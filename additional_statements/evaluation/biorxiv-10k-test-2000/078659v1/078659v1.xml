<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/078659</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>System-wide automatic extraction of functional signatures in <italic>Pseudomonas aeruginosa</italic> with eADAGE</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8893-4566</contrib-id>
<name><surname>Tan</surname><given-names>Jie</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0835-6955</contrib-id>
<name><surname>Doing</surname><given-names>Georgia</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3010-8453</contrib-id>
<name><surname>Lewis</surname><given-names>Kimberley A.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Price</surname><given-names>Courtney E.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7461-9530</contrib-id>
<name><surname>Chen</surname><given-names>Kathleen M.</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Cady</surname><given-names>Kyle C.</given-names></name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Perchuk</surname><given-names>Barret</given-names></name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Laub</surname><given-names>Michael T.</given-names></name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6366-2971</contrib-id>
<name><surname>Hogan</surname><given-names>Deborah A.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8713-9213</contrib-id>
<name><surname>Greene</surname><given-names>Casey S.</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a7">7</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Molecular and Systems Biology, Geisel School of Medicine at Dartmouth</institution>, Hanover, NH, <country>USA</country> 03755.</aff>
<aff id="a2"><label>2</label><institution>Department of Microbiology and Immunology, Geisel School of Medicine at Dartmouth</institution>, Hanover, NH, <country>USA</country> 03755</aff>
<aff id="a3"><label>3</label><institution>Department of Systems Pharmacology and Translational Therapeutics, University of Pennsylvania</institution>, Philadelphia, PA, <country>USA</country> 19104.</aff>
<aff id="a4"><label>4</label><institution>Department of Biology, Massachusetts Institute of Technology</institution>, Cambridge, MA, 02139, <country>USA</country>.</aff>
<aff id="a5"><label>5</label><institution>Howard Hughes Medical Institute</institution>, Cambridge, MA, 02139, <country>USA</country>.</aff>
<aff id="a6"><label>6</label><institution>Institute for Translational Medicine and Therapeutics, Perelman School of Medicine, University of Pennsylvania</institution>, Philadelphia, PA, <country>USA</country> 19104</aff>
<aff id="a7"><label>7</label><institution>Institute for Biomedical Informatics, Perelman School of Medicine, University of Pennsylvania</institution>, Philadelphia, PA, <country>USA</country> 19104</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>To whom correspondence should be addressed: <email>csgreene@mail.med.upenn.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2016</year>
</pub-date>
<elocation-id>078659</elocation-id>
<history>
<date date-type="received"><day>03</day><month>10</month><year>2016</year></date>
<date date-type="accepted"><day>03</day><month>10</month><year>2016</year></date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions>
<self-uri xlink:href="078659.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Abundant public expression data capture gene expression across diverse conditions. These steady state mRNA measurements could reveal the transcriptional consequences of cells&#x2019; genetic backgrounds or their responses to the environment. However, public data remain relatively untapped, in part because extracting biological signal as opposed to technical noise remains challenging. Here we introduce a procedure, termed eADAGE, that performs unsupervised integration of public expression data using an ensemble of neural networks as well as heuristics that, given a dataset, help users identify an appropriate level of model complexity. This ensemble modeling approach captures biological pathways more clearly than existing methods, enabling analyses that span entire public gene expression compendia such as that for the bacterium <italic>Pseudomonas aeruginosa</italic>. These analyses reveal a previously undiscovered feature of the phosphate starvation response apparent in public data: a sensor kinase, KinB, that is required for full activation of the response to phosphate at intermediate concentrations. Our molecular validation experiments confirm this role of KinB and our screen of a histidine kinase knock out collection confirmed the prediction&#x2019;s specificity. Public data are captured from a broad range of conditions in diverse organism backgrounds and may provide a unique opportunity to identify these subtle and context-specific regulatory interactions. Algorithms that extract biological signal from these data, such as eADAGE, can highlight opportunities to discover mechanisms that are apparent from but unrealized in public data.</p>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>denoising autoencoders</kwd>
<kwd>ensemble modeling</kwd>
<kwd>gene expression</kwd>
<kwd><italic>gene expression</italic></kwd>
<kwd>PhoB crosstalk</kwd>
</kwd-group>
<counts>
<page-count count="25"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Introduction</title>
<p>Available gene expression data are outstripping our knowledge about the organisms that we&#x2019;re measuring. Ideally each organism&#x2019;s data reveals the principles underlying gene regulation and consequent pathway activity changes in every condition in which gene expression is measured. Extracting this information requires new algorithms, but many commonly used algorithms are supervised. These algorithms require curated pathway knowledge to work effectively, and in many species such resources are biased in various ways (<xref ref-type="bibr" rid="c33">Schnoes <italic>et al</italic>, 2013;</xref> <xref ref-type="bibr" rid="c13">Gillis &#x0026; Pavlidis, 2013;</xref> <xref ref-type="bibr" rid="c15">Greene &#x0026; Troyanskaya, 2012</xref>). Annotation transfer can help, but such function assignments remain challenging for many biological processes (<xref ref-type="bibr" rid="c17">Jiang <italic>et al</italic>, 2016</xref>). An unsupervised method that doesn&#x2019;t rely on annotation transfer would bypass the challenges of both annotation transfer and biased knowledge.</p>
<p>Along with our wealth of data, abundant computational resources can now power deep unsupervised applications of neural networks (<xref ref-type="bibr" rid="c38">Vincent <italic>et al</italic>, 2008</xref>). Denoising autoencoders (DAs), an unsupervised neural network method, are well suited to gene expression data (<xref ref-type="bibr" rid="c36">Tan <italic>et al</italic>, 2015</xref>). DAs are more robust than linear approaches such as ICA or PCA in the context of public data, which employ heterogeneous experimental designs, lack shared controls and provide limited metadata (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>). Investigators can use models trained on public data to reexamine their own data to identify the processes or pathways that are particularly perturbed in their experiment.</p>
<p>As a result of a training process that uses stochastic gradient descent, each DA model represents a local minimum. Because the number of parameters is large, there are many distinct models that can explain the data. One way to address this challenge is by finding patterns that are stable across multiple models, which Yu highlights for its importance in statistical inference (<xref ref-type="bibr" rid="c40">Yu, 2013</xref>). Even if run-to-run variability in models obscures some biological features, these stable cross-model patterns may clearly resolve biological pathways. To directly target stability, we introduce an unsupervised ensemble modeling procedure that improves model robustness by constructing an ensemble neural network model. Our approach is inspired by consensus clustering (<xref ref-type="bibr" rid="c23">Monti <italic>et al</italic>, 2003</xref>), which now has become a standard part of clustering applications for biological datasets.</p>
<p>While this new generation of unsupervised data integration methods provides a powerful lens through which to study complex biological systems, it also raises questions: how many biological signatures are in the data; and how many samples are needed to find those features? Heuristics should include data-driven analyses that can be applied in any setting, as well as knowledge-based heuristics that are suitable in cases where pathway annotations are available.</p>
<p>We introduce both data- and knowledge-based heuristics to suggest an appropriate model size for a given data compendium. We previously constructed a 50-node ADAGE (Analysis using Denoising Autoencoders for Gene Expression) model of <italic>P. aeruginosa</italic> because this balanced the need for breadth of the model with the limits of manual annotation required for the initial validation of the method (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>). Our heuristics indicate that the existing <italic>P. aeruginosa</italic> compendium can support 300 node models, which we use in this work. We compare ADAGE models with models generated through an ensemble form of ADAGE (eADAGE) and find that eADAGE models have greater stability. The eADAGE models are not only more robust, but also more successfully capture pathway features in the data. While ADAGE allows comparison of pathway activities within an experiment, eADAGE models also enable analyses that cut across an organism&#x2019;s gene expression compendium. We analyze <italic>P. aeruginosa</italic>&#x2019;s responses to multiple types of media with eADAGE. This cross-compendium analysis reveals a gene expression signature for the response to low-phosphate in certain media, which our molecular validation confirms. Our analyses of this signature across the compendium revealed a previously undiscovered link between KinB and PhoB activity. PhoB is known to mediate the low phosphate response and is canonically regulated by a histidine kinase, PhoR. However, our molecular validation shows PhoA activity, which indicates PhoB activity, independent of PhoR in some conditions and dependent on KinB in some conditions. Our experiments confirm that KinB regulates PhoB activity at physiologically relevant phosphate concentrations and that this activity is specific to KinB among kinases.</p>
<p>In summary, eADAGE more precisely and robustly represents biological processes and pathways. It allows biologists to identify not only differentially active signatures within one experiment, but also cross-compendium patterns that reveal undiscovered regulatory mechanisms captured within existing public data.</p>
</sec>
<sec id="s2"><title>Results</title>
<sec id="s2a"><title>Analysis of the effects of model size on pathway characterization of ADAGE models from <italic>P. aeruginosa</italic> gene expression</title>
<p>While ADAGE models are constructed without the use of any curated information, we can use experimentally-derived knowledge on gene functions to provide heuristic information about the number and types of pathways captured by a model and determine how this varies with model size. We define a functional signature learned by an ADAGE model as a set of genes that contribute the highest positive or highest negative weights to a specific node (see methods for detail). Therefore, one node results in two gene signatures, one on each high weight side. These high-weight (HW) genes are often involved in a common biological process as demonstrated by the fact that there is often a statistically significant enrichment in specific KEGG pathways within each signature. For models of different sizes (10-1000 nodes), we determined the number of KEGG pathways significantly associated with at least one gene signature in a model, referred to as KEGG pathway coverage for that model, and found that KEGG pathway coverage increased as model size increased until a model size of approximately 300 (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). The number of pathways per node (including pathways associated with both the positive and negative signatures in a node) for all nodes with at least one associated KEGG pathway decreased as model size increased (Figure EV1), suggesting that multiple pathways were grouped in small models and were separated into more discrete features in large models with more nodes.</p>
<fig id="fig1" position="float" fig-type="figure"><label>Figure 1:</label>
<caption><title>Knowledge- and data-driven heuristics for ADAGE</title>
<p>A Knowledge-driven model size heuristics on pathway coverage. As model size increases, pathway coverage also increases at first and then levels out at size 300. The red line goes through the median value at each model size.</p>
<p>B Data-driven model size heuristics on reconstruction error. As model size increases, the reconstruction error drops quickly at the beginning and levels out at size 300. The red line goes through the median reconstruction errors at each model size.</p>
<p>C Knowledge-driven sample size heuristics on pathway coverage. For 50-node models, pathway coverage increases with sample size and peaks at 500 samples. 300-node models cover more pathways than 50-node modes in general and maintain a slow growing trend of pathway coverage at the maximum sample size.</p>
<p>D Data-driven sample size heuristics on reconstruction error. In both 50- and 300-node models, the reconstruction errors on the test set get closer to the reconstruction errors on the train set as sample size increases.</p></caption>
<graphic xlink:href="078659_fig1.tif"/>
</fig>
<p>Methods that use pathway coverage to identify the appropriate model size for a collection of samples require curated pathways, but a parallel analysis can be performed without this requirement. During ADAGE training, neural networks are trained to reconstruct the input from data with noise added, and calculating the reconstruction error does not require any curated information. The reconstruction error can also be used to estimate model sizes that can be supported by the available data. The reconstruction error quickly decreases as model size increases and reaches a plateau at model size of approximately 300 (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Further increasing model size does not improve reconstruction, suggesting that the available data are insufficient to support larger models. Therefore, considering the knowledge-driven and data-driven heuristics together, we identified a 300-node model as most appropriate for the existing <italic>P. aeruginosa</italic> gene expression compendium.</p>
</sec>
<sec id="s2b"><title>Analysis of the effects of sample number in the training set on ADAGE models</title>
<p>The expression compendium contains 1051 samples from 125 experiments. We next performed a subsampling analysis in which we trained ADAGE models on randomly selected sets of 100, 200, 500, and 800 expression profiles. We examined the number of KEGG pathways associated with at least one gene signature (pathway coverage) as a function of the size of the training set (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). In the 50-node models, the size used in (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>), the average KEGG pathway coverage at each training size increased significantly up to 500 samples (Tukey&#x2019;s HSD adjusted p-values &#x003C; 0.05 between models trained with 100, 200, and 500 samples), but differences beyond 500 training samples were not significant (Tukey&#x2019;s HSD adjusted p values &#x003E; 0.05 between models trained with 500, 800, and 1051 samples). For 300-node models, pathway coverage showed significant increases (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) between the models constructed with 100, 200, 500, and 800 samples (Tukey&#x2019;s HSD adjusted p-values &#x003C; 0.05) but not between 800 and 1051 (Tukey&#x2019;s HSD adjusted p-value &#x003E; 0.05). The slower increase in pathway coverage when sample size is relatively large suggests redundancy in the compendium, potentially due to biological replicates or experiments probing similar processes. This highlights the importance of data that capture diverse processes.</p>
<p>Using the subsampling strategy, we also evaluated the reconstruction error of each model on its training set and a randomly chosen held out test set of 200 samples. As sample size increased, training reconstruction errors increased slightly while testing reconstruction errors dropped dramatically (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). We fitted exponential models between sample size and the differences of training and testing errors (R<sup>2</sup>&#x003D; 0.78 for 50-node models and R<sup>2</sup>&#x003D; 0.83 for 300-node models). We extrapolated from these models to predict that testing errors would approximately match training errors when sample size was 782 for 50-node models and 1076 for 300-node models. These results suggested that smaller models were less sensitive to sample size, likely because they have fewer parameters to fit and also that our 1051 sample compendium was sufficient to train a 300-node model.</p>
</sec>
<sec id="s2c"><title>eADAGE: ensemble modeling improves the model breadth, depth, and robustness</title>
<p>Individual ADAGE models capture a local minimum, with models of the same size capturing different pathways. This occurs because each ADAGE model is initialized with random weights, and the training processes are sensitive to these initial conditions. eADAGE, in which we built an ensemble version of individual ADAGE models, took advantage of this variation to enhance model robustness. Each eADAGE model integrated nodes from 100 individual ADAGE models (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). To unite nodes from different models, we applied consensus clustering on nodes&#x2019; weight vectors. Our previous ADAGE analyses showed that HW genes characterized each node&#x2019;s biological significance, so we designed a weighted Pearson correlation to incorporate gene weights in building eADAGE models (see methods). We compared eADAGE to two primary baseline methods: individual ADAGE models and corADAGE, which combined nodes with an unweighted Pearson correlation. For direct comparison, the model sizes of ADAGE, eADAGE, and corADAGE were all fixed to 300 nodes, which we found to be appropriate for the current <italic>P.a</italic> expression compendium.</p>
<fig id="fig2" position="float" fig-type="figure"><label>Figure 2:</label>
<caption><title>The construction and performance of eADAGE.</title>
<p>A eADAGE construction workflow. 100 individual ADAGE models were built using the same input dataset (step 1). Nodes from all models were extracted (step 2) and clustered based on the similarities in their associated weight vectors (step 3). Nodes derived from different models were rearranged by their clustering assignments (step 4). Weight vectors from nodes in the same cluster were averaged and thus becoming the final weight vector of a newly constructed node in an eADAGE model (step5).</p>
<p>B Pathway coverage comparison between individual ADAGE and ensemble ADAGE. eADAGE models (n&#x003D;10) covers significantly more pathways than both corADAGE (n&#x003D;10) and ADAGE (n&#x003D;1000).</p>
<p>C The enrichment significance of three example pathways in different models. The three pathways show different trends as model size increases in individual ADAGE, however, their median significance levels in eADAGE are comparable or better than all individual models with different sizes. The grey dotted line indicates FDR q-value of 0.05 in pathway enrichment.</p>
<p>D Comparison among PCA, ICA, and eADAGE in pathway coverage at different significance levels. eADAGE outperforms PCA at all significance levels. eADAGE and ICA show similar pathway coverage at the cutoff q-value &#x003D; 0.05. However, ICA covers less pathways than eADAGE as the significance cutoff becomes more stringent.</p></caption>
<graphic xlink:href="078659_fig2.tif"/>
</fig>
<p>eADAGE models exhibited greater KEGG pathway coverage than those generated by other methods. We evaluated ADAGE, corADAGE, and eADAGE for the number of covered KEGG pathways (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Both corADAGE and eADAGE covered significantly more KEGG pathways than ADAGE (t-test p-value of 1.04e-6 between corADAGE (n&#x003D;10) and ADAGE (n&#x003D;1000) and t-test p-value of 1.41e-6 between eADAGE (n&#x003D;10) and ADAGE (n&#x003D;1000)). Moreover, eADAGE models covered, on average, 10 more pathways than corADAGE (t-test p-value of 1.99e-3, n&#x003D;10 for both groups), confirming the critical roles of an ADAGE node&#x2019;s HW gene signatures in defining biological pathways. Genes that participate in multiple pathways can influence pathway enrichment analysis, a factor termed pathway crosstalk (<xref ref-type="bibr" rid="c8">Donato <italic>et al</italic>, 2013</xref>). If eADAGE signatures tended to include genes that participated in many pathways, this could also drive the increase in number of observed pathways. To control for this, we performed crosstalk correction (<xref ref-type="bibr" rid="c8">Donato <italic>et al</italic>, 2013</xref>). After correction, the total number of covered pathways dropped approximately by half (Figure EV2), but eADAGE still covered significantly more pathways than corADAGE (t-test p-value of 1.60e-3) and ADAGE (t-test p-value of 6.16e-07). These results suggested that eADAGE effectively integrates multiple models to more broadly capture pathway signals embedded in diverse gene expression compendia. We next evaluated how specifically and completely signatures learned by the models capture known KEGG pathways. We use each gene signature&#x2019;s FDR corrected p-value for enrichment of a KEGG pathway as a combined measure, as this captures both the sensitivity and specificity. If a pathway was significantly associated with multiple gene signatures in a model, we only considered its most significant association. We found that 71&#x0025; of pathways were more significantly enriched (had lower median p-values) in corADAGE models (n&#x003D;10) when compared to individual ADAGE models (n&#x003D;100) (Figure EV3). This increased to 87&#x0025; for eADAGE (n&#x003D;10). We also directly compared eADAGE and corADAGE by this measure and observed that 74&#x0025; of pathways were more significantly enriched in eADAGE. Our earlier evaluation of pathway-based heuristics showed that different pathways were best captured at different model sizes (Figure EV3). We next compared the 300-node eADAGE model to individual models of each size. Although the 300-node eADAGE models were constructed only from 300-node ADAGE models, we found that 69&#x0025; pathways were more significantly enriched (i.e. lower median p-values) in eADAGE models than ADAGE models of any size, including those with more nodes than the eADAGE models (Figure EV3). Three example pathways that are best captured either when model size is small, large, or in the middle are all well captured in the 300-node eADAGE model (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). These results demonstrate that eADAGE&#x2019;s ensemble modeling procedure captures signals across model sizes more effectively than individual ADAGE and corADAGE models. Thus eADAGE more completely and precisely captures the gene expression signatures of biological pathways.</p>
<p>We designed eADAGE to provide a more robust analysis framework than individual ADAGE models. To assess this, we examined the percentage of models that covered each pathway (coverage rate) between ADAGE and eADAGE (Figure EV4). The pathways covered by each individual ADAGE model were highly variable. Most KEGG pathways were covered by less than half of individual models but more than half of eADAGE models (Figure EV5), suggesting that eADAGE models were more robust than individual ADAGE models. We excluded all pathways always covered by both individual ADAGE and eADAGE models and observed that 72&#x0025; of the remaining pathways were covered more frequently by eADAGE than ADAGE. This suggests that their associations are stabilized through the ensemble construction procedures. In summary, these comparisons of eADAGE and ADAGE reveal that not only are more pathways captured more specifically, but also those that are captured are captured more consistently.</p>
<p>Principle component analysis (PCA) and independent component analysis (ICA) have been previously used to extract biological features and build functional gene sets (<xref ref-type="bibr" rid="c10">Engreitz <italic>et al</italic>, 2010;</xref> <xref ref-type="bibr" rid="c29">Raychaudhuri <italic>et al</italic>, 2000;</xref> <xref ref-type="bibr" rid="c14">Gong <italic>et al</italic>, 2007;</xref> <xref ref-type="bibr" rid="c1">Alter <italic>et al</italic>, 2000;</xref> <xref ref-type="bibr" rid="c29">Raychaudhuri <italic>et al</italic>, 2000;</xref> <xref ref-type="bibr" rid="c21">Lutter <italic>et al</italic>, 2009;</xref> <xref ref-type="bibr" rid="c12">Frigyesi <italic>et al</italic>, 2006;</xref> <xref ref-type="bibr" rid="c5">Chen <italic>et al</italic>, 2008;</xref> <xref ref-type="bibr" rid="c30">Roden <italic>et al</italic>, 2006;</xref> <xref ref-type="bibr" rid="c22">Ma &#x0026; Kosorok, 2009</xref>). We performed PCA and generated multiple ICA models from the same <italic>P. aeruginosa</italic> expression compendium and evaluated their KEGG pathway coverage following the same procedures used for eADAGE. eADAGE substantially and significantly outperforms PCA in terms of pathway coverage (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). We observed that low-order PCs tend to be associated with more pathways than high-order PCs, which is consistent with the higher variance explained by low-order PCs. ICA and eADAGE covered a similar number of pathways at the significance cutoff of FDR 0.05. However, we observed that eADAGE represented KEGG pathways more precisely than ICA. Specifically, among pathways significantly enriched in either approach, 68&#x0025; pathways exhibited more significant enrichment in eADAGE. Increasing the significance threshold for pathway coverage demonstrates the advantage of eADAGE (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p>
<p>Taken together, the eADAGE method outperformed PCA, ICA, ADAGE, and corADAGE in capturing KEGG pathways of <italic>P. aeruginosa</italic>. eADAGE had higher pathway coverage, covered pathways more specifically, and more robustly than existing methods. Though the primary goal of eADAGE is not function prediction, it captures pathway signals in transcriptional data significantly more effectively than existing unsupervised data integration methods. These results clearly indicate that eADAGE extracts biological patterns from gene expression compendia.</p>
</sec>
<sec id="s2d"><title>Elucidating functional signatures that are indicative of growth medium</title>
<p>Gene expression analysis experiments are generally designed to include only a small number of variables. Thus, it is not surprising that in the majority of publically available <italic>P. aeruginosa</italic> gene expression experiments, the growth medium was held constant while there was variation in other parameters such as strain, environmental parameters (i.e. pH, temperature, growth phase, or gaseous atmosphere), or culture amendments (antibiotics, etc.). Though it was rare for the base medium to vary within a single experiment, our manual annotation showed that 78 different base media were used across the gene expression compendium (Table EV1). These media exhibit great diversity in the number of different medium components, the abundance of different nutrients, and the form in which nutrients were provided. Some medium groups contained numerous samples from multiple experiments other media types were unique to a single experiment.</p>
<p>For biological evaluation, we built a single new eADAGE model with 300 nodes. In this model we identified cross-media signals of biological importance. The model&#x2019;s weight matrix (Table EV2), positive and negative gene signatures for each node (Table EV3) and signature activities for each sample in the compendium (Table EV4) are provided. For each gene signature, we used its mean activity for samples prepared from cells grown in a given medium compared to the mean activity of the signature across all the remaining samples in the compendium normalized to the total range to provide an activation score. We then further reduced this set by filtering to all signature-medium relationships with an activation score greater than or equal to 0.4 (Table EV5), which included only the top 2.4&#x0025; of potential pairs. To capture pan-media patterns we identified signatures that had multiple signature-media activation scores above this threshold and averaged their activation scores. Table EV6 lists the media groups on which gene signatures were most differentially active (a complete list of signature-media associations is in Table EV7).</p>
<p>The signature Node164pos had the highest pan-media activation score. To evaluate the basis for the high activation score, we examined the signature&#x2019;s underlying activity across media. This revealed that Node164pos was highly active in King&#x2019;s A medium, peptone medium, and NGM&#x002B;&#x003C;0.1mM phosphate (NGMlowP), but not in NGM&#x002B;25mM phosphate (NGMhighP) (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The difference in Node164pos activity between NGMlowP and NGMhighP suggested that the genes in this signature respond to phosphate concentrations. Consistent with this proposal, a KEGG pathway enrichment analysis of Node164pos genes suggested a strong enrichment in genes involved in phosphate acquisition (Table EV6). The other two media in which <italic>P. aeruginosa</italic> gene expression leads to consistently high Node164pos activity (Peptone and King&#x2019;s A) also had low phosphate concentrations (0.4 mM) relative to other media in the compendium. For example, commonly used LB has a phosphate concentration of approximately 4.5 mM (<xref ref-type="bibr" rid="c2">Bertani, 2004</xref>) and many others have concentrations above 20 mM.</p>
<fig id="fig3" position="float" fig-type="figure"><label>Figure 3:</label>
<caption><title>Node164pos is active in a NGM&#x002B;&#x003C;0.1phosphate, peptone, King&#x2019;s A, and PIA media</title>
<p>A Activity of Node164pos in each medium type. NGM&#x002B;&#x003C;0.1phosphate, peptone, and King&#x2019;s A media have evident elevation in Node164pos&#x2019;s activity. PIA medium show a wide range in Node164pos&#x2019;s activity. All other media have very low activities.</p>
<p>B Gene expression heatmaps of genes in Node164pos across samples in <bold>NGM&#x002B;&#x003C;0.1phosphate, peptone, King&#x2019;s A, and PIA media</bold>. Heatmap color range is determined by the Z-scored gene expression of all samples in the compendium (Figure EV6). These genes are highly expressed in all samples grown on NGM &#x002B; &#x003C;0.1mM phosphate, peptone, King&#x2019;s A, and half of samples on PIA, but not expressed in samples grown on NGM &#x002B; 25mM phosphate.</p></caption>
<graphic xlink:href="078659_fig3.tif"/>
</fig>
<p>Many of the phosphate responsive genes in Node164pos are known to be under the control of the transcription factor PhoB in <italic>P. aeruginosa</italic> (<xref ref-type="bibr" rid="c32">Santos-Beneit, 2015</xref>; <xref ref-type="bibr" rid="c4">Blus-Kadosh <italic>et al</italic>, 2013;</xref> <xref ref-type="bibr" rid="c3">Bielecki <italic>et al</italic>, 2015</xref>) and <italic>phoB</italic> itself is in this signature. Analysis of genes in Node164pos finds that this signature has the largest overlap with the PhoB regulon (see methods) in comparison to all other gene signatures learned by this eADAGE model (FDR q-value of 8.1e-29 in hypergeometric test). The transcript levels of genes in Node164pos are higher in peptone, King&#x2019;s A, and NGM&#x002B;&#x003C;0.1 phosphate medium relative to the other samples in the compendium including NGM&#x002B; 25 mM phosphate (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p>
<p>Among the highest weight genes in Node164pos is a gene that encodes alkaline phosphatase (PhoA), an enzyme with an activity that can be easily measured using a colorimetric assay. As expected, PhoA activity (blue color) was high when <italic>P. aeruginosa</italic> was grown on NGMlowP and not when grown on NGMhighP (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The same trend was observed in another medium, MOPS, with the same high and low phosphate concentrations. Also consistent, PhoA was not active on the phosphate replete medium LB. Furthermore, PhoA activity was dependent on PhoB and the PhoB-activating histidine kinase PhoR, which is consistent with previous publications (<xref ref-type="bibr" rid="c3">Bielecki <italic>et al</italic>, 2015</xref>). These results provide striking evidence that low phosphate media induced PhoB activity as predicted by the eADAGE analysis and previous characterizations of the <italic>P. aeruginosa</italic> phosphate response. Interestingly, Node164pos activity exhibited a wide spread in PIA medium (0.8 mM phosphate), with six samples having high activities and the other six samples having low activities (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Each set of six samples came from a different study. All of the strains in the first sample set, published in 2012, in which Node164pos was low used a PAO1 <italic>kinB</italic>::Gm<sup>R</sup> mutant background (<xref ref-type="bibr" rid="c7">Damron <italic>et al</italic>, 2012</xref>). The second, published in 2013, used a PAO1 strain with <italic>kinB</italic> intact and showed high Node164pos activity on PIA (<xref ref-type="bibr" rid="c6">Damron <italic>et al</italic>, 2013</xref>). The fact that <italic>kinB</italic> mutant samples in PIA show significantly lower Node164pos activity suggests that KinB may be a regulator of PhoB on PIA.</p>
<fig id="fig4" position="float" fig-type="figure"><label>Figure 4:</label>
<caption><title>PhoA activity, as seen by the colorimetric BCIP assay in various media</title>
<p>A PhoA activity, as seen by the blue-colored product of BCIP cleavage, is dependent on low phosphate concentrations, <italic>phoB, phoR</italic> and, in NGM, <italic>kinB</italic>.</p>
<p>B PhoA is active in King&#x2019;s A, Peptone and PIA and is dependent on <italic>phoB</italic> and <italic>phoR</italic> on King&#x2019;s A and peptone but dependent on <italic>kinB</italic> as well on PIA at 16 hours.</p>
<p>C PhoA is active in King&#x2019;s A, Peptone and PIA and is dependent on <italic>phoB,</italic> but no longer <italic>phoR,</italic> while still dependent on <italic>kinB</italic> on PIA after 32 hours.</p>
<p>D PhoA activity is dependent on phosphate concentrations &#x003C; 0.6 mM, <italic>phoB, phoR</italic> and <italic>kinB</italic> as well at 0.5 mM phosphate in MOPS. Concentration 0.2 mM (not shown) mimics 0.1mM and concentrations 0.7mM &#x2013; 0.9mM (not shown) mimic 1.0 mM.</p></caption>
<graphic xlink:href="078659_fig4.tif"/>
</fig>
<p>Expectedly, PhoA activity was high in peptone and King&#x2019;s A media, as in NGMlowP. Further, as predicted by eADAGE Node164pos activity, PhoA activity was evident and was KinB dependent on PIA medium (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Notably, PhoA activity was still dependent on PhoB and PhoR as it was on peptone and King&#x2019;s A. Over time the &#x2206;<italic>phoR</italic> mutants developed PhoA activity on all three media, but the &#x2206;<italic>kinB</italic> on PIA did not (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Recovery of PhoA activity in &#x2206;<italic>phoR</italic> mutants suggests that there are PhoR-independent paths for PhoB activation. The co-dependence on KinB and PhoR suggest that these kinases do not perform redundant functions but rather regulate PhoB in conjunction with each other. To determine if the deletion of kinases non-specifically altered PhoB activation, we screened 63 in-frame deletion mutants each lacking a histidine kinase (Table EV8) to identify mutants altered in PhoA activation on PIA. Other than &#x2206;<italic>phoR</italic>, &#x2206;<italic>kinB</italic> was the only strain lacking PhoA activity on NGMlowP. This suggests that PhoA activity is not altered by changes in generic kinase activity but rather the interaction with KinB is specific.</p>
<p>Notably, although PIA, peptone and King&#x2019;s A contain low phosphate levels compared to rich media such as LB, PIA has a higher phosphate concentration (0.8mM) than do peptone and King&#x2019;s A (0.4mM). To test whether the moderately low level of phosphate in PIA provokes KinB regulation of PhoA, we conducted a titration experiment in MOPS minimal medium. PhoA activity was consistent with that on NGM and other media. Further, while the PAO1 wild type (WT) showed PhoA activity at 0.5 mM, PAO1 &#x2206;<italic>kinB</italic> did not (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). This shows KinB regulation of PhoB in moderately low phosphate and not in lower phosphate. Noting that PIA has a phosphate concentration of 0.8 mM and our titration experiment in MOPS showed <italic>kinB</italic>-sensitivity at 0.5 mM, it is likely that the precise concentration at which KinB regulates PhoA depends on the background medium. Node164pos activity across the compendium suggested, and experimental evidence confirmed, that KinB regulates PhoA at moderately low phosphate levels. To our knowledge, KinB has not been previously implicated in the activation of PhoB, although cross-compendium eADAGE analysis of two PIA experiments was capable of revealing this relationship.</p>
<p>In summary, eADAGE effectively extracted biologically meaningful features, accurately indicated their activity in multiple media spanning numerous independent experiments, and revealed a novel regulatory mechanism. By summarizing gene-based expression information into biologically relevant features, eADAGE greatly simplifies analyses that cut across large gene expression compendia.</p>
</sec>
</sec>
<sec id="s3"><title>Discussion</title>
<p>For unsupervised approaches, it has been very challenging to determine the appropriate model complexity. In supervised learning problems, predictors can be assessed through cross-validation accuracies. To our knowledge, there is not yet a similar well-established approach to estimate appropriate model size for unsupervised feature construction of gene expression data. Here we develop heuristics that target two aspects of the problem: the model needs to be well supported by the amount of available data and the extracted features should well resemble known biological processes. Our data-driven heuristics can be applied to organisms for which gene-process annotations are lacking. We expect that additional data will support larger models, especially data that measure experimental conditions that are not tested in the existing compendium. We also contribute a novel eADAGE algorithm. This algorithm combines multiple ADAGE models into one ensemble model to address model variability due to stochasticity and local minima. The algorithm is inspired by consensus clustering, which reconciles the differences in cluster assignments in multiple runs. Comparable approaches have also been applied for ICA, where researchers have used the centrotypes of multiple ICA models as the final model (<xref ref-type="bibr" rid="c12">Frigyesi <italic>et al</italic>, 2006</xref>). The ICA centrotype approach for ADAGE corresponds to corADAGE, and our comparison of eADAGE and corADAGE shows that eADAGE not only covers more biological pathways, but also results in cleaner representations of biological pathways. The results of our direct comparison suggest that placing particular emphasis on the genes most associated with a particular signature may be a useful property for other unsupervised feature construction algorithms in biology.</p>
<p>Our eADAGE model revealed patterns that were obvious in the analysis of the large data compendium containing experiments performed in 78 different media, but that were not necessarily evident in individual experiments. For example, our cross-compendium analysis of expression patterns specific to certain media determined those media in which <italic>P. aeruginosa</italic> was in a phosphate limited, PhoB-ON state. PhoB is a global regulator, and thus an awareness of the different states of the PhoB regulon in different media will likely provide important insight into medium-specific phenotypes of relevance. Using eADAGE, we uncovered a subtle aspect of the phosphate starvation response that depends on a histidine kinase not previously associated with the PhoB-dependent phosphate response pathway. Bacteria have evolved many mechanisms to insulate response pathways from each other (<xref ref-type="bibr" rid="c28">Podgornaia &#x0026; Laub, 2013</xref>), but cross-talk, wherein a sensor kinase from one pathway phosphorylates a response regulator from another, has been suggested to explain the complexity of signaling networks, including that of PhoB (<xref ref-type="bibr" rid="c25">Ninfa <italic>et al</italic>, 1988;</xref> <xref ref-type="bibr" rid="c11">Fisher <italic>et al</italic>, 1995</xref>). Thus, it is possible that both PhoR and KinB directly activate PhoB. While there are many examples of one kinase partially compensating when the cognate kinase is absent, it is more challenging to find conditions where two kinases are needed for full response regulator activation (<xref ref-type="bibr" rid="c37">Verhamme <italic>et al</italic>, 2002</xref>). Alternatively, KinB may influence PhoB activity indirectly by regulating activities that affect PhoB levels, PhoB dephosphorylation, or PhoB localization, or protein-protein interactions. Future work will further address the mechanistic aspects of this model. We propose that moderate levels of phosphate, like those in PIA, provide a niche for crosstalk: the activity of PhoR is low enough that the interaction with KinB is needed for full PhoB activity on this medium. Together, PhoR and KinB may enable a more sensitive and effective response to phosphate limitation. Without the eADAGE analysis across multiple media, we would not have found this nuanced mechanism.</p>
<p>In the 300-node eADAGE model used for medium analysis, 81&#x0025; genes in <italic>P.a.</italic> PAO1 genome are included in at least one gene signature. Among all signatures, 59&#x0025; have a KEGG pathways associated with them. Among the remaining 41&#x0025; of signatures, 17 of them had ten or fewer genes and may not have associated with KEGG pathways for this reason. Some others were associated with known pathways that have not yet been annotated in KEGG, such as Node174pos which encodes genes encoded by the P2 phage or Node150neg which contains genes involved in the formation of surface associated communities referred to as biofilms. Thus eADAGE can group functionally linked genes in ways that may facilitate the identification or annotation of pathways. There are now abundant public gene expression data. Cross-compendium analyses provide the opportunity to efficiently use existing data to identify regulatory patterns that are evident across multiple experiments, datasets, and labs. To tap this potential, we will require algorithms that robustly integrate these diverse datasets in a manner that is not tied to only aspects of biology that are well understood. We expect that robust unsupervised data integration methods, like eADAGE, will play a key role in this process.</p>
</sec>
<sec id="s4"><title>Materials and Methods</title>
<sec id="s4a"><title>Data processing</title>
<p>We followed the same procedures for data collection, processing, and normalization from (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>) and updated the <italic>P. aeruginosa</italic> gene expression compendium to include newly uploaded datasets on GPL84 platform from the ArrayExpress database (<xref ref-type="bibr" rid="c31">Rustici <italic>et al</italic>, 2013</xref>) on 31 July 2015. The updated <italic>P. aeruginosa</italic> compendium contains 125 datasets with 1051 individual genome-wide assays. We provide the <italic>P. aeruginosa</italic> expression compendium (Dataset EV1) along with all the code used in this paper (<xref ref-type="bibr" rid="c34">Tan <italic>et al</italic>, 2016a</xref>). The eADAGE repository is also tracked under version control at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/greenelab/eadage">https://bitbucket.org/greenelab/eadage</ext-link>.</p>
</sec>
<sec id="s4b"><title>Construction of ADAGE models</title>
<p>We constructed ADAGE models as described in (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>). To summarize the process and outputs, we constructed a denoising autoencoder for the gene expression compendium. Denoising autoencoders model the data in a lower dimension than the input space, and the models are trained with random gene expression measurements set to zero. Thus an ADAGE model must learn gene-gene dependencies to fill in this missing information. Once the ADAGE model is trained, each node in the hidden layer contains a weight vector. These positive and negative weights represent the strength of each gene&#x2019;s connection to that node.</p>
</sec>
<sec id="s4c"><title>Gene signatures as sign-specific high-weight gene sets</title>
<p>In previous work (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>) we defined high-weight (HW) genes as those in the extremes of the weight distribution on the positive or negative side of a node. Here, we use a more granular definition that accounts for sign specificity. Each node&#x2019;s gene weights are approximately normal and centered at zero in ADAGE models (<xref ref-type="bibr" rid="c36">Tan <italic>et al</italic>, 2015</xref>, <xref ref-type="bibr" rid="c35">2016b</xref>). We defined positive HW genes as those that were more than 2.5 standard deviations from the mean on the positive side, and negative HW genes as those that were more than 2.5 standard deviations from the mean on the negative side. After this split, a model with n nodes provides 2n gene signatures. Because a node is simply named by the order that it occurs in a model, we named two gene signatures derived from one node as &#x201C;NodeXXpos&#x201D; and &#x201C;NodeXXneg&#x201D;.</p>
</sec>
<sec id="s4d"><title>KEGG pathway enrichment analysis</title>
<p>To evaluate the biological relevance of gene signatures extracted by an ADAGE model, we tested how they relate to known KEGG pathways (<xref ref-type="bibr" rid="c18">Kanehisa, 2000</xref>). We tested a signature&#x2019;s association with each KEGG pathway using hypergeometric test and corrected the p-value by the number of KEGG pathways we tested following the Benjamini&#x2013;Hochberg procedure. We used a false discovery rate of 0.05 as the significance cutoff.</p>
<p>Genes can be annotated to multiple pathways. To control for this effect in our analysis, we also performed a parallel analysis after applying crosstalk correction as described in (<xref ref-type="bibr" rid="c8">Donato <italic>et al</italic>, 2013</xref>). This approach uses expectation maximization to map each gene to the pathway in which it has the greatest predicted impact. A gene-to-pathway membership matrix, defined using KEGG pathway annotations, initially makes the assumption that each gene&#x2019;s role in all of its assigned pathways remains constant independent of context. We then applied pathway crosstalk correction using genes&#x2019; weights for each node in the ADAGE model. We used the expectation maximization algorithm to maximize the log-likelihood of observing the membership matrix given each node&#x2019;s weight vector. This process inferred an underlying gene-to-pathway impact matrix and iteratively estimated the probability that a particular gene g contributed the greatest fraction of its impact to some pathway P. Upon convergence, we assigned each gene to the pathway in which it had the maximum impact. The resulting pathway definitions do not share genes. We then used these corrected definitions for an analysis parallel to the KEGG process described above.</p>
</sec>
<sec id="s4e"><title>Reconstruction error calculation</title>
<p>The training objective of ADAGE is to take a sample with added noise and return the originally measured expression values. The error between the reconstructed data and the initial data is the &#x2018;reconstruction error.&#x2019; To summarize the difference over all genes we used cross-entropy between the original sample and the reconstruction, which has been widely used with these methods and in this domain (<xref ref-type="bibr" rid="c38">Vincent <italic>et al</italic>, 2008;</xref> <xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>). This matches the statistic used during training of the model. To calculate reconstruction error for a model, we use the mean reconstruction error across samples.</p>
</sec>
<sec id="s4f"><title>Model size and sample size heuristics</title>
<p>One important parameter of a denoising autoencoder model is the number of nodes in the hidden layer, which we refer to as the model size. To evaluate the impact of model size and choose the most appropriate size, we built 100 ADAGE models at each model size of 10, 50, 100, 200, 300, 500, 750, and 1000, using different random seeds. The random seed determines the initialization statuses of the weight matrix and bias vectors in ADAGE construction and thus different random seeds will result in training stopped at different local minimums. Other training parameters were kept the same and set to the values identified as suitable for a gene expression compendium (<xref ref-type="bibr" rid="c36">Tan <italic>et al</italic>, 2015</xref>). In total, 800 ADAGE models with 100 at each model size were generated in the model size evaluation experiment. To evaluate the impact of sample size on the performance of ADAGE models, we randomly generated subsets of the <italic>P. aeruginosa</italic> expression compendium with sample size of 100, 200, 500, and 800. We then trained 100 ADAGE models at each sample size, each with a different combination of 10 different random subsets and 10 different random training initializations. To evaluate each model, we randomly selected 200 samples not used during training as its testing set. We performed this subsampling analysis at model size 50 and 300. In total, 800 ADAGE models were built in the sample size evaluation experiment.</p>
</sec>
<sec id="s4g"><title>Construction of eADAGE models</title>
<p>We constructed ensemble ADAGE (eADAGE) models by combining many individual ADAGE models in to a single model. For each eADAGE model we combined 100 individual ADAGE models. The 100 models were trained with identical parameters but distinct random seeds. For an eADAGE model of size 300, we trained 100 individual models with 300 nodes each, which provided 30000 total nodes. Each node has a weight vector. We have previously observed that high-weight genes provided the most information to each node (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>), so we calculated a weighted Pearson correlation between each node&#x2019;s weight vectors. Our weighted Pearson correlation used (|node1 weight|&#x002B;|node2 weight|)/2 as the weight function for each gene. We compared this to an unweighted Pearson correlation (corADAGE) as well a baseline ADAGE model.</p>
<p>After calculating correlation (weighted for eADAGE and unweighted for corADAGE), we converted the correlation to distance by calculating (1-correlation)/2. This provided a 30000&#x002A;30000 distance matrix storing distances between every two nodes. We clustered this distance matrix using the Partition Around Medoids (PAM) clustering algorithm (<xref ref-type="bibr" rid="c26">Park &#x0026; Jun, 2009</xref>).We implemented clustering in R using the ConsensusClusterPlus package (<xref ref-type="bibr" rid="c39">Wilkerson &#x0026; Hayes, 2010</xref>) from Bioconductor with the ppam function from Sprint package to perform parallel PAM (<xref ref-type="bibr" rid="c27">Piotrowski <italic>et al</italic>, 2011</xref>). We set the number of clusters to match the individual ADAGE model (e.g. 300) allowing for direct comparison between the eADAGE and ADAGE methods.</p>
<p>Clustering assigned each node to a cluster ranging from 1 to 300. We combined nodes assigned to the same cluster by calculating the average of their weight vectors. These 300 averaged vectors formed the weight matrix of the eADAGE model. Because the ensemble model is built from the weight matrices of individual models, it does not have the parameters that form the bias vectors. We built 10 eADAGE and 10 corADAGE models from 1000 ADAGE models with each ensemble model built upon 100 different individual models. The individual eADAGE model used for biological analysis in this work was constructed with random seed 123, which was arbitrarily chosen before model construction and evaluation.</p>
</sec>
<sec id="s4h"><title>PCA and ICA model construction</title>
<p>We constructed PCA and ICA models and defined each model&#x2019;s weight matrix following the same procedures in (<xref ref-type="bibr" rid="c35">Tan <italic>et al</italic>, 2016b</xref>). To compare with the 300-node eADAGE, we generated models of matching size (300 components). For ICA, we evaluated 10 replicates. PCA provides a single model. PCA and ICA models were evaluated through the KEGG pathway enrichment analysis described above.</p>
</sec>
<sec id="s4i"><title>Media annotation of the <italic>P. aeruginosa</italic> compendium</title>
<p>A team of <italic>P. aeruginosa</italic> biologists annotated the media for all samples in the compendium by referring to information associated with each sample in the ArrayExpress (<xref ref-type="bibr" rid="c31">Rustici <italic>et al</italic>, 2013</xref>) and/or GEO (<xref ref-type="bibr" rid="c9">Edgar, 2002</xref>) databases and along with the original publication, if reported. Each sample was annotated by two curators separately. Conflicting annotations, if they occurred, were resolved by a third curator. The media annotation for all samples in the compendium were provided in Table EV1.</p>
</sec>
<sec id="s4j"><title>Activity calculation for a gene signature</title>
<p>We calculated a signature&#x2019;s activity for a specific sample as A &#x003D; W&#x2219; E / N, in which W is the weight vector of genes in that signature, E is a vector of genes&#x2019; expression values after zero-one normalization in that sample, and N is the number of genes. It can be viewed as an averaged weighted sum of genes&#x2019; expression levels. We normalized a signature&#x2019;s activity by the number of genes (N) in that signature, because different signatures have different number of genes.</p>
</sec>
<sec id="s4k"><title>Identification of signatures activated across media</title>
<p>We calculated an activation score to identify gene signatures with dramatically elevated or reduced activity in a specific medium. We grouped samples by their medium annotation. For each gene signature and medium combination, we calculated the difference between the mean activity of the signature for samples in that medium as well as the mean activity across the remainder of samples in the compendium. We divided this absolute difference in the means by the range of activity for all samples across the compendium. This score captures the proportion by which the mean activity in a medium differs relative to the total difference across the compendium. We termed this ratio the activation score.</p>
<p>To identify the most specifically active signatures for each medium, we constructed a table for all pairs with an activation score greater than or equal to 0.4 (Table EV5). This was highly stringent: it captured only the top 2.4&#x0025; of the potential signature-medium pairs. To identify pan-media signatures, we limited signatures to those that were active in multiple media (greater or equal to 0.4) and averaged their activation scores. These signatures exhibit parallel patterns for multiple media across multiple distinct experiments.</p>
</sec>
<sec id="s4l"><title>Definition of the PhoB regulon</title>
<p>A PhoB regulon for the PAO1 genome was adapted from the PhoB regulon of PA14 in (<xref ref-type="bibr" rid="c3">Bielecki <italic>et al</italic>, 2015</xref>) in order to be comparable to ADAGE models. Of the 187 genes in the PA14 regulon, 160 were in the PAO1 reference genome (<ext-link ext-link-type="uri" xlink:href="http://www.pseudomonas.com">www.pseudomonas.com</ext-link>).</p>
</sec>
<sec id="s4m"><title>Strains and Media</title>
<p>Strains used were WT, &#x2206;<italic>phoB</italic> (DH2633, O&#x2019;Toole lab collection), &#x2206;<italic>phoR</italic> (DH2516) and &#x2206;<italic>kinB</italic> (DH2517), all in the PA14 background. All strains were maintained on LB with 1.5&#x0025; agar and grown at 37 &#x00B0;C. For cross-media and phosphate concentration comparisons, BCIP assays (see methods below) were conducted on different base media with 1.5&#x0025; agar (Fisher): King&#x2019;s A (pancreatic digest of gelatin (Difco) 20g/L; MgCl<sub>2</sub> 1.4g/L; K<sub>2</sub>SO<sub>4</sub> 10g/L; glycerol 10ml/L) (<xref ref-type="bibr" rid="c19">King <italic>et al</italic>, 1954</xref>), LB (Tryptone (Fisher) 10g/L; Yeast Extract (Fisher) 5g/L; NaCl 5g/L) (<xref ref-type="bibr" rid="c2">Bertani, 2004</xref>), MOPS (morpholinepropanesulfonic acid 40mM; Glucose 20 ml/L; K<sub>2</sub>SO<sub>4</sub> 2.67mM; K<sub>2</sub>HPO<sub>2</sub> 0mM, 25mM or 0.1 &#x2013; 1 mM) (<xref ref-type="bibr" rid="c24">Neidhardt <italic>et al</italic>, 1974</xref>), NGM (Pancreatic digest of gelatin 2.5g/L; cholesterol 5mg/L; NaCl 3g/L; MgSO<sub>4</sub> 1mM; CaCl<sub>2</sub> 1mM; KCl 25mM; Potassium Phosphate buffer pH6 0 or 25 mM) (<xref ref-type="bibr" rid="c41">Zaborin <italic>et al</italic>, 2009</xref>), Peptone (Pancreatic digest of gelatin 10g/L; MgSO<sub>4</sub> 1.5g/L; K<sub>2</sub>SO<sub>4</sub>10g/L) (<xref ref-type="bibr" rid="c20">Lundgren <italic>et al</italic>, 2013</xref>), Pseudomonas Isolation Agar (PIA, prepared as per instructions, BioWorld).</p>
</sec>
<sec id="s4n"><title>BCIP assay</title>
<p>Various media were supplemented with 5-bromo-4-chloro-3-indolyl phosphate (BCIP) DMF solution to a final concentration of 60 &#x00B5;g/mL. BCIP assay plates were inoculated with 5 &#x00B5;l of overnight <italic>P.a</italic> culture in LB broth. Colonies were grown for 16 hours at 37 &#x00B0;C then matured at room temperature until imaging. Images were collected 16 and 32 hours post inoculation.</p>
</sec>
<sec id="s4o"><title>Screen of a histidine kinase knock out collection</title>
<p>Molecular techniques to construct the histidine kinase (HK) knock out collection were carried out as previously described (<xref ref-type="bibr" rid="c16">Ha <italic>et al</italic>, 2014</xref>). For each strain in the HK collection, a BCIP assay was performed on PIA. Plates were struck with an overnight <italic>P.a.</italic> culture concentrated two-fold by centrifugation. Plates were incubated at 37 &#x00B0;C 12-16 hours and matured at room temperature for an additional 12-16 hours alkaline phosphatase activity was determined qualitatively, based on blue color.</p>
</sec>
</sec>
</body>
<back>
<ack><title>Acknowledgements</title>
<p>This work was supported in part by a grant from the Gordon and Betty Moore Foundation (GBMF 4552) to CSG. This work was supported by National Institutes of Health (NIH) grant RO1-AI091702 to DAH. MTL is an investigator of the Howard Hughes Medical Institute. This work was supported by a pilot grant from the Cystic Fibrosis Foundation (STANTO15R0) to CSG and DAH. The authors acknowledge Gregory Way and Ren&#x00E9; Zelaya for helpful code review.</p>
</ack>
<sec><title>Author contributions</title>
<p>JT, DAH and CSG conceived and designed the research. JT, GD and KMC performed computational analyses. GD, KAL and CEP performed molecular experiments. KC, BP and MTL constructed and contributed the histidine kinase knock out collection. JT, GD, KMC, DAH and CSG wrote the manuscript, and KAL, CEP, KMC, KD, BP and MTL provided critical feedback.</p>
</sec>
<sec><title>Conflict of interest</title>
<p>The authors have no conflicts of interest to report.</p>
</sec>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Alter</surname> <given-names>O</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>PO</given-names></string-name> &#x0026; <string-name><surname>Botstein</surname> <given-names>D</given-names></string-name> (<year>2000</year>) <article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A.</source> <volume>97</volume>: <fpage>10101</fpage>&#x2013;<lpage>6</lpage></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bertani</surname> <given-names>G</given-names></string-name> (<year>2004</year>) <article-title>Lysogeny at mid-twentieth century: P1, P2, and other experimental systems</article-title>. <source>J. Bacteriol.</source> <volume>186</volume>: <fpage>595</fpage>&#x2013;<lpage>600</lpage></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bielecki</surname> <given-names>P</given-names></string-name>, <string-name><surname>Jensen</surname> <given-names>V</given-names></string-name>, <string-name><surname>Schulze</surname> <given-names>W</given-names></string-name>, <string-name><surname>Godeke</surname> <given-names>J</given-names></string-name>, <string-name><surname>Strehmel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Eckweiler</surname> <given-names>D</given-names></string-name>, <string-name><surname>Nicolai</surname> <given-names>T</given-names></string-name>, <string-name><surname>Bielecka</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wille</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gerlach</surname> <given-names>RG</given-names></string-name> &#x0026; <string-name><surname>Haussler</surname> <given-names>S</given-names></string-name> (<year>2015</year>) <article-title>Cross talk between the response regulators PhoB and TctD allows for the integration of diverse environmental signals in <italic>Pseudomonas aeruginosa</italic></article-title>. <source>Nucleic Acids Res.</source> <volume>43</volume>: <fpage>6413</fpage>&#x2013;<lpage>25</lpage></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Blus-Kadosh</surname> <given-names>I</given-names></string-name>, <string-name><surname>Zilka</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yerushalmi</surname> <given-names>G</given-names></string-name> &#x0026; <string-name><surname>Banin</surname> <given-names>E</given-names></string-name> (<year>2013</year>) <article-title>The effect of <italic>pstS</italic> and <italic>phoB</italic> on quorum sensing and swarming motility in <italic>Pseudomonas aeruginosa</italic></article-title>. <source>PLoS One</source> <volume>8</volume>: <fpage>e74444</fpage></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>L</given-names></string-name>, <string-name><surname>Xuan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Shih</surname> <given-names>I-M</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Hoffman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Clarke</surname> <given-names>R</given-names></string-name>, <string-name><surname>Devore</surname> <given-names>J</given-names></string-name>, <string-name><surname>Peck</surname> <given-names>R</given-names></string-name>, <string-name><surname>Tusher</surname> <given-names>V</given-names></string-name>, <string-name><surname>Tibshirani</surname> <given-names>R</given-names></string-name>, <string-name><surname>Chu</surname> <given-names>G</given-names></string-name>, <string-name><surname>Storey</surname> <given-names>J</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>W</given-names></string-name>, <string-name><surname>Leek</surname> <given-names>J</given-names></string-name>, <string-name><surname>Tompkins</surname> <given-names>R</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>R</given-names></string-name>, <string-name><surname>Conesa</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nueda</surname> <given-names>M</given-names></string-name>, <etal>et al</etal> (<year>2008</year>) <article-title>Knowledge-guided multi-scale independent component analysis for biomarker identification</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>416</fpage></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Damron</surname> <given-names>FH</given-names></string-name>, <string-name><surname>Barbier</surname> <given-names>M</given-names></string-name>, <string-name><surname>McKenney</surname> <given-names>ES</given-names></string-name>, <string-name><surname>Schurr</surname> <given-names>MJ</given-names></string-name> &#x0026; <string-name><surname>Goldberg</surname> <given-names>JB</given-names></string-name> (<year>2013</year>) <article-title>Genes required for and effects of alginate overproduction induced by growth of <italic>Pseudomonas aeruginosa</italic> on Pseudomonas isolation agar supplemented with ammonium metavanadate</article-title>. <source>J. Bacteriol.</source> <volume>195</volume>: <fpage>4020</fpage>&#x2013;<lpage>36</lpage></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Damron</surname> <given-names>FH</given-names></string-name>, <string-name><surname>Owings</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Okkotsu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Varga</surname> <given-names>JJ</given-names></string-name>, <string-name><surname>Schurr</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Goldberg</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Schurr</surname> <given-names>MJ</given-names></string-name> &#x0026; <string-name><surname>Yu</surname> <given-names>HD</given-names></string-name> (<year>2012</year>) <article-title>Analysis of the <italic>Pseudomonas aeruginosa</italic> regulon controlled by the sensor kinase KinB and sigma factor RpoN</article-title>. <source>J. Bacteriol.</source> <volume>194</volume>: <fpage>1317</fpage>&#x2013;<lpage>30</lpage></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Donato</surname> <given-names>M</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Tomoiaga</surname> <given-names>A</given-names></string-name>, <string-name><surname>Granneman</surname> <given-names>JG</given-names></string-name>, <string-name><surname>Mackenzie</surname> <given-names>RG</given-names></string-name>, <string-name><surname>Bao</surname> <given-names>R</given-names></string-name>, <string-name><surname>Than</surname> <given-names>NG</given-names></string-name>, <string-name><surname>Westfall</surname> <given-names>PH</given-names></string-name>, <string-name><surname>Romero</surname> <given-names>R</given-names></string-name> &#x0026; <string-name><surname>Draghici</surname> <given-names>S</given-names></string-name> (<year>2013</year>) <article-title>Analysis and correction of crosstalk effects in pathway analysis</article-title>. <source>Genome Res.</source> <volume>23</volume>: <fpage>1885</fpage>&#x2013;<lpage>93</lpage></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Edgar</surname> <given-names>R</given-names></string-name> (<year>2002</year>) <article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>. <source>Nucleic Acids Res.</source> <volume>30</volume>: <fpage>207</fpage>&#x2013;<lpage>210</lpage></mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Engreitz</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Daigle</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Marshall</surname> <given-names>JJ</given-names></string-name> &#x0026; <string-name><surname>Altman</surname> <given-names>RB</given-names></string-name> (<year>2010</year>) <article-title>Independent component analysis: mining microarray data for fundamental human gene expression modules</article-title>. <source>J. Biomed. Inform.</source> <volume>43</volume>: <fpage>932</fpage>&#x2013;<lpage>44</lpage></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Fisher</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Wanner</surname> <given-names>BL</given-names></string-name> &#x0026; <string-name><surname>Walsh</surname> <given-names>CT</given-names></string-name> (<year>1995</year>) <article-title>Cross-talk between the histidine protein kinase VanS and the response regulator PhoB. Characterization and identification of a VanS domain that inhibits activation of PhoB</article-title>. <source>J. Biol. Chem.</source> <volume>270</volume>: <fpage>23143</fpage>&#x2013;<lpage>9</lpage></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Frigyesi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Veerla</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lindgren</surname> <given-names>D</given-names></string-name>, <string-name><surname>H&#x00F6;glund</surname> <given-names>M</given-names></string-name>, <string-name><surname>Quackenbush</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jutten</surname> <given-names>C</given-names></string-name>, <string-name><surname>Herault</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chiappetta</surname> <given-names>P</given-names></string-name>, <string-name><surname>Roubaud</surname> <given-names>M</given-names></string-name>, <string-name><surname>Torr&#x00E9;sani</surname> <given-names>B</given-names></string-name>, <string-name><surname>Hyv&#x00E4;rinen</surname> <given-names>A</given-names></string-name>, <string-name><surname>Oja</surname> <given-names>E</given-names></string-name>, <string-name><surname>Liebermeister</surname> <given-names>W</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>S</given-names></string-name>, <string-name><surname>Batzoglou</surname> <given-names>S</given-names></string-name>, <string-name><surname>Martoglio</surname> <given-names>A</given-names></string-name>, <string-name><surname>Miskin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>S</given-names></string-name>, <string-name><surname>MacKay</surname> <given-names>D</given-names></string-name>, <string-name><surname>Saidi</surname> <given-names>S</given-names></string-name>, <etal>et al</etal> (<year>2006</year>) <article-title>Independent component analysis reveals new and biologically significant structures in microarray data</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>290</fpage></mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Gillis</surname> <given-names>J</given-names></string-name> &#x0026; <string-name><surname>Pavlidis</surname> <given-names>P</given-names></string-name> (<year>2013</year>) <article-title>Assessing identity, redundancy and confounds in Gene Ontology annotations over time</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>476</fpage>&#x2013;<lpage>82</lpage></mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Gong</surname> <given-names>T</given-names></string-name>, <string-name><surname>Xuan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Hoffman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Clarke</surname> <given-names>R</given-names></string-name> &#x0026; <string-name><surname>Wang</surname> <given-names>Y</given-names></string-name> (<year>2007</year>) <article-title>Gene module identification from microarray data using nonnegative independent component analysis</article-title>. <source>Gene Regul. Syst. Bio.</source> <volume>1</volume>: <fpage>349</fpage>&#x2013;<lpage>63</lpage></mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Greene</surname> <given-names>CS</given-names></string-name> &#x0026; <string-name><surname>Troyanskaya</surname> <given-names>OG</given-names></string-name> (<year>2012</year>) <article-title>Accurate evaluation and analysis of functional genomics data and methods</article-title>. <source>Ann. N. Y. Acad. Sci.</source> <volume>1260</volume>: <fpage>95</fpage>&#x2013;<lpage>100</lpage></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Ha</surname> <given-names>D-G</given-names></string-name>, <string-name><surname>Richman</surname> <given-names>ME</given-names></string-name> &#x0026; <string-name><surname>O&#x2019;Toole</surname> <given-names>GA</given-names></string-name> (<year>2014</year>) <article-title>Deletion mutant library for investigation of functional outputs of cyclic diguanylate metabolism in <italic>Pseudomonas aeruginosa</italic> PA14</article-title>. <source>Appl. Environ. Microbiol.</source> <volume>80</volume>: <fpage>3384</fpage>&#x2013;<lpage>93</lpage></mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Jiang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Oron</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Clark</surname> <given-names>WT</given-names></string-name>, <string-name><surname>Bankapur</surname> <given-names>AR</given-names></string-name>, <string-name><surname>D&#x2019;Andrea</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lepore</surname> <given-names>R</given-names></string-name>, <string-name><surname>Funk</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Kahanda</surname> <given-names>I</given-names></string-name>, <string-name><surname>Verspoor</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Ben-Hur</surname> <given-names>A</given-names></string-name>, <string-name><surname>Koo</surname> <given-names>DCE</given-names></string-name>, <string-name><surname>Penfold-Brown</surname> <given-names>D</given-names></string-name>, <string-name><surname>Shasha</surname> <given-names>D</given-names></string-name>, <string-name><surname>Youngs</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bonneau</surname> <given-names>R</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sahraeian</surname> <given-names>SME</given-names></string-name>, <string-name><surname>Martelli</surname> <given-names>PL</given-names></string-name>, <string-name><surname>Profiti</surname> <given-names>G</given-names></string-name>, <string-name><surname>Casadio</surname> <given-names>R</given-names></string-name>, <etal>et al</etal> (<year>2016</year>) <article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>. <source>Genome Biol.</source> <volume>17</volume>: <fpage>184</fpage></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Kanehisa</surname> <given-names>M</given-names></string-name> (<year>2000</year>) <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res.</source> <volume>28</volume>: <fpage>27</fpage>&#x2013;<lpage>30</lpage></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>King</surname> <given-names>EO</given-names></string-name>, <string-name><surname>Ward</surname> <given-names>MK</given-names></string-name> &#x0026; <string-name><surname>Raney</surname> <given-names>DE</given-names></string-name> (<year>1954</year>) <article-title>Two simple media for the demonstration of pyocyanin and fluorescin</article-title>. <source>J. Lab. Clin. Med.</source> <volume>44</volume>: <fpage>301</fpage>&#x2013;<lpage>7</lpage></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Lundgren</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Thornton</surname> <given-names>W</given-names></string-name>, <string-name><surname>Dornan</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Villegas-Pe&#x00F1;aranda</surname> <given-names>LR</given-names></string-name>, <string-name><surname>Boddy</surname> <given-names>CN</given-names></string-name> &#x0026; <string-name><surname>Nomura</surname> <given-names>CT</given-names></string-name> (<year>2013</year>) <article-title>Gene PA2449 is essential for glycine metabolism and pyocyanin biosynthesis in <italic>Pseudomonas aeruginosa</italic> PAO1</article-title>. <source>J. Bacteriol.</source> <volume>195</volume>: <fpage>2087</fpage>&#x2013;<lpage>100</lpage></mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Lutter</surname> <given-names>D</given-names></string-name>, <string-name><surname>Langmann</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ugocsai</surname> <given-names>P</given-names></string-name>, <string-name><surname>Moehle</surname> <given-names>C</given-names></string-name>, <string-name><surname>Seibold</surname> <given-names>E</given-names></string-name>, <string-name><surname>Splettstoesser</surname> <given-names>WD</given-names></string-name>, <string-name><surname>Gruber</surname> <given-names>P</given-names></string-name>, <string-name><surname>Lang</surname> <given-names>EW</given-names></string-name> &#x0026; <string-name><surname>Schmitz</surname> <given-names>G</given-names></string-name> (<year>2009</year>) <article-title>Analyzing time-dependent microarray data using independent component analysis derived expression modes from human macrophages infected with <italic>F. tularensis holartica</italic></article-title>. <source>J. Biomed. Inform.</source> <volume>42</volume>: <fpage>605</fpage>&#x2013;<lpage>611</lpage></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Ma</surname> <given-names>S</given-names></string-name> &#x0026; <string-name><surname>Kosorok</surname> <given-names>MR</given-names></string-name> (<year>2009</year>) <article-title>Identification of differential gene pathways with principal component analysis</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>882</fpage>&#x2013;<lpage>9</lpage></mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Monti</surname> <given-names>S</given-names></string-name>, <string-name><surname>Tamayo</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mesirov</surname> <given-names>J</given-names></string-name> &#x0026; <string-name><surname>Golub</surname> <given-names>T</given-names></string-name> (<year>2003</year>) <article-title>Consensus clustering: a resampling-based method for class discovery and visualization of gene expression microarray data</article-title>. <source>Mach. Learn.</source> <volume>52</volume>: <fpage>91</fpage>&#x2013;<lpage>118</lpage></mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Neidhardt</surname> <given-names>FC</given-names></string-name>, <string-name><surname>Bloch</surname> <given-names>PL</given-names></string-name> &#x0026; <string-name><surname>Smith</surname> <given-names>DF</given-names></string-name> (<year>1974</year>) <article-title>Culture medium for enterobacteria</article-title>. <source>J. Bacteriol.</source> <volume>119</volume>: <fpage>736</fpage>&#x2013;<lpage>47</lpage></mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Ninfa</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Ninfa</surname> <given-names>EG</given-names></string-name>, <string-name><surname>Lupas</surname> <given-names>AN</given-names></string-name>, <string-name><surname>Stock</surname> <given-names>A</given-names></string-name>, <string-name><surname>Magasanik</surname> <given-names>B</given-names></string-name> &#x0026; <string-name><surname>Stock</surname> <given-names>J</given-names></string-name> (<year>1988</year>) <article-title>Crosstalk between bacterial chemotaxis signal transduction proteins and regulators of transcription of the Ntr regulon: evidence that nitrogen assimilation and chemotaxis are controlled by a common phosphotransfer mechanism</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A.</source> <volume>85</volume>: <fpage>5492</fpage>&#x2013;<lpage>6</lpage></mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Park</surname> <given-names>H-S</given-names></string-name> &#x0026; <string-name><surname>Jun</surname> <given-names>C-H</given-names></string-name> (<year>2009</year>) <article-title>A simple and fast algorithm for K-medoids clustering</article-title>. <source>Expert Syst. Appl.</source> <volume>36</volume>: <fpage>3336</fpage>&#x2013;<lpage>3341</lpage></mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="confproc"><string-name><surname>Piotrowski</surname> <given-names>M</given-names></string-name>, <string-name><surname>Forster</surname> <given-names>T</given-names></string-name>, <string-name><surname>Dobrezelecki</surname> <given-names>B</given-names></string-name>, <string-name><surname>Sloan</surname> <given-names>TM</given-names></string-name>, <string-name><surname>Mitchell</surname> <given-names>L</given-names></string-name>, <string-name><surname>Ghazal</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mewsissen</surname> <given-names>M</given-names></string-name>, <string-name><surname>Petrou</surname> <given-names>S</given-names></string-name>, <string-name><surname>Trew</surname> <given-names>A</given-names></string-name> &#x0026; <string-name><surname>Hill</surname> <given-names>J</given-names></string-name> (<year>2011</year>) <article-title>Optimisation and parallelisation of the partitioning around medoids function in R</article-title>. In <conf-name>2011 International Conference on High Performance Computing &#x0026; Simulation</conf-name> pp <fpage>707</fpage>&#x2013;<lpage>713</lpage>. <publisher-name>IEEE</publisher-name></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Podgornaia</surname> <given-names>AI</given-names></string-name> &#x0026; <string-name><surname>Laub</surname> <given-names>MT</given-names></string-name> (<year>2013</year>) <article-title>Determinants of specificity in two-component signal transduction</article-title>. <source>Curr. Opin. Microbiol.</source> <volume>16</volume>: <fpage>156</fpage>&#x2013;<lpage>62</lpage></mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="other"><string-name><surname>Raychaudhuri</surname> <given-names>S</given-names></string-name>, <string-name><surname>Stuart</surname> <given-names>JM</given-names></string-name> &#x0026; <string-name><surname>Altman</surname> <given-names>RB</given-names></string-name> (<year>2000</year>) <article-title>Principal components analysis to summarize microarray experiments: application to sporulation time series</article-title>. <source>Pac. Symp. Biocomput.</source>: <fpage>455</fpage>&#x2013;<lpage>66</lpage></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Roden</surname> <given-names>JC</given-names></string-name>, <string-name><surname>King</surname> <given-names>BW</given-names></string-name>, <string-name><surname>Trout</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mortazavi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wold</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Hart</surname> <given-names>CE</given-names></string-name>, <string-name><surname>Tavazoie</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hughes</surname> <given-names>J</given-names></string-name>, <string-name><surname>Campbell</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cho</surname> <given-names>R</given-names></string-name>, <string-name><surname>Church</surname> <given-names>G</given-names></string-name>, <string-name><surname>Tamayo</surname> <given-names>P</given-names></string-name>, <string-name><surname>Slonim</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mesirov</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Kitareewan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dmitrovsky</surname> <given-names>E</given-names></string-name>, <string-name><surname>Lander</surname> <given-names>E</given-names></string-name>, <string-name><surname>Golub</surname> <given-names>T</given-names></string-name>, <string-name><surname>Eisen</surname> <given-names>M</given-names></string-name>, <etal>et al</etal> (<year>2006</year>) <article-title>Mining gene expression data by interpreting principal components</article-title>. <source>BMC Bioinformatics</source> <volume>7</volume>: <fpage>194</fpage></mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Rustici</surname> <given-names>G</given-names></string-name>, <string-name><surname>Kolesnikov</surname> <given-names>N</given-names></string-name>, <string-name><surname>Brandizi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Burdett</surname> <given-names>T</given-names></string-name>, <string-name><surname>Dylag</surname> <given-names>M</given-names></string-name>, <string-name><surname>Emam</surname> <given-names>I</given-names></string-name>, <string-name><surname>Farne</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hastings</surname> <given-names>E</given-names></string-name>, <string-name><surname>Ison</surname> <given-names>J</given-names></string-name>, <string-name><surname>Keays</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kurbatova</surname> <given-names>N</given-names></string-name>, <string-name><surname>Malone</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mani</surname> <given-names>R</given-names></string-name>, <string-name><surname>Mupo</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pedro Pereira</surname> <given-names>R</given-names></string-name>, <string-name><surname>Pilicheva</surname> <given-names>E</given-names></string-name>, <string-name><surname>Rung</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sharma</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tang</surname> <given-names>YA</given-names></string-name>, <string-name><surname>Ternent</surname> <given-names>T</given-names></string-name>, <etal>et al</etal> (<year>2013</year>) <article-title>ArrayExpress update-trends in database growth and links to data analysis tools</article-title>. <source>Nucleic Acids Res.</source> <volume>41</volume>: <fpage>D987</fpage>&#x2013;<lpage>90</lpage></mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Santos-Beneit</surname> <given-names>F</given-names></string-name> (<year>2015</year>) <article-title>The Pho regulon: a huge regulatory network in bacteria</article-title>. <source>Front. Microbiol</source>. <volume>6</volume>: <fpage>402</fpage></mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Schnoes</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Ream</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Thorman</surname> <given-names>AW</given-names></string-name>, <string-name><surname>Babbitt</surname> <given-names>PC</given-names></string-name> &#x0026; <string-name><surname>Friedberg</surname> <given-names>I</given-names></string-name> (<year>2013</year>) <article-title>Biases in the experimental annotations of protein function and their effect on our understanding of protein function space</article-title>. <source>PLoS Comput. Biol.</source> <volume>9</volume>: <fpage>e1003063</fpage></mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="other"><string-name><surname>Tan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Doing</surname> <given-names>G</given-names></string-name>, <string-name><surname>Lewis</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Price</surname> <given-names>CE</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Cady</surname> <given-names>KC</given-names></string-name>, <string-name><surname>Perchuk</surname> <given-names>B</given-names></string-name>, <string-name><surname>Laub</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Hogan</surname> <given-names>DA</given-names></string-name> &#x0026; <string-name><surname>Greene</surname> <given-names>CS</given-names></string-name> (<year>2016a</year>) <article-title>eADAGE-1.0.0rc1</article-title>. <source>Zenodo</source></mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Tan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hammond</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Hogan</surname> <given-names>DA</given-names></string-name> &#x0026; <string-name><surname>Greene</surname> <given-names>CS</given-names></string-name> (<year>2016b</year>) <article-title>ADAGE-Based Integration of Publicly Available <italic>Pseudomonas aeruginosa</italic> Gene Expression Data with Denoising Autoencoders Illuminates Microbe-Host Interactions</article-title>. <source>mSystems</source> <volume>1</volume>: <fpage>e00025-15</fpage></mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Tan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ung</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>C</given-names></string-name> &#x0026; <string-name><surname>Greene</surname> <given-names>CS</given-names></string-name> (<year>2015</year>) <article-title>Unsupervised feature construction and knowledge extraction from genome-wide assays of breast cancer with denoising autoencoders</article-title>. <source>Pac. Symp. Biocomput.</source> <volume>20</volume>: <fpage>132</fpage>&#x2013;<lpage>43</lpage></mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Verhamme</surname> <given-names>DT</given-names></string-name>, <string-name><surname>Arents</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Postma</surname> <given-names>PW</given-names></string-name>, <string-name><surname>Crielaard</surname> <given-names>W</given-names></string-name> &#x0026; <string-name><surname>Hellingwerf</surname> <given-names>KJ</given-names></string-name> (<year>2002</year>) <article-title>Investigation of in vivo cross-talk between key two-component systems of <italic>Escherichia coli</italic></article-title>. <source>Microbiology</source> <volume>148</volume>: <fpage>69</fpage>&#x2013;<lpage>78</lpage></mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="book"><string-name><surname>Vincent</surname> <given-names>P</given-names></string-name>, <string-name><surname>Larochelle</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bengio</surname> <given-names>Y</given-names></string-name> &#x0026; <string-name><surname>Manzagol</surname> <given-names>P-A</given-names></string-name> (<year>2008</year>) <chapter-title>Extracting and composing robust features with denoising autoencoders</chapter-title>. In <source>Proceedings of the 25th International Conference on Machine learning - ICML &#x2018;08</source> pp <fpage>1096</fpage>&#x2013;<lpage>1103</lpage>. <publisher-loc>New York, New York, USA</publisher-loc>: <publisher-name>ACM Press</publisher-name></mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Wilkerson</surname> <given-names>MD</given-names></string-name> &#x0026; <string-name><surname>Hayes</surname> <given-names>DN</given-names></string-name> (<year>2010</year>) <article-title>ConsensusClusterPlus: a class discovery tool with confidence assessments and item tracking</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1572</fpage>&#x2013;<lpage>3</lpage></mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Yu</surname> <given-names>B</given-names></string-name> (<year>2013</year>) <article-title>Stability</article-title>. <source>Bernoulli</source> <volume>19</volume>: <fpage>1484</fpage>&#x2013;<lpage>1500</lpage></mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Zaborin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Romanowski</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gerdes</surname> <given-names>S</given-names></string-name>, <string-name><surname>Holbrook</surname> <given-names>C</given-names></string-name>, <string-name><surname>Lepine</surname> <given-names>F</given-names></string-name>, <string-name><surname>Long</surname> <given-names>J</given-names></string-name>, <string-name><surname>Poroyko</surname> <given-names>V</given-names></string-name>, <string-name><surname>Diggle</surname> <given-names>SP</given-names></string-name>, <string-name><surname>Wilke</surname> <given-names>A</given-names></string-name>, <string-name><surname>Righetti</surname> <given-names>K</given-names></string-name>, <string-name><surname>Morozova</surname> <given-names>I</given-names></string-name>, <string-name><surname>Babrowski</surname> <given-names>T</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Zaborina</surname> <given-names>O</given-names></string-name> &#x0026; <string-name><surname>Alverdy</surname> <given-names>JC</given-names></string-name> (<year>2009</year>) <article-title>Red death in <italic>Caenorhabditis elegans</italic> caused by <italic>Pseudomonas aeruginosa</italic> PAO1</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A.</source> <volume>106</volume>: <fpage>6327</fpage>&#x2013;<lpage>32</lpage></mixed-citation></ref>
</ref-list>
<sec id="s5"><title>Expanded View Figure Legends</title>
<p>Figure EV1: The relationship between model size and the number of KEGG pathways a node significantly associated with. Pathways associated with positive and negative signatures of a node were added together. When model is small, one node needs to account for multiple KEGG pathways. As model size grows, more nodes become available and pathways also tend to spread into different nodes.</p>
<p>Figure EV2: Pathway coverage comparison between individual ADAGE and ensemble ADAGE after correcting pathway crosstalk effects. eADAGE models (n&#x003D;10) covers significantly more pathways than both corADAGE (n&#x003D;10) and ADAGE (n&#x003D;1000).</p>
<p>Figure EV3: The association significance of each KEGG pathway in the 300-node eADAGE models (n &#x003D; 10), 300-node corADAGE models (n&#x003D;10) and ADAGE models with different number of nodes (n &#x003D; 100 for each model size).</p>
<p>Figure EV4: The coverage rate of each KEGG pathway in 300-node ADAGE models (n&#x003D;1000) and 300-node eADAGE (n&#x003D;10) models.</p>
<p>Figure EV5: The distribution of KEGG pathway coverage rates in 300-node ADAGE models (n&#x003D;1000) and 300-node eADAGE models (n&#x003D;10). eADAGE shows a higher density in distribution on the high coverage end.</p>
<p>Figure EV6: Z-scored gene expression heatmap of genes in signature Node164pos across all samples in the compendium.</p>
</sec>
<sec id="s6"><title>Expanded View Datasets and Tables</title>
<p>Dataset EV1: <italic>Pseudomonas aeruginosa</italic> gene expression compendium. Gene expression values in each sample have been background corrected and quantile normalized.</p>
<p>Table EV1: Medium annotation for each sample in the compendium. Some medium names are abbreviated and their actual ingredients are provided in a separate sheet in the excel file.</p>
<p>Table EV2: Weight matrix of the eADAGE model highlighted in this paper. The weight matrix defines how much each gene contributes to each node.</p>
<p>Table EV3: Genes in each signature in the eADAGE model. Filtering the weight matrix provides these gene sets. Specifically, genes in a signature are those that were more than 2.5 standard deviations from the mean on the positive side, or those that were more than 2.5 standard deviations from the mean on the negative side.</p>
<p>Table EV4: The activity of each signature for each sample in the compendium. A signature has high activity when its gene weights are required to reconstruct the gene expression.</p>
<p>Table EV5: A complete list of signatures activated in one medium with activation scores higher than or equal to 0.4.</p>
<p>Table EV6: Top 5 eADAGE signatures that were active in a group of media. Each signature was annotated by its percentage of uncharacterized genes, its associated KEGG pathways, and a manual inspection of genes in the signature.</p>
<p>Table EV7: A complete list of signatures activated in a group of media.</p>
<p>Table EV8: Library of histidine kinase deletion mutants in PA14 used for a BCIP screen in PIA. All strains in the collection of PA14 histidine kinase mutants described by the number from the Hogan lab collection (DH number), the locus of the deleted gene, gene name (if available) and position in the storage plate.</p>
</sec>
</back>
</article>
