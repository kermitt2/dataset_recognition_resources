<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/116319</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Microbiology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>An Efficient Moments-Based Inference Method for Within-Host Bacterial Infection Dynamics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Price</surname>
<given-names>David J.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Breuz&#x00E9;</surname>
<given-names>Alexandre</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dybowski</surname>
<given-names>Richard</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Restif</surname>
<given-names>Olivier</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Veterinary Medicine, University of Cambridge, Madingley Road</institution>, Cambridge CB3 0ES, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>ENSTA-ParisTech</institution>, 828 Boulevard des Mar&#x00E9;chaux, 91120 Palaiseau, <country>France</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Author for correspondence: <email>or226@cam.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>116319</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>3</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="116319.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Over the last ten years, isogenic tagging (IT) has revolutionised the study of bacterial infection dynamics in laboratory animal models. However, quantitative analysis of IT data has been hindered by the piecemeal development of relevant statistical models. The most promising approach relies on stochastic Markovian models of bacterial population dynamics within and among organs. Here we present an efficient numerical method to fit such stochastic dynamic models to <italic>in vivo</italic> experimental IT data. A common approach to statistical inference with stochastic dynamic models relies on producing large numbers of simulations, but this remains a slow and inefficient method for all but simple problems. Instead, we derive and solve the systems of ordinary differential equations for the two lower-order moments of the stochastic variables (mean, variance and covariance). For any given model structure, and assuming linear dynamic rates, we demonstrate how the model parameters can be efficiently and accurately estimated by divergence minimisation. We then apply our method to an experimental dataset and compare the estimates and goodness-of-fit to those obtained by maximum likelihood estimation. This flexible framework can easily be applied to a range of experimental systems. Its computational efficiency paves the way for model comparison and optimal experimental design.</p>
<sec>
<title>List of symbols</title>
<def-list>
<def-item>
<term><italic>A</italic></term>
<def><p>number of animals</p></def>
</def-item>
<def-item>
<term><italic>T</italic></term>
<def><p>number of tagged strains</p></def>
</def-item>
<def-item>
<term><italic>n</italic></term>
<def><p>number of organs</p></def>
</def-item>
<def-item>
<term><italic>N<sub>i</sub></italic></term>
<def><p>number of bacteria in organ <italic>i</italic></p></def>
</def-item>
<def-item>
<term><italic>m<sub>ij</sub></italic></term>
<def><p>migration rate from organ <italic>i</italic> to organ <italic>j</italic></p></def>
</def-item>
<def-item>
<term><italic>k<sub>i</sub></italic></term>
<def><p>killing rate in organ <italic>i</italic></p></def>
</def-item>
<def-item>
<term><italic>r<sub>i</sub></italic></term>
<def><p>replication rate in organ <italic>i</italic></p></def>
</def-item>
<def-item>
<term><italic>&#x03C4;<sub>i</sub></italic></term>
<def><p>observation time <italic>i</italic></p></def>
</def-item>
<def-item>
<term>A, B, C</term>
<def><p>matrices</p></def>
</def-item>
<def-item>
<term>&#x03BB;</term>
<def><p>vector of transition rates</p></def>
</def-item>
<def-item>
<term><italic>B</italic></term>
<def><p>Number of bootstrap samples</p></def>
</def-item>
<def-item>
<term><italic>&#x03B8;&#x002A;</italic></term>
<def><p>MDE parameter estimate</p></def>
</def-item>
</def-list>
</sec>
<sec>
<title>Abbreviations</title>
<def-list>
<def-item>
<term>ABC</term>
<def><p>approximate Bayesian computation</p></def>
</def-item>
<def-item>
<term>IT</term>
<def><p>isogenic tagging</p></def>
</def-item>
<def-item>
<term>LV</term>
<def><p>live vaccine</p></def>
</def-item>
<def-item>
<term>MARE</term>
<def><p>mean absolute relative error</p></def>
</def-item>
<def-item>
<term>MDE</term>
<def><p>minimum divergence estimate</p></def>
</def-item>
<def-item>
<term>MLE</term>
<def><p>maximum likelihood estimate</p></def>
</def-item>
<def-item>
<term>qPCR</term>
<def><p>quantitative polymerase chain reaction</p></def>
</def-item>
<def-item>
<term>WITS</term>
<def><p>wildtype isogenic tagged strain</p></def>
</def-item>
</def-list>
</sec>
</abstract>
<counts>
<page-count count="39"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>The elucidation of basic kinetic rates governing bacterial growth during infection (such as division and death rates) has been recognised as an important challenge for over 60 years [<xref ref-type="bibr" rid="c1">1</xref>]. Thanks to recent technological developments in microbiology, and pushed by growing concern over antimicrobial resistance, the last decade has witnessed rapid progress in the quantification of <italic>in vivo</italic> dynamics of bacterial infection in animal models. Two experimental approaches in particular have shown great promise across multiple pathogen species: isogenic tagging, the focus of this report, and fluorescence dilution, aterm encompassing several techniques from which bacterial repication can be inferred [<xref ref-type="bibr" rid="c2">2</xref>]. Isogenic tagging (IT) consists in generating an arbitrary number of sub-clones of a given bacterial strain, each defined by a unique genetic tag (a predetermined nucleotide sequence) inserted in a non-coding region of the chromosome. When grown together in <italic>vitro</italic> or in <italic>vivo</italic>, every tagged strain behaves identically to the original strain. Their relative frequencies within a bacterial culture can be measured by quantitative qPCR or sequencing of the tagged region. Taken together with the absolute number of bacteria (e.g., by plating colonies), changes in the frequencies of the tags within the bacterial population can reveal underlying variations in the rates at which bacteria divide, die and disperse. For example, a constant number of bacteria accompanied by a loss of some of the tags in a closed population would indicate that a certain proportion of bacteria have died and been replaced by replication. Likewise, when monitoring tag frequencies in two or more anatomical compartments within animals, a gradual homogenisation among organs can reveal the transfer of bacteria. While some studies have stopped at qualitative interpretations of such empirical patterns [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>], it is possible to quantify underlying processes with the help of mathematical models. Two different types have been used: stochastic population dynamic models to estimate bacterial division, death and migration rates [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>], and population genetic models to estimate bottleneck sizes [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>]. Our aim is to develop efficient inference methods to deal with the former type of models.</p>
<p>Stochastic birth&#x2013;death&#x2013;migration models (a canonical class of Markovian processes [<xref ref-type="bibr" rid="c15">15</xref>]) are a common choice to analyse IT experiments, and naturally lead to likelihood&#x2013;based inference, using either maximum likelihood [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c11">11</xref>] or Bayesian estimation [<xref ref-type="bibr" rid="c12">12</xref>]. In a given experiment, assuming that all of the <italic>A</italic> animals sampled at a given time and in given conditions are identical, and that all of the <italic>T</italic> tagged strains infecting each animal act independently of each other and are governed by identical rates, we can treat the <italic>A</italic> &#x00D7; <italic>T</italic> observed strain abundances as independent realisations of a stochastic birth&#x2013;death&#x2013;migration process, and calculate the likelihood of any model of interest accordingly. In most published IT studies, bacteria can grow at different rates in different locations within an animal, and migrate from one location to another, generating a network of subpopulations (or metapopulation). This increases the dimensions of both the state variable space (as the model must keep track of the multivariate distribution of bacterial abundance) and the parameter space. Calculating the likelihood of such a model given an experimental dataset requires solving a complex stochastic model, which will rarely be possible analytically. Even a linear birth&#x2013;death process with a non&#x2013;Poisson immigration process (representing the transfer of a finite inoculum dose) is sufficient to prevent a fully analytical treatment, and results in a computationally intensive estimation process [<xref ref-type="bibr" rid="c12">12</xref>]. Alternatively, approximate-likelihood (e.g., iterative filtering [<xref ref-type="bibr" rid="c16">16</xref>]) or likelihood&#x2013;free (e.g., approximate Bayesian computation or ABC [<xref ref-type="bibr" rid="c17">17</xref>]) methods involve the generation of a large number of stochastic simulations of the model of interest, which can be equally time&#x2013;consuming, even when taking advantage of parallel computation. Although this may not be a problem when fitting a single model to a single dataset, it limits our ability to compare multiple models across complex datasets (typically involving multiple experimental treatments) and, beyond that, use these inference tools for the purpose of optimising experimental design [<xref ref-type="bibr" rid="c18">18</xref>]. Hence, there is a need for alternative inference methods using suitable approximations to achieve greater gains in computational efficiency.</p>
<p>The dynamics of multivariate Markovian processes can be approximated using moment&#x2013; closure methods [<xref ref-type="bibr" rid="c19">19</xref>]. Mathematically, a system of differential equations for the moments of the state variables can be derived analytically from the governing equation of any stochastic model [<xref ref-type="bibr" rid="c20">20</xref>]. By effectively ignoring the higher moments, a closed, small-dimension system can be derived, allowing fast numerical solution of the lower moments at any time point. Parameter estimation can then be achieved by fitting the first and second order moments of the model to the mean, variance and covariance of the corresponding variables in the data. Apart from a few proof&#x2013;of&#x2013;principle studies using simulated chemical reaction data [<xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>] that show great promise, application to statistical inference from biological data remain scarce. As a rare example, Buchholz et al. [<xref ref-type="bibr" rid="c24">24</xref>] implemented a moment-based method to solve a multiple T&#x2013;cell differentiation pathway problem, fitting the moments of a large number of alternative stochastic models to experimental data using a &#x03C7;<sup>2</sup> statistic. This suggests that efficient moment&#x2013;based inference methods should be made more readily available to unleash the full potential of stochastic models in experimental biology.</p>
<p>Our objective is to provide a functional and flexible computational framework to estimate the parameters of stochastic metapopulation models for the within&#x2013;host dynamics of infection, and demonstrate its application and value to analyse IT studies. The model tracks the probability distribution of the number of copies of a tagged strain of bacteria across a network of anatomical compartments within an animal. The goal is to estimate the bacterial division and death rates within each organ, and migration rates between each pair of compartments. First, we present an algorithm that evaluates the first two moments of the state variables for arbitrary network structures, and assess its accuracy and speed against a gold standard for stochastic models: the exact Gillespie algorithm. We then compare the accuracy of several inference options against simulated data, and finally apply the most promising method to a recent dataset on the dynamics of <italic>Salmonella enterica</italic> serovar Typhimurium in the blood, liver and spleen of vaccinated mice [<xref ref-type="bibr" rid="c11">11</xref>]. The massive gain in speed compared to likelihood-based inference allows us to use parametric bootstrap to quantify parameter uncertainty and goodness-of-fit. We also demonstrate how empirically derived noise terms (e.g., caused by imprecise data collection) can be taken into account.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Methodology</title>
<sec id="s2a">
<label>2.1</label>
<title>Biological context</title>
<p>We consider the general case of a bacterial pathogen inoculated into an animal host where it can potentially reach <italic>n</italic> anatomical compartments&#x2014;which can be distinct organs, tissues, lumens, or predefined sections thereof. All our examples are motivated by IT experiments in which a set of identical animals receive the same initial inoculum dose in one compartment (e.g., mouth, nose, blood, peritoneum, etc) at time <italic>t</italic> &#x003D; 0. The inoculum is composed of an even mix of <italic>T</italic> tagged strains. At given times <italic>&#x03C4;</italic><sub>1</sub>,<italic>&#x03C4;</italic><sub>2</sub> etc, a subset of <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, etc animals are chosen at random and euthanised. The abundance of each tagged strain in each of the <italic>n</italic> anatomical compartments of interest is measured. Thus, at a given time <italic>&#x03C4;<sub>i</sub></italic>, the data consist of a matrix D<sub>i</sub> with <italic>n</italic> rows by <italic>A<sub>i</sub>T</italic> columns, filled with observed bacterial numbers. From this matrix, we can calculate the observed moments, namely the mean and variance of strain abundance within each compartment, and the covariance between each pair of compartments.</p>
<p>Depending on the experimental procedures, these observations are usually subject to some degree of uncertainty, due to observational error. In general we assume that this error is random with a mean of zero, so that there is no systematic bias; this should be assessed by the researchers who conducted the experiments. As a result, we assume that the observed means are unbiased, but the observed (co)variances may be incorrect. In <xref ref-type="sec" rid="s2g">Section 2.7</xref>, we describe how known sources of error can be accounted for as part of the data processing procedure. In addition, there usually is some uncertainty about the actual inoculum dose received by each animal. Variations in the abundance of each strain should be assessed experimentally by testing several inoculum doses: this provides estimates for the initial mean and variance of the number of bacteria present in the target compartment at <italic>t</italic> &#x003D; 0.</p>
<p>We emphasise a few key assumptions and caveats of the present study, which we review in further detail in the Discussion. First, the variable of interest from a modelling perspective is the abundance of a single tagged strain, rather than the total bacterial load per animal (as the latter can be deduced from the former). Indeed, our model framework assumes that, over the time period considered and for a given set of initial conditions, the rates of bacterial division, death and migration per <italic>capita</italic> are independent of the total bacterial load. Second, we assume that all the bacterial cells are governed by identical probabilities of division, death and migration. While this excludes the case of so&#x2013;called persister cells (i.e., a subset of bacteria with a much lower division rate than the rest) or similar discrete partition, it is worth noting that the stochastic model we describe below does generate continuous variations in the times of events, consistent with empirical distributions of bacterial replication in vivo [<xref ref-type="bibr" rid="c25">25</xref>].</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Stochastic model framework</title>
<p>As a function of time <italic>t</italic> since inoculation, the vector of positive integer state variables <bold><italic>N</italic></bold>(<italic>t</italic>) &#x003D; &#x007B;<italic>N</italic><sub>1</sub>(<italic>t</italic>),&#x2026;, <italic>N<sub>n</sub></italic>(<italic>t</italic>)&#x007D; represents the simultaneous abundance of bacteria in compartments 1 to <italic>n</italic>. In the context of IT studies, this represents a single tagged strain. Three types of stochastic events drive the bacterial dynamics: division (which adds one bacterium to a given compartment), death (which removes one bacterium from a given compartment) and migration (which moves one bacterium from one compartment to another). Assuming linear transition rates, we have a total of <italic>n</italic> division rates <italic>&#x03C4;<sub>i</sub>N<sub>i</sub></italic> and death rates <italic>k<sub>i</sub>N<sub>i</sub></italic> within organ <italic>i</italic>, and <italic>n</italic>(<italic>n</italic> &#x2212; 1) migration rates <italic>m<sub>i</sub></italic>,<italic><sub>j</sub>N<sub>i</sub></italic> from compartment <italic>i</italic> to <italic>j</italic>. Note that specific models may assume that some of the parameters are equal to zero, for example if there is no physical connection between given pairs of compartments.</p>
<p>In particular, we consider two geometries, illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>, corresponding to two typical anatomical topologies of relevance to bacterial infection: a radial network with a central compartment (e.g., bloodstream supplying every organ), and a linear network (e.g., digestive track).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption>
<p>Diagram illustrating the two types of network structure we consider.</p>
</caption>
<graphic xlink:href="116319_fig1.tif"/>
</fig>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Computation of the first two moments</title>
<p>The method we propose for parameter inference relies on the first two moments of the stochastic system. That is, we use only the expected number of bacteria within each compartment, the variance of the number of bacteria within each compartment, and the pair-wise covariances. A simple approach to generating these moments for a particular stochastic system in terms of the model parameters, is given by [<xref ref-type="bibr" rid="c26">26</xref>]. Letting &#x03BB; &#x003D; &#x007B;<italic>r</italic><sub>1</sub><italic>N</italic><sub>1</sub>,&#x2026;,<italic>r<sub>n</sub>N<sub>n</sub></italic>, <italic>k</italic><sub>1</sub><italic>N</italic><sub>1</sub>,&#x2026;, <italic>k<sub>n</sub>N<sub>n</sub></italic>, <italic>m</italic><sub>1,2</sub><italic>N</italic><sub>1</sub>,&#x2026;&#x007D; be the vector of transition rates, we can write the <italic>h<sup>th</sup></italic> non-central moment of the state of the <italic>i<sup>th</sup></italic> compartment as:
<disp-formula id="eqn1"><alternatives><graphic xlink:href="116319_eqn1.gif"/></alternatives></disp-formula>
where <italic>&#x03D5;<sub>j</sub></italic> is a function describing the change of the state for the <italic>jth</italic> transition. In Supplementary Materials (S1.7), we show that this leads to a closed, linear system of differential equations for the first moments. Letting <bold><italic>M</italic></bold><sub>1</sub> (<italic>t</italic>) &#x003D; &#x007B;&#x1D53C; [<italic>N<sub>i</sub></italic>(<italic>t</italic>)], 1 &#x2264; <italic>i</italic> &#x2264; <italic>n</italic>&#x007D; be the vector of first moments as a function of time, we can express these differential equations in matrix form as:
<disp-formula id="eqn2"><alternatives><graphic xlink:href="116319_eqn2.gif"/></alternatives></disp-formula>
which leads to the solution,
<disp-formula id="eqn3"><alternatives><graphic xlink:href="116319_eqn3.gif"/></alternatives></disp-formula>
where <bold><italic>M</italic></bold><sub>1</sub>(0) are the initial conditions of the system, <bold>A</bold> is a time-independent matrix containing the model parameters, and <italic>exp</italic> is the matrix exponential function.</p>
<p>Next, let <bold><italic>M</italic></bold><sub>2</sub>(t) &#x003D; &#x007B;&#x1D53C; [<italic>N<sub>i</sub></italic>(<italic>t</italic>)<italic>N<sub>j</sub></italic>(<italic>t</italic>)], 1 &#x2264; <italic>i</italic> &#x2264; <italic>n</italic>, 1 &#x2264; <italic>j</italic> &#x2264; <italic>n</italic>&#x007D; be the vector of second moments. By applying Duhamel&#x2019;s formula to the differential equations obtained from <xref ref-type="disp-formula" rid="eqn1">equation (1)</xref>, we obtain the following expression for the second-order moments:
<disp-formula id="eqn4"><alternatives><graphic xlink:href="116319_eqn4.gif"/></alternatives></disp-formula>
where <bold>B</bold> and <bold>C</bold> are time-independent matrices containing model parameters, and <bold><italic>M</italic></bold><sub>1</sub>(0) and <bold><italic>M</italic></bold><sub>2</sub>(0) are vectors containing the initial moments. Using the numerical method for matrix exponential in [<xref ref-type="bibr" rid="c27">27</xref>], we can evaluate the first two moments at any time point. Remarkably, no moment-closure approach is required as the expressions for the second-order moments are independent of higher-order moments. See Supplementary Information for a full derivation.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Parameter Inference by Divergence Minimisation</title>
<p>Given a dataset consisting of one or more matrices D of bacterial counts (as per <xref ref-type="sec" rid="s2a">section 2.1</xref>), and a stochastic model (as per <xref ref-type="sec" rid="s2b">section 2.2</xref>), we now describe methods to estimate the parameter values of the model that minimise the divergence between the predicted and observed distributions of bacterial abundance, using only the lower moments of those distributions. Specifically, we evaluate the means, variances and covariances of the <italic>N<sub>i</sub></italic> variables at a given time <italic>t</italic>. From the corresponding matrix D, we calculate the vector of observed means <italic>&#x03BC;</italic><sup>(D)</sup> and the matrix of observed variance-covariance V<sup>(D)</sup>; and from the model&#x2019;s solution given a set of parameters <italic>&#x03B8;</italic>, we compute the vector of predicted means <italic>&#x03BC;<sup>(&#x03B8;)</sup></italic> and the matrix of predicted variances-covariances V<sup>(<italic>&#x03B8;</italic>)</sup> which can be derived from <bold><italic>M</italic></bold><sub>2</sub>(<italic>t</italic>). We compared four common divergence measures: a Chi-Squared metric, the Mahalanobis distance, the Hellinger distance, and the Kullback-Leibler divergence.</p>
<p>Note that none of the measures below is designed to deal with the particular situation when any of the organs is reported void of bacteria (i.e., <italic>N<sub>i</sub></italic> &#x003D; 0) in all replicates at a given time point, i.e. if all the observed moments related to that organ are equal to zero. In some experimental systems, this may be an artefact of the observation method, e.g., when counting bacteria from a small sample: in this case, it is possible to &#x201C;correct&#x201D; the data for sampling biases (see <xref ref-type="sec" rid="s2g">Section 2.7</xref>). Otherwise, a simple solution would be to remove the moments relative to that organ from the inference procedure. In some cases, it may make sense to completely remove the empty organ from the model if no meaningful inference can be expected from its inclusion, as illustrated in <xref ref-type="sec" rid="s2c">Section 3.3</xref>.</p>
<p>The Chi-Squared metric adds up the squared pairwise-differences between each predicted moment and its corresponding observed moment, each term being scaled by the magnitude of the observed moment. As a result, all moments are effectively treated equally. The expression for this divergence is:
<disp-formula id="eqn5"><alternatives><graphic xlink:href="116319_eqn5.gif"/></alternatives></disp-formula></p>
<p>The other three divergence expressions we tested make use of the fact that our chosen statistics <italic>&#x03BC;</italic> and V are moments of distributions. Since we do not establish complete characterisations of the distributions, we decided to borrow the expressions of well-known divergences measures for multivariate normal distributions, as these only require the knowledge of their first and second-order moments. In other words, we compute the divergence between two multivariate normal distributions with respective moments (<italic>&#x03BC;</italic><sup>(D)</sup>, V<sup>(D)</sup>) and (<italic>&#x03BC;</italic><sup>(<italic>&#x03B8;</italic>)</sup>, V<sup>(<italic>&#x03B8;</italic>)</sup>).</p>
<p>The Mahalanobis distance is measured between each point in the observed data, and the distribution described by the predicted moments. That is, by estimating the parameters we are trying to find the distribution that these data are most likely to have been sampled from. Specifically, each observation <italic>X</italic><sub><italic>j</italic></sub> is given by column <italic>j</italic> of the data matrix D. The divergence is obtained by summing the distances to the predicted distribution from every observation:
<disp-formula id="eqn6"><alternatives><graphic xlink:href="116319_eqn6.gif"/></alternatives></disp-formula></p>
<p>The squared Hellinger distance is given by:
<disp-formula id="eqn7"><alternatives><graphic xlink:href="116319_eqn7.gif"/></alternatives></disp-formula>
where <italic>&#x03BC;</italic>&#x003D;<italic>&#x03BC;</italic><sup>(<italic>&#x03B8;</italic>)</sup>&#x2212;<italic>&#x03BC;</italic><sup>(D)</sup> and <inline-formula><alternatives><inline-graphic xlink:href="116319_inline1.gif"/></alternatives></inline-formula>.</p>
<p>The Kullback-Leibler divergence from the predicted distribution to the observed one is given by:
<disp-formula id="eqn8"><alternatives><graphic xlink:href="116319_eqn8.gif"/></alternatives></disp-formula>
where tr(&#x00B7;) is the trace operator. The derivations of the Hellinger and Kullback-Leibler divergences are given in Supplementary Materials S1.2.</p>
<p>Even though these expressions may not provide correct estimates of the actual &#x201C;Mahalanobis distance&#x201D;, &#x201C;Hellinger distance&#x201D; and &#x201C;Kullback-Leibler divergence&#x201D; between the data and the predicted distributions (as these are not normally distributed), they still provide adequate divergence measures: they all return positive values which are only equal to zero (hence are minimised) when <italic>&#x03BC;</italic>,<sup>(<italic>&#x03B8;</italic>)</sup> &#x003D; <italic>&#x03BC;</italic>,<sup>(D)</sup> and V<sup>(<italic>&#x03B8;</italic>)</sup> &#x003D; V<sup>(D)</sup>, which occurs when the data are drawn from the predicted distribution. We used that property for the purpose of parameter inference, given a dataset and a model. The set of parameter values <italic>&#x003B8;</italic> that minimises the divergence measure is termed the &#x201C;minimum divergence estimate&#x201D; (MDE).</p>
<p>All code was written in R [<xref ref-type="bibr" rid="c28">28</xref>]. We used the UObyQA optimisation routine in the powell package [<xref ref-type="bibr" rid="c29">29</xref>].</p>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>Bootstrap Variance Estimate</title>
<p>In order to quantify the uncertainty in our parameter estimates conditional on the dynamic model considered, we utilise the parametric bootstrap method (e.g., [<xref ref-type="bibr" rid="c30">30</xref>]), which can be exploited simply here due to the computational efficiency of the inference approach. Having obtained an MDE, <italic>&#x03B8;</italic>&#x002A; for a given data matrix D and a given model, we simulate <italic>B</italic> data sets from the model at these parameters (i.e., <italic>X</italic><sup><italic>b</italic></sup>&#x007E;<italic>f</italic> (<italic>x</italic> &#x007C; <italic>&#x03B8;</italic>&#x002A;), <italic>b</italic> &#x003D; 1,&#x2026;, <italic>B</italic>). For each simulation, we estimate the corresponding parameters using the MDE technique (<italic>&#x03B8;</italic><sup><italic>b</italic></sup>, <italic>b</italic> &#x003D; 1,&#x2026;, <italic>B</italic>). These <italic>B</italic> estimated parameters are used to estimate the variance-covariance matrix of the parameter estimates. Subsequently, one can use this matrix to estimate confidence intervals in a number of ways [<xref ref-type="bibr" rid="c31">31</xref>]. For simplicity, the analysis in <xref ref-type="sec" rid="s3c">Section 3.3</xref> uses the ellipse package in R [<xref ref-type="bibr" rid="c32">32</xref>] to obtain approximate 95&#x0025; confidence intervals of the model parameters (that is, assuming the bootstrapped parameter estimates follow a multivariate normal distribution).</p>
</sec>
<sec id="s2f">
<label>2.6</label>
<title>Model Goodness-of-fit</title>
<p>In order to assess the model goodness-of-fit, we once again utilise the parametric bootstrap. Concurrent to calculating the uncertainty estimates using the MDE method, the divergences corresponding to each simulated data set at their estimated parameter values are recorded. These bootstrapped divergences can thus be used to represent the null distribution of divergences for the model at the estimated parameter values &#x2013; giving a representation of the divergences we should expect from the model at these values. The divergence estimated for the observed data is then compared to the null distribution to obtain a p-value for the hypothesis that the data could have been generated by the model.</p>
</sec>
<sec id="s2g">
<label>2.7</label>
<title>Data analysis with observational noise</title>
<p>A common source of error when fitting a model to experimental data is the observation process. In the type of microbiology experiments considered here, where the data represent bacterial loads in infected animals, there are at least two steps that affect the accuracy of the measurements: sampling (when only part of the bacterial loads are recovered) and and quantitation (the process by which the number of bacterial cells in the samples is measured). For example, in a recent IT experiment [<xref ref-type="bibr" rid="c11">11</xref>], sampling error was modelled as a binomial process (as known fractions of each homogenised organ were plated) and quantitation error was modelled using a log-normal distribution which was estimated empirically using an independent control experiment (in which known numbers of bacterial colonies were processed by qPCR in the same way as bacterial samples extracted from animals in the main experiment). Although both error distributions were centred on the true bacterial numbers (i.e. the mean numbers of bacteria were not biased), the variance and covariance in the reported data would not have been accurate estimates of the variance and covariance within the animals: hence our MDE could be biased if we did not account for observational errors.</p>
<p>In our present reanalysis of those data, we integrate both error terms before performing parameter inference, using the following procedure. Our goal is to propose a simple heuristic which could be applied to any experimental dataset with known (or assumed) observational error distributions. First, we generate a large number of stochastic simulations of the model under a biologically reasonable range of parameter values (i.e. using uniform prior distributions across sensible ranges) to generate &#x201C;perfect&#x201D; observations. We then calculate the corresponding &#x201C;perfect moments&#x201D; from every simulated dataset. Next, we apply the observation noise to the simulated data, and calculate the corresponding &#x201C;observed moments&#x201D;. We then use linear regression models to establish a relationship between each of the perfect and observed moments (with transformations where appropriate), with weights given by the simulations proximity to the actual observed moments from the experiment. This calibrated regression model is then applied to the moments of the experimental data of interest, in order to estimate the moments of the true, unobserved bacterial loads in the animals. We eventually compute MDE using these corrected moments.</p>
<p>We note that for some models of the observation process, it may be possible to establish analytic relationships between the &#x201C;perfect&#x201D; and &#x201C;observed&#x201D; moments using conditional expectation and variance theory (e.g., [<xref ref-type="bibr" rid="c33">33</xref>]). The choice of suitable correction methods for a given system will depend on both the model complexity and the level of empirical quantification of observation noise.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<p>We begin by demonstrating the speed and accuracy of the computation of the first two moments for arbitrary network structures, compared to Gillespie simulations. We then assess the four previously mentioned divergence measures to validate our minimum divergence estimation procedure with each model, across a range of parameter values. Finally, we apply our inference method to reanalyse a published experimental dataset, and compare the results with the previous maximum likelihood estimates.</p>
<sec id="s3a">
<label>3.1</label>
<title>Moment computation</title>
<p>As a proof-of-concept, we compare our proposed computation method of the means, variances and covariances of bacterial loads, with the values derived from large numbers of Gillespie simulations, across a range of model structures and parameter values. Our results illustrate the computational effort required to obtain the same level of accuracy with each method. For each model and each parameter set, we simulated 100 experiments, each consisting of 10, 50, 100, 250, 500, or 1000 observations (representing the product of the number of animals <italic>A</italic> by the number of tagged strains <italic>T</italic> as per <xref ref-type="sec" rid="s2a">section 2.1</xref>) at a given time, without observational error. The initial bacterial loads at <italic>t</italic> &#x003D; 0 in each replicate experiment were drawn at random from a Poisson distribution, to mimic typical variability in inoculum doses in experiments [<xref ref-type="bibr" rid="c11">11</xref>]. We considered three model structures, illustrated in <xref ref-type="fig" rid="fig2">Fig. 2</xref>: (a) basic migration-birth-death model, (b) four-compartment radial network, and (c) four-compartment linear network. For each virtual experiment, we calculated the first- and second-order moments of the bacterial loads in two ways at a given time point (<italic>t</italic> &#x003D; 6 for the basic migration-birth-death model, and <italic>t</italic> &#x003D; 4 for the four-compartment radial and linear network).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption>
<p>Illustrations of three representative model structures.</p>
</caption>
<graphic xlink:href="116319_fig2.tif"/>
</fig>
<p>We randomly draw the stated number of initial conditions (ranging from 10 to 1000), and evaluate the moments at the future time point in the following two ways. First, we use Gillespie simulations to progress each initial condition forward to the stated observation time, and then calculate the moments from the collection of simulations. Second, we take the stated number of initial conditions to estimate the moments at time zero, and use these to evaluate the moments at the observation time using <xref ref-type="disp-formula" rid="eqn3">equations (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>; we refer to this as the direct moment-calculation method.</p>
<p><xref ref-type="fig" rid="fig3">Figure 3</xref> shows that there is still a greater amount of variation in the moments from 1000 Gillespie simulations, compared to the direct approach. The direct method produces less variable moment estimates as experiment size increases, as a result of more accurate estimates of the initial distribution of bacteria. Furthermore, the computation time of the Gillespie approach increases steadily with the number of simulations, while the direct method is consistently more efficient, independent of the size of the experiment (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Similar patterns are shown in the Supplementary Materials (S1.3) for the four-compartment linear and and radial network model.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption>
<p>Box plots of estimated moments from 100 simulated experiments using the two-compartment birth-death-migration model (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). For each experiment (of size 10, 50, 100, 250, 500 or 1000), the lower moments of variables <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> at time <italic>t</italic> &#x003D; 6 were calculated from Gillespie simulations (red boxes) or from the moments equations (&#x201C;direct method&#x201D;, blue boxes), starting from Poisson-distributed initial conditions. The stated number of simulations per experiments is equivalent to the total number of replicate observation (<italic>A<sub>i</sub>T</italic> at time point <italic>&#x03C4;<sub>i</sub></italic> as per <xref ref-type="sec" rid="s2a">section 2.1</xref>).</p>
</caption>
<graphic xlink:href="116319_fig3.tif"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption>
<p>Box plots of computation time to evaluate the moments from 100 simulated experiments of the two-compartment birth-death-migration model, as per <xref ref-type="fig" rid="fig3">Figure 3</xref>. The vertical axis shows the logarithm in base 10 of running times in seconds.</p>
</caption>
<graphic xlink:href="116319_fig4.tif"/>
</fig>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Divergence Measures: Simulation Study</title>
<p>Next, we compared the accuracy of MDE among the four candidate divergence measures, using data simulated from the same three model structures as in the previous section and across a range of parameter values. For each model structure and each parameter combination, we ran 100 series of 100 Gillespie simulations from <italic>t</italic> &#x003D; 0 to each of 8 observation times, representing 800 experiments (each of size 100) with &#x201C;perfect&#x201D; observations of the system (i.e., without experimental noise). This process was repeated for a range of different parameter values for each model to represent different scenarios &#x2013; three representative values for each parameter in the basic model (3<sup>3</sup> &#x003D; 27 scenarios), and five randomly generated sets of parameters for the four compartment linear and radial networks with parameters. The initial conditions for each simulation, in every scenario, were randomly generated from a Poisson distribution with mean parameter 200. The optimisation routine was initiated at randomly generated conditions each time, with each parameter values drawn independently from a Uniform(0,1) distribution.</p>
<p>From the results of each simulated experiment, we computed the MDE using each of the Chi-Squared, Mahalanobis, Hellinger, and Kullback-Leibler divergences. The performance of each divergence is measured by the mean absolute relative error (MARE). That is, under scenario <italic>s</italic>, with <italic>p</italic> target parameters <italic>&#x03B8;</italic><sub><italic>s</italic></sub> &#x003D; &#x007C;(<italic>&#x03B8;</italic><sub>1<italic>s</italic></sub>, <italic>&#x03B8;</italic><sub>2<italic>s</italic></sub>,&#x2026;, <italic>&#x03B8;</italic><sub><italic>ps</italic></sub>), and estimated parameters <bold><italic>&#x03B8;&#x0302;</italic></bold><sub><italic>sj</italic></sub> &#x003D; (<italic>&#x03B8;&#x0302;</italic><sub>1<italic>sj</italic></sub>, <italic>&#x03B8;&#x0302;</italic><sub>2<italic>sj</italic></sub>,&#x2026;, <italic>&#x03B8;&#x0302;<sub>psj</sub></italic>) for the&#x007C; <italic>j<sup>th</sup></italic> simulation, the MARE is given by:
<disp-formula><alternatives><graphic xlink:href="116319_ueqn1.gif"/></alternatives></disp-formula></p>
<p><xref ref-type="fig" rid="fig5">Figure 5</xref> displays the average error across each scenario for the four divergence measures, at a range of observation times, for each of the three models under consideration. We can see that both the Hellinger and Kullback-Leibler divergence measures perform considerably better than the Chi-Squared and Mahalanobis divergences for the Basic, Linear and Radial networks. The similar performance of the Hellinger and Kullback-Leibler divergences is not unexpected, due to their relationship. We observe a marginal advantage in favour of the Kullback-Leibler divergence for the basic and radial network, and thus we use the Kullback-Leibler divergence in analysing experimental data in <xref ref-type="sec" rid="s3c">Section 3.3</xref>. The results aggregated by scenario for each model are shown in Supplementary Materials S1.4.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption>
<p>The average mean absolute relative error (MARE) across a number of observation times, for the two-compartment network (top panel), the linear four-compartment network (middle panel) and the radial four-compartment network (bottom panel). Each point is the average for that measure, at that observation time, with error bars representing the standard error.</p>
</caption>
<graphic xlink:href="116319_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption>
<p>Box plots of MDE&#x2019;s corresponding to simulated data for two different choices of parameter values (Scenario 4 and 12), at a number of different observation times (1, 4 and 8) of the simple model. The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic xlink:href="116319_fig6.tif"/>
</fig>
<p><xref ref-type="fig" rid="fig9">Figure 9</xref> further illustrates the distribution of parameter estimates for a few selected scenarios and time points. For each time point, the variation is generated by the stochastic birth-death-migration process, demonstrating the level of uncertainty in parameter estimates due to the biological process itself. In this case, each simulated experiment was made up of 100 simulations; fewer replicates would increase the parameter uncertainty.</p>
<p>At each time point, the estimates of the migration rate <italic>m</italic><sub>12</sub> are much less variable than hose of the killing rate <italic>k</italic><sub>2</sub> and replication rate <italic>r</italic><sub>2</sub>: this is actually caused by a very strong positive correlation between the latter two parameters (<xref ref-type="fig" rid="fig7">Figure 7</xref>). This can be understood intuitively, as the net growth rate <italic>r</italic><sub>2</sub> &#x2212; <italic>k</italic><sub>2</sub> is the main determinant of the mean bacterial load in compartment 2. We also remark that the earlier observation time contains more information about the clearance rate, whereas the later observation time better captures the replication and killing rates. Results of all scenarios are shown in Supplementary Materials S1.6.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption>
<p>Bivariate plot of MDE&#x2019;s corresponding to simulated data for two different choices of parameter values (Scenario 4 and 12), at a number of different observation times (1, 4 and 8) of the simple model. The points represent 100 parameter estimates of <italic>r</italic><sub>2</sub> and <italic>k</italic><sub>2</sub> corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic xlink:href="116319_fig7.tif"/>
</fig>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8:</label>
<caption>
<p>Box plots of MDE&#x2019;s corresponding to simulated data for a random set of parameter values (Scenario 4), at a number of different observation times (1, 4 and 8) of the linear model. The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic xlink:href="116319_fig8.tif"/>
</fig>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9:</label>
<caption>
<p>Box plots of MDE&#x2019;s corresponding to simulated data for a random set of parameter values (Scenario 4), at a number of different observation times (1, 4 and 8) of the radial model. The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic xlink:href="116319_fig9.tif"/>
</fig>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>Analysis of experimental data</title>
<sec id="s3c1">
<label>3.3.1</label>
<title>Description of the system</title>
<p>Finally, we perform a re-analysis of experimental data from [<xref ref-type="bibr" rid="c11">11</xref>], in which groups of mice received an intravenous dose of <italic>Salmonella enterica</italic> Typhimurium, composed of an even mixture of 8 wildtype isogenic tagged strains (WITS). Bacterial loads and WITS composition were measured in the blood, liver and spleen of 10 mice at each observation time. During the first phase of the WITS experiments (represented by the first two time points at 0.5 and 6 hours post inoculation), the only biologically relevant processes considered are: migration of bacteria from blood to liver or spleen, replication and death inside the liver and the spleen. That is, on state space <italic>S</italic> &#x003D; &#x007B;(<italic>n<sub>B</sub></italic>, <italic>n<sub>L</sub></italic>, <italic>n<sub>s</sub></italic>) &#x007C; <italic>n<sub>B</sub>, n<sub>L</sub></italic>, <italic>n<sub>S</sub></italic>&#x2265; 0&#x007D;, we have the following transition rates:
<disp-formula><alternatives><graphic xlink:href="116319_ueqn2.gif"/></alternatives></disp-formula>
where <italic>c<sub>L</sub></italic>, <italic>c<sub>S</sub></italic> are the clearance (&#x003D;migration) rates from the blood into the liver and spleen respectively, <italic>r<sub>L</sub></italic>, <italic>r<sub>S</sub></italic> are the replication rates in the liver and spleen respectively, and <italic>k<sub>L</sub></italic>, <italic>k<sub>S</sub></italic> are the killing rates in the liver and spleen, respectively.</p>
<p>One purpose of the study in [<xref ref-type="bibr" rid="c11">11</xref>] was to assess the efficacy of different vaccine strategies with regards to clearing infection. Here, we re-analyse two of the experimental groups: an untreated group (naive) who received no vaccine, and a group who received a live-vaccine (LV). In the vaccinated group, no data were observed in the blood at either of the two observation times, meaning we are unable to estimate the clearance rates and thus take an alternative approach to the initial conditions of the model. In the naive group, we estimate the effective inoculum size consistent with the observed data to estimate the loss of inoculum (that is, we estimate <italic>i<sub>0</sub></italic> &#x003D; <italic>N<sub>B</sub></italic>(0)), as well as the clearance, replication and killing rates. However, in the LV-group, as no bacteria are observed in the blood at the earliest time point, we assume that the inoculum is located directly in the liver or spleen at time zero (i.e., <italic>i<sub>L</sub></italic> &#x003D; <italic>N<sub>L</sub></italic>(0) and <italic>i<sub>s</sub></italic> &#x003D; <italic>N<sub>s</sub></italic>(0)). Hence, we estimate the effective inoculum in these two organs individually (rather than the clearance rate from the blood), as well as estimating the replication and killing rates. In each case, the inoculum size is assumed to be Poisson distributed.</p>
</sec>
<sec id="s3c2">
<label>3.3.2</label>
<title>Parameter estimation with observation noise</title>
<p>We use the MDE tool to estimate the parameters corresponding to these systems, and compare the results to the estimates obtained via the MLE approach, presented in [<xref ref-type="bibr" rid="c11">11</xref>]. Having obtained the MDE parameter estimates, we use the bootstrap approach to calculate uncertainty intervals on the estimates, and assess the model goodness-of-fit.</p>
<p>Furthermore, the observed moments of this system are subject to observation noise. In particular, only a fraction of some organs were sampled (e.g., as we are not able to fully recover the total amount of blood from an individual mouse), and there is noise introduced via the qPCR. The observed moments were adjusted using the simulation-based, pre-processing procedure described in <xref ref-type="sec" rid="s2g">Section 2.7</xref>, where it is assumed that the form of the sampling is binomial, and the qPCR noise has been previously modelled using a log-Normal distribution [<xref ref-type="bibr" rid="c11">11</xref>]. For example, for the na&#x00EF;ve group, we sampled 10,000 parameters (<italic>c<sub>L</sub></italic>,<italic>c<sub>S</sub>,k<sub>L</sub>,k<sub>S</sub>,r<sub>L</sub>,r<sub>S</sub></italic>) each independently from <italic>U</italic>[0,3], and initial inoculums <italic>i<sub>0</sub></italic> &#x007E; Poisson(30.33) (the mean WITS population calculated from plating experiments [<xref ref-type="bibr" rid="c11">11</xref>]). &#x201C;Perfect moments&#x201D; were calculated from simulations of the same size as the experimental data. The corresponding observed moments were then calculated by applying the observation noise model - binomial sampling to represent the fractional sampling of organs within each mouse, and log-Normal noise to represent the qPCR noise - to each simulation, and calculating the moments. The variances were logged for the purposes of the regression models to predict the corresponding perfect moments from those observed from the experiment.</p>
<p><xref ref-type="fig" rid="fig10">Figure 10</xref> provides a comparison of the MLE and MDE estimation procedures for the naive and LV experimental groups. The box plots represent the bootstrapped parameter estimates, with the MDE parameter estimate (blue dots), and MLE parameter estimates (red crosses). As explained in the previous section, the strong positive correlation between the replication and killing rates within each organ is shown on <xref ref-type="fig" rid="fig11">Figure 11</xref>.</p>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure">
<label>Figure 10:</label>
<caption>
<p>Left: Diagram of each model illustrating the relevant compartments, initial conditions, and rates of interest. Right: MDE parameter estimate (blue dot), MLE parameter estimate (red cross), and box plots of the bootstrapped parameter estimates.</p>
</caption>
<graphic xlink:href="116319_fig10.tif"/>
</fig>
<fig id="fig11" position="float" orientation="portrait" fig-type="figure">
<label>Figure 11:</label>
<caption>
<p>Bivariate distributions of replication and killing rates in liver and spleen, for both naive and live-vaccinated groups. Blue circles are the MDE values, with the blue (solid) ellipses representing the 95&#x0025; confidence ellipses calculated using the 1000 bootstrap samples (grey points). The red crosses are the MLE values, with red (dashed) ellipse calculated using the hessian evaluated at the MLE.</p>
</caption>
<graphic xlink:href="116319_fig11.tif"/>
</fig>
</sec>
<sec id="s3c3">
<label>3.3.3</label>
<title>Model Goodness-of-fit</title>
<p>In calculating the MDE parameter estimates for the bootstrap samples, we evaluate divergence measures for data that is known to be created by the model. Thus, the collection of these divergences provide a suitable representation of the null distribution of divergences under this model. We can simply compare the divergence for our observed data set to this null distribution in order to assess the model goodness-of-fit. <xref ref-type="fig" rid="fig12">Figure 12</xref> demonstrates the goodness-of-fit measure for the models fit to the two experimental groups.</p>
<fig id="fig12" position="float" orientation="portrait" fig-type="figure">
<label>Figure 12:</label>
<caption>
<p>Figures demonstrating the goodness-of-fit of the two models to the respective data sets. The histogram bars are the bootstrapped estimate of the null distribution of divergences under the model at the estimated parameter values for the respective model. The (blue) vertical dashed-line is the divergence corresponding to the observed data set.</p>
</caption>
<graphic xlink:href="116319_fig12.tif"/>
</fig>
<p>The approximate p-values associated with the goodness-of-fit tests for the naive and LV experimental groups are 0.002 and 0.882, respectively. This suggests that the model provides a suitable fit to the vaccinated experimental group, however, there is a non-negligible discrepancy between the model output for the naive group fit, and the observed data. This suggests that some of the assumptions in the original dynamic model may be erroneous; however, revisiting them goes beyond the scope of the present study.</p>
<p>As a further demonstration of the model goodness-of-fit, we compare the model output at each of the estimated parameter sets, to the observed data. <xref ref-type="fig" rid="fig13">Figure 13</xref> shows these simulations from each of the MDE and MLE approaches, at each of the 0.5 and 6 hour observation times, for both the naive and vaccinated experimental groups. Observational noise consistent with that in the experimental data was added to the simulated data (i.e., binomial sampling of observed counts, and log-normal noise consistent with qPCR).</p>
<fig id="fig13" position="float" orientation="portrait" fig-type="figure">
<label>Figure 13:</label>
<caption>
<p>Observed experimental data for both naive and vaccinated groups, at both observation times, compared to simulations from the model at parameters estimated by both the MLE and MDE methods, in each of the blood (B), liver (L) and spleen (S).</p>
</caption>
<graphic xlink:href="116319_fig13.tif"/>
</fig>
<p>The plots indicate that the main source of discrepancy between data and model in the naive-mice group is the distribution of bacterial loads in the blood after 6 hours.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion</title>
<p>We have described a functional and flexible moments-based method to estimate parameters of stochastic metapopulation models, and applied it to experimental data on within-host bacterial infection dynamics. Compared to simulation-based methods, our technique delivers accurate estimation orders of magnitude faster. Although simulation-based inference has grown in popularity in computational biology&#x2014;either within likelihood-free [<xref ref-type="bibr" rid="c17">17</xref>] or approximate-likelihood [<xref ref-type="bibr" rid="c16">16</xref>] approaches&#x2014; even with the increasing availability of fast, multi-core computers, algorithms can still take days to converge in multi-parameter and multi-variable problems. While this is not a major issue when fitting a single model to a single dataset, it is a hindrance for more ambitious applications: indeed there is a growing demand in biology for model selection and model-based optimal experimental design, which are much more computationally intensive tasks (e.g., [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c37">37</xref>]).</p>
<p>In its current form, our method can incorporate any linear, multivariate, continuous-time Markovian model, and fit it to experimental data that include multiple replicates and an arbitrary number of independent time points. These last two characteristics are typical of experimental biology, yet little attention has been given to systems of this form in recent statistical developments. Indeed, many inference methods for stochastic models (for example, driven by applications to epidemiology), target inference from a single time-series [<xref ref-type="bibr" rid="c38">38</xref>, <xref ref-type="bibr" rid="c16">16</xref>].</p>
<p>In addition, we have provided a worked example for how to correct for observation noise, applicable to any given experimental system. While sampling error is typically taken into account in likelihood-based inference, many inference studies either ignore experimental noise (e.g. [<xref ref-type="bibr" rid="c24">24</xref>]) or choose arbitrary distributions (e.g. [<xref ref-type="bibr" rid="c39">39</xref>]). Even if experimental error has limited impact on the mean of the observations, it will affect the variance, with implications for the precision and reliability of statistical inference. The method we demonstrated here is based on pre-processing experimental data to effect an empirical correction of the observation noise. Crucially, it is not limited by mathematical tractability when combining multiple error sources, and it does not slow down the inference computation (i.e., it only needs to be performed once before fitting the model, and the same simulations are also used to adjust the moments of the noisy-simulated data).</p>
<p>The choice of a metric to minimise for likelihood-free inference is a common issue in computational statistics, especially in the context of increasingly popular ABC methods [<xref ref-type="bibr" rid="c40">40</xref>]. When the data and the model output are summarised by multiple statistics, the default option is to use either euclidian distance or a chi-squared type variant. The latter was chosen, for example, in a recent study using moment-based inference to solve a systems-biology problem [<xref ref-type="bibr" rid="c24">24</xref>]. However, because the summary statistics of interest are the moments of statistical distributions, we hypothesised it would be more informative to use a divergence metric instead. While many divergence measures exist for the purpose of comparing mathematically defined distributions [<xref ref-type="bibr" rid="c41">41</xref>], we are not aware of standard methods to compute divergence between multivariate distributions generated by complex stochastic processes. Instead, we took a pragmatic approach and used mathematical expressions for the Hellinger distance or the Kullback-Liebler divergence between multivariate normal distributions, because these expressions depend on the first two moments of the distributions only. Even though the resulting divergence measures are not the actual Hellinger distance or Kullback-Liebler divergence between our observed and predicted distributions, they still outperform the chi-squared metric based on parameter inference accuracy. It is worth noting that, across the three model structures we tested, there was not a single metric that was consistently better than any other, and the differences in accuracy were often relatively small (<xref ref-type="fig" rid="fig5">Fig. 5</xref>). Depending on the degree of accuracy sought, it may be worth testing these and other metrics against simulations before applying this method to a different experimental system. It is our intention to provide a flexible blueprint that can be tailored to other problems, rather than a one-size-fits-all black box which may prove unreliable as soon as the circumstances change.</p>
<p>The particular molecular technology (isogenic tagging) that motivated the development of this inference method, has become pervasive in the study of within-host dynamics of bacterial infection in the last 10 years (see reviews by [<xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c43">43</xref>]). Yet, to our knowledge, this is the first attempt to provide a general modelling and inference framework that could be applied to most of these experimental systems. Indeed, previous efforts have been tailored to specific case studies [<xref ref-type="bibr" rid="c43">43</xref>, <xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c8">8</xref>] despite asking fundamentally similar questions: how fast are bacteria replicating and dying? How much migration is taking place among organs or tissues? As soon as any two of these dynamic processes are co-occurring, it is not possible to evaluate them based solely on average bacterial loads: it is necessary to obtain reliable estimates of the variance, preferably within a single animal, by quantifying a set of independent and isogenic tags. The first known example goes back 60 years, using two naturally occurring mutants of <italic>S. enterica</italic> that could be distinguished by selective growth medium to investigate colonisation dynamics in mice. Although a wide range of bacterial tagging methods (including antibiotic markers and fluorophores) have been used since, non-coding DNA barcodes have opened new prospects as arbitrarily large numbers of truly isogenic tags can be generated and quantified by sequencing [<xref ref-type="bibr" rid="c14">14</xref>]. It is our hope that the inference framework presented here will contribute to the field&#x2019;s extension by providing much needed analytical support to analyse and design microbiology experiments.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank the many microbiologists whose collaboration has helped initiate and shape this study, including Andrew Grant, Piero Mastroeni, Eric Harvill, Emma Slack, Chris Coward and Duncan Maskell. We are also grateful to fellow modellers Roland Regoes, Simon Frost, Julia Gog and Joshua Ross for their technical advice.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><surname>Meynell</surname> <given-names>G</given-names></string-name>. <article-title>Use of superinfecting phage for estimating the division rate of lysogenic bacteria in infected animals</article-title>. <source>Microbiology</source>. <year>1959</year>;<volume>21</volume>(<issue>2</issue>):<fpage>421</fpage>&#x2013;<lpage>437</lpage>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><surname>Crimmins</surname> <given-names>GT</given-names></string-name>, <string-name><surname>Isberg</surname> <given-names>RR</given-names></string-name>. <article-title>Analyzing microbial disease at high resolution: following the fate of the bacterium during infection</article-title>. <source>Current opinion in microbiology</source>. <year>2012</year>;<volume>15</volume>(<issue>1</issue>):<fpage>23</fpage>&#x2013;<lpage>27</lpage>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><surname>Barnes</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Bergman</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Mecsas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Isberg</surname> <given-names>RR</given-names></string-name>. <article-title>Yersinia pseudotuberculosis disseminates directly from a replicating bacterial pool in the intestine</article-title>. <source>Journal of Experimental Medicine</source>. <year>2006</year>;<volume>203</volume>:<fpage>1591</fpage>&#x2013;<lpage>1601</lpage>. doi:<pub-id pub-id-type="doi">10.1084/jem.20060905</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><surname>Schwartz</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Hultgren</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Seed</surname> <given-names>PC</given-names></string-name>. <article-title>Population dynamics and niche distribution of uropathogenic Escherichia coli during acute and chronic urinary tract infection</article-title>. <source>Infection and immunity</source>. <year>2011</year>;<volume>79</volume>(<issue>10</issue>):<fpage>4250</fpage>&#x2013;<lpage>4259</lpage>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><surname>Walters</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Lane</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Vigil</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>SN</given-names></string-name>, <string-name><surname>Walk</surname> <given-names>ST</given-names></string-name>, <string-name><surname>Mobley</surname> <given-names>HLT</given-names></string-name>. <article-title>Kinetics of uropathogenic &#x003C;i&#x003E;Escherichia coli&#x003C;/i&#x003E; metapopulation movement during urinary tract infection</article-title>. <source>mBio</source>. <year>2012</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>&#x2013;<lpage>11</lpage>. doi:<pub-id pub-id-type="doi">10.1128/mBio.00303-11</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>Lowe</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Ernst</surname> <given-names>SMC</given-names></string-name>, <string-name><surname>Zito</surname> <given-names>C</given-names></string-name>, <string-name><surname>Ya</surname> <given-names>J</given-names></string-name>, <string-name><surname>Glomski</surname> <given-names>IJ</given-names></string-name>. <article-title>Bacillus anthracis has two independent bottlenecks that are dependent on the portal of entry in an intranasal model of inhalational infection</article-title>. <source>Infection and Immunity</source>. <year>2013</year>;<volume>81</volume>(<issue>12</issue>):<fpage>4408</fpage>&#x2013;<lpage>4420</lpage>. doi:<pub-id pub-id-type="doi">10.1128/IAI.00484-13</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Grant</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Restif</surname> <given-names>O</given-names></string-name>, <string-name><surname>McKinley</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Sheppard</surname> <given-names>M</given-names></string-name>, <string-name><surname>Maskell</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Mastroeni</surname> <given-names>P</given-names></string-name>. <article-title>Modelling within-host spatiotemporal dynamics of invasive bacterial disease</article-title>. <source>PLoS Biology</source>. <year>2008</year>;<volume>6</volume>:<fpage>e74</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pbio.0060074</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Melton-Witt</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Rafelski</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Portnoy</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Bakardjiev</surname> <given-names>AI</given-names></string-name>. <article-title>Oral Infection with Signature-Tagged Listeria monocytogenes Reveals Organ-Specific Growth and Dissemination Routes in Guinea Pigs</article-title>. <source>Infection and Immunity</source>. <year>2012</year>;<volume>80</volume>(<issue>2</issue>):<fpage>720</fpage>&#x2013;<lpage>732</lpage>. doi:<pub-id pub-id-type="doi">10.1128/iai.05958-11</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><surname>Kaiser</surname> <given-names>P</given-names></string-name>, <string-name><surname>Slack</surname> <given-names>E</given-names></string-name>, <string-name><surname>Grant</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Hardt</surname> <given-names>WD</given-names></string-name>, <string-name><surname>Regoes</surname> <given-names>RR</given-names></string-name>. <article-title>Lymph node colonization dynamics after oral salmonella typhimurium infection in mice</article-title>. <source>PLoS pathogens</source>. <year>2013</year>;<volume>9</volume>(<issue>9</issue>):<fpage>e1003532</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1003532</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><surname>Kaiser</surname> <given-names>P</given-names></string-name>, <string-name><surname>Regoes</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Dolowschiak</surname> <given-names>T</given-names></string-name>, <string-name><surname>Wotzka</surname> <given-names>SY</given-names></string-name>, <string-name><surname>Lengefeld</surname> <given-names>J</given-names></string-name>, <string-name><surname>Slack</surname> <given-names>E</given-names></string-name>, <etal>et al.</etal> <article-title>Cecum Lymph Node Dendritic Cells Harbor Slow-Growing Bacteria Phenotypically Tolerant to Antibiotic Treatment</article-title>. <source>PLoS Biology</source>. <year>2014</year>;<volume>12</volume>(<issue>2</issue>). doi:<pub-id pub-id-type="doi">10.1371/journal.pbio.1001793</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><surname>Coward</surname> <given-names>C</given-names></string-name>, <string-name><surname>Restif</surname> <given-names>O</given-names></string-name>, <string-name><surname>Dybowski</surname> <given-names>R</given-names></string-name>, <string-name><surname>Grant</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Maskell</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Mastoeni</surname> <given-names>P</given-names></string-name>. <article-title>The Effects of Vaccination and Immunity on Bacterial Infection Dynamics In <italic>Vivo</italic></article-title>. <source>PLOS Pathogens</source>. <year>2014</year>;<volume>10</volume>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><surname>Dybowski</surname> <given-names>R</given-names></string-name>, <string-name><surname>Restif</surname> <given-names>O</given-names></string-name>, <string-name><surname>Goupy</surname> <given-names>A</given-names></string-name>, <string-name><surname>Maskell</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Mastroeni</surname> <given-names>P</given-names></string-name>, <string-name><surname>Grant</surname> <given-names>AJ</given-names></string-name>. <article-title>Single passage in mouse organs enhances the survival and spread of Salmonella enterica</article-title>. <source>Journal of the Royal Society, Interface / the Royal Society</source>. <year>2015</year>;<volume>12</volume>(<issue>113</issue>):<fpage>20150702</fpage>&#x2013;. doi:<pub-id pub-id-type="doi">10.1098/rsif.2015.0702</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Trzci&#x0144;ski</surname> <given-names>K</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>. <article-title>Within-host selection is limited by an effective population of Streptococcus pneumoniae during nasopharyngeal colonization</article-title>. <source>Infection and immunity</source>. <year>2013</year>;<volume>81</volume>(<issue>12</issue>):<fpage>4534</fpage>&#x2013;<lpage>4543</lpage>. doi:<pub-id pub-id-type="doi">10.1128/IAI.00527-13</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Abel</surname> <given-names>S</given-names></string-name>, <string-name><surname>Abel zur Wiesch</surname> <given-names>P</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>HH</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Waldor</surname> <given-names>MK</given-names></string-name>. <article-title>Sequence tag-based analysis of microbial population dynamics</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>3</issue>):<fpage>223</fpage>&#x2013;<lpage>6</lpage>, 3 p following 226. doi:<pub-id pub-id-type="doi">10.1038/nmeth.3253</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><surname>Crawford</surname> <given-names>FW</given-names></string-name>, <string-name><surname>Suchard</surname> <given-names>Ma</given-names></string-name>. <article-title>Transition probabilities for general birth-death processes with applications in ecology, genetics, and evolution</article-title>. <source>Journal of mathematical biology</source>. <year>2012</year>;<volume>65</volume>(<issue>3</issue>):<fpage>553</fpage>&#x2013;<lpage>80</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s00285-011-0471-z</pub-id>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><surname>King</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Nguyen</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ionides</surname> <given-names>EL</given-names></string-name>. <article-title>Statistical Inference for Partially Observed Markov Processes via the R Package pomp</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>59</volume>(<issue>10</issue>). doi:<pub-id pub-id-type="doi">10.18637/jss.v069.i12</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><surname>Liepe</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kirk</surname> <given-names>P</given-names></string-name>, <string-name><surname>Filippi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Toni</surname> <given-names>T</given-names></string-name>, <string-name><surname>Barnes</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Stumpf</surname> <given-names>MPH</given-names></string-name>. <article-title>A framework for parameter estimation and model selection from experimental data in systems biology using approximate Bayesian computation</article-title>. <source>Nature protocols</source>. <year>2014</year>;<volume>9</volume>(<issue>2</issue>):<fpage>439</fpage>&#x2013;<lpage>56</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nprot.2014.025</pub-id>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><surname>Ryan</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Drovandi</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Pettitt</surname> <given-names>AN</given-names></string-name>. <article-title>Optimal Bayesian Experimental Design for Models with Intractable Likelihoods Using Indirect Inference Applied to Biological Process Models</article-title>. <source>Bayesian Analysis</source>. <year>2016</year>;<volume>11</volume>(<issue>3</issue>):<fpage>857</fpage>&#x2013;<lpage>883</lpage>. doi:<pub-id pub-id-type="doi">10.1214/15-BA977</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname> <given-names>CS</given-names></string-name>. <article-title>Moment-closure approximations for mass-action models</article-title>. <source>IET Systems Biology</source>. <year>2009</year>;<volume>3</volume>(<issue>1</issue>):<fpage>52</fpage>&#x2013;<lpage>58</lpage>. doi:<pub-id pub-id-type="doi">10.1049/iet-syb:20070031</pub-id>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Sotiropoulos</surname> <given-names>V</given-names></string-name>, <string-name><surname>Kaznessis</surname> <given-names>YN</given-names></string-name>. <article-title>Analytical derivation of moment equations in stochastic chemical kinetics</article-title>. <source>Chemical Engineering Science</source>. <year>2011</year>;<volume>66</volume>(<issue>3</issue>):<fpage>268</fpage>&#x2013;<lpage>277</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ces.2010.10.024</pub-id>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><surname>Singh</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hespanha</surname> <given-names>JP</given-names></string-name>. <article-title>Approximate Moment Dynamics for Chemically Reacting Systems</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>2011</year>;<volume>56</volume>(<issue>2</issue>):<fpage>414</fpage>&#x2013;<lpage>418</lpage>. doi:<pub-id pub-id-type="doi">10.1109/TAC.2010.2088631</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><surname>Smadbeck</surname> <given-names>P</given-names></string-name>, <string-name><surname>Kaznessis</surname> <given-names>YN</given-names></string-name>. <article-title>A closure scheme for chemical master equations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>35</issue>):<fpage>14261</fpage>&#x2013;<lpage>14265</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1306481110</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><surname>Lakatos</surname> <given-names>E</given-names></string-name>, <string-name><surname>Ale</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kirk</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Stumpf</surname> <given-names>MP</given-names></string-name>. <article-title>Multivariate moment closure techniques for stochastic kinetic models</article-title>. <source>The Journal of chemical physics</source>. <year>2015</year>;<volume>143</volume>(<issue>9</issue>):<fpage>094107</fpage>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Buchholz</surname> <given-names>VR</given-names></string-name>, <string-name><surname>Flossdorf</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hensel</surname> <given-names>I</given-names></string-name>, <string-name><surname>Kretschmer</surname> <given-names>L</given-names></string-name>, <string-name><surname>Weissbrich</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gr&#x00E4;f</surname> <given-names>P</given-names></string-name>, <etal>et al.</etal> <article-title>Disparate individual fates compose robust CD8&#x002B; T cell immunity</article-title>. <source>Science</source>. <year>2013</year>;<volume>340</volume>(<issue>6132</issue>):<fpage>630</fpage>&#x2013;<lpage>635</lpage>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><surname>Claudi</surname> <given-names>B</given-names></string-name>, <string-name><surname>Spr&#x00F6;te</surname> <given-names>P</given-names></string-name>, <string-name><surname>Chirkova</surname> <given-names>A</given-names></string-name>, <string-name><surname>Personnic</surname> <given-names>N</given-names></string-name>, <string-name><surname>Zankl</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sch&#x00FC;rmann</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>Phenotypic variation of Salmonella in host tissues delays eradication by antimicrobial chemotherapy</article-title>. <source>Cell</source>. <year>2014</year>;<volume>158</volume>(<issue>4</issue>):<fpage>722</fpage>&#x2013;<lpage>733</lpage>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><surname>Singh</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hespanha</surname> <given-names>JP</given-names></string-name>. <article-title>Moment Closure Techniques for Stochastic Models in Population Biology</article-title>. <source>Proceedings of the 2006 American Control Conference</source>. <year>2006</year>;.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><string-name><surname>Van Loan</surname> <given-names>CF</given-names></string-name>. <article-title>Computing Integrals Involving the Matrix Exponential</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>1978</year>;<volume>23</volume>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="website"><collab>R Core Team</collab>. <article-title>R: A Language and Environment for Statistical Computing</article-title>; <year>2016</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="book"><string-name><surname>Powell</surname> <given-names>MJD</given-names></string-name>. <chapter-title>UOBYQA: unconstrained optimization by quadratic approximation</chapter-title>. <publisher-name>University of Cambridge</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><surname>Efron</surname> <given-names>B</given-names></string-name>, <string-name><surname>Tibshirani</surname> <given-names>R</given-names></string-name>. <article-title>Bootstrap Methods for Standard Errors, Confidence Intervals, and Other Measures of Statistical Accuracy</article-title>. <source>Statistical Science</source>. <year>1986</year>;<volume>1</volume>(<issue>1</issue>):<fpage>54</fpage>&#x2013;<lpage>75</lpage>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="website"><string-name><surname>Hall</surname> <given-names>P</given-names></string-name>. <article-title>On the Bootstrap and Likelihood-Based Confidence Regions</article-title>. <source>Biometrika</source>. <year>1987</year>;<volume>74</volume>(<issue>3</issue>):<fpage>481</fpage>&#x2013;<lpage>493</lpage>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="website"><string-name><surname>Murdoch</surname> <given-names>D</given-names></string-name>, <string-name><surname>Chow</surname> <given-names>ED</given-names></string-name>. <article-title>ellipse: Functions for drawing ellipses and ellipse-like confidence regions</article-title>; <year>2013</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package&#x003D;ellipse">https://CRAN.R-project.org/package&#x003D;ellipse</ext-link>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><string-name><surname>Casella</surname> <given-names>G</given-names></string-name>, <string-name><surname>Berger</surname> <given-names>RL</given-names></string-name>. <article-title>Statistical Inference</article-title>. <edition>2nd ed</edition>. <source>Duxbury</source>; <year>2002</year>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><string-name><surname>Busetto</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Hauser</surname> <given-names>A</given-names></string-name>, <string-name><surname>Krummenacher</surname> <given-names>G</given-names></string-name>, <string-name><surname>Sunnaker</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dimopoulos</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ong</surname> <given-names>CS</given-names></string-name>, <etal>et al.</etal> <article-title>Near-optimal experimental design for model selection in systems biology</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>20</issue>):<fpage>2625</fpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt436</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><surname>Price</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Bean</surname> <given-names>NG</given-names></string-name>, <string-name><surname>Ross</surname> <given-names>JV</given-names></string-name>, <string-name><surname>Tuke</surname> <given-names>J</given-names></string-name>. <article-title>On the efficient determination of optimal Bayesian experimental designs using ABC: A case study in optimal observation of epidemics</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2016</year>;<volume>172</volume>:<fpage>1</fpage>&#x2013;<lpage>15</lpage>. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jspi.2015.12.008">http://dx.doi.org/10.1016/j.jspi.2015.12.008</ext-link>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><string-name><surname>Overstall</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Woods</surname> <given-names>DC</given-names></string-name>. <article-title>Bayesian Design of Experiments using Approximate Coordinate Exchange</article-title>. <source>Technometrics</source>. <year>2016</year>;doi:<pub-id pub-id-type="doi">10.1080/00401706.2016.1251495</pub-id>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><string-name><surname>Ryan</surname> <given-names>EG</given-names></string-name>, <string-name><surname>Drovandi</surname> <given-names>CC</given-names></string-name>, <string-name><surname>McGree</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Pettitt</surname> <given-names>AN</given-names></string-name>. <article-title>A Review of Modern Computational Algorithms for Bayesian Optimal Design</article-title>. <source>International Statistics Review</source>. <year>2016</year>;<volume>84</volume>(<issue>1</issue>):<fpage>128</fpage>&#x2013;<lpage>154</lpage>. doi:<pub-id pub-id-type="doi">10.1111/insr.12107</pub-id>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><string-name><surname>Toni</surname> <given-names>T</given-names></string-name>, <string-name><surname>Welch</surname> <given-names>D</given-names></string-name>, <string-name><surname>Strelkowa</surname> <given-names>N</given-names></string-name>, <string-name><surname>Ipsen</surname> <given-names>A</given-names></string-name>, <string-name><surname>Stumpf</surname> <given-names>MPH</given-names></string-name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2009</year>;<volume>6</volume>(<issue>31</issue>):<fpage>187</fpage>&#x2013;<lpage>202</lpage>. doi:<pub-id pub-id-type="doi">10.1098/rsif.2008.0172</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><string-name><surname>House</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ford</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bilson</surname> <given-names>S</given-names></string-name>, <string-name><surname>Buckingham-Jeffery</surname> <given-names>E</given-names></string-name>, <string-name><surname>Girolami</surname> <given-names>M</given-names></string-name>. <article-title>Bayesian uncertainty quantification for transmissibility of influenza, norovirus and Ebola using information geometry</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2016</year>;<volume>13</volume>(<issue>121</issue>):<fpage>20160279</fpage>. doi:<pub-id pub-id-type="doi">10.1098/rsif.2016.0279</pub-id>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><string-name><surname>Sunnaker</surname> <given-names>M</given-names></string-name>, <string-name><surname>Busetto</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Numminen</surname> <given-names>E</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Foll</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dessimoz</surname> <given-names>C</given-names></string-name>. <article-title>Approximate Bayesian Computation</article-title>. <source>PLOS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>&#x2013;<lpage>10</lpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002803</pub-id>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="book"><string-name><surname>Pardo</surname> <given-names>L</given-names></string-name>. <chapter-title>Statistical inference based on divergence measures</chapter-title>. <publisher-name>CRC Press</publisher-name>; <year>2005</year>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><string-name><surname>Mastroeni</surname> <given-names>P</given-names></string-name>, <string-name><surname>Grant</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Restif</surname> <given-names>O</given-names></string-name>, <string-name><surname>Maskell</surname> <given-names>DJ</given-names></string-name>. <article-title>A dynamic view of the spread and intracellular distribution of Salmonella enterica</article-title>. <source>Nature Reviews Microbiology</source>. <year>2009</year>;<volume>7</volume>:<fpage>73</fpage>&#x2013;<lpage>80</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nrmicro2034</pub-id>.</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="journal"><string-name><surname>Abel</surname> <given-names>S</given-names></string-name>, <string-name><surname>Abel zur Wiesch</surname> <given-names>P</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Waldor</surname> <given-names>MK</given-names></string-name>. <article-title>Analysis of Bottlenecks in Experimental Models of Infection</article-title>. <source>PLoS Pathog</source>. <year>2015</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004823</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1004823</pub-id>.</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="journal"><string-name><surname>Lim</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Voedisch</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wahl</surname> <given-names>B</given-names></string-name>, <string-name><surname>Rouf</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Geffers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rhen</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <article-title>Independent Bottlenecks Characterize Colonization of Systemic Compartments and Gut Lymphoid Tissue by Salmonella</article-title>. <source>PLoS Pathog</source>. <year>2014</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e1004270</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1004270</pub-id>.</mixed-citation></ref>
</ref-list>
</back>
</article>