<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/170589</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Dynamics of Adaptive Genetic Diversity During the Early Stages of Clonal Evolution</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Blundell</surname><given-names>Jamie R.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">&#x2217;</xref>
<xref ref-type="author-notes" rid="n1">&#x2020;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Schwartz</surname><given-names>Katja</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Francois</surname><given-names>Danielle</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Fisher</surname><given-names>Daniel S.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Sherlock</surname><given-names>Gavin</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Levy</surname><given-names>Sasha F.</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">&#x2217;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Applied Physics, Stanford University</institution>, Stanford, CA 94305, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Genetics, Stanford University</institution>, Stanford, CA 94305, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biochemistry and Cellular Biology, Stony Brook University</institution>, Stony Brook, NY 11794-5215, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Laufer Center for Physical and Quantitative Biology, Stony Brook University</institution>, Stony Brook, NY 11794-5252, <country>USA</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x2217;</label>Correspondence to: <email>sasha.levy@stonybrook.edu</email>, <email>jrb75@cam.ac.uk</email></corresp>
<fn id="n1" fn-type="present-address"><label>&#x2020;</label><p>Present address: Department of Oncology, University of Cambridge</p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>170589</elocation-id>
<history>
<date date-type="received">
<day>31</day>
<month>7</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>31</day>
<month>7</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="170589.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<p>The dynamics of genetic diversity in large clonally-evolving cell populations are poorly understood, despite having implications for the treatment of cancer and microbial infections. Here, we combine barcode lineage tracking, sequencing of adaptive clones, and mathematical modelling of mutational dynamics to understand diversity changes during experimental evolution. We find that, despite differences in beneficial mutational mechanisms and fitness effects between two environments, early adaptive genetic diversity increases predictably, driven by the expansion of many single-mutant lineages. However, a crash in diversity follows, caused by highly-fit double-mutants fed from exponentially growing single-mutants, a process closely related to the classic Luria-Delbruck experiment. The diversity crash is likely to be a general feature of clonal evolution, however its timing and magnitude is stochastic and depends on the population size, the distribution of beneficial fitness effects, and patterns of epistasis.</p>
</abstract>
<counts>
<page-count count="52"/>
</counts>
</article-meta>
</front>
<body>
<p>In large clonally-evolving populations, lineages harboring beneficial &#x201C;driver&#x201D; mutations expand, compete with one another, and acquire further beneficial mutations, shaping genetic diversity [<xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c3">3</xref>]. Recent studies employing deep genomic sequencing have shown that large laboratory [<xref ref-type="bibr" rid="c4">4</xref>&#x2013;<xref ref-type="bibr" rid="c6">6</xref>] and clinical [<xref ref-type="bibr" rid="c7">7</xref>&#x2013;<xref ref-type="bibr" rid="c13">13</xref>] cell populations harbor high levels of genetic diversity that changes through time. In disease-relevant scenarios, such as cancer [<xref ref-type="bibr" rid="c7">7</xref>&#x2013;<xref ref-type="bibr" rid="c11">11</xref>] and within-host microbial dynamics [<xref ref-type="bibr" rid="c13">13</xref>], the timescale over which diversity builds up is often short, such that dominant clones only accumulate a handful of driver mutations. When the supply of driver mutations is low, evolution is characterized by successive selective sweeps, wherein a single adaptive lineage periodically purges genetic diversity [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>]. However, when the supply of driver mutations is high, evolution is characterized by clonal interference, with multiple adaptive lineages expanding and competing through time [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c16">16</xref>&#x2013;<xref ref-type="bibr" rid="c19">19</xref>]. In the clonal interference regime, mutations often rise and fall together in cohorts [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c20">20</xref>]. However, due to the limited ability to detect low frequency mutations via genomic sequencing, it remains unclear what controls diversity changes through time in this regime, whether large purges of diversity might also occur as in the case of a selective sweep, and whether these diversity crashes are predictable across replicates and environments [<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>To address these questions, we introduced &#x007E;500,000 unique DNA barcodes into <italic>S. cerevisiae</italic> [<xref ref-type="bibr" rid="c22">22</xref>] and evolved populations of &#x007E;5 &#x00D7; 10<sup>8</sup> cells in triplicate for 304 generations under two well-mixed nutrient-limited environments: nitrogen-limitation (N-lim) and carbon-limitation (C-lim). Lineage abundances were tracked by barcode sequencing every &#x007E;8-24 generations. Lineages that harbor adaptive mutations were identified by finding those trajectories that deviate from a neutral expectation [<xref ref-type="bibr" rid="c22">22</xref>]. Tracking all adaptive lineages through time reveals the changing levels of adaptive lineage diversity (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Initially, adaptive diversity expands, driven by thousands of independent mutations. This expansion is quantitatively different between environments; in N-lim, the expansion is slower and fewer lineages reach high frequencies. Later however, similarities between environments emerge: a handful of lineages begin to dominate the population, causing a crash in adaptive lineage diversity.</p>
<fig id="fig1" position="float" fig-type="figure"><label>Figure 1.</label>
<caption><p>&#x201C;Muller&#x201D; plots of adaptive lineages. The cell number of all adaptive lineages (colors) inferred from barcode sequencing (arrows) and whole genome sequencing of picked clones (large arrowheads) of replicate evolutions in carbon-limited (A and B) and nitrogen-limited media (C and D). Colors are for visualization purposes only, and do not represent lineages harbouring specific mutations.</p></caption>
<graphic xlink:href="170589_fig1.tif"/>
</fig>
<p>We suspected that differences in lineage diversity dynamics between the two environments could be attributed, in part, to differences in the <underline>m</underline>utational <underline>D</underline>istribution of <underline>F</underline>itnesses <underline>E</underline>ffects (mDFE), defined as the distribution of mutation rates over fitness effects for single beneficial mutations arising on the ancestor. We have previously shown that high-resolution lineage tracking over short times can be used to infer the mDFE [<xref ref-type="bibr" rid="c22">22</xref>]. In C-lim, the mDFE results in &#x007E;10<sup>4</sup> beneficial mutations with fitness effects (s) above 3&#x0025; entering the population over the first &#x007E;100 generations. This initially produces a quasi-deterministic expansion in diversity because the low fitness effect beneficial mutations that dominate early occur at a high rate. Later, the diversity expansion becomes more stochastic because the high fitness effect beneficial mutations that dominate during this time occur at a lower rate (i.e. the effective beneficial mutation rate decreases, SM2.1). To test whether these features might generalize to other environments we inferred the mDFE for N-lim (SM1). We find that the shape of the mDFE in N-lim is qualitatively different from that in C-lim (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Most strikingly, the rates of mutation to higher fitness effects (s&#x003E;5&#x0025;) are &#x007E;3-fold lower in N-lim, and fall off rapidly, resulting in no detectable fitness effects above 8&#x0025;. With time, the lineage dynamics become exponentially more sensitive to these differences at the higher fitness effects (expanded region <xref ref-type="fig" rid="fig2">Figure 2</xref> and SM2). In C-lim, these mutations establish (escaping stochastic loss), expand, and compete over shorter timescales (<xref ref-type="fig" rid="fig1">Figure 1 A</xref> vs. C). In N-lim, the lower rate of mutation to higher fitness effects results in even more stochastic dynamics: the highly fit mutations occur in smaller numbers, causing larger variations between replicates (<xref ref-type="fig" rid="fig1">Figure 1 C</xref> vs. D, SM2.1).</p>
<fig id="fig2" position="float" fig-type="figure"><label>Figure 2.</label>
<caption><p>Using barcode-directed whole-genome sequencing of adaptive clones to find the mutational targets underlying the distribution of beneficial fitness effects (mDFE) in (A) carbon- and (B) nitrogen-limitation. Most adaptive events are diploidizations (top, light blue), but high fitness effects are caused by mutations in or near genes (below, color key). Each fitness bin is colored according the to the estimated rate of mutation of verified single-mutants to each gene in that bin (SM3.3). The color key is roughly ordered from lowest to highest fitness effect of a mutational event. Pie charts indicate the mutational mechanisms of adaptive mutations.</p></caption>
<graphic xlink:href="170589_fig2.tif"/>
</fig>
<p>To verify that single beneficial mutations are the determinants of the early diversity dynamics, we used barcode-directed whole-genome sequencing to identify hundreds of unique adaptive mutations that span a wide range of fitness effects. In C-lim, we previously found a near-comprehensive spectrum of adaptation-driving single-mutations by sequencing 418 adaptive clones isolated from generation 88 [<xref ref-type="bibr" rid="c23">23</xref>]. Here, we repeated this for N-lim, sequencing 291 adaptive clones picked from generation 192 and re-measuring fitness (SM3.2). In both environments, the majority of sequenced adaptive clones contain a single adaptive mutation (&#x003E;75&#x0025;), consistent with single-mutants being the determinants of early diversity dynamics. Lineages containing two adaptive mutations are crucial to the later-time diversity dynamics and we return to these below. Focusing on single-mutant clones, we find major differences in mutational mechanisms and the mutational targets of adaptation (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Surprisingly, Ty transposition events play a major role in driving adaptation in N-lim but not C-lim. In both environments, adaptation is driven first by cells that undergo a frequent diploidization (Dip) event, and later by cells that acquire mutations in a small set of nutrient sensing pathway genes (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and [<xref ref-type="bibr" rid="c16">16</xref>]. The majority of these recurrently mutated genes are putative loss-of-function (LoF) mutations, with a minority being putative gain-of-function (GoF) mutations (SM3.4). Additionally, there are a significant number of adaptive mutations in singly mutated genes that do not appear to function in nutrient sensing pathways, suggesting cells have many pathways to increase fitness in N-lim (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p>
<p>In each evolution, we observed a lineage diversity crash whereby a handful of lineages outcompete all others (<xref ref-type="fig" rid="fig1">Figure 1</xref>). One possibility is that multiple adaptive clones within each lineage contribute to a lineage&#x2019;s dominance. Alternatively, a single large clone within each lineage may be primarily responsible for this dominance. However, it is unclear how such large clones would arise. To investigate these questions, we simulated the diversity dynamics using the mDFE inferred in each environment, removing any lineages which were found to contain two adaptive mutations occurring in the same cell (double-mutants), and tracked both the lineage and clone diversity (SM4). To make comparisons of genetic diversity across a large number of simulations, we plot the Shannon entropy [<xref ref-type="bibr" rid="c24">24</xref>] of adaptive lineages and clones through time, which track one another closely until the time at which triple- and quadruple-mutant clones first expand within barcoded lineages (SM2.5). Simulations accounting only for the stochastic occurrence of, and competition between, single-mutants (single mutant model) predict that diversity should crash slowly, at odds with observations (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). We therefore reasoned that the diversity crash is caused by the emergence of double-mutants. To test this, we modified our simulations to allow for multiple-mutants drawn from the single-mutant mDFE and whose fitness effects combine additively (additive model, <xref ref-type="fig" rid="fig3">Figure 3B</xref>). Additive model simulations produce diversity crashes that are caused by a handful of lineages that each contain a single dominant double-mutant clone (typically &#x003C;5 lineages are &#x003E;90&#x0025; of the population at times beyond 150 generations, SM4).</p>
<fig id="fig3" position="float" fig-type="figure"><label>Figure 3.</label>
<caption><p>Exponential feeding of double mutants causes a diversity crash. (A-C) Shannon entropy of adaptive lineages from replicate experiments in carbon-limitation (black lines) and stochastic simulations (grey lines) using a single-mutant model (A), additive model (B), or epistasis model (C). The entropy of adaptive clones (not shown) closely tracks the entropy of adaptive lineages (<italic>SM 2.5</italic>). (D,E) Muller plots from <xref ref-type="fig" rid="fig1">Figure 1</xref> recolored to depict single-mutant (grey) and early double-mutant (green and blue) adaptive lineages in (D) carbon- and (E) nitrogen-limitation. (F) Schematic showing the statistical behavior of the ancestor (grey), first (red), and second (blue) mutants. Grey arrows show the relative growth rates due to selection.</p></caption>
<graphic xlink:href="170589_fig3.tif"/>
</fig>
<p>To understand why a handful of large double-mutant clones cause a diversity crash we considered a model of the mutation acquisition process (SM2) and [<xref ref-type="bibr" rid="c17">17</xref>]. Single-mutants establish in large numbers because the product of the population size (N &#x003D; 5 &#x00D7; 10<sup>8</sup>) and the effective beneficial mutation rate (U<sub>b</sub>&#x003E;&#x007E;10<sup>&#x2212;7</sup>, see SM2.1) is large (NU<sub>b</sub>&#x003E;50). However, since the probability of two mutations occurring concurrently is small (NU<sub arrange="stack">b</sub><sup arrange="stack">2</sup>&#x003C;&#x003C;1), double mutants must enter stochastically on the background of exponentially growing single-mutants. By considering when an expanding single-mutant clone will typically give rise to a double-mutant (following similar arguments presented in [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c17">17</xref>]), we find that the distribution of sizes (n) of double-mutant clones is a power law &#x007E;1/n<sup>(2&#x002B;&#x0394;)/(1&#x002B;&#x0394;)</sup>, where &#x0394; is the fitness effect of the second mutation over the fitness effect of the first mutation (s<sub>2</sub>/s<sub>1</sub>). If double-mutants are no fitter than single-mutants (&#x0394;&#x003D;0), this collapses to the classic Luria-Delbruck distribution of clone sizes, &#x007E;1/n<sup>2</sup> [<xref ref-type="bibr" rid="c25">25</xref>], whereby many double-mutant cells belong to a large number of small clones. However, when double-mutants are significantly fitter than single-mutants (&#x0394;&#x003E;1), most double-mutant cells belong to a handful of large clones (SM2). In this second case, a few lucky double-mutants with the earliest occurrence times go on to dominate the population, but stochasticity in their occurrence times results in variability in the timing and depth of the diversity crash between replicates (<xref ref-type="fig" rid="fig3">Figure 3F</xref>, SM4).</p>
<p>To validate that a handful of double-mutants cause the diversity crashes observed in our experiments, we examined the trajectories of lineages containing a confirmed double-mutant and verified that they do indeed go on to dominate (data in <xref ref-type="fig" rid="fig3">Figure 3D &#x0026; E</xref>). Surprisingly, however, the sequencing of clones revealed that dominant double-mutants were not composed of two high fitness effect mutations (e.g. LoF&#x002B;LoF) as would be predicted by our additive model simulations (SM4). Instead, dominant clones that were sequenced were Dip&#x002B;GoF double-mutants (Dip&#x002B;<italic>ras2</italic> in C1; Dip&#x002B;<italic>mep1</italic> in N1), despite neither GoF mutation occurring at a high rate. We reasoned that this could be caused by epistasis: some classes of beneficial mutations combine non-additively and these interactions must play a crucial role in determining which mutations go on to dominate. To test this, we modified our additive model simulations (above) to ban second mutations that are implausible or unobserved (Dip&#x002B;Dip, Dip&#x002B;LoF, LoF&#x002B;LoF, or LoF&#x002B;GoF, SM4). Simulations using this &#x201C;epistasis model&#x201D; produce diversity crashes and lineage trajectories that are more consistent with observations (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Importantly, the epistasis model predicts that clones driving the diversity crash will usually be Dip&#x002B;GoF, if the crash is deep, and LoF&#x002B;Dip if the crash is shallow.</p>
<p>Lineage trajectories alone have limited power to distinguish between the additive and epistasis models (<xref ref-type="fig" rid="fig3">Figures 3B &#x0026; C</xref>). To further test our models, we therefore asked if the dynamics of mutations, rather than lineages, are consistent with predictions of either model. We measured the abundance of diploids in the population every 8-24 generations using a colony-growth assay (SM6) and [<xref ref-type="bibr" rid="c23">23</xref>], not only for the 4 evolutions described above, but for two additional evolutions (1 in C-lim, 1 in N-lim) not characterized by lineage tracking (<xref ref-type="fig" rid="fig4">Figure 4B-E</xref>). Consistent with our observations, both models predict that replicate diploid trajectories will track each other closely, first, as large numbers of ancestral cells diploidize and expand, and second, as diploids begin to be out-competed by haploids that have acquired fitter LoF and GoF mutations. At later times, however, the models deviate. In C-lim, the additive model predicts that LoF&#x002B;LoF or LoF&#x002B;GoF double-mutants drive the continuing decline of diploids (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In N-lim, the additive model predicts that Dip&#x002B;LoF mutations should expand fast enough that diploid trajectories never dip (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). However, consistent with observations, the epistasis model predicts that the diploid trajectory will dip and subsequently recover, driven by LoF and GoF haploids that diploidize and by diploids that acquire GoF mutations (<xref ref-type="fig" rid="fig4">Figures 4C &#x0026; E</xref>). Since this diploid recovery is driven by rare double-mutants, its timing and depth are predicted to be highly stochastic, resulting in large variations between replicates, in agreement with our data. In cases where diploids recover early (e.g. C1, N1 and N3), our model correctly predicts that the recovery is likely driven by Dip&#x002B;GoF double-mutants, largely because this event has the highest &#x0394; value (SM2).</p>
<fig id="fig4" position="float" fig-type="figure"><label>Figure 4.</label>
<caption><p>Simulations of diploid dynamics using the additive and epistasis models. (A) The simplified fitness landscape used for simulations in C-lim, where u(s) indicates the mutation rates and s indicates the fitness effects to Diploidy (Dip), Loss-of-Function (LoF), and Gain-of-Function (GoF) mutations. Greyed arrows are paths disallowed by the epistasis model. Dashed lines indicate the paths taken by the dominant clones in the additive (blue) epistasis models (red). (C-E) The diploid trajectories in C-lim and N-lim predicted by the additive model (B and D, respectively) and the epistasis model (C and E, respectively) compared to the measured diploid trajectories (data points) from the three replicate populations in each condition. Color scale indicates the extent to which the diploid rescue is driven by Dip&#x002B;GoF (purple) vs. LoF&#x002B;Dip or Dip&#x002B;LoF (yellow) mutants, with early rescue being more likely to be driven by Dip&#x002B;GoF mutations.</p></caption>
<graphic xlink:href="170589_fig4.tif"/>
</fig>
<p>We have shown that the genetic diversity in our experiments first increases quasi-deterministically, caused by a large number of single-mutants, and later crashes stochastically, caused by competition from a handful of highly-fit double-mutants that occur anomalously early. While the expansion rate and the timing and depth of the crash are influenced by the population size, the mDFE, and the pattern of epistasis between adaptive mutations, they are likely to be general features of clonal evolution. In environments such as our experiments where the mDFE lacks extremely high fitness effect mutations, mutations that cause the diversity expansion are being fed from a large, effectively-constant population, while mutations that cause the crash are being fed from a small, exponentially-growing population. In environments where extremely high fitness effect mutations are possible, such as in the presence of a growth-inhibiting drug [<xref ref-type="bibr" rid="c26">26</xref>], a diversity expansion and crash will still occur, but the crash will sometimes be driven by the expansion of a highly fit single-mutant (SM2.6 and SM2.7). That is, a diversity crash is likely to occur, whether driven by a well-described selective sweep of a single mutant [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>] or by a multiple mutant that occurs anomalously early. While we have focused on well-mixed populations, a qualitatively similar phenomenon has been described during the expansion of spatially structured populations [<xref ref-type="bibr" rid="c27">27</xref>]. More generally, our work highlights that while genetic diversity evolves in a highly stochastic way and depends on rare events, the statistics of these processes provide a means by which to forecast evolution [<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>While in our experiments the deterministic to stochastic transition occurs between first and second mutations, in small populations (NU<sub>b</sub>&#x003C;1), first adaptive mutations are stochastic, and diversity crashes (of neutral mutations) will occur at nearly every adaptive event. In even larger populations (NU<sub arrange="stack">b</sub><sup arrange="stack">2</sup>/s&#x003E; 1 &#x003E;NU<sub arrange="stack">b</sub><sup arrange="stack">3</sup>/s<sup>2</sup>), double-mutants will occur deterministically, but triple-mutants stochastically, and therefore the diversity crash will be caused by a few triple-mutants. More generally, for mDFEs that lack a small supply of relatively large fitness effects (whose dynamics can be characterized by a single &#x201C;predominant fitness class&#x201D; [<xref ref-type="bibr" rid="c17">17</xref>]), the diversity crash will be driven by clones harbouring <italic>k</italic> beneficial mutations, where <italic>k</italic> is the smallest integer for which Ns(U<sub>b</sub>/s)<sup>k</sup>&#x003C;1, a parameter which also controls the steady-state range of fitnesses present in an adapting population [<xref ref-type="bibr" rid="c17">17</xref>]. Previous work has found that &#x201C;beneficial cohorts&#x201D;, multiple beneficial mutations co-occurring in clones that are at frequencies below the detection limit of whole-genome or whole-exome sequencing, commonly drive laboratory [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c20">20</xref>] and clinical [<xref ref-type="bibr" rid="c11">11</xref>] clonal evolution. Our results suggest that, at least during the early stages of clonal evolution, these cohorts are expected, with cohort size being determined by <italic>k</italic> (SM2). Furthermore, theoretical work predicts that beneficial cohorts and fluctuations in genetic diversity should occur throughout evolution, driven by the stochastic occurrence of anomalously early and/or fit multiple-mutants [<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>]. Experimental validation of these predictions, however, will likely require the development of double-barcoding technologies [<xref ref-type="bibr" rid="c30">30</xref>] or barcodes that continuously generate diversity through time [<xref ref-type="bibr" rid="c31">31</xref>&#x2013;<xref ref-type="bibr" rid="c33">33</xref>].</p>
<sec id="s1"><title>Methods</title>
<sec id="s1a"><title>Experimental evolutions</title>
<p>Details of strain construction, media and equipment used in the evolutions can be found in the supplementary information of Levy et. al. [<xref ref-type="bibr" rid="c14">14</xref>].</p></sec>
<sec id="s1b"><title>Barcode sequencing</title>
<p>Details of the DNA preps, PCR reactions and sequencing protocols can be found in the supplementary information of Levy et. al. [<xref ref-type="bibr" rid="c14">14</xref>] for the Carbon condition. Further relevant details for the Nitrogen condition can be found in <xref ref-type="sec" rid="s2a">Section 1.1</xref> and <xref ref-type="sec" rid="s2b">1.2</xref> of the supplementary information accompanying this manuscript.</p></sec>
<sec id="s1c"><title>Identifying adaptive lineages</title>
<p>Adaptive lineages were identified using the same methods and code as outlined in the supplementary information of Levy et. al. [<xref ref-type="bibr" rid="c14">14</xref>]</p></sec>
<sec id="s1d"><title>Isolating and Sequencing of adaptive clones</title>
<p>All clones, including those from the Nitrogen conditions, were isolated and sequenced following the protocol outlined in detail in the &#x201C;Star methods&#x201D; section of Venkataram et. al. [<xref ref-type="bibr" rid="c16">16</xref>]. For further details of the sequencing of the Nitrogen clones we refer the reader also to <xref ref-type="sec" rid="s4a">Sections 3.1</xref> and <xref ref-type="sec" rid="s4b">3.2</xref> of the supplementary information accompanying this manuscript.</p></sec>
<sec id="s1e"><title>Simulated lineage dynamics</title>
<p>Details of the simulations can be found in <xref ref-type="sec" rid="s3">Sections 2</xref> and <xref ref-type="sec" rid="s5">4</xref> of the supplementary information accompanying this manuscript.</p>
</sec>
</sec>
</body>
<back>
<ack><title>Acknowledgements</title>
<p>We wish to thank all members of the Levy, Sherlock and Fisher labs for useful discussions and comments. J.R.B. is supported NSF PHY-1545840, Stand Up 2 Cancer and by the Louis and Beatrice Laufer Center; D.S.F. by NSF PHY-1305433, NSF PHY-1545840, Stand Up 2 Cancer and NIH R01 HG003328; G.S by NIH grants R01 HG003328 and GM110275; and S.F.L by NIH grant R01 HG008354 and by the Louis and Beatrice Laufer Center. All data available on request.</p></ack>
<ref-list><title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Desai</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Walczak</surname>, <given-names>A. M.</given-names></string-name> &#x0026; <string-name><surname>Fisher</surname>, <given-names>D. S.</given-names></string-name> <article-title>Genetic Diversity and the Structure of Genealogies in Rapidly Adapting Populations</article-title>. <source>Genetics</source> <volume>193</volume>, <fpage>565</fpage>&#x2013;<lpage>585</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Neher</surname>, <given-names>R. A.</given-names></string-name> &#x0026; <string-name><surname>Hallatschek</surname>, <given-names>O.</given-names></string-name> <article-title>Genealogies of rapidly adapting populations</article-title>. <source>PNAS</source> <volume>110</volume>, <fpage>437</fpage>&#x2013;<lpage>442</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Nowell</surname>, <given-names>P. C.</given-names></string-name> <article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source> <volume>194</volume>, <fpage>23</fpage>&#x2013;<lpage>28</lpage> (<year>1976</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Tenaillon</surname>, <given-names>O.</given-names></string-name> <etal>et al.</etal> <article-title>Tempo and mode of genome evolution in a 50,000-generation experiment</article-title>. <source>Nature</source> <volume>536</volume>, <fpage>165</fpage>&#x2013;<lpage>170</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Lang</surname>, <given-names>G. I.</given-names></string-name> <etal>et al.</etal> <article-title>Pervasive genetic hitchhiking and clonal interference in forty evolving yeast populations</article-title>. <source>Nature</source> <volume>500</volume>, <fpage>571</fpage>&#x2013;<lpage>574</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Baym</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Spatiotemporal microbial evolution on antibiotic landscapes</article-title>. <source>Science</source> <volume>353</volume>, <fpage>1147</fpage>&#x2013;<lpage>1151</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Lawrence</surname>, <given-names>M. S.</given-names></string-name> <etal>et al.</etal> <article-title>Mutational heterogeneity in cancer and the search for new cancer-associated genes</article-title>. <source>Nature</source> <volume>499</volume>, <fpage>214</fpage>&#x2013;<lpage>218</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Landau</surname>, <given-names>D. A.</given-names></string-name> <etal>et al.</etal> <article-title>Mutations driving CLL and their evolution in progression and relapse</article-title>. <source>Nature</source> <volume>526</volume>, <fpage>525</fpage>&#x2013;<lpage>530</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Gerlinger</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Intratumor Heterogeneity and Branched Evolution Revealed by Multiregion Sequencing</article-title>. <source>New England Journal of Medicine</source> <volume>366</volume>, <fpage>883</fpage>&#x2013;<lpage>892</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Jan</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Clonal Evolution of Preleukemic Hematopoietic Stem Cells Precedes Human Acute Myeloid Leukemia</article-title>. <source>Science Translational Medicine</source> <volume>4</volume>, <fpage>149ra118</fpage>&#x2013;<lpage>149ra118</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Nik-Zainal</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>The Life History of 21 Breast Cancers</article-title>. <source>Cell</source> <volume>149</volume>, <fpage>994</fpage>&#x2013;<lpage>1007</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Neher</surname>, <given-names>R. A.</given-names></string-name>, <string-name><surname>Russell</surname>, <given-names>C. A.</given-names></string-name> &#x0026; <string-name><surname>Shraiman</surname>, <given-names>B. I.</given-names></string-name> <article-title>Predicting evolution from the shape of genealogical trees</article-title>. <source>eLife</source> <volume>3</volume>, (<year>2014</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Didelot</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Walker</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>Peto</surname>, <given-names>T. E.</given-names></string-name>, <string-name><surname>Crook</surname>, <given-names>D. W.</given-names></string-name> &#x0026; <string-name><surname>Wilson</surname>, <given-names>D. J.</given-names></string-name> <article-title>Within-host evolution of bacterial pathogens</article-title>. <source>Nat Rev Micro</source> <volume>14</volume>, <fpage>150</fpage>&#x2013;<lpage>162</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>J. M.</given-names></string-name> &#x0026; <string-name><surname>Haigh</surname>, <given-names>J.</given-names></string-name> <article-title>The hitch-hiking effect of a favourable gene</article-title>. <source>Genetics Research</source> <volume>23</volume>, <fpage>23</fpage>&#x2013;<lpage>35</lpage> (<year>1974</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Messer</surname>, <given-names>P. W.</given-names></string-name> &#x0026; <string-name><surname>Neher</surname>, <given-names>R. A.</given-names></string-name> <article-title>Estimating the Strength of Selective Sweeps from Deep Population Diversity Data</article-title>. <source>Genetics</source> <volume>191</volume>, <fpage>593</fpage>&#x2013;<lpage>605</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Gerrish</surname>, <given-names>P. J.</given-names></string-name> &#x0026; <string-name><surname>Lenski</surname>, <given-names>R. E.</given-names></string-name> <article-title>The fate of competing beneficial mutations in an asexual population</article-title>. <source>Genetica</source> <volume>102&#x2013;103</volume>, <fpage>127</fpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Desai</surname>, <given-names>M. M.</given-names></string-name> &#x0026; <string-name><surname>Fisher</surname>, <given-names>D. S.</given-names></string-name> <article-title>Beneficial Mutation&#x2013;Selection Balance and the Effect of Linkage on Positive Selection</article-title>. <source>Genetics</source> <volume>176</volume>, <fpage>1759</fpage>&#x2013;<lpage>1798</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Kao</surname>, <given-names>K. C.</given-names></string-name> &#x0026; <string-name><surname>Sherlock</surname>, <given-names>G.</given-names></string-name> <article-title>Molecular characterization of clonal interference during adaptive evolution in asexual populations of Saccharomyces cerevisiae</article-title>. <source>Nat Genet</source> <volume>40</volume>, <fpage>1499</fpage>&#x2013;<lpage>1504</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Good</surname>, <given-names>B. H.</given-names></string-name>, <string-name><surname>Rouzine</surname>, <given-names>I. M.</given-names></string-name>, <string-name><surname>Balick</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Hallatschek</surname>, <given-names>O.</given-names></string-name> &#x0026; <string-name><surname>Desai</surname>, <given-names>M. M.</given-names></string-name> <article-title>Distribution of fixed beneficial mutations and the rate of adaptation in asexual populations</article-title>. <source>PNAS</source> <volume>109</volume>, <fpage>4950</fpage>&#x2013;<lpage>4955</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Buskirk</surname>, <given-names>S. W.</given-names></string-name>, <string-name><surname>Peace</surname>, <given-names>R. E.</given-names></string-name> &#x0026; <string-name><surname>Lang</surname>, <given-names>G. I.</given-names></string-name> <article-title>Hitchhiking and epistasis give rise to cohort dynamics in adapting populations</article-title>. <source>bioRxiv</source> <fpage>106732</fpage> (<year>2017</year>). doi:<pub-id pub-id-type="doi">10.1101/106732</pub-id></mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>L&#x00E4;ssig</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mustonen</surname>, <given-names>V.</given-names></string-name> &#x0026; <string-name><surname>Walczak</surname>, <given-names>A. M.</given-names></string-name> <article-title>Predicting evolution</article-title>. <source>Nature Ecology &#x0026; Evolution</source> <volume>1</volume>, <fpage>77</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Levy</surname>, <given-names>S. F.</given-names></string-name> <etal>et al.</etal> <article-title>Quantitative evolutionary dynamics using high-resolution lineage tracking</article-title>. <source>Nature</source> <volume>519</volume>, <fpage>181</fpage>&#x2013;<lpage>186</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Venkataram</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Development of a Comprehensive Genotype-to-Fitness Map of Adaptation-Driving Mutations in Yeast</article-title>. <source>Cell</source> <volume>166</volume>, <fpage>1585</fpage>&#x2013;<lpage>1596.e22</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Jost</surname>, <given-names>L.</given-names></string-name> <article-title>Entropy and diversity</article-title>. <source>Oikos</source> <volume>113</volume>, <fpage>363</fpage>&#x2013;<lpage>375</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Luria</surname>, <given-names>S. E.</given-names></string-name> &#x0026; <string-name><surname>Delbr&#x00FC;ck</surname>, <given-names>M.</given-names></string-name> <article-title>Mutations of Bacteria from Virus Sensitivity to Virus Resistance</article-title>. <source>Genetics</source> <volume>28</volume>, <fpage>491</fpage>&#x2013;<lpage>511</lpage> (<year>1943</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Hughes</surname>, <given-names>D.</given-names></string-name> &#x0026; <string-name><surname>Andersson</surname>, <given-names>D. I.</given-names></string-name> <article-title>Evolutionary consequences of drug resistance: shared principles across diverse targets and organisms</article-title>. <source>Nat Rev Genet</source> <volume>16</volume>, <fpage>459</fpage>&#x2013;<lpage>471</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Fusco</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Gralka</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kayser</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Anderson</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Hallatschek</surname>, <given-names>O.</given-names></string-name> <article-title>Excess of mutational jackpot events in expanding populations revealed by spatial Luria&#x2013;Delbr&#x00FC;ck experiments</article-title>. <source>Nature Communications</source> <volume>7</volume>, <fpage>12760</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Fisher</surname>, <given-names>D. S.</given-names></string-name> <article-title>Asexual evolution waves: fluctuations and universality</article-title>. <source>J. Stat. Mech.</source> <volume>2013</volume>, <fpage>P01011</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Park</surname>, <given-names>S.-C.</given-names></string-name> &#x0026; <string-name><surname>Krug</surname>, <given-names>J.</given-names></string-name> <article-title>Clonal interference in large populations</article-title>. <source>PNAS</source> <volume>104</volume>, <fpage>18135</fpage>&#x2013;<lpage>18140</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Jaffe</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sherlock</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Levy</surname>, <given-names>S. F.</given-names></string-name> <article-title>iSeq: A New Double-Barcode Method for Detecting Dynamic Genetic Interactions in Yeast</article-title>. <source>G3: Genes, Genomes, Genetics</source> <volume>7</volume>, <fpage>143</fpage>&#x2013;<lpage>153</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>McKenna</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Whole-organism lineage tracing by combinatorial and cumulative genome editing</article-title>. <source>Science</source> <volume>353</volume>, <fpage>aaf7907</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Perli</surname>, <given-names>S. D.</given-names></string-name>, <string-name><surname>Cui</surname>, <given-names>C. H.</given-names></string-name> &#x0026; <string-name><surname>Lu</surname>, <given-names>T. K.</given-names></string-name> <article-title>Continuous genetic recording with self-targeting CRISPR-Cas in human cells</article-title>. <source>Science</source> <volume>353</volume>, <fpage>aag0511</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Shipman</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Nivala</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Macklis</surname>, <given-names>J. D.</given-names></string-name> &#x0026; <string-name><surname>Church</surname>, <given-names>G. M.</given-names></string-name> <article-title>Molecular recordings by directed CRISPR spacer acquisition</article-title>. <source>Science</source> <volume>353</volume>, <fpage>aaf1175</fpage> (<year>2016</year>).</mixed-citation></ref>
</ref-list>
<sec sec-type="supplementary-material"><title>SUPPLEMENTARY MATERIALS</title>
<sec id="s2"><label>1</label><title>N-lim experiment and DFE</title>
<sec id="s2a"><label>1.1</label><title>Media used for N-lim condition</title>
<p>The barcoded yeast library from [<xref ref-type="bibr" rid="sc1">1</xref>], containing &#x223C;500,000 barcodes, was evolved by serial batch culture under nitrogen limitation in 100 ml of 5x Delft media [<xref ref-type="bibr" rid="sc2">2</xref>] with 0.04&#x0025; ammonium sulfate and 4&#x0025; dextrose. Cells were grown in 500 ml Delong flasks (Bellco) at 30&#x00B0; C and 223 RPM for 48 hours between each bottleneck. Bottlenecks were performed by adding 400 <italic>&#x03BC;</italic>l of the evolution to fresh media. Cell counts were performed at each bottleneck to estimate the generation time. Contamination checks for bacteria or other non-yeast microbes were performed regularly. Barcode sequencing and counting was performed, as described [<xref ref-type="bibr" rid="sc1">1</xref>].</p>
</sec>
<sec id="s2b"><label>1.2</label><title>Inferring the DFE in N-lim</title>
<sec id="s2b1"><title>Here we outline how we infer the DFE in N-lim and compare its features with those measured previously in C-lim</title>
<p>To construct the DFE in N-lim we followed the procedure outlined in detail in [<xref ref-type="bibr" rid="sc1">1</xref>]. Because adaptation is slower in N-lim we used trajectories for &#x223C;200 generations with read depths given in the following table:</p>
<table-wrap id="tbl1" orientation="portrait" position="float"><label>Table 1:</label>
<caption><p>Read depths across time points for the two replicate evolutions in nitrogen limitation (N-lim). Only these time points are used in the analysis.</p></caption>
<graphic xlink:href="170589_tbl1.tif"/>
</table-wrap>
<p>To identify lineages with beneficial mutations, using the same null model as outlined in [<xref ref-type="bibr" rid="sc1">1</xref>], each barcode trajectory was assigned a posterior probability of harboring an established beneficial mutation with fitness effect <italic>s</italic> and establishment time <bold>&#x03C4;</bold> based on its abundance change between subsequent time points. Lineage trajectories in both N-lim replicates (N1 and N2) are shown in <xref ref-type="fig" rid="fig5">Figure 1</xref> alongside the original C-lim trajectories (C1 and C2) (previously published in [<xref ref-type="bibr" rid="sc1">1</xref>]) for comparison. The more rapid adaptation observed in C-lim relative to N-lim can be quantified by plotting the mean-fitness trajectory (mean fitness of cells in the population relative to the ancestor), shown in the right-hand panel of <xref ref-type="fig" rid="fig5">Figure 1</xref>. These mean fitness trajectories are inferred using the fitness estimates and interpolated trajectories for each adaptive lineage identified in each environment.</p>
<fig id="fig5" position="float" fig-type="figure"><label>Figure 1:</label>
<caption><p>(Left) Lineage trajectories from each of the four replicates (C1, C2 performed in C-lim and N1, N2 performed in N-lim) for which lineage tracking was performed colored by probability of containing an adaptive mutation. (Right) The mean fitness of cells in each experiment over time relative to the wild-type. Replicates within the same environment are consistent with one another although do show some variation, particularly at later times, due to the stochastic occurrence time of mutations [<xref ref-type="bibr" rid="sc1">1</xref>]. Shaded region indicates approximate error on the mean fitness inference.</p></caption>
<graphic xlink:href="170589_fig5.tif"/>
</fig>
<p>To infer the DFE in N-lim, we first filtered out adaptive lineages that were identified as adaptive in both replicates (purple points in <xref ref-type="fig" rid="fig6">Figure 2</xref>) as these were likely pre-existing mutations that arose prior to the beginning of the experimental evolutions [<xref ref-type="bibr" rid="sc1">1</xref>]. <xref ref-type="fig" rid="fig6">Figure 2</xref> shows all beneficial mutations identified as adaptive colored according to whether they are pre-existing (purple) or not (green) in both N-lim replicates and, for comparison, the previously published C-lim replicates.</p>
<fig id="fig6" position="float" fig-type="figure"><label>Figure 2:</label>
<caption><p>Expansion of lineages can be used to estimate the fitness effect <italic>s</italic> (y-axis) and establishment time, <italic>&#x03C4;</italic>, (x-axis) of all detectable single beneficial mutations that enter the population. Each circle is an independently occurring mutation, the size indicates its abundance in the population at generation 88. Color indicates whether it entered prior to the separation of the replicates (purple, &#x201C;pre-existing&#x201D;) or after the separation (green, &#x201C;not pre-existing&#x201D;). The top panel is from previously published data in [<xref ref-type="bibr" rid="sc1">1</xref>] and is shown here for comparison.</p></caption>
<graphic xlink:href="170589_fig6.tif"/>
</fig>
<p>Next we used the estimates of <italic>s</italic> inferred for each adaptive lineage together with the deterministic approximation outlined in [<xref ref-type="bibr" rid="sc1">1</xref>] (that relates the mutation rate density <italic>&#x03BC;</italic>(<italic>s</italic>) to fitness effects in the range [<italic>s</italic>, <italic>s</italic> &#x002B; <italic>ds</italic>] to the measured fraction <italic>f</italic>(<italic>ds</italic>, <italic>t</italic>) of cells in the population expanding at rates between [<italic>s</italic>, <italic>s</italic> &#x002B; <italic>ds</italic>] at time <italic>t</italic>) to estimate the rate of mutation to each fitness interval via:
<disp-formula id="eqn1"><alternatives><graphic xlink:href="170589_eqn1.gif"/></alternatives></disp-formula>
which is independent of the variance in offspring number [<xref ref-type="bibr" rid="sc1">1</xref>]. The result of this procedure gives one an estimate for the mutation rate density as a function of fitness effect as shown here in <xref ref-type="fig" rid="fig7">Figure 3</xref> and also in the main text <xref ref-type="fig" rid="fig6">Figure 2</xref>. The lower two panels are inferences for the N-lim replicates while the upper two panels show previously published DFE estimates for the two C-lim replicates. It should be noted that the y-axes is log-scaled to enable visualizing the shape of the high-fitness nose of the DFE which is critical in determining the dynamics (see <xref ref-type="sec" rid="s3">Section 2</xref>).</p>
<fig id="fig7" position="float" fig-type="figure"><label>Figure 3:</label>
<caption><p>The distribution of fitness effects of all detected single beneficial mutations arising in each of the four replicates. Rates to each fitness effect are inferred by counting the number of cells in a given fitness range over time and using a deterministic approximation to infer <italic>&#x03BC;</italic>(<italic>s</italic>) (see [<xref ref-type="bibr" rid="sc1">1</xref>]).</p></caption>
<graphic xlink:href="170589_fig7.tif"/>
</fig>
</sec>
</sec>
</sec>
<sec id="s3"><label>2</label><title>The DFE and population size determine early lineage- and genotype-size statistics</title>
<p>Here we outline how the DFE influences the size statistics of single-mutants and, subsequently, multiple-mutants and how these together with neutral drift affect lineage sizes through time. We show that single-mutants determine the diversity over short timescales but multiple-mutants determine the diversity over longer times scales. We outline that the entropy of all adaptive genotypes in the population undergoes an expansion followed by a crash. This expansion and crash can be measured by tracking the entropy of adaptive lineages.</p>
<sec id="s3a"><label>2.1</label><title>Distribution of single-mutant sizes over time and effective <italic>U<sub>b</sub></italic></title>
<p>The arguments in this section follow similar arguments presented in the supplemental methods of [<xref ref-type="bibr" rid="sc1">1</xref>] and [<xref ref-type="bibr" rid="sc3">3</xref>]. Consider a mutation at a given site in the genome <italic>i</italic> with fitness advantage <italic>s</italic>, which occurs at a constant rate <italic>R<sub>i</sub></italic> &#x003D; <italic>NU<sub>i</sub></italic> from a pool of <italic>N</italic> ancestral feeding cells. The total number of single-mutant cells with this mutation is the convolution of the single mutant size distribution (see [<xref ref-type="bibr" rid="sc1">1</xref>]) with the distribution of times at which the mutations enter (uniform). This yields a distribution of rescaled clone sizes <italic>&#x03BD;</italic> &#x003D; <italic>n</italic>/<italic>&#x00F1;</italic> &#x003D; <italic>n</italic>/((<italic>c</italic>/<italic>s</italic>)<italic>e<sup>st</sup></italic>):
<disp-formula id="eqn2"><alternatives><graphic xlink:href="170589_eqn2.gif"/></alternatives></disp-formula></p>
<p>The rate of mutating a given site is <italic>&#x03BC;</italic> &#x2248; 3 &#x00D7; 10<sup>&#x2212;10</sup> per bp per generation [<xref ref-type="bibr" rid="sc1">1</xref>] hence <italic>R<sub>i</sub></italic> &#x226A; 1 and the distribution of sizes of unique SNPs is approximately <italic>NUe<sup>&#x2212;&#x03BD;</sup></italic>/<italic>&#x03BD;</italic> with the largest single-mutants being those that arose immediately reaching sizes <italic>n</italic> &#x223C; (<italic>c</italic>/<italic>s</italic>)<italic>e<sup>st</sup></italic> and the smallest being those that arose in the previous generation and that are of size &#x223C; 1.</p>
<p>In general there are a range of possible <italic>s</italic> with different mutation rates <italic>&#x03BC;</italic>(<italic>s</italic>) hence the distribution of single-mutant abundances is obtained by summing all of these:
<disp-formula id="eqn3"><alternatives><graphic xlink:href="170589_eqn3.gif"/></alternatives></disp-formula></p>
<p>Thus the exact form of the single-mutant distribution will depend on the shape of <italic>&#x03BC;</italic>(<italic>s</italic>) and in general will not retain the characteristic 1/<italic>n</italic> form even at low frequencies unless <italic>&#x03BC;</italic>(<italic>s</italic>) is sharply peaked over a narrow range.</p>
<sec id="s3a1"><title>Note on clonal interference</title>
<p>The above expression assumes no competition between lineages. This is a good approximation at early times, but for times after the single-mutant class has reached a significant fraction of the entire population clonal interference cannot be ignored. In the simplest model however, clonal interference &#x2014; which results from the total population size of cells having to remain &#x2248; <italic>N</italic> &#x2014; is captured by considering a genotype&#x2019;s fitness advantage over the (increasing) meanfitness of the population, <italic>&#x0078;&#x0304;</italic>(<italic>t</italic>). Thus, while the previous expression will still accurately capture relative frequencies of mutants, the absolute numbers of the different genotypes will be modified by a factor
<disp-formula id="eqn4"><alternatives><graphic xlink:href="170589_eqn4.gif"/></alternatives></disp-formula></p>
<p>Consider now an entire class of mutations with a given fitness effect range <italic>s</italic>, <italic>s</italic> &#x002B; <italic>ds</italic> rather than a specific mutation. The mutation rates to this range of fitness effects is given by <italic>&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic>. Provided the population size <italic>N&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic> &#x226B; 1, (true for the majority of the range we consider, but see below for when this does not hold) single mutants occur in large numbers for a given fitness range (since <italic>N&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic> &#x003D; <italic>R</italic> &#x226B; 1) and therefore, as a class, behave quasi-deterministically. The fraction of single-mutant cells in a given fitness range <italic>f</italic>(<italic>s</italic>)<italic>ds</italic> is simply
<disp-formula id="eqn5"><alternatives><graphic xlink:href="170589_eqn5.gif"/></alternatives></disp-formula></p>
<p>Since the timescale over which mutations with fitness effects <italic>s</italic> will contribute is 1/<italic>s</italic> and the number establishing per generation is <italic>N&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic>, the number of mutations contributing significantly to the genetic diversity in each fitness class is of order <italic>N&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic>. The small lineage size ensures that the majority of single-mutants will occur inside independent lineages, hence the number of lineages that expand at a rate between <italic>s</italic>, <italic>s</italic> &#x002B; <italic>ds</italic> is also <italic>N&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic>.</p></sec>
<sec id="s3a2"><title>Effective fitness effects and effective mutation rates</title>
<p>For times <italic>st</italic> &#x003E; 1, the differences in fitness effects between mutations enable some lineages to expand more relative to others. The range of fitness effects dominating all adaptive cells are those for whom <italic>f</italic>(<italic>s</italic>)<italic>ds</italic> &#x003D; <italic>&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic>(<italic>e<sup>st</sup></italic> &#x2013; 1)/<italic>s</italic> is maximized, which corresponds to fitness classes in the region of <italic>&#x0073;&#x0303;</italic>, where
<disp-formula id="eqn6"><alternatives><graphic xlink:href="170589_eqn6.gif"/></alternatives></disp-formula>
the region having a width <italic>&#x03B4;&#x0073;&#x0303;</italic> is given by <inline-formula><alternatives><inline-graphic xlink:href="170589_inline1.gif"/></alternatives></inline-formula> evaluated at <italic>&#x0073;&#x0303;</italic>. Mutations in the fitness range [<italic>&#x0073;&#x0303;</italic>(<italic>t</italic>), <italic>&#x0073;&#x0303;</italic>(<italic>t</italic>) &#x002B; <italic>&#x03B4;&#x0073;&#x0303;</italic>(<italic>t</italic>)] dominate the population at <italic>t</italic> and hence they can be considered an effective <italic>s</italic>. Similarly, the rate of mutation to these fitness effects <italic>&#x0055;&#x0303;<sub>b</sub></italic> &#x003D; <italic>&#x03BC;</italic>(<italic>&#x0073;&#x0303;</italic>(<italic>t</italic>))<italic>&#x03B4;&#x0073;&#x0303;</italic>(<italic>t</italic>) can be considered an effective mutation rate. Together these can be used to determine the number of expanding unique single-mutants contributing to the diversity at time <italic>t</italic>:
<disp-formula id="eqn7"><alternatives><graphic xlink:href="170589_eqn7.gif"/></alternatives></disp-formula></p></sec>
<sec id="s3a3"><title>Stochastic occurrence of highly fit single mutants</title>
<p>The fitness of the predominant fitness class <italic>&#x0073;&#x0303;</italic> typically increases over time because the size of each fitness class has an exponential weighting <italic>e<sup>st</sup></italic>. Since <italic>&#x03BC;</italic>(<italic>s</italic>) in both environments we analyze decreases with increasing <italic>s</italic>, this results in a smaller <italic>&#x0055;&#x0303;<sub>b</sub></italic> at later times. This has important consequences for stochasticity. The single mutant genetic diversity is determined by an exponential expansion of types, but where the number of types is ever decreasing (see &#x201C;top-hat&#x201D; DFE example). For late enough times, the predominant fitness class <italic>&#x0073;&#x0303;</italic>(<italic>t</italic>) with associated width <italic>&#x03B4;&#x0073;&#x0303;</italic>(<italic>t</italic>) has an associated mutation rate <italic>&#x0055;&#x0303;<sub>b</sub></italic>(<italic>t</italic>) &#x003D; <italic>&#x03BC;</italic>(<italic>&#x0073;&#x0303;</italic>(<italic>t</italic>))<italic>&#x03B4;&#x0073;&#x0303;</italic>(<italic>t</italic>), which can be small enough that <italic>N&#x0055;&#x0303;<sub>b</sub></italic>(<italic>t</italic>) &#x2272; 1. At this point, the number of mutations contributing to the adaptive single-mutant population becomes small since the population is dominated by the small number of high fitness clones. This results in lower genetic diversity and increased stochasticity. At times <italic>&#x0074;&#x0303;</italic> &#x2248; (1/<italic>&#x0073;&#x0303;</italic>)In (<italic>&#x0073;&#x0303;</italic>/<italic>&#x0055;&#x0303;<sub>b</sub></italic>) single-mutants comprise a significant fraction of all cells. Around this time they begin to interfere with one another, slowing their exponential expansion. The predictions resulting from considering a &#x201C;predominant&#x201D; class are checked in the section exploring the dynamics that result from a &#x201C;top-hat&#x201D; DFE.</p>
</sec>
</sec>
<sec id="s3b"><label>2.2</label><title>Distribution of multiple-mutant sizes over time</title>
<p>Here we calculate the distribution of sizes of multiple-mutant clones, which are fed by mutation from exponentially growing single mutant clones. We note that a closely related calculations, for neutral mutations with possibly large mutation rate, has been performed in [<xref ref-type="bibr" rid="sc4">4</xref>]). Consider a single-mutant (or mutant-class, or indeed a multiple-mutant) that, early in its trajectory is expanding in the population as
<disp-formula id="eqn8"><alternatives><graphic xlink:href="170589_eqn8.gif"/></alternatives></disp-formula>
(if this were an class of single mutants fed from the ancestor at rate <italic>U</italic> then <italic>n</italic><sub>0</sub> &#x2248; <italic>NU</italic>). Suppose that second mutants with fitness advantage <italic>s</italic> &#x00D7; &#x0394; occur at rate <italic>U</italic>&#x2032;. If fitness effects combine additivity, the fitness of the second-mutant relative to the ancestor is <italic>s</italic>(1 &#x002B; &#x0394;). Provided <italic>n</italic><sub>0</sub><italic>U</italic>&#x2032; &#x003D; <italic>NUU</italic>&#x2032;/<italic>s</italic> &#x226A; 1 the occurrence of double mutants will be rare and thus highly stochastic, with most of the stochasticity coming from the occurrence time of the mutant, rather than drift. The expected time for the ith double-mutant to establish is <italic>t<sub>i</sub></italic> where
<disp-formula id="eqn9"><alternatives><graphic xlink:href="170589_eqn9.gif"/></alternatives></disp-formula>
since this mutant will grow as <italic>n&#x2032;</italic> &#x2248; (<italic>&#x03BD;</italic>/<italic>s</italic>(1 &#x002B; &#x0394;))<italic>e</italic><sup><italic>st</italic>(1&#x002B;&#x0394;)</sup> (with <italic>&#x03BD;</italic> a random variate from an exponential distribution with mean 1 stemming from stochasticity of drift), the typical size <inline-formula><alternatives><inline-graphic xlink:href="170589_inline2.gif"/></alternatives></inline-formula> of the <italic>i</italic>th double mutant is
<disp-formula id="eqn10"><alternatives><graphic xlink:href="170589_eqn10.gif"/></alternatives></disp-formula></p>
<p>The typical relative sizes of subsequent mutations therefore follows the series
<disp-formula id="eqn11"><alternatives><graphic xlink:href="170589_eqn11.gif"/></alternatives></disp-formula>
hence the number of terms that contribute significantly to this series (and thus the typical number of mutations that contribute significantly to the total number of double-mutant cells) is controlled by the ratio of the fitness effects of double mutants compared to single mutants &#x0394;. For &#x0394; &#x2273; 1 one can consider the sum of this series (evaluated via an integral) to estimate of the number of terms (i.e. mutations) contributing to the sum and is found to be
<disp-formula id="eqn12"><alternatives><graphic xlink:href="170589_eqn12.gif"/></alternatives></disp-formula>
where 1 &#x2013; <italic>&#x03F5;</italic> controls how much of the sum one accounts for (i.e. an <italic>&#x03F5;</italic> &#x003D; 0.1 corresponds to the resulting number of doublemutants accounting for &#x007E; 90&#x0025; of the population). The result of which is that the number of terms contributing to the total population rapidly approaches 1 as &#x0394; increases and even for small &#x0394; &#x003D; 1 is a modest, meaning only a handful of double mutants dominate the population. The mean and standard deviation in the number of double-mutants comprising &#x2265; 90&#x0025; of the total population of double-mutants, as a function of increasing &#x0394; is shown in <xref ref-type="table" rid="tbl2">Table 2</xref>. We note that as &#x0394; &#x2192; 0 the number of terms contributing to the sum diverges, hence the dominance of a handful of clones is a feature of beneficial mutations i.e. those with a significant fitness advantage over the feeding population and thus a &#x0394; which is not very close to zero.</p>
<table-wrap id="tbl2" orientation="portrait" position="float"><label>Table 2:</label>
<caption><p>The mean and standard deviation of the number of second mutants that will comprise &#x2265; 90&#x0025; of the total doublemutant population as a function of the growth advantage of the double mutant (&#x0394;). In case of a neutral mutation &#x0394; &#x003D; 0 the number of mutations contributing to the total diverges over time, never reaching a fixed number as newer mutations keep contributing.</p></caption>
<graphic xlink:href="170589_tbl2.tif"/>
</table-wrap>
<p>For &#x0394; &#x003E; 1 the number of mutants that contribute is essentially only the first few and thus there is a rather general prediction that that fit double mutants should always cause a diversity crash independent of the details of the shape of the DFE, though the extent and timing of the crash depends on the DFE. The previous argument is been based on &#x201C;typical&#x201D; sizes. We note that the exact timing of the mutant is stochastic and hence there are fluctuations around these typical values for all of the <italic>i</italic>. The only fluctuations that really matter though are for the first few mutants <italic>i</italic> &#x003D; 1, 2, 3&#x2026;, the first being particularly important, which can be seen by considering sub-integer <italic>i</italic> in the above expressions. <italic>i</italic> &#x003D; 0.1 will occur 10&#x0025; of the time <italic>i</italic> &#x003D; 0.01 occurs 1&#x0025; of the time. These result in double-mutants that are 10<sup>1&#x002B;&#x0394;</sup> or 100<sup>1&#x002B;&#x0394;</sup> times larger. For large &#x0394;, this can produce a double-mutant (the first one that occurs) that dominates the entire population, almost completely wiping out genetic diversity. Hence, the relatively rare events with an early and fit double mutant are predicted to be able to wipe out diversity.</p>
<p>We can use similar arguments &#x2014; i.e. using the probability of when the first established second-mutant will enter the population &#x2017; to predict the distribution of second-mutant sizes (as for single-mutants in the previous section). We find the distribution over sizes of the earliest second-mutant to occur is
<disp-formula id="eqn13"><alternatives><graphic xlink:href="170589_eqn13.gif"/></alternatives></disp-formula>
where <italic>&#x00F1;</italic> &#x003D; (<italic>c</italic>/(1 &#x002B; &#x0394;)<italic>s</italic>)<italic>e</italic><sup><italic>s</italic>(1&#x002B;&#x0394;)<italic>t</italic></sup>. This expression holds out to a size <italic>n</italic> &#x2248; <italic>&#x00F1;</italic> beyond which it develops exponential tail (mutations above this size occurred immediately and their distribution of sizes above this result from the stochasticity associated with genetic drift). As a sanity check, this expression recovers the classic Luria-Delbruck form of &#x007E; 1/<italic>n</italic><sup>2</sup> for neutral mutations (&#x0394; &#x003D; 0) and approaches 1 &#x007E; /<italic>n</italic> form for &#x0394; &#x226B; 1 which is the same as if the feeding population were constant and feeding a rare beneficial mutation. The discussion around <xref ref-type="disp-formula" rid="eqn7">Eq. 7</xref> in the text above (regarding clonal interference and its effect on the absolute sizes of single-mutants) applies similarly to double-mutants i.e. the above expression will capture the scaling relation between relative frequencies of double-mutants but the absolute size of each in the population will be modified by the changing mean fitness term.</p>
<p>Below we explore two concrete examples of DFEs to highlight how the shape of the DFE affects mutation statistics and diversity.</p>
</sec>
<sec id="s3c"><label>2.3</label><title>Example: a delta-function DFE</title>
<sec id="s3c1"><title>Single mutants</title>
<p>Consider that the DFE is very sharply peaked such that every mutation confers the same advantage, <italic>s</italic>, and that mutations to this fitness occur at rate <italic>U<sub>b</sub></italic>. We begin by restricting analysis to single mutations only (we will later ask when this assumption breaks down to understand the effect of multiple-mutants). At early times, the mean fitness will be negligible and the probability of a mutation establishing in the population in the interval (<italic>t</italic>&#x2032;, <italic>t</italic>&#x2032; &#x002B; <italic>dt</italic>&#x2032;) is simply
<disp-formula id="eqn14"><alternatives><graphic xlink:href="170589_eqn14.gif"/></alternatives></disp-formula>
meaning that mutants enter at a constant rate. Early on, each of these mutants grows exponentially
<disp-formula id="eqn15"><alternatives><graphic xlink:href="170589_eqn15.gif"/></alternatives></disp-formula>
where <italic>t</italic>&#x2032; is the time of occurrence of the mutation and <italic>&#x03C4;</italic> is a stochastic variable called the &#x201C;establishment time&#x201D; which accounts for differences in the time it takes for a mutation to climb out of the stochastic behavior that dominates at low frequencies and begin to grow exponentially. (The distribution of <italic>&#x03C4;</italic> is peaked at zero with variations of &#x00B1;1/<italic>s</italic> either side). Because mutants grow exponentially and come in at a constant rate, the total number of single-mutant cells is dominated by the earliest few mutations that occur. More precisely, because the growth rate of mutants is <italic>s</italic>, only mutants that enter in the first &#x007E; 1/<italic>s</italic> generations contribute significantly to the expansion and hence the total number of single-mutant cells increases
<disp-formula id="eqn16"><alternatives><graphic xlink:href="170589_eqn16.gif"/></alternatives></disp-formula></p>
<p>This enables us to estimate how the mean fitness of the population increases:
<disp-formula id="eqn17"><alternatives><graphic xlink:href="170589_eqn17.gif"/></alternatives></disp-formula></p>
<p>This correctly captures the behavior that the mean fitness, <italic>&#x0078;&#x0304;</italic>(<italic>t</italic>) is small for <italic>t</italic> &#x226A; (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) then asymptotes to <italic>&#x0078;&#x0304;</italic>(<italic>t</italic>) &#x2248; <italic>s</italic> as <italic>t</italic> &#x226B; (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) (<xref ref-type="fig" rid="fig8">Figure 4 a &#x0026; b</xref>, 2nd row). The timescale for the mean fitness to increase appreciably
<disp-formula id="eqn18"><alternatives><graphic xlink:href="170589_eqn18.gif"/></alternatives></disp-formula>
is particularly important in understanding the diversity. The feeding of new mutants remains roughly constant until <italic>t</italic> &#x2248; (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) at which time time the feeding population declines rapidly and the fitness advantage of new mutations is diminished, causing the rate of establishing new mutations to decline and eventually stop altogether. These observations can be used to calculate the entropy
<disp-formula id="eqn19"><alternatives><graphic xlink:href="170589_eqn19.gif"/></alternatives></disp-formula></p>
<fig id="fig8" position="float" fig-type="figure"><label>Figure 4:</label>
<caption><title>Diversity dynamics for a delta-function DFE with only single-mutants</title>
<p>Two replicate simulations (a, b) using a single-mutant model with a delta-function DFE. Top row, the DFE, <italic>&#x03C1;</italic>(<italic>s</italic>) &#x003D; <italic>&#x03B4;</italic>(<italic>s</italic> &#x2013; <italic>s</italic><sub>0</sub>) where <italic>s</italic><sub>0</sub> &#x003D; 0.05 and <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> the bottleneck population size is 5 &#x00D7; 10<sup>7</sup> which grows by a factor of 256 between bottlenecks resulting in an effective population size of &#x2248; 4 &#x00D7; 10<sup>8</sup>. Second row, the mean fitness plateaus over a timescale of the &#x201C;sweep&#x201D; time (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) &#x2248; 216 for the numbers in this simulation, and highlighted by the dashed vertical gridline. Third row, the genotype trajectories of all unique genotypes that arise in the simulation. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref> in the text.</p></caption>
<graphic xlink:href="170589_fig8.tif"/>
</fig>
<p>The entropy will plateau at <italic>t</italic> &#x007E; (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) obtaining its maximum diversity
<disp-formula id="eqn20"><alternatives><graphic xlink:href="170589_eqn20.gif"/></alternatives></disp-formula></p>
<p>These features are indeed born out in simulations (<xref ref-type="fig" rid="fig8">Figure 4 a &#x0026; b</xref> 4th row). Note that a slightly more accurate form for the entropy can be obtained by accounting for the diminishing fitness advantage of clones as they expand rather than using a sharp cut-off. This more accurate approximation shows good quantitative agreement with the measured entropy of the distribution.</p></sec>
<sec id="s3c2"><title>Multiple mutants</title>
<p>How do the previous observations change if we allow multiple mutants to enter? In this delta-function DFE model multiple mutants allow genotypes to have different fitnesses, which will typically reduce diversity as some are fitter than others. At the same time, however, there is a far larger space of genotypes available to multiple mutations which will act to increase diversity. We start by considering double-mutants that have a fitness advantage <italic>s</italic><sub>1</sub> &#x002B; <italic>s</italic><sub>2</sub>. These are fed from the expanding class of 1st mutants which is increasing as
<disp-formula id="eqn21"><alternatives><graphic xlink:href="170589_eqn21.gif"/></alternatives></disp-formula></p>
<p>The probability that a mutation, destined to establish, enters the population in the interval (<italic>t</italic>&#x2032;,<italic>t</italic>&#x2032; &#x002B; <italic>dt</italic>&#x2032;) is now
<disp-formula id="eqn22"><alternatives><graphic xlink:href="170589_eqn22.gif"/></alternatives></disp-formula>
which is different to before since <italic>n</italic><sub>1</sub>(<italic>t</italic>) is increasing exponentially. Each of the mutants therefore grows exponentially as
<disp-formula id="eqn23"><alternatives><graphic xlink:href="170589_eqn23.gif"/></alternatives></disp-formula></p>
<p>Provided <italic>n</italic><sub>1</sub>(<italic>t</italic> &#x003D; 1/<italic>s</italic><sub>1</sub>)<italic>U<sub>b</sub></italic> &#x226A; 1 as is the case in these simulations and for the multiple mutants in the experiments, the single mutants do not feed double mutants immediately, but must grow up exponentially for an appreciable fraction of the sweep time first. Considering the typical time the second mutants will enter, the size of the expanding double-mutant class will be
<disp-formula id="eqn24"><alternatives><graphic xlink:href="170589_eqn24.gif"/></alternatives></disp-formula>
where <italic>i</italic> refers to the <italic>i</italic>th double-mutant that enters and <italic>k</italic> is the index of the most recent double mutant to occur. This is very different if <italic>n</italic><sub>1</sub>(<italic>t</italic> &#x003D; 1/<italic>s</italic><sub>1</sub>)<italic>U<sub>b</sub></italic> &#x226B; 1, in which case many double-mutants occur before the single mutant class grows exponentially and hence the expansion is dominated by the <inline-formula><alternatives><inline-graphic xlink:href="170589_inline3.gif"/></alternatives></inline-formula> double-mutants that occur in the first 1/(<italic>s</italic><sub>1</sub> &#x002B; <italic>s</italic><sub>2</sub>) generations, leading to the double-mutant class expanding as
<disp-formula id="eqn25"><alternatives><graphic xlink:href="170589_eqn25.gif"/></alternatives></disp-formula>
which, if <inline-formula><alternatives><inline-graphic xlink:href="170589_inline4.gif"/></alternatives></inline-formula> is much larger than in <xref ref-type="disp-formula" rid="eqn24">Eq. 24</xref>. If <inline-formula><alternatives><inline-graphic xlink:href="170589_inline5.gif"/></alternatives></inline-formula> the entire class of second mutants is dominated by the first few mutations to occur since
<disp-formula id="eqn26"><alternatives><graphic xlink:href="170589_eqn26.gif"/></alternatives></disp-formula></p>
<p>The fact that the diversity of second-mutant is dominated by the first handful is also borne out in simulated data (<xref ref-type="fig" rid="fig9">Figure 5C</xref>, red lines). Only these double-mutants will contribute significantly to the entropy, and since there are already <italic>NU<sub>b</sub></italic> &#x226B; 1 single-mutants expanding and driving the early-time entropy, the handful of double-mutants does not significantly increase it. However, the double mutants do expand and eventually outcompete the single mutants. This effect causes a diversity &#x201C;crash&#x201D; resulting in a significant reduction in entropy (<xref ref-type="fig" rid="fig9">Figure 5</xref>, bottom row). The magnitude and timing of this drop in diversity is determined by the relative diversities of the single versus double-mutant classes and the timing of when the double mutants out-compete the single mutants i.e. when <italic>n</italic><sub>2</sub>(<italic>t</italic>) &#x226B; <italic>n</italic><sub>1</sub>(<italic>t</italic>) which yields
<disp-formula id="eqn27"><alternatives><graphic xlink:href="170589_eqn27.gif"/></alternatives></disp-formula></p>
<fig id="fig9" position="float" fig-type="figure"><label>Figure 5:</label>
<caption><title>Diversity dynamics for a delta-function DFE with multiple-mutants that combine additively.</title>
<p>Top row, the DFE, <italic>&#x03C1;</italic>(<italic>s</italic>) &#x003D; <italic>&#x03B4;</italic>(<italic>s</italic> &#x2013; <italic>s</italic><sub>0</sub>) where <italic>s</italic><sub>0</sub> &#x003D; 0.05 and <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> the bottleneck population size is 5 &#x00D7; 10<sup>7</sup> which grows by a factor of 256 between bottlenecks resulting in an effective population size of &#x2248; 4 &#x00D7; 10<sup>8</sup>. Second row, multiple mutants increase the mean fitness significantly when they comprise an appreciable fraction of the population. The double-mutants will be a significant fraction of the single mutants after a time <inline-formula><alternatives><inline-graphic xlink:href="170589_inline6.gif"/></alternatives></inline-formula> generations leading to large deviations from the single mutant predictions (solid blue line, second row). Third row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). Note the emergence of a small number of very large double mutants (a, c, d, e) and occasionally of a anomalously early triple mutants (b). Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref> in the text that assumes single mutants only. The expansion of the double-mutants causes the diversity to &#x201C;crash&#x201D; over a similar timescale as when the double mutants comprise a significant fraction of the population. The small number of large double-mutant clones eventually outcompete the single mutants over this timescale.</p></caption>
<graphic xlink:href="170589_fig9.tif"/>
</fig>
<p>At this time, the single mutants have been outcompeted and are therefore at a total abundance &#x003C; 0.5, hence their contribution to the entropy is reduced from &#x007E; In(<italic>NU<sub>b</sub></italic>) at the maximum (<xref ref-type="fig" rid="fig9">Figure 5D</xref> where In(<italic>NU<sub>b</sub></italic>) &#x2248; 6), to &#x007E; 1. The contribution of the second-mutants to the entropy will also be <italic>O</italic>(1) and should largely be independent of <italic>N</italic> provided <inline-formula><alternatives><inline-graphic xlink:href="170589_inline7.gif"/></alternatives></inline-formula></p></sec>
<sec id="s3c3"><title>Stochasticity</title>
<p>While <xref ref-type="disp-formula" rid="eqn24">Eq. 24</xref> correctly captures the typical size of the ith mutant, there are fluctuations due to variation in the occurrence time of the first few double-mutants. This stochasticity can be seen in <xref ref-type="fig" rid="fig9">Figure 5a&#x2013;e</xref> showing 5 independent simulated evolutions with the same DFE.</p>
</sec>
</sec>
<sec id="s3d"><label>2.4</label><title>Example: a &#x201C;top-hat&#x201D; DFE</title>
<sec id="s3d1"><title>Single mutants</title>
<p>Consider a &#x201C;top-hat&#x201D; distribution with density <italic>&#x03BC;</italic>(<italic>s</italic>)<italic>ds</italic> &#x003D; 2 &#x00D7; 10<sup>&#x2212;5</sup><italic>ds</italic>, such that the total beneficial mutation rate is again <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> but it is now uniformly spread out over the interval [0.025, 0.075]. In the deterministic approximation, which holds well for single-mutants, the total number of cells across time binned by fitness will be
<disp-formula id="eqn28"><alternatives><graphic xlink:href="170589_eqn28.gif"/></alternatives></disp-formula></p>
<p>The mean fitness over time is therefore
<disp-formula id="eqn29"><alternatives><graphic xlink:href="170589_eqn29.gif"/></alternatives></disp-formula></p>
<p>Typically, only a narrow range of fitness classes contribute to the total number of adaptive cells and hence one can normally find an effective fitness effect <italic>&#x0073;&#x0303;</italic> and range of fitness effects <italic>&#x03B4;&#x0073;&#x0303;</italic> and an effective rate to these fitness effects <italic>U<sub>b</sub></italic>. For the case of the &#x201C;top-hat&#x201D; these are straightforward to work out: fitness classes grow exponentially relative to one another so only a range of fitnesses within 1/<italic>t</italic> of the maximum fitness effect, <italic>s<sub>max</sub></italic> will contribute. Hence the effective selection coefficients will lie in the range
<disp-formula id="eqn30"><alternatives><graphic xlink:href="170589_eqn30.gif"/></alternatives></disp-formula>
and since the rate to fitness effects is constant, the effective beneficial mutation rate becomes
<disp-formula id="eqn31"><alternatives><graphic xlink:href="170589_eqn31.gif"/></alternatives></disp-formula></p>
<p>Substituting <italic>&#x0073;&#x0303;</italic> and <italic>&#x0055;&#x0303;</italic> into the expressions for the mean fitness and entropy from the delta-function distribution successfully predicts the behavior of both the mean fitness over time (<xref ref-type="fig" rid="fig10">Figure 6 a &#x0026; b</xref>, 2nd row) as well as the genetic diversity (<xref ref-type="fig" rid="fig10">Figure 6 a and b</xref>, 4th row).</p>
<fig id="fig10" position="float" fig-type="figure"><label>Figure 6:</label>
<caption><title>Diversity dynamics for a top-hat DFE allowing only single mutants.</title>
<p>Simulations using a single-mutant model with a top-hat DFE. Top row, the DFE, <italic>&#x03C1;</italic>(<italic>s</italic>) &#x003D; 2 &#x00D7; 10<sup>&#x2212;5</sup> between <italic>s</italic> &#x003D; 0.025 and <italic>s</italic> &#x003D; 0.075 and <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> the bottleneck population size is 5 &#x00D7; 10<sup>7</sup> which grows by a factor of 256 between bottlenecks resulting in an effective population size of &#x2248; 4 &#x00D7; 10<sup>8</sup>. Second row, the mean fitness plateaus over a timescale of the &#x201C;sweep&#x201D; time (1/<italic>s</italic>)In(<italic>s</italic>/<italic>U<sub>b</sub></italic>) &#x2248; 170 since the &#x201C;predominant&#x201D; <italic>s</italic> &#x003D; 0.075. Third row, the genotype trajectories of all unique genotypes that arise in the simulation. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text. The slow decline of the diversity is due to clonal competition between single-mutants with different fitness effects.</p></caption>
<graphic xlink:href="170589_fig10.tif"/>
</fig>
<p>The effect of changing the DFE to a top-hat distribution with the same mean fitness effect as the delta function results in the mean fitness increasing more rapidly because the increased effective fitness effect <italic>&#x0073;&#x0303;</italic> has a larger effect the rate of mean fitness increase than the reduced effective mutation rate <italic>&#x0055;&#x0303;<sub>b</sub></italic> does. This results from the timescale for the mean to increase depending inversely on the fitness effect and only logarithmically on the mutation rate via <xref ref-type="disp-formula" rid="eqn18">Eq. 18</xref>. Similarly, the genetic diversity increases more rapidly as it is being driven by larger fitness effect mutants that expand faster. However it peaks at a smaller value because the number of unique mutants contributing to the expansion is smaller (and decreases over time) due to the lower rate of mutating to the specific &#x201C;predominant&#x201D; fitness class <italic>&#x0073;&#x0303;</italic>. This effect produces decline in the genetic diversity, even in the absence of further mutations, due to the larger fitness effect mutants out-competing the others. After the initial exponential expansion, the entropy at time <italic>t</italic> is effectively given by In(<italic>N&#x0055;&#x0303;<sub>b</sub></italic>) which in this case decreases as &#x2013; In(<italic>t</italic>) due to <italic>&#x0055;&#x0303;<sub>b</sub></italic> &#x007E; 1/<italic>t</italic>.</p></sec>
<sec id="s3d2"><title>Multiple mutants</title>
<p>The effect of multiple mutants is qualitatively similar for a top-hat DFE as it is for the delta-function DFE. The emergence of a handful of large double mutants causes the entropy trajectory to crash at roughly the time when double mutants dominate the population. This subsequently partially recovers with the emergence of triple- and quadruple-mutants. The stochasticity in the size distribution of double-mutants resulting from exponential feeding is clear in <xref ref-type="fig" rid="fig11">Figure 7 a-e</xref> which are 5 replicate simulations. Panels a-c show more typical simulations where there are a handful of large double-mutants. Panels d-e show examples of anomalously early multiple mutants that drive an even more dramatic diversity crash.</p>
<fig id="fig11" position="float" fig-type="figure"><label>Figure 7:</label>
<caption><title>Diversity dynamics for a top-hat DFE with multiple-mutants that combine additively.</title>
<p>Top row, the DFE, <italic>&#x03C1;</italic>(<italic>s</italic>) &#x003D; 2 &#x00D7; 10<sup>&#x2212;5</sup> between <italic>s</italic> &#x003D; 0.025 and <italic>s</italic> &#x003D; 0.075 and <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> the bottleneck population size is 5 &#x00D7; 10<sup>7</sup> which grows by a factor of 256 between bottlenecks resulting in an effective population size of &#x2248; 4 &#x00D7; 10<sup>8</sup>. Second row, multiple mutants increase the mean fitness significantly when they comprise an appreciable fraction of the population. The double-mutants will be a significant fraction of the single mutants after a time <inline-formula><alternatives><inline-graphic xlink:href="170589_inline8.gif"/></alternatives></inline-formula> (with predominant <italic>s</italic> &#x003D; 0.075) generations leading to large deviations from the single mutant predictions (solid blue line, second row). Third row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). Note the emergence of a small number of very large double-mutants (b, e) and occasionally of a anomalously early triple mutants (a, d). Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text that assumes single mutants only. The expansion of the double-mutants causes the diversity to &#x201C;crash&#x201D; over a similar timescale as when the double mutants comprise a significant fraction of the population. The small number of large double-mutant clones eventually outcompete the single mutants over this timescale.</p></caption>
<graphic xlink:href="170589_fig11.tif"/>
</fig>
</sec>
</sec>
<sec id="s3e"><label>2.5</label><title>Barcode lineage diversity tracks genotype diversity into the crash</title>
<p>In the previous sections, genetic diversity is measured via the entropy of all <italic>unique genotypes</italic> in the population. We however can only measure the abundance of <italic>unique lineages.</italic> A natural question is then: <bold>does the adaptive lineage diversity (measured via entropy of all adaptive lineages) match the adaptive genetic diversity (measured via entropy of all adaptive genotypes)?</bold></p>
<p>Somewhat surprisingly, our simulations show that the diversity of adaptive barcodes tracks true genotypic diversity well beyond the emergence of single mutations, robustly capturing the diversity &#x201C;crash&#x201D; caused by double-mutants outcompeting single-mutants (<xref ref-type="fig" rid="fig12">Figure 8</xref>). Top panels plot the log-abundance of almost all genotypes that enter the population colored by the number of adaptive mutations: single mutants (orange), double mutants (green), triple mutants (red), quadruple mutants (purple). The bottom panel plots the entropy of all adaptive genotypes (data points) and, for comparison, the predicted entropy of single mutants (hashed line) and entropy of all adaptive barcode lineages (blue line). In all simulations performed the diversity of adaptive barcode lineage closely tracks the true genetic diversity of adaptive mutations out to the point of the minimum diversity (the &#x201C;crash&#x201D;), which in all cases is caused by the expansion of a small number of double-mutants.</p>
<fig id="fig12" position="float" fig-type="figure"><label>Figure 8:</label>
<caption><title>Barcode diversity tracks true diversity.</title>
<p>(a-f) stochastic simulations of the evolutionary dynamics that result from a delta function DFE peaked at <italic>s</italic> &#x003D; 5&#x0025;, with <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup> and <italic>N</italic> &#x003D; 4 &#x00D7; 10<sup>8</sup>. Top panel lines are all genotypes in the population through time colored by the number of beneficial mutations harbored by that genotype: single-mutants (orange), double-mutants (green), triple-mutants (red) and quadruple mutants (purple). As predicted, double-mutants are typically dominated by between 1 and 10 genotypes, in contrast to single-mutants in which hundreds of distinct genotypes contribute. Bottom panels show the entropy of all beneficial genotypes calculated from the true genetic diversity (data points), predicted assuming single-mutants only (hashed line) and inferred using the abundance of adaptive barcoded lineages (blue lines). Barcode abundance can be used to robustly infer true beneficial diversity out to when double mutants expand to cause the diversity &#x201C;crash&#x0394;.</p></caption>
<graphic xlink:href="170589_fig12.tif"/>
</fig>
<p>The reason adaptive lineages provide useful information about double-mutant expansions is because only a handful of double-mutants contribute significantly to diversity and these can occur inside &#x007E; 10<sup>3</sup> different adaptive barcode lineages containing an expanding single-mutant. It is therefore likely that all of the large double mutants occur in different barcode lineages and, because they occur anomalously early, quickly become the dominant types in those lineages. Tracking the abundance of the largest adaptive barcode lineages at late times therefore provides a robust method to infer the diversity of adaptive mutations in a population and can be used to test whether double-mutants cause a diversity &#x201C;crash&#x201D; that is predicted in both theory and simulation.</p>
<p>Extending the above arguments explains why barcode diversity does not track true genetic diversity for triple mutants. It is predicted that &#x007E; 10 triple-mutants contribute significantly to diversity. However, these are all likely to occur in the largest few double mutant lineages, meaning these largest few lineages will harbor &#x201C;sub-clonal&#x201D; diversity. Adaptive barcode diversity will therefore underestimate true adaptive diversity beyond the point of minimum diversity causing the diversity trajectories to diverge (<xref ref-type="fig" rid="fig12">Figure 8</xref>).</p></sec>
<sec id="s3f"><label>2.6</label><title>Growth-inhibiting drug DFE</title>
<p>Here we model how adaptive genetic diversity evolves under a DFE with a small supply of large-effect mutations, as might occur in the presence of a growth-inhibiting drug. As an example of what happens in such a scenario, we use a model DFE where small-fitness-effect mutations (<italic>s<sub>&#x03B1;</sub></italic> &#x003D; 0.05) occur at a relatively high rate (<italic>U<sub>&#x03B1;</sub></italic> &#x003D; 10<sup>&#x2212;5</sup> per cell division) while large fitness-effect mutations (<italic>s<sub>&#x03B2;</sub></italic> &#x003D; 0.20) occur at a lower rate (in the range 10<sup>&#x2212;11</sup> &#x003C; <italic>U<sub>&#x03B2;</sub></italic> &#x003C; 10<sup>&#x2212;9</sup> per cell division). In this context we take &#x201C;large&#x201D; fitness effects to mean that <italic>s<sub>&#x03B2;</sub></italic> &#x003E; <italic>s<sub>&#x03B1;</sub></italic> &#x00D7; (In(<italic>Ns<sub>&#x03B1;</sub></italic>)/In(<italic>s<sub>&#x03B1;</sub></italic>/<italic>U<sub>&#x03B1;</sub></italic>)). That is, large-effect mutations destined to establish will typically sweep regardless of the fitness of the genotype on which they fall (since the fitness effect is larger than the range of fitnesses expected in the population at any time). In this limit the the dynamics of adaptive genetic diversity depends most sensitively on the supply of large-effect mutations <italic>U<sub>&#x03B2;</sub></italic>.</p>
<p>Large effect mutants enter typically every &#x007E; 1/<italic>NU<sub>&#x03B2;</sub>s<sub>&#x03B2;</sub></italic> generations. The early time dynamics of the modest-effect mutations studied here takes place over timescales <italic>&#x03C4;<sub>sw</sub></italic> &#x003D; (1/<italic>s<sub>&#x03B1;</sub></italic>)In(<italic>s<sub>&#x03B1;</sub></italic>/<italic>U<sub>&#x03B1;</sub></italic>) called the &#x201C;sweep time&#x201D; (&#x007E; 170 generationsfor the parameters above and those in <xref ref-type="fig" rid="fig13">Figures 9</xref> - <xref ref-type="fig" rid="fig15">11</xref>). It is the relative magnitudes of these timescales that can be used to assess the impact of the large-effect mutants on the adaptive genetic diversity.</p>
<fig id="fig13" position="float" fig-type="figure"><label>Figure 9:</label>
<caption><title>Diversity dynamics for DFE modeling growth-inhibiting drug.</title>
<p>Here the DFE is composed of two delta-functions (at <italic>s<sub>&#x03B1;</sub></italic> &#x003D; 0.05 with rate <italic>U<sub>&#x03B1;</sub></italic> &#x003D; 10<sup>&#x2212;5</sup> and <italic>s<sub>&#x03B2;</sub></italic> &#x003D; 0.20 with rate <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;11</sup>). Top row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). Large crashes in diversity (column 2 and 3) are caused by anomalously early double mutants comprised of two small-effect mutations. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text that assumes single mutants only.</p></caption>
<graphic xlink:href="170589_fig13.tif"/>
</fig>
<p>When the supply of large-effect mutations is low enough, large-effect mutations have little impact on the early adaptive diversity dynamics (<xref ref-type="fig" rid="fig13">Figure 9</xref>, where <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;11</sup>). In this case the typical time it takes for a large-effect mutation to enter is &#x007E; 10<sup>3</sup> generations and hence the probability of large-effect mutation entering during the early time dynamics (&#x003C;170 generations) is small. Thus, when large diversity crash does occur, it is driven by anomalously early double mutants as can be seen in <xref ref-type="fig" rid="fig13">Figure 9</xref> and as is the case for the empirical DFEs observed in the experimental evolutions.</p>
<p>As one increases the supply of large-effect mutations (<xref ref-type="fig" rid="fig14">Figure 10</xref>, where <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;10</sup>) the timing of the first large-effect mutation and the sweep time become comparable. For parameters used here, this is predicted to occur at <italic>U<sub>&#x03B2;</sub></italic> &#x007E; 10<sup>&#x2212;10</sup>, and <xref ref-type="fig" rid="fig14">Figure 10</xref> indeed shows that, in a substantial fraction of simulations, a large-effect mutation enters and causes a single-mutant driven diversity crash. As the supply of large-effect mutants in increased further (<xref ref-type="fig" rid="fig15">Figure 11</xref> where <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;9</sup>), large-effect single mutants sweep in almost all simulations and the diversity does not have enough time to build up before a large-effect mutant sweeps.</p>
<fig id="fig14" position="float" fig-type="figure"><label>Figure 10:</label>
<caption><title>Diversity dynamics for DFE modeling growth-inhibiting drug.</title>
<p>Here the DFE is composed of two delta-functions (at <italic>s<sub>&#x03B1;</sub></italic> &#x003D; 0.05 with rate <italic>U<sub>&#x03B1;</sub></italic> &#x003D; 10<sup>&#x2212;5</sup> and <italic>s<sub>&#x03B2;</sub></italic> &#x003D; 0.20 with rate <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;10</sup>). Top row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). Here, because the supply of large-effect single-mutants is higher, large crashes in diversity (e.g. column 1 and 5) can be caused large-effect single-mutants which sweep. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text that assumes single mutants only. In cases where large-effect single-mutants enter early, they drive a diversity crash before single-mutant diversity has much time to build up.</p></caption>
<graphic xlink:href="170589_fig14.tif"/>
</fig>
<fig id="fig15" position="float" fig-type="figure"><label>Figure 11:</label>
<caption><title>Diversity dynamics for DFE modeling growth-inhibiting drug.</title>
<p>Here the DFE is composed of two delta-functions (at <italic>s<sub>&#x03B1;</sub></italic> &#x003D; 0.05 with rate <italic>U<sub>&#x03B1;</sub></italic> &#x003D; 10<sup>&#x2212;5</sup> and <italic>s<sub>&#x03B2;</sub></italic> &#x003D; 0.20 with rate <italic>U<sub>&#x03B2;</sub></italic> &#x003D; 10<sup>&#x2212;9</sup>). Top row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). With a larger supply of large-effect single-mutants almost all simulations exhibit a diversity crash driven by large-effect single-mutants which sweep. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text that assumes single mutants only. In all cases a diversity crash caused by large-effect single-mutants occurs before diversity can build up substantially. This is followed by large oscillations in diversity occurring over timescales at which large-effect mutations enter and sweep i.e. every 1/(<italic>NU<sub>&#x03B2;</sub>s<sub>&#x03B2;</sub></italic>) &#x007E; 100 generations.</p></caption>
<graphic xlink:href="170589_fig15.tif"/>
</fig>
<p>The presence of a growth-inhibiting drug could therefore be expected to alter the early adaptive diversity dynamics since stochastically occurring large-effect single-mutants could drive a crash, which would be quantitatively different from the case where the diversity crash is driven by a small number of fit multiple-mutants. It should be noted however, that in this case, the evolutionary dynamics changes more generally: it is driven by successive sweeps of large-effect mutants and is no longer truly in the clonal-interference multiple-mutation limit studied here.</p>
</sec>
<sec id="s3g"><label>2.7</label><title>Power-law DFEs</title>
<p>In this section we explore how the dynamics of adaptive genetic diversity would be expected to evolve when the DFE has a supply of beneficial mutations spread over roughly two orders-of-magnitude. We consider DFEs where <italic>&#x03BC;</italic>(<italic>s</italic>) &#x007E; <italic>s</italic><sup>&#x2212;<italic>&#x03B3;</italic></sup> with a lower limit of <italic>s</italic> &#x003D; 0.005 (set since this mutations below this effect size would not be able to establish before the end of the observation period &#x007E; 300 generations) and with an upper limit of <italic>s</italic> &#x003D; 0.3 (set to remain biologically plausible, given the observed fitness effects). The total rate of beneficial mutations is set to be <italic>U<sub>b</sub></italic> &#x003D; 10<sup>&#x2212;6</sup>.</p>
<p><xref ref-type="fig" rid="fig16">Figure 12</xref> shows the early time dynamics of beneficial clones for <italic>&#x03B3;</italic> &#x003D; 2. In this case, the dynamics effectively enters a successive sweep regime whereby stochastically occurring large-fitness-effect clones effectively fix before the occurrence of the <italic>n</italic> &#x002B; 1th mutant clone. In this case, diversity has a limited time to build up and is typically purged causing characteristic humps in the entropy (last row, <xref ref-type="fig" rid="fig16">Figure 12</xref>).</p>
<fig id="fig16" position="float" fig-type="figure"><label>Figure 12:</label>
<caption><title>Diversity dynamics for a power-law DFE.</title>
<p>In these simulations <italic>&#x03BC;</italic>(<italic>s</italic>) &#x007E; <italic>s</italic><sup>&#x2212;2</sup> for 0.005 &#x003E; <italic>s</italic> &#x003C; 0.3. The total beneficial mutation rate is normalized to <italic>U</italic> &#x003D; 10<sup>&#x2212;6</sup>. As in previous simulations the bottleneck population size is 7 &#x00D7; 10<sup>7</sup> which grows by a factor of 256 between bottlenecks resulting in an effective population size of &#x2248; 5 &#x00D7; 10<sup>8</sup>. Top row, the genotype trajectories of all unique genotypes that arise in the simulation (single-mutants blue, double-mutants red, triple-mutants orange, quadruple-mutants purple). Middle row: Muller plots of adaptive lineages. Bottom row: the entropy trajectory (see <xref ref-type="sec" rid="s6b">Section 5.2</xref>) of all genotypes in the population (data points) compared to the theoretical prediction from using <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> in the text that assumes single mutants only. This is followed by large oscillations in diversity occurring over timescales at which large-effect mutations enter and sweep i.e. every 1/(<italic>NU<sub>&#x03B2;</sub>s<sub>&#x03B2;</sub></italic>) &#x007E; 100 generations.</p></caption>
<graphic xlink:href="170589_fig16.tif"/>
</fig>
<p>Power law DFEs thus produce qualitatively different adaptive diversity dynamics than we observe in the experimental data, though we note that a full quantitative analysis of the dynamics expected under a power-law DFE is beyond the scope of the present work [<xref ref-type="bibr" rid="sc3">3</xref>].</p>
</sec>
</sec>
<sec id="s4"><label>3</label><title>Sequencing of clones, remeasuring fitness and &#x201C;coloring&#x201D; the DFE</title>
<sec id="s4a"><label>3.1</label><title>C-lim</title>
<p>In total 475 clones were picked from the C-lim evolution (369 clones from C1, blue disks in <xref ref-type="disp-formula" rid="eqn13">13</xref>, 106 clones from C2, green disks in <xref ref-type="disp-formula" rid="eqn13">13</xref>). A large proportion of these clones have been described previously in [<xref ref-type="bibr" rid="sc5">5</xref>] and we refer readers to this reference for clone picking and sequencing details. <xref ref-type="fig" rid="fig17">Figure 13</xref> shows the top 100 clones ranked by re-measured fitness. Anomalously large double mutant clones are highlighted by barcode numbering on the plot.</p>
<fig id="fig17" position="float" fig-type="figure"><label>Figure 13:</label>
<caption><title>C-lim sequenced clones.</title>
<p>The top 100 clones ranked (left to right) in order of decreasing re-measured fitness relative to the ancestor in C-lim. Each column is a clone (picked from the population at generation 88). The top panel shows the extrapolated abundance &#x2013; indicated by disk area &#x2013; at generation 300, the middle panel the measured abundance &#x2013; indicated by disk area &#x2013; at time of sampling (generation 88) and the bottom panel shows the barcode ID, and number of mutations identified in each clone (squares) with colors indicating which gene the mutation landed in. Gray indicates &#x201C;other&#x201D; mutations that appear only once, a substantial fraction of which are likely neutral. Multiple mutants are denoted by bold outlines and sometimes also by a dark blue square. The dark blue square indicates an adaptive mutation that did not fall into one of the commonly mutated genes listed in the key on the right-hand side.</p></caption>
<graphic xlink:href="170589_fig17.tif"/>
</fig>
<sec id="s4a1"><title>Adaptive mutations</title>
<p>We used the following criteria to determine whether mutations were adaptive &#x201C;driver&#x201D; mutations (those causing the non-neutral fitness) or neutral passenger mutations.</p>
<list list-type="order">
<list-item><p>If a gene was mutated multiple times in clones with distinct barcodes, mutations in that gene were designated as <monospace>adaptive</monospace>. A conservative estimate of the probability that two independently occurring neutral mutations in a given gene would be identified as adaptive via such an approach is small (&#x007E; 0.005), as the number of genes mutated twice in independent lineages is 26 and there are &#x007E; 5, 000 possible genes. This estimate is conservative because (i) it does not use functional information and the vast majority of these mutations indicate they are functional (e.g. missense, frameshift, upstream indel) and (ii) because there is often only one mutation observed in that clone, making it more likely to be the variant causing the fitness difference.</p></list-item>
<list-item><p>If a mutation in a gene was only observed once, but that clone was clearly non-neutral (mean re-measured fitness&#x003E;0.01), and no other mutations were identified in the clone, then that gene was labeled as adaptive <monospace>adaptive</monospace>.</p></list-item>
</list>
</sec>
<sec id="s4a2"><title>Multiple-mutants</title>
<p>A clone that contains two or more mutations that are identified as &#x201C;adaptive&#x201D; via the above criteria was classified as a multiple mutant. In replicate C1 the largest clone (barcode 3730) is a confirmed double-mutant with mutations Dip&#x002B; <italic>RAS2</italic>. C2 is more difficult to assess as the number of clones sampled was smaller and thus a larger fraction of the high abundance barcodes at late times were not sampled at generation 88 (see <xref ref-type="fig" rid="fig27">Figure 23</xref>). The largest lineage in C2 &#x2014; 1379 &#x2014; is indeed identified as a double-mutant composed of an <italic>IRA1</italic> (mutated 47 times across both replicates) and <italic>YIL169C</italic> (mutated 6 times across both replicates). However a note of caution is warranted here: 5 of the 6 mutations in <italic>YIL169C</italic> are at exactly the same position. While this can occur by chance at the population sizes we use, it is more likely due to a neutral pre-existing mutation that arose prior to barcoding and was barcoded multiple times. This is especially likely in this case since the same SNP is sampled into both replicates (C1 and C2) yet is not adaptive in C1. Hence in C2 there is little evidence for early anomalously fit double-mutants. This lack of early double-mutants is consistent with the diploid trajectory in C2 (<xref ref-type="fig" rid="fig4">Figure 4C</xref> of main text, green data points) where the diploid trajectory is outcompeted for a long time and is rescued late, indicating a later double-mutant in this replicate.</p>
</sec>
</sec>
<sec id="s4b"><label>3.2</label><title>N-lim</title>
<p>We isolated clones from generation 192 of N1, and remeasured the fitness of the 291 clones within that pool, whose trajectories indicated they were adaptive as previously described [<xref ref-type="bibr" rid="sc5">5</xref>]. We whole genome sequenced all clones from this pool to a mean coverage of 30x. Variants were called using the same pipeline as outlined in [<xref ref-type="bibr" rid="sc5">5</xref>]. Details of the top 100 clones ranked by re-measured fitness is shown in <xref ref-type="fig" rid="fig18">Figure 14</xref>.</p>
<fig id="fig18" position="float" fig-type="figure"><label>Figure 14:</label>
<caption><title>N-lim sequenced clones.</title>
<p>The top 100 clones ranked (left to right) in order of decreasing re-measured fitness relative to the ancestor in N-lim. Each column is a clone (picked from the population at generation 192). The top panel shows the extrapolated abundance &#x2013; indicated by disk area &#x2013; at generation 300, the middle panel the measured abundance &#x2013; indicated by disk area &#x2013; at time of sampling (generation 192) and the bottom panel shows the barcode ID, and number of mutations identified in each clone (squares) with colors indicating which gene the mutation landed in. Gray indicates &#x201C;other&#x201D; mutations that appear only once, a substantial fraction of which are likely neutral. Multiple mutants are denoted by bold outlines and sometimes also by a dark blue square. The dark blue square indicates an adaptive mutation that did not fall into one of the commonly mutated genes listed in the key on the right-hand side.</p></caption>
<graphic xlink:href="170589_fig18.tif"/>
</fig>
<p>From the whole genome sequencing data, we identified SNPs, small indels, larger deletions and insertions, Ty transposition events, and CNVs, including aneuploidy and segmental aneuploidy and annotated the genes within which those mutations fell. Among these genes, there were 39 that had more mutations than would be expected by chance including: <italic>MEP1</italic>, <italic>GAT1</italic>, <italic>PAR32</italic>, <italic>FCY2</italic>, <italic>DAL81</italic> and <italic>MIT1.</italic> In addition, we saw mutations in <italic>MEP2</italic> and <italic>MEP3.</italic> The <italic>MEP</italic> genes encode the ammonium permeases, suggesting that the mutations that we observe are likely to be gain of function, increasing the cell&#x2019;s ability to scavenge ammonium, which is the limiting nutrient. We also observe mutations in <italic>GAT1</italic>, which has been previously identified as mutation in nitrogen limited chemostats [<xref ref-type="bibr" rid="sc6">6</xref>], and encodes a GATA transcription factor that activates the nitrogen catabolite repression regulon.</p>
<sec id="s4b1"><title>Adaptive mutations</title>
<p>Adaptive mutations were identified in the same way as in the C-lim replicates (see above).</p></sec>
<sec id="s4b2"><title>Multiple-mutants</title>
<p>In the sequenced N-lim replicate, 28 of the top 100 clones ranked by fitness are double-mutants (defined as above for C-lim). Of these, two lineages go onto dominate the population 84944 (composed of Dip&#x002B; <italic>MEP1</italic>) and 222232 (composed of Dip&#x002B; <italic>GAT1</italic>) both indicating Dip&#x002B;GoF structure since the gene variants are beneficial as heterozygotes.</p>
</sec>
</sec>
<sec id="s4c"><label>3.3</label><title>Coloring the DFE by gene / mutation type</title>
<p>Combining the whole genome sequencing of adaptive clones with the lineage tracking data enables one to assign which mutations in which genes contribute to various regions of the DFE. This is shown for both N-lim and C-lim environments in <xref ref-type="fig" rid="fig2">Figure 2</xref> of the main text. To &#x201C;color&#x201D; the beneficial mutation rate spectrum, by gene like this, we divided up the fitness range ([0, 0.15] in C-lim and [0, 0.12] in N-lim) into bins of width <italic>&#x03B4;x</italic> &#x003D; 0.002. For each of the replicates with large numbers of sequenced clones (C1 and N1) we then assigned each adaptive barcode to a bin if its fitness estimate (from the maximum likelihood approach using the early time trajectory in <xref ref-type="sec" rid="s2">Section 1</xref>) fell within that fitness bin. For each adaptive barcode in each fitness bin, we then asked whether a clone from this barcode was whole genome sequenced and if it was sequenced, which genes were mutated.</p>
<p>The contribution of a given barcode lineage to the bin rate was determined by estimating the rate using the inferred fitness effect and establishment time via
<disp-formula id="eqn32"><alternatives><graphic xlink:href="170589_eqn32.gif"/></alternatives></disp-formula></p>
<p>We scaled the rate of each gene in a given bin up by a factor such that the rate to all genes in a given bin added up to the total rate inferred for that bin. For example if 2 barcoded lineages each with a different mutated gene contributed to a bin, but the estimates of the rates to each were in the ratio 2:1, and the total rate to the bin was 10<sup>&#x2212;6</sup>, then the first gene would be colored to a height of 0.67 &#x00D7; 10<sup>&#x2212;6</sup> and the second to 0.33 &#x00D7; 10<sup>&#x2212;6</sup>. Bins in which no clones were sampled for sequencing were marked as unknown. This method will work well for bins in which many unique lineages that were found to be mutated, and will work less well as the number genes contributing to a bin decreases, since in the latter case there is a good chance we have under-sampled. This effect however does not affect any subsequent results, only the coloration of the DFEs in <xref ref-type="fig" rid="fig2">Figure 2</xref> of the main text. Only single-mutants, which were not pre-existing (e.g. were adaptive replicate C1 (N1) and not in C2 (N2)), and which contained mutations in verified adaptive genes were counted. Verified adaptive genes are defined in <xref ref-type="sec" rid="s4a">section 3.1</xref>.</p>
<p>Multiple mutants, i.e. lineages which contain clones that upon sequencing had 2 or more mutations in genes that were independently verified as adaptive (using the above criteria) were colored differently (dark blue) so that the (small) contribution of multiple mutant lineages to the DFE could be assessed.</p>
</sec>
<sec id="s4d"><label>3.4</label><title>Loss-of-Function vs. Gain-of-Function mutations</title>
<p>In the simulations described in <xref ref-type="sec" rid="s5">section 4</xref>, we classify high-fitness mutations as either Loss-of-Function (LoF) or Gain-of-Function (GoF). This classification is inspired by observations that, in both environments, a large fraction of adaptive mutations disrupt gene function (putative LoF mutations) while a smaller fraction are likely to have modified the gene&#x2019;s function (putative GoF mutations). <bold>It should be stressed, however, that our classification of mutations as being either LoF or GoF are not definitive, and none of our conclusions depend on assigning individual clones as harboring LoF or GoF mutations. However multiple lines of evidence do point to these two broad classes of mutation being important to the diversity dynamics</bold>. Specifically:</p>
<list list-type="bullet">
<list-item><p><bold>Putative LoF mutations typically occur in negative regulators</bold>. We defined clones as harboring LoF mutations if the adaptive mutation was identified as (i) nonsense, (ii) frameshift or (iii) a large deletion or (iv) missense but in a gene in which at least one other clone harbored a mutation of type (i)-(iii) and was also identified as adaptive. Examples in C-lim of genes which are adaptive under a LoF mutation include <italic>IRA1</italic>, <italic>IRA2</italic>, <italic>GPB2</italic>, <italic>PDE2</italic> [<xref ref-type="bibr" rid="sc5">5</xref>], examples in N-lim include <italic>PAR32</italic>, <italic>GAT1</italic>, <italic>MIT1</italic>, <italic>FCY2</italic>.</p></list-item>
<list-item><p><bold>Putative GoF mutations often occur in positive regulators</bold>. We defined clones as harboring GoF mutations if the adaptive mutation was identified as (i) missense and in which no other type of mutation was found to be adaptive in that gene or, in the case of N-lim, occasionally a Ty transposition if further biology could justify it as GoF (below). In C-lim, for example, mutations in positive regulators of the <italic>RAS</italic> pathway are exclusively missense mutations in genes such as <italic>RAS2</italic>, <italic>CYR1</italic>, <italic>TFS1</italic> strongly indicating they are GoF mutations. In N-lim, mutations in <italic>MEP1</italic>, <italic>MEP2</italic>, <italic>and MEP3</italic> genes were identified as putative GoF. The MEP genes encode ammonium permeases, suggesting that the mutations that we observe are likely to be gain of function, increasing the cell&#x2019;s ability to scavenge ammonium, which is the limiting nutrient. Mutations in the MEP genes are either very specific missense mutations (sometimes hitting the same exact nucleotide) or Ty insertions downstream of the gene.</p></list-item>
<list-item><p><bold>Putative LoF mutations are more common than GoF mutations</bold>. Based on the mutations in <xref ref-type="fig" rid="fig4">Figure 4</xref> of [<xref ref-type="bibr" rid="sc5">5</xref>] these classes occur in the ratio of 66:16 or roughly 4:1. Making a quantitative assessment in N-lim is more challenging as definitely assigning LoF or GoF to a given mutation is harder. Thus we elected to use the same ratio 4:1 for N-lim simulations too.</p></list-item>
<list-item><p><bold>Putative LoF mutations partially or totally recessive</bold>. In C-lim, as predicted by our theory, the LoF mutations are almost never seen in diploids. There were however three clones which were sampled which did have LoF mutation in diploids. An <italic>IRA1</italic> homozygote (barcode ID 10103, re-measured fitness 9.6&#x0025;), an <italic>IRA2</italic> homozygote (barcode ID 5564, re-measured fitness 10.0&#x0025;) and an <italic>IRA2</italic> heterozygote (barcode ID 3577, re-measured fitness 2.8&#x0025;). This suggests that high-fitness effect LoF mutations are recessive since the homozygotes retain their high fitness while the heterozygote does not.</p></list-item>
<list-item><p><bold>Putative GoF mutations at least partially dominant</bold>. In contrast to the paucity of LoF mutations in diploids, GoF mutations are observed in diploids and are exclusively seen in heterozygotes. Missense heterozygote mutations in <italic>ACF2</italic> (barcode ID 2039, re-measured fitness 8.3&#x0025;), <italic>RAS2</italic> (barcode ID 3730, re-measured fitness 13.7&#x0025;), <italic>PSE1</italic> (barcode ID 9689, re-measured fitness 5.7&#x0025;), <italic>VPS3</italic> (barcode ID 15337, re-measured fitness 6.9&#x0025;) and a Chromosomal amplification of Chr11 (barcode ID 3577, re-measured fitness 8.6&#x0025;) are all clearly supplying a fitness benefit above and beyond the fitness effect of being a diploid (4&#x0025;&#x00B1;1&#x0025;).</p></list-item>
</list>
<p>These features become important when we outline the epistasis model. Since self-diploidization is a common mutation the distinction between LoF and GoF is likely to be important when considering double-mutants. Indeed, the high fitness double-mutants we observe are typically Dip&#x002B;GoF mutations and are heterozygote for the GoF mutation since it occurred second. In the epistasis model outlined below we use this biological insight to reason that the order of acquiring mutations is important and profoundly changes the dynamics of genetic diversity. If LoF mutations were able to occur at the same rate on the diploid background as they do on the haploid, for example, the additive model predicts they would dominate the population of double-mutants.</p>
</sec>
</sec>
<sec id="s5"><label>4</label><title>Simulated lineage dynamics with inferred DFEs under 3 models</title>
<p>In <xref ref-type="sec" rid="s3">section 2</xref> we used theory and simulations using simple DFEs to determine genotype and lineage dynamics. Here we perform similar simulations using more realistic DFEs: those directly inferred in both N-lim and C-lim. We show that the insights from simple DFEs hold for these more realistic DFEs: single-mutants drive an expansion in genetic diversity that subsequently crashes due to the emergence of double-mutants.</p>
<p>To simulate the genotype and lineage dynamics with measured single-mutant DFEs, we started with the DFEs inferred in each environment (outlined in <xref ref-type="sec" rid="s2">Section 1</xref>) and made the following changes:</p>
<list list-type="order">
<list-item><p>Lineages that contained multiple-mutants verified via sequencing of clones (see <xref ref-type="sec" rid="s4">Section 3</xref>) were removed from the DFE</p></list-item>
<list-item><p>The de-novo rate of diploidization (fitness classes below the dashed line in <xref ref-type="fig" rid="fig19">Figure 15</xref>) used was 3 &#x00D7; 10<sup>&#x2212;6</sup> per generation. In our previous work [<xref ref-type="bibr" rid="sc5">5</xref>], we discovered that the large class of mutants in the 4&#x0025; range in C-lim and 3&#x0025; range in N-lim were diploids. Based on the high initial fraction (&#x007E; 1&#x0025;) of the population which harbored a diploid mutation, it was also clear that many of these must have been induced during the transformation of barcodes rather than arising de-novo. To estimate the rate of de-novo diploidization we therefore asked what de-novo rate was most consistent with the measured diploid trajectories (<xref ref-type="sec" rid="s7a">Section 6.1</xref>). We found that a de-novo rate of &#x007E; 10<sup>&#x2212;6</sup> was consistent with the rescue time for diploid trajectories. This rate is broadly consistent with the measured the fraction of diploids present in the population in the same experimental conditions but which did not undergo a barcode transformation. After &#x007E; 120 generations of growth an estimated fraction of &#x007E; 10&#x0025; &#x00B1; 3&#x0025; of cells were diploid (Lucas Herrissant, <italic>unpublished data</italic>). Using the fact that this class will behave deterministically, the rate can be estimated using
<disp-formula id="eqn33"><alternatives><graphic xlink:href="170589_eqn33.gif"/></alternatives></disp-formula>
resulting in an estimated rate between 3 &#x00D7; 10<sup>&#x2212;6</sup> &#x2013; 3 &#x00D7; 10<sup>&#x2212;5</sup> per generation. Uncertainties in this number should be stressed too: the exact number of diploids depends on their growth advantage in the growth conditions prior to the serial batch transfer, which are not known.</p>
<p><fig id="fig19" position="float" fig-type="figure"><label>Figure 15:</label>
<caption><title>Caricature DFEs.</title>
<p>(a) The inferred DFE in N-lim from all adaptive lineages and (b) the DFE resulting from excluding known multiple mutant lineages (from sequencing of clones) and revising the rate to Dip mutations (those below dashed line). (c) and (d) the equivalent plots for the C-lim environment. Note the logarithmic scale on the y-axis.</p></caption>
<graphic xlink:href="170589_fig19.tif"/>
</fig></p>
</list-item>
</list>
<p>The results of these two adjustments are shown in <xref ref-type="fig" rid="fig19">Figure 15</xref> (a &#x2192; b for N-lim and c &#x2192; d for C-lim). The mutations below the dashed line are all diploidizations (Dip). In both C-lim and N-lim loss-of-function (LoF) mutations occur at a higher rate than gain-of-function (GoF) mutations. As such for our caricature DFEs we assumed for simplicity that each fitness class above the dashed line has both LoF and GoF mutations which occur with relative rates of 4:1. This is broadly consistent with the number of LoF to GoF mutations seen in each environment (see <xref ref-type="fig" rid="fig4">Figure 4</xref> of [<xref ref-type="bibr" rid="sc5">5</xref>]).</p>
<sec id="s5a"><title>Simulation details</title>
<p>Simulations were performed using a custom written python code (available on request) that simulated the fate of mutations and lineages and plotted the associated diversity measures (entropy) through time. The simulation closely follows the experimental procedure, briefly:</p>
<list list-type="bullet">
<list-item><p>A population of <italic>N</italic> &#x003D; 5 &#x00D7; 10<sup>8</sup> &#x201C;cells&#x201D; are barcoded with <italic>L</italic> &#x003D; 500, 000 tags. The initial population of cells that gets barcoded contains 99&#x0025; ancestor and 1&#x0025; Dip. The distribution of initial abundances is Poisson distributed with a mean of 1000.</p></list-item>
<list-item><p>Each lineage contains a dynamically updated number of genotypes (unique sets of independently occurring mutations), each of which is initially either the ancestor (WT) or the ancestor &#x002B; a diploidization (WT&#x002B;Dip).</p></list-item>
<list-item><p>Genotypes give rise to further genotypes via acquiring mutations drawn from the DFE. The acquisition of new mutations occurs stochastically and in two steps (i) a mutation is generated (ii) a stochastic variable determines whether it establishes, and if it does, the new genotype created starts at establishment size (1/fitness advantage over the mean).</p></list-item>
<list-item><p>Each generation genotypes increase in abundance according to their fitness advantage over the &#x201C;mean fitness&#x201D; (calculated each generation). Genetic drift (arising from small number fluctuations) is modelled implicitly in the establishment process and after this (i.e. at frequencies large enough that drift is irrelevant) lineages are modeled deterministically. Initially for example a (WT&#x002B;Dip) genotype would have a fitness advantage of 4&#x0025; in C-lim or 3&#x0025; in N-lim since this is the fitness effect of Dip in each environment.</p></list-item>
<list-item><p>The abundance of each lineage is simply the sum of the abundances of all genotypes within that lineage (which can be multiple). Genotype and lineage abundances are recorded every 8 generations.</p></list-item>
</list>
<sec id="s5a1"><label>4.1</label><title>Single-mutant model</title>
<p>In the single-mutant-model simulations, any cell that has acquired a mutation can no longer mutate and thus only single-mutant genotypes exist and competition between these determines the entire lineage and genotype dynamics. In both environments (C-lim, <xref ref-type="fig" rid="fig20">Figure 16</xref>; N-lim, <xref ref-type="fig" rid="fig21">17</xref>) this model produces lineage and diversity dynamics that are not in agreement with observations. The single-mutant model predicts too many lineages that remain at intermediate-high frequencies at the later time points (3rd row, &#x201C;Muller&#x201D; plot) as compared with the experimental lineage data. This produces elevated levels of diversity (as measured via the entropy of all adaptive lineages, 4th row) again above observations (<xref ref-type="fig" rid="fig3">Figure 3</xref> of main text).</p>
<fig id="fig20" position="float" fig-type="figure"><label>Figure 16:</label>
<caption><title>C-lim Single-mutants.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in C-lim under a singlemutant only model. Each column is a replicate and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, genotypes colored according to color-key on top of figure), the abundance of each adaptive lineage (different colors are here chosen arbitrarily for visualization purposes) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig20.tif"/>
</fig>
<fig id="fig21" position="float" fig-type="figure"><label>Figure 17:</label>
<caption><title>N-lim Single-mutants.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in N-lim under a singlemutant only model. Each column is a replicate and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, genotypes colored according to color-key on top of figure), the abundance of each adaptive lineage (different colors are here chosen arbitrarily for visualization purposes) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig21.tif"/>
</fig>
<p>As expected most of the adaptation in the single-mutant model is driven by the high-fitness LoF and GoF mutations (light and dark green lines in 2nd row of both <xref ref-type="fig" rid="fig20">Figure 16</xref> and <xref ref-type="fig" rid="fig21">17</xref>)</p>
<p>There are a number of reasons this model is not accurately capturing the correct lineage and diversity dynamics. First, is that the whole genome sequencing of clones gives direct evidence that very fit double mutants are the most abundant genotypes in the population at late times in both C-lim and N-lim. Second, the adaptive lineage dynamics do not match the observed ones: competition between single mutants alone is not enough to explain the crash in genetic diversity observed across both environemtns.</p>
</sec>
<sec id="s5a2"><label>4.2</label><title>Additive model</title>
<p>In the additive simulations, cells can continue to stochastically acquire multiple adaptive mutations (waves of different colors in row 2 of <xref ref-type="fig" rid="fig22">Figures 18</xref> and <xref ref-type="fig" rid="fig23">19</xref> (color key on top of plot). New mutations are drawn from the same unchanging DFE (i.e. the DFE is independent of genotype) and fitness effects of mutations combine additively. This model would be appropriate if epistasis were rare, and cells were able to acquire many different LoF and GoF mutations that do not interact.</p>
<fig id="fig22" position="float" fig-type="figure"><label>Figure 18:</label>
<caption><title>C-lim Multiple-mutants.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in C-lim under the additive model. Each column is a replicate simulation and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, genotypes colored according to color-key on top of figure), the abundance of each adaptive lineage (different colors are here chosen arbitrarily for visualization purposes) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig22.tif"/>
</fig>
<fig id="fig23" position="float" fig-type="figure"><label>Figure 19:</label>
<caption><title>N-lim Multiple-mutants.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in N-lim under the multiple-mutant no epistasis model. Each column is a replicate and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, grey is the ancestor, blue are single mutants), the abundance of each adaptive lineage (different colors) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig23.tif"/>
</fig>
<p>For the C-lim simulations (<xref ref-type="fig" rid="fig22">Figure 18</xref>) this model also produces lineage and diversity dynamics that are not in agreement with observations. First, the lineage dynamics (<xref ref-type="fig" rid="fig22">Figure 18</xref>) predicted by such a model are qualitatively different than those observed, whereby at intermediate-late times lineages are predicted to undergo large-scale fluctuations over long timescales (&#x007E;50 generations) which we never observe in the experimental data (see columns b, d and e in <xref ref-type="fig" rid="fig22">Figure 18</xref> as examples). These lineage dynamics produce trajectories of the adaptive lineage entropy which are in disagreement with observations: diversity either does not crash as dramatically and remains high even out to 300 generations as the competition between a few fit lineages continues, or it crashed too dramatically due to a very early LoF&#x002B;LoF mutant (columns a and c in <xref ref-type="fig" rid="fig22">Figure 18</xref> show examples). While these look qualitatively similar to the crashed observed in the data (<xref ref-type="fig" rid="fig1">Figure 1</xref> of main text, and entropy plots in <xref ref-type="fig" rid="fig3">Figure 3</xref> of main text) they are typically sharper: the entropy falling off more rapidly between 150-200 generations than is observed in experiment.</p>
<p>Another key difference between the predictions of the additive model and the observations comes from comparing the types of clones that should dominate the population at intermediate and late times. The additive model predicts that the dominant double-mutant clones over generations 150 - 300 in the 50 simulations performed are LoF&#x002B;LoF (18/50), Dip&#x002B;LoF (14/50), early triple mutants (11/50) GoF&#x002B;LoF (4/50) or Dip&#x002B;GoF (3/50). This is at odds with the sequencing of clones where we observe Dip&#x002B;GoF double-mutants to be the most dominant. Furthermore, this additive model predicts that diploid trajectories (see main text <xref ref-type="fig" rid="fig4">Figure 4</xref> and supplementary <xref ref-type="sec" rid="s7a">section 6.1</xref>) will undergo a double-dip whereby the rescue, driven by Dip&#x002B;LoF clones will be outcompeted by LoF&#x002B;LoF clones, which also disagrees with our data.</p>
<p>For N-lim simulations (<xref ref-type="fig" rid="fig23">Figure 19</xref>) using the additive model produces lineage dynamics which are qualitatively similar to those observed. The entropy adaptive lineage trajectories predicted by this model (see 4th row of <xref ref-type="fig" rid="fig23">Figure 19</xref>) are also in reasonable agreement with observed trajectories. However model predictions are in disagreement with observations in two important ways. First, the dominant intermediate/late time genotype (the one driving the diversity crash) is predicted to be Dip&#x002B;LoF, which is not observed in our data. Second, the more modest fitness advantage of the haploid LoF and GoF mutations in N-lim coupled with the the expansion of Dip&#x002B;LoF mutants, predict that the diploid trajectories in N-lim (see <xref ref-type="fig" rid="fig4">Figure 4</xref> main text) should sweep to fixation almost every time with no dip. This is again in disagreement with data.</p></sec>
<sec id="s5a3"><label>4.3</label><title>Epsitasis model</title>
<p>The whole genome sequencing of hundred of adaptive clones (see <xref ref-type="sec" rid="s4">Section 3</xref>) and the Diploid trajectories (see <xref ref-type="sec" rid="s7a">section 6.1</xref> and main text <xref ref-type="fig" rid="fig4">Figure 4</xref>) produced a number of somewhat surprising results including:</p>
<list list-type="bullet">
<list-item><p>In both environments no example of a double-mutant composed of two fit single mutant SNPs was found e.g. (LoF&#x002B;LoF) or (LoF&#x002B;GoF) or (GoF&#x002B;LoF) or (GoF &#x002B; GoF).</p></list-item>
<list-item><p>The double mutants observed (and that dominate the population at late times) were either Dip&#x002B;GoF (and thus heterozygote for the GoF mutation since it occurred after diploidization) or (LoF&#x002B;Dip) (and thus homozygote for the LoF mutation since it preceded diploidization).</p></list-item>
<list-item><p>Diploid abundance in all replicate evolutions undergoes an expansion-contraction-expansion dynamics.</p></list-item>
<list-item><p>Cells do not undergo further genome duplications (e.g. to become tetraploid).</p></list-item>
<list-item><p>The fitnesses (those from the original lineage tracking data and the fitness re-measurements) of double mutants (WT&#x002B;Dip&#x002B;GoF) and (WT&#x002B;LoF&#x002B;Dip) combine approximately additively</p></list-item>
</list>
<p>Together, these observations suggested a simple model for epistasis in which, while there are 3 classes of single mutants (Dip, LoF, GoF) there are only three possible double mutants as shown <xref ref-type="fig" rid="fig4">Figure 4A</xref> of the main text. The key features of the epistasis model we use are:</p>
<list list-type="bullet">
<list-item><p>if first mutation is Dip then second mutations can only be GoF drawn from rates to GoF mutations in the DFE for that environment (&#x007E; 10<sup>&#x2212;8</sup> per generation).</p></list-item>
<list-item><p>if first mutation is LoF then second mutations can only be Dip which occurs at rate of 10<sup>&#x2212;6</sup>/gen independent of LoF mutation</p></list-item>
<list-item><p>if first mutation is GoF then second mutations can only be Dip which occurs at rate of 10<sup>&#x2212;6</sup>/gen independent of GoF mutation</p></list-item>
</list>
<p>The predictions for this model from 5 replicate simulations are shown in <xref ref-type="fig" rid="fig24">Figure 20</xref> (C-lim) and <xref ref-type="fig" rid="fig25">21</xref> N-lim. For C-lim simulations the epistasis model produces lineage dynamics and diversity trajectories (adaptive lineage entropy trajectories) in close agreement with observations. While there remains considerable stochasticity, the dominance of a handful of doublemutant genotypes (red trajectories, 2nd row <xref ref-type="fig" rid="fig24">Figure 20</xref>) and corresponding dominance of a handful of lineages (3rd row) is consistent with data. Importantly, this model also predicts that overly dominant double-mutants are more likely to be caused by (Dip&#x002B;GoF) and that these are most often the cause of the diversity crash.</p>
<fig id="fig24" position="float" fig-type="figure"><label>Figure 20:</label>
<caption><title>C-lim Epistasis model.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in C-lim under the epistasis model. Each column is a replicate and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, grey is the ancestor, blue are single mutants), the abundance of each adaptive lineage (different colors) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig24.tif"/>
</fig>
<fig id="fig25" position="float" fig-type="figure"><label>Figure 21:</label>
<caption><title>N-lim Epistasis model.</title>
<p>(a&#x2013;e) 5 randomly sampled simulated replicates of the dynamics in N-lim under the epistasis model. Each column is a replicate and shows the mean fitness of cells relative to the ancestor over time (1st row), the abundance of every genotype in the population through time on a log-scale (2nd row, grey is the ancestor, blue are single mutants), the abundance of each adaptive lineage (different colors) ranked top to bottom by lineage size at generation 300 (third row) and the entropy of all adaptive lineages through time (4th row) as measured via all genotypes (solid line) and via adaptive lineages (data points).</p></caption>
<graphic xlink:href="170589_fig25.tif"/>
</fig>
<p>For N-lim simulations, lineage trajectories alone show less clear evidence that the epistasis model agrees more with observations compared to the additive model. In fact, the epistasis model produces similar lineage trajectories and slightly slower entropy expansion than is observed. However the advantage of the epistasis model is that, while it produces similar lineage dynamics, it predicts that the specific genotypes that dominate the population will be (Dip&#x002B;GoF) rather than (Dip &#x002B; LoF) predicted by the multiple-mutant model.</p>
<sec id="s5a3a"><title>The possibility of further LoF and GoF mutations</title>
<p>This epistasis model shown in <xref ref-type="fig" rid="fig20">Figures 16</xref> - <xref ref-type="fig" rid="fig25">21</xref> does not permit the the acquisition of more than two mutations. This is clearly unnatural since it is inevitable that further mutations enter at later times and expand. However this simple model appears sufficient to explain the dynamics we observe in the early stages of the experimental evolutions we performed. This suggests that single-mutants with highly fit LoF or GoF mutations have (i) fewer high fitness mutations available to them or (ii) that the fitness effects of new mutations is significantly reduced or (iii) a combination of these. Studying the emergence of multiple-mutants beyond double-mutants, however, and their impact on genetic diversity will likely require re-barcoding techniques as discussed and referenced in the main text as well as longer term whole-population sequencing efforts as in [<xref ref-type="bibr" rid="sc7">7</xref>,<xref ref-type="bibr" rid="sc8">8</xref>].</p>
</sec>
</sec>
</sec>
</sec>
<sec id="s6"><label>5</label><title>Lineage abundances and calculation of adaptive lineage diversity</title>
<p>Here we outline how we produced <xref ref-type="fig" rid="fig1">Figure 1</xref> of the main text as well as trajectories for the genetic diversity (entropy) in <xref ref-type="fig" rid="fig3">Figure 3</xref> of the main text.</p>
<sec id="s6a"><label>5.1</label><title>Interpolating and extrapolating lineage abundances</title>
<p>To plot <xref ref-type="fig" rid="fig1">Figure 1</xref> of the main text we use all of the time points sequenced to best interpolate and extrapolate the abundance of each lineage in the population. To do this we use the first 104 generations of C-lim and the first 192 generations of N-lim data to estimate the fitness of each lineage using the same methods as outlined in [<xref ref-type="bibr" rid="sc1">1</xref>], which produce fitness estimates for each lineage as well as the time evolution of the population mean fitness. We then &#x201C;forecast&#x201D; the abundance for times later than T104 (C-lim) or T192 (N-lim) by:
<list list-type="order">
<list-item><p>Using the inferred fitness <italic>x<sub>i</sub></italic> and the initial mean fitness <italic>&#x0078;&#x0304;</italic>(<italic>t</italic><sub>0</sub>) to predict the frequencies at the next time point:
<disp-formula id="eqn34"><alternatives><graphic xlink:href="170589_eqn34.gif"/></alternatives></disp-formula></p>
</list-item>
<list-item><p>Recalculate the new mean fitness at this later time point:
<disp-formula id="eqn35"><alternatives><graphic xlink:href="170589_eqn35.gif"/></alternatives></disp-formula>
and iterate each generation until T304. The result of this procedure can be validated against the known abundance of the lineage measured from sequencing data at the later time points. Comparisons for how well this procedure works is shown in <xref ref-type="fig" rid="fig26">Figures 22</xref> and <xref ref-type="fig" rid="fig27">23</xref>.</p>
<p><fig id="fig26" position="float" fig-type="figure"><label>Figure 22:</label>
<caption><title>Interpolation and extrapolation of lineage abundance trajectories, C-lim replicate 1.</title>
<p>The top 30 barcodes ranked by abundance. Each panel shows a measured barcode trajectory (data points) vs. the predicted trajectory from the extrapolation procedure (solid line). Colors indicate fitness level. Shaded panels are those lineages from which a clone was picked and subsequently whole-genome sequenced.</p></caption>
<graphic xlink:href="170589_fig26.tif"/>
</fig>
<fig id="fig27" position="float" fig-type="figure"><label>Figure 23:</label>
<caption><title>Interpolation and extrapolation of lineage abundance trajectories, C-lim replicate 1.</title>
<p>The top 30 barcodes ranked by abundance. Each panel shows a measured barcode trajectory (data points) vs. the predicted trajectory from the extrapolation procedure (solid line). Colors indicate fitness level. Shaded panels are those lineages from which a clone was picked and subsequently whole-genome sequenced.</p></caption>
<graphic xlink:href="170589_fig27.tif"/>
</fig></p>
</list-item>
</list>
</p>
</sec>
<sec id="s6b"><label>5.2</label><title>Diversity measured via adaptive lineage entropy</title>
<p>To quantify genetic diversity we use the Shannon entropy of adaptive lineage through time defined here as
<disp-formula id="eqn36"><alternatives><graphic xlink:href="170589_eqn36.gif"/></alternatives></disp-formula>
where <italic>f<sub>i</sub></italic>(<italic>t</italic>) is the frequency of lineage <italic>i</italic> at time <italic>t</italic> and the sum is over all <italic>adaptive</italic> lineages (excluding diploids) identified using the same method as in [<xref ref-type="bibr" rid="sc1">1</xref>] (using lineage deviation from a neutral expectation). The numerical value of <italic>S</italic> can be interpreted, very roughly, as there being effectively &#x007E; <italic>e<sup>S</sup></italic> adaptive lineages present in the population. Note that we exclude diploids from our definition because most diploid lineages are genetically identical despite adaptive clones arising in a large number of lineages. SNPs by contrast are typically genetically unique.</p>
<sec id="s6b1"><title>Other possible measures of diversity</title>
<p>The diversity is really a statement about the distribution of adaptive clones sizes and how this changes through time as shown by the colored lines in the 2nd rows of <xref ref-type="fig" rid="fig20">Figures 16</xref> - <xref ref-type="fig" rid="fig25">21</xref>.</p>
<p>However, if one wants to compare many replicates it becomes difficult unless one chooses a statistic based on the distribution of clone or lineage abundances. The entropy is one such measure. We do not claim that the entropy is the &#x201C;correct&#x201D; measure of diversity since there are many alternatives, but it <italic>does</italic> capture the important qualitative distinction between the early vs. late distribution of clone sizes in the populations. Early, there are many small clones of roughly equal size, whereas late there is a very skewed distribution with a small number of very large clones, and the entropy measure captures this difference as discussed in <xref ref-type="sec" rid="s3e">Section 2.5</xref> and in the bottom rows of <xref ref-type="fig" rid="fig20">Figures 16</xref> - <xref ref-type="fig" rid="fig25">21</xref>. Crucially, the entropy of adaptive lineages tracks the entropy of adaptive genotypes into the diversity crash.</p>
<p>One consideration for a diversity measure is how much to weight low frequency lineages. Consider the case where one adaptive lineage is large, at frequency <italic>p</italic> while the <italic>k</italic> &#x226B; 1 other lineages are at frequency 1 &#x2013; <italic>p</italic>/<italic>k</italic>. In this case the contribution from the low frequency lineages would be (1 &#x2013; <italic>p</italic>)log(<italic>k</italic>/(1 &#x2013; <italic>p</italic>)) which would mean that the low frequency lineages would contribute more to the entropy than the dominant lineage when <italic>p</italic> &#x003C; 1 &#x2013; 1/log(<italic>k</italic>). A reasonable alternative measure of diversity, would be to weight variants not with log(<italic>p<sub>i</sub></italic>) (as one does in the entropy measure), but with a different functional form. For example, if we used a diversity measure:
<disp-formula id="eqn37"><alternatives><graphic xlink:href="170589_eqn37.gif"/></alternatives></disp-formula>
where 0 &#x2265; <italic>&#x03B3;</italic> &#x2264; 1, the contribution from the low frequency lineages would be enhanced over simple linear weighting, (and in the limit of <italic>&#x03B3;</italic> &#x003D; 0 it is simply a count of how many are present). Following the same line of argument as above, the contribution of the low frequency lineages would be larger than the single large lineage if 1 &#x2013; <italic>p</italic> &#x003C; <italic>k</italic><sup>1&#x2013;1/<italic>&#x03B3;</italic></sup>.</p>
<p>Other reasonable choices of the diversity measure could be made. One simple example would be a step function counting how many lineages reach above a threshold size <italic>p</italic><sub>0</sub> over time. Because many adaptive lineages reach frequencies above 10<sup>&#x2212;5</sup>, but many of them dip below this frequency at late times, for parameter values 10<sup>&#x2212;5</sup> &#x003C; <italic>p</italic><sub>0</sub> &#x003C; 10<sup>&#x2212;3</sup>, this measure would be qualitatively similar to the entropy measure, though has the drawback of having to make a somewhat arbitrary choice for <italic>p</italic><sub>0</sub>.</p>
</sec>
</sec>
</sec>
<sec id="s7"><label>6</label><title>Diploid trajectories</title>
<sec id="s7a"><label>6.1</label><title>Measuring diploid abundance through time</title>
<p>We suspended cells (from either the carbon or nitrogen limited evolution) from a frozen stock into 1mL of water. We used a coulter counter (Beckman Coulter: 6605700) to quantify cell concentration, then used 5-8 glass beads to spread &#x007E; 400 cells onto Nunc plates (ThermoFisher Cat &#x0023;: 267060) containing YPD agar (10g yeast extract Fisher: 212750, 20g peptone Fisher: 211677, 20g dextrose Sigma Aldrich: G8270-5KG, 20g agar Fisher: 214010, bring up to 1L with DO water) supplemented with 2x G418 (8mL of 50mg/mL stock into 1L YPD) and allowed them to grow for two days at 30&#x00B0;C. Then we scanned plates at 600 dpi resolution and inputted the resulting images into a custom written MATLAB code (available on request), which infers coordinates for individual colonies based on the scanned image. We then used a ROTOR STINGER robot (Singer Instruments) to pick colonies into 96 well plates (ThermoFisher: 265301) containing YPD with 2x G418. These plates were placed in a 30&#x00B0;C incubator and grown overnight. We next used the ROTOR STINGER robot to replicate the 96 well plates onto a square plate with Benomyl media, and control plate with DMSO (Sigma Aldrich: 472301) media. The Benomyl media was made from a 10mg/ml stock of Benomyl (Sigma Adrich Cat &#x0023;: 381586-5G) in DMSO by adding 2 mL of stock Benomyl drop-wise while stirring to one liter of YPD that had been allowed to cool to about 55&#x00B0;C. The final concentration of the Benomyl media was 10 <italic>&#x03BC;</italic>g/ml. The cells replicated onto Benomyl and DMSO plates were grown up for 2 days at 30&#x00B0; C. After 48 hours growth, each plate was scanned. Haploids are able to grow better on Benomyl media while diploids grow more slowly. For each colony that grew on the control plate, we checked the corresponding positions on Benomyl plate and counted how many grew poorly (see <xref ref-type="fig" rid="fig28">Figure 24</xref>). Diploid frequencies were then calculated as the fraction of those colonies that grew poorly.</p>
<fig id="fig28" position="float" fig-type="figure"><label>Figure 24:</label>
<caption><title>Benomyl assay for quantifying diploid abundances.</title>
<p>Example plates showing the growth of 96 randomly sampled colonies from the population on a control plate (YPD) (a) and on a plate containing benomyl (YPD&#x002B;Benomyl) (b) where the growth of diploids is inhibited.</p></caption>
<graphic xlink:href="170589_fig28.tif"/>
</fig>
</sec>
<sec id="s7b"><label>6.2</label><title>Predicted diploid trajectories under the 3 models</title>
<p>To track diploid trajectories, one does not need lineage information. Thus, diploid trajectory simulations were implemented independently since they are far more efficient without the large number of lineage labels that are required in the simulations outlined in <xref ref-type="sec" rid="s5">Section 4</xref>.</p>
<p>The frequency trajectory of diploids in the population though time is then calculated using the following stochastic simulation:</p>
<list list-type="bullet">
<list-item><p>The initial abundance of diploids is set at 1&#x0025;, based on direct measurement from the colony growth assay.</p></list-item>
<list-item><p>The initial abundance of fitter LoF and GoF mutations is generated stochastically by realizing that their effective starting number will be roughly Poisson distributed with mean <italic>n</italic><sub>0</sub> &#x003D; <italic>NU<sub>LOF</sub></italic> or <italic>n</italic><sub>0</sub> &#x003D; <italic>NU<sub>GOF</sub></italic> which then grow deterministically through time as <italic>n</italic><sub>0</sub><italic>e<sup>st</sup></italic>/<italic>s</italic>. (parameter values in the table below). Drift for the single mutants can be safely ignored since <italic>n</italic><sub>0</sub> for each of the three classes is a large parameter i.e <italic>NU<sub>LoF</sub></italic> &#x226B; 1 and <italic>NU<sub>GoF</sub></italic> &#x226B; 1.</p></list-item>
<list-item><p>These three expanding classes can each acquire further mutations whose mutation rates and fitness effects are outlined in the tables below. These double mutants change in frequency between time points by generating a Poisson sample the new expected number of cells and normalizing by <italic>N</italic> in order to include the stochasticity of drift: which is crucial for the double-mutants.</p>
</list-item>
</list>
<p>Each model is specified by a number of parameters:</p>
<table-wrap id="tbl3" orientation="portrait" position="float"><label>Table 3:</label>
<caption><p>Values used for the simulations of diploid trajectories in C-lim.</p></caption>
<graphic xlink:href="170589_tbl3.tif"/>
</table-wrap>
<table-wrap id="tbl4" orientation="portrait" position="float"><label>Table 4:</label>
<caption><p>Values used for the simulations of diploid trajectories in N-lim.</p></caption>
<graphic xlink:href="170589_tbl4.tif"/>
</table-wrap>
<fig id="fig29" position="float" fig-type="figure"><label>Figure 25:</label>
<caption><title>C-lim diploid, LoF and GoF trajectories for 3 models of mutation acquisition.</title>
<p>(a) single-mutant model (b) additive model and, (c), epistasis model. The 2nd and 3rd columns show the trajectory of LoF and GoF mutants as classes. Coloring is consistent across the three plots so that a yellow trajectory in one column is the same color across all three columns since it comes from the same simulation.</p></caption>
<graphic xlink:href="170589_fig29.tif"/>
</fig>
<fig id="fig30" position="float" fig-type="figure"><label>Figure 26:</label>
<caption><title>N-lim diploid, LoF and GoF trajectories for 3 models of mutation acquisition.</title>
<p>(a) single-mutant model (b) additive model and, (c), epistasis model. The 2nd and 3rd columns show the trajectory of LoF and GoF mutants as classes. Coloring is consistent across the three plots so that a yellow trajectory in one column is the same color across all three columns since it comes from the same simulation.</p></caption>
<graphic xlink:href="170589_fig30.tif"/>
</fig>
</sec>
</sec>
</sec>
<ref-list><title>References</title>
<ref id="sc1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><surname>Sasha</surname> <given-names>F. Levy</given-names></string-name>, <string-name><surname>Jamie</surname> <given-names>R. Blundell</given-names></string-name>, <string-name><surname>Sandeep</surname> <given-names>Venkataram</given-names></string-name>, <string-name><surname>Dmitri</surname> <given-names>A. Petrov</given-names></string-name>, <string-name><surname>Daniel</surname> <given-names>S. Fisher</given-names></string-name>, and <string-name><surname>Gavin</surname> <given-names>Sherlock</given-names></string-name>. <article-title>Quantitative evolutionary dynamics using high-resolution lineage tracking</article-title>. <source><underline>Nature</underline></source>, <volume>519</volume>(<issue>7542</issue>):<fpage>181</fpage>&#x2013;<lpage>186</lpage>, <month>March</month> <year>2015</year>. ISSN 0028-0836. URL <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/nature/journal/v519/n7542/abs/nature14279.html">http://www.nature.com/nature/journal/v519/n7542/abs/nature14279.html</ext-link>.</mixed-citation></ref>
<ref id="sc2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><surname>Cornelis</surname> <given-names>Verduyn</given-names></string-name>, <string-name><surname>Erik</surname> <given-names>Postma</given-names></string-name>, <string-name><given-names>W.</given-names> <surname>Alexander Scheffers</surname></string-name>, and <string-name><surname>Johannes</surname> <given-names>P. Van Dijken</given-names></string-name>. <article-title>Effect of benzoic acid on metabolic fluxes in yeasts: A continuous-culture study on the regulation of respiration and alcoholic fermentation</article-title>. <source><underline>Yeast</underline></source>, <volume>8</volume>(<issue>7</issue>): <fpage>501</fpage>&#x2013;<lpage>517</lpage>, <month>July</month> <year>1992</year>. ISSN 1097-0061. URL <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1002/yea.320080703/abstract">http://onlinelibrary.wiley.com/doi/10.1002/yea.320080703/abstract</ext-link>.</mixed-citation></ref>
<ref id="sc3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><surname>Michael</surname> <given-names>M. Desai</given-names></string-name> and <string-name><surname>Daniel</surname> <given-names>S. Fisher</given-names></string-name>. <article-title>Beneficial mutation selection Balance and the Effect of Linkage on Positive Selection</article-title>. <source><underline>Genetics</underline></source>, <volume>176</volume>(<issue>3</issue>):<fpage>1759</fpage>&#x2013;<lpage>1798</lpage>, <month>July</month> <year>2007</year>. ISSN 0016&#x2013;6731, 1943&#x2013;2631. URL <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/176/3/1759">http://www.genetics.org/content/176/3/1759</ext-link>.</mixed-citation></ref>
<ref id="sc4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><surname>Philipp</surname> <given-names>W. Messer</given-names></string-name> and <string-name><surname>Richard</surname> <given-names>A. Neher</given-names></string-name>. <article-title>Estimating the Strength of Selective Sweeps from Deep Population Diversity Data</article-title>. <source><underline>Genetics</underline></source>, <volume>191</volume>(<issue>2</issue>):<fpage>593</fpage>&#x2013;<lpage>605</lpage>, <month>June</month> <year>2012</year>. ISSN 0016&#x2013;6731, 1943&#x2013;2631. URL <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/191/2/593">http://www.genetics.org/content/191/2/593</ext-link>.</mixed-citation></ref>
<ref id="sc5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><surname>Sandeep</surname> <given-names>Venkataram</given-names></string-name>, <string-name><surname>Barbara</surname> <given-names>Dunn</given-names></string-name>, <string-name><surname>Yuping</surname> <given-names>Li</given-names></string-name>, <string-name><surname>Atish</surname> <given-names>Agarwala</given-names></string-name>, <string-name><surname>Jessica</surname> <given-names>Chang</given-names></string-name>, <string-name><surname>Emily</surname> <given-names>R. Ebel</given-names></string-name>, <string-name><surname>Kerry</surname> <given-names>Geiler-Samerotte</given-names></string-name>, <string-name><surname>Lucas</surname> <given-names>Herrissant</given-names></string-name>, <string-name><surname>Jamie</surname> <given-names>R. Blundell</given-names></string-name>, <string-name><surname>Sasha</surname> <given-names>F. Levy</given-names></string-name>, <string-name><surname>Daniel</surname> <given-names>S. Fisher</given-names></string-name>, <string-name><surname>Gavin</surname> <given-names>Sherlock</given-names></string-name>, and <string-name><surname>Dmitri</surname> <given-names>A. Petrov</given-names></string-name>. <article-title>Development of a Comprehensive Genotype-to-Fitness Map of Adaptation-Driving Mutations in Yeast</article-title>. <source><underline>Cell</underline></source>, <volume>0</volume>(<issue>0</issue>), <month>September</month> <year>2016</year>. ISSN 0092&#x2013;8674, <fpage>1097</fpage>&#x2013;<lpage>4172</lpage>. URL /cell/abstract/S0092-8674(16)31010-8.</mixed-citation></ref>
<ref id="sc6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>Jungeui</surname> <given-names>Hong</given-names></string-name> and <string-name><surname>David</surname> <given-names>Gresham</given-names></string-name>. <article-title>Molecular Specificity, Convergence and Constraint Shape Adaptive Evolution in Nutrient-Poor Environments</article-title>. <source><underline>PLOS Genetics</underline></source>, <volume>10</volume>(<issue>1</issue>):<fpage>e1004041</fpage>, <month>January</month> <year>2014</year>. ISSN 1553&#x2013;7404. URL <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004041">http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004041</ext-link>.</mixed-citation></ref>
<ref id="sc7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Gregory</surname> <given-names>I. Lang</given-names></string-name>, <string-name><surname>Daniel</surname> <given-names>P. Rice</given-names></string-name>, <string-name><surname>Mark</surname> <given-names>J. Hickman</given-names></string-name>, <string-name><surname>Erica</surname> <given-names>Sodergren</given-names></string-name>, <string-name><surname>George</surname> <given-names>M. Weinstock</given-names></string-name>, <string-name><surname>David</surname> <given-names>Botstein</given-names></string-name>, and <string-name><surname>Michael</surname> <given-names>M. Desai</given-names></string-name>. <article-title>Pervasive genetic hitchhiking and clonal interference in forty evolving yeast populations</article-title>. <source><underline>Nature</underline></source>, <volume>500</volume>(<issue>7464</issue>):<fpage>571</fpage>&#x2013;<lpage>574</lpage>, <month>August</month> <year>2013</year>. ISSN 0028&#x2013;0836. URL <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/nature/journal/v500/n7464/full/nature12344.html">http://www.nature.com/nature/journal/v500/n7464/full/nature12344.html</ext-link>.</mixed-citation></ref>
<ref id="sc8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Daniel</surname> <given-names>J. Kvitek</given-names></string-name> and <string-name><surname>Gavin</surname> <given-names>Sherlock</given-names></string-name>. <string-name><surname>Whole</surname> <given-names>Genome</given-names></string-name>, <article-title>Whole Population Sequencing Reveals That Loss of Signaling Networks Is the Major Adaptive Strategy in a Constant Environment</article-title>. <source><underline>PLoS Genet</underline></source>, <volume>9</volume>(<issue>11</issue>):<fpage>e1003972</fpage>, <month>November</month> <year>2013</year>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1003972">http://dx.doi.org/10.1371/journal.pgen.1003972</ext-link>.</mixed-citation></ref>
</ref-list>
</back>
</article>