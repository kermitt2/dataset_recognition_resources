<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/071951</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Phenoscape Knowledgebase: tools and APIs for computing across phenotypes from evolutionary diversity and model organisms</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8688-6599</contrib-id>
<name><surname>Balhoff</surname><given-names>James P.</given-names></name>
</contrib>
<aff><institution>RTI International Research Triangle Park</institution>, NC, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn id="n1"><p><email>jbalhoff@rti.org</email></p></fn>
<fn id="n2"><p>Phenoscape project team <ext-link ext-link-type="uri" xlink:href="http://phenoscape.org/wiki/Acknowledgments">http://phenoscape.org/wiki/Acknowledgments</ext-link></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2016</year>
</pub-date>
<elocation-id>071951</elocation-id>
<history>
<date date-type="received"><day>27</day><month>8</month><year>2016</year></date>
<date date-type="accepted"><day>28</day><month>8</month><year>2016</year></date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="071951.pdf" content-type="pdf" xlink:role="full-text"/>
<counts>
<page-count count="2"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><label>I.</label><title>Introduction</title>
<p>The Phenoscape Knowledgebase (KB) is an ontology-driven database that combines existing phenotype annotations from model organism databases with new phenotype annotations from the evolutionary literature. Phenoscape curators have created phenotype annotations for more than 5,000 species and higher taxa, by defining computable phenotype concepts for more than 20,000 character states from over 160 published phylogenetic studies. These phenotype concepts are in the form of Entity&#x2013;Quality (EQ) [<xref ref-type="bibr" rid="c1">1</xref>] compositions which incorporate terms from the Uberon anatomy ontology, the Biospatial Ontology (BSPO), and the Phenotype and Trait Ontology (PATO). Taxonomic concepts are drawn from the Vertebrate Taxonomy Ontology (VTO). This knowledge of comparative biodiversity is linked to potentially relevant developmental genetic mechanisms by importing associations of genes to phenotypic effects and gene expression locations from zebrafish (ZFIN [<xref ref-type="bibr" rid="c2">2</xref>]), mouse (MGI [<xref ref-type="bibr" rid="c3">3</xref>]), Xenopus (Xenbase [<xref ref-type="bibr" rid="c4">4</xref>]), and human (Human Phenotype Ontology project [<xref ref-type="bibr" rid="c5">5</xref>]). Thus far, the Phenoscape KB has been used to identify candidate genes for evolutionary phenotypes [<xref ref-type="bibr" rid="c6">6</xref>], to match profiles of ancestral evolutionary variation with gene phenotype profiles [<xref ref-type="bibr" rid="c7">7</xref>], and to combine data across many evolutionary studies by inferring indirectly asserted values within synthetic supermatrices [<xref ref-type="bibr" rid="c8">8</xref>]. Here we describe the software architecture of the Phenoscape KB, including data ingestion, integration of OWL reasoning, web service interface, and application features (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Fig. 1.</label>
<caption><title>Phenoscape KB software architecture and data flow.</title></caption>
<graphic xlink:href="071951_fig1.tif"/>
</fig>
</sec>
<sec id="s2"><label>II.</label><title>Data Ingestion and Inference Materialization</title>
<p>Phenoscape curators annotate character by taxon matrices associated with phylogenetic publications using the Phenex software [<xref ref-type="bibr" rid="c9">9</xref>], following the curation process described by Dahdul et al. [<xref ref-type="bibr" rid="c10">10</xref>]. The resulting NeXML data files, along with tab-delimited data dumps obtained from model organism databases, are translated into OWL models (including definitions of EQ phenotypes) using the Phenoscape data ingest pipeline (phenoscape-owl-tools, available with all other described software under an MIT open source license in the Phenoscape GitHub repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/phenoscape">https://github.com/phenoscape</ext-link>). OWL transformation code for individual data sources is kept concise and readable by using a Scala-based domain specific language for OWL axioms (Scowl) [<xref ref-type="bibr" rid="c11">11</xref>]. Next, all OWL data files, along with referenced ontologies, are processed to standardize property IRIs; in many cases community ontologies use non-standard or competing IRIs for the &#x201C;same&#x201D; property, e.g. our system accounts for ten variants of the <italic>part_of</italic> property. We rename these, rather than assert equivalence axioms, to simplify downstream reasoning and querying.</p>
<p>Based on the content of the data and reference ontologies, several &#x201C;ontologies&#x201D; are programmatically generated, for the purpose of precomputing inferred concept hierarchies supporting various Phenoscape use cases: 1) materialization of the transitive closure for selected properties; 2) generation of grouping phenotypes for semantic similarity queries; 3) generation of &#x201C;absence&#x201D; concepts for custom negation reasoning. The ELK reasoner [<xref ref-type="bibr" rid="c12">12</xref>] is then used to compute the inferred classification hierarchy, and inferred subclass axioms are materialized into concrete assertions. Because ELK does not support negation reasoning, we have also implemented a custom procedure to compute a class hierarchy for a predetermined set of negations [<xref ref-type="bibr" rid="c13">13</xref>]. To make reasoning on this large dataset feasible, we extract only the class axioms (Tbox) for input into ELK. This is sufficient for our purposes since most of the data is in the form of compositional class expressions; however it does restrict use cases that would rely on inference of property assertions or instance classification. All data, including asserted and inferred class axioms as well as instance data, are loaded into the Blazegraph RDF triple store [<xref ref-type="bibr" rid="c14">14</xref>], constituting approximately 100 million RDF triples. A separate OWL file including only class axioms (&#x007E;870,000 logical axioms) is saved for later use in reasoner queries.</p>
</sec>
<sec id="s3"><label>III.</label><title>Semantic Similarity Precomputation</title>
<p>Phenotypic profiles for evolutionarily variable taxonomic nodes and model organism genes are computed as described in [<xref ref-type="bibr" rid="c7">7</xref>], and loaded into Blazegraph. The inferred phenotype class hierarchy is used to precompute semantic similarity scores between all pairs of evolutionary variation profiles and gene phenotype profiles, using an information content-based metric. The set of pair comparisons is broken into chunks and processed in parallel on a compute cluster to reduce computation time. The resulting set of similarity scores, along with computed statistical support, is loaded into Blazegraph, resulting in a final triple store totaling approximately 300 million RDF triples.</p>
</sec>
<sec id="s4"><label>IV.</label><title>Web Service Interfaces</title>
<p>Access to data in the Phenoscape KB is provided by two web service applications, implemented in Scala using the Spray HTTP toolkit [<xref ref-type="bibr" rid="c15">15</xref>]. The first, Owlery, provides a generic JSON-format API to an any OWL API-based reasoner; for the Phenoscape KB we use ELK, loaded with extracted class axioms from the ontologies and data. We use Owlery to support web application queries that require reasoning on arbitrary OWL class expressions. Owlet provides web services for description logic queries (obtaining subclasses and superclasses), and also supports reasoner-based query expansion using our Owlet package. The Owlery API is documented at <ext-link ext-link-type="uri" xlink:href="http://docs.owlery.apiary.io/">http://docs.owlery.apiary.io/</ext-link>. The second web service application, phenoscape-kb-services, is the primary public Phenoscape API and provides Phenoscape application-specific services such as annotation query, semantic similarity, annotation support for presence/absence inference, and term info. Phenoscape-kb-services obtains most results via SPARQL query to the Blazegraph triple store. For use cases requiring computation by the ELK reasoner, SPARQL queries with embedded OWL expressions are first expanded using the Owlet service provided by the Owlery API before being submitted to Blazegraph. The phenoscape-kb-services API returns most results in both JSON and tab-delimited text formats. Documentation for the phenoscape-kb-services API can be found at <ext-link ext-link-type="uri" xlink:href="http://docs.phenoscapekb.apiary.io/">http://docs.phenoscapekb.apiary.io/</ext-link>.</p>
</sec>
<sec id="s5"><label>V.</label><title>Applications</title>
<p>A public web user interface for the Phenoscape Knowledgebase is available at <ext-link ext-link-type="uri" xlink:href="http://kb.phenoscape.org/">http://kb.phenoscape.org/</ext-link>. The web interface is a client-side browser application developed in the AngularJS JavaScript framework [<xref ref-type="bibr" rid="c16">16</xref>]. The application is implemented entirely upon web service calls to the phenoscape-kb-services API, ensuring that all functionality is available via a documented, public API. Using the web application, researchers can query evolutionary descriptions and gene phenotypes relevant to particular structures and qualities, search for taxonomic groups exhibiting variation similar to the phenotypic effects of a gene of interest [<xref ref-type="bibr" rid="c7">7</xref>] (and vice versa), and export synthetic presence/absence supermatrices using the OntoTrace system [<xref ref-type="bibr" rid="c8">8</xref>]. Building upon the same web service API, we have also implemented an R package, rPhenoscape, which makes some of the functionality of the KB available within the R statistical computing environment.</p>
</sec>
<sec id="s6"><label>VI.</label><title>Conclusion</title>
<p>The Phenoscape Knowledgebase architecture illustrates one approach to integration of multiple datasets in a rich ontological framework. Deriving the full benefit of the sophisticated knowledge represented in OBO library ontologies will often require application of automated reasoners and programmatic generation of axioms and concepts to facilitate particular use cases. Here we have provided an overview of the mix of reusable components and special purpose code we have developed to support Phenoscape; it is our hope that continued evolution of the Phenoscape KB architecture will result in further identification and development of reusable tools which can support similar efforts.</p>
</sec>
</body>
<back>
<ref-list><title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Mungall</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Gkoutos</surname> <given-names>GV</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>CL</given-names></string-name>, <string-name><surname>Haendel</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Lewis</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Ashburner</surname> <given-names>M</given-names></string-name>. <article-title>Integrating phenotype ontologies across multiple species</article-title>. <source>Genome Biol</source>. <year>2010</year>;<volume>11</volume>: <fpage>R2</fpage>. doi:<pub-id pub-id-type="doi">10.1186/gb-2010-11-1-r2</pub-id></mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Bradford</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Conlin</surname> <given-names>T</given-names></string-name>, <string-name><surname>Dunn</surname> <given-names>N</given-names></string-name>, <string-name><surname>Fashena</surname> <given-names>D</given-names></string-name>, <string-name><surname>Frazer</surname> <given-names>K</given-names></string-name>, <string-name><surname>Howe</surname> <given-names>DG</given-names></string-name>, <etal>et al.</etal> <article-title>ZFIN: enhancements and updates to the Zebrafish Model Organism Database</article-title>. <source>Nucl Acids Res</source>. <year>2011</year>;<volume>39</volume>: <fpage>D822</fpage>&#x2013;<lpage>9</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkq1077</pub-id></mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Eppig</surname> <given-names>JT</given-names></string-name>, <string-name><surname>Blake</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bult</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Kadin</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>JE</given-names></string-name>, <article-title>Mouse Genome Database Group. The Mouse Genome Database (MGD): facilitating mouse as a model for human biology and disease</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>: <fpage>D726</fpage>&#x2013;<lpage>36</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gku967</pub-id></mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Karpinka</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Fortriede</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Burns</surname> <given-names>KA</given-names></string-name>, <string-name><surname>James-Zorn</surname> <given-names>C</given-names></string-name>, <string-name><surname>Ponferrada</surname> <given-names>VG</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Xenbase, the Xenopus model organism database; new virtualized system, data types and genomes</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>: <fpage>D756</fpage>&#x2013;<lpage>63</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gku956</pub-id></mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>K&#x00F6;hler</surname> <given-names>S</given-names></string-name>, <string-name><surname>Doelken</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Mungall</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Bauer</surname> <given-names>S</given-names></string-name>, <string-name><surname>Firth</surname> <given-names>HV</given-names></string-name>, <string-name><surname>Bailleul-Forestier</surname> <given-names>I</given-names></string-name>, <etal>et al.</etal> <article-title>The Human Phenotype Ontology project: linking molecular biology and disease through phenotype data</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>: <fpage>D966</fpage>&#x2013;<lpage>74</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkt1026</pub-id></mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Edmunds</surname> <given-names>RC</given-names></string-name>, <string-name><surname>Su</surname> <given-names>B</given-names></string-name>, <string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Eames</surname> <given-names>BF</given-names></string-name>, <string-name><surname>Dahdul</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Lapp</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <article-title>Phenoscape: Identifying Candidate Genes for Evolutionary Phenotypes</article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>: <fpage>13</fpage>&#x2013;<lpage>24</lpage>. doi:<pub-id pub-id-type="doi">10.1093/molbev/msv223</pub-id></mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Manda</surname> <given-names>P</given-names></string-name>, <string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Lapp</surname> <given-names>H</given-names></string-name>, <string-name><surname>Mabee</surname> <given-names>P</given-names></string-name>, <string-name><surname>Vision</surname> <given-names>TJ</given-names></string-name>. <article-title>Using the Phenoscape Knowledgebase to relate genetic perturbations to phenotypic evolution</article-title>. <source>Genesis</source>. <year>2015</year>;<volume>53</volume>: <fpage>561</fpage>&#x2013;<lpage>571</lpage>. doi:<pub-id pub-id-type="doi">10.1002/dvg.22878</pub-id></mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Dececchi</surname> <given-names>TA</given-names></string-name>, <string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Lapp</surname> <given-names>H</given-names></string-name>, <string-name><surname>Mabee</surname> <given-names>PM</given-names></string-name>. <article-title>Toward Synthesizing Our Knowledge of Morphology: Using Ontologies and Machine Reasoning to Extract Presence/Absence Evolutionary Phenotypes across Studies</article-title>. <source>Syst Biol</source>. <year>2015</year>; doi:<pub-id pub-id-type="doi">10.1093/sysbio/syv031</pub-id></mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Dahdul</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Kothari</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Lapp</surname> <given-names>H</given-names></string-name>, <string-name><surname>Lundberg</surname> <given-names>JG</given-names></string-name>, <string-name><surname>Mabee</surname> <given-names>P</given-names></string-name>, <etal>et al.</etal> <article-title>Phenex: ontological annotation of phenotypic diversity</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>: <fpage>e10500</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0010500</pub-id></mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Dahdul</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Engeman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Grande</surname> <given-names>T</given-names></string-name>, <string-name><surname>Hilton</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Kothari</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <article-title>Evolutionary characters, phenotypes and ontologies: curating data from the systematic biology literature</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>: <fpage>e10708</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0010708</pub-id></mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>. <article-title>Scowl: a Scala DSL for programming with the OWL API</article-title>. <source>The Journal of Open Source Software</source>. <year>2016</year>. doi:<pub-id pub-id-type="doi">10.21105/joss.00023</pub-id></mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="book"><string-name><surname>Kazakov</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Kr&#x00F6;tzsch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Siman&#x010D;&#x00ED;k</surname> <given-names>F</given-names></string-name>. <chapter-title>The Incredible ELK</chapter-title>. <source>J Automat Reason</source>. <publisher-loc>Springer Netherlands</publisher-loc>; <year>2013</year>;<volume>53</volume>: <fpage>1</fpage>&#x2013;<lpage>61</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s10817-013-9296-3</pub-id></mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="website"><string-name><surname>Balhoff</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Dececchi</surname> <given-names>TA</given-names></string-name>, <string-name><surname>Mabee</surname> <given-names>PM</given-names></string-name>, <string-name><surname>Lapp</surname> <given-names>H</given-names></string-name>. <article-title>Presence-absence reasoning for evolutionary phenotypes</article-title>. <source>Proceedings of Phenotype Day of the Bio-ontologies SIG at ISMB</source> <year>2014</year>. 2014. pp. <fpage>1</fpage>&#x2013;<lpage>4</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://phenoday2014.bio-lark.org/pdf/11.pdf">http://phenoday2014.bio-lark.org/pdf/11.pdf</ext-link></mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="website"><collab>Blazegraph. [Internet]</collab>. [cited <day>29</day> <month>May</month> <year>2016</year>]. Available: <ext-link ext-link-type="uri" xlink:href="https://www.blazegraph.com">https://www.blazegraph.com</ext-link></mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="website"><collab>spray | REST/HTTP for your Akka/Scala Actors [Internet]</collab>. [cited <day>29</day> <month>May</month> <year>2016</year>]. Available: <ext-link ext-link-type="uri" xlink:href="http://spray.io">http://spray.io</ext-link></mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="website"><collab>AngularJS &#x2014; Superheroic JavaScript MVW Framework [Internet]</collab>. [cited <day>29</day> <month>May</month> <year>2016</year>]. Available: <ext-link ext-link-type="uri" xlink:href="https://angularjs.org">https://angularjs.org</ext-link></mixed-citation></ref>
</ref-list>
<fn-group>
<fn><p>Funded by National Science Foundation grants DBI-1062404, DBI-1062542.</p></fn>
</fn-group>
</back>
</article>
