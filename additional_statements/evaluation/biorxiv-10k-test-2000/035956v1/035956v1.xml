<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/035956</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Regmex, Motif analysis in ranked lists of sequences</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Nielsen</surname>
<given-names>Morten Muhlig</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tataru</surname>
<given-names>Paula</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Madsen</surname>
<given-names>Tobias</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hobolth</surname>
<given-names>Asger</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Pedersen</surname>
<given-names>Jakob Skou</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Molecular Medicine (MOMA), Aarhus University Hospital</institution>, Brendstrupg&#x00E5;rdsvej 100, 8000 Aarhus C, <country>Denmark</country></aff>
<aff id="a2"><label>2</label><institution>Bioinformatics Research Centre, C.F. M&#x00F8;llers All&#x00E9; 8, Aarhus University</institution>, 8000 Aarhus C, <country>Denmark</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>To whom correspondence should be addressed. Tel: &#x002B;45 784 55360; Fax: &#x002B;45 867 82108; Email: <email>morten.muhlig@clin.au.dk</email> or <email>jakob.skou@clin.au.dk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2016</year>
</pub-date>
<elocation-id>035956</elocation-id>
<history>
<date date-type="received">
<day>05</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>05</day>
<month>1</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="035956.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Motif analysis has long been an important method to characterize biological functionality and the current growth of sequencing-based genomics experiments further extends its potential. These diverse experiments often generate sequence lists ranked by some functional property. There is therefore a growing need for motif analysis methods that can exploit this coupled data structure and be tailored for specific biological questions. Here, we present a motif analysis tool, Regmex (REGular expression Motif EXplorer), which offers several methods to identify overrepresented motifs in a ranked list of sequences. Regmex uses regular expressions to define motifs or families of motifs and embedded Markov models to calculate exact probabilities for motif observations in sequences. Motif enrichment is optionally evaluated using random walks, Brownian bridges, or modified rank based statistics. These features make Regmex well suited for a range of biological sequence analysis problems related to motif discovery. We demonstrate different usage scenarios including rank correlation of microRNA binding sites co-occurring with a U-rich motif. The method is available as an R package.</p>
</abstract>
<counts>
<page-count count="7"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>INTRODUCTION</title>
<p>Motif discovery is a classical problem in sequence analysis and its scope broadens with modern sequencing technologies. A large number of tools are designed to find enriched motifs in sequences, with the majority aimed at finding motifs that are enriched in a foreground set of sequences relative to a background set. This is optimal for sequences where a categorical variable defines a foreground and a background. However, many experimental settings are associated with continuous variables where set-based methods are suboptimal. Instead of using a hard threshold to divide a continuous variable into foreground and background, it is more powerful to take the magnitude of the continuous variable directly into account.</p>
<p>More recently, motif enrichment methods have been developed that can exploit the ranking in a list of sequences, e.g. (<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>). These methods seek to find the motifs that best correlate with the ranked sequence list. Most commonly, this is achieved by exhaustively searching through the space of all simple motifs of a given length k (k-mers). K-mers, ranked by their correlation measures, are then either output directly, clustered and used to define position weight matrices (PWMs) or used as seeds in a variety of downstream algorithms to refine the top correlating motifs.</p>
<p>A general challenge of motif analysis, and specifically of methods based on an exhaustive search, is the rapid increase in search space with motif size and complexity. This problem has been addressed in recent work by using suffix trees, allowing exhaustive searches of large spaces such as all variable gap motifs up to a given length (<xref ref-type="bibr" rid="c4">4</xref>). However, functional motifs may display a much higher degree of complexity than current methods meet. Many snoRNAs, for example, are known to bind their targets in a composite motif consisting of two binding sites separated by a variable number of nucleotides. In addition, regulation of biological systems often rely on multiple factors acting in concert. For instance, endogenous RNAs can severely perturb regulatory networks of microRNAs (<xref ref-type="bibr" rid="c6">6</xref>). It is thus valuable to be able to evaluate enrichments for subsets of binding sites in combination.</p>
<p>A central aspect in motif analysis of ranked sequences is the significance evaluation of the motif rank correlation. A number of approaches have been used, including linear regression models (<xref ref-type="bibr" rid="c7">7</xref>), Wilcoxon rank sum tests (<xref ref-type="bibr" rid="c8">8</xref>), a Kolmogorow-Smirnov based approach (<xref ref-type="bibr" rid="c9">9</xref>), a Brownian bridge based approach (<xref ref-type="bibr" rid="c2">2</xref>) and methods using variants of hyper geometric tests (<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>). The various methods also have different standards for motif scoring in the sequences. Examples include simple presence/absence scores for each sequence (<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c9">9</xref>), dependence of sequence lengths and global base composition (<xref ref-type="bibr" rid="c1">1</xref>) and probabilistic scoring that models base composition of every sequence in the rank list (<xref ref-type="bibr" rid="c2">2</xref>).</p>
<p>Presence/absence scores in particular suffer a risk of bias because sequence length and composition is not included in the score model, which is a problem if e.g. sequence lengths are biased in the rank. Also, presence/absence score-based methods may be under-powered in situations where the number of motif occurrences in a single sequence matters.</p>
<p>Based on these issues, we see a need for a tool that allows hypotheses for flexible motifs to be evaluated, and calculates accurate sequence dependent <italic>p</italic>-values for motif observations. We present Regmex, a motif enrichment tool, with a number of new features aimed at accurate significance evaluation (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). First, we calculate sequence specific motif <italic>p</italic>-values that depend on both sequence lengths and base compositions using an embedded Markov model. Second, depending on the problem and hypothesis, motif rank correlation or motif clustering can be evaluated in one of three different ways; (<xref ref-type="bibr" rid="c1">1</xref>) a Brownian bridge based approach, (<xref ref-type="bibr" rid="c2">2</xref>) a modified sum of ranks method which takes sequence properties into account, or (<xref ref-type="bibr" rid="c3">3</xref>) a random walk based method which is sensitive to clustering of motif observations anywhere in the sequence list. In addition, Regmex makes use of regular expressions, thus allowing a motif to be far more complex than k-mers. We illustrate some of the benefits by using Regmex on simulated data as well as on real data sets. The method is available as an R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/muhligs/regmex">https://github.com/muhligs/regmex</ext-link>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Flow diagram of the procedures for calculating sequence specific <italic>p</italic>-values and rank correlation or clustering <italic>p</italic>-value in Regmex.</p></caption>
<graphic xlink:href="035956_fig1.tif"/>
</fig>
</sec>
<sec id="s2"><title>MATERIALS AND METHODS</title>
<sec id="s2a"><title>The Regmex tool</title>
<p>In this study, we introduce Regmex, a motif analysis tool available as an R package. Regmex is designed with flexibility in mind to study rank correlation or clustering of motifs in a list of sequences. Briefly, it takes as input a list of sequences ranked by an experimental setting, and one or more motifs, each defined as a regular expression (RE) (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). The output, in its simplest form, contains the rank correlation or clustering p-values (RCPs) for the input motifs. Alternatively, it is possible to get the underlying sequence specific p-values (SSPs) for motifs as well as count statistics etc.</p>
<p>To illustrate the power of REs in a biological sequence context, we consider the following examples:</p>
<list list-type="simple">
<list-item><p>1) A stem loop structure TTTCNNNGAAA found in the 3'UTR of many key inflammatory and immune genes (<xref ref-type="bibr" rid="c10">10</xref>). Although this is a simple RE, it captures 64 11-mers in one expression, and Regmex reports the rank correlation <italic>p</italic>-value of the combined set.</p></list-item>
<list-item><p>2) A G-quadroplex structure, GGGLGGGLGGGLGGG, L &#x003D; (N|NN|NNN|NNNN). This is found e.g. in telomeric regions (<xref ref-type="bibr" rid="c11">11</xref>).</p></list-item>
<list-item><p>3) Any size open reading frame, ATG(NNN)&#x002A;((TGA)|(TAA)|(TAG)). This RE is an example of an enormous set, which would be difficult to obtain without a RE.</p></list-item></list>
<p>We note that an advantage of REs in relation to the motif enrichment problem is that a RE can be obtained for any set of simple motifs. Thus for example a set of experimentally verified binding sequences can be expressed as a RE, and matching will include exactly this set.</p></sec>
<sec id="s2b"><title>Sequence specific motif <italic>p</italic>-value calculation</title>
<p>A central point in the way Regmex calculates a motif RCP is to calculate SSPs for observing the motif the observed number of times <italic>(n<sub>obs</sub>)</italic> or more. Briefly, from a deterministic finite state automaton (DFA) associated with the RE motif, we identify a sequence specific transition probability matrix (TPM) which is used to build an embedded TPM (eTPM) specific for <italic>n<sub>obs</sub></italic> (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). The SSP is subsequently read from the eTPM raised to the power of the sequence length.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><p>(A) Motif in the form of a regular expression. Base coloring applies throughout the figure. (B) Deterministic finite state automaton corresponding to the regular expression in (A). Initial state is indicated in gray, end state is indicated by a double circle. (C) Transition state probability matrix (TPM) associated with the model in (B). (D) Embedded Markov Model (eDFA) for two observed occurrences of the motif. States are pre-indexed with number of prior motif observations. (E) Embedded transition state probability matrix (eTPM) associated with the eDFA. The yellow matrix is an exact copy of the yellow matrix from (C). The gray entries have zero probability. The end state transition probabilities of the DFA model (red/orange in (C)) are shifted forward and contain the initial state of the next motif occurrence, except for any end to end transition probability (occurs for REs ending with a &#x002A;), which remains in the DFA template (red field). The final state of the eDFA (<xref ref-type="bibr" rid="c2">2</xref>,4 in D) is an absorbing state and all transition probability is in (<xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c4">4</xref>;<xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c4">4</xref>) indicated in black. (F) Heat diagrams of the n-step eTPM reflecting the probability of moving between states in the eDFA given a random sequence of length <italic>n</italic> with a specific base composition. The row corresponding to the initial state (0,1) holds the probability distribution of going from the start state to any state in the eDFA in <italic>n</italic> steps. The last entry of this row (red field) holds the probability of the observed number of motifs <italic>(n<sub>obs</sub>)</italic> or more in the sequence (the SSP).</p></caption>
<graphic xlink:href="035956_fig2.tif"/>
</fig>
<sec id="s2b1"><title>Deterministic Finite State Automaton</title>
<p>For any RE, the corresponding DFA can be built, which is the initial step in the SSP calculation (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). The DFA starts in an initial state, accepts symbols (i.e. nucleotides) on the edges and moves through the states. The end state corresponds to having observed the RE. The DFA used here recognizes an extended regular expression, as described in (<xref ref-type="bibr" rid="c12">12</xref>). The routine used to build the DFA for a given RE is implemented in Java, using (<xref ref-type="bibr" rid="c13">13</xref>), and supports standard regular expression operations (concatenation, union and Kleene star).</p></sec>
<sec id="s2b2"><title>Markov Embedding</title>
<p>The DFA graph structure can also be thought of as a Markov model, where instead of accepting symbols, it generates symbols on the edges with probabilities corresponding to the base frequencies in a given sequence. The Markov model can be represented by a transition probability matrix (TPM), which holds the probabilities of moving between states of the DFA given a randomly picked base from the sequence (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). TPM<italic><sup>n</sup></italic> will hold the probability of moving between states given <italic>n</italic> bases.</p>
<p>We are interested in the SSP and thus need to have a probability model that takes <italic>n<sub>obs</sub></italic> into account. Regmex does this by making a model expansion using the DFA as a template. We refer to this as an embedded DFA (eDFA) (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Specifically, the template DFA is copied <italic>n<sub>obs</sub></italic> times and outgoing edges of the end state(s) of the DFA template are moved to the corresponding states in the next template copy. This effectively allows the embedded model to count how many times the RE motif has been observed. The final state of the eDFA is absorbing, so no further motif observations are scored.</p>
<p>Again, the eDFA can be thought of both as an automaton accepting symbols or as a Markov model generating symbols on edges. As above, Regmex constructs a transition probability matrix (eTPM) based on the eDFA (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). The eTPM<sup>n</sup> holds probabilities of moving between states of the eDFA given a random sequence of length <italic>n</italic> with the observed base frequencies (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). We can now extract the probability distribution of the RE motif in a given sequence by reading the row corresponding to the initial state (0,1) in the eTPM<italic><sup>n</sup></italic>. In particular the probability of observing the motif <italic>n<sub>obs</sub></italic> number of times or more (SSP) can be read in the final state column of the initial state row (red field in <xref ref-type="fig" rid="fig2">Figure 2F</xref>).</p></sec></sec>
<sec id="s2c"><title>Motif Rank Correlation <italic>p</italic>-value</title>
<p>In the downstream analysis, Regmex uses the calculated SSPs when calculating the RCP. Because the characteristics of rank correlation may vary depending on the problem analyzed, the choice of method used to evaluate the correlation may differ in detection power. E.g. one test may have higher power for detecting long motifs occurring rarely in the sequence list and another may have superior sensitivity for frequent short motifs. In Regmex, we have implemented three methods for evaluating motif rank correlation or motif clustering, which have different strengths. These methods are based on Brownian bridge (BB), random walk (RW) and modified sum of rank (MSR) statistics. <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates the concept underlying each of these statistics on a small list of 50 sequences with an enriched motif.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><p>(A) Sequences enriched with a 7-mer motif (ACGTGAT) as indicated with red marks. Upper bars indicate sequence lengths, lower bars indicate SSPs for the motif. (B) Brownian bridge for the 7-mer motif in (A) (red) and for 500 random 7-mer motifs (gray). The RCP corresponding to the BB is indicated. (C) Random walk for the motif in (A) (red) and 500 random 7-mer motifs (black). The RCP corresponding to the RW is indicated. (D) Schematic of the MSR method. Lines represent sequences with lengths proportional to the probability of observing the motif one or more times. A motif occurrence is marked by an asterix. The RCP corresponding to the motif distribution is indicated.</p></caption>
<graphic xlink:href="035956_fig3.tif"/>
</fig>
<sec id="s2c1"><title>Brownian Bridge Method</title>
<p>This method is a re-implementation of the method developed by Jacobsen et al. (<xref ref-type="bibr" rid="c14">14</xref>) and recently implemented in cWords (<xref ref-type="bibr" rid="c2">2</xref>). Our implementation differs in the calculation of the SSPs and in how we calculate the RCP (see supplemental methods for details). Briefly, the method calculates the max value <italic>D</italic> of a running sum of mean adjusted log scores of the SSPs. The running sum starts and ends in zero and hence is a Brownian bridge under the null model (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). We identify the <italic>p</italic>-value from the analytical distribution of max values of a Brownian bridge.</p></sec>
<sec id="s2c2"><title>Random Walk Statistic</title>
<p>The RW method is similar to the use of random walks in the BLAST algorithm (<xref ref-type="bibr" rid="c15">15</xref>). This method is sensitive to clustering of motifs anywhere in the sequence list. The SSPs for a motif are transformed into steps in a walk (see <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Under the null model the motif is not enriched and SSPs follow the uniform distribution. The SSPs are transformed into steps according to a scoring scheme where small <italic>p</italic>-values (SSPs) corresponds to a positive step and large <italic>p</italic>-values corresponds to a negative step. The exact scoring scheme is based on assumed motif densities in the foreground relative to the background, so that higher motif densities give rise to a higher walk in local regions of the sequence list. The RW starts over from zero every time it reaches the lower bound of &#x2212;1. This makes the RW method sensitive to local runs of enriched motifs in the sequence list. For significance evaluation, we find the probability of a walk with at least as high a max value under the null distribution. We do this using a recursion on an analytic expression for the max value distribution of random walks (see supplemental methods for details). Alternatively, we can use a geometric-like distribution (Gumbel distribution) as an approximation for the max value distribution (<xref ref-type="bibr" rid="c16">16</xref>).</p></sec>
<sec id="s2c3"><title>Modified Sum of Ranks Statistics</title>
<p>The MSR method is based on the idea of using a sum of rank test to determine a rank bias in motif containing sequences. Rather than summing ranks, MSR uses a sum of scores specific for the sequences and motif. The scores are based on sequence specific probabilities, which eliminates bias from sequence composition and length. All motif observations are associated with a score (see supplemental methods for details) that reflect the probability of the motif being found one or more times in the sequence, as well as the rank of the sequence. The score can be considered as a rank normalized for the probability of observing motifs in the sequence. For the MSR method, the null model is that all observed motifs are randomly distributed in the sequences given the sequence compositions and lengths. The test statistic is the sum of the scores, which is approximately normally distributed when the motifs fall randomly in the sequences. The MSR method is faster than the others because we need only the probability of observing one or more motifs in the sequence, which can be read from the TPM of the DFA (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) modified so that the end state is absorbing, and thus we do not need to construct the larger embedded model.</p></sec></sec></sec>
<sec id="s3"><title>RESULTS</title>
<sec id="s3a"><title>Combined motifs increase power</title>
<p>Because of different characteristics of the three methods for rank correlation evaluation, they perform differently in different scenarios. <xref ref-type="fig" rid="fig4">Figure 4A</xref> illustrates their behavior when applied to a set of 1000 random sequences with a simple 7-mer motif inserted up to 100 times in the upper half of the sequence list. In this particular scenario, the RW approach has the highest sensitivity, followed by the BB method and the MSR method (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The RW method generally has a high sensitivity when the motif density is high, regardless of where in the sequence list it occurs. This is in contrast to both the MSR and BB methods, which are more sensitive to enrichment in the beginning or end of the sequence list. The rank sum derived nature of the MSR method yields a higher sensitivity for enrichment in the ends of longer sequence lists, while the BB method is highly superior in short sequence lists with moderate enrichment. (see Supplemental Figure S1).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Regmex behavior in different scenarios. (<bold>A</bold>) Comparison of <italic>p</italic>-value output for the different rank correlation methods used in Regmex. One 7-mer motif (ACGTGAT) is inserted as indicated in the first half of 1000 sequences each with a length of 1000 bases. In replicates with no insertion the BB method was used, but the other methods gave similar results. Error bars indicate standard error of 100 replicates. (<bold>B</bold>) Up to four different 7-mer motifs inserted randomly in the first half of the sequences in (A). <italic>p</italic>-value output from Regmex using the BB method plotted against the number of inserted motifs. RE motifs define sets of one up to all four 7-mers as indicated, e.g. m1 | m2 &#x003D; (ACGTGAT)|(GCATTGT). (<bold>C</bold>) p-value output from Regmex using the BB method plotted against the number of inserted motifs. Sets of four 7-mer motifs were inserted at fixed positions randomly among the first half of the sequences in (A), so that motifs occur together in the same sequences. RE motifs define sets of combinations of one up to all four 7-mers as indicated, e.g. m1 &#x0026; m2 &#x003D; (ACGTGATN&#x002A;GCATTGT)|(GCATTGTN&#x002A;ACGTGAT), where N denotes any nucleotide.</p></caption>
<graphic xlink:href="035956_fig4.tif"/>
</fig>
<p>When using SSPs rather than e.g. binary scores for motif observations in sequences, the benefit of differential scoring becomes clear. This means, e.g., that rank correlation of common and individually insignificant motifs can be better evaluated because their impact on the rank correlation is moderated by the significance of the observation. The same argument applies to rare, highly significant motifs. This, combined with RE motif definition, is useful in the case of evaluating rank correlation of combinations of motifs.</p>
<p>We used Regmex to evaluate rank correlation of combinations of inserted motifs in a set of random sequences. First, we inserted four different simple 7-mers up to 100 times at random positions in the upper half of the ranked sequences. We looked at the behavior of Regmex when defining motifs as REs capturing different subsets of the 7-mers including from one up to all four (i.e. REs defined to capture presence of any member of the subset). We clearly see the effect of combining multiple simple motifs in a set (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). When searching for motif 1 or 2 (RE &#x003D; m1|m2), we see a marked increase in detection sensitivity starting at around 20 inserted motifs. As expected, this increases with number of inserted motifs. Rank correlation increases even more dramatically for the motif subsets of three or four 7-mers. We note that the SSPs become less significant when including more 7-mers in the motif, but because the number of inserted motif observations in the enriched end of the sequence list increases (up to 400 for four 7-mers vs. 100 for a single 7-mer), the RCP becomes more significant.</p>
<p>We next looked at the behavior of Regmex when calculating rank correlation of multiple motifs present in the same sequences. Such calculations may be relevant when two or more different factors acting on the same sequences could explain the sequence ranking. To this end, we inserted the four 7-mers together in the same sequences. This was done up to 100 times in the upper half of the sequence list. We used Regmex to calculate RCPs for subsets of combined motifs, i.e. RE motifs designed to capture the presence of one up to all four 7-mers in the same sequence. The SSPs, in contrast to before, now decrease with the number of 7-mers in the RE subset, whereas number of motif observations are identical for all four motifs (by construction). As expected, the detection power of the combined motifs is much higher than that of a single simple motif (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p>
<p>These experiments show how more complex motifs, such as motif sets, can be captured by REs with great increase in power.</p></sec>
<sec id="s3b"><title>U rich motifs and microRNA seed target sites as combined motifs</title>
<p>As an example of a scenario where combinations of motifs are relevant, we looked for rank correlation of microRNA seed site targets in combination with a U-rich motif (URM) in a number of microRNA over-expression data sets. URMs are known to bind HuD/ELAVL4 (<xref ref-type="bibr" rid="c17">17</xref>) and their presence in 3&#x2019;UTRs has been shown to correlate with down regulation in several microRNA over-expression experiments (<xref ref-type="bibr" rid="c14">14</xref>). Based on this finding, a model was proposed where URMs augment microRNA induced destabilization of target mRNAs (<xref ref-type="bibr" rid="c14">14</xref>). We used Regmex to calculate RCPs for microRNA seed site targets and combinations of the target and URM1 as identified in (<xref ref-type="bibr" rid="c14">14</xref>) with sequence UUUUAAA. This was done using 11 different microRNA over-expression data sets (<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>).</p>
<p>We first calculated RCPs for the microRNA seed site targets. For all data sets, we saw low RCPs for the relevant microRNA seed site target in 3&#x2019;UTRs, demonstrating correlation between the motif and down-regulated genes (<xref ref-type="table" rid="tbl1">Table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Rank correlation <italic>p</italic>-values for URM (U) and seed target (S) motifs</p></caption>
<graphic xlink:href="035956_tbl1.tif"/>
</table-wrap>
<p>We next calculated RCPs for microRNA seed site targets and URM1 in combination. To this end, we constructed REs of the form (UN&#x002A;S)|(SN&#x002A;U), where U denotes the URM, S denotes the microRNA seed site target and N denotes any nucleotide. This RE will capture all combinations of the URM and the seed site in either orientation. As expected, based on the previous findings (<xref ref-type="bibr" rid="c14">14</xref>), we consistently saw an even lower RCP for the RE motif capturing both the seed target and the URM1 motif (<xref ref-type="table" rid="tbl1">Table 1</xref>). The experiment thus verifies earlier results showing URM1 3&#x2019;UTR presence correlating with down-regulation.</p>
<p>We next asked whether RCPs are of similar magnitude when the URM is downstream or upstream of the seed target. Here we used Regmex with two REs, SN&#x002A;U and UN&#x002A;S for the downstream and upstream question respectively. We observed low RCPs for both the downstream and upstream case for all microRNAs, indicating that URM1 correlates with down-regulation regardless of its relative position to the seed target (<xref ref-type="table" rid="tbl1">Table 1</xref>). Notably, we found that RCPs were lower for URM1 upstream the seed target than for URM1 downstream the seed target. This could indicate a preference in relative position between the URM site and the seed target.</p>
<p>The example above illustrates how Regmex is useful in testing well defined hypotheses involving combinations of motifs defined as REs. We note that the outcome verifies earlier findings and further suggests a positional bias in the relative position between the URM motif and the augmented microRNA seed site targets.</p></sec></sec>
<sec id="s4"><title>DISCUSSION</title>
<p>We have introduced Regmex, an R package for evaluating rank correlation or clustering of motifs in lists of sequences. Regmex differs from current methods in combining powerful RE motif definition with accurate sequence specific motif significance evaluation and a variety of correlation score statistics. This makes Regmex a flexible tool that expands on the type of motif correlation problems that current methods can handle. Although Regmex handles e.g. traditional exhaustive k-mer screens as other methods (<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>), it is designed for specific hypothesis testing that involves potentially complex RE motif correlation testing. In particular, Regmex can accurately evaluate rank correlation significance for arbitrary combined sets of simple motifs, such as sets of high scoring k-mers in conventional k-mer screens or combinations of microRNA seed sites. This is relevant for investigations of competitive endogenous RNAs, snoRNA target sites, etc.</p>
<p>The accuracy introduced by the embedded model comes at the cost of computational speed. In particular, motifs that occur frequently in the sequences and are also represented by DFAs with many states require large eTPMs, which may slow down the computation. This can be countered by parallelization, which Regmex natively supports. Furthermore, data structures are simple enough to sub-divide and distribute calculations. Also, the embedded model may be reduced by introducing counting transitions, as suggested in (<xref ref-type="bibr" rid="c20">20</xref>).</p>
<p>Regmex offers three alternative ways of evaluating motif rank correlation, which differ in their null models. For the RW method, the null model is that motifs occur at random given the sequence compositions and lengths. The RW method is sensitive to stretches of low SSPs anywhere in the sequence list, and thus may find use in special cases where enrichment is expected off the ends. This could be the case if a sequence list represents consecutive functional sets of sequences, such as a gene ontologies or expression clusters.</p>
<p>Both the MSR and the BB methods are more sensitive to motifs occurring in the ends of the list, but have subtle differences in their null models. For the MSR method, the number of observed motifs in the sequence list is fixed, and only their distribution among the sequences vary under the null. For the BB method, the null is a uniform distribution of SSPs. Although this would suggest a bias for motifs occurring more frequently than expected, the transformation of SSPs into a Brownian bridge via a running sum normalizes for this effect. Thus both of these methods should be robust to motif occurrence bias. As noted (<xref ref-type="fig" rid="fig3">Figure 3</xref> and supplemental Figure S1) they have different sensitivity in different scenarios. The MSR method tends to be more sensitive than the BB method for longer sequence lists and vice versa.</p>
<p>Regmex is implemented in R and offers a number of costumization options including model options such as di-nucleotide dependence and a motif overlap option. Alternative outputs such as SSPs and <italic>n<sub>obs</sub></italic> combined with simple data formats makes Regmex well suited for a range of problems.</p>
<p><italic>Conflict of interest statement</italic>. None declared.</p></sec>
</body>
<back>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>van Dongen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Abreu-Goodger</surname>, <given-names>C.</given-names>,</string-name> and <string-name><surname>Enright</surname>, <given-names>A.</given-names></string-name> (<year>2008</year>) <article-title>Detecting microRNA binding and siRNA off-target effects from expression data</article-title>. <source>Nature methods</source>, <volume>5</volume>(<issue>12</issue>), <fpage>1023</fpage>&#x2013;<lpage>1025</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Rasmussen</surname>, <given-names>S. H.</given-names></string-name>, <string-name><surname>Jacobsen</surname>, <given-names>A.</given-names>,</string-name> and <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name> (<year>2013</year>) <article-title>cWords - systematic microRNA regulatory motif discovery from mRNA expression data</article-title>.. <source>Silence</source>, <volume>4</volume>(<issue>1</issue>), <fpage>2</fpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Steinfeld</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Navon</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Ach</surname>, <given-names>R.</given-names>,</string-name> and <string-name><surname>Yakhini</surname>, <given-names>Z.</given-names></string-name> (<year>2013</year>) <article-title>miRNA target enrichment analysis reveals directly active miRNAs in health and disease</article-title>.. <source>Nucleic acids research</source>, <volume>41</volume>(<issue>3</issue>), <fpage>e45</fpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Leibovich</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Paz</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Yakhini</surname>, <given-names>Z.</given-names>,</string-name> and <string-name><surname>Mandel-Gutfreund</surname>, <given-names>Y.</given-names></string-name> (<year>2013</year>) <article-title>DRIMust: a web server for discovering rank imbalanced motifs using suffix trees</article-title>.. <source>Nucleic acids research</source>, <volume>41</volume> (Web Server issue), <fpage>W174</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Eden</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Lipson</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Yogev</surname>, <given-names>S.</given-names>,</string-name> and <string-name><surname>Yakhini</surname>, <given-names>Z.</given-names></string-name> (<year>2007</year>) <article-title>Discovering motifs in ranked lists of DNA sequences</article-title>.. <source>PLoS computational biology</source>, <volume>3</volume>(<issue>3</issue>), <fpage>e39</fpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Poliseno</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Salmena</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Carver</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Haveman</surname>, <given-names>W. J.</given-names>,</string-name> and <string-name><surname>Pandolfi</surname>, <given-names>P. P.</given-names></string-name> (<year>2010</year>) <article-title>A coding-independent function of gene and pseudogene mRNAs regulates tumour biology</article-title>.. <source>Nature</source>, <volume>465</volume>(<issue>7301</issue>), <fpage>1033</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Bussemaker</surname>, <given-names>H. J.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>H.</given-names>,</string-name> and <string-name><surname>Siggia</surname>, <given-names>E. D.</given-names></string-name> (<year>2001</year>) <article-title>Regulatory element detection using correlation with expression</article-title>.. <source>Nature genetics</source>, <volume>27</volume>(<issue>2</issue>), <fpage>167</fpage>&#x2013;<lpage>71</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Sood</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Krek</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zavolan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Macino</surname>, <given-names>G.</given-names>,</string-name> and <string-name><surname>Rajewsky</surname>, <given-names>N.</given-names></string-name> (<year>2006</year>) <article-title>Cell-type-specific signatures of microRNAs on target mRNA expression</article-title>.. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>103</volume>(<issue>8</issue>), <fpage>2746</fpage>&#x2013;<lpage>51</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Jensen</surname>, <given-names>L.</given-names></string-name> and <string-name><surname>Knudsen</surname>, <given-names>S.</given-names></string-name> (<year>2000</year>) <article-title>Automatic discovery of regulatory patterns in promoter regions based on whole cell expression data and functional annotation</article-title>. <source>Bioinformatics</source>, <volume>16</volume>(<issue>4</issue>), <fpage>326</fpage>&#x2013;<lpage>333</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Parker</surname>, <given-names>B. J.</given-names></string-name>, <string-name><surname>Moltke</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Roth</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Washietl</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Wen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kellis</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Breaker</surname>, <given-names>R.</given-names>,</string-name> and <string-name><surname>Pedersen</surname>, <given-names>J. S.</given-names></string-name> (<year>2011</year>) <article-title>New families of human regulatory RNA structures identified by comparative analysis of vertebrate genomes</article-title>.. <source>Genome research</source>, <volume>21</volume>(<issue>11</issue>), <fpage>1929</fpage>&#x2013;<lpage>43</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Blackburn</surname>, <given-names>E. H.</given-names>,</string-name> and <string-name><surname>Gall</surname>, <given-names>J. G.</given-names></string-name> (<year>1978</year>) <article-title>A tandemly repeated sequence at the termini of the extrachromosomal ribosomal RNA genes in Tetrahymena</article-title>.. <source>Journal of molecular biology</source>, <volume>120</volume>(<issue>1</issue>), <fpage>33</fpage>&#x2013;<lpage>53</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Tataru</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Sand</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hobolth</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mailund</surname>, <given-names>T.</given-names>,</string-name> and <string-name><surname>Pedersen</surname>, <given-names>C. N. S.</given-names></string-name> (<year>2013</year>) <article-title>Algorithms for hidden markov models restricted to occurrences of regular expressions</article-title>. <source>Biology</source>, <volume>2</volume>(<issue>4</issue>), <fpage>1282</fpage>&#x2013;<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="website"><string-name><surname>M&#x00F8;ller</surname>, <given-names>A.</given-names></string-name> <source>dk.brics.automaton &#x2013; Finite-State Automata and Regular Expressions for Java</source>. (<year>2010</year>) <ext-link ext-link-type="uri" xlink:href="http://www.brics.dk/automaton/">http://www.brics.dk/automaton/</ext-link>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Jacobsen</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Wen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Marks</surname>, <given-names>D. S.</given-names>,</string-name> and <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name> (<year>2010</year>) <article-title>Signatures of RNA binding proteins globally coupled to effective microRNA target sites</article-title>.. <source>Genome research</source>, <volume>20</volume>(<issue>8</issue>), <fpage>1010</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Altschul</surname>, <given-names>S. F.</given-names></string-name>, <string-name><surname>Gish</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Myers</surname>, <given-names>E.</given-names>,</string-name> and <string-name><surname>Lipman</surname>, <given-names>D. J.</given-names></string-name> (<year>1990</year>) <article-title>Basic Local Alignment Search Tool</article-title>. <source>Journal of molecular biology</source>, <volume>215</volume>, <fpage>403</fpage>&#x2013;<lpage>410</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="book"><string-name><surname>Ewens</surname>, <given-names>W.</given-names></string-name> and <string-name><surname>Grant</surname>, <given-names>G.</given-names></string-name> (<year>2005</year>) <source>Statistical methods in bioinformatics</source>, <publisher-name>Springer Netherlands</publisher-name>, <edition>2</edition> edition.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Bolognani</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Contente-Cuomo</surname>, <given-names>T.</given-names>,</string-name> and <string-name><surname>Perrone-Bizzozero</surname>, <given-names>N. I.</given-names></string-name> (<year>2010</year>) <article-title>Novel recognition motifs and biological functions of the RNA-binding protein HuD revealed by genome-wide identification of its targets</article-title>.. <source>Nucleic acids research</source>, <volume>38</volume>(<issue>1</issue>), <fpage>117</fpage>&#x2013;<lpage>30</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Grimson</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Farh</surname>, <given-names>K. K.-H.</given-names></string-name>, <string-name><surname>Johnston</surname>, <given-names>W. K.</given-names></string-name>, <string-name><surname>Garrett-Engele</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Lim</surname>, <given-names>L. P.</given-names>,</string-name> and <string-name><surname>Bartel</surname>, <given-names>D. P.</given-names></string-name> (<year>2007</year>) <article-title>MicroRNA targeting specificity in mammals: determinants beyond seed pairing</article-title>.. <source>Molecular cell</source>, <volume>27</volume>(<issue>1</issue>), <fpage>91</fpage>&#x2013;<lpage>105</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Linsley</surname>, <given-names>P. S.</given-names></string-name>, <string-name><surname>Schelter</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Burchard</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kibukawa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Martin</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Bartz</surname>, <given-names>S. R.</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>J. M.</given-names></string-name>, <string-name><surname>Cummins</surname>, <given-names>J. M.</given-names></string-name>, <string-name><surname>Raymond</surname>, <given-names>C. K.</given-names></string-name>, <string-name><surname>Dai</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Chau</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Cleary</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jackson</surname>, <given-names>A. L.</given-names></string-name>, <string-name><surname>Carleton</surname>, <given-names>M.</given-names>,</string-name> and <string-name><surname>Lim</surname>, <given-names>L.</given-names></string-name> (<year>2007</year>) <article-title>Transcripts targeted by the microRNA-16 family cooperatively regulate cell cycle progression</article-title>.. <source>Molecular and cellular biology</source>, <volume>27</volume>(<issue>6</issue>), <fpage>2240</fpage>&#x2013;<lpage>52</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Ribeca</surname>, <given-names>P.</given-names></string-name> and <string-name><surname>Raineri</surname>, <given-names>E.</given-names></string-name> (<year>2008</year>) <article-title>Faster exact Markovian probability functions for motif occurrences: a DFA-only approach</article-title>.. <source>Bioinformatics (Oxford, England)</source>, <volume>24</volume>(<issue>24</issue>), <fpage>2839</fpage>&#x2013;<lpage>48</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>