<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/068478</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Genomics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title><monospace>recount</monospace>: A large-scale resource of analysis-ready RNA-seq expression data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Collado-Torres</surname><given-names>Leonardo</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Nellore</surname><given-names>Abhinav</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Kammers</surname><given-names>Kai</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Ellis</surname><given-names>Shannon E.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Taub</surname><given-names>Margaret A.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Hansen</surname><given-names>Kasper D.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Jaffe</surname><given-names>Andrew E.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="corresp" rid="cor1">&#x2021;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Langmead</surname><given-names>Ben</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor2">&#x2021;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Leek</surname><given-names>Jeffrey T.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor3">&#x2020;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health</institution></aff>
<aff id="a2"><label>2</label><institution>Center for Computational Biology, Johns Hopkins University</institution></aff>
<aff id="a3"><label>3</label><institution>Lieber Institute for Brain Development, Johns Hopkins Medical Campus</institution></aff>
<aff id="a4"><label>4</label><institution>Department of Computer Science, Johns Hopkins University</institution></aff>
<aff id="a5"><label>5</label><institution>Department of Mental Health, Johns Hopkins University</institution></aff>
<aff id="a6"><label>6</label><institution>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University</institution></aff>
</contrib-group>
<author-notes>
<fn id="n1"><label>&#x002A;</label><p>co-first authors;</p></fn>
<corresp id="cor1"><label>&#x2021;</label>corresponding author; <email>andrew.jaffe@libd.org</email></corresp>
<corresp id="cor2"><label>&#x2021;</label>corresponding author; <email>langmea@cs.jhu.edu</email></corresp>
<corresp id="cor3"><label>&#x2020;</label>corresponding author; <email>jtleek@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2016</year></pub-date>
<elocation-id>068478</elocation-id>
<history>
<date date-type="received">
<day>08</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>08</day>
<month>8</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="068478.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title><p><monospace>recount</monospace> is a resource of processed and summarized expression data spanning nearly 60,000 human RNA-seq samples from the Sequence Read Archive (SRA). The associated <monospace>recount</monospace> Bio-conductor package provides a convenient API for querying, downloading, and analyzing the data. Each processed study consists of meta/phenotype data, the expression levels of genes and their underlying exons and splice junctions, and corresponding genomic annotation. We also provide data summarization types for quantifying novel transcribed sequence including base-resolution coverage and potentially unannotated splice junctions. We present workflows illustrating how to use recount to perform differential expression analysis including meta-analysis, annotation-free base-level analysis, and replication of smaller studies using data from larger studies. recount provides a valuable and user-friendly resource of processed RNA-seq datasets to draw additional biological insights from existing public data. The resource is available at <ext-link ext-link-type="uri" xlink:href="https://jhubiostatistics.shinyapps.io/recount/">https://jhubiostatistics.shinyapps.io/recount/</ext-link>.</p>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>RNA sequencing</kwd>
<kwd>differential expression analysis</kwd>
<kwd>coverage</kwd>
<kwd>gene expression</kwd>
</kwd-group>
<counts>
<page-count count="19"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><label>1</label><title>Introduction</title>
<p>RNA sequencing (RNA-seq) is a ubiquitous tool for assaying gene expression. Public sequencing data repositories such as the Sequence Read Archive [<xref ref-type="bibr" rid="c1">1</xref>] now hold more than 50,000 human RNA-seq samples, and the size of the archive doubles approximately every 18 months (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view&#x003D;announcement">http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view&#x003D;announcement</ext-link>). Many studies in public and dbGaP-protected repositories are valuable to biological researchers and methods developers. For example, some studies are derived from individuals with rare disease [<xref ref-type="bibr" rid="c2">2</xref>], from hard-to-obtain tissues [<xref ref-type="bibr" rid="c3">3</xref>] or from rare forms of cancer [<xref ref-type="bibr" rid="c4">4</xref>]. Other studies are notable for their size, e.g. the GTEx study [<xref ref-type="bibr" rid="c5">5</xref>] consisting of 9,662 samples derived from 551 individuals and 54 body sites.</p>
<p>However, the majority of these archived samples are available only as compressed collections of raw sequencing reads. And while some samples have been summarized into gene counts in repositories like the Gene Expression Omnibus (GEO), these expression level summarizations are heavily dependent on the processing pipelines, which can vary dramatically across study. Typically analyses of public data require re-analysis beginning from the reads. However, processing raw reads into a form suitable for various downstream analyses is technically challenging. Care is required to craft expression summaries, derived from a common comparable pipeline - that are both concise &#x2013; convenient for researchers to download and interact with &#x2013; and useful in a variety of downstream scenarios.</p>
<p>Our first effort addressed this in two ways: (a) by summarizing data into concise gene count tables, and (b) by making processed data available in the form of Bioconductor [<xref ref-type="bibr" rid="c6">6</xref>] ExpressionSet objects including associated metadata using a single processing pipeline. That resource, called recount [<xref ref-type="bibr" rid="c7">7</xref>], was applied, for example, to development of methods for differential expression and normalization [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>], compilation of co-expression networks [<xref ref-type="bibr" rid="c11">11</xref>], and to studying the effect of ribosomal DNA dosage on gene expression [<xref ref-type="bibr" rid="c12">12</xref>]. Here we present an updated version of recount consisting of 59,319 uniformly processed human RNA-seq samples across 2,035 projects. These publicly available SRA samples include, for example, the entirety of the GTEx, GEUVADIS [<xref ref-type="bibr" rid="c13">13</xref>], SEQC/MACQ-III [<xref ref-type="bibr" rid="c14">14</xref>], and ABRF [<xref ref-type="bibr" rid="c15">15</xref>] studies. Now recount summarizes the expression data across multiple feature types, including genes, exons, exon-exon splice junctions and base-level coverage. These summarizations enable a wider variety of downstream analyses, including testing for differential expression of potentially unannotated transcribed sequence. Similarly, recount now marshals relevant meta/phenotype data into a searchable interface available from both the website (<ext-link ext-link-type="uri" xlink:href="https://jhubiostatistics.shinyapps.io/recount/">https://jhubiostatistics.shinyapps.io/recount/</ext-link>) and the Bioconductor package https:// github.com/leekgroup/recount, allowing users to rapidly access relevant data.</p>
<p>We demonstrate three potential workflows using the recount database and corresponding R package. First, we show that the resource can be used to merge multiple data sets studying the same problem to perform rapid genomic meta-analyses. Next, we demonstrate that our processed version of the GTEx gene count data closely matches the official gene counts released by the project itself. This serves to demonstrate (a) that it is easy to compare the processed data from recount to data processed with other pipelines and (b) that our gene counts are consistent with those published from the GTEx project. Lastly we show that the resource can be used to easily perform differential expression analysis at different feature summarizations: exons, genes, junctions, and expressed regions [<xref ref-type="bibr" rid="c7">7</xref>]. We also demonstrate the ease of comparing results discovered in one study within recount to other studies in the resource for validation. All of our analyses are reproducible and the results can be compiled using the R markdown files found at: <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/">http://leekgroup.github.io/recount-analyses/</ext-link>.</p>
</sec>
<sec id="s2"><label>2</label><title>Results</title>
<sec id="s2a"><label>2.1</label><title>Data description</title>
<p>We analyzed the publicly available SRA and the latest (v6) release of GTEx and samples. The SRA data consisted of 49,848 publicly available samples spanning over 146 terabases of reads. These reads were downloaded and analyzed, resulting in a final set of 48,558 samples that could be fully downloaded and processed (1,290 samples could be downloaded only partially and were excluded, see Supplementary Methods). The GTEx data consisted of 9,662 samples spanning over 65 terabases of reads, 550 individuals and the K562 cell line, and 32 tissues. These reads were downloaded and analyzed, resulting in a final set of 9479 samples that could be fully downloaded and processed (183 could be downloaded only partially, see Supplementary Methods).</p>
</sec>
<sec id="s2b"><label>2.2</label><title>Use case 1: Meta-analysis</title>
<p>To illustrate the ease of combining data from multiple projects included in recount as part of a cross-study meta-analysis, we carried out a cross-tissue differential expression (DE) analysis comparing gene expression between colon and whole blood. As an initial analysis, colon samples labeled as controls were taken from studies SRP029880 (a study of colorectal cancer [<xref ref-type="bibr" rid="c16">16</xref>], n &#x003D; 19) and SRP042228 (a study of Crohn&#x2019;s disease [<xref ref-type="bibr" rid="c17">17</xref>], n &#x003D; 41). Whole blood samples labeled as controls were taken from SRP059039 (a study of virus-caused diarrhea, unpublished, n &#x003D; 24), SRP059172 (a study of blood biomarkers for brucellosis, unpublished, n &#x003D; 47) and SRP062966 (a study of lupus, unpublished, n &#x003D; 18). After filtering genes to include only those with an average normalized count of at least 5 across samples, we performed gene-level differential expression analysis using limma [<xref ref-type="bibr" rid="c18">18</xref>] and voom [<xref ref-type="bibr" rid="c9">9</xref>].</p>
<p>To validate the results, we selected all colon and whole blood samples from the GTEx project (n &#x003D; 376 and 456, respectively) and performed the same analysis, adjusting for batch effects. We then computed rank-based concordance, examining the fraction of the top DE genes that were included in both analyses. Results are shown in orange in <xref rid="fig1" ref-type="fig">Figure 1A</xref>. Approximately 20&#x0025; of the top 100 genes from the two analyses were concordant. As a comparison and to provide context for this result, we performed two additional comparisons. First, we used GTEx lung data (n &#x003D; 374) in place of the colon data and computed DE genes compared to whole blood. In this case, only approximately 5&#x0025; of the top 100 DE genes were shared in the top 100 genes from our multi-study analysis. Second, to represent concordance results expected for a comparison of unrelated things, we used ranked coefficients for batch instead of for tissue and see very little concordance. These comparisons support that we can use the resources found in recount to perform a valid tissue-specific meta-analysis.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1:</label>
<caption><title>Meta-analysis and study comparison facilitated by recount A.</title>
<p>A concordance at the top plot showing comparisons between a meta-analysis tissue comparison of whole blood and colorectal tissue in data from the sequence read archive and the GTEx project. When comparing the same tissues there is strong concordance between differential expression results on public data and GTEx, less when different tissues are compared, and almost none when comparing different analyses. <bold>B.</bold> The distribution of correlations between gene expression estimates for GTEx V6 from the GTEx portal and the counts calculated in recount. The gene expression counts are highly correlated between both quantifications. <bold>C.</bold> An MA-plot comparing the fold changes for differential expression between colon and whole blood using the quantifications from GTEx and from recount. Most genes have similar fold change between the two analyses.</p></caption>
<graphic xlink:href="068478_fig1.tif"/>
</fig>
</sec>
<sec id="s2c"><label>2.3</label><title>Use case 2: GTEx comparison</title>
<p>One of the largest collections of RNA sequencing data currently available are data from the GTEx project consisting of 9,662 samples from over 250 individuals [<xref ref-type="bibr" rid="c19">19</xref>]. The recount collection includes the RNA-seq data from GTEx processed using the same pipeline as all other samples from SRA. The exon, gene, and junction counts are available from recount in the form of both tab-delimited files and analysis-ready Bioconductor objects.</p>
<p>We downloaded the official release of the gene counts from the GTEx portal (which were based on read counting) and compared them to our genes counts (which were based on base-level coverage). The gene expression levels we estimate using the recount pipeline have a median (IQR) correlation of 0.96 (0.93, 0.98) with the V6 release from GTEx (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). We performed a differential expression analysis comparing colon and whole blood samples. Differential expression analysis using the gene expression measurements from recount match the results using the V6 release from the GTEx portal (<italic>r</italic><sup>2</sup> &#x003D; .93 between fold changes for recount and GTEx v6 counts, <xref rid="fig1" ref-type="fig">Figure 1C</xref>). The advantage of using the recount version of the GTEx data is that they are already processed identically to tens of thousands of SRA samples and can be easily integrated to perform more comprehensive analyses as we have shown in previous examples.</p>
</sec>
<sec id="s2d"><label>2.4</label><title>Use case 3: Multi-level differential expression analyses</title>
<p>To demonstrate the ease with which differential gene expression analyses can be carried out in recount, we lastly performed differential expression (DE) analysis at the gene, exon, exon-exon-junction, and expressed region levels from data generated to determine the transcriptomic differences between breast cancer subtypes. In this first analysis, HER2-positive and triple negative breast cancer (TNBC) samples were selected from study SRP032789 (TNBC, n &#x003D; 6; HER2-positive, n &#x003D; 5) [<xref ref-type="bibr" rid="c20">20</xref>], and feature-level expression at genes, exons, junctions, and expressed regions were extracted (see Supplementary Methods). DE analysis at the gene-level identified 1,611 differentially expressed genes (q <italic>&#x003C;</italic> 0.05) with 933 genes demonstrating decreased expression and 678 increased expression in TNBC relative to HER2-positive breast cancer. At the exon level, 23,647 exons demonstrated differential expression (q <italic>&#x003C;</italic> 0.05; 11,218 downregulated and 12,429 upregulated). Finally, 19,805 exon-exon junctions were differentially expressed (q <italic>&#x003C;</italic> 0.05, 18,073 downregulated and 1,732 upregulated). DE analysis identified 35,809 differentially expressed regions (q <italic>&#x003C;</italic> 0.05, 17,170 downregulated and 18,639 upregulated). Of these significant DERs, 6,613 do not over-lap any annotated exons, demonstrating that 18&#x0025; of DERs detected would not be reported using annotation-dependent methods of expression estimation. <xref rid="fig2" ref-type="fig">Figure 2C</xref> highlights an example region in which differential expression occurs outside of any annotated protein-coding gene on Chromosome 3.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2:</label>
<caption><title>Multi-level differential expression analysis is facilitated by recount A.</title>
<p>A concordance at the top plot showing concordance between a gene-level analysis, an exon-level analysis, a junction level analysis, and an expressed region level analysis (DER). All of these analyses are possible and comparable with recount. <bold>B.</bold> A Venn diagram showing the number of expressed regions detected that overlap exons, intergenic regions, and intronic regions, including expressed regions that overlap multiple annotation types. Differential expression occurs outside of previously annotated protein-coding regions. <bold>C.</bold> An example of a region showing differential expression between breast tumor subtypes where there is no annotated gene present. The lines show the average coverage in each group across samples.</p></caption>
<graphic xlink:href="068478_fig2.tif"/>
</fig>
<p>We then summarized junctions and exons at the gene-level using the resulting DE p-values, and 67&#x0025; of the top 100 genes were shared across the gene and exon-level analyses (<xref rid="fig2" ref-type="fig">Figure 2A</xref>). In comparison, expressed regions and exon-exon junction analyses only shared 18&#x0025; and 5&#x0025; of the top 100 genes, respectively. Furthermore, to validate the differential expression findings, we compared the gene level results from study SRP032789 to an independent study (SRP019936; TNBC, n &#x003D; 8; HER2-positive, n &#x003D; 7) [<xref ref-type="bibr" rid="c21">21</xref>] (see Supplementary Methods). DE analysis was carried out as described above, identifying 3,197 genes as differentially expressed (q <italic>&#x003C;</italic> 0.05, 1,728 downregulated and 1,469 upregulated). Given the low concordance (8&#x0025; among the top 1000 genes) between these results and those from study SRP032789, we then applied independent hypothesis weighting (IHW) [<xref ref-type="bibr" rid="c22">22</xref>] across the two studies, which slightly improved replication rates. While sample size is limited in these two studies and thus likely thwarts our ability to see a huge increase in power using IHW, example code for IHW in recount is provided for application to other data sets.</p>
</sec>
</sec>
<sec id="s3"><label>3</label><title>Discussion</title>
<p>By producing summaries at multiple levels of detail, recount enables a range of downstream analyses. The summaries are concise and easy for users to download and use. Achieving an appropriate balance between conciseness and queryability is an important design challenge for any effort that seeks to make public data more usable for researchers.</p>
<p>All <monospace>recount</monospace> summaries are produced with analysis pipelines that are both reproducible and annotation-agnostic. Gene annotations are used only to label summarized data post analysis, and not to align reads or discover splice junctions. Downstream analyses are therefore fully aware of unannotated splicing events.</p>
<p>Other efforts have been made to summarize public gene expression data. The Expression Atlas [<xref ref-type="bibr" rid="c23">23</xref>] provides final results queryable only at the gene level, Toil focuses on curated data [<xref ref-type="bibr" rid="c24">24</xref>], and other efforts have focused primarily on cancer [<xref ref-type="bibr" rid="c25">25</xref>].</p>
<p><monospace>recount</monospace>, by contrast, covers a broad range of projects and produces summarized objects that can be further analyzed in a variety of ways - including directly with Bioconductor using the <monospace>recount</monospace> package.</p>
<p>The <monospace>recount</monospace> website is located at <ext-link ext-link-type="uri" xlink:href="https://jhubiostatistics.shinyapps.io/recount/">https://jhubiostatistics.shinyapps.io/recount/</ext-link>. The recount Bioconductor package is available under the Artistic 2.0 open source license and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/leekgroup/recount">https://github.com/leekgroup/recount</ext-link>.</p>
</sec>
<sec id="s4"><label>4</label><title>Online Methods</title>
<sec id="s4a"><label>4.1</label><title>Alignment</title>
<p>GTEx and public SRA samples were selected by searching the SRA website. Samples that could not be downloaded using fastq-dump were eliminated as discussed in Supplementary Methods.</p>
<p>Samples were aligned in a spliced fashion to the hg38 assembly of the human genome using Rail-RNA. Alignments were performed in batches on computer clusters rented from the Amazon Web Services Elastic MapReduce service. The alignment pipeline was divided into two phases, where the first phase (&#x201C;preprocessing&#x201D;) downloads and reformats the data and the second phase performs spliced alignment. Outputs of the pipeline include, for each sample, a junction coverage file (similar to a TopHat &#x201C;junctions.bed&#x201D; file) and a BigWig file [<xref ref-type="bibr" rid="c26">26</xref>] containing a genomewide coverage vector. Further details are presented in the Rail-RNA study [<xref ref-type="bibr" rid="c27">27</xref>] and Supplementary Methods.</p>
</sec>
<sec id="s4b"><label>4.2</label><title>Tabulation</title>
<p>Gene and exon counts were compiled using the BigWig files output by Rail-RNA and the UCSC knownGene annotation. For exon counts, we first obtained a set of non-overlapping &#x201C;unioned&#x201D; exons. Gene and exon counts were compiled into per-project tables and RangedSummarizedExperiment objects. We expanded the tables with several metadata columns containing, for example, read count, paired-end status, GEO accession, and the tissue type as predicted by the SHARQ beta resource (<ext-link ext-link-type="uri" xlink:href="http://www.cs.cmu.edu/&#x223C;ckingsf/sharq/">http://www.cs.cmu.edu/&#x223C;ckingsf/sharq/</ext-link>).</p>
</sec>
<sec id="s4c"><label>4.3</label><title>Use cases</title>
<p>All R code used for the analyses performing the use cases is available from the website: <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/">http://leekgroup.github.io/recount-analyses/</ext-link>.
<list list-type="bullet">
<list-item><p>Use case 1: Meta-analysis <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/example_meta/meta_analysis.pdf">http://leekgroup.github.io/recount-analyses/example_meta/meta_analysis.pdf</ext-link></p></list-item>
<list-item><p>Use case 2: GTEx comparison <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/example_meta/compare_with_GTEx_reproducible.pdf">http://leekgroup.github.io/recount-analyses/example_meta/compare_with_GTEx_reproducible.pdf</ext-link></p></list-item>
<list-item><p>Use case 3: Multi-level differential expression analyses Gene/exon: <ext-link ext-link-type="uri" xlink:href="http://leekgroup">http://leekgroup</ext-link>. github.io/recount-analyses/example_de/recount_SRP032789.pdf and annotation agnostic: <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/example_de/recount_DER_SRP032789.pdf">http://leekgroup.github.io/recount-analyses/example_de/recount_DER_SRP032789.pdf</ext-link> and validation of results in a second study <ext-link ext-link-type="uri" xlink:href="http://leekgroup.github.io/recount-analyses/example_de/recount_SRP019936.pdf">http://leekgroup.github.io/recount-analyses/example_de/recount_SRP019936.pdf</ext-link></p></list-item>
</list>
</p>
</sec>
</sec>
<sec id="s5"><label>5</label><title>Acknowledgments</title>
<p>We thank Carl Kingsford and Darya Filippova for their assistance in adding SHARQ metadata to recount. recount data is hosted on SciServer, a collaborative research environment for large-scale data-driven science. It is being developed at, and administered by, the Institute for Data Intensive Engineering and Science at Johns Hopkins University. SciServer is funded by the National Science Foundation Award ACI-1261715. For more information about SciServer, visit <ext-link ext-link-type="uri" xlink:href="http://www">http://www</ext-link>. sciserver.org.</p>
<p>The Genotype-Tissue Expression (GTEx) Project was supported by the Common Fund of the Office of the Director of the National Institutes of Health. Additional funds were provided by the NCI, NHGRI, NHLBI, NIDA, NIMH, and NINDS. Donors were enrolled at Biospecimen Source Sites funded by NCI/SAIC-Frederick, Inc. (SAIC-F) subcontracts to the National Disease Research Interchange (10XS170), Roswell Park Cancer Institute (10XS171), and Science Care, Inc. (X10S172). The Laboratory, Data Analysis, and Coordinating Center (LDACC) was funded through a contract (HHSN268201000029C) to The Broad Institute, Inc. Biorepository operations were funded through an SAIC-F subcontract to Van Andel Institute (10ST1035). Additional data repository and project management were provided by SAIC-F (HHSN261200800001E). The Brain Bank was supported by a supplements to University of Miami grants DA006227 &#x0026; DA033684 and to contract N01MH000028. Statistical Methods development grants were made to the University of Geneva (MH090941 &#x0026; MH101814), the University of Chicago (MH090951, MH090937, MH101820, MH101825), the University of North Carolina - Chapel Hill (MH090936 &#x0026; MH101819), Harvard University (MH090948), Stanford University (MH101782), Washington University St Louis (MH101810), and the University of Pennsylvania (MH101822). The data used for the analyses described in this manuscript were obtained from: the GTEx Portal on 11/21/15 and/or dbGaP accession number phs000424.v6.p1 on 11/30/15 - 12/04/15.</p>
</sec>
<sec id="s6"><label>6</label><title>Competing interests</title>
<p>The authors declare that they have no competing interests.</p>
</sec>
<sec id="s7" sec-type="funding"><label>7</label><title>Funding</title>
<p>BL, JTL, LCT, SE, AN, MT, KH and KK were supported by NIH R01 GM105705. LCT was supported by Consejo Nacional de Ciencia y Tecnolog&#x00ED;a M&#x00B4;exico 351535. Amazon Web Services experiments were supported by AWS in Education research grants.</p>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><given-names>Y.</given-names> <surname>Kodama</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Shumway</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Leinonen</surname></string-name>. &#x201C;<article-title>The Sequence Read Archive: explosive growth of sequencing data</article-title>&#x201D;. <source>In: Nucleic acids research</source> <volume>40.D1</volume> <year>(2012)</year>, pp. <fpage>D54</fpage>&#x2013;<lpage>D56</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><given-names>C. A.</given-names> <surname>Albers</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Compound inheritance of a low-frequency regulatory SNP and a rare null mutation in exon-junction complex subunit RBM8A causes TAR syndrome</article-title>&#x201D;. <source>In: Nature genetics</source> <volume>44.4</volume> <year>(2012)</year>, pp. <fpage>435</fpage>&#x2013;<lpage>439</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Kohen</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Transcriptome profiling of human hippocampus dentate gyrus granule cells in mental illness</article-title>&#x201D;. <source>In: Translational psychiatry</source> <volume>4.3</volume> <year>(2014)</year>, <fpage>e366</fpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Goh</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Recurrent activating mutation in PRKACA in cortisol-producing adrenal tumors</article-title>&#x201D;. <source>In: Nature genetics</source> <volume>46.6</volume> <year>(2014)</year>, pp. <fpage>613</fpage>&#x2013;<lpage>617</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Mel&#x00E9;</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>The human transcriptome across tissues and individuals</article-title>&#x201D;. <source>In: Science</source> <volume>348.6235</volume> <year>(2015)</year>, pp. <fpage>660</fpage>&#x2013;<lpage>665</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><given-names>R. C.</given-names> <surname>Gentleman</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>&#x201D;. <source>In: Genome biology</source> <volume>5.10</volume> <year>(2004)</year>, <fpage>R80</fpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><given-names>A. C.</given-names> <surname>Frazee</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Langmead</surname></string-name>, and <string-name><given-names>J. T.</given-names> <surname>Leek</surname></string-name>. &#x201C;<article-title>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</article-title>&#x201D;. <source>In: BMC bioinformatics</source> <volume>12</volume> <year>(2011)</year>, p. <fpage>449</fpage>. issn: 1471-2105. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-12-449</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><given-names>M. I.</given-names> <surname>Love</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Huber</surname></string-name>, and S. Anders. &#x201C;<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>&#x201D;. <source>In: Genome biology</source> <volume>15.12</volume> <year>(2014)</year>, pp. <fpage>1</fpage>&#x2013;<lpage>21</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><given-names>C. W.</given-names> <surname>Law</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>&#x201D;. <source>In: Genome Biol</source> <volume>15.2</volume> <year>(2014)</year>, <fpage>R29</fpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><given-names>J. N.</given-names> <surname>Paulson</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>&#x201D;. <source>In: Nature methods</source> <volume>10.12</volume> <year>(2013)</year>, pp. <fpage>1200</fpage>&#x2013;<lpage>1202</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><given-names>O. D.</given-names> <surname>Iancu</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Utilizing RNA-Seq data for de novo coexpression network inference</article-title>&#x201D;. <source>In: Bioinformatics</source> <volume>28.12</volume> <year>(2012)</year>, pp. <fpage>1592</fpage>&#x2013;<lpage>1597</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><given-names>J. G.</given-names> <surname>Gibbons</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Ribosomal DNA copy number is coupled with gene expression variation and mitochondrial abundance in humans</article-title>&#x201D;. <source>In: Nature communications</source> <volume>5</volume> <year>(2014)</year>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><given-names>T.</given-names> <surname>Lappalainen</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>&#x201D;. <source>In: Nature</source> <volume>501.7468</volume> <year>(2013)</year>, pp. <fpage>506</fpage>&#x2013;<lpage>511</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><given-names>S.-I.</given-names> <surname>Consortium</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>&#x201D;. <source>In: Nature biotechnology</source> <volume>32.9</volume> <year>(2014)</year>, pp. <fpage>903</fpage>&#x2013;<lpage>914</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Li</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Multi-platform assessment of transcriptome profiling using RNA-seq in the ABRF next-generation sequencing study</article-title>&#x201D;. <source>In: Nature biotechnology</source> <volume>32.9</volume> <year>(2014)</year>, pp. <fpage>915</fpage>&#x2013;<lpage>925</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><given-names>S.-K.</given-names> <surname>Kim</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>A nineteen gene-based risk score classifier predicts prognosis of colorectal cancer patients</article-title>&#x201D;. <source>In: Molecular Oncology</source> <volume>8.8</volume> <year>(2014)</year>, pp. <fpage>1653</fpage>&#x2013;<lpage>1666</lpage>. issn: 1574-7891. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.molonc.2014.06.016">http://dx.doi.org/10.1016/j.molonc.2014.06.016</ext-link>. url: <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S1574789114001525">http://www.sciencedirect.com/science/article/pii/S1574789114001525</ext-link>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><given-names>Y.</given-names> <surname>Haberman</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Pediatric Crohn disease patients exhibit specific ileal transcriptome and microbiome signature</article-title>&#x201D;. <source>In: The Journal of Clinical Investigation</source> <volume>124.8</volume> (Aug. 2014), pp. <fpage>3617</fpage>&#x2013;<lpage>3633</lpage>. doi:<pub-id pub-id-type="doi">10.1172/JCI75436</pub-id>. url: <ext-link ext-link-type="uri" xlink:href="http://www.jci.org/articles/view/75436">http://www.jci.org/articles/view/75436</ext-link>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><given-names>G. K.</given-names> <surname>Smyth</surname></string-name>. &#x201C;<article-title>Limma: linear models for microarray data</article-title>&#x201D;. <source>In: Bioinformatics and computational biology solutions using R and Bioconductor. Springer</source>, <year>2005</year>, pp. <fpage>397</fpage>&#x2013;<lpage>420</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Consortium</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>The Genotype-Tissue Expression (GTEx) pilot analysis: Multitissue gene regulation in humans</article-title>&#x201D;. <source>In: Science</source> <volume>348.6235</volume> <year>(2015)</year>, pp. <fpage>648</fpage>&#x2013;<lpage>660</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Eswaran</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>RNA sequencing of cancer reveals novel splicing alterations</article-title>&#x201D;. <source>In: Scientific reports</source> <volume>3</volume> <year>(2013)</year>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><given-names>K. R.</given-names> <surname>Kalari</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>An integrated model of the transcriptome of HER2-positive breast cancer</article-title>&#x201D;. <source>In: PloS one</source> <volume>8.11</volume> <year>(2013)</year>, <fpage>e79298</fpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><given-names>N.</given-names> <surname>Ignatiadis</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Data-driven hypothesis weighting increases detection power in genomescale multiple testing</article-title>&#x201D;. <source>In: Nature methods</source><year>(2016)</year>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><given-names>R.</given-names> <surname>Petryszak</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Expression Atlas update&#x2014;an integrated database of gene and protein expression in humans, animals and plants</article-title>&#x201D;. <source>In: Nucleic acids research</source> <volume>44.D1</volume> <year>(2016)</year>, pp. <fpage>D746</fpage>&#x2013;<lpage>D752</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Vivian</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Rapid and efficient analysis of 20,000 RNA-seq samples with Toil</article-title>&#x201D;. <source>In: bioRxiv</source> <year>(2016), p</year>. <fpage>062497</fpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><given-names>P.</given-names> <surname>Tatlow</surname></string-name> and <string-name><given-names>S. R.</given-names> <surname>Piccolo</surname></string-name>. &#x201C;<article-title>A cloud-based workflow to quantify transcript-expression levels in public cancer compendia</article-title>&#x201D;. <source>In: bioRxiv</source><year>(2016), p</year>. <fpage>063552</fpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><given-names>W. J.</given-names> <surname>Kent</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>BigWig and BigBed: enabling browsing of large distributed datasets</article-title>&#x201D;. <source>In: Bioinformatics (Oxford, England)</source> <volume>26.17</volume> (Sept. 2010), pp. <fpage>2204</fpage>&#x2013;<lpage>2207</lpage>. issn: 1367-4811. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btq351.</pub-id></mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Nellore</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Rail-RNA: Scalable analysis of RNA-seq splicing and coverage</article-title>&#x201D;. <source>In: bioRxiv</source> <year>(2015)</year>, p. <fpage>019067</fpage>.</mixed-citation></ref>
</ref-list>
<sec id="s8" sec-type="supplementary-material"><title>Supplementary Methods and Results</title>
<sec id="s8a"><label>1</label><title>Supplementary Results</title>
</sec>
<sec id="s8b"><label>2</label><title>Supplementary Methods</title>
<sec id="s8b1"><title>Selecting GTEx samples</title>
<p>On November 21, 2015, we queried the SRA website at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link> for RNA-seq samples in the GTEx project (accession: SRP012682). Precise search terms were (SRP012682) AND &#x201C;strategy rna seq&#x0022;[Properties]. A screenshot is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/gtex/SRA_GTEx_search_screenshot_">https://github.com/nellore/runs/raw/master/gtex/SRA_GTEx_search_screenshot_</ext-link> 6.37.16_PM_ET_11.21.2015.png. We used the &#x201C;send to file&#x201D; function to download search results to a table, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/gtex/SraRunInfo.csv">https://github.com/nellore/runs/raw/master/gtex/SraRunInfo.csv</ext-link>. The table lists 9,795 run accessions, some of which were mmPCR-seq. We restricted our attention to the 9,662 mRNA-seq samples in the V6 release of the GTEx consortium.</p>
</sec>
<sec id="s8b2"><title>Selecting SRA samples</title>
<p>Public SRA samples were selected from SRA as follows. On February 3, 2016, we queried the SRA website at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link> for publicly available human RNA-seq samples. Precise search terms were &#x201C;platform illumina&#x0022;[Properties] AND &#x201C;strategy rna seq&#x0022;[Properties] AND &#x201C;human&#x0022;[Organism] AND &#x201C;cluster public&#x0022;[Properties] AND &#x201C;biomol rna&#x0022;[Properties]. A screenshot is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/">https://github.com/nellore/</ext-link> runs/raw/master/sra/v2/hg38/SRA_RNA-seq_search_screenshot_3.33.19_PM_ET_02.03.2016. png. We used the &#x201C;send to file&#x201D; function to download the search results to a table, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/sra/v2/hg38/SraRunInfo.csv">https://github.com/nellore/runs/raw/master/sra/v2/hg38/SraRunInfo.csv</ext-link>. The table lists 50,186 run accessions, each with metadata fields including layout (SINGLE or PAIRED) and number of reads (i.e., read pairs for paired-end samples).</p>
</sec>
<sec id="s8b3"><title>Alignment with Rail-RNA</title>
<p>We used Rail-RNA v0.2.3 [<xref ref-type="bibr" rid="c1">1</xref>] to align all selected samples we could download to the <italic>hg38</italic> assembly. Alignment was performed using the Amazon Web Services Elastic MapReduce commercial cloud computing service. that is, standardized units of computing capacity.</p>
<p>Spot instances allow users to bid for excess computing capacity. If the fluctuating market price drops below a users&#x2019;s bid, the instances could be lost, halting the computation. So saving money by bidding for spot instances comes with risk, and rather than aligning all samples in one batch, we distributed this risk by dividing alignment up [into batches]. For GTEx, we randomly divided the set of 9,662 samples up into 30 batches, each with 322 or 323 samples; for other SRA samples, we randomly divided the set of samples into 100 batches, each with 501 or 502 samples. Analysis of each batch was itself divided into (1) a preprocessing job flow, which uses SRA Tools fastq-dump (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link>) to download compressed reads from the National Center for Biotechnology Information server and preprocess them, writing to Amazon&#x2019;s cloud storage service S3; and (2) an alignment job flow. Every preprocessing job flow was run on a cluster of 21 m3.xlarge instances, each with 4 Intel Xeon E5-2680 v2 (Ivy Bridge) processing cores and 15 GB of RAM. Every alignment job flow was run on a cluster of 81 c3.8xlarge instances, each with 32 Intel Xeon E5-2680 v2 (Ivy Bridge) processing cores and 60 GB of RAM. Our GTEx alignment runs may be reproduced by following instructions at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/blob/">https://github.com/nellore/runs/blob/</ext-link> master/gtex/README.md. Our alignment runs may be reproduced by following instructions at <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/blob/master/sra/v2/README.md">https://github.com/nellore/runs/blob/master/sra/v2/README.md</ext-link>. Alignment of GTEx data is described in more detail in the supplementary material of [<xref ref-type="bibr" rid="c2">2</xref>].</p>
</sec>
<sec id="s8b4"><title>Incomplete and invalid input data</title>
<p>For the analysis of the public SRA samples, some samples could not be downloaded, due to failures of the fastq-dump software. The issue persisted even when we attempted to restart the fastq-dump process. Samples exhibiting this issue can be excluded from analysis. These samples are listed here: <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/">https://github.com/nellore/runs/raw/master/</ext-link> sra/v2/hg38/NOTES. That file also describes two other preprocessing issues that led us to exclude a few other samples from analysis: (1) sequence input encoded in a manner we did not recognize; (2) miscellaneous errors reported by fastq-dump.</p>
<p>In addition, for each of a small number of both GTEx and public SRA samples, fastq-dump would return success (an exit code of 0) when an error had occurred and the number of reads output by the tool disagreed with the number of reads from SRA metadata given in the SraRunInfo.csv file for that sample. So for each sample, we compared the number of reads ingested by Rail-RNA with the number of reads reported in SraRunInfo.csv. Sometimes, the sample was listed as paired-end when the number of mates (i.e., twice the number of read pairs listed in SRARunInfo.csv) was exactly twice the number of reads Rail-RNA processed; other times, the sample was listed as single-end but the number of reads Rail-RNA processed was greater than the number of reads listed. In these cases, we made note of our suspicion that the library layout listed on SRA was incorrect.</p>
<p>The table <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/gtex/incomplete.tsv">https://github.com/nellore/runs/raw/master/gtex/incomplete.tsv</ext-link> (respectively, <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/sra/v2/incomplete.tsv">https://github.com/nellore/runs/raw/master/sra/v2/incomplete.tsv</ext-link>) lists all GTEx (respectively, public SRA) samples that either could not be downloaded or were incompletely down-loaded, and it includes these suspected layout misreports in a column. This table was generated by the script <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/gtex/incomplete.py">https://github.com/nellore/runs/raw/master/gtex/incomplete.py</ext-link> (re-spectively, <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/raw/master/sra/v2/incomplete.py">https://github.com/nellore/runs/raw/master/sra/v2/incomplete.py</ext-link>) for GTEx (respectively, public SRA) samples.</p>
</sec>
<sec id="s8b5"><title>Counting genes and exons</title>
<p>When creating the count tables, genes and exons (features) were determined using TxDb.Hsapiens.UCSC.hg38.knownGene package version 3.1.3 [<xref ref-type="bibr" rid="c3">3</xref>]. For each gene, we first obtained a set of non-overlapping exonic intervals by taking the &#x201C;union&#x201D; of the gene&#x2019;s annotated exons. We call these &#x201C;unioned exons&#x201D;. We summed per-base coverage across each unioned exon using bwtool version 1.0 [<xref ref-type="bibr" rid="c4">4</xref>]. We obtained gene-level counts by summing per-base coverage totals of its constituent unioned exons. For each SRA project and each feature type we created a RangedSummarizedExperiment object [<xref ref-type="bibr" rid="c5">5</xref>] containing columns for:
<list list-type="bullet">
<list-item><p>SRA study id</p></list-item>
<list-item><p>SRA sample id</p></list-item>
<list-item><p>SRA experiment id</p></list-item>
<list-item><p>SRA run id</p></list-item>
<list-item><p>read counts as reported by SRA</p></list-item>
<list-item><p>number of reads downloaded from SRA and subsequently aligned with Rail-RNA</p></list-item>
<list-item><p>proportion of reads reported by SRA that aligned</p></list-item>
<list-item><p>whether the sample was paired-end or not</p></list-item>
<list-item><p>whether SRA likely misreported the paired-end label (as explained above)</p></list-item>
<list-item><p>mapped read count by Rail-RNA</p></list-item>
<list-item><p>coverage area under the curve (AUC), i.e. total number of aligned bases not including soft-clipped bases</p></list-item>
<list-item><p>tissue type as predicted by SHARQ (<ext-link ext-link-type="uri" xlink:href="http://www.cs.cmu.edu/&#x223C;ckingsf/sharq/">http://www.cs.cmu.edu/&#x223C;ckingsf/sharq/</ext-link>)</p></list-item>
<list-item><p>cell type as predicted by SHARQ</p></list-item>
<list-item><p>biosample submission date</p></list-item>
<list-item><p>biosample publication date</p></list-item>
<list-item><p>biosample update date</p></list-item>
<list-item><p>average read length as reported by SRA</p></list-item>
<list-item><p>GEO accession id</p></list-item>
<list-item><p>sample title as reported by GEO</p></list-item>
<list-item><p>sample characteristics as reported by GEO</p></list-item>
<list-item><p>name of the coverage BigWig file</p></list-item>
</list>
</p>
<p>For each sample we normalized the coverage to 40 million 100 base-pair reads using the AUC information. We then computed the base-level coverage sum for each project using the sample normalized coverage with bwtool version 1.0 [4] and divided the coverage sum by the number of samples in the project resulting in the project mean coverage. We then stored the mean coverage for each SRA project in a BigWig file [6]. The mean coverage can then be used to identify expressed regions with derfinder [7] via the recount R package. The code and log files for creating these files as well as the recount website are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/leekgroup/recount-website">https://github.com/leekgroup/recount-website</ext-link>. <bold>Exon-exon junction output processing.</bold> We postprocessed Rail-RNA&#x2019;s cross-sample junction TSVs to obtain two gzip-compressed files for each project on SRA: [SRA project accession number].junction id with transcripts.bed.gz, a file in BED format that contains junction coordinates, assigns each junction a unique identifier in the name column, and also lists which transcripts in GENCODE v24 [8] contain the junction or its corresponding donor and acceptor site; and [SRA project accession].junction coverage.tsv.gz, which for each junction identifer gives the number of reads that map across the junction in each sample in the project. This postprocessing was performed by two scripts run in succession: <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/blob/master/sra/v2/hg38/junctions_by_project.py">https://github.com/nellore/runs/blob/master/sra/v2/hg38/junctions_by_project.py</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/nellore/runs/blob/master/sra/v2/hg38/add_knowngene.py">https://github.com/nellore/runs/blob/master/sra/v2/hg38/add_knowngene.py</ext-link>.</p>
<p>For each project, we created a RangedSummarizedExperiment using the sample metadata as in the exon and gene cases while annotating the exon-exon junctions with the:
<list list-type="bullet">
<list-item><p>exon-exon junction id</p></list-item>
<list-item><p>GENCODE v24 transcript id</p></list-item>
<list-item><p>transcript name, gene id and gene symbol based on TxDb.Hsapiens.UCSC.hg38.knownGene</p></list-item>
<list-item><p>class: annotated, exon skip, alternative end, fusion, novel</p></list-item>
<list-item><p>proposed gene id and gene symbol based on TxDb.Hsapiens.UCSC.hg38.knownGene.</p></list-item>
</list></p>
<p>The code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/leekgroup/recount-website">https://github.com/leekgroup/recount-website</ext-link>.</p>
</sec>
<sec id="s8b6"><title>Breast Cancer Use Case</title>
<p>Principal component analysis (PCA) was run to identify any sample outliers. All samples were retained for downstream analyses. The 17,874 genes with an average normalized count greater than five across samples were included for downstream analysis. Similarly, 204,559 exons and 45,933 exon-exon junctions with reads overlapping those genes were also included for DE analysis. Finally using this data set, we further included analysis of data at the level of expressed regions to highlight the utility of summarizing expression in an annotation-agnostic manner. At the expressed region level, 291,247 regions with an average normalized read count greater than five across samples were included for DE analysis. DE between the two cancer subtypes was carried out using limma and voom [9]. For multiple comparison correction we calculated q-values from the observed p-values after estimating the proportion of differentially expressed genes, exons, or exon-exon junctions in the experiment [10]. Features with calculated q-values smaller than 0.05 between different tissue types were declared statistically significant. To compare the results across these levels of data, we used Simes&#x2019; rule [11] to calculate a gene-based p-value for all exons, exon-exon junctions, and differentially expressed regions that overlap genes. We then computed rank-based concordance between the gene and either the exon, junction, or expressed region level results.</p>
<p>In the replication dataset, count data were filtered as before and PCA was utilized to identify global sample outliers. One TNBC tumor sample was identified as an outlier and removed from analysis. IHW uses a set of independent weights for each gene in one study to weight the hypothesis tests in the second study to increase power to detect differences. Here, for each gene the absolute value of the test statistic from study SRP032789 were used as weights for DE analysis in study SRP019936. This is akin to using an empirical prior and treating the second study as a validation of the first.</p>
</sec>
</sec>
</sec>
<ref-list><title>References</title>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Nellore</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Rail-RNA: Scalable analysis of RNA-seq splicing and coverage</article-title>&#x201D;. <source>In: bioRxiv</source> (<year>2015</year>), p. <fpage>019067</fpage>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Nellore</surname></string-name>, <etal>et al.</etal> &#x201C;<article-title>Rail-dbGaP: a protocol and tool for analyzing protected genomic data in a commercial cloud</article-title>&#x201D;. <source>In: bioRxiv</source> (<year>2015</year>), p. <fpage>035287</fpage>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Carlson</surname></string-name>. <article-title>TxDb.Hsapiens.UCSC.hg38</article-title>.<source>knownGene: Annotation package for TxDb object(s). R package version</source> <volume>3</volume>.<issue>1</issue>.<issue>3</issue>. <fpage>2015</fpage>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Pohl</surname></string-name> and <string-name><given-names>M.</given-names> <surname>Beato</surname></string-name>. <article-title>&#x201C;bwtool: a tool for bigWig files&#x201D;. In: Bioinformatics (Oxford</article-title>, <source>England)</source> <volume>30</volume>.<issue>11</issue> (June <year>2014</year>), pp. <fpage>1618</fpage>&#x2013;<lpage>1619</lpage>. issn: <issn>1367&#x2013;4811</issn>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btu056</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Morgan</surname></string-name>, <etal>et al.</etal> <article-title>SummarizedExperiment: SummarizedExperiment container</article-title>. <source>R package version</source> <volume>1</volume>.<issue>3</issue>.<issue>3</issue>. <fpage>2016</fpage>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><string-name><given-names>W. J.</given-names> <surname>Kent</surname></string-name>, <etal>et al.</etal> <article-title>&#x201C;BigWig and BigBed: enabling browsing of large distributed datasets&#x201D;. In: Bioinformatics (Oxford</article-title>, <source>England)</source> <volume>26</volume>.<issue>17</issue> (Sept. <year>2010</year>), pp. <fpage>2204</fpage>&#x2013;<lpage>2207</lpage>. issn: <issn>1367&#x2013;4811</issn>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btq351</pub-id>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><string-name><given-names>L.</given-names> <surname>Collado-Torres</surname></string-name>, <etal>et al.</etal> &#x201C;<article-title>Flexible expressed region analysis for RNA-seq with derfinder</article-title>&#x201D;. <source>In: bioRxiv</source> (<year>2016</year>), p. <fpage>015370</fpage>. doi: <pub-id pub-id-type="doi">10.1101/015370</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Harrow</surname></string-name>, <etal>et al.</etal> &#x201C;<article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>&#x201D;. <source>In: Genome research</source> <volume>22</volume>.<issue>9</issue> (<year>2012</year>), pp. <fpage>1760</fpage>&#x2013;<lpage>1774</lpage>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><string-name><given-names>C. W.</given-names> <surname>Law</surname></string-name>, <etal>et al.</etal> &#x201C;<article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>&#x201D;. <source>In: Genome Biol</source> <volume>15</volume>.<issue>2</issue> (<year>2014</year>), <fpage>R29</fpage>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><string-name><given-names>J. D.</given-names> <surname>Storey</surname></string-name> and <string-name><given-names>R.</given-names> <surname>Tibshirani</surname></string-name>. &#x201C;<article-title>Statistical significance for genomewide studies</article-title>&#x201D;. <source>In: Proceedings of the National Academy of Sciences</source> <volume>100</volume>.<issue>16</issue> (<year>2003</year>), pp. <fpage>9440</fpage>&#x2013;<lpage>9445</lpage>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><string-name><given-names>R. J.</given-names> <surname>Simes</surname></string-name>. &#x201C;<article-title>An improved Bonferroni procedure for multiple tests of significance</article-title>&#x201D;. <source>In: Biometrika</source> <volume>73</volume>.<issue>3</issue> (<year>1986</year>), pp. <fpage>751</fpage>&#x2013;<lpage>754</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
