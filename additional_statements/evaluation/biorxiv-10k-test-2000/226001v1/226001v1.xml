<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/226001</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Biophysics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Biomolecular simulations under realistic macroscopic salt conditions</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ross</surname><given-names>Gregory A.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rustenburg</surname><given-names>Ari&#x0451;n S.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9762-4201</contrib-id>
<name>
<surname>Grinaway</surname><given-names>Patrick B.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3719-266X</contrib-id>
<name>
<surname>Fass</surname><given-names>Josh</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Chodera</surname><given-names>John D.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Computational and Systems Biology Program, Sloan Kettering Institute, Memorial Sloan Kettering Cancer Center</institution>, New York, NY 10065</aff>
<aff id="a2"><label>2</label><institution>Graduate Program in Physiology, Biophysics, and Systems Biology, Weill Cornell Medical College</institution>, New York, NY 10065</aff>
<aff id="a3"><label>3</label><institution>Tri-Institutional PhD Program in Computational Biology &#x0026; Medicine</institution>, New York, NY 10065</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>For correspondence: <email>john.chodera@choderalab.org</email> (John D. Chodera)</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>226001</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>28</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>29</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="226001.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Biomolecular simulations are typically performed in an aqueous environment where the number of ions remains fixed for the duration of the simulation, generally with either a minimally neutralizing ion environment or a number of salt pairs intended to match the macroscopic salt concentration. In contrast, real biomolecules experience local ion environments where the salt concentration is dynamic and may differ from bulk. The degree of salt concentration variability and average deviation from the macroscopic concentration remains, as yet, unknown. Here, we describe the theory and implementation of a Monte Carlo <italic>osmostat</italic> that can be added to explicit solvent molecular dynamics or Monte Carlo simulations to sample from a semigrand canonical ensemble in which the number of salt pairs fluctuates dynamically during the simulation. The osmostat reproduce the correct equilibrium statistics for a simulation volume that can exchange ions with a large reservoir at a defined macroscopic salt concentration. To achieve useful Monte Carlo acceptance rates, the method makes use of nonequilibrium candidate Monte Carlo (NCMC) moves in which monovalent ions and water molecules are alchemically transmuted using short nonequilibrium trajectories, with a modified Metropolis-Hastings criterion ensuring correct equilibrium statistics for an (&#x0394;<italic>&#x03BC;, N, p, T</italic>) ensemble. We demonstrate how typical protein (DHFR and the tyrosine kinase Src) and nucleic acid (Drew-Dickerson B-DNA dodecamer) systems exhibit salt concentration distributions that significantly differ from fixed-salt bulk simulations and display fluctuations that are on the same order of magnitude as the average.</p>
</abstract>
<counts>
<page-count count="44"/>
</counts>
</article-meta>
</front>
<body>
<p>Molecular dynamics simulations have proven themselves a powerful tool for studying the structure, dynamics, and function of biomolecular systems in atomic detail. Current state-of-the-art approaches simulate a small volume around the biomolecule using explicit atomistic solvent to model the local environment. To more realistically emulate electrostatic screening effects in the local solvent environment, explicit ions are generally added, both to achieve net neutrality and to mimic the macroscopic salt concentration in the <italic>in vitro</italic> or <italic>in vivo</italic> environment being studied.</p>
<p>Salt concentrations and ionic composition are tightly regulated in biology [<xref ref-type="bibr" rid="c39">39</xref>]. Ion composition differs between inter/intracellular environments [<xref ref-type="bibr" rid="c52">52</xref>], tumor microenvironments [<xref ref-type="bibr" rid="c19">19</xref>], and organelles [<xref ref-type="bibr" rid="c55">55</xref>] (see <xref ref-type="fig" rid="fig1">Figure 1</xref>, <italic>left</italic>). The local ionic concentration in the environment around real biological macromolecules, however, can significantly deviate from macroscopic concentrations. Many biomolecules possess a significant net charge, and the energetic penalty for physical systems to maintain charge separation over large distances serves to recruit more or less ions from bulk to maintain charge neutrality over macroscopic lengthscales. Yet, the number of ions within the immediate vicinity may not necessarily counter the net charge of the macromolecule, as proteins can predominantly bind to ions that have the same polarity as their net charge [<xref ref-type="bibr" rid="c78">78</xref>]. Additionally, statistical fluctuations in the total number of ions in the region around the biomolecule may result in significant variance in the local salt concentration, where relative concentration fluctuations diminish slowly with increasing simulation volume (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <italic>middle</italic>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Schematic illustrations of typical salt concentrations in mammalian environments and anions and cations being exchanged with a saline buffer in the region around a biomolecule.</title><p><italic>Left:</italic> The ion compositions of intra- and intercellular mammalian environments are shown as <italic>millimolar equivalents</italic> (mM Eq), which is the ion concentration multiplied by the absolute charge of the ion. The primary contribution to the ionic-strength are monovalent ions (Na<sup>&#x002B;</sup>, K<sup>&#x002B;</sup>, Cl<sup>&#x2212;</sup>), divalent cations (predominantly Mg<sup>2&#x002B;</sup>), complex salt and buffer molecules, and charged proteins. In addition to the significant difference between the ionic composition of the cytoplasmic fluid and extracellular fluid, organelles can also have markedly different ionic concentrations to the cytoplasmic fluid [<xref ref-type="bibr" rid="c55">55</xref>]. Over large lengthscales, environments are approximately electrostatically neutral;electrostatic potentials across cell membranes are maintained by an imbalance of anions and cations that is minuscule relative to the total number ions [<xref ref-type="bibr" rid="c52">52</xref>]. Figure adapted from [<xref ref-type="bibr" rid="c52">52</xref>] and [<xref ref-type="bibr" rid="c60">60</xref>]. <italic>Middle:</italic> In a very large system, where the number of water molecules and number of ions are f xed, signif cant fluctuations can occur in the ionic strength of the local environment of a biomolecule (in purple). The local environment is represented by a dashed line, within which the number of water molecules and ions fluctuate at equilibrium. <italic>Right:</italic> A simulation with an osmostat replicates the natural variations in ionic strength around a biomolecule that would occur if the system were embedded in an inf nite saline reservoir at a fixed macroscopic salt concentration. Anions and cations (blue and orange spheres) are inserted and deleted (green stars) from the system using semigrand canonical Monte Carlo moves that exchange explicit water molecules for the ions in a manner that maintains total charge neutrality. The reservoir is completely def ned by its thermodynamic parameters, which in this case include the difference in the chemical potential for two water molecules and NaCl, &#x0394;<italic>&#x03BC;</italic> (&#x003D; &#x0394;<italic>&#x03BC;</italic><sub>2.H<sub>2</sub>O-NaCl</sub>), pressure <italic>p</italic>, and temperature, <italic>T</italic>.</p></caption>
<graphic xlink:href="226001_fig1.tif"/>
</fig>
<sec id="s1">
<sec id="s1a">
<title>Biomolecular behavior can be sensitive to salt environments</title>
<p>The conformations, dynamics, function, and binding of biological macromolecules can be exquisitely sensitive to the salt concentration and composition of the local environment. The Hofmeister effect, in which ions modulate the strength of the hydrophobic effect&#x2014;a major driving force in protein folding and association [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c79">79</xref>]&#x2014;has been known since at least the nineteenth century [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c63">63</xref>]. Biomolecular interactions involving highly charged nucleic acids&#x2014;such as DNA:protein interactions critical for DNA repair [<xref ref-type="bibr" rid="c26">26</xref>]&#x2014;have been observed to show sensitivity to macroscopic salt concentrations [<xref ref-type="bibr" rid="c45">45</xref>], as have DNA:antibiotic interactions [<xref ref-type="bibr" rid="c54">54</xref>]. In the realm of pharmaceutical design, where there is great interest in engineering small molecule ligands, salt effects are known to modulate the interactions of small molecules with proteins [<xref ref-type="bibr" rid="c62">62</xref>] or with supramolecular hosts [<xref ref-type="bibr" rid="c61">61</xref>].</p>
</sec>
<sec id="s1b">
<title>Current simulation practice arbitrarily fixes microscopic salt composition</title>
<p>In contrast to real physical systems, where the local region near the biomolecule is able to exchange ions with a macroscopic reservoir at a fixed salt concentration (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <italic>middle),</italic> simulations of biomolecules typically fix the <italic>number</italic> of salt molecules present in the simulation volume. There is a great deal of diversity in how the fixed number of added ions is typically determined: Along with the specified macroscopic ion concentration, simulation packages may make use of the total cell volume (e.g., Gromacs [<xref ref-type="bibr" rid="c6">6</xref>]), the total solvent volume excluding the biomolecular solutes (e.g., CHARMM-GUI [<xref ref-type="bibr" rid="c33">33</xref>]), or the number of water molecules (converting the ion concentration into mole or mass fraction, as in OpenMM [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>]). Some simulation packages choose to use only minimal neutralizing counterions or no counterions at all, relying on uniform background neutralizing charge to allow treatment of long-range electrostatics by particle mesh Ewald (PME) methods [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c30">30</xref>] (such as Schr&#x00F6;dinger&#x2019;s FEP<sup>&#x002B;</sup> alchemical free energy calculations [<xref ref-type="bibr" rid="c89">89</xref>]). In simulation volumes large enough to mimic the inclusion of a macroscopic salt reservoir far from the biomolecular system of interest, the environment near the biomolecule may be accurately represented, but long correlation times for well-ordered ions may still hinder equilibration of the ion environment [<xref ref-type="bibr" rid="c64">64</xref>, <xref ref-type="bibr" rid="c67">67</xref>, <xref ref-type="bibr" rid="c71">71</xref>].</p>
</sec>
<sec id="s1c">
<title>Simulations in the semigrand canonical ensemble can mimic real salt fluctuations</title>
<p>Simulations in the(semi)grand canonical ensemble, however, can&#x2014;at least in principle&#x2014;remedy this situation by explicitly allowing one or more components (such as ions) to fluctuate over the course of the simulation via <italic>grand canonical Monte Carlo</italic> (GCMC) moves (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <italic>right</italic>). In grand and semigrand canonical methods, simulations are placed in thermodynamic equilibrium with a theoretical reservoir of components. The simulation can exchange molecules/particles with the reservoir, and the concentration the components in the reservoir are specified by their respective chemical potentials. Before running these simulations, one first has to determine the mapping between the concentration in the reservoir and chemical potentials, a process we refer to as <italic>calibration.</italic> Sampling over ion concentrations in explicit water via straightforward GCMC is difficult: Monte Carlo insertion/deletions have to overcome long-range effects, low acceptance rates for instantaneous Monte Carlo moves, and the concentration is sensitive to small (&#x003C; <italic>k<sub>B</sub>T)</italic> variations in the chemical potential. Some efforts have circumvented these issues by using implicit solvent models [<xref ref-type="bibr" rid="c78">78</xref>, <xref ref-type="bibr" rid="c83">83</xref>], cavity-biased insertions in specialized solvent models [<xref ref-type="bibr" rid="c85">85</xref>], and explicit solvent reorganization moves [<xref ref-type="bibr" rid="c73">73</xref>]. <italic>Osmotic ensemble Monte Carlo</italic> schemes that use fractional ions and Wang-Landau approaches have also proven themselves to be useful in simulations of simple aqueous electrolytes [<xref ref-type="bibr" rid="c43">43</xref>, <xref ref-type="bibr" rid="c56">56</xref>].</p>
</sec>
<sec id="s1d">
<title>Nonequilibrium candidate Monte Carlo (NCMC) can achieve high acceptance rates</title>
<p>More recently, nonequilibrium candidate Monte Carlo (NCMC) has been shown to be an effective solution to the problem of low acceptance rates when inserting or deleting particles [<xref ref-type="bibr" rid="c58">58</xref>]. In contrast to an instantaneous Monte Carlo (MC) proposal in which an inserted particle is switched instantaneously on and may clash with other solvent or solute particles, in an NCMC proposal, the particle is switched on slowly as the system is allowed to relax via some form of dynamics. NCMC uses a modified acceptance criteria that incorporates the nonequilibrium work to ensure that the resulting endpoints sample from the equilibrium distribution. With well-tuned nonequilibrium protocols, NCMC acceptance rates can be astronomically higher than their instantaneous MC counterparts [<xref ref-type="bibr" rid="c58">58</xref>]. In work simulating biomolecules at constant-pH, for example, Roux and coworkers have demonstrated how NCMC is effective at achieving high acceptance rates for NCMC proposals that also transmute an ion to/from a water molecule to maintain net charge neutrality of the system [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c65">65</xref>].</p>
<p>While calibration of the effective chemical potential for the water and ion forcefields and simulation parameters at hand is nontrivial, this technical challenge can be satisfyingly addressed with existing technologies: Self-adjusted mixture sampling (SAMS) [<xref ref-type="bibr" rid="c82">82</xref>], a form of adaptive expanded ensemble sampling [<xref ref-type="bibr" rid="c46">46</xref>], can be used to conveniently achieve uniform sampling of all relevant salt concentrations in a single simulation, while the Bennett acceptance ratio (BAR) can optimally extract estimates of the relevant free energy differences from all NCMC proposals along with good estimates of statistical error and minimal bias [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c74">74</xref>]. Independent simulations at each salt concentration could be performed separately, with nonequilibrium switching trajectories used to estimate relative free energies between different numbers of salt pairs. How ever, SAMS helps more rapidly decorrelate the configurations of ions and, in principle, allows a single simulation to be used for calibration.</p>
</sec>
<sec id="s1e">
<title>An NCMC osmostat can be used alongside thermostats and barostats</title>
<p>Here, we present a new approach that makes use of NCMC to insert/delete salt pairs with high acceptance probability in a manner that correctly models the statistical mechanics of exchange with a macroscopic salt reservoir. The osmostat needs to be calibrated once for the specified solvent and ion models, simulation parameters, and thermodynamic conditions (temperature, pressure, pH, etc.). Following calibration, the osmostat is used in a manner similar to a Monte Carlo barostat, attempting to modify the system composition (and hence interaction potential) at regular intervals to ensure sampling from a target probability density that models a system in equilibrium with a macroscopic salt reservoir (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Similar to a Monte Carlo barostat [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c21">21</xref>], the osmostat moves can be integrated alongside molecular dynamics simulations and other Monte Carlo schemes to sample from equilibrium distributions with specified thermodynamic control parameters. This composability is a general feature of Markov chain Monte Carlo moves, which provide a useful framework for designing modular algorithms for biomolecular simulation [<xref ref-type="bibr" rid="c44">44</xref>].</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Schematic illustration of the workflow used to calibrate and implement the osmostat.</title><p><italic>(a)</italic> Self-adjusted mixture sampling (SAMS) simulations sample an entire range of salt pairs, <italic>N</italic><sub>NaCl</sub> &#x2208; [0, <italic>N</italic><sub>NaCl, max</sub>], in a sufficiently large box of water to model a saline reservoir. Nonequilibrium candidate Monte Carlo (NCMC) is used to achieve high acceptance rates during salt insertion/deletion attempts, in which an NaCl molecule is transformed into a pair of water molecules, or vice versa. <italic>(b)</italic> The Bennett acceptance ratio (BAR) estimator uses the work values from <italic>all</italic> NCMC proposals (including rejected proposals) to compute an optimal estimate the (dimensionless) relative free energy, &#x0394;<italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) &#x2261; <italic>f</italic> (<italic>N</italic><sub>NaCl</sub> &#x002B; 1) &#x2013; <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>), to add an additional NaCl salt pair to the box of saline as a function of the number of salt pairs already present, <italic>N</italic><sub>NaCl</sub>. BAR allows <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) to be estimated to a higher precision than the estimates from SAMS. <italic>(c)</italic> Once &#x0394;<italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) has been computed for the desired water/ion forcefield and simulation parameters governing the energy computation (such as long-range electrostatics treatment), the chemical potential &#x0394;<italic>&#x03BC;</italic> that produces the desired macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline1.gif"/></alternatives></inline-formula> is numerically computed using <xref ref-type="disp-formula" rid="eqn19">equation 19</xref>. <italic>(d)</italic> This same chemical potential &#x0394;<italic>&#x03BC;</italic> is subsequently used as the thermodynamic parameter governing the osmostat to simulate a biomolecular system in equilibrium with an infinitely sized saline reservoir at the specified macroscopic salt concentration.</p></caption>
<graphic xlink:href="226001_fig2.tif"/>
</fig>
</sec>
<sec id="s1f">
<title>How do salt environments vary in realistic biomolecular simulations?</title>
<p>Once we have developed and validated this tool, we use it to ask biophysical questions about the nature of salt environments around biological macromolecules: What is the average salt concentration in the simulation volume, and how does it compare to bulk? Which heuristic scheme, if any, most closely approximates the local salt concentration: macroscopic concentration times total cell volume or solvent volume, or mole fraction of water molecules? How much does the local salt concentration and ionic strength vary in &#x201C;typical&#x201D; biomolecular simulation conditions for different classes of biomolecular systems, such as proteins and nucleic acids? And can a Monte Carlo osmostat reduce correlation times for ions over that seen in standard MD simulations, such as the slow correlation times in ion environments around nucleic acids [<xref ref-type="bibr" rid="c64">64</xref>]? We consider some test systems that represent different classes of common biomolecular simulations: TIP3P [<xref ref-type="bibr" rid="c36">36</xref>] (and TIP4P-Ew [<xref ref-type="bibr" rid="c28">28</xref>]) water boxes, dihydrofolate reductase (DHFR), the <italic>apo</italic> kinase Src, and the Drew-Dickerson B-DNA dodecamer [<xref ref-type="bibr" rid="c64">64</xref>] as a typical nucleic acid.</p>
</sec>
<sec id="s1g">
<title>Outline</title>
<p>This paper is organized as follows: First, we review the theory behind (semi)grand canonical ensembles that model the fluctuations experienced by small subvolumes surrounding biomolecules. Second, we describe the algorithmic design of the osmostat used to allow salt concentrations to fluctuate dynamically. Finally, we apply the osmostat to address biophysical questions of interest and discuss the nature of salt distributions and their fluctuations.</p>
</sec>
</sec>
<sec id="s2">
<title>Theory and methodology</title>
<sec id="s2a">
<title>An NCMC osmostat for sampling ion fluctuations in the semigrand ensemble</title>
<p>An <italic>osmostat</italic> is like a thermostat or barostat but allows the number of salt pairs in the simulation box to change dynamically under the control of a conjugate thermodynamic parameter&#x2014;here, the chemical potential of salt. Salt pairs can be thought of as being exchanged with a macroscopic reservoir, with the free energy to add or remove salt to this reservoir described by the applied chemical potential. In principle, an osmostat could be implemented by including a number of noninteracting (&#x201C;ghost&#x201D;) molecules in the simulation volume, turning their interactions on and off to allow the number of active salt molecules to fluctuate dynamically; alternatively, new salt molecules could be introduced or removed dynamically using reversible-jump Monte Carlo (RJMC) methods [<xref ref-type="bibr" rid="c24">24</xref>]. In either case, solvent cavity formation to accommodate ions would almost certainly require nonequilibrium protocols that employ soft-core potentials and significant tuning of these insertion/deletion protocols to achieve high acceptance rates.</p>
<p>To simplify implementation for the ions most commonly used in biomolecular simulations (such as NaCl or KCl), we instead choose to exchange the <italic>identities</italic> of water molecules and salt ions, where our conjugate thermodynamic parameter &#x0394;<italic>&#x03BC;</italic><sub>2.H<sub>2</sub>O&#x2013;NaCL</sub> (which we will abbreviate as &#x0394;<italic>&#x03BC;</italic>) will represent the difference in chemical potential between withdrawing an NaCl molecule from the reservoir while returning two H<sub>2</sub>O molecules. Because solvent cavities are not being created or destroyed&#x2014;only modified slightly in size&#x2014;this should provide superior phase space overlap between initial and final states.</p>
<p>We denote the total number of water molecules and ions as <italic>N</italic>, and define the identities of the water molecules and ions with the vector <italic>&#x03B8;</italic> &#x003D; (<italic>&#x03B8;</italic><sub>1</sub>, <italic>&#x03B8;</italic><sub>2</sub>,&#x2026;,<italic>&#x03B8;<sub>N</sub></italic>) with <italic>&#x03B8;<sub>i</sub></italic> &#x2208; &#x007B;&#x2013;1,0, &#x002B;1&#x007D; to denote anions (<italic>&#x03B8;<sub>i</sub></italic> &#x003D; &#x2013;1), water (<italic>&#x03B8;<sub>i</sub></italic> &#x003D; 0), and cations (<italic>&#x03B8;<sub>i</sub></italic> &#x003D; &#x002B;1), respectively (with the potential to extend this to divalent ions by adding -2, &#x002B;2). This choice of labeling allows us to define the total number of Na<sup>&#x002B;</sup> ions as
<disp-formula id="eqn1">
<alternatives>
<graphic xlink:href="226001_eqn1.gif"/>
</alternatives>
</disp-formula>
the total number of Cl<sup>-</sup> ions as
<disp-formula id="eqn2">
<alternatives>
<graphic xlink:href="226001_eqn2.gif"/>
</alternatives>
</disp-formula>
and the number of water molecules as
<disp-formula id="eqn3">
<alternatives>
<graphic xlink:href="226001_eqn3.gif"/>
</alternatives>
</disp-formula>
where <italic>&#x03B4;</italic>(<italic>x, y</italic>) denotes the Kronecker delta, which is unity when <italic>x</italic> &#x003D; <italic>y</italic> and zero otherwise, and sums run from <italic>i</italic> to <italic>N</italic>. Note that the total number of waters and ions, <italic>N</italic> &#x003D; <italic>N</italic><sub>Na<sup>&#x002B;</sup></sub>(<italic>&#x03B8;</italic>) &#x002B; <italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub>(<italic>&#x03B8;</italic>) &#x002B; <italic>N</italic><sub>H<sub>2</sub>0</sub>(<italic>&#x03B8;</italic>), is fixed, and does not depend on <italic>&#x03B8;</italic>. We define the total charge number of the biomolecules, excluding counterions, as <italic>z</italic>.</p>
<p>When <italic>z</italic> &#x2260; 0, counterions will be added to ensure that the total charge of the simulation system is zero. The system can be neutralized by any of choice of <italic>&#x03B8;</italic> that satisfies <italic>n</italic>(<italic>&#x03B8;</italic>) &#x003D; &#x2013;<italic>z</italic>, where the total charge due to ions is given by
<disp-formula id="eqn4">
<alternatives>
<graphic xlink:href="226001_eqn4.gif"/>
</alternatives>
</disp-formula></p>
<p>As neutralizing the system will lead to unequal numbers of Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup>, we define the amount of salt as the number of neutral pairs,
<disp-formula id="eqn5">
<alternatives>
<graphic xlink:href="226001_eqn5.gif"/>
</alternatives>
</disp-formula></p>
<sec id="s2a1">
<title>The semigrand ensemble models salt exchange with a macroscopic salt reservoir</title>
<p>When our osmostat is combined with a scheme that samples the isothermal-isobaric (<italic>N, p, T</italic>) ensemble, we formally sample the semigrand-isothermal-isobaric ensemble (<italic>&#x0394;&#x03BC;, N, p, T</italic>). The associated equilibrium probability density is given by
<disp-formula id="eqn6">
<alternatives>
<graphic xlink:href="226001_eqn6.gif"/>
</alternatives>
</disp-formula>
where the Kronecker delta <italic>&#x03B4;(n(&#x03B8;), &#x2013;z</italic>) imposes net charge neutrality, <italic>&#x03B2;</italic> &#x2261; 1/<italic>k<sub>B</sub>T</italic> is the inverse temperature, and &#x039E;(&#x0394;<italic>&#x03BC;, N, p, T</italic>) is the normalizing constant, given by
<disp-formula id="eqn7">
<alternatives>
<graphic xlink:href="226001_eqn7.gif"/>
</alternatives>
</disp-formula>
where the outer sum is over all identity vectors and the integral is over all configuration space. For brevity, the dependence of <italic>&#x03C0;</italic> and &#x039E; on <italic>z</italic> will be omitted. It is also possible to express the probability density of the system as a function of the total number of cations and anions, rather than as function of <italic>&#x03B8;</italic>. This can be achieved by summing <italic>&#x03C0;</italic>(<italic>x, &#x03B8;</italic>; &#x0394;<italic>&#x03BC;, N, p, T</italic>) over all identity vectors that preserve the neutral charge of the system and <italic>N</italic><sub>NaCl</sub>(<italic>&#x03B8;</italic>) at some constant value <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline2.gif"/></alternatives></inline-formula>:
<disp-formula id="eqn8">
<alternatives>
<graphic xlink:href="226001_eqn8.gif"/>
</alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline3.gif"/></alternatives></inline-formula> is the potential energy for a system with fixed particle identities that contains <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline4.gif"/></alternatives></inline-formula> salt pairs. The factorial prefactors account for the degeneracy number of identity vectors <italic>&#x03B8;</italic> that satisfy the constraints <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline5.gif"/></alternatives></inline-formula>.</p>
</sec>
<sec id="s2a2">
<title>Gibbs sampling provides a modular way to sample from the semigrand ensemble</title>
<p>A Gibbs sampling framework can be used to create a modular simulation scheme in which the osmostat updates molecular identities infrequently while some MCMC scheme (such as Metropolis Monte Carlo or Metropolized molecular dynamics) updates particle positions using fixed particle identities:
<disp-formula id="eqn9">
<alternatives>
<graphic xlink:href="226001_eqn9.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn10">
<alternatives>
<graphic xlink:href="226001_eqn10.gif"/>
</alternatives>
</disp-formula></p>
<p>By embedding this approach in a Gibbs sampling framework, it allows the osmostat to readily be combined with other sampling schemes that make use of a Gibbs sampling framework such as replica exchange and expanded ensemble simulations [<xref ref-type="bibr" rid="c13">13</xref>].</p>
<p>Instead of instantaneous MC switching to propose changes in the chemical identities <italic>&#x03B8;</italic> at fixed configuration <italic>x</italic>, nonequilibrium candidate Monte Carlo (NCMC) is used to propose updates of chemical identities and positions simultaneously as sufficiently long switching trajectories can sampling efficiencies that are orders of magnitude larger than instantaneous proposals [<xref ref-type="bibr" rid="c58">58</xref>]:
<disp-formula id="eqn11">
<alternatives>
<graphic xlink:href="226001_eqn11.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn12">
<alternatives>
<graphic xlink:href="226001_eqn12.gif"/>
</alternatives>
</disp-formula></p>
<p>NCMC uses a modified Metropolis-Hastings acceptance protocol in which the appropriate <italic>total work</italic> for switching is accumulated during the nonequilibrium proposal and used in the acceptance criterion.</p>
</sec>
<sec id="s2a3">
<title>The chemical potential &#x0394;<italic>&#x03BC;</italic> must be calibrated to model macroscopic salt concentrations</title>
<p>Simulating a system that is in chemical equilibrium with an inf nitely large saline reservoir at a specified salt concentration first requires the calibration of the chemical potential &#x0394;<italic>&#x03BC;</italic>. There are multiple ways that one could compute the necessary chemical potential. For instance, one could approximate the reservoir with a sufficiently large box of water, and narrow-in on the chemical potential that produces the desired salt concentration using stochastic approximation or the density control method recommended by Speidal et al. [<xref ref-type="bibr" rid="c81">81</xref>]. However, this requires carrying out separate calibration calculations for each desired macroscopic concentration. Instead, we aim to construct a simple calibration procedure by computing the free energies to insert salt pairs into a sufficiently large box of water. We then use these free energies to analytically compute macroscopic salt concentrations over a wide range of chemical potentials, providing a relationship that can be numerically inverted. This procedure need be done only once for a specified ion and water model, though it may need to be repeated if the method used to compute long-range electrostatic interactions is modified.</p>
<p>Our approach to calibration computes the free energies to add <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;1,2,&#x2026;,<italic>N</italic><sub>NaCl, max</sub>&#x007D; salt pairs to an initially pure box of water. We limit our calculations to estimate free energies up to some maximum <italic>N</italic><sub>NaCl, max</sub> &#x226A; <italic>N</italic> for practical convenience and since very high salt concentrations are rare in biology. We define the absolute dimensionless free energy of a system with <italic>N</italic><sub>NaCl</sub> salt pairs at pressure <italic>p</italic> and temperature <italic>T</italic> as <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>, <italic>N, p, T</italic>),
<disp-formula id="eqn13">
<alternatives>
<graphic xlink:href="226001_eqn13.gif"/>
</alternatives>
</disp-formula>
where the partition function <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline6.gif"/></alternatives></inline-formula> is given by
<disp-formula id="eqn14">
<alternatives>
<graphic xlink:href="226001_eqn14.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn15">
<alternatives>
<graphic xlink:href="226001_eqn15.gif"/>
</alternatives>
</disp-formula>
where the number of water molecules <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline7.gif"/></alternatives></inline-formula>. For convenience, we define relative free energies as
<disp-formula id="eqn16">
<alternatives>
<graphic xlink:href="226001_eqn16.gif"/>
</alternatives>
</disp-formula></p>
<p>For simplicity, we shall use <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) as abbreviations to <xref ref-type="disp-formula" rid="eqn13">equations 13</xref> and <xref ref-type="disp-formula" rid="eqn16">16</xref>, respectively. The free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) can then be used to calculate the average number of salt pairs as a function of the chemical potential &#x0394;<italic>&#x03BC;</italic>,
<disp-formula id="eqn17">
<alternatives>
<graphic xlink:href="226001_eqn17.gif"/>
</alternatives>
</disp-formula>
where the semigrand partition function &#x039E;(&#x0394;<italic>&#x03BC;, N, p, T</italic>) (the same one from <xref ref-type="disp-formula" rid="eqn7">equation 7</xref>) can be compactly written as
<disp-formula id="eqn18">
<alternatives>
<graphic xlink:href="226001_eqn18.gif"/>
</alternatives>
</disp-formula></p>
<p>Knowledge of <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) will also provide a convenient estimate of the macroscopic salt concentration. We define the macroscopic salt concentration as the mean salt concentration of a system in the thermodynamic limit, and derive in <xref ref-type="app" rid="app2">Appendix 2</xref> the following expression for the macroscopic concentration that is amenable to computational analysis:
<disp-formula id="eqn19">
<alternatives>
<graphic xlink:href="226001_eqn19.gif"/>
</alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline8.gif"/></alternatives></inline-formula> is the average volume for a fixed <italic>N</italic><sub>NaCl</sub>. The macroscopic concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline9.gif"/></alternatives></inline-formula> is a monotonic function of the chemical potential &#x0394;<italic>&#x03BC;</italic>. Therefore&#x2014;provided one has estimates of <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline10.gif"/></alternatives></inline-formula>&#x2014;the value of the chemical potential &#x0394;<italic>&#x03BC;</italic>(<italic>c</italic>) that yields a desired macroscopic concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline11.gif"/></alternatives></inline-formula> can be obtained by numerically inverting <xref ref-type="disp-formula" rid="eqn19">equation 19</xref>.</p>
</sec>
<sec id="s2a4">
<title>Free energies for salt insertion can be efficiently computed using SAMS</title>
<p>One could estimate the free energies <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,1, &#x2026;,<italic>N</italic><sub>NaCl, max</sub>&#x007D; using a <italic>N</italic><sub>NaCl, max</sub> &#x2013; 1 equilibrium calculations of the relative free energies &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) or the recently developed grand canonical integration technique [<xref ref-type="bibr" rid="c68">68</xref>, <xref ref-type="bibr" rid="c69">69</xref>]. As the latter requires <italic>a priori</italic> knowledge of the approximate scaling of the chemical potential with the concentration, we instead opt to use the recently proposed self-adjusted mixture sampling (SAMS) [<xref ref-type="bibr" rid="c82">82</xref>] method to facilitate the calculation of the free energies from a single simulation. SAMS is a development on the method of expanded ensembles [<xref ref-type="bibr" rid="c46">46</xref>] (sometimes known as serial tempering [<xref ref-type="bibr" rid="c49">49</xref>]) and generalized Wang-Landau algorithms [<xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c88">88</xref>] that is both asymptotically consistent (in that it produces unbiased estimates, unlike Wang-Landau) and asymptotically optimal (in that it achieves these estimates in the fastest manner possible) [<xref ref-type="bibr" rid="c82">82</xref>]. It can be used to sample over a discrete state space and simultaneously estimate the relative log-normalizing constant for each state. For our calibration simulations, the discrete states correspond to the number of salt pairs in the systems <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,1,&#x2026;, <italic>N</italic><sub>NaCl, max</sub>&#x007D; and the log-normalizing constant are the desired free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>). By dynamically altering a series of biasing potentials, one for each state, the SAMS algorithm asymptotically samples the discrete states according to user specif ed target weights [<xref ref-type="bibr" rid="c82">82</xref>]. When the target weights are uniform over the state space&#x2014;as we choose herein to ensure the uncertainties in the estimated free energies are approximately equal&#x2014;the biasing potentials are themselves estimates of the free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>). Thus, SAMS can, in principle, calculate all <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) in a single simulation more efficiently and conveniently than numerous independent equilibrium free energy calculations.</p>
<p>As we describe below, our osmostat employs NCMC, which allows us to calculate the salt-insertion free energies by processing the all the NCMC protocol work values in the SAMS simulations with BAR, even from the attempts that are rejected. BAR requires samples of forward and reverse work samples of salt insertion and deletion attempts to compute &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and its statistical uncertainty for <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,1,&#x2026;,<italic>N</italic><sub>NaCl, max</sub>&#x007D; [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c74">74</xref>]. These relative free energies can then be summed to estimate <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and corresponding statistical uncertainties. Our calibration simulations therefore exploit the sampling efficiency of SAMS and the estimation efficiency of BAR.</p>
<p>In general, the chemical potential &#x0394;<italic>&#x03BC;</italic> will need to be recalibrated if the practitioner changes temperature, pressure, water or ion forcefeld models, nonbonded treatment, or anything that will affect <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) or <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline12.gif"/></alternatives></inline-formula>. A sufficiently large water box must be used when calculating <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) to reach a regime in which <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) is insensitive to changes in simulation size; as we will show, our calibration simulations achieve this size insensitivity even for modest water boxes of a few thousand molecules.</p>
</sec>
<sec id="s2a5">
<title>The osmostat maintains electrostatic neutrality</title>
<p>To use PME [<xref ref-type="bibr" rid="c16">16</xref>], a popular choice for accurate long-range electrostatics, charge neutrality of the entire system needs to be maintained to avoid the artifacts induced by application of a uniform background neutralizing charge [<xref ref-type="bibr" rid="c30">30</xref>]. Even if an alternative long-range electrostatics treatment is employed (e.g. reaction f eld electrostatics or other non-Ewald methods [<xref ref-type="bibr" rid="c22">22</xref>]), there is, in general, approximate equality between the total number of negative charges and positive charges in biological microenvironments as they approach macroscopic lengthscales (see <xref ref-type="fig" rid="fig1">Figure 1</xref> <italic>left</italic>). From a purely theoretical perspective, the existence of a thermodynamic limit a system with a net charge depends on the particular details of the system [<xref ref-type="bibr" rid="c42">42</xref>]. For these reasons, we ensure that our proposals always maintain charge neutrality by inserting or deleting a neutral Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> pair.</p>
<p>We insert and delete a salt pair by converting Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> ions to two water molecules (see <xref ref-type="fig" rid="fig3">Figure 3</xref>). These moves convert the nonbonded forcefeld parameters (partial changes <italic>q</italic>, Lennard-Jones radii <italic>&#x03C3;</italic>, and Lennard-Jones potential well-depths <italic>&#x03F5;</italic>) of the water and ion parameters. The Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> ions have the same topology as the water molecules, with the nonbonded ion parameters located on the water oxygen atom. The mass of the ions is set as the same as water, which has no impact on the equilibrium configuration probability density, though it may distrupt the kinetics (which are not of interest here).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Schematic illustration of the nonequilibrium candidate Monte Carlo (NCMC) alchemical protocol used to insert NaCl.</title><p>Two water molecules are chosen at random for transformation into Na<sup>&#x002B;</sup> (blue sphere) and Cl<sup>&#x2212;</sup> (orange sphere). Over a number of NCMC steps, the nonbonded parameters of each atom in the water molecules, namely the partial charges, <italic>q</italic>, Lennard-Jones energy well depths, <italic>&#x03F5;</italic>, and Lennard-Jones separation parameters, <italic>&#x03C3;</italic>, are transformed into the nonbonded parameters of the ions along a linear interpolation of the parameters. The entire NCMC proposal is then accepted or rejected according to the probability given in <xref ref-type="disp-formula" rid="eqn51">equation 51</xref>. Note that osmostat NCMC moves are mixed with standard Langevin integration at a fixed timestep to obtain fully ergodic sampling. A full description of the Monte Carlo and NCMC procedure used here is provided in <xref ref-type="app" rid="app3">Appendix 3</xref>.</p></caption>
<graphic xlink:href="226001_fig3.tif"/>
</fig>
</sec>
<sec id="s2a6">
<title>Nonequilibrium candidate Monte Carlo is used to enhance sampling efficiency</title>
<p>A benefit of exchanging ion and water nonbonded forcefield parameters is that this procedure avoids the need to create new cavities in solvent, a difficulty that significantly complicates particle creation and destruction techniques. Nevertheless, instantaneous Monte Carlo attempts to interconvert salt and water will be overwhelmingly rejected as it is highly unlikely that the dipoles of the molecules that surround a transmuted ion&#x2014;usually solvent&#x2014;will be orientated in a manner that favorably solvates the new charge. This effect is compounded by the long-range nature of Coulombic interactions. The acceptance probability for salt insertion and deletion would improve drastically if the dipoles and locations of the solvent could be redistributed during an MCMC attempt. Previously, Shelly and Patey developed a configuration bias Monte Carlo technique for the insertion and deletion of ions in grand canonical Monte Carlo [<xref ref-type="bibr" rid="c73">73</xref>]. Their method reorients dipoles in a shell surrounding the inserted or deleted ion, which improved the sampling efficiency by over two orders of magnitude [<xref ref-type="bibr" rid="c73">73</xref>].</p>
<p>Here, we use nonequilibrium candidate Monte Carlo (NCMC) [<xref ref-type="bibr" rid="c58">58</xref>], a technique that is closely related to sequential Monte Carlo and annealed importance sampling [<xref ref-type="bibr" rid="c38">38</xref>, <xref ref-type="bibr" rid="c57">57</xref>], to automatically relax systems around inserted or deleted ions, thereby boosting acceptance rates and sampling efficiencies to values far higher than reported elsewhere.</p>
<p>In NCMC, a Monte Carlo attempt is divided into a nonequilibrium protocol that drives the system through many intermediate states. Candidate configurations are generated by driving a chosen set of variables (thermodynamic or configurational) through these intermediate states whilst allowing unperturbed degrees of freedom to relax via dynamical propagation in response to the driving protocol. The total amount of work that is accumulated between interleaved steps of perturbation (of the variables of interest) and propagation (of the unperturbed degrees of freedom) is used to accept or reject the candidate configuration. Good NCMC acceptance rates can be achieved for a reasonable choice of nonequilibrium protocol;often, a parametric protocol is specified and the total protocol length (or <italic>NCMC switching time)</italic> is tuned to be long enough to ensure a system is sufficiently relaxed with respect to the completed perturbation but short enough to be efficient.</p>
<p>In our NCMC osmostat, the nonbonded parameters of the ions and water molecules being exchanged are linearly interpolated into a series of equally spaced alchemical states. Each perturbation step along the alchemical path was followed by a fixed number of time-steps of Langevin dynamics where the configurations of the whole system were integrated (see <xref ref-type="fig" rid="fig3">Figure 3</xref>). A full description of our Monte Carlo and NCMC procedure is provided in <xref ref-type="app" rid="app3">Appendix 3</xref>. Here, NCMC propagator uses the same Langevin integrator as used in equilibrium sampling to ensure there was no significant mismatch between the sampled densities. Our particular choice of Langevin integrator (described below) was used to avoid the long correlation times that results from fully metropolized molecular dynamics integrators and to mitigate the configuration sampling bias that is incurred by unmetropolized finite time-step integrators.</p>
</sec>
<sec id="s2a7">
<title>We use an integrator that minimizes configuration sampling bias</title>
<p>Care must be taken to ensure that the total work is properly accumulated in NCMC, as incorrect accumulation of work or the use of alternative definitions will lead to erroneous computation of the acceptance probability and simulation results. For time reversible MCMC integrators, such as with generalized Hamiltonian Monte Carlo (GHMC), the total work is the <italic>protocol work</italic>: the sum of the instantaneous potential energy changes that result from each perturbation during the driving process [<xref ref-type="bibr" rid="c75">75</xref>]. If the system is relaxed in-between perturbations using propagators that do not leave the target distribution invariant, such as unmetropolized Langevin integrators, NCMC can drive systems to undesirable nonequilibrium steady states, whose statistics may differ from equilibrium. On top of the work that is already performed by the driving protocol, propagators that do not satisfy microscopic reversibility can also be considered to perform work on a system [<xref ref-type="bibr" rid="c75">75</xref>]. This work, known as the <italic>shadow work</italic>, must either be minimized or eliminated (i.e., via Metropolizing the dynamics) for NCMC to sample very close to, or exactly, from the target probability density.</p>
<p>The issue of shadow work accumulation is not limited to propagators in NCMC. Indeed, all finite time-step molecular dynamics integrators incur a discretization error that results in biased sampling when used without Metropolization. While configuration sampling errors do not occur with GHMC, the correct acceptance criterion requires that the momenta of all particles are reversed upon rejection (or acceptance) of a proposal. The reversal of momenta results in a simulation &#x2018;retracing its steps&#x2019;, thereby signif cantly increasing correlation times and decreasing sampling efficiencies. Hamiltonian Monte Carlo sampling can suffer from even longer correlation times, as momenta are randomized for each trial, irrespective of whether the previous move was accepted or not. This problem can be mitigated by using GHMC reduced momentum flipping schemes that still rigorously sample from the target distribution [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c77">77</xref>, <xref ref-type="bibr" rid="c86">86</xref>]. Correlation times are minimized by GHMC schemes that do not reverse momenta at all, although this incurs sampling bias [<xref ref-type="bibr" rid="c20">20</xref>].</p>
<p>Recently, Leimkuhler and Matthews have proposed an unmetropolized Langevin dynamics technique that incurs minimal configuration sampling bias [<xref ref-type="bibr" rid="c40">40</xref>]. The minimal error is achieved using a particular numerical scheme to update the positions and momenta at each time-step. Denoting half time-step velocity updates as V, half time-step position updates as R, and the addition of an Ornstein-Uhlenbeck process as O (the Brownian motion &#x201C;kick&#x201D;), the symmetry in the VRORV splitting scheme leads to a particularly favorable cancellation of configuration sampling error. Leimkuhler and Matthews also found that than VRORV exhibited the lowest error on configuration dependent quantities, such as the potential energy, in biomolecular simulations compared to other symmetric splittings. As Langevin dynamics with VRORV splitting samples very closely to the true configuration Hamiltonian, we expect its neglect within NCMC moves designed to sample configurational properties to induce very little error in sampled configurational densities. For this reason, we used the protocol work to accept or reject proposals from NCMC in our osmostat.</p>
</sec>
</sec>
<sec id="s2b">
<title>Salt concentration and ionic strength</title>
<sec id="s2b1">
<title>Ionic strength influences the effective salt concentration</title>
<p>We are interested in quantifying the variation of the instantaneous salt concentration c in our osmostated biomolecular simulations, where
<disp-formula id="eqn20">
<alternatives>
<graphic xlink:href="226001_eqn20.gif"/>
</alternatives>
</disp-formula></p>
<p>Although the salt concentration of the saline reservoir, i.e. the macroscopic concentration, is known precisely and controlled by the user, the presence of a biomolecule in a simulation, along with any neutralizing counterions, may lead to significant differences in the mean salt concentration in the simulation volume from the macroscopic salt concentration. In contrast, the mean salt concentration in an initially pure box of water should match the macroscopic salt concentration of the reservoir if the chemical potential used in the osmostat is accurately calibrated.</p>
<p>The Debye-H&#x00FC;ckel theory of electrolytes provided an early, analytical treatment of dilute ionic solutions using continuum electrostatics. In Debye-H&#x00FC;ckel theory, the ionic strength <italic>I</italic> of a system, which for our simulations is
<disp-formula id="eqn21">
<alternatives>
<graphic xlink:href="226001_eqn21.gif"/>
</alternatives>
</disp-formula>
is used to predict how the effective concentrations, or activities, of ions are affected by the presence of electrolytes in the solution. The key insight of Debye-H&#x00FC;ckel theory is that&#x2014;because of electrostatic screening&#x2014;the ionic strength tempers the activity of ions, such that increasing the ionic strength of a solution lowers the effective concentration of electrolytes. Although Debye-H&#x00FC;ckel theory is too simplistic to be used to accurately predict the salt concentration in biomolecular simulations, the ionic strength may still provide insight into the salt concentrations that we will observe in our osmostated simulations. Thus, we will investigate the variation of the ionic strength as well as the salt concentration. As a large charge number of the biomolecule <italic>z</italic> will dominate <italic>I</italic> for small simulation volumes, we will also consider the variation of ionic strength of the solvent only, i.e., by neglecting <italic>z</italic><sup>2</sup> in <xref ref-type="disp-formula" rid="eqn21">equation 21</xref>.</p>
</sec>
<sec id="s2b2">
<title>Simulation packages add different amounts of salt</title>
<p>There is diversity in the way that current practitioners of all-atom biomolecular simulations add salt (<italic>salinate)</italic> to systems during the preparation stages of simulations. While it is common that only neutralizing counterions are added, a number of workflows elect not to add counterions at all [<xref ref-type="bibr" rid="c89">89</xref>]. Salt pairs may be added, or not added at all, and when they are added, simulation packages use differing definitions of salt concentration, such that each package can add different numbers of salt pairs to the same system even if the desired salt concentration is the same. All packages ignore the presence of neutralizing counterions when adding salt. In this study, we are concerned with quantifying the accuracy of some of the most popular salination techniques.</p>
<p>Given a target salt concentration of <italic>c<sub>t</sub></italic>, a popular method to add salt&#x2014;exemplified by the Gromacs package [<xref ref-type="bibr" rid="c6">6</xref>]&#x2014;uses the initial volume of the system <italic>V</italic>(<italic>x</italic><sub>0</sub>) to count the required number of pairs. We determine the number of salt pairs that would be added by this strategy as
<disp-formula id="eqn22">
<alternatives>
<graphic xlink:href="226001_eqn22.gif"/>
</alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline13.gif"/></alternatives></inline-formula> denotes the floored value of <italic>y</italic>. We are interested in assessing the accuracy of the corresponding concentration of salt <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline14.gif"/></alternatives></inline-formula>. Preparation tools such as CHARMM-GUI [<xref ref-type="bibr" rid="c33">33</xref>] add salt based on the initial volume of the <italic>solvent V</italic>(<italic>x</italic><sub>0H<sub>2</sub>O</sub>), which we reproduce with
<disp-formula id="eqn23">
<alternatives>
<graphic xlink:href="226001_eqn23.gif"/>
</alternatives>
</disp-formula>
to estimate the corresponding concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline15.gif"/></alternatives></inline-formula> that would occur for all later configurations. Estimates that use strategies similar to <xref ref-type="disp-formula" rid="eqn22">equations 22</xref> and <xref ref-type="disp-formula" rid="eqn23">23</xref> are sensitive to initial volume of the system; if salt is added before the volume is sufficiently equilibrated, the salt concentration during the simulation can deviate signif cantly from the target concentration. In contrast, packages such as OpenMM [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>], use the <italic>ratio</italic> of salt pairs to water molecules in bulk solvent to add
<disp-formula id="eqn24">
<alternatives>
<graphic xlink:href="226001_eqn24.gif"/>
</alternatives>
</disp-formula>
salt pairs, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline16.gif"/></alternatives></inline-formula> is concentration of bulk water, for which 55.4 M is used by OpenMM. The corresponding salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline17.gif"/></alternatives></inline-formula>, as well as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline18.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline19.gif"/></alternatives></inline-formula> will be compared to the concentration of salt that results from the application of our osmostat to help inform future simulation strategies.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Simulation details</title>
<sec id="s3a">
<title>Systems considered in the study</title>
<p>The primary aims of this study are to quantify and understand how the concentration of salt and ionic strength vary around typical biomolecules, to assess the accuracy of methods that insert salt in typical simulation strategies, and to ascertain whether an NCMC osmostat can decorrelate biomolecule:ion interactions faster than fixed-salt dynamics. To meet these aims, we considered four biological systems that are representative of those that are commonly simulated with molecular dynamics: pure water, dihydrofolate reductase (DHFR), the <italic>apo</italic> kinase Src, and the Drew-Dickerson B-DNA dodecamer palindromic sequence. All systems were taken from the OpenMMTools [0.11.1] set of test systems [<xref ref-type="bibr" rid="c4">4</xref>], such that each system has a different provenance.</p>
<p>Dihydrofolate reductase (DHFR) is a small, globular enzyme that has frequently been used as a model system in molecular simulations. The DHFR system used here was originally prepared for the joint Amber-CHARMM (JAC) benchmark, the the current version of this system was obtained from the Amber 14 benchmark archive [<xref ref-type="bibr" rid="c3">3</xref>].</p>
<p>The tyrosine kinase Src, a member of the non-receptor tyrosine kinase family, was selected for this study as an example of a prototypical drug target. The <italic>apo</italic> Src structure was taken from the OpenMMtools testsystems data set and resolvated with TIP3P in a cubic box that was at least 10 &#x00C5; away from the protein. As part of the preparation, the energy of system was minimized and subsequently relaxed using 3 ps of Langevin dynamics to remove any bad contacts. Further equilibration was performed as detailed below. The original system was not suitable for simulation with the osmostat as fixed neutralizing counterions were present in the system. The OpenMMtools structure was downloaded from the Protein Data Bank, identification code 1YI6, and prepared using PDBFixer [<xref ref-type="bibr" rid="c1">1</xref>] and protonated at pH 7. The small molecule in the binding site was also removed during the preparation. The Amber 14SB forcefeld from the AmberTools 16 package was used for the simulations [<xref ref-type="bibr" rid="c47">47</xref>].</p>
<p>The Drew-Dickerson dodecamer (CGCGAATTGCGC) is a classic model DNA system. The B-DNA structure of the Drew-Dickerson dodecamer was downloaded from the Protein Data Bank (identification code 4C64). The structure was stripped of ions and solvated in a box of TIP3P water to ensure at least 9 &#x00C5; of clearance around the DNA. To test the effect of the amount of solvent on the distribution of salt and ions, the structure was also solvated in a box of TIP3P water that had a clearance of at least 16 &#x00C5; around the DNA. As with the <italic>apo</italic> kinase Src, the system was energy minimized and subsequently relaxed using 3 ps of Langevin dynamics. As described below, further equilibration was also performed. The Amber OL15 forcefeld from the AmberTools 16 package was used for the DNA [<xref ref-type="bibr" rid="c91">91</xref>].</p>
</sec>
<sec id="s3b">
<title>General simulation details</title>
<p>Simulations were performed with OpenMM [7.1.0] [<xref ref-type="bibr" rid="c18">18</xref>]. The osmostat was implemented within the open-source package SaltSwap [0.52] that was written for the purpose of this publication. Simulations utilized either TIP3P [<xref ref-type="bibr" rid="c36">36</xref>] or TIP4P-Ew [<xref ref-type="bibr" rid="c28">28</xref>] water models, and Joung and Cheatham parameters were used for Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> ions [<xref ref-type="bibr" rid="c37">37</xref>]. Unless otherwise stated, the amount of salt in a simulation was initialized by salinating the system according to <xref ref-type="disp-formula" rid="eqn24">equation 24</xref> with the macroscopic concentration as the target concentration <italic>c<sub>t</sub>.</italic></p>
<p>For all simulations, long-range electrostatic interactions were treated with particle mesh Ewald (PME), with both direct-space PME and Lennard-Jones potentials making use of a 10 &#x00C5; cutoff; the Lennard-Jones potential was switched to zero at the cutoff over a switch width of 1.5 &#x00C5; to ensure continuity of potential and forces. PME used a relative error tolerance of 10<sup>&#x2212;4</sup> at the cutoff to automatically select the <italic>a</italic> smoothing parameter, and the default algorithm in OpenMM was used to select Fourier grid spacing. All bonds to hydrogen were constrained, and OpenMM&#x2019;s long-range analytical dispersion correction was used to avoid pressure artifacts from truncation of the Lennard-Jones potential. Simulations were run at 300 K with a Monte Carlo barostatwith 1 atm external pressure and Monte Carlo update interval of 25 steps. Equilibrium and NCMC dynamics were propagated using high-quality Langevin integrators taken from the OpenMMTools [0.11.1] package, with a 2 fs timestep and collision rate of 1 ps<sup>&#x2212;1</sup>. In addition to the dynamics used to prepare the systems, every simulation was briefly thermalized using 4 ps of dynamics, and before statistical estimates were computed, equilibration times were estimated using the automatic procedure in the pymbar timeseries module detailed in [<xref ref-type="bibr" rid="c12">12</xref>]. As described above, positions and velocities were updated using the VRORV splitting scheme (also known as BAOAB) to mitigate the configuration space error in equilibrium sampling and NCMC proposals that result from unmetropolized Langevin dynamics [<xref ref-type="bibr" rid="c40">40</xref>] The insertion or deletion of salt was attempted every 4 ps using the procedure described in <xref ref-type="app" rid="app3">Appendix 3</xref>. With the exception of the simulatons where the NCMC protocol was optimized, the NCMC protocol was 20 ps long, and consisted of 1000 perturbation steps, where each perturbation followed by 10 steps of Langevin integration. The NCMC protocol length is not accounted for in the reported lengths of the simulations.</p>
<p>The simulations were analyzed with open source scripts that used a combination of numpy 1.13.1 [<xref ref-type="bibr" rid="c87">87</xref>], scipy 0.19.1 [<xref ref-type="bibr" rid="c34">34</xref>], pymbar 3.0.1 [<xref ref-type="bibr" rid="c2">2</xref>], MDTraj 1.8.0 [<xref ref-type="bibr" rid="c50">50</xref>], VMD 1.9.4 [<xref ref-type="bibr" rid="c31">31</xref>] (see <italic>Code and data availability);</italic> the <monospace>saltswap</monospace> conda package provided automatically installs the dependencies needed to run the simulation scripts. Plots and figures were produced using Matplotlib 2.0.2 [<xref ref-type="bibr" rid="c32">32</xref>] and Inkscape 0.91.</p>
</sec>
<sec id="s3c">
<title>Calibration of the chemical potential</title>
<p>The chemical potential was calibrated in cubic boxes of TIP3P water and TIP4P-Ew water. Both boxes initially had edge lengths of 30 &#x00C5; with water molecules at roughly the same density as bulk water; the box of TIP3P water contained 887 molecules and the box of TIP4P-Ew water contained 886 molecules. Ten 80 ns SAMS simulations were performed on each box, and were targeted to sample uniformly over salt pairs <italic>N</italic><sub>NaCl</sub>(<italic>&#x03B8;</italic>) &#x2208; &#x007B;0,1,&#x2026;, 20&#x007D;. Half of the simulations were initialized with 0 salt pairs, whereas the other half were initialized with 20 salt pairs. The maximum number of salt pairs <italic>N</italic><sub>NaCl, max</sub> was chosen to be 20 in these calibration simulations because the corresponding salt concentration (roughly 1.2 M) is beyond the concentrations in biological microenvironments that are typically considered. The volumes of the boxes at each salt occupancy were recorded during the SAMS simulations in order to estimate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline20.gif"/></alternatives></inline-formula> (henceforth abbreviated as &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub>). The SAMS simulation procedure automatically provides on-line estimates of the free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>), which, along &#x2329;<italic>V</italic>&#x2329;<sub>N<sub>NaCl</sub></sub>, are required to calibrate the chemical potential. The protocol work from all of the NCMC insertion and deletion attempts were post-processed with BAR (using the pymbar package [<xref ref-type="bibr" rid="c2">2</xref>]) to provided additional estimates of <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) along with statistical uncertainties.</p>
<p>To assess whether <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> had been accurately calculated, larger boxes of TIP3P and TIP4P-Ew water were simulated for 32 ns at a range of chemical potentials &#x0394;<italic>&#x03BC;</italic>. The mean salt concentrations from the simulations were compared to concentrations predicted using <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> with the estimated values for <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub>. The boxes of these validation simulations were initially 50 &#x00C5; in length, and contained 4085 TIP3P and 4066 TIP4P-Ew water molecules. These simulations were initialized without any salt present in the systems.</p>
</sec>
<sec id="s3d">
<title>Optimization of the NCMC protocol</title>
<p>We consider only two parameters in optimizing the nonequilibrium protocol used in NCMC proposals: the total number of times the potential is perturbed, <italic>T</italic>, and the number of Langevin steps that occur before and after each perturbation, <italic>K</italic>. Generally, we expect the acceptance probability to increase as the overall perturbation is broken into smaller pieces&#x2014;as <italic>T</italic> increases. Increasing the number of propagation steps following each perturbation, <italic>K</italic>, also improves the acceptance probability in a manner that is dependent on the computational efficiency details of the simulation code. To quantify the trade-off between acceptance probability and compute time, we define the NCMC efficiency <italic>E</italic>(<italic>T, K</italic>) as
<disp-formula id="eqn25">
<alternatives>
<graphic xlink:href="226001_eqn25.gif"/>
</alternatives>
</disp-formula>
where &#x2329;<italic>A</italic>&#x232A;(<italic>T,K</italic>) is the average acceptance probability and <italic>C</italic>(<italic>T,K</italic>) is the average computer time per insertion/deletion attempt. All simulations were performed and timed on single Nvidia GTX-1080 GPUs. The total protocol length of an NCMC attempt is equal to <italic>T</italic> &#x00D7; <italic>K</italic> multiplied by the Langevin integration timestep, which is 2 fs in this case.</p>
<p>Simulations using various NCMC protocols lengths were performed on cubic boxes of TIP3P and TIP4P-Ew that had initial edge lengths of 30 &#x00C5;. The simulations sampled configurations for a total of 32 ns (excluding the NCMC sampling) and had NCMC protocol lengths up to 40 ps for different combinations of total perturbation steps <italic>T</italic> and propagation steps <italic>K</italic>. The efficiency of each protocol <italic>E</italic> was estimated relative the efficiency of instantaneous insertion and deletion. Shelly and Patey also used the ratio of the average acceptance probability to the compute time to estimate the efficiency of their configuration bias ion insertion scheme relative to instantaneous insertions [<xref ref-type="bibr" rid="c73">73</xref>]. In this work, no effort was made to optimize the alchemical path.</p>
</sec>
<sec id="s3e">
<title>Quantifying the scaling behavior of the osmostat</title>
<p>To investigate the sampling efficiency of our osmostat under physiological conditions, DHFR was simulated with macroscopic concentrations of 100 mM, 150 mM, and 200 mM. Each simulation was 30 ns long and there were three repeats per macroscopic concentration. The timeseries module in pymbar [<xref ref-type="bibr" rid="c2">2</xref>] was used to estimate the autocorrelation function of salt concentration as well as the integrated autocorrelation time for each macroscopic salt concentration.</p>
<p>It is important to establish how the distributions of salt concentration and salt numbers scale with the number of water molecules in the system and the macroscopic concentration. To this end, we simulated different sizes of water boxes with macroscopic concentrations of 100 mM, 150 mM, and 200 mM. Each simulation was repeated three times.</p>
</sec>
<sec id="s3f">
<title>Estimating the efficiency of ion configuration sampling with NCMC</title>
<p>Ponomarev et al. previously used the Drew-Dickerson DNA palindromic sequence to quantify the rate of convergence of spatial ion distributions in DNA simulations [<xref ref-type="bibr" rid="c64">64</xref>]. We sought to reproduce the analysis of Ponomarev et al. for our NCMC osmostat and fixed salt simulations to test whether or not osmostatic simulations can accelerate the configuration sampling of ions. Three osmostated simulations and three fixed-salt simulations of the Drew-Dickerson dodecamer were performed for 60 ns with a macroscopic salt concentration of 200 mM. The fixed salt simulations used the same ion topologies and masses as those used by the osmostat, are were added to the system using the scheme summarized by <xref ref-type="disp-formula" rid="eqn24">equation 24</xref>. The autocorrelation of ion:phosphate interaction occupancies was also estimated from the osmostated and fixed-salt simulations using the open-source analysis scripts that accompany this manuscript.</p>
</sec>
<sec id="s3g">
<title>Quantifying the salt concentration around biomolecules</title>
<p>Three 30 ns simulations of <italic>apo</italic> Src kinase were performed with a macroscopic concentration of 200 mM. These simulations, as well as those of TIP3P water, DHFR, and the DNA dodecamer described above, were used to analyze the distributions of salt concentration (<xref ref-type="disp-formula" rid="eqn20">equation 20</xref>), ionic strength (<xref ref-type="disp-formula" rid="eqn21">equation 21</xref>), and the concentrations of salt that would occur for the heuristic salination schemes described in <xref ref-type="disp-formula" rid="eqn22">equations 22</xref>, <xref ref-type="disp-formula" rid="eqn23">23</xref>, and <xref ref-type="disp-formula" rid="eqn24">24</xref>.</p>
<p>To further understand the scaling behavior of the distributions of salt concentration with system size, and to assess the extent of finite size effects on the ion spatial distributions around DNA, additional simulations were performed on DNA. The Drew-Dickerson DNA dodecamer was resolvated in a box of TIP3P water that was at least 16 &#x00C5; away from the molecule. Three repeats of 45 ns long osmostated and fixed-salt simulations were performed, and the salt concentration distribution was measured, as were the Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> spatial distributions around the DNA.</p>
</sec>
</sec>
<sec id="s4">
<title>Results</title>
<sec id="s4a">
<title>SAMS simulations and BAR estimates accurately capture salt insertion free energies</title>
<p>In order to estimate the chemical potential &#x0394;<italic>&#x03BC;</italic> corresponding to a desired macroscopic salt concentration, we must have precise estimates of both free energies to insert salt into a box of water containing <italic>N</italic><sub>NaCl</sub> salt molecules, <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>), and the average saline box volume as a function of <italic>N</italic><sub>NaCl</sub>, &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NACL</sub></sub>, for <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,1,&#x2026;, <italic>N</italic><sub>NaCl, max</sub>&#x007D;. <xref ref-type="fig" rid="fig4">Figure 4</xref> (upper left) depicts the computed relative free energy difference for inserting an additional salt pair into a box of water molecules already containing <italic>N</italic><sub>NaCl</sub> salt molecules for both TIP3P and TIP4P-Ew for <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,&#x2026;, 19&#x007D;. The relative free energies were estimated with BAR using all nonequilibrium work values for salt pair insertion/deletion NCMC proposals, irrespective of whether the proposal attempt was accepted or not, from ten SAMS simulation. Although SAMS also provides <italic>online</italic> estimates for <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) over this same range [<xref ref-type="bibr" rid="c82">82</xref>], these online estimates were found to have significantly higher variance than the BAR estimates (see <xref ref-type="fig" rid="figS1">Figure A5.1</xref>), so we make use of BAR-derived estimates of <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) derived from SAMS simulations throughout.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Calibration of chemical potential &#x0394;<italic>&#x03BC;</italic> for two different water models (TIP3P and TIP4P-Ew) and NCMC protocol optimization.</title><p><italic>Top left, main:</italic> The relative free energy &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) to insert an Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> salt pair and remove two water molecules in boxes of TIP3P and TIP4P-Ew water as a function of the number of salt pairs <italic>N</italic><sub>NaCl</sub> already present in the box (see <xref ref-type="disp-formula" rid="eqn16">equation 16</xref>).Top <italic>left, inset:</italic> The average volume &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> of the saline box as a function of <italic>N</italic><sub>NaCl</sub>. The TIP3P box contained a total of 887 molecules (including water and ions) and the TIP4P-Ew box contained 886 molecules. The relative free energies and 95&#x0025; confidence intervals have been calculated using BAR and are smaller than the circular markers. <italic>Top right:</italic> Predicted relationship between the macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline29.gif"/></alternatives></inline-formula> and chemical potential difference &#x0394;<italic>&#x03BC;</italic> estimated with <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> for TIP3P and TIP4P-Ew (dark lines) compared to the average concentrations &#x2329;<italic>c</italic>&#x232A; estimated from equilibrium osmostat simulations of boxes of water at specified chemical potentials (circles). There were 4085 and 4066 molecules in the boxes of TIP3P and TIP4P-Ew water, respectively. Bootstrapping of BAR uncertainty estimates of <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and bootstrap uncertainties of &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> were used to calculate 95&#x0025; confidence intervals for the mean concentration curves&#x2014;these fall inside the thick lines. Error bars on the average simulation concentrations show 95&#x0025; confidence intervals, and have been estimated using bootstrap sampling of statistically independent subsamples of the simulation concentrations. Independent samples were extracted using the timeseries module of pymbar [<xref ref-type="bibr" rid="c2">2</xref>]. <italic>Bottom left:</italic> Average acceptance probability for salt insertion and deletion as a function of the NCMC protocol length. Simulations were run with a 200 mM osmostat in boxes of TIP3P (887 molecules) and TIP4P-Ew (886 molecules). The mean instantaneous MC acceptance probabilities for TIP3P and TIP4P-Ew are very small: 3.0 &#x00D7; 10<sup>&#x2212;51</sup> [5.0 &#x00D7; 10<sup>&#x2212;66</sup>, 9.0 &#x00D7; 10<sup>&#x2212;51</sup>] and 1.0 &#x00D7; 10<sup>&#x2212;46</sup> [3.0 &#x00D7; 10<sup>&#x2212;64</sup>, 4.0 &#x00D7; 10<sup>&#x2212;46</sup>] respectively, (with 95&#x0025; confidence intervals denoted in brackets). <italic>Bottom right:</italic> The efficiency (defined by <xref ref-type="disp-formula" rid="eqn25">equation 25</xref>) of the NCMC protocols relative to instantaneous insertion and deletion attempts in TIP3P for a 200 mM osmostat; all protocols are at least 10<sup>45</sup> times more efficient than instantaneous insertion and deletion. NCMC protocols of about 20 ps for TIP3P are optimal for our nonequilibrium procedure, though longer protocols are required to achieve similar efficiencies for TIP4P-Ew.</p></caption>
<graphic xlink:href="226001_fig4.tif"/>
</fig>
<p>The free energy to insert one NaCl pair in a box of TIP3P and TIP4P-Ew are broadly in agreement with previous computational estimates and experimental measurements. As implied by <xref ref-type="disp-formula" rid="eqn16">equation 16</xref>, the free energy to insert the first salt pair, &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub> &#x003D; 0), can be expressed as the difference in hydration free energy between NaCl and two water molecules. Assuming the hydration free energy of TIP3P and TIP4P-Ew water to be -6.3 kcal/mol [<xref ref-type="bibr" rid="c35">35</xref>], we estimate the hydration free energy of NaCl to be -171.73 &#x00B1; 0.04 kcal/mol and -170.60 &#x00B1;0.04 kcal/mol in TIP3P and TIP4P-Ew water, respectively. Using a different treatment of long-rang electrostatics but same ion parameters as this study, Joung and Cheatham calculated the individual hydration free energies of Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> in TIP3P and TIP4P-Ew, which can be summed to approximate the hydration free energy of NaCl [<xref ref-type="bibr" rid="c37">37</xref>]. These hydration free energies (-178.3 kcal/mol in TIP3P -177.7 kcal/mol in TIP4P-Ew) are within 5&#x0025; of our estimates. For comparison, estimates of standard NaCl hydration free energies based on experimental data are -170.4 kcal/mol [<xref ref-type="bibr" rid="c48">48</xref>], -171.8 kcal/mol [<xref ref-type="bibr" rid="c59">59</xref>], and -177.8 kcal/mol [<xref ref-type="bibr" rid="c72">72</xref>].</p>
</sec>
<sec id="s4b">
<title>The chemical potential for a macroscopic salt concentration can be reliably determined</title>
<p>The salt insertion free energies and average volumes in <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>upper left</italic> provide a way to relate the chemical potential &#x0394;<italic>&#x03BC;</italic> to macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline21.gif"/></alternatives></inline-formula> via <xref ref-type="disp-formula" rid="eqn19">equation 19</xref>. <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>upper right</italic> shows the predicted macroscopic salt concentration for a range of chemical potentials &#x0394;<italic>&#x03BC;</italic> computed using <xref ref-type="disp-formula" rid="eqn19">equation 19</xref>. The average salt concentration in a saline box &#x2329;<italic>c</italic>&#x232A; should equal the predicted macroscopic concentration for sufficiently large saline boxes if the chemical potential has been properly calibrated. To verify the accuracy of the calculated values for <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NACl</sub></sub>, simulations of water boxes were performed using an osmostat with different fixed chemical potentials and the average salt concentrations in the simulations were estimated (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <italic>upper right</italic>). These boxes of TIP3P and TIP4P-Ew waters contained 4085 and 4066 molecules respectively, whereas the TIP3P and TIP4P-Ew boxes used to estimate <italic>f</italic> (<italic>N</italic>) and &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> contained 887 and 886 molecules respectively. As <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>upper right</italic> shows, the macroscopic concentrations <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline22.gif"/></alternatives></inline-formula> predicted using <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> fall within the statistical error of the average concentrations &#x2329;<italic>c</italic>&#x232A; determined from the fxed-&#x0394;<italic>&#x03BC;</italic> simulations.</p>
<p>Although &#x0394;<italic>&#x03BC;</italic> is the thermodynamic control parameter for osmostated simulations, experimental wetlab conditions instead generally specify the macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline23.gif"/></alternatives></inline-formula> rather than &#x0394;<italic>&#x03BC;</italic>. As the relationship between &#x0394;<italic>&#x03BC;</italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline24.gif"/></alternatives></inline-formula> is monotonic, as illustrated by <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>upper right,</italic> we can numerically invert <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> to enable practitioners to choose the desired macroscopic salt concentration and extract the required &#x0394;<italic>&#x03BC;</italic> for the osmostat to model equilibrium with the macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline25.gif"/></alternatives></inline-formula>.</p>
</sec>
<sec id="s4c">
<title>The average salt concentration is highly sensitive to chemical potential</title>
<p>The macroscopic salt concentration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline26.gif"/></alternatives></inline-formula> for a fixed chemical potential &#x0394;<italic>&#x03BC;</italic> is a highly sensitive and nonlinear function of the chemical potential (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <italic>upper right)</italic> for both water models. Small changes to the chemical potential, on the order of 1 <italic>kT</italic>, can alter the mean concentration by hundreds of millimolar. Correspondingly, to accurately model a given macroscopic concentration <italic>c</italic>, the function &#x0394;<italic>&#x03BC;</italic>(<italic>c</italic>) must be very precisely calibrated.</p>
</sec>
<sec id="s4d">
<title>Different water models have distinct chemical potentials for the same salt concentration</title>
<p>Strikingly, both the value and shape of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline27.gif"/></alternatives></inline-formula> is very sensitive to choice of water model (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <italic>upper right</italic>). For instance, a &#x0394;<italic>&#x03BC;</italic> of about 316 <italic>kT</italic> results in a mean salt concentration in TIP3P water that is approximately 500 mM, compared to approximately 200 mM in TIP4P-Ew water for the same value of &#x0394;<italic>&#x03BC;</italic>. These features highlight the importance of specifically calibrating the chemical potential for each water and ion model as well as estimating <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) and &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> to a sufficient degree of precision. <xref ref-type="fig" rid="figS2">Figure A5.2</xref> shows that for TIP3P and the treatment of long-rang interactions used herein, the free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) for each <italic>N</italic><sub>NaCl</sub> &#x2208; &#x007B;0,1,&#x2026;, 20&#x007D; need to be determined to a standard error of 8 kcal/mol to consistently determine the macroscopic concentration to an inaccuracy of at least about 80 mM for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline28.gif"/></alternatives></inline-formula>. The average standard error achieved in the calibration simulations for the free energies <italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) is 0.04 kcal/mol, which determines the concentration to an inaccuracy no larger than about 1 mM.</p>
</sec>
<sec id="s4e">
<title>NCMC greatly enhances the sampling efficiency of salt insertion and deletion moves</title>
<p>We estimate that instantaneous salt insertion and deletion moves have acceptance probabilities of 3.0 &#x00D7; 10<sup>&#x2212;51</sup> [95&#x0025; CI: 5.0 &#x00D7; 10<sup>&#x2212;66</sup>, 9.0 &#x00D7; 10<sup>&#x2212;51</sup>] and 1.0 &#x00D7; 10<sup>&#x2212;46</sup> [95 &#x0025; CI: 3.0 &#x00D7; 10<sup>&#x2212;64</sup>, 4.0 &#x00D7; 10<sup>&#x2212;46</sup>] in TIP3P and TIP4P-Ew water respectively, implying that the implementation of an osmostat is practically impossible using such naive moves. In contrast, we found that in our longest protocol, NCMC insertion/deletion attempts achieved acceptance probabilities of about 30&#x0025; in TIP3P water and approximately 15&#x0025; in TIP4P-Ew water (see the lower left of <xref ref-type="fig" rid="fig4">Figure 4</xref>). Although the acceptance probability increases monotonically with the length of the protocol, so does the computational cost and time for each attempt. The efficiency, defined in <xref ref-type="disp-formula" rid="eqn25">equation 25</xref>, quantifies the trade-off between the acceptance rate and computational expense. <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>lower right</italic> shows that NCMC protocols in TIP3P water that are between 15 ps and 30 ps in length are the most efficient for our procedure. For this reason, all subsequent simulations used TIP3P water and a 20 ps long NCMC protocol. In addition, it was found that 10 propagation steps (at 2 fs) between each perturbation was found to be the most computationally efficient for our simulation code SaltSwap [0.5.2] and OpenMM [7.1.0] (see <xref ref-type="fig" rid="figS3">Figure A5.3</xref>). Further optimization of the NCMC protocol would be required for NCMC attempts in TIP4P-Ew to achieve sampling efficiencies that are competitive with those in TIP3P water.</p>
</sec>
<sec id="s4f">
<title>An NCMC osmostat can rapidly equilibrate the salt concentration in biomolecular systems</title>
<p><xref ref-type="fig" rid="fig5">Figure 5</xref> shows example salt concentration trajectories around DHFR as well as plots of the corresponding autocorrelation functions for three biologically plausible macroscopic salt concentrations. The autocorrelation times for the three macroscopic salt concentrations are on the order of 1 ns, implying that our osmostated simulations should be at least tens of nanoseconds long to generate sufficient uncorrelated samples of salt concentrations. Importantly, the magnitude of the instantaneous salt concentration fluctuations increases with the macroscopic salt concentration, which causes an increase in the correlation time as our osmostat implementation proposes the insertion/deletion of one salt pair a at a time. As a result, more attempts are required to explore salt concentration distributions of higher variance. This suggests that inserting or deleting multiple salt pairs in each attempt could improve the sampling efficiency of our osmostat at higher macroscopic salt concentrations, though longer NCMC insertion/deletion protocols would likely be required to achieve similar acceptance probabilities.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Dynamic salt sampling for DHFR in TIP3P water at three macroscopic salt concentrations.</title><p><italic>Left:</italic> Trajectories of the salt concentration in 30 ns simulations of DHFR in a boxes of TIP3P waters as a function of time for 100 mM, 150 mM, and 200 mM NaCl, along with distribution of equilibrium salt concentrations to right of the time-series plots. The distributions were estimated using a Gaussian smoothing kernel with bandwidth of 0.3 mM from all three simulation repeats at each macroscopic concentration. Before the insertion of NaCl, the simulation contained 7023 water molecules. <italic>Right:</italic> Normalized fluctuation autocorrelation functions and integrated autocorrelation times (&#x03C4;) of salt concentrations for each simulation. Shaded regions and uncertainties on the autocorrelation time signify 95&#x0025; confidence intervals calculated using bootstrap estimation from three independent simulations.</p></caption>
<graphic xlink:href="226001_fig5.tif"/>
</fig>
</sec>
<sec id="s4g">
<title>Fluctuation magnitude grows with system size and macroscopic salt concentration</title>
<p><xref ref-type="fig" rid="fig6">Figure 6</xref> <italic>upper left</italic> demonstrates that for a pure box of saline and fixed macroscopic salt concentration, increasing the number of molecules in the system increases both amount of salt and the spread of the salt number distribution; in contrast, <xref ref-type="fig" rid="fig6">Figure 6</xref> (<italic>upper right)</italic> reveals that the distribution of the concentration remains centered around the macroscopic concentration, but the variance decreases. The salt concentration distribution for the smallest water box (with 2094 molecules) in <xref ref-type="fig" rid="fig6">Figure 6</xref> (<italic>upper right)</italic> can be seen to be highly multimodal. Each peak corresponds a particular number of salt pairs in the system; there are so few water molecules in this system that changing N<sub>NaCl</sub> by one results in a large jump in the concentration. <xref ref-type="fig" rid="fig6">Figure 6</xref> (<italic>bottom left and right)</italic> highlight that for a system with a fixed number of water molecules, the number of salt pairs increases in proportion with the macroscopic concentration.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Distribution of salt numbers and concentrations for TIP3P water boxes of varying size and macroscopic salt concentration</title><p><italic>Top:</italic> Equilibrium distribution of salt numbers (<italic>N</italic><sub>NaCl</sub>, <italic>left</italic>) and salt concentrations (<italic>c, right</italic>) as a function of the number of water molecules in the simulation. The applied macroscopic concentration was 150mM. Notably, at fixed macroscopic salt concentration, the magnitude of fluctuations in the number of salt pairs <italic>N</italic><sub>NaCl</sub> grows with box size (<italic>left</italic>), whereas the magnitude in the concentration decreases with box size. The average salt concentration &#x2329;<italic>c</italic>&#x232A; remains fixed at the specified macroscopic concentration (<italic>right)</italic> showing that the calibrated chemical potential &#x0394;<italic>&#x03BC;</italic> is invariant to box size provided the calibration box is selected to be sufficiently large to avoid finite-size effects. The small range of <italic>N</italic><sub>NaCl</sub> in the 40 &#x00C5; box results in a multimodal salt concentration distribution. <italic>Bottom:</italic> Equilibrium distribution of salt numbers (<italic>N</italic><sub>NaCl</sub>, <italic>left</italic>) and salt concentrations (<italic>c, right</italic>) as a function of salt concentration for a water box containing 7128 waters.</p></caption>
<graphic xlink:href="226001_fig6.tif"/>
</fig>
</sec>
<sec id="s4h">
<title>Salt concentrations vary significantly in typical biomolecular systems</title>
<p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows the distribution of salt concentration and ionic strength for 3 typical biomolecular systems: DHFR, <italic>apo</italic> Src kinase, and the Drew-Dickerson DNA dodecamer. The distributions in a box of TIP3P are also shown for reference. The fluctuations of the salt concentration for DHFR and the DNA dodecamer are substantial: 95&#x0025; of all salt concentration samples fall within a range of 114.5 mM for DHFR and 135.9 mM for the DNA dodecamer system. With nearly three times as many water molecules in the simulation the DNA dodecamer, Src kinase (bottom left of <xref ref-type="fig" rid="fig7">Figure 7</xref>) experiences smaller fluctuations in the salt concentration, with 95&#x0025; of all samples within a range of 78.9 mM. We expect these values to be indicative of the natural variation in salt concentration in the local environments of real biomolecules.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Equilibrium salt concentration distributions for various biomolecular systems simulated with a 200 mM osmostat.</title><p>Equilibrium salt concentration distributions (blue shaded area) are shown as a kernel density estimate of the probability density, along with the ionic strength of the solvent (light green shaded area with dotted lines). For reference, the mean salt concentrations that would be achieved in three typical fixed-salt salination strategies are shown in transparent gray lines. The continuous line uses <xref ref-type="disp-formula" rid="eqn22">equation 22</xref> and the <italic>total</italic> volume of first frame of the production simulation; the dashed line uses <xref ref-type="disp-formula" rid="eqn23">equation 23</xref> and the volume of <italic>solvent</italic> at the start of the production simulation, and the dotted line uses <xref ref-type="disp-formula" rid="eqn24">equation 24</xref> and the <italic>ratio</italic> of the number of salt pairs and water molecules. Illustrations of each system are also shown in the top right of each plot, with Na<sup>&#x002B;</sup> (purple) and Cl<sup>-</sup>(orange) densities from equilibrium 200 mM osmostat simulations shown around the three macromolecules. Isovalues for the each of 3D ion densities were chosen for visual clarity. <italic>Upper left:</italic> Box of TIP3P waters; <italic>Upper right:</italic> DHFR (dihydrofolate reductase) in TIP3P with isosurfaces containing 6.4&#x0025; and 0.85&#x0025; of Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> densities, respectively; <italic>Lower left: apo</italic> Src kinase in TIP3P with isosurfaces containing 10.2&#x0025; and 0.46&#x0025; of the Na<sup>&#x002B;</sup> and Cl<sup>-</sup> densities, respectively; <italic>Lower right:</italic> Drew-Dickerson DNA dodecamer in TIP3P with 6.8&#x0025; of the Na<sup>&#x002B;</sup> density contained in the isosurface.</p></caption>
<graphic xlink:href="226001_fig7.tif"/>
</fig>
</sec>
<sec id="s4i">
<title>Simulations containing charged biomolecules can experience salt concentrations that systematically deviate from the macroscopic concentrations</title>
<p>The DHFR, <italic>apo</italic> Src kinase, and the Drew-Dickerson DNA dodecamer structures have net charges of -11 |<italic>e</italic>|, -6 |<italic>e</italic>| and -22 |<italic>e</italic>|, respectively. The net charge of the DNA dodecamer is a result of the phosphate group on each of the nucleotides (with each of the eleven phosphate groups carrying -1 |<italic>e</italic>| charge), whereas the net charges on DHFR and Src kinase are due to an excess of glutamate and aspartate residues over arginine, histidine, and lysine residues. Neutralizing Na<sup>&#x002B;</sup> ions were added to both systems to avoid the uniform background charge that would be applied automatically with PME electrostatics. Like the other ions in our osmostat, these counterions had transmutable identities.</p>
<p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows that in our osmostated simulations of the macromolecules, the average salt concentration is on average <italic>less</italic> than the macroscopic salt concentration. Specifically, the estimated mean salt concentration for the DHFR and DNA systems are 163.1 [155.3, 172.9] mM and 132.2 [128.1, 139.2] mM respectively. The salt concentration distribution in the Src kinase system is centered closer to the macroscopic concentration of 200 mM, with an estimated mean of 177.3 [171.8, 186.1] mM.</p>
<p>The larger number of water molecules in the Src kinase system is partly the reason why its mean concentration is closer to the macroscopic value than DHFR and the DNA dodecamer. Bulk-like conditions anchor the sampled salt concentrations about the macroscopic concentration; the more water molecules and salt pairs there are, the smaller the effect a macromolecule has on the salt concentration relative to the whole system. <xref ref-type="fig" rid="fig8">Figure 8</xref> <italic>inset</italic> highlights this phenomenon with the DNA dodecamer; the mean salt concentration moves closer to the macroscopic value when more water molecules are added to the simulation.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8.</label>
<caption><title>Dependence of the charge screening length and salt concentration on simulation size for the Drew-Dickerson DNA dodecamer.</title><p><italic>Main:</italic> The mean total charge within a minimum distance from the Drew-Dickerson DNA dodecamer for 200 mM NaCl osmostated simulations and 200 mM fixed salt fraction simulations. To compare the effect of solvent content on charge screening effects, the DNA dodecamer was solvated in water boxes of two different sizes. The smallest system had water added up to a distance no less than 9 &#x00C5; away from the DNA dodecamer (adding 4296 waters), whereas the larger was solvated up to a distance at least as large as 16 &#x00C5; (adding 9276 waters). As each simulation is electrostatically neutral, the total charge must decay to zero as the distance from the DNA dodecamer increases, but the rate at which this decay occurs provides insight into the lengthscales for which biomolecules accrete a neutralizing ion constellation. The charge distributions appear robust with respect to the size of the simulation cell, as all 95&#x0025; confidence intervals (transparent colors) of the mean charge-distance profiles overlap over all distances considered. The charge-distance profiles were estimated by counting the number of ions within fixed distances of the DNA dodecamer every 1 ns and the confidence intervals were estimated by using boostrap sampling. <italic>Inset:</italic> Salt concentration probability densities estimated using kernel density estimation for 200 mM osmostated simulations with different amounts of solvent. The simulation with the small solvent box (purple) recruits far fewer salt pairs from bulk on average (dotted black line denotes 200 mM), while the average salt concentration of the simulation with the larger solvent box (pink) is significantly less perturbed from bulk.</p></caption>
<graphic xlink:href="226001_fig8.tif"/>
</fig>
</sec>
<sec id="s4j">
<title>The accuracy of heuristic salination schemes is system dependent</title>
<p>On its own, the excluded volume of the macromolecule will reduce the number of salt pairs that can occupy the simulation volume compared to bulk saline. So, as we define the salt concentration as the number of salt pairs over the total volume of the system (<xref ref-type="disp-formula" rid="eqn20">equation 20</xref>), one would expect there to be a lower salt concentration than the macroscopic value. The preparation schemes that are typically used to add salt in fixed-salt simulations that account for this effect use either the volume of the solvent (<xref ref-type="disp-formula" rid="eqn23">equation 23</xref>), or the ratio of the number of salt pairs to water molecules (<xref ref-type="disp-formula" rid="eqn24">equation 24</xref>). As a result, these methods are closer to the mode of the concentration distributions in the osmostated simulations than the heuristic method that uses the total volume of the system (<xref ref-type="disp-formula" rid="eqn22">equation 22</xref>).</p>
<p>The volume-based methods are sensitive to how equilibrated the volume is when salt is added, and, in <xref ref-type="fig" rid="fig7">Figure 7</xref>, the volume at the start of the production simulation was used to estimate the amount of salt that would be added with <xref ref-type="disp-formula" rid="eqn22">equations 22</xref> and <xref ref-type="disp-formula" rid="eqn23">23</xref>. The salt-water ratio method (<xref ref-type="disp-formula" rid="eqn24">equation 24</xref>) has no such volume dependence. As the DHFR system from the JAC benchmark was pre-equilibrated, the solvent-volume method produces a concentration that is closer to the concentration of the salt-water ratio method than in the other macromolecular systems.</p>
</sec>
<sec id="s4k">
<title>The ionic strength exceeds the salt concentration for charged macromolecules</title>
<p>In addition to the distributions of salt concentrations, <xref ref-type="fig" rid="fig7">Figure 7</xref> also shows the ionic strength of the saline buffer. While the ionic strength is used in analytical models to estimate the activities of ionic species [<xref ref-type="bibr" rid="c84">84</xref>], the only discernible common feature of the ionic strength in our simulations is that it tends to be greater than the salt concentration, which is predominantly due to the presence of neutralizing counterions. The estimated mean ionic strength of the saline buffer in the macromolecular systems are 202.4 [197.3, 215.9] mM for DHFR, 189.8 [183.6, 196.1] mM for Src kinase, and 267.6 [262.9, 273.0] mM for the DNA dodecamer (bracketed quantities denote 95&#x0025; confidence intervals). It is important to note that the calculated ionic strength can be much larger when the contribution of the macromolecule is included: the estimated ionic strengths for the whole of the DHFR, Src kinase, and DNA systems are 633.8 [624.0, 643.5] mM, 264.3 [258.6, 271.7] mM, and 3246.3 [3236.7, 3251.3] mM respectively. These high values, particularly for the DNA system, is because the ionic strength is proportional to the square of the charged number of the ionic solute. It could be more informative to consider the macromolecule and the counterions that are bound to it as a single, aggregate macro-ion, such that the contribution to the ionic strength would be lessened [<xref ref-type="bibr" rid="c84">84</xref>]; however, as there is no clear boundary between bound and unbound ions (see <xref ref-type="fig" rid="fig8">Figure 8</xref>), this approach is conceptually difficult.</p>
</sec>
<sec id="s4l">
<title>The osmostat accurately represents the local salt concentration around</title>
<p>DNA The aim of our osmostat is to replicate the local ion concentrations that would occur around biomolecules when embedded in large saline reservoirs. However, the use of periodic simulation cells and the addition of neutralizing counterions constrains length scale at which charges are screened (the Debye length) to be less than or equal to the length scale of the periodic cell. An artificial constriction of the Debye length would be finite size effect that would limit the accuracy of the salt concentrations from osmostated simulations. <xref ref-type="fig" rid="fig8">Figure 8</xref> shows the total charge contained within ever increasing distances from the Drew-Dickerson DNA dodecamer for two simulation box sizes. The smallest box was constructed by solvating the DNA up to a minimum distance of 9 &#x00C5; away from the DNA (4296 water molecules), whereas the larger box resulted from solvating up to a distance of 16 &#x00C5; from the DNA (9276 water molecules). If the Debye length was significantly affected by the periodic cell size of the smallest simulation, there would be large discrepancies between the charge distributions around the DNA of the smallest box and the larger box. <xref ref-type="fig" rid="fig8">Figure 8</xref> indicates that if such discrepancies exists, they are small, and are not found to be statistically significant in our analysis.</p>
<p>Shown first in <xref ref-type="fig" rid="fig7">Figure 7</xref> (lower right), the osmostated simulation of the Drew-Dickerson DNA dodecamer experienced significantly lower NaCl concentrations than the applied 200 mM macroscopic NaCl concentration. This difference highlights how the local ionic environment of a solute can be strikingly different from bulk saline. Increasing the amount of water in the simulation diminishes the relative effect that DNA has on perturbing the salt concentration distribution of the whole system. <xref ref-type="fig" rid="fig8">Figure 8</xref> (inset), shows that increasing the number of water molecules in the system from 4296 to 9276 molecules partially masks the local salt concentration around the DNA, such that the total salt concentration over the whole system is closer to the macroscopic concentration of 200 mM.</p>
</sec>
<sec id="s4m">
<title>NCMC increases the sampling efficiency of ion-biomolecule interactions</title>
<p>In the Drew-Dickerson DNA dodecamer, the nucleotide sequence in one strand is same as the reverse of the sequence in the other strand. At equilibrium, the average ion-occupancy of a particular atom should be equal to that of the mirrored atom on the other strand. Deviations between the average ion occupancies of mirrored atoms can quantify the degree of convergence in the ion sampling. The correlation between <italic>all</italic> of the ion occupancies of each atom in one strand and all those in the other strand is a measure of global convergence, and&#x2014;like Ponomarev et al. [<xref ref-type="bibr" rid="c64">64</xref>]&#x2014;we use the Pearson correlation coefficient to quantify this palindromic concordance. Also following Ponomarev et al., we def ne the instantaneous ion occupancy of an atom as the number of ions that are within 5 &#x00C5; and are no closer to any other atom: this distance cutoff was originally chosen to encompass the first two solvation shells around the DNA dodecamer [<xref ref-type="bibr" rid="c64">64</xref>]. The correlation between the cumulative ion occupancies in osmostated and fixed salt simulations at a range of simulation lengths are shown in <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>left.</italic> As can be seen, the global ion occupancy distribution more rapidly achieves symmetry in the osmostated simulations than the fixed-salt simulations. An average correlation of 0.90 is achieved in the osmostated simulations after an average of 19.4 [17.8,19.7] ns, but it takes 63.2 [35.4, 85.6] ns on average for fixed salt simulations to reach this correlation.</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9.</label>
<caption><title>Convergence of equilibrium salt distribution around a DNA palindrome.</title><p>The Drew-Dickerson DNA dodecamer (CGCGAATTGCGC) is a palindromic DNA sequence that has been traditionally been used as a demonstration of the slow convergence of ion distributions around the phosphate backbone of DNA. Because it is symmetric, the left-right ion environment asymmetry can be used to quantify how long an initially asymmetric ion distribution takes to become symmetric (equilibrated). <italic>Left:</italic> Evolution of the correlation between the Na<sup>&#x002B;</sup> occupancies of the two palindromic strands as a function of simulation time for standard MD (green) and MD with dynamic ion sampling (purple). The thick lines indicate the mean over three independent simulations, and the shaded regions highlight the range over the independent replicates. <italic>Right:</italic> Phosphate-cation normalized fluctuation autocorrelation functions for binary occupancies in standard MD (thick green) and MD with dynamic ion sampling either neglecting the NCMC switching time (thick purple), or the effective number of samples taken with accepted NCMC moves (dashed purple), or accounting for all NCMC MD steps whether the moves were accepted or not as a measure of total effort (dotted purple). Shaded regions highlight 95&#x0025; bootstrap confidence intervals, with bootstrap samples taken from all the adenine groups from the three simulations.</p></caption>
<graphic xlink:href="226001_fig9.tif"/>
</fig>
<p>In <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>left,</italic> the cumulative ion occupancies were updated every 4 ps, such that each instantaneous occupancy count was likely to be highly correlated with the previous. The number of <italic>independent</italic> ion-DNA interactions that occur in a given time determines the speed of the palindromic convergence. If both the osmostated and fixed-salt simulations accrued the same number of independent ion occupancy counts in a given time, the global ion correlation would increase at the same rate. Indeed, when the total occupancies are updated every 1 ns instead of 4 ps, the global ion occupancy correlations of the osmostated and fixed-salt simulations increase at approximately the same rate (see <xref ref-type="fig" rid="figS4">Figure A5.4</xref>). This indicates that the NCMC enhanced salt insertion and deletion moves in the osmostated simulations decorrelate the ion-DNA interactions faster than in fixed-salt simulations.</p>
<p>The autocorrelation functions of cation-phosphate interactions were estimated for the osmostated and fixed-salt simulations by recording ions that were within 5 &#x00C5; of the phosphorous atoms in adenine nucleotides. The autocorrelation function of these occupancies measures the probability that a cation that is initially within the distance cutoff will also be present after a given amount of time. <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>right</italic> shows that the estimated cation-phosphate autocorrelation function in the osmostated simulations decreases signif cantly faster than the autocorrelation function in the fixed-salt simulations. This trend is reflected in the estimated integrated autocorrelation times: 0.08 [0.07, 0.09] ns for osmostated simulations compared to 0.31 [0.23, 0.42] ns in the fixed-salt simulations. These estimated integrated autocorrelation times are relatively insensitive to the distance cutoff used to define occupancy: a distance cutoff of 4 &#x00C5; results in autocorrelation times of 0.09 [0.08, 0.11] ns and 0.38 [0.29,0.49] nsfor osmostated and fixed-salt simulations respectively, and a distance cutoff of 6 &#x00C5; results in autocorrelation times of 0.08 [0.07, 0.09] ns and 0.31 [0.23, 0.42] ns for osmostated and fixed-salt simulations respectively.</p>
<p>Although the dynamic ion sampling in the osmostated simulations has an integrated autocorrelation time that is roughly a factor of three and a half times less than the fixed-salt simulations, it is important to note that each accepted NCMC move has propagated the configurations of the whole system. The faster decorrelation in the osmostated simulations could therefore be a result of these extra propagation steps. Alternatively, it could be that (accepted) insertion and deletion moves by themselves are sufficient to decorrelate the cation interactions. As described in the methods, a salt insertion or deletion attempt occurs every 4 ps, and an NCMC attempt involves 20 ps of dynamics. The average acceptance probability in the DNA simulations was calculated to be 11.9 [11.7,12.2] &#x0025;. Therefore, the osmostated simulations effectively sample 1.6 [&#x2248; (0.119 &#x00D7; 20 ps &#x002B; 4 ps)/4 ps] times more dynamics than fixed salt simulations. Multiplying the osmostated integrated autocorrelation time by this factor results in a value that remains signif cantly less than the integrated autocorrelation time from the fixed salt simulations. <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>right</italic> shows the osmostated autocorrelation function when the timescale has been multiplied by the effective NCMC sampling factor (1.6). Despite the application of this factor, the fixed-salt autocorrelation function can be seen to decay significantly slower than the fixed-salt autocorrelation function. Thus, the increased sampling efficiency observed in the osmostated simulations cannot be explained by the extra dynamics sampled in the NCMC simulations. This implies that the random insertion and deletion, not the NCMC that was used to enhance the move efficiency, is responsible for the rapid decorrelation of ion interactions observed in the DNA osmostated simulations.</p>
<p>It is important to note that the use of NCMC increases the computational burden the simulations. There is an additional 20 ps of dynamics for every insertion/deletion attempt, irrespective of whether the proposal was accepted or not. As each attempted is preceded by 4 ps of equilibrium dynamics, our osmostated simulations have 6 (&#x003D; (20 ps <sup>&#x002B;</sup> 4 ps)/4 ps) times as timestep evaluations than the fixed-salt simulations. Multiplying the mean integrated autocorrelation time from the osmostat simulations by this factor yields an effective autocorrelation of 0.48 [0.42, 0.54] ns. This value is within the statistical uncertainty of the integrated autocorrelation time of the fixed-salt simulations. The right-hand plot of <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>right</italic> also shows the osmostat autocorrelation function when its timescale is stretched by a factor of 6. One can see that it consistently falls within the 95&#x0025; confidence intervals of the fixed-salt autocorrelation function. These results imply the dynamic NaCl sampling achieved by our osmostat has a similar cost effectiveness&#x2014;with regards to ion sampling&#x2014;than fixed-salt simulations, with the additional benefit of sampling realistic salt concentrations.</p>
</sec>
</sec>
<sec id="s5">
<title>Discussion</title>
<p>In this work, we have implemented an omsostat that dynamically samples the NaCl concentration in biomolecular simulations. The osmostat couples a simulation cell to a saline reservoir at a fixed macroscopic concentration and allows the salt concentration in the simulation to fluctuate about its equilibrium value. We have applied our osmostat to simulations of dihydrofolate reductase (DHFR), <italic>apo</italic> Src kinase, and the Drew-Dickerson B-DNA dodecamer (CGCGAATTGCGC), and found that the mean salt concentration can differ significantly from the amount salt added by common molecular dynamics methodologies. In addition, we found that the salt concentration fluctuations were large, being of the same order of magnitude as the mean. These results show that the ionic composition around biomolecules can be highly variable and system dependent.</p>
<p>The insertion and deletion of salt was greatly enhanced by nonequilibrium candidate Monte Carlo (NCMC), to the extent that the protocol used in our simulations was approximately 5 &#x00D7; 10<sup>46</sup> times more efficient than instantaneous attempts in TIP3P water. The Drew-Dickerson B-DNA dodecamer is a palindromic sequence that facilitated a study of the convergence of ion distributions around the DNA. We found that NCMC-accelerated random insertion and deletion of ions in our osmostat decorrelated ion-DNA interactions signif cantly faster than f xed-salt simulations. The speed-up of the ion configuration sampling was such that the osmostat remained computationally competitive with fixed-salt simulations despite the extra expense of the NCMC procedure.</p>
<sec id="s5a">
<title>Potential applications</title>
<p>While the dependence of enzyme-substrate activity on ionic strength is well documented, the impact of salt concentration on protein-ligand binding affinity is much less clear. Recently, Papaneophytou et al. performed a systematic analysis on the effect of buffer conditions on the <italic>in vitro</italic> affinity of three complexes [<xref ref-type="bibr" rid="c62">62</xref>], finding salt concentration dependence to be system dependent and largest for complexes that formed hydrophilic interactions. Our osmostat provides the opportunity to rigorously study the impact of salt concentration on protein-ligand binding affinities <italic>in silico.</italic> We are interested to know if similar trends to what Papaneophytou et al. observed can be reproduced in all-atom binding free energies calculations, and whether binding free energy estimates differ signif cantly between simulations carried out with and without an osmostat. Free energy calculations on complexes whose association is sensitive to the concentration of salt are likely to be most affected by the osmostat, given the large fluctuations of concentration and the deviation from the fixed-salt values that occurred in our simulations (see <xref ref-type="fig" rid="fig7">Figure 7</xref>). The combination of self adjusted mixture sample (SAMS) and Bennett acceptance ratio (BAR) that we used to calibrate the chemical potential can also be used to estimate the difference between traditional and osmostated free energy calculations. If signif cant differences between binding free energy calculations in fixed-salt and osmostat simulations are observed, it is also possible to apply the same SAMS-BAR methodology to correct the free energy calculations that have been performed with fixed salt.</p>
<p>As our osmostat has been designed to reproduce realistic salt environments around biomolecules, it is well suited to study systems whose function are sensitive to the salt concentration, or biomolecules that are regulated by interactions with Na<sup>&#x002B;</sup> or Cl<sup>&#x2212;</sup>. While our osmostat can efficiently sample ion binding to biomolecular surfaces, the sampling of deeply buried ion binding sites is likely to be no more than efficient than in typical molecular dynamics simulations due to the fact that our osmostat is implemented by swapping water with salt. To this end, the osmostat could be improved and generalized if position-biased insertions of fully-decoupled ghost molecules could be added to its sampling repertoire. An example of one such biasing scheme can be found in the biomolecular simulation package ProtoMS, where the grand canonical insertion and deletion of water are attempted in a pre-defned region within proteins [<xref ref-type="bibr" rid="c68">68</xref>, <xref ref-type="bibr" rid="c69">69</xref>]. Previously, Song and Gunner studied the interplay between protein conformation, residue pKas, and ion binding affinity using a grand canonical ion insertion scheme within the MCCE framework [<xref ref-type="bibr" rid="c78">78</xref>]. Their work provided structural insight into the often tight-coupling between ion and proton affinity as well as the pH sensitivity of ion binding, and highlights the power of specialized ion sampling schemes to rationalize and understand experimental measurements. The insertion of decoupled ghost molecules&#x2014;while it would likely require more highly optimized alchemical protocols for insertion&#x2014;would also permit generalizing the method to more complex salt or buffer molecules or other excipients.</p>
</sec>
<sec id="s5b">
<title>Enhancing realism in molecular simulations</title>
<p>Because the pKa of protein residues are dependent on the ionic strength of the medium, a natural extension of the osmostat is to combine it with constant-pH simulations in explicit water. Previously, Chen and Roux coupled protonation state changes with the insertion and deletion of ions to maintain electrostatic neutrality [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c65">65</xref>]. The application of an osmostat to such transformations would allow for the macroscopicion concentration&#x2014;as well pH&#x2014;to be rigorously maintained, and could be implemented in modular MCMC scheme that updates protonation states and ion identities in tandem.</p>
<p>This work only considers the concentration of NaCl, but both the formalism we introduce in the Theory section and the flexibility SaltSwap code-base can be readily extended to sample over biologically relevant salt mixtures by including additional monovalent species such as K<sup>&#x002B;</sup> and divalent species like Ca<sup>2&#x002B;</sup>. More complex ions or buffer molecules, such as HCO<sub>3</sub><sup>&#x2212;</sup> would require a more signif cant extension to code (such as the insertion of ghost particles described earlier), and could be implemented by using a softcore alchemical NCMC pathway that converts the molecule between fully interacting and noninteracting states.</p>
<p>The combination of a multicomponent osmostat with a constant-pH methodology would allow for realistic physiological conditions to be better approximated in molecular simulations. While it is well appreciated that pathological tissue can be found with altered pH&#x2014;tumor microenvironments can have low pH, while cancer cells can have elevated pH, for example [<xref ref-type="bibr" rid="c90">90</xref>]&#x2014;pathologies can also disrupt healthy ion compositions [<xref ref-type="bibr" rid="c19">19</xref>]. The ability to reproduce specif c ionic concentrations as well as pH would open the possibility of using molecular simulations to target compounds to specif c microenvironments or achieve selectivity via salt-dependent environmental differences. Indeed, Spahn et al. recently used molecular simulations to develop an analgesic that selectively targets the &#x03BC;-opioid receptors in damaged, low pH, tissues [<xref ref-type="bibr" rid="c80">80</xref>].</p>
</sec>
<sec id="s5c">
<title>Improving osmostat efficiency</title>
<p>We have demonstrated that our implementation of the NCMC osmostat was sufficient to sample equilibrium distributions of ions around biomolecules in practical simulation times. We have not yet extensively optimized the osmostat for computational or algorithmic efficiency beyond exploring NCMC protocol lengths (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="figS3">Figure A5.3</xref>), such that there a number of ways that the computational efficiency could be further improved.</p>
<p>In our current implementation, which only proposes insertion/deletion of a single salt pair in each proposal, the correlation time for the instantaneous salt concentration increases with increasing system size as the size of the equilibrium fluctuations also grow in terms of total numbers of ions (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Inserting or deleting multiple ion pairs&#x2014;likely using longer specialized NCMC protocols tuned to the number of ions being inserted or deleted&#x2014;could help maintain efficiency. Adaptive MCMC proposals, currently in widespread use in the Bayesian inference community (e.g., PyMC [<xref ref-type="bibr" rid="c5">5</xref>]), could be used to automatically tune the number of ions proposed to be deleted or inserted based on the current concentration and the history of the sampler, provided care was taken to ensure the adaptation method maintained ergodicity and ensured the target density was properly sampled [<xref ref-type="bibr" rid="c7">7</xref>]. One of the earliest adaptive scheme was originally validated on unimodal distributions [<xref ref-type="bibr" rid="c25">25</xref>], such that a discretized variant could be well suited to sampling the number of pairs.</p>
<p>Acceptance rates can also be increased by using proposals that do not simply select ions at random, but instead select ions that are more easily inserted/deleted based on some rapidly-evaluated surrogate (such as their instantaneous Monte Carlo acceptance probabilities or the electrostatic potential on water and ion sites), provided this biased selection probability is accounted for in a modified Metropolis-Hastings acceptance criteria.</p>
<p>There is a great deal of potential to improve the efficiency of the NCMC protocol used for the insertion and deletion proposals. The current work uses a linear interpolation of the salt and water nonbonded parameters as the alchemical path and perturbations steps that are equally spaced with respect to the parameters, primarily because this is the simplest scheme to implement. The only optimization carried out here was tuning the total protocol length to be sufficiently long to achieve high acceptance rates but not so long that the overall efficiency would be diminished by further extending the protocol length (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Optimized NCMC protocols can reduce protocol switching times required to achieve high acceptance rates, thereby increasing overall efficiency. The ability to quantify the <italic>thermodynamic length</italic> of the nonequilibrium protocol allows the problem of protocol optimization to be tackled rigorously. The thermodynamic length (an application of the Fisher-Rao metric to statistical mechanics [<xref ref-type="bibr" rid="c8">8</xref>]) is a natural, albeit abstract, measure of the distance traversed by a system during a thermodynamic driving process [<xref ref-type="bibr" rid="c14">14</xref>]. Within this framework, optimal NCMC protocols are given by geodesics in a Riemannian metric tensor space [<xref ref-type="bibr" rid="c76">76</xref>]. The thermodynamic length of the NCMC protocol can be estimated in separate equilibrium simulations spaced along the alchemical path, or estimated directly from the protocol work values of the NCMC switching trajectories, including those from rejected proposals [<xref ref-type="bibr" rid="c53">53</xref>]. For optimizing a preselected alchemical path, spacing the perturbation steps to be equidistant with respect to the thermodynamic length can improve acceptance rates by reducing the total variance of the protocol work. As optimal paths are geodesics in thermodynamic space, the most efficient alchemical path for the insertion or deletion will likely be a nonlinear, rather than linear, interpolation of the water and ion nonbonded parameters. Previous efforts to optimize nonequilibrium paths have included directly solving for the geodesic [<xref ref-type="bibr" rid="c70">70</xref>], sampling the protocol from an ensemble [<xref ref-type="bibr" rid="c23">23</xref>], and by restricting the optimization to a family of functional forms [<xref ref-type="bibr" rid="c66">66</xref>]. The close relationship between thermodynamic length and the dissipation along the path also suggests that restricting the propagated dynamics to only the first few layers of the solvation shell around the transmuted molecules could also improve the NCMC protocol.</p>
</sec>
</sec>
<sec id="s6">
<title>Conclusion</title>
<p>The philosophy of this work is that increasing the realism of biomolecular simulations will aid structural inference and improve the quantitative accuracy of predictions. We believe that the NCMC osmostat we have presented here will be a useful tool for probing the interactions of ions and biomolecules under more physiological conditions than considered in traditional molecular dynamics simulations. It is our hope that the application of the osmostat to protein-ligand binding free energy calculations and extending the method to more comprehensive ion compositions will improve its utility even further.</p>
</sec>
<sec id="s7" sec-type="availability">
<title>Code and data availability</title>
<list list-type="bullet">
<list-item><p>Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/choderalab/saltswap">https://github.com/choderalab/saltswap</ext-link></p></list-item>
<list-item><p>Data analysis scripts available at <ext-link ext-link-type="uri" xlink:href="https://github.com/choderalab/saltswap-results">https://github.com/choderalab/saltswap-results</ext-link></p></list-item>
</list>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>GR, ASR, PBG, JF, and JDC acknowledge support from the Sloan Kettering Institute. JDC acknowledges support from NIH grant P30 CA008748. The authors are especially grateful to Zhiqiang Tan (Rutgers) for many fruitful discussions on the theory and application of self-adjusted mixture sampling and nonequilibrium candidate Monte Carlo, to Marilyn R. Gunner (CCNY) for her insight in counterion distributions around macromolecules, Peter Eastman for his help and advice with OpenMM, and Kyle A. Beauchamp (Counsyl) for the DHFR system. JDC expresses enormous gratitude to Ken A. Dill (Laufer Center, Stony Brook University) for highly formative conversations about the nature of thermodynamic parameters relevant to biomolecular systems on microscopic lengthscales and his encyclopedic knowledge of the foundational experiments that laid bare their role in driving biophysical phenomena; some of these ideas are realized here.</p>
</ack>
<sec id="s8">
<title>Disclosures</title>
<p>JDC is a member of the Scientific Advisory Board for Schr&#x00F6;dinger, LLC.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="website"><collab>PDBFixer</collab>;.<ext-link ext-link-type="uri" xlink:href="https://github.com/pandegroup/pdbflxer">https://github.com/pandegroup/pdbflxer</ext-link>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="website"><collab>pymbar</collab>;.<ext-link ext-link-type="uri" xlink:href="https://github.com/choderalab/pymbar">https://github.com/choderalab/pymbar</ext-link>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="website"><collab>Amber 14 benchmark archive</collab>; <year>2017</year>.<ext-link ext-link-type="uri" xlink:href="http://ambermd.org/Amber14&#x005F;Benchmark&#x005F;Suite">http://ambermd.org/Amber14&#x005F;Benchmark&#x005F;Suite.tar.bz2</ext-link>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="website"><collab>OpenMMTools 0.11.1</collab>; <year>2017</year>. <ext-link ext-link-type="uri" xlink:href="https://github.com/choderalab/openmmtools/releases/tag/0.11.1">https://github.com/choderalab/openmmtools/releases/tag/0.11.1</ext-link>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="website"><source>Probabilistic Programming in Python: Bayesian Modeling and Probabilistic Machine Learning with Theano</source>; <year>2017</year>. <ext-link ext-link-type="uri" xlink:href="https://github.com/pymc-devs/pymc3">https://github.com/pymc-devs/pymc3</ext-link>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>Abraham</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Murtola</surname> <given-names>T</given-names></string-name>, <string-name><surname>Schulz</surname> <given-names>R</given-names></string-name>, <string-name><surname>P&#x00E1;ll</surname> <given-names>S</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Hess</surname> <given-names>B</given-names></string-name>, <string-name><surname>Lindahl</surname> <given-names>E.</given-names></string-name> <article-title>GROMACS: High performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>. <source>SoftwareX</source>. <year>2015</year> Sep; <volume>1</volume>&#x2013;<issue>2</issue>:<fpage>19</fpage>&#x2013;<lpage>25</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.softx.2015.06.001">http://dx.doi.org/10.1016/j.softx.2015.06.001</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Andrieu</surname> <given-names>C</given-names></string-name>, <string-name><surname>Thoms</surname> <given-names>J.</given-names></string-name> <source>A tutorial on adaptive MCMC. Statistics and Computing</source>. <year>2008</year> <month>Dec</month>; <volume>18</volume>(<issue>4</issue>):<fpage>343</fpage>&#x2013;<lpage>373</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11222&#x2013;008-9110-y">http://dx.doi.org/10.1007/s11222&#x2013;008-9110-y,</ext-link> doi:<pub-id pub-id-type="doi">10.1007/s11222&#x2013;008-9110-y</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Atkinson</surname> <given-names>C</given-names></string-name>, <string-name><surname>Mitchell</surname> <given-names>AFS</given-names></string-name>. <article-title>Rao&#x2019;s Distance Measure</article-title>. <source>The Indian Journal of Statistics</source>. <year>1981</year>; <volume>43</volume>:<fpage>345</fpage>&#x2013;<lpage>365</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.jstor.org/stable/25050283?seq&#x003D;">https://www.jstor.org/stable/25050283?seq&#x003D;1#page&#x005F;scan&#x005F;tab&#x005F;contents</ext-link>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><surname>Bennett</surname> <given-names>CH</given-names></string-name>. <article-title>Efficient estimation of free energy differences from Monte Carlo data</article-title>. <source>Journal of Computational Physics</source>. <year>1976</year> <month>Oct</month>; <volume>22</volume>(<issue>2</issue>):<fpage>245</fpage>&#x2013;<lpage>268</lpage>. <ext-link ext-link-type="uri" xlink:href="http://linkinghub.elsevier.com/retrieve/pii/0021999176900784">http://linkinghub.elsevier.com/retrieve/pii/0021999176900784</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/0021-9991(76)90078&#x2013;4</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Roux</surname> <given-names>B.</given-names></string-name> <article-title>Efficient hybrid non-equilibrium molecular dynamics - Monte Carlo simulations with symmetric momentum reversal</article-title>. <source>The Journal of Chemical Physics</source>. <year>2014</year>; <volume>141</volume>:<issue>114107&#x002B;</issue>. <ext-link ext-link-type="uri" xlink:href="http://aip.scitation.org/doi/10.1063/1.4895516">http://aip.scitation.org/doi/10.1063/1.4895516</ext-link>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Roux</surname> <given-names>B.</given-names></string-name> <article-title>Constant-pH Hybrid Nonequilibrium Molecular Dynamics-Monte Carlo Simulation Method</article-title>. <source>J Chem Theory Comput</source>. <year>2015</year> <month>Aug</month>; <volume>11</volume>(<issue>8</issue>):<fpage>3919</fpage>&#x2013;<lpage>3931</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/acs.jctc.5b00261">http://dx.doi.org/10.1021/acs.jctc.5b00261</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/acs.jctc.5b00261</pub-id>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>. <article-title>A Simple Method for Automated Equilibration Detection in Molecular Simulations</article-title>. <source>J Chem Theory Comput</source>. <year>2016</year> <month>Apr</month>; <volume>12</volume>(<issue>4</issue>):<fpage>1799</fpage>&#x2013;<lpage>1805</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/acs.jctc.5b00784">http://dx.doi.org/10.1021/acs.jctc.5b00784</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00784</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Shirts</surname> <given-names>MR</given-names></string-name>. <article-title>Replica Exchange and Expanded Ensemble Simulations as Gibbs Sampling: Simple Improvements for Enhanced Mixing</article-title>. <source>J Chem Phys</source>. <year>2011</year>; <volume>135</volume>(<issue>19</issue>):<fpage>194110</fpage>. doi:<pub-id pub-id-type="doi">10.1063/1.3660669</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>. <article-title>Measuring Thermodynamic Length</article-title>. <source>Phys Rev Lett</source>. <year>2007</year> <month>Sep</month>; <volume>99</volume>(<issue>10</issue>):<issue>100602</issue><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/physrevlett.99.100602">http://dx.doi.org/10.1103/physrevlett.99.100602</ext-link>, doi: <pub-id pub-id-type="doi">10.1103/physrevlett.99.100602</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="other"><string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>. <article-title>Excursions in Statistical Dynamics</article-title>. <source>PhD thesis</source>; <year>1999</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><surname>Darden</surname> <given-names>T</given-names></string-name>, <string-name><surname>York</surname> <given-names>D</given-names></string-name>, <string-name><surname>Pedersen</surname> <given-names>L.</given-names></string-name> <article-title>Particle mesh Ewald: An NlogN method for Ewald sums in large systems</article-title>. <source>The Journal of Chemical Physics</source>. <year>1993</year> <month>Jun</month>; <volume>98</volume>(<issue>12</issue>):<fpage>100891</fpage>&#x2013;<lpage>10092</lpage>. <ext-link ext-link-type="uri" xlink:href="http://aip.scitation.org/doi/10.1063/1.464397">http://aip.scitation.org/doi/10.1063/1.464397</ext-link>, doi: <pub-id pub-id-type="doi">10.1063/1.464397</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><surname>Eastman</surname> <given-names>P</given-names></string-name>, <string-name><surname>Friedrichs</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Radmer</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Bruns</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Ku</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Beauchamp</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Lane</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>LP</given-names></string-name>, <string-name><surname>Shukla</surname> <given-names>D</given-names></string-name>,<string-name><surname>Tye</surname> <given-names>T</given-names></string-name>, <string-name><surname>Houston</surname> <given-names>M</given-names></string-name>, <string-name><surname>Stich</surname> <given-names>T</given-names></string-name>, <string-name><surname>Klein</surname> <given-names>C</given-names></string-name>, <string-name><surname>Shirts</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Pande</surname> <given-names>VS</given-names></string-name>. <article-title>OpenMM 4: A Reusable, Extensible, Hardware Independent Library for High Performance Molecular Simulation</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2013</year> <month>Jan</month>; <volume>9</volume>(<issue>1</issue>):<fpage>461</fpage>&#x2013;<lpage>469</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/ct300857j">http://pubs.acs.org/doi/abs/10.1021/ct300857j</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/ct300857j</pub-id>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><surname>Eastman</surname> <given-names>P</given-names></string-name>, <string-name><surname>Swails</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>, <string-name><surname>McGibbon</surname> <given-names>RT</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Beauchamp</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>LP</given-names></string-name>, <string-name><surname>Simmonett</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Harrigan</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Stern</surname> <given-names>CD</given-names></string-name>, <string-name><surname>Wiewiora</surname> <given-names>RP</given-names></string-name>, <string-name><surname>Brooks</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Pande</surname> <given-names>VS</given-names></string-name>. <article-title>OpenMM 7: Rapid development of high performance algorithms for molecular dynamics</article-title>. <source>PLOS Computational Biology</source>. <year>2017</year> <month>Jul</month>; <volume>13</volume>(<issue>7</issue>):<fpage>e1005659</fpage><sup>&#x002B;</sup>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005659">http://dx.doi.org/10.1371/journal.pcbi.1005659</ext-link>, doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005659</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Eil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Vodnala</surname> <given-names>SK</given-names></string-name>, <string-name><surname>Clever</surname> <given-names>D</given-names></string-name>, <string-name><surname>Klebanoff</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Sukumar</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Palmer</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Gros</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yamamoto</surname> <given-names>TN</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Guittard</surname> <given-names>GC</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Carbonaro</surname> <given-names>V</given-names></string-name>, <string-name><surname>Okkenhaug</surname> <given-names>K</given-names></string-name>, <string-name><surname>Schrump</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Linehan</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Roychoudhuri</surname> <given-names>R</given-names></string-name>, <string-name><surname>Restifo</surname> <given-names>NP</given-names></string-name>. <article-title>Ionic immune suppression within the tumour microenvironment limits T cell effector function</article-title>. <source>Nature</source>. <year>2016</year> <month>Sep</month>; <volume>537</volume>(<issue>7621</issue>):<fpage>539</fpage>&#x2013;<lpage>543</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature19364">http://dx.doi.org/10.1038/nature19364</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/nature19364</pub-id>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Elena</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bou-Rabee</surname> <given-names>N</given-names></string-name>, <string-name><surname>Reich</surname> <given-names>S.</given-names></string-name> <article-title>A comparison of generalized hybrid Monte Carlo methods with and without momentum flip</article-title>. <source>Journal of Computational Physics</source>. <year>2009</year>; <volume>228</volume>:<fpage>2256</fpage>&#x2013;<lpage>2265</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0021999108006323">http://www.sciencedirect.com/science/article/pii/S0021999108006323</ext-link>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><surname>Faller</surname> <given-names>R</given-names></string-name>, <string-name><surname>de Pablo</surname> <given-names>JJ</given-names></string-name>. <article-title>Constant pressure hybrid Molecular Dynamics-Monte Carlo simulations</article-title>. <source>The Journal of Chemical Physics</source>. <year>2002</year>; <volume>116</volume>(<issue>1</issue>):<fpage>55</fpage>. <ext-link ext-link-type="uri" xlink:href="http://scitation.aip.org/content/aip/journal/jcp/116/1/10.1063/1.1420460">http://scitation.aip.org/content/aip/journal/jcp/116/1/10.1063/1.1420460</ext-link>, doi: <pub-id pub-id-type="doi">10.1063/1.1420460</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><surname>Fukuda</surname> <given-names>I</given-names></string-name>, <string-name><surname>Nakamura</surname> <given-names>H.</given-names></string-name> <source>Non-Ewald methods: theory and applications to molecular systems</source>. <year>2012</year>; <volume>4</volume>(<issue>3</issue>):<fpage>161</fpage>&#x2013;<lpage>170</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s12551&#x2013;012-0089&#x2013;4">http://dx.doi.org/10.1007/s12551&#x2013;012-0089&#x2013;4</ext-link>, doi: <pub-id pub-id-type="doi">10.1007/s12551&#x2013;012-0089&#x2013;4</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><surname>Gingrich</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Rotskoff</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Geissler</surname> <given-names>PL</given-names></string-name>. <article-title>Near-optimal protocols in complex nonequilibriumtransformations</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2016</year> <month>Sep</month>; <volume>113</volume>(<issue>371</issue>):<fpage>10263</fpage>&#x2013;<lpage>10268</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1606273113">http://dx.doi.org/10.1073/pnas.1606273113</ext-link>, doi: <pub-id pub-id-type="doi">10.1073/pnas.1606273113</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Green</surname> <given-names>PJ</given-names></string-name>. <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source>. <year>1995</year>; <volume>82</volume>(<issue>4</issue>):<fpage>711</fpage>&#x2013;<lpage>732</lpage>. <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/biomet/article-abstract/82/4/711/252058?redirectedFrom&#x003D;fulltext">https://academic.oup.com/biomet/article-abstract/82/4/711/252058?redirectedFrom&#x003D;fulltext</ext-link>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><surname>Haario</surname> <given-names>H</given-names></string-name>, <string-name><surname>Saksman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Tamminen</surname> <given-names>J.</given-names></string-name> <article-title>An adaptive Metropolis algorithm</article-title>. <source>Bernoulli</source>. <year>2001</year>; <volume>7</volume>(<issue>2</issue>):<fpage>223</fpage>&#x2013;<lpage>242</lpage>. <ext-link ext-link-type="uri" xlink:href="https://projecteuclid.org/euclid.bj/1080222083">https://projecteuclid.org/euclid.bj/1080222083</ext-link>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><surname>Hammarsten</surname> <given-names>O</given-names></string-name>, <string-name><surname>Chu</surname> <given-names>G.</given-names></string-name> <article-title>DNA-dependent protein kinase: DNA binding and activation in the absence of Ku</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>; <volume>95</volume>(<issue>2</issue>):<fpage>525</fpage>&#x2013;<lpage>530</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/content/95/2/525.short">http://www.pnas.org/content/95/2/525.short</ext-link>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><string-name><surname>Hofmeister</surname> <given-names>F.</given-names></string-name> <article-title>Zur Lehre von der Wirkung der Salze: Zweite Mittheilung</article-title>. <source>Archivf&#x00FC;r Experimentelle Pathologie und Pharmakologie</source>. <year>1888</year> <month>Feb</month>; <volume>24</volume>(<issue>4&#x2013;5</issue>):<fpage>247</fpage>&#x2013;<lpage>260</lpage>. <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/BF01918191">http://link.springer.com/10.1007/BF01918191</ext-link>, doi: <pub-id pub-id-type="doi">10.1007/BF01918191</pub-id>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><surname>Horn</surname> <given-names>HW</given-names></string-name>, <string-name><surname>Swope</surname> <given-names>WC</given-names></string-name>, <string-name><surname>Pitera</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Madura</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Dick</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Hura</surname> <given-names>GL</given-names></string-name>, <string-name><surname>Head-Gordon</surname> <given-names>T.</given-names></string-name> <article-title>Development of an improved four-site water model for biomolecular simulations: TIP4P-Ew</article-title>. <source>The Journal of Chemical Physics</source>. <year>2004</year> <month>May</month>; <volume>120</volume>(<issue>20</issue>):<fpage>9665</fpage>&#x2013;<lpage>9678</lpage>.<ext-link ext-link-type="uri" xlink:href="http://scitation.aip.org/content/aip/journal/jcp/120/20/10.1063/1.1683075">http://scitation.aip.org/content/aip/journal/jcp/120/20/10.1063/1.1683075</ext-link>, doi: <pub-id pub-id-type="doi">10.1063/1.1683075</pub-id>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><surname>Hribar</surname> <given-names>B</given-names></string-name>, <string-name><surname>Southall</surname> <given-names>NT</given-names></string-name>, <string-name><surname>Vlachy</surname> <given-names>V</given-names></string-name>, <string-name><surname>Dill</surname> <given-names>KA</given-names></string-name>. <article-title>How Ions Affect the Structure of Water</article-title>. <source>Journal of the American Chemical Society</source>. <year>2002</year> <month>Oct</month>; <volume>124</volume>(<issue>41</issue>):<fpage>12302</fpage>&#x2013;<lpage>12311</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/ja026014h">http://pubs.acs.org/doi/abs/10.1021/ja026014h</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/ja026014h</pub-id>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><surname>Hub</surname> <given-names>JS</given-names></string-name>, <string-name><surname>de Groot</surname> <given-names>BL</given-names></string-name>, <string-name><surname>Grubm&#x00FC;ller</surname> <given-names>H</given-names></string-name>, <string-name><surname>Groenhof</surname> <given-names>G.</given-names></string-name> <article-title>Quantifying Artifacts in Ewald Simulations of Inhomogeneous Systems with a Net Charge</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2014</year> <month>Jan</month>; <volume>10</volume>(<issue>1</issue>):<fpage>381</fpage>&#x2013;<lpage>390</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/ct400626b">http://pubs.acs.org/doi/abs/10.1021/ct400626b</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/ct400626b</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><surname>Humphrey</surname> <given-names>W</given-names></string-name>, <string-name><surname>Dalke</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schulten</surname> <given-names>K.</given-names></string-name> <article-title>VMD: Visual molecular dynamics</article-title>. <source>Journal of Molecular Graphics</source>. <year>1996</year> <month>Feb</month>; <volume>14</volume>(<issue>1</issue>):<fpage>33</fpage>&#x2013;<lpage>38</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0263&#x2013;7855(96)00018&#x2013;5">http://dx.doi.org/10.1016/0263&#x2013;7855(96)00018&#x2013;5</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/0263&#x2013;7855(96)00018&#x2013;5</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><surname>Hunter</surname> <given-names>JD</given-names></string-name>. <article-title>Matplotlib: A 2D graphics environment</article-title>. <source>Computing In Science &#x0026; Engineering</source>. <year>2007</year>; <volume>9</volume>(<issue>3</issue>):<fpage>90</fpage>&#x2013;<lpage>95</lpage>. doi: <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><string-name><surname>Jo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>T</given-names></string-name>, <string-name><surname>Iyer</surname> <given-names>VG</given-names></string-name>, <string-name><surname>Im</surname> <given-names>W.</given-names></string-name> <collab>CHARMM-GUI: A web-based graphical user interface for CHARMM</collab>. <source>J Comput Chem</source>. <year>2008</year> <month>Aug</month>; <volume>29</volume>(<issue>11</issue>):<fpage>1859</fpage>&#x2013;<lpage>1865</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.20945">http://dx.doi.org/10.1002/jcc.20945</ext-link>, doi: <pub-id pub-id-type="doi">10.1002/jcc.20945</pub-id>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="website"><string-name><surname>Jones</surname> <given-names>E</given-names></string-name>, <string-name><surname>Oliphant</surname> <given-names>T</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>P</given-names></string-name>, <etal>et al.</etal>, <source>SciPy: Open source scientific tools for Python</source>; <fpage>2001</fpage>&#x2013;<lpage>2017</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><surname>Jorgensen</surname> <given-names>WL</given-names></string-name>, <string-name><surname>Blake</surname> <given-names>JF</given-names></string-name>, <article-title>Buckner. Free energy of TIP4P water and the free energies of hydration of CH4 and Cl<sup>-</sup> from statistical perturbation theory</article-title>. <source>Chem Phys</source>. <year>1989</year> <month>Jan</month>; <volume>1291</volume>(<issue>2</issue>):<fpage>193</fpage>&#x2013;<lpage>200</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0301-0104(89)80004-7">http://dx.doi.org/10.1016/0301-0104(89)80004-7</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/0301-0104(89)80004-7</pub-id>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><string-name><surname>Jorgensen</surname> <given-names>WL</given-names></string-name>, <string-name><surname>Chandrasekhar</surname> <given-names>J</given-names></string-name>, <string-name><surname>Madura</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Impey</surname> <given-names>RW</given-names></string-name>, <string-name><surname>Klein</surname> <given-names>ML</given-names></string-name>. <article-title>Comparison of simple potential functions for simulating liquid water</article-title>. <source>The Journal of Chemical Physics</source>.<year>1983</year> <month>Jul</month>; <volume>79</volume>(<issue>2</issue>):<fpage>926</fpage>&#x2013;<lpage>935</lpage>. <ext-link ext-link-type="uri" xlink:href="http://scitation.aip.org/content/aip/journal/jcp/79/2/10.1063/1.445869">http://scitation.aip.org/content/aip/journal/jcp/79/2/10.1063/1.445869</ext-link>, doi: <pub-id pub-id-type="doi">10.1063/1.445869</pub-id>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><string-name><surname>Joung</surname> <given-names>IS</given-names></string-name>, <string-name><surname>Cheatham</surname> <given-names>TE</given-names></string-name>. <article-title>Determination of Alkali and Halide Monovalent Ion Parameters for Use in Explicitly Solvated Biomolecular Simulations</article-title>. <source>J Phys Chem B</source>.<year>2008</year> <month>Jul</month>; <volume>112</volume>(<issue>30</issue>):<fpage>9020</fpage>&#x2013;<lpage>9041</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp8001614">http://dx.doi.org/10.1021/jp8001614</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/jp8001614</pub-id>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><string-name><surname>Karagiannis</surname> <given-names>G</given-names></string-name>, <string-name><surname>Andrieu</surname> <given-names>C.</given-names></string-name> <article-title>Annealed Importance Sampling Reversible Jump MCMC Algorithms</article-title>. <source>Journal of Computational and Graphical Statistics</source>.<year>2013</year> <month>Jul</month>; <volume>22</volume>(<issue>3</issue>):<fpage>623</fpage>&#x2013;<lpage>648</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10618600.2013.805651">http://dx.doi.org/10.1080/10618600.2013.805651</ext-link>, doi: <pub-id pub-id-type="doi">10.1080/10618600.2013.805651</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><string-name><surname>Le Rudulier</surname> <given-names>D</given-names></string-name>, <string-name><surname>Strom</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Dandekar</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>LT</given-names></string-name>, <string-name><surname>Valentine</surname> <given-names>RC</given-names></string-name>. <article-title>Molecular Biology of Osmoregulation</article-title>. <source>Science</source>.<year>1984</year> <month>Jun</month>; <volume>224</volume>(<issue>4653</issue>):<fpage>1064</fpage>&#x2013;<lpage>1068</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/cgi/doi/10.1126/science.224.4653.1064">http://www.sciencemag.org/cgi/doi/10.1126/science.224.4653.1064</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.224.4653.1064</pub-id>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="website"><string-name><surname>Leimkuhler</surname> <given-names>B</given-names></string-name>, <string-name><surname>Matthews</surname> <given-names>C.</given-names></string-name> <article-title>Numerical Methods for Stochastic Molecular Dynamic. In</article-title>: <source>Molecular Dynamics: With Deterministic and Stochastic Numerical Methods</source> Springer;<year>2015</year>.<ext-link ext-link-type="uri" xlink:href="http://www.springer.com/gb/book/9783319163741">http://www.springer.com/gb/book/9783319163741</ext-link>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><string-name><surname>Liang</surname> <given-names>F.</given-names></string-name> <article-title>A Generalized Wang-Landau Algorithm for Monte Carlo Computation</article-title>. <source>Journal of the American Statistical Association</source>.<year>2005</year> <month>Dec</month>; <volume>100</volume>(<issue>472</issue>):<fpage>1311</fpage>&#x2013;<lpage>1327</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214505000000259">http://dx.doi.org/10.1198/016214505000000259</ext-link>, doi:<pub-id pub-id-type="doi">10.1198/016214505000000259</pub-id>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><string-name><surname>Lieb</surname> <given-names>EH</given-names></string-name>, <string-name><surname>Lebowitz</surname> <given-names>JL</given-names></string-name>. <article-title>The constitution of matter: Existence of thermodynamics for systems composed of electrons and nuclei</article-title>. <source>Advances in Mathematics</source>.<year>1972</year>; <volume>9</volume>(<issue>3</issue>):<fpage>316</fpage>&#x2013;<lpage>398</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/0001870872900230">http://www.sciencedirect.com/science/article/pii/0001870872900230</ext-link>.</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="journal"><string-name><surname>L&#x00ED;sal</surname> <given-names>M</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>WR</given-names></string-name>, <string-name><surname>Kolafa</surname> <given-names>J.</given-names></string-name> <article-title>Molecular Simulations of Aqueous Electrolyte Solubility: 1. The Expanded-Ensemble Osmotic Molecular Dynamics Method for the Solution Phase</article-title>. <source>J Phys Chem B</source>.<year>2005</year> <month>Jul</month>; <volume>109</volume>(<issue>26</issue>):<fpage>12956</fpage>&#x2013;<lpage>12965</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp0507492">http://dx.doi.org/10.1021/jp0507492</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/jp0507492</pub-id>.</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="website"><string-name><surname>Liu</surname> <given-names>JS</given-names></string-name>. <article-title>Monte Carlo Strategies in Scientific Computing</article-title>. <source>Springer Series in Statistics, Springer</source>;<year>2008</year>.<ext-link ext-link-type="uri" xlink:href="https://books.google.com/books?id&#x003D;R8E-yHaKCGUC">https://books.google.com/books?id&#x003D;R8E-yHaKCGUC</ext-link>.</mixed-citation></ref>
<ref id="c45"><label>[45]</label><mixed-citation publication-type="journal"><string-name><surname>Lundb&#x00E4;ck</surname> <given-names>T</given-names></string-name>, <string-name><surname>H&#x00E4;rd</surname> <given-names>T.</given-names></string-name> <article-title>Salt dependence of the free energy, enthalpy, and entropy of nonsequence specific DNA binding</article-title>. <source>The Journal of Physical Chemistry</source>.<year>1996</year>; <volume>100</volume>(<issue>44</issue>):<fpage>17690</fpage>&#x2013;<lpage>17695</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jp9614613">http://pubs.acs.org/doi/abs/10.1021/jp9614613</ext-link>.</mixed-citation></ref>
<ref id="c46"><label>[46]</label><mixed-citation publication-type="journal"><string-name><surname>Lyubartsev</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Martsinovski</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Shevkunov</surname> <given-names>SV</given-names></string-name>, <string-name><surname>Vorontsov-Velyaminov</surname> <given-names>PN</given-names></string-name>. <article-title>New approach to Monte Carlo calculation of the free energy: Method of expanded ensembles</article-title>. <source>TheJournal of Chemical Physics</source>.<year>1992</year>; <volume>96</volume>(<issue>3</issue>):<fpage>1776</fpage>&#x2013;<lpage>1783</lpage>. <ext-link ext-link-type="uri" xlink:href="http://aip.scitation.org/doi/abs/10.1063/1.462133">http://aip.scitation.org/doi/abs/10.1063/1.462133</ext-link>.</mixed-citation></ref>
<ref id="c47"><label>[47]</label><mixed-citation publication-type="journal"><string-name><surname>Maier</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Martinez</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kasavajhala</surname> <given-names>K</given-names></string-name>, <string-name><surname>Wickstrom</surname> <given-names>L</given-names></string-name>, <string-name><surname>Hauser</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Simmerling</surname> <given-names>C.</given-names></string-name> <article-title>ff14SB: Improving the Accuracy of Protein Side Chain and Backbone Parameters from ff99SB</article-title>. <source>Journal of chemical theory and computation</source>.<year>2015</year> <month>Aug</month>; <volume>11</volume>(<issue>8</issue>):<fpage>3696</fpage>&#x2013;<lpage>3713</lpage>. <ext-link ext-link-type="uri" xlink:href="http://view.ncbi.nlm.nih.gov/pubmed/26574453">http://view.ncbi.nlm.nih.gov/pubmed/26574453</ext-link>.</mixed-citation></ref>
<ref id="c48"><label>[48]</label><mixed-citation publication-type="journal"><string-name><surname>Marcus</surname> <given-names>Y.</given-names></string-name> <article-title>Thermodynamics of solvation of ions. Part 5.-Gibbs free energy of hydration at 298.15 K</article-title>. <source>J Chem Soc, Faraday Trans</source>.<year>1991</year>; <volume>87</volume>(<issue>18</issue>):<fpage>2995</fpage>&#x2013;<lpage>2999</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/ft9918702995">http://dx.doi.org/10.1039/ft9918702995</ext-link>, doi:<pub-id pub-id-type="doi">10.1039/ft9918702995</pub-id>.</mixed-citation></ref>
<ref id="c49"><label>[49]</label><mixed-citation publication-type="website"><string-name><surname>Marinari</surname> <given-names>E</given-names></string-name>, <string-name><surname>Parisi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Roma</surname> <given-names>S</given-names></string-name>, <string-name><surname>Vergata</surname> <given-names>T.</given-names></string-name> <article-title>SIMULATED TEMPERING: A NEW MONTECARLO SCHEME</article-title>. <year>1992</year>; <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi&#x003D;10.1.1.286.6748">http://citeseerx.ist.psu.edu/viewdoc/summary?doi&#x003D;10.1.1.286.6748</ext-link>.</mixed-citation></ref>
<ref id="c50"><label>[50]</label><mixed-citation publication-type="journal"><string-name><surname>McGibbon</surname> <given-names>RT</given-names></string-name>, <string-name><surname>Beauchamp</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Harrigan</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Klein</surname> <given-names>C</given-names></string-name>, <string-name><surname>Swails</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Hern&#x00E1;ndez</surname> <given-names>CX</given-names></string-name>, <string-name><surname>Schwantes</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>LP</given-names></string-name>, <string-name><surname>Lane</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Pande</surname> <given-names>VS</given-names></string-name>. <article-title>MDTraj: A Modern Open Library for the Analysis of Molecular Dynamics Trajectories</article-title>. <source>Biophysical Journal</source>.<year>2015</year>; <volume>109</volume>(<issue>8</issue>):<fpage>1528</fpage>&#x2013;<lpage>1532</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.bpj.2015.08.015</pub-id>.</mixed-citation></ref>
<ref id="c51"><label>[51]</label><mixed-citation publication-type="journal"><string-name><surname>Melander</surname> <given-names>W</given-names></string-name>, <string-name><surname>Horv&#x00E1;th</surname> <given-names>C.</given-names></string-name> <article-title>Salt effects on hydrophobic interactions in precipitation and chromatography of proteins: An interpretation of the lyotropic series</article-title>. <source>Archives of Biochemistry and Biophysics</source>.<year>1977</year> <month>Sep</month>; <volume>183</volume>(<issue>1</issue>):<fpage>200</fpage>&#x2013;<lpage>215</lpage>. <ext-link ext-link-type="uri" xlink:href="http://linkinghub.elsevier.com/retrieve/pii/0003986177904349">http://linkinghub.elsevier.com/retrieve/pii/0003986177904349</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/0003&#x2013;9861(77)90434&#x2013;9</pub-id>.</mixed-citation></ref>
<ref id="c52"><label>[52]</label><mixed-citation publication-type="website"><string-name><surname>Milo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Phillips</surname> <given-names>R.</given-names></string-name> <article-title>What are the concentrations of different ions in cells?</article-title> In: <source>Cell Biology by the Numbers, draft ed. Garland Science</source>; <year>2015</year>. p. <fpage>127</fpage>&#x2013;<lpage>130</lpage>. <ext-link ext-link-type="uri" xlink:href="http://garlandscience.com/product/isbn/9780815345374">http://garlandscience.com/product/isbn/9780815345374</ext-link>.</mixed-citation></ref>
<ref id="c53"><label>[53]</label><mixed-citation publication-type="journal"><string-name><surname>Minh</surname> <given-names>DDL</given-names></string-name>, <string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>. <article-title>Estimating equilibrium ensemble averages using multiple time slices from driven nonequilibrium processes: Theory and application to free energies, moments, and thermodynamic length in single-molecule pulling experiments</article-title>. <source>The Journal of Chemical Physics</source>.<year>2011</year>; <volume>134</volume>:<fpage>024111</fpage><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://aip.scitation.org/doi/pdf/10.1063/1.3516517">http://aip.scitation.org/doi/pdf/10.1063/1.3516517</ext-link>.</mixed-citation></ref>
<ref id="c54"><label>[54]</label><mixed-citation publication-type="journal"><string-name><surname>Misra</surname> <given-names>VK</given-names></string-name>, <string-name><surname>Sharp</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Friedman</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Honig</surname> <given-names>B.</given-names></string-name> <article-title>Salt Effects on Ligand-DNA Binding</article-title>. <source>Journal of Molecular Biology</source>.<year>1994</year> <month>Apr</month>; <volume>238</volume>(<issue>2</issue>):<fpage>245</fpage>&#x2013;<lpage>263</lpage>. <ext-link ext-link-type="uri" xlink:href="http://linkinghub.elsevier.com/retrieve/pii/S002228368471285X">http://linkinghub.elsevier.com/retrieve/pii/S002228368471285X</ext-link>, doi: <pub-id pub-id-type="doi">10.1006/jmbi.1994.1285</pub-id>.</mixed-citation></ref>
<ref id="c55"><label>[55]</label><mixed-citation publication-type="journal"><string-name><surname>Moore</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Morrill</surname> <given-names>GA</given-names></string-name>. <article-title>A possible mechanism for concentrating sodium and potassium in the cell nucleus</article-title>. <source>BiophysJ</source>.<year>1976</year>; <volume>16</volume>:<fpage>527</fpage>&#x2013;<lpage>533</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1334873/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1334873/</ext-link>.</mixed-citation></ref>
<ref id="c56"><label>[56]</label><mixed-citation publication-type="journal"><string-name><surname>Mou&#x010D;ka</surname> <given-names>F</given-names></string-name>, <string-name><surname>L&#x00ED;sal</surname> <given-names>M</given-names></string-name>, <string-name><surname>&#x0160;kvor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jirs&#x00E1;k</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nezbeda</surname> <given-names>I</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>WR</given-names></string-name>. <article-title>Molecular Simulation of Aqueous Electrolyte Solubility. 2. Osmotic Ensemble Monte Carlo Methodology for Free Energy and Solubility Calculations and Application to NaCl</article-title>. <source>The Journal of Physical</source> <string-name><surname>Chemistry</surname> <given-names>B.</given-names></string-name><year>2011</year> <month>Jun</month>; <volume>115</volume>(<issue>24</issue>):<fpage>7849</fpage>&#x2013;<lpage>7861</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jp202054d">http://pubs.acs.org/doi/abs/10.1021/jp202054d</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/jp202054d</pub-id>.</mixed-citation></ref>
<ref id="c57"><label>[57]</label><mixed-citation publication-type="website"><string-name><surname>Neal</surname> <given-names>RM</given-names></string-name>, <source>Annealed Importance Sampling</source>;<year>1998</year>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/physics/9803008">http://arxiv.org/abs/physics/9803008</ext-link>.</mixed-citation></ref>
<ref id="c58"><label>[58]</label><mixed-citation publication-type="journal"><string-name><surname>Nilmeier</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Minh</surname> <given-names>DDL</given-names></string-name>, <string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>. <article-title>Nonequilibrium candidate Monte Carlo is an efficient tool for equilibrium simulation</article-title>. <source>Proceedings of the National Academy of Sciences</source>.<year>2011</year> <month>Nov</month>; <volume>108</volume>(<issue>45</issue>):<fpage>E1009</fpage>&#x2013;<lpage>E1018</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1106094108">http://dx.doi.org/10.1073/pnas.1106094108</ext-link>, doi: <pub-id pub-id-type="doi">10.1073/pnas.1106094108</pub-id>.</mixed-citation></ref>
<ref id="c59"><label>[59]</label><mixed-citation publication-type="journal"><string-name><surname>Noyes</surname> <given-names>RM</given-names></string-name>. <article-title>Thermodynamics of Ion Hydration as a Measure of Effective Dielectric Properties of Water</article-title>. <source>J Am Chem Soc</source>.<year>1962</year> <month>Feb</month>; <volume>84</volume>(<issue>4</issue>):<fpage>513</fpage>&#x2013;<lpage>522</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja00863a002">http://dx.doi.org/10.1021/ja00863a002</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/ja00863a002</pub-id>.</mixed-citation></ref>
<ref id="c60"><label>[60]</label><mixed-citation publication-type="website"><string-name><surname>Olaf</surname> <given-names>S A.</given-names></string-name> <article-title>Cellular electrolyte metabolism. In</article-title>: <source>Encyclopedia of Metalloproteins Springer</source>;<year>2013</year>.p. <fpage>580</fpage>&#x2013;<lpage>587</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.springer.com/gb/book/9781461415329">http://www.springer.com/gb/book/9781461415329</ext-link>.</mixed-citation></ref>
<ref id="c61"><label>[61]</label><mixed-citation publication-type="journal"><string-name><surname>Ong</surname> <given-names>W</given-names></string-name>, <string-name><surname>Kaifer</surname> <given-names>AE</given-names></string-name>. <article-title>Salt effects on the apparent stability of the cucurbit [7] uril-methyl viologen inclusion complex</article-title>. <source>The Journal of organic chemistry</source>.<year>2004</year>; <volume>69</volume>(<issue>4</issue>):<fpage>1383</fpage>&#x2013;<lpage>1385</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jo035030&#x002B;">http://pubs.acs.org/doi/abs/10.1021/jo035030&#x002B;</ext-link>.</mixed-citation></ref>
<ref id="c62"><label>[62]</label><mixed-citation publication-type="journal"><string-name><surname>Papaneophytou</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Grigoroudis</surname> <given-names>AI</given-names></string-name>, <string-name><surname>McInnes</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kontopidis</surname> <given-names>G.</given-names></string-name> <article-title>Quantification of the Effects of Ionic Strength, Viscosity, and Hydrophobicity on Protein-Ligand Binding Affinity</article-title>. <source>ACS Med Chem Lett</source>.<year>2014</year> <month>Aug</month>; <volume>5</volume>(<issue>8</issue>):<fpage>931</fpage>&#x2013;<lpage>936</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ml500204e">http://dx.doi.org/10.1021/ml500204e</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/ml500204e</pub-id>.</mixed-citation></ref>
<ref id="c63"><label>[63]</label><mixed-citation publication-type="journal"><string-name><surname>Pegram</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Record</surname> <given-names>MT</given-names></string-name>. <article-title>Hofmeister Salt Effects on Surface Tension Arise from Partitioning of Anions and Cations between Bulk Water and the Air-Water Interface</article-title>. <source>The Journal of Physical</source> <string-name><surname>Chemistry</surname> <given-names>B.</given-names></string-name><year>2007</year> <month>May</month>; <volume>111</volume>(<issue>19</issue>):<fpage>5411</fpage>&#x2013;<lpage>5417</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jp070245z">http://pubs.acs.org/doi/abs/10.1021/jp070245z</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/jp070245z</pub-id>.</mixed-citation></ref>
<ref id="c64"><label>[64]</label><mixed-citation publication-type="journal"><string-name><surname>Ponomarev</surname> <given-names>SY</given-names></string-name>, <string-name><surname>Thayer</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Beveridge</surname> <given-names>DL</given-names></string-name>. <article-title>Ion motions in molecular dynamics simulations on DNA</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>.<year>2004</year> <month>Oct</month>; <volume>101</volume>(<issue>41</issue>):<fpage>14771</fpage>&#x2013;<lpage>14775</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0406435101">http://dx.doi.org/10.1073/pnas.0406435101</ext-link>, doi:<pub-id pub-id-type="doi">10.1073/pnas.0406435101</pub-id>.</mixed-citation></ref>
<ref id="c65"><label>[65]</label><mixed-citation publication-type="website"><string-name><surname>Radak</surname> <given-names>BK</given-names></string-name>, <string-name><surname>Chipot</surname> <given-names>C</given-names></string-name>, <string-name><surname>Suh</surname> <given-names>D</given-names></string-name>,<string-name><surname>Jo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Phillips</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Schulten</surname> <given-names>K</given-names></string-name>, <string-name><surname>Roux</surname> <given-names>B.</given-names></string-name> <article-title>Constant-pH Molecular Dynamics Simulations for Large Biomolecular Systems</article-title>. <source>J Chem Theory Comput</source>.<year>2017</year> <month>Nov</month>; <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/acs.jctc.7b00875">http://dx.doi.org/10.1021/acs.jctc.7b00875</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/acs.jctc.7b00875</pub-id>.</mixed-citation></ref>
<ref id="c66"><label>[66]</label><mixed-citation publication-type="journal"><string-name><surname>Radak</surname> <given-names>BK</given-names></string-name>, <string-name><surname>Roux</surname> <given-names>B.</given-names></string-name> <article-title>Efficiency in nonequilibrium molecular dynamics Monte Carlo simulations</article-title>. <source>The Journal of Chemical Physics</source>.<year>2016</year> <month>Oct</month>; <volume>145</volume>(<issue>13</issue>):<fpage>134109</fpage><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4964288">http://dx.doi.org/10.1063/1.4964288</ext-link>, doi:<pub-id pub-id-type="doi">10.1063/1.4964288</pub-id>.</mixed-citation></ref>
<ref id="c67"><label>[67]</label><mixed-citation publication-type="book"><string-name><surname>Ravishanker</surname> <given-names>G</given-names></string-name>, <string-name><surname>Auffinger</surname> <given-names>P</given-names></string-name>, <string-name><surname>Langley</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Jayaram</surname> <given-names>B</given-names></string-name>, <string-name><surname>Young</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Beveridge</surname> <given-names>DL</given-names></string-name>. <chapter-title>Treatment of Counterions in Computer Simulations of DNA1</chapter-title>. In: <person-group person-group-type="editer"><string-name><surname>Lipkowitz</surname> <given-names>KB</given-names></string-name>, <string-name><surname>Boyd</surname> <given-names>DB</given-names></string-name></person-group>, editors. <source>Reviews in Computational Chemistry</source>, vol. <volume>11</volume> <publisher-loc>Hoboken, NJ, USA</publisher-loc>: <publisher-name>John Wiley &#x0026; Sons, Inc</publisher-name>.; <year>1997</year>.p. <fpage>317</fpage>&#x2013;<lpage>372</lpage>. <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/9780470125885.ch6">http://doi.wiley.com/10.1002/9780470125885.ch6</ext-link>, doi:<pub-id pub-id-type="doi">10.1002/9780470125885.ch6</pub-id>.</mixed-citation></ref>
<ref id="c68"><label>[68]</label><mixed-citation publication-type="journal"><string-name><surname>Ross</surname> <given-names>GA</given-names></string-name>, <string-name><surname>Bodnarchuk</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Essex</surname> <given-names>JW</given-names></string-name>. <article-title>Water Sites, Networks, And Free Energies with Grand Canonical Monte Carlo</article-title>. <source>J Am Chem Soc</source>.<year>2015</year> <month>Dec</month>; <volume>137</volume>(<issue>47</issue>):<fpage>14930</fpage>&#x2013;<lpage>14943</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jacs.5b07940">http://dx.doi.org/10.1021/jacs.5b07940</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/jacs.5b07940</pub-id>.</mixed-citation></ref>
<ref id="c69"><label>[69]</label><mixed-citation publication-type="website"><string-name><surname>Ross</surname> <given-names>GA</given-names></string-name>, <string-name><surname>Bruce Macdonald</surname> <given-names>HE</given-names></string-name>, <string-name><surname>Cave-Ayland</surname> <given-names>C</given-names></string-name>, <string-name><surname>Cabedo Martinez</surname> <given-names>AI</given-names></string-name>, <string-name><surname>Essex</surname> <given-names>JW</given-names></string-name>. <article-title>Replica exchange and standard state binding free energies with grand canonical Monte Carlo</article-title>. <source>J Chem Theory Comput</source>.<year>2017</year> <month>Nov</month>; <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/acs.jctc.7b00738">http://dx.doi.org/10.1021/acs.jctc.7b00738</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/acs.jctc.7b00738</pub-id>.</mixed-citation></ref>
<ref id="c70"><label>[70]</label><mixed-citation publication-type="journal"><string-name><surname>Rotskoff</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Vanden-Eijnden</surname> <given-names>E.</given-names></string-name> <article-title>A geometric approach to optimal nonequilibrium control: Minimizing dissipation in nanomagnetic spin systems</article-title>. <source>Physical</source> <string-name><surname>Review</surname> <given-names>E.</given-names></string-name><year>2016</year> <month>Jul</month>; <volume>95</volume>(<issue>1</issue>). <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/physreve.95.012148">http://dx.doi.org/10.1103/physreve.95.012148</ext-link>, doi:<pub-id pub-id-type="doi">10.1103/physreve.95.012148</pub-id>.</mixed-citation></ref>
<ref id="c71"><label>[71]</label><mixed-citation publication-type="journal"><string-name><surname>Rueda</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cubero</surname> <given-names>E</given-names></string-name>, <string-name><surname>Laughton</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Orozco</surname> <given-names>M.</given-names></string-name> <article-title>Exploring the Counterion Atmosphere around DNA: What Can Be Learned from Molecular Dynamics Simulations?</article-title> <source>Biophysical Journal</source>.<year>2004</year> <month>Aug</month>; <volume>87</volume>(<issue>2</issue>):<fpage>800</fpage>&#x2013;<lpage>811</lpage>. <ext-link ext-link-type="uri" xlink:href="http://linkinghub.elsevier.com/retrieve/pii/S0006349504735663">http://linkinghub.elsevier.com/retrieve/pii/S0006349504735663</ext-link>, doi:<pub-id pub-id-type="doi">10.1529/biophysj.104.040451</pub-id>.</mixed-citation></ref>
<ref id="c72"><label>[72]</label><mixed-citation publication-type="journal"><string-name><surname>Schmid</surname> <given-names>R</given-names></string-name>, <string-name><surname>Miah</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Sapunov</surname> <given-names>VN</given-names></string-name>. <article-title>A new table of the thermodynamic quantities of ionic hydration: values and some applications (enthalpy-entropy compensation and Born radii)</article-title>. <source>Phys Chem Chem Phys</source>.<year>2000</year>; <volume>2</volume>(<issue>1</issue>):<fpage>97</fpage>&#x2013;<lpage>102</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/a907160a">http://dx.doi.org/10.1039/a907160a</ext-link>, doi:<pub-id pub-id-type="doi">10.1039/a907160a</pub-id>.</mixed-citation></ref>
<ref id="c73"><label>[73]</label><mixed-citation publication-type="journal"><string-name><surname>Shelley</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Patey</surname> <given-names>GN</given-names></string-name>. <article-title>A configuration bias Monte Carlo method for ionic solutions</article-title>. <source>The Journal of Chemical Physics</source>.<year>1994</year><month>Jun</month>; <volume>100</volume>(<issue>11</issue>):<fpage>8265</fpage>&#x2013;<lpage>8270</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063Z1.466770">http://dx.doi.org/10.1063Z1.466770</ext-link>, doi:<pub-id pub-id-type="doi">10.1063/1.466770</pub-id>.</mixed-citation></ref>
<ref id="c74"><label>[74]</label><mixed-citation publication-type="journal"><string-name><surname>Shirts</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Bair</surname> <given-names>E</given-names></string-name>, <string-name><surname>Hooker</surname> <given-names>G</given-names></string-name>, <string-name><surname>Pande</surname> <given-names>VS</given-names></string-name>. <article-title>Equilibrium Free Energies from Nonequilibrium Measurements Using Maximum-Likelihood Methods</article-title>. <source>Physical Review Letters</source>.<year>2003</year> <month>Oct</month>; <volume>91</volume>(<issue>14</issue>). <ext-link ext-link-type="uri" xlink:href="https://link.aps.org/doi/10.1103/PhysRevLett.91.140601">https://link.aps.org/doi/10.1103/PhysRevLett.91.140601</ext-link>, doi:<pub-id pub-id-type="doi">10.1103/PhysRevLett.91.140601</pub-id>.</mixed-citation></ref>
<ref id="c75"><label>[75]</label><mixed-citation publication-type="journal"><string-name><surname>Sivak</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Chodera</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>. <article-title>Using Nonequilibrium Fluctuation Theorems to Understand and Correct Errors in Equilibrium and Nonequilibrium Simulations of Discrete Langevin Dynamics</article-title>. <source>Phys Rev X</source>.<year>2013</year>; <volume>3</volume>:<issue>011007<sup>&#x002B;</sup></issue>. <ext-link ext-link-type="uri" xlink:href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX3.011007">https://journals.aps.org/prx/abstract/10.1103/PhysRevX3.011007</ext-link>.</mixed-citation></ref>
<ref id="c76"><label>[76]</label><mixed-citation publication-type="journal"><string-name><surname>Sivak</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Crooks</surname> <given-names>GE</given-names></string-name>. <article-title>Thermodynamic Metrics and Optimal Paths</article-title>. <source>Phys Rev Lett</source>.<year>2012</year> <month>May</month>; <volume>108</volume>:<issue>190602</issue><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/physrevlett.108.190602">http://dx.doi.org/10.1103/physrevlett.108.190602</ext-link>, doi:<pub-id pub-id-type="doi">10.1103/physrevlett.108.190602</pub-id>.</mixed-citation></ref>
<ref id="c77"><label>[77]</label><mixed-citation publication-type="website"><string-name><surname>Sohl-Dickstein</surname> <given-names>J</given-names></string-name>, <source>Hamiltonian Monte Carlo with Reduced Momentum Flips</source>;<year>2012</year>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1205.1939">http://arxiv.org/abs/1205.1939</ext-link>.</mixed-citation></ref>
<ref id="c78"><label>[78]</label><mixed-citation publication-type="journal"><string-name><surname>Song</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Gunner</surname> <given-names>MR</given-names></string-name>. <article-title>Using multiconformation continuum electrostatics to compare chloride binding motifs in alpha-amylase, human serum albumin, and Omp32</article-title>. <source>Journal of molecular biology</source>.<year>2009</year> <month>Apr</month>; <volume>387</volume>(<issue>4</issue>):<fpage>840</fpage>&#x2013;<lpage>856</lpage>. <ext-link ext-link-type="uri" xlink:href="http://view.ncbi.nlm.nih.gov/pubmed/19340943">http://view.ncbi.nlm.nih.gov/pubmed/19340943</ext-link>.</mixed-citation></ref>
<ref id="c79"><label>[79]</label><mixed-citation publication-type="journal"><string-name><surname>Southall</surname> <given-names>NT</given-names></string-name>, <string-name><surname>Dill</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Haymet</surname> <given-names>ADJ</given-names></string-name>. <article-title>A View of the Hydrophobic Effect</article-title>. <source>The Journal of Physical Chemistry B</source>.<year>2002</year> <month>Jan</month>; <volume>106</volume>(<issue>3</issue>):<fpage>521</fpage>&#x2013;<lpage>533</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jp015514e">http://pubs.acs.org/doi/abs/10.1021/jp015514e</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/jp015514e</pub-id>.</mixed-citation></ref>
<ref id="c80"><label>[80]</label><mixed-citation publication-type="journal"><string-name><surname>Spahn</surname> <given-names>V</given-names></string-name>, <string-name><surname>Del Vecchio</surname> <given-names>G</given-names></string-name>, <string-name><surname>Labuz</surname> <given-names>D</given-names></string-name>, <string-name><surname>Rodriguez-Gaztelumendi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Massaly</surname> <given-names>N</given-names></string-name>, <string-name><surname>Temp</surname> <given-names>J</given-names></string-name>, <string-name><surname>Durmaz</surname> <given-names>V</given-names></string-name>, <string-name><surname>Sabri</surname> <given-names>P</given-names></string-name>, <string-name><surname>Reidelbach</surname> <given-names>M</given-names></string-name>, <string-name><surname>Machelska</surname> <given-names>H</given-names></string-name>, <string-name><surname>Weber</surname> <given-names>M</given-names></string-name>, <string-name><surname>Stein</surname> <given-names>C.</given-names></string-name> <article-title>A nontoxic pain killer designed by modeling of pathological receptor conformations</article-title>. <source>Science</source>.<year>2017</year> <month>Mar</month>; <volume>355</volume>(<issue>6328</issue>):<fpage>966</fpage>&#x2013;<lpage>969</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.aai8636">http://dx.doi.org/10.1126/science.aai8636</ext-link>, doi:<pub-id pub-id-type="doi">10.1126/science.aai8636</pub-id>.</mixed-citation></ref>
<ref id="c81"><label>[81]</label><mixed-citation publication-type="journal"><string-name><surname>Speidel</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Banfelder</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Mezei</surname> <given-names>M.</given-names></string-name> <article-title>Automatic Control of Solvent Density in Grand Canonical Ensemble Monte Carlo Simulations</article-title>. <source>J Chem Theory Comput</source>.<year>2006</year> <month>Sep</month>; <volume>2</volume>(<issue>5</issue>):<fpage>1429</fpage>&#x2013;<lpage>1434</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct0600363">http://dx.doi.org/10.1021/ct0600363</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/ct0600363</pub-id>.</mixed-citation></ref>
<ref id="c82"><label>[82]</label><mixed-citation publication-type="journal"><string-name><surname>Tan</surname> <given-names>Z.</given-names></string-name> <article-title>Optimally Adjusted Mixture Sampling and Locally Weighted Histogram Analysis</article-title>. <source>Journal of Computational and Graphical Statistics</source>.<year>2017</year> <month>Jan</month>; <volume>26</volume>(<issue>1</issue>):<fpage>54</fpage>&#x2013;<lpage>65</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.tandfonline.com/doi/full/10.1080/10618600.2015.1113975">https://www.tandfonline.com/doi/full/10.1080/10618600.2015.1113975</ext-link>, doi:<pub-id pub-id-type="doi">10.1080/10618600.2015.1113975</pub-id>.</mixed-citation></ref>
<ref id="c83"><label>[83]</label><mixed-citation publication-type="website"><string-name><surname>Thomas</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>NA</given-names></string-name>, <article-title>GIBS: A grand-canonical Monte Carlo simulation program for simulating ion-biomolecule interactions</article-title>;<year>2017</year>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1704.05534">http://arxiv.org/abs/1704.05534</ext-link>.</mixed-citation></ref>
<ref id="c84"><label>[84]</label><mixed-citation publication-type="journal"><string-name><surname>Sastre</surname> <given-names>de</given-names></string-name> <string-name><surname>Vicente</surname> <given-names>ME</given-names></string-name>. <article-title>The Concept of Ionic Strength Eighty Years after Its Introduction in Chemistry</article-title>. <source>J Chem Educ</source>.<year>2004</year> <month>May</month>; <volume>81</volume>(<issue>5</issue>):<fpage>750</fpage><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ed081p750">http://dx.doi.org/10.1021/ed081p750</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/ed081p750</pub-id>.</mixed-citation></ref>
<ref id="c85"><label>[85]</label><mixed-citation publication-type="journal"><string-name><surname>Vitalis&#x002A;</surname> <given-names>A</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>NA</given-names></string-name>, <string-name><surname>McCammon&#x0167;</surname> <given-names>JA</given-names></string-name>. <article-title>ISIM: A Program for Grand Canonical Monte Carlo Simulations of the Ionic Environment of Biomolecules</article-title>. <source>Molecular Simulation</source>.<year>2004</year> <month>Jan</month>; <volume>30</volume>(<issue>1</issue>):<fpage>45</fpage>&#x2013;<lpage>61</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/08927020310001597862">http://dx.doi.org/10.1080/08927020310001597862</ext-link>, doi:<pub-id pub-id-type="doi">10.1080/08927020310001597862</pub-id>.</mixed-citation></ref>
<ref id="c86"><label>[86]</label><mixed-citation publication-type="journal"><string-name><surname>Wagoner</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Pande</surname> <given-names>VS</given-names></string-name>. <article-title>Reducing the effect of Metropolization on mixing times in molecular dynamics simulations</article-title>. <source>TheJournal of Chemical Physics</source>.<year>2012</year> <month>Sep</month>; <volume>137</volume>(<issue>21</issue>):<fpage>214105</fpage><sup>&#x002B;</sup>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4769301">http://dx.doi.org/10.1063/1.4769301</ext-link>, doi:<pub-id pub-id-type="doi">10.1063/1.4769301</pub-id>.</mixed-citation></ref>
<ref id="c87"><label>[87]</label><mixed-citation publication-type="journal"><string-name><surname>van der Walt</surname> <given-names>S</given-names></string-name>, <string-name><surname>Colbert</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Varoquaux</surname> <given-names>G.</given-names></string-name> <article-title>The NumPy Array: A Structure for Efficient Numerical Computation</article-title>. <source>Computing in Science &#x0026; Engineering</source>.<year>2011</year> <month>Mar</month>; <volume>13</volume>(<issue>2</issue>):<fpage>22</fpage>&#x2013;<lpage>30</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/mcse.2011.37">http://dx.doi.org/10.1109/mcse.2011.37</ext-link>, doi: <pub-id pub-id-type="doi">10.1109/mcse.2011.37</pub-id>.</mixed-citation></ref>
<ref id="c88"><label>[88]</label><mixed-citation publication-type="website"><string-name><surname>Wang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Landau</surname> <given-names>DP</given-names></string-name>. <article-title>Efficient, Multiple-Range Random Walk Algorithm to Calculate the Density of States</article-title>. <source>Physical Review Letters</source>.<year>2001</year> <month>Mar</month>; <volume>86</volume>(<issue>10</issue>):<fpage>2050</fpage>&#x2013;<lpage>2053</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/physrevlett.86.2050">http://dx.doi.org/10.1103/physrevlett.86.2050</ext-link>, doi:<pub-id pub-id-type="doi">10.1103/phys-revlett.86.2050</pub-id>.</mixed-citation></ref>
<ref id="c89"><label>[89]</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Deng</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>B</given-names></string-name>, <string-name><surname>Pierce</surname> <given-names>L</given-names></string-name>, <string-name><surname>Krilov</surname> <given-names>G</given-names></string-name>, <string-name><surname>Lupyan</surname> <given-names>D</given-names></string-name>, <string-name><surname>Robinson</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dahlgren</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Greenwood</surname> <given-names>J</given-names></string-name>, <string-name><surname>Romero</surname> <given-names>DL</given-names></string-name>, <string-name><surname>Masse</surname> <given-names>C</given-names></string-name>, <string-name><surname>Knight</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Steinbrecher</surname> <given-names>T</given-names></string-name>, <string-name><surname>Beuming</surname> <given-names>T</given-names></string-name>, <string-name><surname>Damm</surname> <given-names>W</given-names></string-name>, <string-name><surname>Harder</surname> <given-names>E</given-names></string-name>, <string-name><surname>Sherman</surname> <given-names>W</given-names></string-name>, <string-name><surname>Brewer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wester</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title>Accurate and Reliable Prediction of Relative Ligand Binding Potency in Prospective Drug Discovery by Way of a Modern Free-Energy Calculation Protocol and Force Field</article-title>. <source>Journal of the American Chemical Society</source>.<year>2015</year> <month>Feb</month>; <volume>137</volume>(<issue>7</issue>):<fpage>2695</fpage>&#x2013;<lpage>2703</lpage>. <ext-link ext-link-type="uri" xlink:href="http://pubs.acs.org/doi/abs/10.1021/ja512751q">http://pubs.acs.org/doi/abs/10.1021/ja512751q</ext-link>, doi:<pub-id pub-id-type="doi">10.1021/ja512751q</pub-id>.</mixed-citation></ref>
<ref id="c90"><label>[90]</label><mixed-citation publication-type="journal"><string-name><surname>Webb</surname> <given-names>BA</given-names></string-name>, <string-name><surname>Chimenti</surname> <given-names>M</given-names></string-name>, <string-name><surname>Jacobson</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Barber</surname> <given-names>DL</given-names></string-name>. <article-title>Dysregulated pH: a perfect storm for cancer progression</article-title>. <source>Nature Reviews Cancer</source>.<year>2011</year>; <volume>11</volume>:<fpage>671</fpage>&#x2013;<lpage>677</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nrc3110">https://www.nature.com/articles/nrc3110</ext-link>.</mixed-citation></ref>
<ref id="c91"><label>[91]</label><mixed-citation publication-type="journal"><string-name><surname>Zgarbov&#x00E1;</surname> <given-names>M</given-names></string-name>, <string-name><surname>&#x0160;poner</surname> <given-names>J</given-names></string-name>, <string-name><surname>Otyepka</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cheatham</surname> <given-names>TE</given-names></string-name>, <string-name><surname>Galindo-Murillo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Jure&#x010D;ka</surname> <given-names>P.</given-names></string-name> <article-title>Refinement of the Sugar-Phosphate Backbone Torsion Beta for AMBER Force Fields Improves the Description of Z- and B-DNA</article-title>. <source>J Chem Theory Comput</source>. <year>2015</year> <month>Dec</month>; <volume>11</volume>(<issue>12</issue>):<fpage>5723</fpage>&#x2013;<lpage>5736</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/acs.jctc.5b00716">http://dx.doi.org/10.1021/acs.jctc.5b00716</ext-link>, doi: <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00716</pub-id>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix 1</title>
<sec id="app1a">
<title>Symbols and their definitions</title>
<list list-type="bullet">
<list-item><p><italic>x</italic>: Instantaneous configuration (positions, box vectors)</p></list-item>
<list-item><p><italic>N</italic><sub>H<sub>2</sub>0</sub>: Number of water molecules</p></list-item>
<list-item><p>N<sub>Na<sup>&#x002B;</sup></sub>: Number of cations</p></list-item>
<list-item><p><italic>N</italic><sub>Cl<sup>-</sup></sub>: Number of anions</p></list-item>
<list-item><p><italic>N</italic><sub>NaCl</sub>: Number of salt pairs beyond minimal neutralizing ions; equal to min&#x007B;<italic>N</italic><sub>Na<sup>&#x002B;</sup></sub>, <italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub>&#x007D;</p></list-item>
<list-item><p><italic>N</italic>: Sum of total number of waters and ions in the system</p></list-item>
<list-item><p><italic>&#x03B8;</italic>: Vector species labels with <italic>N</italic> elements that identifies which molecules are waters and which are ions; <italic>&#x03B8;<sub>i</sub></italic> &#x003D; 0 indicates water, <italic>&#x03B8;<sub>i</sub></italic> &#x003D; &#x002B;1 indicates monovalent cations, and <italic>&#x03B8;<sub>i</sub></italic> &#x003D; &#x2212;1 indicates monovalent anions</p></list-item>
<list-item><p><italic>z</italic>: total charge number of the macromolecules in the simulation</p></list-item>
<list-item><p><italic>n</italic>(<italic>&#x03B8;</italic>): total charge number of the ions in the simulation
<disp-formula id="eqn26">
<alternatives>
<graphic xlink:href="226001_eqn26.gif"/>
</alternatives>
</disp-formula></p></list-item>
<list-item><p><italic>U</italic>(<italic>x, &#x03B8;</italic>): Potential energy for a system with configuration <italic>x</italic> and water/ion identities <italic>&#x03B8;</italic>, units of energy</p></list-item>
<list-item><p><italic>p</italic>: External pressure, units of energy &#x00B7; length<sup>&#x2212;3</sup></p></list-item>
<list-item><p><italic>V</italic>: Instantaneous box volume, units of length<sup>3</sup></p></list-item>
<list-item><p><italic>T</italic>: Absolute temperature, units of temperature</p></list-item>
<list-item><p><italic>k<sub>B</sub></italic>: Boltzmann constant, units of energy &#x00B7; temperature<sup>&#x2212;1</sup></p></list-item>
<list-item><p><italic>&#x03B2;</italic>: Inverse temperature (&#x2261;1/<italic>k<sub>B</sub>T</italic>), units of energy<sup>&#x2212;1</sup></p></list-item>
<list-item><p><italic>I</italic>: Ionic strength, where instantaneous ionic strength for configuration <italic>x</italic> is given by
<disp-formula id="eqn27">
<alternatives>
<graphic xlink:href="226001_eqn27.gif"/>
</alternatives>
</disp-formula></p>
<p>Note that ionic strength includes minimal neutralizing counterions in the sum.</p></list-item>
<list-item><p>&#x0394;<italic>&#x03BC;</italic>: Chemical potential difference for extracting a NaCl molecule from bulk water and depositing two water molecules to bulk water; an abbreviation of &#x0394;<italic>&#x03BC;</italic><sub>2&#x00B7;H<sub>2</sub>&#x2013;NaCl</sub></p></list-item>
<list-item><p><italic>f</italic>(<italic>N</italic><sub>NaCl</sub>): Free energy to replace 2<italic>N</italic><sub>H<sub>2</sub>O</sub> water molecules with <italic>N</italic><sub>NaCl</sub> salt pairs in bulk water; an abbreviation of <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>,<italic>N, p, T</italic>).</p></list-item>
<list-item><p>&#x0394;<italic>f</italic>(<italic>N</italic><sub>NaCl</sub>): Free energy to add one more salt pair and remove two additional water molecules in a box of water than contains <italic>N</italic><sub>NaCl</sub> salt pairs already; equal to <italic>f</italic>(<italic>N</italic><sub>NaCl</sub> &#x002B; 1) &#x2013; <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>); an abbreviation of &#x0391;<italic>f</italic>(<italic>N</italic><sub>NaCl</sub>,<italic>N, p, T</italic>)</p></list-item>
<list-item><p><italic>Z</italic>(<italic>N</italic><sub>NaCl</sub><italic>,N, p, T</italic>): Isothermal-isobaric configurational partition function
<disp-formula id="eqn28">
<alternatives>
<graphic xlink:href="226001_eqn28.gif"/>
</alternatives>
</disp-formula></p></list-item>
<list-item><p>&#x039E;(&#x0394;<italic>&#x03BC;, N, p, T</italic>): Semigrand-isothermal-isobaric configurational partition function expressed as a sum over all <italic>&#x03B8;</italic>
<disp-formula id="eqn29">
<alternatives>
<graphic xlink:href="226001_eqn29.gif"/>
</alternatives>
</disp-formula>
and expressed as a sum of number of ions and water molecules
<disp-formula id="eqn30">
<alternatives>
<graphic xlink:href="226001_eqn30.gif"/>
</alternatives>
</disp-formula>
where <italic>N</italic><sub>NaCl</sub> &#x003D; min&#x007B;<italic>N</italic><sub>Na<sup>&#x002B;</sup></sub>, <italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub>&#x007D; and <italic>N</italic> &#x003D; <italic>N</italic><sub>Na<sup>&#x002B;</sup></sub>&#x002B;<italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub>&#x002B; <italic>N</italic><sub>H<sub>2</sub>0</sub>. The upper bound of the summation&#x2014;valid when <italic>z</italic> &#x003D; 0 and <italic>N</italic> is even&#x2014;is required as two water molecules are removed for every <italic>N</italic><sub>NaCl</sub>.</p></list-item>
<list-item><p><italic>&#x03C0;</italic>(<italic>x,&#x03B8;; N, p, T, &#x03BC;</italic>): Semigrand-isothermal-isobaric probability density with charge neutrality constraint
<disp-formula id="eqn31">
<alternatives>
<graphic xlink:href="226001_eqn31.gif"/>
</alternatives>
</disp-formula>
where the dependence of <italic>&#x03C0;</italic>(<italic>x,&#x03B8;</italic>;&#x0394;<italic>&#x03BC;, N, p, T</italic>) on <italic>z</italic> is omitted for brevity</p></list-item>
<list-item><p>&#x2329;<italic>A</italic>&#x232A;<sub>&#x0394;<italic>&#x03BC;N, p, T</italic></sub>: Expectation of <italic>A</italic>(<italic>x,&#x03B8;</italic>) in (&#x0394;<italic>&#x03BC;, N, p, T</italic>) ensemble
<disp-formula id="eqn32">
<alternatives>
<graphic xlink:href="226001_eqn32.gif"/>
</alternatives>
</disp-formula></p></list-item>
<list-item><p>&#x2329;<italic>A</italic>&#x232A;<sub><italic>N</italic><sub>NaCl</sub>, <italic>N, p, T</italic></sub>: Expectation of <italic>A</italic>(<italic>x</italic>) in (<italic>N</italic><sub>NaCl</sub>,<italic>N, p, T</italic>) ensemble
<disp-formula id="eqn33">
<alternatives>
<graphic xlink:href="226001_eqn33.gif"/>
</alternatives>
</disp-formula></p></list-item>
</list>
</sec>
</app>
<app id="app2">
<title>Appendix 2</title>
<sec id="app2a">
<title>Salt concentration in the thermodynamic limit</title>
<p>The purpose of this section is to derive an expression that relates the chemical potential to the salt concentration in a macroscopic saline reservoir (<xref ref-type="disp-formula" rid="eqn19">equation 19</xref>). This relationship is used in the calibration of our osmostat. The derivation will proceed by first, justifying the macroscopic concentration as the thermodynamic limit of the mean concentration, and second, rewriting the resultant expression in a manner that is amenable to computation.</p>
<sec id="app2b">
<title>The mean concentration in the thermodynamic limit</title>
<p>Following the definition of the concentration given in <xref ref-type="disp-formula" rid="eqn20">equation 20</xref>, the mean salt concentration in the semigrand ensemble considered here is given by
<disp-formula id="eqn34">
<alternatives>
<graphic xlink:href="226001_eqn34.gif"/>
</alternatives>
</disp-formula></p>
<p>We seek an approximation to this expression that it is appropriate for large, macroscopic amounts of liquid saline. For brevity, all expectation values with respect to the thermodynamic ensemble (&#x0394;<italic>&#x03BC;, N, p, T</italic>) in this section will henceforth be abbreviated as &#x2329;&#x00B7;&#x232A;.</p>
<p>The concentration is a function of two correlated random variables, the number of salt pairs <italic>N</italic><sub>NaCl</sub>(<italic>&#x03B8;</italic>) and the total volume <italic>V</italic>(<italic>x</italic>). A common way to approximate the expectation value, or mean, of a function of random variables is to perform a Taylor expansion about the mean of the arguments. The Taylor expansion (up to the second-order) of the function <italic>g</italic>(<italic>a, b</italic>) about the means &#x2329;<italic>a</italic>&#x232A; and &#x2329;<italic>b</italic>&#x232A;, is
<disp-formula id="eqn35">
<alternatives>
<graphic xlink:href="226001_eqn35.gif"/>
</alternatives>
</disp-formula></p>
<p>This expansion is particularly useful because the first order terms of the expanded mean &#x2329;<italic>g</italic>(<italic>a, b</italic>)&#x232A; are zero i.e. &#x2329;<italic>a</italic> &#x2013; &#x2329;<italic>a</italic>&#x232A;&#x232A; &#x003D; 0 and &#x2329;<italic>b</italic> &#x2013; &#x2329;<italic>b</italic>&#x232A;&#x232A; &#x003D; 0. Hence, truncating the expansion to the second order leaves us with the approximation
<disp-formula id="eqn36">
<alternatives>
<graphic xlink:href="226001_eqn36.gif"/>
</alternatives>
</disp-formula>
where Var(<italic>a</italic>) and Cov(<italic>a, b</italic>) denote the variance and covariance, respectively. Returning to the salt concentration, we relate <italic>c</italic> to the above with <italic>g</italic>(<italic>N</italic><sub>NaCl</sub>, <italic>V</italic>) &#x003D; <italic>N</italic><sub>NaCl</sub>/<italic>V</italic>, and evaluate the partial derivatives to find that
<disp-formula id="eqn37">
<alternatives>
<graphic xlink:href="226001_eqn37.gif"/>
</alternatives>
</disp-formula></p>
<p>The leading term &#x2329;<italic>N</italic><sub>NaCl</sub>&#x232A;/&#x2329;<italic>V</italic>&#x232A; is the macroscopic expression that we seek. Thus, we require that the variance and covariance terms vanish in the thermodynamic limit. To show that they indeed do, we exploit the useful correspondence between partial derivatives and covariance in statistical thermodynamics. First, note that
<disp-formula id="eqn38">
<alternatives>
<graphic xlink:href="226001_eqn38.gif"/>
</alternatives>
</disp-formula>
where &#x039E; &#x2261; &#x039E;(&#x0394;<italic>&#x03BC;, N, p, T</italic>) and is defined in <xref ref-type="disp-formula" rid="eqn7">equation 7</xref>. Also, note that
<disp-formula id="eqn39">
<alternatives>
<graphic xlink:href="226001_eqn39.gif"/>
</alternatives>
</disp-formula></p>
<p>Second, we make use of the isothermal compressibility
<disp-formula id="eqn40">
<alternatives>
<graphic xlink:href="226001_eqn40.gif"/>
</alternatives>
</disp-formula>
and introduce the susceptibility of volume with respect to the chemical potential
<disp-formula id="eqn41">
<alternatives>
<graphic xlink:href="226001_eqn41.gif"/>
</alternatives>
</disp-formula></p>
<p>The susceptibilities <italic>&#x03BA;<sub>p</sub></italic> and <italic>&#x03BA;</italic><sub>&#x0394;<italic>&#x03BC;</italic></sub> are bulk properties that measure the relative amount the volume of a system responds to changes in pressure and chemical potential, respectively. They are intensive quantities, such that they do not scale with the size of the system. These allow us to re-write the approximation of the mean concentration (<xref ref-type="disp-formula" rid="eqn37">equation 37</xref>) as
<disp-formula id="eqn42">
<alternatives>
<graphic xlink:href="226001_eqn42.gif"/>
</alternatives>
</disp-formula></p>
<p>To proceed, note that in the second term, both <italic>N</italic><sub>NaCl</sub> and &#x2329;<italic>V</italic>&#x232A; are extensive, and rise in proportion to the total number of molecules in the system <italic>N</italic>. Thus, approximating the mean concentration as &#x2329;<italic>N</italic><sub>NaCl</sub>&#x232A;/&#x2329;<italic>V</italic>&#x232A; incurs and error that is <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline30.gif"/></alternatives></inline-formula>, which tends to zero in the thermodynamic limit. We therefore define the macroscopic concentration of a saline reservoir as
<disp-formula id="eqn43">
<alternatives>
<graphic xlink:href="226001_eqn43.gif"/>
</alternatives>
</disp-formula></p>
</sec>
<sec id="app2c">
<title>We require the macroscopic concentration to be amenable to computational analysis</title>
<p>While the expression for the macroscopic concentration above does not appear immediately useful, we now show how <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline31.gif"/></alternatives></inline-formula> can be calculated for wide range of applied chemical potentials by precalculating the free energies to insert salt into a system, <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) (&#x2261; <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>,&#x0394;<italic>&#x03BC;, N, p, T</italic>)), and the average volume as a function of the number of salt pairs, &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub> (&#x2261; &#x2329;<italic>V</italic>&#x232A;<sub><italic>N</italic><sub>NaCl</sub>,<italic>N, p, T</italic></sub>).</p>
<p>To begin, it is useful to expand the def nition of &#x2329;<italic>N</italic><sub>NaCl</sub>&#x232A; given by <xref ref-type="disp-formula" rid="eqn17">equation 17</xref> into
<disp-formula id="eqn44">
<alternatives>
<graphic xlink:href="226001_eqn44.gif"/>
</alternatives>
</disp-formula></p>
<p>Next, we derive an expression for &#x2329;<italic>V</italic>&#x232A; that will cancel with the denominator of <xref ref-type="disp-formula" rid="eqn44">equation 44</xref> when evaluating <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline32.gif"/></alternatives></inline-formula>. Using the representation of the semigrand density given by <xref ref-type="disp-formula" rid="eqn8">equation 8</xref>, the mean volume is given by
<disp-formula id="eqn45">
<alternatives>
<graphic xlink:href="226001_eqn45.gif"/>
</alternatives>
</disp-formula>
where the third and fourth line exploit the definition of the ensemble average for a fixed <italic>N</italic><sub>NaCl</sub>. Inserting the expressions for the average number of salt pairs (<xref ref-type="disp-formula" rid="eqn44">equation 44</xref>) and the average volume (<xref ref-type="disp-formula" rid="eqn45">equation 45</xref>) into the macroscopic concentration (<xref ref-type="disp-formula" rid="eqn43">equation 43</xref>), we arrive at
<disp-formula>
<alternatives>
<graphic xlink:href="226001_ueqn1.gif"/>
</alternatives>
</disp-formula>
which is the same as <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> from the main text. Pertinently, the denominators in <xref ref-type="disp-formula" rid="eqn44">equations 44</xref> and <xref ref-type="disp-formula" rid="eqn45">45</xref> have canceled, which greatly simplif es the evaluation of the macroscopic concentration for a given &#x0394;<italic>&#x03BC;</italic>.</p>
</sec>
</sec>
</app>
<app id="app3">
<title>Appendix 3</title>
<sec id="app3a">
<title>Algorithmic implementation of the osmostat</title>
<p>This section describes the Metropolis-Hastings procedure from Saltswap [0.52] used to insert and delete salt. Insertion and deletion moves were enhanced with NCMC [<xref ref-type="bibr" rid="c58">58</xref>]. To describe its implementation of NCMC within SaltSwap, a more compressed notation is used compared to the original publication. For a more general and detailed exposition on NCMC, we refer readers to the original manuscript.</p>
<p>The osmostat move begins with the random choice of whether to insert or delete salt. The protocol is denoted &#x039B; &#x2208; &#x007B; &#x039B;<sub>insert</sub>, &#x039B;<sub>delete</sub>&#x007D;, and the time reversed protocol is denoted <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline33.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline34.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline35.gif"/></alternatives></inline-formula>. The probability to insert or delete a salt pair, <italic>P</italic>(&#x039B;|<italic>N</italic><sub>NaCl</sub>), depends on the number of salt molecules, <italic>N</italic><sub>NaCl</sub>, in the system in the following way:
<disp-formula id="eqn46">
<alternatives>
<graphic xlink:href="226001_eqn46.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn47">
<alternatives>
<graphic xlink:href="226001_eqn47.gif"/>
</alternatives>
</disp-formula>
where for all simulations except the SAMS calibration simulations, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline36.gif"/></alternatives></inline-formula> was chosen as two water molecules are required for the insertion of a Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> pair. In the SAMS calibration simulations, <italic>N</italic><sub>NaCl, max</sub> was set to twenty. The particular choices of <italic>P</italic>(&#x039B;<sub>delete</sub>|<italic>N</italic><sub>NaCl</sub>) and <italic>P</italic>(&#x039B;<sub>insert</sub>|<italic>N</italic><sub>NaCl</sub>) ensure that insertions are always attempted when there is no salt in the system, and deletions are always attempted when the number of salt pairs has reached maximum capacity.</p>
<p>For the insertion of salt, any two water molecules could be selected for transformation into Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup>. Similarly, for the removal of salt, any Na<sup>&#x002B;</sup> ion and Cl<sup>&#x2212;</sup> ion could be selected for transformation into two water molecules. Formally, let <italic>S</italic>(<italic>N</italic>) denote the set &#x007B;1,2, &#x2026;,<italic>N</italic>&#x007D;, i.e. the set of indices for all water molecules and ions. For salt insertion, the index of candidate Na<sup>&#x002B;</sup> ion was a random uniform sample from the set &#x007B;<italic>i</italic> &#x2208; <italic>S</italic>(<italic>N</italic>): <italic>&#x03B8;<sub>i</sub></italic> &#x003D; 0 &#x007D; and the index of the Cl<sup>&#x2212;</sup> ion was a random uniform sample from the set &#x007B;<italic>j</italic> &#x2208; <italic>S</italic>(<italic>N</italic>): <italic>&#x03B8;<sub>j</sub></italic> &#x003D; 0, <italic>i</italic> &#x2260; <italic>j</italic>&#x007D;. For salt removal, indices were selected randomly and uniformally from the sets &#x007B;<italic>i</italic> &#x2208; <italic>S</italic>(<italic>N</italic>): <italic>&#x03B8;<sub>i</sub></italic> &#x003D; &#x002B;1&#x007D; and &#x007B;<italic>j</italic> &#x2208; <italic>S</italic>(<italic>N</italic>): <italic>&#x03B8;<sub>j</sub></italic> &#x003D; -1&#x007D;. As indices were chosen with equal probability within each set of possible candidates, the ratio of selection probabilities for molecule indices for forward and reverse protocols are given by
<disp-formula id="eqn48">
<alternatives>
<graphic xlink:href="226001_eqn48.gif"/>
</alternatives>
</disp-formula>
and
<disp-formula id="eqn49">
<alternatives>
<graphic xlink:href="226001_eqn49.gif"/>
</alternatives>
</disp-formula></p>
<p>Following the choice of protocol and pair of molecules that would be transmuted, NCMC was used to enhance the efficiency of the insertion or deletion attempt. This implementation of NCMC consists of a fixed series of <italic>perturbation</italic> and <italic>propagation</italic> kernels over a fixed alchemical path. For both insertion and deletion moves, the alchemical path is a linear interpolation the nonbonded parameters of the water model and the ions. This particular alchemical path ensured that charge neutrality was maintained throughout the NCMC procedure.</p>
<p>The alchemical path is broken up into <italic>T</italic> segments that are uniformally spaced with respect to the nonbonded parameters. At state <italic>t</italic>, the configuration of the system will be denoted as <italic>x<sub>t</sub></italic> and the values of the nonbonded parameters for molecules <italic>i</italic> and <italic>j</italic> will be denoted as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline37.gif"/></alternatives></inline-formula>. A single NCMC <italic>step</italic> corresponds to the application of the perturbation kernel followed by a the propagation kernel. When in state <italic>t</italic>, the perturbation kernel updates the nonbonded parameters <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline38.gif"/></alternatives></inline-formula>, and the propagation kernel updates the configuration <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline39.gif"/></alternatives></inline-formula>. Each propagation kernel consists of <italic>K</italic> steps of Langevin dynamics using the parameters described in Simulation Details. A propagation kernel is also applied to the system before the first perturbation kernel to ensure the time symmetry of the protocol. The instantaneous change in the potential energy that results from the application of the perturbation kernel is recorded for each NCMC step and summed to produce the total work performed on the system by the protocol:
<disp-formula id="eqn50">
<alternatives>
<graphic xlink:href="226001_eqn50.gif"/>
</alternatives>
</disp-formula>
where the nonequilibrium trajectory <italic>X<sub>T</sub></italic> &#x2261; (<italic>x</italic><sub>0</sub>, <italic>x</italic><sub>1</sub>, &#x2026;,<italic>x<sub>T</sub></italic>). The difference between the protocol work and applied chemical potential &#x0394;<italic>&#x03BC;</italic>, along with the move proposal probabilities, determines whether a move is accepted or rejected. For the insertion of salt &#x0394;<italic>&#x03BC;</italic>(&#x039B;<sub>insert</sub>) &#x003D; 2<italic>&#x03BC;</italic><sub>H<sub>2</sub>O</sub> - <italic>&#x03BC;</italic><sub>NaCl</sub>, and for the deletion of salt &#x0394;<italic>&#x03BC;</italic>(&#x039B;<sub>delete</sub>) &#x003D; 2<italic>&#x03BC;</italic><sub>NaCl</sub> &#x2013; <italic>&#x03BC;</italic><sub>H<sub>2</sub>O</sub>. Attempts are accepted with the following probability
<disp-formula id="eqn51">
<alternatives>
<graphic xlink:href="226001_eqn51.gif"/>
</alternatives>
</disp-formula></p>
<p>To preserve pathwise detailed balance, velocities were reversed upon acceptance. If a move is accepted, <italic>&#x03B8;<sub>i</sub></italic> and <italic>&#x03B8;<sub>j</sub></italic> are updated to reflect the new molecule identities.</p>
</sec>
</app>
<app id="app4">
<title>Appendix 4</title>
<sec id="app4a">
<title>Validation: Ideal Mixing with the osmostat</title>
<p>In the Results section, <xref ref-type="fig" rid="fig4">Figure 4</xref> <italic>top left</italic> indicates that the chemical potential has been properly calibrated, and <xref ref-type="fig" rid="fig6">Figure 6</xref> shows that the omsostat produces samples that are concordant with physical-chemical intuition. In this section, we apply our osmostat to sample ideal mixing to provide further validation of the SaltSwap code base. Ideal mixing can be simulated with our osmostat by ensuring that salt insertion and deletion accrue no protocol work. This is implemented by using the same forcefeld parameters for Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> as the water model. As our omsostat also gives the ions the same mass as water, the &#x201C;ions&#x201D; sampled over in this section are identical to water except for their labeling.</p>
<p>To validate the sampling of the osmostat, we require an analytical relationship between the chemical potential &#x0394;<italic>&#x03BC;</italic> and the numbers of salt <italic>N</italic><sub>NaCl</sub> and water molecules <italic>N</italic><sub>H<sub>2</sub>O</sub>. The chemical potential used in our osmostat is the difference between the twice the chemical potential of water and Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup>:
<disp-formula id="eqn52">
<alternatives>
<graphic xlink:href="226001_eqn52.gif"/>
</alternatives>
</disp-formula></p>
<p>In order to relate &#x0394;<italic>&#x03BC;</italic> to <italic>N</italic><sub>NaCl</sub> and <italic>N</italic><sub>H<sub>2</sub>O</sub>, we will first consider a solution of water and ions in the (<italic>N, p, T</italic>) ensemble with fixed particle identities, and then relate the result to the (&#x0394;<italic>&#x03BC;, N, p, T</italic>) ensemble. For this fixed identity solution, let <italic>N</italic> &#x003D; <italic>N</italic><sub>H<sub>2</sub>O</sub> &#x002B; <italic>N</italic><sub>Na<sup>&#x002B;</sup></sub> &#x002B; <italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub> and <italic>N</italic><sub>Na<sup>&#x002B;</sup></sub> &#x003D; <italic>N</italic><sub>Cl<sup>&#x2212;</sup></sub>. In the (<italic>N, p, T</italic>) ensemble, the chemical potential for a species <italic>s</italic> can be expressed as
<disp-formula id="eqn53">
<alternatives>
<graphic xlink:href="226001_eqn53.gif"/>
</alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="226001_inline40.gif"/></alternatives></inline-formula> is the chemical potential of <italic>s</italic> in some reference state, <italic>x<sub>s</sub></italic> is the mole fraction of <italic>s</italic>, and <italic>&#x03B3;<sub>s</sub></italic>(<italic>N, p, T</italic>) is the activity coefficient of <italic>s</italic>. In general, the chemical potential is also dependent on the composition of the system. When Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> have the same forcefeld parameters and mass as water (i.e they are physically identical), the reference state and activity coefficients must be the same. So using <xref ref-type="disp-formula" rid="eqn53">equation 53</xref> and <xref ref-type="disp-formula" rid="eqn52">52</xref> we have
<disp-formula id="eqn54">
<alternatives>
<graphic xlink:href="226001_eqn54.gif"/>
</alternatives>
</disp-formula>
where the second line follows from the fact that there are equal numbers of Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> ions. In the semigrand canonical (&#x0394;<italic>&#x03BC;, N, p, T</italic>) ensemble that is sampled by our osmostat, the chemical potential &#x0394;<italic>&#x03BC;</italic> is a controlled by the user. As this conjugate to the number of salt pairs, <xref ref-type="disp-formula" rid="eqn54">equation 54</xref> will apply to the averages &#x2329;<italic>N</italic><sub>NaCl</sub>&#x232A;<sub>&#x0394;<italic>&#x03BC;, N, p, T</italic></sub> and &#x2329;<italic>N</italic><sub>H<sub>2</sub>O</sub>&#x232A;<sub>&#x0394;<italic>&#x03BC;, N, p, T</italic></sub>, so that we have
<disp-formula id="eqn55">
<alternatives>
<graphic xlink:href="226001_eqn55.gif"/>
</alternatives>
</disp-formula></p>
<p>To test whether our osmostat correctly samples the average salt to water ratio given in <xref ref-type="disp-formula" rid="eqn55">equation 55</xref>, ideal mixing simulations were performed using SaltSwap on a small box of TIP3P water containing five hundred molecules for a range of chemical potentials. Ten thousand insertion and deletion attempts were made for salt pairs that had the same forcefeld parameters as water. Only one perturbation step was used for the ideal NCMC insertion and deletion and the configuration of the system was not propagated during attempts. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows that there is excellent agreement between the relationship predicted by <xref ref-type="disp-formula" rid="eqn55">equation 55</xref> and the simulation data.</p>
<fig id="figA1" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 4 Figure 1.</label>
<caption><title>Validating the osmostat by comparing the observed average salt-water fractions to analytical values for ideal mixing.</title><p>The relationship between the chemical potential and fraction of average number of salt pairs to water molecules is known exactly for ideal mixing, and is given by <xref ref-type="disp-formula" rid="eqn55">equation 55</xref>. Ideal mixing was implemented for the osmostat by giving the ions the same forcefeld parameters as water. For each simulation at a chemical potential, the equilibration time and statistical inefficiency for the the average number of salt pairs &#x2329;<italic>N</italic><sub>NaCl</sub>&#x232A;<sub>&#x0394;<italic>&#x03BC;, N, p, T</italic></sub> and water molecules &#x2329;<italic>N</italic><sub>H<sub>2</sub>O</sub>)<sub>&#x0394;<italic>&#x03BC;, N, p, T</italic></sub> was determined using the timeseries module of pymbar [<xref ref-type="bibr" rid="c2">2</xref>]. Effectively independent samples were extracted using the statistical inefficiency, and the means and 95&#x0025; confidence intervals were estimated using bootstrap analysis.</p></caption>
<graphic xlink:href="226001_figA1.tif"/>
</fig>
<p>It was also verified that the protocol work was effectively zero for the ideal NCMC transformations. While the protocol work should be exactly zero, the numerical imprecision of our implementation meant this could not always be achieved. The average protocol work for the transformations shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> (which were performed on a CPU Intel Core i7 with one perturbation step) was 1 &#x00D7; 10<sup>&#x2212;7</sup> kT with a maximum absolute value of 8 &#x00D7; 10<sup>&#x2212;5</sup> kT. The NCMC protocol used throughout this study has one thousand perturbation steps and ten propagation steps per perturbation. With this protocol, the average protocol work was estimated using one thousand attempts on a GTX1080 GPU to be 2 &#x00D7; 10<sup>&#x2212;8</sup> kT with a maximum absolute value of 5 &#x00D7; 10<sup>&#x2212;4</sup> kT.</p>
</sec>
</app>
<app id="app5">
<title>Appendix 5</title>
<sec sec-type="supplementary-material">
<title>Supplementary figures</title>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 5 Figure 1.</label>
<caption><title>A Comparison of the salt insertion free energies as estimated by SAMS and BAR.</title><p>The individual SAMS estimates from ten repeats of the relative free energy &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) to insert an Na<sup>&#x002B;</sup> and Cl<sup>&#x2212;</sup> and remove two water molecules in boxes of TIP3P (left) and TIP4P-Ew (right) for each SAMS simulations. Each color represents an estimate of &#x0394;<italic>f</italic> (<italic>N</italic><sub>NaCl</sub>) from each repeat. The relative free energy as calculated by BAR using all the SAMS simulation data is shown for reference (dotted black line). Five of the SAMS repeats were started with the maximum of 20 salt pairs in the system, and the other f ve started with none. The signif cant variation between the individual SAMS repeats is due to the rapid accumulation of the biasing potential in the initial stages of the algorithm. This biased the sampling away from the initial states of the simulations and prevented the uniform sampling over the salt numbers.</p></caption>
<graphic xlink:href="226001_figS1.tif"/>
</fig>
<fig id="figS2" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 5 Figure 2.</label>
<caption><title>The statistical uncertainty of the predicted macroscopic concentration as a function of the chemical potential for different standard errors of the free energies <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) in TIP3P water.</title><p>Gaussian noise, with a mean of zero, was added to each estimated free energy <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) <italic>N</italic> &#x2208; &#x007B;0,1, &#x2026;, 20&#x007D;, for a fixed values of &#x2329;<italic>V</italic>&#x232A;<sub>N<sub>NaCl</sub></sub>. Three thousand noisy sample of <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) <italic>N</italic> &#x2208; &#x007B;0,1, &#x2026;, 20&#x007D;, <xref ref-type="disp-formula" rid="eqn19">equation 19</xref> were used to predict the macroscopic concentration for a range of chemical potentials. This figure shows the 95&#x0025; confidence range of the resultant ensemble of concentrations for different standard deviations of the Gaussian noise about the free energies. One needs to evaluate the free energies <italic>f</italic>(<italic>N</italic><sub>NaCl</sub>) to within 8 kcal/mol to achieve an error in the concentration that is no larger than roughly 80 mM. The tapering of the statistical error in the concentration at lower values of the chemical potential is due to maximum number of salt pairs used in the calibration (20), which limits that maximum concentration that can be predicted.</p></caption>
<graphic xlink:href="226001_figS2.tif"/>
</fig>
<fig id="figS3" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 5 Figure 3.</label>
<caption><title>The relative efficiency of salt insertions/deletions in TIP3P water for different numbers of NCMC propagation steps between each perturbation step.</title><p>Due to the manner in which the nonbonded parameters are updated in the SaltSwap code, it is faster&#x2014;for a fixed protocol time-length&#x2014;to perform multiple propagation steps for each perturbation (i.e. update of the nonbonded parameters) during an NCMC insertion/deletion attempt. More propagation steps limit the amount of communication between the CPU and GPU. However, for a fixed total protocol time-length, fewer perturbations increases the thermodynamic length each perturbation must traverse, which decreases the mean acceptance rate of the attempts. Thus, there is a (code-dependent) trade-off in the sampling efficiency between the number of perturbations and propagations steps. This figure shows the efficiency, defined by <xref ref-type="disp-formula" rid="eqn25">equation 25</xref>, for different numbers of propagation steps at different protocol time-lengths relative to the efficiency of instantaneous insertions and deletions. Ten propagation steps per perturbation step achieve the highest efficiencies, and so were used in all production osmostat simulations.</p></caption>
<graphic xlink:href="226001_figS3.tif"/>
</fig>
<fig id="figS4" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 5 Figure 4.</label>
<caption><title>Evolution of the cation-DNA correlation function when counting ion occupancies every 1 ns.</title><p>This plot shows the correlation between <italic>all</italic> of the Na<sup>&#x002B;</sup> occupancies of each DNA atom in one strand with all the mirrored pairs in the other strand as a function of simulation time for standard MD (green) and MD with dynamic counterion sampling (purple). The thick lines indicate the mean over three independent simulations, and the shaded regions highlight the range over the independent replicates. Unlike <xref ref-type="fig" rid="fig9">Figure 9</xref> <italic>left,</italic> the palindromic correlation functions increases at approximately the same rate because the total cation occupancies are calculated using statistically independent observations.</p></caption>
<graphic xlink:href="226001_figS4.tif"/>
</fig>
</sec>
</app>
</app-group>
</back>
</article>