<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/036558</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>SC3 &#x2013; consensus clustering of single-cell RNA-Seq data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Kiselev</surname><given-names>Vladimir Yu.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Kirschner</surname><given-names>Kristina</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Schaub</surname><given-names>Michael T.</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Andrews</surname><given-names>Tallulah</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Chandra</surname><given-names>Tamir</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Natarajan</surname><given-names>Kedar N</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Reik</surname><given-names>Wolf</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Barahona</surname><given-names>Mauricio</given-names></name>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Green</surname><given-names>Anthony R</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-2255</contrib-id>
<name><surname>Hemberg</surname><given-names>Martin</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Wellcome Trust Sanger Institute</institution>, Cambridge, Hinxton, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>Cambridge Institute for Medical Research, Wellcome Trust/MRC Stem Cell Institute and Department of Haematology, University of Cambridge</institution>, Hills Road, Cambridge, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>Department of Mathematics and naXys, University of Namur</institution>, <country>Belgium</country></aff>
<aff id="a4"><label>4</label><institution>ICTEAM, Universit&#x00E9; catholique de Louvain</institution>, <country>Belgium</country></aff>
<aff id="a5"><label>5</label><institution>Epigenetics Programme, The Babraham Institute</institution>, Babraham, Cambridge, <country>UK</country></aff>
<aff id="a6"><label>6</label><institution>EMBL-European Bioinformatics Institute</institution>, Hinxton, Cambridge, <country>UK</country></aff>
<aff id="a7"><label>7</label><institution>Centre for Throphoblast Research, University of Cambridge</institution>, Cambridge, <country>UK</country></aff>
<aff id="a8"><label>8</label><institution>Department of Mathematics, Imperial College London</institution>, London, <country>UK</country></aff>
</contrib-group>
<pub-date pub-type="epub">
<year>2016</year></pub-date>
<elocation-id>036558</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>1</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="036558.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Using single-cell RNA-seq (scRNA-seq), the full transcriptome of individual cells can be acquired, enabling a quantitative characterisation of cell-type based on expression profiles. Due to the large variability in gene expression, assigning cells into groups based on the transcriptome remains challenging. We present Single-Cell Consensus Clustering (SC3), a tool for unsupervised clustering of scRNA-seq data. SC3 integrates many different clustering solutions through a consensus approach, thereby increasing its accuracy and robustness against noise. Tests on nine published datasets show that SC3 outperforms existing methods, yet SC3 remains scalable for large datasets, as shown by the analysis of a dataset containing &#x007E;45,000 cells. To enhance the accessibility to users with limited bioinformatics expertise, SC3 features an interactive graphical implementation, which aids the biological interpretation by identifying marker genes, differentially expressed genes and outlier cells. Finally, we apply SC3 to identify different subclones of neoplastic cells in data collected from patients.</p>
</abstract>
<counts>
<page-count count="23"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>With the recent advent of single cell RNA-seq (scRNA-seq) technology, researchers are now able to quantify the entire transcriptome of individual cells, opening up a wide spectrum of biological applications. A key application of scRNA-seq is the ability to determine cell types based on the transcriptome profile alone<sup><xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c3">3</xref></sup>. The diversity of cell-types is a fundamental property of higher eukaryotes. Traditionally, cell type was defined based on shape and morphological properties. More recently, tools from molecular biology have enabled researchers to categorize cells based on surface markers<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c5">5</xref></sup>. However, morphology or a small number of marker proteins are not sufficient to characterise complex cellular phenotypes. scRNA-seq makes it possible to group cells based on their genome-wide transcriptome profiles, which is likely to provide a better representation of the cellular phenotype. Indeed, several studies have already used scRNA-seq to identify novel cell-types <sup><xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c3">3</xref></sup>, demonstrating the potential to unravel and catalogue the full diversity of cells in the human body.</p>
<p>Mathematically, the problem of <italic>de novo</italic> identification of cell-type from data may be seen as an unsupervised clustering problem, i.e., how to separate cells into non-overlapping groups without a <italic>priori</italic> information as to the number of groups or group labels. However, the lack of training data renders this unsupervised clustering a hard problem, and for scRNA-seq the challenge is further compounded by the fact that there are few reliable benchmarks for validation.</p>
<p>Although scRNA-seq is a relatively new technology, several groups have already developed custom clustering methods for single cell data<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c6">6</xref>&#x2013;<xref ref-type="bibr" rid="c10">10</xref></sup>. However, these clustering methods have various shortcomings: (i) they have not been thoroughly benchmarked against one another or against standard algorithms; (ii) it is not clear how they can be scaled to large datasets; (iii) there is no interactive, user-friendly implementation that includes support to facilitate the biological interpretation of the clusters; and (iv) the number of clusters, <italic>k</italic>, has to be fixed a <italic>priori</italic> by the user and there is no support to explore different hierarchies of clusters. The last point is particularly relevant when studying complex biological tissues as previous studies have found biologically meaningful cell populations at several levels of granularity<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c12">12</xref></sup>. Thus, a clustering method should enable the user to explore how the clusters change with <italic>k</italic>.</p>
<p>We present a novel interactive clustering tool for scRNA-seq data, SC3 (<bold>S</bold>ingle <bold>C</bold>ell <bold>C</bold>onsensus <bold>C</bold>lustering). SC3 obtains robust results by combining several well-established techniques using a consensus clustering approach. We demonstrate the performance of SC3 by applying it to nine published datasets and thoroughly benchmarking the method against four other methods. We showcase the scalability of SC3 to very large datasets by analysing a dataset with &#x007E;45,000 cells<sup><xref ref-type="bibr" rid="c3">3</xref></sup>. SC3 is implemented as an R-package with a graphical user interface, thus making it possible for users with limited bioinformatics training to explore different clusterings in an interactive and intuitive manner. In addition to providing cell clusters, SC3 facilitates their biological interpretation by identifying marker genes, differentially expressed genes, outlier cells, and by providing an integrated link to Gene Ontology analysis. To demonstrate how SC3 can be used to provide novel biological insights, we analyse scRNA-seq data from two patients with a myeloproliferative neoplasm. Strikingly, the clusters that we identify can be directly linked to subclonal populations that were characterised through independent experiments.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Consensus clustering as a robust methodology underpinning SC3</title>
<p>The output of a scRNA-seq experiment is typically represented as an expression matrix (<bold><italic>M</italic></bold>) consisting of <italic>g</italic> rows (corresponding to genes or transcripts) and <italic>N</italic> columns (corresponding to cells). SC3 takes this expression matrix as its input. The SC3 algorithm consists of several steps: a cell filter, a gene filter, distance calculations, nonlinear spectral transformations and <italic>k</italic>-means clustering, followed by the consensus step (<xref ref-type="fig" rid="fig1">Fig. 1a</xref>, Methods). Note, in particular, that the distance calculation reflects a change of coordinate space, as we go from the expression matrix (<italic>g</italic> &#x00D7; <italic>N</italic>) to a cell-to-cell matrix (<italic>N</italic> &#x00D7; <italic>N</italic>). The nonlinear spectral transformation step of the distance matrix retains the first <italic>d</italic> eigenvectors for clustering. Each of the above steps requires the specification of a number of parameters, e.g. different metrics to calculate distances between the cells or the type of nonlinear transformation. However, choosing optimal parameter values is difficult. To avoid this problem, SC3 utilizes a parallelisation approach, whereby a significant subset of the parameter space is evaluated simultaneously. The outcome of this strategy is a set of clusterings. Instead of trying to pick one optimal solution from within this set, we combine all the different clustering outcomes into a consensus matrix which summarises how often each pair of cells is located in the same cluster. The final result provided by SC3 is a consensus cluster determined by complete-linkage hierarchical clustering of the consensus matrix into <italic>k</italic> groups (<xref ref-type="fig" rid="fig1">Fig. 1b</xref>). Using this approach, we can leverage the power of a plenitude of well-established methods, while additionally gaining robustness against the particularities of any single method.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Validation of the SC3 clustering.</title>
<p>(<bold>a</bold>) Overview of SC3 clustering method (see Methods for the details). <italic>D</italic> is the length of the <italic>d</italic> range. (<bold>b</bold>) Diagram of the consensus matrix construction for the Treutlein data. Binary matrices (Methods) corresponding to each clustering solution in (<bold>a</bold>) are averaged and the resulting matrix is then clustered by hierarchical clustering with <italic>k</italic> level of hierarchy (<italic>k</italic> = 5 in this example). (<bold>c</bold>) Published datasets used to validate SC3. <italic>N</italic> is the number of cells in a dataset, <italic>k</italic> is the number of clusters identified by the authors<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c11">11</xref>&#x2013;<xref ref-type="bibr" rid="c17">17</xref></sup>. RPKM is Reads Per Kilobase of transcript per Million mapped reads, RPM is Reads Per Million mapped reads, FPKM is Fragments Per Kilobase of transcript per Million mapped reads and TPM is Transcripts Per Million mapped reads. (<italic>d</italic>) Median of ARI over 100 realizations of the SC3 clustering for four validation datasets - Ting, Deng, Pollen and Usoskin (colors correspond to the colors in (<bold>c</bold>)). The x-axis shows the number of eigenvectors <italic>d</italic> (see (<bold>a</bold>)) as a percentage of the total number of cells <italic>N</italic> in each dataset. The black vertical lines correspond to <italic>d</italic> = 4&#x0025; and <italic>d</italic> = 7&#x0025; of the total number of cells <italic>N</italic>.</p>
</caption>
<graphic xlink:href="036558_fig1.tif"/>
</fig>
<p>We first validated SC3 using eight publicly available scRNA-Seq datasets<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c11">11</xref>&#x2013;<xref ref-type="bibr" rid="c17">17</xref></sup>, ranging from <italic>N</italic> = 80 to <italic>N</italic> = 3,005 cells (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>). For each dataset, we used the clustering provided by the authors of the original study as <italic>reference labels</italic> against which we compared the clusters obtained by SC3. To quantify the discrepancy of clusterings, we use the Adjusted Rand Index (ARI, see Methods), a normalised similarity index, ranging from 1 when the clusterings are identical to 0 when the similarity is what one would expect by chance. In this study, we take 0.8 to indicate a good score. A suitable set of methods and parameters to include within our consensus approach was obtained by analysing four of the eight datasets (<xref ref-type="fig" rid="fig1">Fig. 1d</xref>). Interestingly, we found that clustering performance was largely unaffected by the cell filter, and for different choices of gene filter, distance metrics and spectral transformations, i.e., the ARI values were largely similar (<xref ref-type="fig" rid="fig1">Fig. 1d</xref>, S1-S4). In contrast, we found that ARI was most sensitive to the number of eigenvectors, <italic>d</italic>, retained after the spectral transformation: the ARI is low for small values of <italic>d</italic>, and then increases to its maximum before dropping close to 0 as <italic>d</italic> approaches <italic>N</italic>/2. In particular, we find that the best clusterings were achieved when <italic>d</italic> is between 4-7&#x0025; of the number of cells, <italic>N</italic> (Methods). We hypothesise that this range represents an optimal dimensionality reduction such that the technical noise is minimized, and use this range of parameters within our consensus approach to narrow down the parameter space to be explored. Strikingly, consensus clustering<sup><xref ref-type="bibr" rid="c18">18</xref></sup> of the solutions obtained in this range further improves the ARI (Fig. S5).</p>
<p>To benchmark SC3, we considered four other methods: tSNE <sup><xref ref-type="bibr" rid="c19">19</xref></sup> followed by <italic>k</italic>-means clustering (a method similar to those used by Gr&#x00FC;n et al<sup><xref ref-type="bibr" rid="c1">1</xref></sup> and Macosko et al<sup><xref ref-type="bibr" rid="c9">9</xref></sup>), pcaReduce<sup><xref ref-type="bibr" rid="c7">7</xref></sup>, SNN-Cliq<sup><xref ref-type="bibr" rid="c6">6</xref></sup> and SINCERA<sup><xref ref-type="bibr" rid="c10">10</xref></sup>. SC3 performs better than all of the other methods across all datasets, with the exception of the Pollen1 dataset (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). Furthermore, the higher ARI attained by SC3 comes at a moderate computational cost (Fig. S6): the run time for <italic>N</italic> = 1,000 is &#x007E;10 min, compared to &#x007E;1 min for the other methods.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Benchmarking of SC3 against existing methods.</title>
<p>Each boxplot contains results of 100 realizations of a given method except for SINCERA which is based on hierarchical clustering and provides a single solution. Pollen1, Pollen2, Usoskin1, Usoskin2, Usoskin3 correspond to different levels of hierarchies as described by Zurauskiene and Yau<sup><xref ref-type="bibr" rid="c7">7</xref></sup>. The black horizontal line corresponds to ARI=0.8. Dots represent outliers that are higher than the highest value (or lower than the lowest value) within 1.5 &#x002A; IQR, where IQR is the inter-quartile range, or distance between the first and third quartiles.</p>
</caption>
<graphic xlink:href="036558_fig2.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>SC3 can be scaled to large datasets</title>
<p>The main computational bottleneck of SC3 is the calculation of the eigenvectors of the distance matrix (which scales as <italic>O</italic>(<italic>N</italic><sup>3</sup>))<sup><xref ref-type="bibr" rid="c20">20</xref></sup>. This scaling makes it impractical to use the original, simpler version of SC3 described above for datasets with &#x003E;10,000 cells.To allow SC3 to be applied to very large datasets, we have implemented a hybrid approach which combines unsupervised and supervised methodologies. When the number of cells is large (<italic>N</italic>&#x003E; 1,000), SC3 selects 1,000 cells uniformly at random, and clusters this subset as described above. Subsequently, the inferred labels are used to train a support vector machine (SVM, Methods), which is used to assign labels to the remaining cells. Training the SVM is fast, thus allowing SC3 to be applied to very large datasets.</p>
<p>To test the SVM in isolation, we used all the validation datasets from <xref ref-type="fig" rid="fig1">Fig. 1c</xref> with the original reference labels provided by the authors to train the SVM. Our results demonstrate that using &#x003E;20&#x0025; of the cells for training it is possible to accurately predict the labels of the remaining cells (<xref ref-type="fig" rid="fig3">Fig. 3a</xref>). Overall, the performance improves with higher <italic>N</italic>, and for the larger datasets, an ARI of 0.8 can be achieved with &#x003E;10&#x0025; of training cells. Using this approach enables us to analyse a large Drop-Seq dataset that would otherwise be intractable (Macosko, <italic>N</italic> = 44,808, <italic>K</italic> = 3)<sup><xref ref-type="bibr" rid="c9">9</xref></sup>. For this dataset we found that an ARI of 0.8 can be achieved by the SVM with only 3&#x0025; of the cells used for training.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Results for the hybrid clustering approach using a linear kernel.</title>
<p>The black line corresponds to ARI = 0.8. Numbers in grey boxes correspond to the number of training cells as &#x0025; of <italic>N</italic>. (<bold>a</bold>) ARI levels for SVM prediction when reference labels (provided by the authors) are used for training. (<bold>b</bold>) ARI levels for SVM prediction when labels calculated by SC3 are used for training. Dots represent outliers that are higher than the highest value (or lower than the lowest value) within 1.5 &#x002A; IQR, where IQR is the inter-quartile range, or distance between the first and third quartiles.</p>
</caption>
<graphic xlink:href="036558_fig3.tif"/>
</fig>
<p>Using the hybrid approach it is still possible to achieve an ARI &#x003E; 0.8 with only 20&#x0025; of the training cells for the larger datasets (Klein and Zeisel, (<xref ref-type="fig" rid="fig3">Fig. 3b</xref>). Interestingly, in the case of the Macosko dataset our consensus clustering produces a result that is drastically different from the authors&#x2019;. Closer inspection of our results shows that SC3 does not identify cluster 24 (labelled as &#x201C;Rods&#x201D;) with 29,400 cells)<sup><xref ref-type="bibr" rid="c9">9</xref></sup>. This implies that the original large cluster 24 may be more heterogeneous than suggested by the authors.</p>
</sec>
<sec id="s2c">
<title>SC3 is implemented through an interactive and user-friendly interface</title>
<p>To increase its usability, SC3 features a graphical user interface displayed through a web browser, thus minimising the need for bioinformatics expertise. The user is only required to provide the input expression matrix and a range for the number of clusters, <italic>k</italic>, and SC3 will calculate the possible clusterings for this range. Since the clustering is performed during startup, the user can thus explore different choices of <italic>k</italic> in real-time. The outcome is presented graphically as a consensus matrix to facilitate visual assessment of the clustering quality (<xref ref-type="fig" rid="fig4">Fig. 4b</xref>). The elements of the consensus matrix represent a score, normalised between 0 and 1, indicating the fraction of SC3 parameter combinations that assigned the two cells to the same cluster. By considering the consensus scores within and between clusters, one may quickly assess the clustering quality by visual inspection. Furthermore, to aid the user in the selection of <italic>k</italic>, SC3 also calculates the silhouette index<sup><xref ref-type="bibr" rid="c21">21</xref></sup>, a measure of how tightly grouped the cells in the cluster are.</p>
</sec>
<sec id="s2d">
<title>SC3 assists with biological interpretation</title>
<p>A key aspect for evaluating the quality of the clustering, which cannot be captured by traditional mathematical consistency criteria, is the biological interpretation of the clusters. To help the user characterise the clusters, SC3 identifies differentially expressed genes, marker genes, and outlier cells. By definition, differentially expressed genes differ between two or more clusters. To detect such genes, SC3 employs the Kruskal-Wallis<sup><xref ref-type="bibr" rid="c22">22</xref></sup> test (Methods) and reports the differentially expressed genes across all clusters, sorted by <italic>p</italic>-value. In contrast, marker genes are highly expressed in only one of the clusters and are selected based on their ability to distinguish one cluster from the remaining ones (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>). To select marker genes, SC3 uses a binary classifier based on the ranked gene expressions to distinguish one cluster from all the others. For each gene, a receiver operator characteristic (ROC) curve is then calculated to evaluate how well the classifier identifies the cluster, and the genes are ranked by the area under the ROC curve. The most significant candidates are then reported as marker genes. Cell outliers are identified by calculating a score for each cell using the Minimum Covariance Determinant<sup><xref ref-type="bibr" rid="c23">23</xref></sup>. Cells that fit well into their clusters receive an outlier score of 0, whereas high values indicate that the cell should be considered an outlier (<xref ref-type="fig" rid="fig4">Fig. 4d</xref>). The outlier score helps to identify cells that could correspond to, e.g. rare cell-types or technical artifacts. Moreover, SC3 also makes it possible to obtain a gene ontology analysis for each cluster by directly exporting the list of marker genes to WebGestalt)<sup><xref ref-type="bibr" rid="c24">24</xref></sup> All the results from SC3 can be saved to text files for further downstream analyses.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Biological interpretation of the Deng dataset.</title>
<p>(<bold>a</bold>) Toy example illustrating the difference between marker genes and differentially expressed genes. 20 cells containing only 14 genes with binary expression values (blue for off and red for on) are clustered. Only genes 1-4 can be considered as marker genes, whereas all genes 1-14 are differentially expressed. (<bold>b</bold>) The consensus matrix panel from SC3. The matrix indicates how often each pair of cells was assigned to the same cluster by the different parameter combinations. Dark red indicates that the cells were often assigned to the same cluster whereas dark blue indicates that they were assigned to different clusters most of the time. The colors at the top represent the labels assigned by the authors and the white lines are visual guides to separate the clusters. (<bold>c</bold>) The marker genes panel from SC3. The heatmap shows expression profiles (after Gene Filter and Log-transformation, Methods) of top 10 marker genes for each of the 10 clusters identified by SC3. The colors of the clusters do not correspond to the ones at the top of (<bold>b</bold>). Note that for cluster 2 no marker genes were found and for cluster 5 only four marker genes were found. (<bold>d</bold>) The outlier cells panel from SC3. Cell outliers in the 10 reference clusters (provided by the authors) - nine adjacent cells in the green cluster were prepared using a different protocol (see text for details).</p>
</caption>
<graphic xlink:href="036558_fig4.tif"/>
</fig>
<p>To illustrate the above features, we analysed the Deng dataset tracing embryonic developmental stages, and clustered it into 10 groups as suggested in the original study<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. As shown in <xref ref-type="fig" rid="fig4">Fig. 4b</xref>, our clusters largely agree with those obtained by the authors. We identified &#x007E;3000 marker genes (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>, Table S2). Characteristic genes for the zygote and 2-cell stages include Xpr1, Elf3, Cux2, Klf6, Emp2, Krt8, Serpinb6a/6b, Fn1 and Pecam1. From 8-cell to blastocyst developmental transition we found several Zscan subunits (Zscan4a, Zscan4b, Zscan4c Zscan4d, Zscan4f and Zscan5f &#x2013; 16-cell stage), Mad2l2, Krt28, Anxa2, Cyb5, Dppa1, Egfr, Eomes, Id2, Lcp1, Mbnl3, Snai1, Tcfap2a, Tspan8, Klf2, Hand1, Gdf9, Tcl1, Pabpc1l, Cryl1, Ddx4, Il10rb and Il6st (receptor for Il6, Lif, Osm, Cntf, II11, Ctf1 for blastocyst stages). In addition, we investigated several other highly ranked marker genes by comparing to public repositories and publications<sup><xref ref-type="bibr" rid="c25">25</xref>&#x2013;<xref ref-type="bibr" rid="c29">29</xref></sup>. The analysis revealed several genes specific to a developmental stage which had previously not been reported (Table S2). Using the reference labels reported by the authors<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, we identified nine cells with high outlier scores (green cells in <xref ref-type="fig" rid="fig4">Fig. 4d</xref>). Further examination revealed that these nine cells were prepared using the Smart-Seq2 protocol instead of the Smart-Seq protocol)<sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c15">15</xref></sup>, thus demonstrating the ability of SC3 to identify technical outliers.</p>
</sec>
<sec id="s2e">
<title>SC3 provides biological insights to clinically relevant patient sub-clones</title>
<p>Next, we applied SC3 to scRNA-seq data from two patients diagnosed with myeloproliferative neoplasm (MPN), a group of diseases which reflects an early stage of tumorigenesis. MPNs are predisposed to acute myeloid leukemia due to overproduction of cells from the myeloid lineage. This chronic myeloid nature of MPNs is a result of mutations in haematopoietic stem cells (HSC). MPNs are a clonal disease where several clones are able to coexist for long periods of time<sup><xref ref-type="bibr" rid="c30">30</xref></sup>.</p>
<p>Each patient typically harbours multiple neoplastic subclones intermingled with normal blood cells, thus presenting a severe challenge for data analysis.</p>
<p>We collected HSCs from both patients and for patient 1 we obtained scRNA-seq data for <italic>N</italic> = 85 cells and for patient 2 for <italic>N</italic> = 96. To characterise the samples, we first performed a separate clustering of the single HSCs from the two patients. For patient 1, 35 of the cells showed little or no expression for all genes and we thus hypothesise that they represent technical artifacts. Even though these cells had enough reads to pass the quality control (Methods), closer inspection revealed low diversity evidenced by the number of expressed genes (Fig. S16). The remaining 50 HSCs separated into three biologically meaningful distinct clusters (clusters 1-3 in Figs. 5a and Methods). In contrast, SC3 found only one cluster for the 96 cells from patient 2 (Methods).</p>
<p>To gain further insight into the clusters, we used previously published information derived from exome sequencing data<sup><xref ref-type="bibr" rid="c31">31</xref></sup> to determine driver mutations for both patients. This analysis identified one driver mutation in the Tet2 gene and one driver mutation in the Jak2V617F gene (Table S3). To assess the clonal composition of each patient, single HSCs were cultured to give rise to individual granulocyte/macrophage colonies, to which Sanger sequencing was applied to quantify the prevalence of both driver mutations. Interestingly, we identified three genotypes for patient 1: 30&#x0025; of the clones had no mutation, 50&#x0025; of the clones harboured a Tet2 mutation, and 20&#x0025; of the clones carried both a Tet2 and a Jak2V617F mutation (<xref ref-type="fig" rid="fig5">Fig. 5b</xref>). This ratio is reflected in the number of cells contributing to each of the three clusters identified by SC3 for patient 1 (<xref ref-type="fig" rid="fig5">Fig. 5a</xref>). Moreover, all clones grown up for patient 2 carried both a Tet2 and a Jak2V617F mutation (<xref ref-type="fig" rid="fig5">Fig. 5b</xref>). Again, this is reflected in the single cluster obtained for this patient from the scRNA-seq data. To compare both patients, we clustered all cells simultaneously (<xref ref-type="fig" rid="fig5">Fig. 5c</xref>). Strikingly, 10/11 cells from cluster 3 in patient 1 are grouped with the cells from patient 2, whereas clusters 1 and 2 from patient 1 remain separate. Thus, we hypothesise that cells in cluster 3 from patient 1 correspond to the double mutant clone. Taken together, these results demonstrate that SC3 is capable of extracting biologically relevant data from primary patient samples.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>SC3 clustering of scRNAseq data from patients.</title>
<p>(<bold>a</bold>) Heatmap of the expression (after Gene Filter and Log-transformation, Methods) of marker genes from clusters 1-3 from patient 1 (clusters 4 and 5 do not have any marker genes). Clusters correspond to <italic>k</italic> = 5 (Methods). (<bold>b</bold>) Clonal composition of patients 1 and 2 (Methods). (<bold>c</bold>) Heatmap of gene expression (after Gene Filter and Log-transformation, Methods) of a combined dataset (patient 1 &#x002B; patient 2). Clusters (separated by white vertical lines) correspond to <italic>k</italic> = 5 (Methods). Cells corresponding to patient 1 are indicated with the same colour as in panel (<bold>a</bold>). Cells from patient 2 are indicated in yellow. On the vertical axis, genes are clustered by <italic>k</italic>-means with <italic>k</italic> = 100 and the heatmap represents the expression levels of the cluster centers.</p>
</caption>
<graphic xlink:href="036558_fig5.tif"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have presented SC3, an interactive tool for unsupervised clustering of scRNA-seq data. By comparing to existing methods, we demonstrate that SC3 provides a highly accurate clustering for published datasets. For large datasets, SC3 employs a hybrid approach, which makes it possible to apply the method to very large experiments, e.g. Drop-seq<sup><xref ref-type="bibr" rid="c9">9</xref></sup>. Importantly, SC3 features a graphical user interface, making it interactive and user-friendly. SC3 also aids biological interpretation by identifying differentially expressed genes, marker genes, and outlier cells.</p>
<p>A major challenge when developing unsupervised clustering algorithms for scRNA-seq data is the lack of good mathematical models that can be used to generate realistic, synthetic surrogate datasets to benchmark the methods. Instead, we must rely on published datasets where the labels have been provided by the original authors. For some of the datasets (Ting, Patel and Klein), the labels are likely to be accurate since they correspond to cells taken from different tissues, patients or time-points. For the others, however, the labelling was based on a combination of the authors' clustering methods together with their biological knowledge. In these latter cases, the labelling is less reliable, and we cannot be certain that the original clustering is more meaningful than ours. Reassuringly, the degree of confidence in the original labels correlates well with the accuracy of SC3; for the datasets where the labels are almost certainly correct (Ting, Patel and Klein) SC3 obtains ARIs close to 1, whereas for the remaining, less certain datasets, SC3 reaches ARIs of &#x007E;0.8.</p>
<p>Another central problem of unsupervised clustering relates to the choice of the number of clusters, <italic>k.</italic> We investigated whether the internal measures of clustering quality, such as the Dunn<sup><xref ref-type="bibr" rid="c32">32</xref></sup> and Davies-Bouldin<sup><xref ref-type="bibr" rid="c33">33</xref></sup> indexes, can be used to choose <italic>K</italic>, but we did not find any correlation between them and the external indexes (Rand, ARI and Jaccard<sup><xref ref-type="bibr" rid="c34">34</xref></sup>)(Fig. S12). In addition, for many datasets (e.g. Pollen, Usoskin and Zeisel) there are at least two hierarchies present, and this is likely to be the case for most samples from complex tissues. Rather than identifying a single <italic>k</italic>, SC3 allows the user to interactively explore different options.</p>
<p>We applied SC3 to scRNA-seq data from two patients diagnosed with MPN. We found strong evidence in support of the hypothesis that the clusters identified by SC3 directly correspond to subclones that were previously characterised by independent experiments<sup><xref ref-type="bibr" rid="c35">35</xref></sup>. Importantly, SC3 can identify marker genes (<xref ref-type="fig" rid="fig5">Fig. 5a</xref>), thus making it possible to determine the impact of different mutations on the transcriptome. These analyses could aid in the development of novel therapies.</p>
<p>As sequencing costs decrease, larger scRNA-seq datasets will become increasingly available, furthering their potential to advance our understanding of biology. An exciting aspect of scRNA-seq is the possibility to address fundamental questions that were previously inaccessible, e.g. <italic>de novo</italic> identification of cell-types. However, the current lack of computational methods for analyzing scRNA-seq has made it difficult to exploit fully the information contained in such datasets. We have shown that SC3 is a versatile, accurate and user-friendly tool, which will facilitate the analysis of complex scRNA-seq datasets. We believe that SC3 can provide experimentalists with a hands-on tool that will help extract novel biological insights from such rich datasets.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Validation datasets</title>
<p>All validation datasets (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>), except the Pollen dataset, were acquired from the accessions provided in the original publications. The Pollen dataset<sup><xref ref-type="bibr" rid="c11">11</xref></sup> was acquired from personal communication with Alex A Pollen. When benchmarking against pcaReduce method <xref ref-type="fig" rid="fig1">Fig. 1</xref> we used this version of the Pollen data. However, in the original pcaReduce paper<sup><xref ref-type="bibr" rid="c7">7</xref></sup> an independent alignment of the data was performed. SC3 benchmarking of this version of the Pollen data is shown in Fig. S11.</p>
</sec>
<sec id="s4b">
<title>SC3 clustering</title>
<p>SC3 takes as input an expression matrix <italic><bold>M</bold></italic> where columns correspond to cells and rows correspond to genes. SC3 does not carry out any form of normalization or correction for batch effects. SC3 is based on seven elementary steps. These parameters can be easily adjusted by the user, but are set to sensible default values, determined via cross-validation on the Ting, Deng, Pollen and Usoskin datasets.</p>
<sec id="s4b1">
<label>1.</label>
<title>Cell Filter</title>
<p>The cell filter should be used if the quality of data is low, i.e. if one suspects that some of the cells may be technical outliers with poor coverage. The cell filter removes cells containing fewer than a specified number of non-zero genes. In our calculations the minimum number of expressed genes was set to 2,000. The Cell Filter was removed from the final algorithm since it only affected the results for the Treutlein dataset.</p>
</sec>
<sec id="s4b2">
<label>2.</label>
<title>Gene Filter</title>
<p>The gene filter removes genes that are either expressed or absent (expression value is less than 2) in at least 94&#x0025; of cells. The motivation for the gene filter is that ubiquitous and rare genes most often are not informative for the clustering.</p>
</sec>
<sec id="s4b3">
<label>3.</label>
<title>Log-transformation</title>
<p>For further analysis the filtered expression matrix <italic><bold>M</bold></italic> is log-transformed after adding a pseudo-count of 1: <italic><bold>M</bold></italic>&#x2019; = log2(<italic><bold>M</bold></italic> &#x002B; 1).</p>
</sec>
<sec id="s4b4">
<label>4.</label>
<title>Distance calculations</title>
<p>Distance between the cells, i.e. columns, in <italic><bold>M</bold></italic>&#x2019; are calculated using the Euclidean, Pearson and Spearman metrics to construct distance matrices.</p>
</sec>
<sec id="s4b5">
<label>5.</label>
<title>Transformations</title>
<p>All distance matrices are transformed using either principal component analysis (PCA), multidimensional scaling (MDS) or by calculating the eigenvectors of the graph Laplacian (Spectral). The columns of the resulting matrices are then sorted in descending order by their corresponding eigenvalues. MDS method was removed from the final algorithm because of poor performance.</p>
</sec>
<sec id="s4b6">
<label>6.</label>
<title>k-means</title>
<p><italic>k</italic>-means clustering is performed on the first <italic>d</italic> eigenvectors of the transformed distance matrices <xref ref-type="fig" rid="fig1">Fig. 1a</xref> by using the default kmeans() R function with the Hartigan and Wong algorithm<sup><xref ref-type="bibr" rid="c36">36</xref></sup>. The maximum number of iterations was set to 10<sup>9</sup> and the number of starts was set to 1,000 (see Fig. S7 for details on different parameter settings).</p>
</sec>
<sec id="s4b7">
<label>7.</label>
<title>Consensus clustering</title>
<p>SC3 computes a consensus matrix using the Cluster-based Similarity Partitioning Algorithm (CSPA)<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. For each clustering result (e.g. Labels(i,<italic>d</italic><sub>3</sub>) in <xref ref-type="fig" rid="fig1">Fig. 1a</xref>) a binary similarity matrix is constructed from the corresponding cell labels: if two cells belong to the same cluster, their similarity is 1, otherwise the similarity is 0. A consensus matrix is calculated by averaging all similarity matrices. This can be split in 2 steps:</p>
</sec>
<sec id="s4b8">
<label>7a.</label>
<title>Consensus over the d range (Consensus1)</title>
<p>SC3 calculates the consensus matrix over a range of <italic>d</italic> from 4&#x0025; to 7&#x0025; of <italic>N</italic>. Consensus over the <italic>d</italic> range is performed for each combination of distance measures and transformations (<xref ref-type="fig" rid="fig1">Fig. 1a</xref>). To reduce computational times, if the length of the <italic>d</italic> range (<italic>D</italic> on <xref ref-type="fig" rid="fig1">Fig. 1a</xref>) is more than 15, a random subset of 15 values selected uniformly from the <italic>d</italic> range is used. Note that consensus over the <italic>d</italic> range does not provide a single solution and further averaging is required.</p>
</sec>
<sec id="s4b9">
<label>7b.</label>
<title>Consensus over the parameter set (Consensus2)</title>
<p>Consensus over the parameter set takes multiple results of Consensus1 and includes additional averaging of similarity matrices over the distance measures and transformations.</p>
</sec>
<sec id="s4b10">
<label>7c.</label>
<title>Consensus clustering</title>
<p>The resulting consensus matrix (after Consensus1 and Consensus2) is clustered using hierarchical clustering with complete agglomeration and the clusters are inferred at the <italic>k</italic> level of hierarchy, where <italic>k</italic> is defined by a user (<xref ref-type="fig" rid="fig1">Fig. 1b</xref>).</p>
<p>Fig. S5 shows that the quality of clustering after Consensus2 is generally better than only after Consensus1.</p>
</sec>
</sec>
</sec>
<sec id="s5">
<title>Adjusted Rand Index</title>
<p>If cell-labels are available (e.g. from a published dataset) the Adjusted Rand Index (ARI)<sup><xref ref-type="bibr" rid="c37">37</xref></sup> can be used to calculate similarity between the SC3 clustering and the published clustering. Since the reference labels are known for all validation datasets, ARI is used for all comparisons throughout the paper. We also investigated the correlation between external (Rand index and Jaccard index<sup><xref ref-type="bibr" rid="c34">34</xref></sup>) and internal (Dunn index<sup><xref ref-type="bibr" rid="c32">32</xref></sup> and Davies-Bouldin index<sup><xref ref-type="bibr" rid="c33">33</xref></sup>) (Fig. S12) measures of clustering. An external index evaluates the clustering based on an external reference, whereas an internal index does not require any additional information. Even though external indexes were in a good agreement with each other, there was little or no correlation between external and internal indexes.</p>
</sec>
<sec id="s6">
<title>Benchmarking</title>
<p>Before benchmarking we applied the Gene Filter to all the datasets for tSNE&#x002B;k-means, SNN-Cliq and SINCERA. For pcaReduce no Gene Filter was used. For tSNE&#x002B;k-means, SNN-Cliq and pcaReduce we additionally applied Log-transformation as described above (<italic><bold>M</bold></italic>&#x2019; = log2(<italic><bold>M</bold></italic> &#x002B; 1)). For SINCERA we used the original z-score normalisation<sup><xref ref-type="bibr" rid="c10">10</xref></sup> instead of the Log-transformation.</p>
</sec>
<sec id="s7">
<title>Biological insights</title>
<sec id="s7a">
<title>Identification of differential expression</title>
<p>Differential expression is calculated using the non-parametric Kruskal-Wallis test)<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, an extension of the Mann-Whitney test for the scenario when there are more than two groups. A significant <italic>p</italic>-value indicates that gene expression in at least one cluster stochastically dominates one other cluster. SC3 provides a list of all differentially expressed genes with adjusted (using the default &#x201C;holm&#x201D; method of p.adjust() R function) <italic>p</italic>-values &#x003C; 0.01 and plots gene expression profiles of the 70 most significant differentially expressed genes. Note that the calculation of differential expression after clustering can introduce a bias in the distribution of <italic>p</italic>-values, and thus we advice to use the <italic>p</italic>-values for ranking genes only.</p>
</sec>
<sec id="s7b">
<title>Identification of marker genes</title>
<p>For each gene a binary classifier is constructed based on the mean cluster expression values. A classifier prediction is then calculated using the gene expression ranks and its ability to distinguish the cluster with the most highly ranked cells from the remaining clusters is assessed. The area under the receiver operating characteristic (ROC) curve is used to quantify the accuracy of the prediction. A <italic>p</italic>-value is assigned to each gene by using the Wilcoxon signed rank test comparing gene ranks in the cluster with the highest mean expression with all others (<italic>p</italic>-values are adjusted by using the default &#x201C;holm&#x201D; method of p.adjust() R function). The genes with the area under the ROC curve (AUROC) &#x003E; 0.85 and with the <italic>p</italic>-value &#x003C; 0.01 are defined as marker genes. The AUROC threshold was derived from 99&#x0025; quantile of the AUROC distributions obtained from 100 random permutations of cluster labels for all datasets (Table S1 and Fig. S13). SC3 provides a visualization of the gene expression profiles for the top 10 marker genes of each obtained cluster.</p>
</sec>
<sec id="s8c">
<title>Cell outlier detection</title>
<p>Outlier cells in each cluster are detected by first reducing the dimensionality of the cluster using the robust method for principal component analysis<sup><xref ref-type="bibr" rid="c38">38</xref></sup> Second, robust distances are calculated using the minimum covariance determinant (MCD)<sup><xref ref-type="bibr" rid="c23">23</xref></sup>. We then used a threshold based on 99.99&#x0025; quantile of the chi-squared distribution to define outliers. Finally we define an outlier score as the differences between the square root of the robust distance and the square root of the 99.99&#x0025; quantile of the chi-squared distribution. The outlier score is plotted as a barplot (Figs. 4d).</p>
</sec>
</sec>
<sec id="s9">
<title>Support Vector Machines (SVM)</title>
<p>When a dataset contains more than 1,000 cells, SC3 randomly selects and clusters 1,000 cells. Next, a support vector machine (SVM)<sup><xref ref-type="bibr" rid="c39">39</xref></sup> model with a linear kernel (this kernel provided the best clustering predictions, results from using other kernels - polynomial, radial and sigmoid - are shown in Figs. S8-S10) is constructed based on the obtained clustering. We used the <italic>svm</italic> function of the <italic>e1071</italic> R-package with default parameters. The cluster IDs for the remaining cells are then predicted by the SVM model.</p>
</sec>
<sec id="s10">
<title>Patients</title>
<p>Both patients provided written informed consent. Diagnoses were made in accordance with the guidelines of the British Committee for Standards in Haematology.</p>
<sec id="s10a">
<title>Isolation of haematopoietic stem and progenitor cells</title>
<p>Cell populations were derived from peripheral blood enriched for haematopoietic stem and progenitor cells (CD34&#x002B;, CD38-, CD45RA-, CD90&#x002B;), hereafter referred to as HSCs. For single cell cultures, individual HSCs were sorted into 96-well plates (Fig. S14) and grown in a cytokine cocktail designed to promote progenitor expansion as previously described<sup><xref ref-type="bibr" rid="c40">40</xref></sup>. For scRNA-seq studies, single HSCs were directly sorted into lysis buffer as described in Picelli et al<sup><xref ref-type="bibr" rid="c41">41</xref></sup>.</p>
</sec>
<sec id="s10b">
<title>Determination of mutation load</title>
<p>Colonies of granulocyte/macrophage composition were picked and DNA isolated for Sanger sequencing for Jak2V617F and Tet2 mutations as previously described Ortmann et al<sup><xref ref-type="bibr" rid="c35">35</xref></sup>.</p>
</sec>
<sec id="s10c">
<title>Single cell RNA-Sequencing</title>
<p>Single HSCs were sorted into 96-well plates and cDNA generated as described<sup><xref ref-type="bibr" rid="c41">41</xref></sup> Nextera XT library making kit was used for library generation as described in Picelli et al<sup><xref ref-type="bibr" rid="c41">41</xref></sup>.</p>
</sec>
<sec id="s10d">
<title>Processing of scRNA-seq data from HSCs</title>
<p>96 single cell samples per patient with 2 sequencing lanes per sample were sequenced yielding a variable number of reads (<italic>mean</italic>=2,180,357, <italic>std dev</italic>= 1,342,541). FastQC)<sup><xref ref-type="bibr" rid="c42">42</xref></sup> was used to assess the sequence quality. Foreign sequences from the Nextera Transposase agent were discovered and subsequently removed with Trimmomatic<sup><xref ref-type="bibr" rid="c43">43</xref></sup>. The reads were trimmed to 90 bases to remove low quality positions before being mapped with TopHat<sup><xref ref-type="bibr" rid="c44">44</xref></sup> to the Ensembl)<sup><xref ref-type="bibr" rid="c45">45</xref></sup> reference genome version GRCh38.77 augmented with the spike-in controls downloaded from the ERCC consortium<sup><xref ref-type="bibr" rid="c46">46</xref></sup> Quality control of the cells was performed similarly to Roshan M et al.<sup><xref ref-type="bibr" rid="c47">47</xref></sup> TPM (Transcripts per Million) values per gene per cell were calculated with RSEM<sup><xref ref-type="bibr" rid="c48">48</xref></sup> and compared with the percentage of aligned reads in order to detect and remove outlier cells from the analysis. Counts of the uniqely mapped reads in each gene were calculated using SeqMonk (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.bbsrc.ac.uk/projects/seqmonk">http://www.bioinformatics.bbsrc.ac.uk/projects/seqmonk</ext-link>) and were used for further downstream analysis (clustering).</p>
</sec>
<sec id="s10e">
<title>SC3 clustering of patient scRNA-seq data</title>
<p>We clustered scRNA-seq data from patient 1, patient 2 separately as well as a merged dataset containing data from both patients. For patient 1 the best clustering was achieved for <italic>k</italic> = 5 (Fig. S15a). In this case there are three meaningful clusters and two other clusters containing lowly expressed cells (the two clusters to the right Fig. S15b, <italic>k</italic> = 5). Data from patient 2 was homogeneous and we were not able to identify more than one meaningful cluster (Fig. S17). The combined dataset (patient 1 &#x002B; patient 2) was clustered for <italic>k</italic> in the range [2:5] (Fig. S18). For all values of <italic>k</italic> the majority of the cells from cluster 3 in patient 1 clustered together with the cells from patient 2. We selected <italic>k</italic> = 5 as a representative example (<xref ref-type="fig" rid="fig5">Fig. 5c</xref>) because in this case two other clusters (1 and 2) from patient 1 were also retrieved by SC3.</p>
</sec>
</sec>
<sec id="s11">
<title>Contributions</title>
<p>MH conceived the study; VK, MH, MS and TA contributed to the computational framework; KK and TC performed the experiments for the patient data; KN helped with the analysis of embryonic mouse data; MB, WR, AG and MH supervised the research; VK and MH led the writing of the manuscript with input from the other authors.</p>
</sec>
<sec id="s12">
<title>Accession Numbers</title>
<p>scRNA-seq data for patient 1 and 2 is available from GEO accession GSEXYZ (upload to be completed)</p>
</sec>
<sec id="s13" sec-type="availability">
<title>Software availability</title>
<p>The source code for SC3 is available under the GPL-3 licence at <ext-link ext-link-type="uri" xlink:href="https://github.com/hemberg-lab/SC3">https://github.com/hemberg-lab/SC3</ext-link> and the package &#x201C;SC3&#x201D; is currently under review at Bioconductor.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We would like to thank Borislav Vangelov, Jean-Charles Delvenne and Renaud Lambiotte for fruitful discussions and their help with computational methods. We would also like to thank David Flores Santa Cruz, Danai Dimitropolou and Jacob Grinfeld for technical assistance with experiments. We thank Ignacio Vasquez-Garcia, David Harmin, Michal Kosicki for helpful comments on the manuscript.</p>
<sec>
<title>Funding</title>
<p>Work in the Green lab is supported by Bloodwise (grant ref. 13003), the Wellcome Trust (grant ref. 104710/Z/14/Z), the Medical Research Council, the Kay Kendall Leukaemia Fund, the Cambridge NIHR Biomedical Research Center, the Cambridge Experimental Cancer Medicine Centre, the Leukemia and Lymphoma Society of America (grant ref. 07037), and a core support grant from the Wellcome Trust and MRC to the Wellcome Trust-Medical Research Council Cambridge Stem Cell Institute.</p>
</sec>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Gr&#x00FC;n</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Singlecell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source> <volume>525</volume>, <fpage>251</fpage>&#x2013;<lpage>255</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Jaitin</surname>, <given-names>D. A.</given-names></string-name> <etal>et al.</etal> <article-title>Massively parallel singlecell RNAseq for markerfree decomposition of tissues into cell types</article-title>. <source>Science</source> <volume>343</volume>, <fpage>776</fpage>&#x2013;<lpage>779</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Mahata</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Singlecell RNA sequencing reveals T helper cells synthesizing steroids de novo to contribute to immune homeostasis</article-title>. <source>Cell Rep.</source> <volume>7</volume>, <fpage>1130</fpage>&#x2013;<lpage>1142</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Coons</surname>, <given-names>A. H.</given-names></string-name>, <string-name><surname>Creech</surname>, <given-names>H. J.</given-names></string-name> &#x0026; <string-name><surname>Jones</surname>, <given-names>R. N.</given-names></string-name> <article-title>Immunological Properties of an Antibody Containing a Fluorescent Group</article-title>. <source>Exp. Biol. Med.</source> <volume>47</volume>, <fpage>200</fpage>&#x2013;<lpage>202</lpage> (<year>1941</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Fulwyler</surname>, <given-names>M. J.</given-names></string-name> <article-title>Electronic separation of biological cells by volume</article-title>. <source>Science</source> <volume>150</volume>, <fpage>910</fpage>&#x2013;<lpage>911</lpage> (<year>1965</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Xu</surname>, <given-names>C.</given-names></string-name> &#x0026; <string-name><surname>Su</surname>, <given-names>Z.</given-names></string-name> <article-title>Identification of cell types from singlecell transcriptomes using a novel clustering method</article-title>. <source>Bioinformatics</source> (<year>2015</year>). doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id></mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Zurauskiene</surname>, <given-names>J.</given-names></string-name> &#x0026;<string-name><surname>Yau</surname>, <given-names>C.</given-names></string-name> <article-title>pcaReduce: Hierarchical Clustering of Single Cell Transcriptional Profiles</article-title>. <source>bioRxiv</source> 026385 (<year>2015</year>). doi: <pub-id pub-id-type="doi">10.1101/026385</pub-id></mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Zeisel</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by singlecell RNAseq</article-title>. <source>Science</source> <volume>347</volume>, <fpage>1138</fpage>&#x2013;<lpage>1142</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Macosko</surname>, <given-names>E. Z.</given-names></string-name> <etal>et al.</etal> <article-title>Highly Parallel Genomewide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source> <volume>161</volume>, <fpage>1202</fpage>&#x2013;<lpage>1214</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Guo</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Potter</surname>, <given-names>S. S.</given-names></string-name>, <string-name><surname>Whitsett</surname>, <given-names>J. A.</given-names></string-name> &#x0026; <string-name><surname>Xu</surname>, <given-names>Y.</given-names></string-name> <article-title>SINCERA: A Pipeline for SingleCell RNASeq Profiling Analysis</article-title>. <source>PLoS Comput. Biol.</source> <volume>11</volume>, <fpage>e1004575</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Pollen</surname>, <given-names>A. A.</given-names></string-name> <etal>et al.</etal> <article-title>Lowcoverage singlecell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat. Biotechnol.</source> <volume>32</volume>, <fpage>1053</fpage>&#x2013;<lpage>1058</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Usoskin</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Unbiased classification of sensory neuron types by largescale singlecell RNA sequencing</article-title>. <source>Nat. Neurosci.</source> <volume>18</volume>, <fpage>145</fpage>&#x2013;<lpage>153</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Treutlein</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using singlecell RNAseq</article-title>. <source>Nature</source> <volume>509</volume>, <fpage>371</fpage>&#x2013;<lpage>375</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Ting</surname>, <given-names>D. T.</given-names></string-name> <etal>et al.</etal> <article-title>Singlecell RNA sequencing identifies extracellular matrix gene expression by pancreatic circulating tumor cells</article-title>. <source>Cell Rep.</source> <volume>8</volume>, <fpage>1905</fpage>&#x2013;<lpage>1918</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Deng</surname>, <given-names>Q.</given-names></string-name>, <string-name><surname>Ramsk&#x00F6;ld</surname>, <given-names>D.</given-names></string-name>,<string-name><surname>Reinius</surname>, <given-names>B.</given-names></string-name> &#x0026; <string-name><surname>Sandberg</surname>, <given-names>R.</given-names></string-name> <article-title>Singlecell RNAseq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>. <source>Science</source> <volume>343</volume>, <fpage>193</fpage>&#x2013;<lpage>196</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Patel</surname>, <given-names>A. P.</given-names></string-name> <etal>et al.</etal> <article-title>Singlecell RNAseq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source> <volume>344</volume>, <fpage>1396</fpage>&#x2013;<lpage>1401</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Klein</surname>, <given-names>A. M.</given-names></string-name> <etal>et al.</etal> <article-title>Droplet Barcoding for SingleCell Transcriptomics Applied to Embryonic Stem Cells</article-title>. <source>Cell</source> <volume>161</volume>, <fpage>1187</fpage>&#x2013;<lpage>1201</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Strehl</surname>, <given-names>A.</given-names></string-name> &#x0026;<string-name><surname>Ghosh</surname>, <given-names>J.</given-names></string-name> <article-title>Cluster Ensembles a Knowledge Reuse Framework for Combining Multiple Partitions</article-title>. <source>J. Mach. Learn. Res.</source> <volume>3</volume>, <fpage>583</fpage>&#x2013;<lpage>617</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>van der Maaten</surname>, <given-names>L.</given-names></string-name> &#x0026; <string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name> <article-title>Visualizing Data using tSNE</article-title>. <source>J. Mach. Learn. Res.</source> <volume>9</volume>, <fpage>2579</fpage>&#x2013;<lpage>2605</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Pan</surname>, <given-names>V. Y.</given-names></string-name> &#x0026; <string-name><surname>Chen</surname>, <given-names>Z. Q.</given-names></string-name> <article-title>The Complexity of the Matrix Eigenproblem. in</article-title> <source>Proceedings of the Thirtyfirst Annual ACM Symposium on Theory of Computing</source> <fpage>507</fpage>&#x2013;<lpage>516</lpage> (ACM, 1999).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Rousseeuw</surname>, <given-names>P. J.</given-names></string-name> <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J. Comput. Appl. Math.</source> <volume>20</volume>, <fpage>53</fpage>&#x2013;<lpage>65</lpage> (<year>1987</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Kruskal</surname>, <given-names>W. H.</given-names></string-name> &#x0026; <string-name><surname>Wallis</surname>, <given-names>W. A.</given-names></string-name> <article-title>Use of Ranks in OneCriterion Variance Analysis</article-title>. <source>J. Am. Stat. Assoc.</source> <volume>47</volume>, <fpage>583</fpage>&#x2013;<lpage>621</lpage> (<year>1952</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Hubert</surname>, <given-names>M.</given-names></string-name> &#x0026; <string-name><surname>Debruyne</surname>, <given-names>M.</given-names></string-name> <article-title>Minimum covariance determinant</article-title>. <source>WIREs Comp Stat</source> <volume>2</volume>, <fpage>36</fpage>&#x2013;<lpage>43</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Kirov</surname>, <given-names>S.</given-names></string-name> &#x0026; <string-name><surname>Snoddy</surname>, <given-names>J.</given-names></string-name> <article-title>WebGestalt: an integrated system for exploring gene sets in various biological contexts</article-title>. <source>Nucleic Acids Res.</source> <volume>33</volume>, <fpage>W741</fpage>&#x2013;<lpage>8</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Guo</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title>Resolution of cell fate decisions revealed by singlecell gene expression analysis from zygote to blastocyst</article-title>. <source>Dev. Cell</source> <volume>18</volume>, <fpage>675</fpage>&#x2013;<lpage>685</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>C. M.</given-names></string-name> <etal>et al.</etal> <article-title>The mouse Gene Expression Database (GXD): 2014 update</article-title>. <source>Nucleic Acids Res.</source> <volume>42</volume>, D<fpage>818</fpage>&#x2013;<lpage>24</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Wiekowski</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Miranda</surname>, <given-names>M.</given-names></string-name>,<string-name><surname>Nothias</surname>, <given-names>J. Y.</given-names></string-name> &#x0026; <string-name><surname>DePamphilis</surname>, <given-names>M. L.</given-names></string-name> <article-title>Changes in histone synthesis and modification at the beginning of mouse development correlate with the establishment of chromatin mediated repression of transcription</article-title>. <source>J. Cell Sci.</source> <volume>110</volume> (Pt 10), <fpage>1147</fpage>&#x2013;<lpage>1158</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Boroviak</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>LineageSpecific Profiling Delineates the Emergence and Progression of Naive Pluripotency in Mammalian Embryogenesis</article-title>. <source>Dev. Cell</source> <volume>35</volume>, <fpage>366</fpage>&#x2013;<lpage>382</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Blakeley</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title>Defining the three cell lineages of the human blastocyst by singlecell RNAseq</article-title>. <source>Development</source> <volume>142</volume>, <fpage>3151</fpage>&#x2013;<lpage>3165</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Staudt</surname>, <given-names>L. M.</given-names></string-name> &#x0026;<string-name><surname>Green</surname>, <given-names>A. R.</given-names></string-name> <article-title>Janus kinase deregulation in leukemia and lymphoma</article-title>. <source>Immunity</source> <volume>36</volume>, <fpage>529</fpage>&#x2013;<lpage>541</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Nangalia</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Somatic CALR mutations in myeloproliferative neoplasms with nonmutated JAK2</article-title>. <source>N. Engl. J. Med.</source> <volume>369</volume>, <fpage>2391</fpage>&#x2013;<lpage>2405</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Dunn</surname>, <given-names>J. C.</given-names></string-name> <article-title>A Fuzzy Relative of the ISODATA Process and Its Use in Detecting Compact WellSeparated Clusters</article-title>. <source>Journal of Cybernetics</source> <volume>3</volume>, <fpage>32</fpage>&#x2013;<lpage>57</lpage> (<year>1973</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Davies</surname>, <given-names>D. L.</given-names></string-name> &#x0026;<string-name><surname>Bouldin</surname>, <given-names>D. W.</given-names></string-name><article-title>A cluster separation measure</article-title>. <source>IEEE Trans. Pattern Anal. Mach. Intell.</source> <volume>1</volume>, <fpage>224</fpage>&#x2013;<lpage>227</lpage> (<year>1979</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Jaccard</surname>, <given-names>P.</given-names></string-name> <article-title>Distribution de la Flore Alpine dans le Bassin des Dranses et dans quelques r&#x00E9;gions voisines</article-title>. <source>Bulletin de la Societe Vaudoise des Sciences Naturelles</source> <volume>37</volume>, <fpage>241</fpage>&#x2013;<lpage>272</lpage> (<year>1901</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Ortmann</surname>, <given-names>C. A.</given-names></string-name> <etal>et al.</etal> <article-title>Effect of mutation order on myeloproliferative neoplasms</article-title>. <source>N. Engl. J. Med.</source> <volume>372</volume>, <fpage>601</fpage>&#x2013;<lpage>612</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Hartigan</surname>, <given-names>J. A.</given-names></string-name> &#x0026; <string-name><surname>Wong</surname>, <given-names>M. A.</given-names></string-name> <article-title>Algorithm AS 136: A KMeans Clustering Algorithm</article-title>. <source>J. R. Stat. Soc. Ser. C Appl. Stat.</source> <volume>28</volume>, <fpage>100</fpage>&#x2013;<lpage>108</lpage> (<year>1979</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Rand</surname>, <given-names>W. M.</given-names></string-name> <article-title>Objective Criteria for the Evaluation of Clustering Methods</article-title>. <source>J. Am. Stat. Assoc.</source> <volume>66</volume>, <fpage>846</fpage>&#x2013;<lpage>850</lpage> (<year>1971</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Hubert</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Rousseeuw</surname>, <given-names>P. J.</given-names></string-name> &#x0026; <string-name><surname>Branden</surname>, <given-names>K. V.</given-names></string-name> <article-title>ROBPCA: A New Approach to Robust Principal Component Analysis</article-title>. <source>Technometrics</source> <volume>47</volume>, <fpage>64</fpage>&#x2013;<lpage>79</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>BenHur</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Horn</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Siegelmann</surname>, <given-names>H. T.</given-names></string-name> &#x0026;<string-name><surname>Vapnik</surname>, <given-names>V.</given-names></string-name> <article-title>Support Vector Clustering</article-title>. <source>J. Mach. Learn. Res.</source> <volume>2</volume>, <fpage>125</fpage>&#x2013;<lpage>137</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Petzer</surname>, <given-names>A. L.</given-names></string-name>, <string-name><surname>Zandstra</surname>, <given-names>P. W.</given-names></string-name>, <string-name><surname>Piret</surname>, <given-names>J. M.</given-names></string-name> &#x0026; <string-name><surname>Eaves</surname>, <given-names>C. J.</given-names></string-name> <article-title>Differential cytokine effects on primitive (CD34&#x002B;CD38) human hematopoietic cells: novel responses to Flt3ligand and thrombopoietin</article-title>. <source>J. Exp. Med.</source> <volume>183</volume>, <fpage>2551</fpage>&#x2013;<lpage>2558</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Picelli</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Fulllength RNAseq from single cells using Smartseq2</article-title>. <source>Nat. Protoc.</source> <volume>9</volume>, <fpage>171</fpage>&#x2013;<lpage>181</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Andrews</surname>, <given-names>S.</given-names></string-name> <article-title>FastQC: A quality control tool for high throughput sequence data</article-title>. <source>Reference Source</source> (<year>2010</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Bolger</surname>, <given-names>A. M.</given-names></string-name>,<string-name><surname>Lohse</surname>, <given-names>M.</given-names></string-name> &#x0026; <string-name><surname>Usadel</surname>, <given-names>B.</given-names></string-name> <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source> <volume>30</volume>, <fpage>2114</fpage>&#x2013;<lpage>2120</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname>, <given-names>C.</given-names></string-name>,<string-name><surname>Pachter</surname>, <given-names>L.</given-names></string-name> &#x0026; <string-name><surname>Salzberg</surname>, <given-names>S. L.</given-names></string-name> <article-title>TopHat: discovering splice junctions with RNASeq</article-title>. <source>Bioinformatics</source> <volume>25</volume>, <fpage>1105</fpage>&#x2013;<lpage>1111</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Cunningham</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Ensembl 2015</article-title>. <source>Nucleic Acids Res.</source> <volume>43</volume>, D<fpage>662</fpage>&#x2013;<lpage>9</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Baker</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal> <article-title>The External RNA Controls Consortium: a progress report</article-title>. <source>Nat. Methods</source> <volume>2</volume>, <fpage>731</fpage>&#x2013;<lpage>734</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Kumar</surname>, <given-names>R. M.</given-names></string-name> <etal>et al.</etal> <article-title>Deconstructing transcriptional heterogeneity in pluripotent stem cells</article-title>. <source>Nature</source> <volume>516</volume>, <fpage>56</fpage>&#x2013;<lpage>61</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>B.</given-names></string-name> &#x0026; <string-name><surname>Dewey</surname>, <given-names>C. N.</given-names></string-name> <article-title>RSEM: accurate transcript quantification from RNASeq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>, <fpage>323</fpage> (<year>2011</year>).</mixed-citation></ref>
</ref-list>
</back>
</article>