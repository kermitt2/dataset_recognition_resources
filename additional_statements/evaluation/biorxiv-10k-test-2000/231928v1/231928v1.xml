<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/231928</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Genetics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Funmap2: an R package for QTL mapping using longitudinal phenotypes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author"><name><surname>Wang</surname><given-names>Nating</given-names></name><xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author"><name><surname>Chu</surname><given-names>Tinyi</given-names></name><xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author"><name><surname>Luo</surname><given-names>Jiangtao</given-names></name><xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author"><name><surname>Wu</surname><given-names>Rongling</given-names></name><xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author"><name><surname>Wang</surname><given-names>Zhong</given-names></name><xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>College of Biological Sciences and Technology, Beijing Forestry University</institution>, Beijing 100083, <country>PR China</country></aff>
<aff id="a2"><label>2</label><institution>Graduate field of Computational Biology, Cornell University</institution>, Ithaca, NY 14850, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biostatistics, College of Public Health, University of Nebraska Medical Center</institution>, Omaha, NE 68198, <country>USA</country></aff>
</contrib-group>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date><elocation-id>231928</elocation-id>
<history>
<date date-type="received">
<day>09</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>09</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>12</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="231928.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>QTL mapping is a powerful tool to infer the complexity of the genetic architecture underlying phenotypic traits, and has been extended to include longitudinal traits measured at multiple temporal/spatial points. Here, we introduce the R package <italic>Funmap2</italic> based on the functional mapping framework, which integrates biological prior knowledge into the statistical model. Specifically, the functional mapping framework is engineered to include longitudinal curves that describes the genetic effects, and the covariance matrix of the trait of interest. <italic>Funmap2</italic> may automatically choose the type of longitudinal curve and covariance matrix by information criterion. <italic>Funmap2</italic> is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2">https://github.com/wzhy2000/Funmap2</ext-link>.</p>
</abstract>
<counts>
<page-count count="12"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Introduction</title>
<p>The advance in molecular biology has dramatically increased the number of molecular markers available to reveal the genome structure and organization of any organism. QTL mapping exploits these markers to identify the genomic regions associated with the quantitative traits within an inbred population. In the past 20 years, a variety of statistical models have been developed to detect QTLs, greatly facilitating the narrowing down of the genomic regions that control the biological traits. In addition to the study of additive and dominant effects, QTL mapping has been successfully applied to the epistasis effects, allometric growth and pleiotropic effects.</p>
<p>Lander and Botstein (<xref ref-type="bibr" rid="c6">Lander 1989</xref>) established tractable statistical methodologies to map QTL on one chromosomal interval bracketed by two flanking markers, known as interval mapping method. Later composite interval mapping improved interval mapping by including markers from other intervals as covariates to control the overall genetic background (<xref ref-type="bibr" rid="c3">Jiang, and Zeng, 1995</xref>). In 1999, Kao et al. proposed the simultaneous use of multiple marker intervals to map multiple QTL of epistatic interactions throughout a linkage map. Since then, applications of QTLs mapping in complicated genetic and genomic problems have boomed.</p>
<p>Albeit the advance in mapping resolution and extension to more complicated mapping problems, conventional mapping approaches are restricted to phenotypic data measured at a single time point. In many important biological problems, however, genotypes that control longitudinal traits, such as those measured during developmental process and environmental changes, cannot be effectively accommodated under the framework of single trait QTL mapping. Several approaches (<xref ref-type="bibr" rid="c11">Ma et al. 2002</xref>, <xref ref-type="bibr" rid="c20">Wu et al. 2002</xref>, <xref ref-type="bibr" rid="c24">Yang et al. 2006</xref>) have been developed for QTL mapping on such traits. Functional mapping (<xref ref-type="bibr" rid="c11">Ma et al. 2002</xref>, <xref ref-type="bibr" rid="c19">Wu and Lin 2006</xref>, <xref ref-type="bibr" rid="c14">Sun et al. 2015</xref>) is a statistical framework derived to map genes that control the dynamic biological process of complex traits. In this framework, a mixture model is fitted using EM algorithm through maximizing likelihood, followed by hypothesis testing the significance of association. In addition, model parameters describing growth trajectories can also be estimated. Functional Mapping has shown remarkable performance in associating QTLs with dynamic traits in plant (<xref ref-type="bibr" rid="c27">Zhao et al. 2004b</xref>, <xref ref-type="bibr" rid="c10">Li et al. 2010b</xref>, <xref ref-type="bibr" rid="c25">Yang et al. 2011</xref>; <xref ref-type="bibr" rid="c13">Sillanpaa et al. 2012</xref>), animal (<xref ref-type="bibr" rid="c26">Zhao et al. 2004a</xref>, <xref ref-type="bibr" rid="c21">Xiong et al. 2011</xref>) and human (<xref ref-type="bibr" rid="c8">Li et al. 2009</xref>), and its application can be extended to genetic dissection of developmental process, including growth trajectory and allometric scaling (<xref ref-type="bibr" rid="c12">Ma et al. 2003</xref>, <xref ref-type="bibr" rid="c7">Li 2014</xref>), phenotypic plasticity based on gene-environment interaction (<xref ref-type="bibr" rid="c18">Wang et al. 2013b</xref>), drug response (<xref ref-type="bibr" rid="c18">Wang et al 2013b</xref>), and morphological shape (<xref ref-type="bibr" rid="c2">Fu et al. 2013</xref>). Recently, the integration of functional mapping and differential equations (<xref ref-type="bibr" rid="c1">Fu et al. 2011</xref>; <xref ref-type="bibr" rid="c18">Wang et al 2013b</xref>) have also been applied to widely emergent applications of dynamic systems.</p>
<p>The <italic>Funmap2</italic> package is developed to identify QTLs for a longitudinal trait based on functional mapping. It is implemented as a package for the freely accessible statistical software R. <italic>Funmap2</italic> implements a complete pipeline which includes data loading, QTLs scanning, significance value computing and significant QTLs reporting. The essence of functional mapping lies on the longitudinal curve of genetic effects and the covariance matrix that characterize longitudinal relationship of the trait. Although a logistic curve may describe the genetic effects in most of biological processes, that of reaction norm in continuously varying environment problem may not follow sigmoid shape. To address this, <italic>Funmap2</italic> provides sigmoid, Legendre, Pharmacology as the built-in resource, and it also allows users to customize the curve equation. Furthermore, to increase the statistical power, the covariance matrix can be chosen from several covariance structures used in IBM SPSS software, such as autoregressive, ante-dependence, or autoregressive moving average (<xref ref-type="bibr" rid="c9">Li et al 2010a</xref>). Considering the difficulty to know which combination of curve shape and covariance structure is the best for a longitudinal trait beforehand, we enable <italic>Funmap2</italic> to automatically choose the best curve shape and covariance structure from the built-in resource based on information criterion.</p>
<p>In addition to statistical analysis, <italic>Funmap2</italic> generates a publication-level report that visualize all results, including phenotype traits, QTL profile, significant QTL curve, and the permutation result. Additionally, the package provides a simulation module for testing the performance and demonstrating the use of the <italic>Funmap2</italic> on data generated by different models. Empirically, we observe the robust performance of <italic>Funmap2</italic> on simulated data with inheritability greater than 5&#x0025;.</p>
<p>To the best of our knowledge, <italic>Funmap2</italic> is the only QTL mapping tool available for the longitudinal traits with open source software license. It is publicly available under an open-source software license: <ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2">https://github.com/wzhy2000/Funmap2</ext-link>. In the following sections, we give a brief review of functional mapping in term of its statistical model. Then we focus on the detailed workflow of <italic>Funmap2</italic>. Lastly, we provide one example with codes and figures.</p>
</sec>
<sec id="s2"><title>Statistical Methods</title>
<p>Functional mapping is a statistical framework aiming at identifying QTLs that are significantly associated with a longitudinal phenotype of interest on an experiment population, such as recombinant inbred lines (RIL) and doubled-haploid (DH) population. Functional mapping computes maximum likelihood estimation (MLE) of mixture models that integrate the likelihood over QTL genotypes. The model also accounts for the 1) longitudinal trend of the trait using a continuous curve, i.e. growth trajectory for time-dependent traits and reaction norm for environment-dependent traits, and 2) internal correlation of traits across longitudinal measurement using a covariance matrix.</p>
<p>The model assumes that the longitudinal trend of the trait follows a particular mathematic curve. In statistical setting, the phenotypes of the trait at all time points follow a multivariate normal distribution, which therefore can be described by the following <xref ref-type="disp-formula" rid="eqn1">equation (1)</xref>:
<disp-formula id="eqn1"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_eqn1.gif"/></alternatives></disp-formula>
</p>
<p>Assuming that y<sub>i</sub> is a vector of measured values for individual <italic>i</italic> at <italic>m</italic> time points, which describes the phenotypic values; g<sub>j</sub> denotes the overall mean vector for genotype <italic>j</italic>, and is described as a mathematic curve, X<sub>i</sub> denotes the covariate for individual <italic>i</italic>, &#x03B1; is a vector of coefficient value for each covariate, &#x03A3; is the covariance matrix. Therefore, f<sub>j</sub>(y<sub>i</sub>) is probability density function relating the measured traits of individual <italic>i</italic> to the combination of the genetic effects contributed by genotype <italic>j</italic> and covariates effects of individual <italic>i.</italic></p>
<p>The estimated likelihood of genotype <italic>j</italic> for individual <italic>i</italic> are summed, weighted by corresponding conditional probability of QTL genotype given the adjacent marker and inbred type. The functional mapping method hence formulates the likelihood calculation of the mixture model as:
<disp-formula id="eqn2"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_eqn2.gif"/></alternatives></disp-formula>
where each element p<sub>ij</sub> indicating the genotypic possibility of subject <italic>i</italic> for gene <italic>j</italic> (QQ, Qq or qq), <italic>N</italic> denoting the individual number in the experiment population, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_inline1.gif"/></alternatives></inline-formula> denoting the random variables in this log likelihood function including covariate coefficient, curve parameters for multiple genotype, and covariance parameters. In <xref ref-type="disp-formula" rid="eqn2">equation (2)</xref>, we prefer to use log likelihood function.</p>
<p>The likelihood function for the null hypothesis model, in which QTL does not affect the trait, is built as follows,
<disp-formula id="eqn3"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_eqn3.gif"/></alternatives></disp-formula>
where f<sub>0</sub>(y<sub>i</sub>) differs from (1) in g<sub>j</sub> by assuming the same longitudinal curve for all genotypes. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_inline2.gif"/></alternatives></inline-formula> denotes the estimated parameters in this log likelihood function.</p>
<p>The goal of functional mapping is to compute log likelihood ratio (LR) for each QTL, defined by the following equation, and then to choose the significant QTL with high value of LR.
<disp-formula id="eqn4"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_eqn4.gif"/></alternatives></disp-formula>
</p>
<p>Intuitively, the null hypothesis H<sub>0</sub> is that there is no gene that controls the growth process, and the alternative hypothesis H<sub>1</sub> is the growth processes are different across the QTL genotypes. Where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_inline3.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="231928_inline4.gif"/></alternatives></inline-formula> are the maximum likelihood estimates of parameters under the hypothesis H<sub>0</sub> and H<sub>1</sub> respectively.</p>
<p>To do log-likelihood ratio test on complicated statistical models like the one used in functional mapping, permutation test is usually used to derive and compare against the null distribution. Whereas permutation test is generally applicable to various models, it is computationally intensive to implement. To address this, we propose a new approach called filtering method, to improve the computational efficiency of a permutation test. We first quantify the correlation between QTL and longitudinal data, using a genotype-oriented curve clustering method. Then, the QTLs which are highly correlated with the outcome were computed in the improved permutation tests (<xref ref-type="bibr" rid="c15">Wang et al, 2017</xref>). As a result, it significantly reduces the amount of computation in permutation tests and speeds up the computation for data analysis in functional mapping.</p>
</sec>
<sec id="s3"><title>Package Workflow</title>
<p>The <italic>Funmap2</italic> package is an open source package for R with automated data analysis for identifying the significant QTLs for longitudinal traits measured. The <italic>Funmap2</italic> pipeline includes modules for data import, curve fitting, QTL scanning, MLE computation, hypothesis testing, and data visualization. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the workflow of <italic>Funmap2</italic>, with the left column being the analysis steps and the right column being the corresponding output obtained in each step.</p>
<fig id="fig1" position="float"><label>Figure 1:</label>
<caption><title>Workflow</title></caption>
<graphic xlink:href="231928_fig1.tif"/></fig>
<p>User may either run the entire <italic>Funmap2</italic> workflow in one function call or step-by-step with customization. Often it is more convenient to call the main function <italic>FM2.pipe</italic> which automatically implements all tasks and outputs the summary information and figures in PDF format. In this function, sub-modules are called successively, functions involved include data loading (<italic>FM2.load.data</italic>), data estimation (<italic>FM2.estimate.data</italic>) for curve fitting and covariance selection, QTL scanning (<italic>FM2.qtlscan</italic>), permutation (<italic>FM.permutation)</italic>, and report generating (<italic>FM2.report</italic>). The typical calling is shown below.</p>
<boxed-text id="bx1" position="float">
<sec>
<p><monospace>&#x0023; Call the pipeline in parallel computing.</monospace></p>
<p><monospace>r &#x003C;- FM2.pipe(file.pheno.csv, NULL, file.geno.csv, file.marker.csv, &#x201C;BC&#x201D;</monospace>,</p>
<p><monospace>curve.type&#x003D;&#x201C;logistic&#x201D;</monospace>,</p>
<p><monospace>covar.type&#x003D;&#x201C;auto&#x201D;</monospace>,</p>
<p><monospace>options&#x003D;list(n.cores&#x003D;10));</monospace></p>
</sec>
</boxed-text>
<p><italic>Funmap2</italic> requires users to provide experiment data and specifying several parameters. Phenotype file containing longitudinal traits, one genotype maker file for the experiment population, and one genetic marker information file are required. Covariate file is optional and is not provided in the above example. In addition to these experiment data, users need to specify the cross type of QTL mapping. 4 available types are provided in <italic>Funmap2</italic>, Backcrossing, F2, RIL and DH. Noted that in this automated run, user may either let <italic>Funmap2</italic> choose the optimal curve type and covariance structure or specify their values as functional arguments.</p>
<p>Alternatively, the data analysis can be conducted by the customizing workflow by successively running sub-modules of <italic>Funmap2</italic>, as illustrated below.</p>
<sec id="s3a"><label>3.1</label><title>Data Loading</title>
<p>Input files for <italic>Funmap2</italic>, including the marker definition file, the genetic marker file, the phenotype file, and the covariate file, should be in CSV format. The function <italic>FM2.load.data</italic> reads these data files, checks the correctness of data format and the consistency of Individual IDs across all files and finally returns a data object wrapper in S3 class. Phenotypic traits, as well as curves describing longitudinal trend (if <monospace>curve.type</monospace> is specified) can be visualized by directly calling plot function on the returned S3 object.</p>
</sec>
<sec id="s3b"><label>3.2</label><title>Curve Fitting &#x0026; Covariance Matrix Selection</title>
<p>The function <italic>FM2.estimate.data</italic> may be invoked to facilitate the manual selection of curve type and covariance structure. The most commonly used curve function is sigmoid, and is generally used to characterize growth curves of biological organisms. Curves other than sigmoid, such as those describing environment-dependent traits for which reaction norms are measured, are also provided. In total, <italic>Funmap2</italic> software implements 9 curves in the current version, including logistic, composite, and those generated by nonparametric method. When running the automated mode, i.e. curve type is not specified during the data loading, least square curve fitting followed by AIC (Akaike Information criterion) and BIC (Bayesian Information criterion) is used to determine the best curve type.</p>
<p>The internal correlation of traits measured at different longitudinal points are described using the covariance matrix, which is essential in the likelihood calculation. We included a comprehensive set of 13 covariance matrices including those employed by SPSS software and first order ante-dependence (Yap et al 2005). <italic>Funmap2</italic> also implements an automated way of selecting covariance matrix by AIC and MLE method. Users should be cautious of the cost of computational time when over-parametrizing the covariance matrix.</p>
</sec>
<sec id="s3c"><label>3.3</label><title>QTL Scanning</title>
<p>The function <italic>FM2.qtlscan</italic> estimates QTL effects as well as parameters that characterize longitudinal trend curve by scanning across all QTL positions. Specifically, the function conducts H<sub>0</sub> and H<sub>1</sub> hypothesis by MLE method and calculates LR2 values in <xref ref-type="disp-formula" rid="eqn4">Equation 4</xref> at each QTL marker at every 1 cM position. The MLE method also outputs covariate coefficients, curve and parameter that optimizes the log likelihood. When finished, <italic>FM2.qtlscan</italic> by default generates the LR2 profile figure and highlight QTLs with the highest LR2 value on each chromosome. To determine the significant QTLs, user will need to run the permutation test (see the following section).</p>
</sec>
<sec id="s3d"><label>3.4</label><title>Permutation test</title>
<p>The distribution of log-likelihood ratio is difficult to be derived in analytical forms, especially for complicated distribution functions. To overcome this difficulty, a permutation test is generally used to obtain the null distribution and declare statistical significance of a QTL. One commonly encountered issue with permutation test, however, is the high cost of computational time, which becomes especially prominent when running on whole genome scale. The function <italic>FM.permutation</italic> includes two methods to address this issue. The first option is parallelization the computation in unix-based operating systems provided that multiple processor threads are available. The second one is to apply filtering method to reduce the computational intensity. This is done by pre-selecting the candidate QTLs with high QTL-trait correlation.</p>
</sec>
<sec id="s3e"><label>3.5</label><title>Report</title>
<p>The resulting objects returned by individual functions contain summarizing information (by the summary function), and can be visualized by the plot function. In addition, <italic>Fumap2</italic> includes the function <italic>FM2.report</italic> that can automatically generate reports, including tiled/overlapping curves describing the longitudinal trait, LR profile for all chromosomes, LR2 profile for QTL position and the curve for QTL position.</p>
</sec>
</sec>
<sec id="s4"><title>Results</title>
<p>We use a data set from poplar as an example. The data are composed of 90 backcross individuals with 22 linkage groups and 275 molecular markers. The phenotypic values were measures throughout 11 years. The code for analyzing the data is shown below, and the results for QTL mapping are plotted in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p>
<fig id="fig2" position="float"><label>Figure 2:</label>
<caption><title>LR profile for QTL position Profile of the likelihood ratio (LR) for one chromosome with 8 markers, with their names and genetic distance for each interval highlighted at the bottom. The peak with LR&#x003D;52 at interval [CA/CCC-640R&#x2014;CG/CCC-825] is discernible at 12 cM, suggesting a potential loci for significant QTL.</title></caption>
<graphic xlink:href="231928_fig2.tif"/></fig>
<fig id="fig3" position="float"><label>Figure 3:</label>
<caption><title>Logistic growth curves Growth curve for QTL selected from <xref ref-type="fig" rid="fig2">figure 2</xref>. Logistic curve is chosen by curve fitting. The curve is colored by genotype. Noted that two genotypes show similar growth at early stages, but diverge at later stages, suggesting a QTL associated with growth kinetics.</title></caption>
<graphic xlink:href="231928_fig3.tif"/></fig>
<boxed-text id="bx2" position="float">
<sec>
<p><monospace>&#x0023; Load the pre-installed data for the example</monospace></p>
<p><monospace>file.pheno.csv &#x003C;- system.file(&#x201C;extdata&#x201D;,&#x201C;populus.BC.pheno.csv&#x201D;, package&#x003D;&#x201C;Funmap2&#x201D;)</monospace></p>
<p><monospace>file.geno.csv &#x003C;- system.file(&#x201C;extdata&#x201D;,&#x201C;populus.BC.geno.csv&#x201D;, package&#x003D;&#x201C;Funmap2&#x201D;)</monospace></p>
<p><monospace>file.marker.csv &#x003C;- system.file(&#x201C;extdata&#x201D;,&#x201C;populus.BC.marker.csv&#x201D;, package&#x003D;&#x201C;Funmap2&#x201D;)</monospace></p>
<p><monospace>r &#x003C;- FM2.pipe(file.pheno.csv, NULL, file.geno.csv, file.marker.csv, &#x201C;BC&#x201D;</monospace>,</p>
<p><monospace>curve.type&#x003D;&#x201C;auto&#x201D;, covar.type&#x003D;&#x201C;AR1&#x201D;, options&#x003D;list (n.cores&#x003D;10));</monospace></p>
</sec>
</boxed-text>
</sec>
<sec id="s5"><title>DISCUSSION AND CONCLUSION</title>
<p>Functional mapping model assumes the longitudinal traits follow a parametric or non-parametric curve, such as growth trajectory, Legendre polynomial, B-Spline (<xref ref-type="bibr" rid="c23">Yang et al 2009</xref>). Under this assumption, likelihood ratio and QTL effects derived from the parameters of parametric or non-parametric curve, are calculated by MLE function over all linkage groups. <italic>Funmap2</italic> implements the functional mapping framework with 9 curves and 13 covariance structures. Importantly, any new curve functions not implemented by <italic>Funmap2</italic>, can be easily imported into the package and assembled into the framework of MLE. It is open architecture for any biological curve to fit the longitudinal traits.</p>
<p>The longitudinal traits tend to strongly correlate between time points (time-dependent) or reaction norms (environment-dependent). Function mapping models this internal relation using covariance matrix, which may increase the statistical power for QTL detection. Whereas previous publications on functional mapping recommended the use of the most parsimonious covariance matrix (<xref ref-type="bibr" rid="c22">Yap et al, 2009</xref>), such as autoregressive, ante-dependence or autoregressive moving average (<xref ref-type="bibr" rid="c9">Li et al, 2010a</xref>), <italic>Funmap2</italic> also provides other covariance matrices implemented in IBM SPSS software, such as Compound Symmetry, Factor Analytic, Huynh-Feldt, Toeplitz. This is because although parsimonious covariance matrix can be computationally efficient, non-parsimonious covariance structures contain more parameters, and hence richer structures, which may potentially lead to better data fitting while minimizing the pitfall of overfitting when guided by information criterion.</p>
<p>Studies of QTL mapping for longitudinal traits other than functional mapping are unexpectedly rare, compared to that for QTL mapping on trait measured at a single point. The works include <xref ref-type="bibr" rid="c24">Yang et al 2006</xref> and Funqtl (<xref ref-type="bibr" rid="c5">Kwak et al 2016</xref>). As a result, researches on the genetic basis underlying biological development and gene/ environment interaction are greatly limited. <italic>Funmap2</italic> provides a user-friendly way to dissecting these problems, and facilitates the building of precise genotype-phenotype relation model through QTL mapping. Besides mapped QTLs, estimates from curve functions may also provide insights for the understanding of the genetic, biochemical and physiological pathways governing developmental change (<xref ref-type="bibr" rid="c16">Wang et al. 2012</xref>). We are making the endeavor to develop a GUI version <italic>Funmap2</italic> to further facilitate the user to extract and interpret the data. At present, <italic>Funmap2</italic> supports experimental populations derived from a cross between two inbred lines, and is limited to four types, F2, backcross, recombinant inbred lines and double-haploid populations. Future versions of <italic>Funmap2</italic> shall be able to accommodate populations of more diverse structures and even multiple traits, epistasis effects, allometric, and QTL-QTL interaction, as functional mapping itself is rapidly evolving and is quickly merging with these fields.</p>
</sec>
</body>
<back>
<sec id="s6" sec-type="funding"><title>Funding</title>
<p>This study was supported by National Training Program of Innovation and Entrepreneurship for Undergraduates (201510022069), the Fundamental Research Funds for the Central Universities (BLX2013026), NSFC Grant (31470675).</p>
</sec>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Fu</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>J.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2011</year>). <article-title>A mathematical framework for functional mapping of complex phenotypes using delay differential equations</article-title>. <source>Journal of theoretical biology</source>, <volume>289</volume>, <fpage>206</fpage>-<lpage>216</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Fu</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Bo</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Pang</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Song</surname>, <given-names>Y.</given-names></string-name>,&#x2026;&#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2013</year>). <article-title>Mapping shape quantitative trait loci using a radius-centroid-contour model</article-title>. <source>Heredity</source>, <volume>110</volume>(<issue>6</issue>), <fpage>511</fpage>-<lpage>519</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Jiang</surname>, <given-names>C.</given-names></string-name>, &#x0026; <string-name><surname>Zeng</surname>, <given-names>Z. B.</given-names></string-name> (<year>1995</year>). <article-title>Multiple trait analysis of genetic mapping for quantitative trait loci</article-title>. <source>Genetics</source>, <volume>140</volume>(<issue>3</issue>), <fpage>1111</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Kao</surname>, <given-names>C. H.</given-names></string-name>, <string-name><surname>Zeng</surname>, <given-names>Z. B.</given-names></string-name>, &#x0026; <string-name><surname>Teasdale</surname>, <given-names>R. D.</given-names></string-name> (<year>1999</year>). <article-title>Multiple interval mapping for quantitative trait loci</article-title>. <source>Genetics</source>, <volume>152</volume>(<issue>3</issue>), <fpage>1203</fpage>-<lpage>1216</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Kwak</surname>, <given-names>I. Y.</given-names></string-name>, <string-name><surname>Moore</surname>, <given-names>C. R.</given-names></string-name>, <string-name><surname>Spalding</surname>, <given-names>E. P.</given-names></string-name>, &#x0026; <string-name><surname>Broman</surname>, <given-names>K. W.</given-names></string-name> (<year>2016</year>). <article-title>Mapping quantitative trait loci underlying function-valued traits using functional principal component analysis and multi-trait mapping</article-title>. <source>G3: Genes\ Genomes\ Genetics</source>, <volume>6</volume>(<issue>1</issue>), <fpage>79</fpage>-<lpage>86</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Lander</surname>, <given-names>E. S.</given-names></string-name>, &#x0026; <string-name><surname>Botstein</surname>, <given-names>D.</given-names></string-name> (<year>1989</year>). <article-title>Mapping mendelian factors underlying quantitative traits using RFLP linkage maps</article-title>. <source>Genetics</source>, <volume>121</volume>(<issue>1</issue>), <fpage>185</fpage>-<lpage>199</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="book"><string-name><surname>Li</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Gai</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2014</year>). <chapter-title>A novel QTL mapping model for allometric growth and pleiotropic extension</chapter-title>. <source>Journal of Nanjing Forestry University</source> (<edition>Natural Sciences Edition</edition>), <publisher-loc>China</publisher-loc>, <volume>38</volume>(<issue>3</issue>), <fpage>35</fpage>-<lpage>39</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Das</surname>, <given-names>K.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2009</year>). <article-title>Functional mapping of human growth trajectories</article-title>. <source>Journal of theoretical biology</source>, <volume>261</volume>(<issue>1</issue>), <fpage>33</fpage>-<lpage>42</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>McMurry</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Berg</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Berceli</surname>, <given-names>S. A.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2010a</year>). <article-title>Functional clustering of periodic transcriptional profiles through ARMA (p, q)</article-title>. <source>PLoS One</source>, <volume>5</volume>(<issue>4</issue>), <fpage>e9894</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>Q.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Gai</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>Y.</given-names></string-name>,&#x2026;&#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2010b</year>). <article-title>Functional mapping of genotype-environment interactions for soybean growth by a semiparametric approach</article-title>. <source>Plant Methods</source>, <volume>6</volume>(<issue>1</issue>), <fpage>13</fpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Ma</surname>, <given-names>C. X.</given-names></string-name>, <string-name><surname>Casella</surname>, <given-names>G.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2002</year>). <article-title>Functional mapping of quantitative trait loci underlying the character process: a theoretical framework</article-title>. <source>Genetics</source>, <volume>161</volume>(<issue>4</issue>), <fpage>1751</fpage>-<lpage>1762</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Ma</surname>, <given-names>C. X.</given-names></string-name>, <string-name><given-names>G.</given-names> <surname>Casella</surname></string-name>, <string-name><given-names>R. C.</given-names> <surname>Littell</surname></string-name>, <string-name><given-names>K. A. I.</given-names> <surname>Khuri</surname></string-name> and <string-name><given-names>R. L.</given-names> <surname>Wu</surname></string-name>, (<year>2003</year>). <article-title>Exponential mapping of quantitative traits governing allometric relationships in organisms</article-title>. <source>Journal of Mathematical Biology</source>, <volume>47</volume>: <fpage>313</fpage>-<lpage>324</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Sillanp&#x00E4;&#x00E4;</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Pikkuhookana</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Abrahamsson</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kn&#x00FC;rr</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fries</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Lerceteau</surname>, <given-names>E.</given-names></string-name>,&#x2026;&#x0026; <string-name><surname>Garc&#x00ED;a-Gil</surname>, <given-names>M. R.</given-names></string-name> (<year>2012</year>). <article-title>Simultaneous estimation of multiple quantitative trait loci and growth curve parameters through hierarchical Bayesian modeling</article-title>. <source>Heredity</source>, <volume>108</volume>(<issue>2</issue>), <fpage>134</fpage>-<lpage>146</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="book"><string-name><surname>Sun</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Ye</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gosik</surname>, <given-names>K.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2015</year>). <chapter-title>Functional Mapping: How to Map Genes for Phenotypic Plasticity of Development</chapter-title>. In <source>Evolutionary Biology: Biodiversification from Genotype to Phenotype</source> (pp. <fpage>3</fpage>-<lpage>17</lpage>). <publisher-name>Springer International Publishing</publisher-name>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname> <given-names>N</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>H</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>R</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> (<year>2017</year>) <article-title>Fast Computation of Significance Threshold in QTL Mapping of Dynamic Quantitative Traits</article-title>. <source>J Biom Biostat</source> <volume>8</volume>: <fpage>329</fpage>. doi: <pub-id pub-id-type="doi">10.4172/2155-6180.1000329</pub-id></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Tao</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>L.</given-names></string-name>,&#x2026;&#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2012</year>). <article-title>How to cluster gene expression dynamics in response to environmental signals</article-title>. <source>Briefings in bioinformatics</source>, <volume>13</volume>(<issue>2</issue>), <fpage>162</fpage>-<lpage>174</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Pang</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Lv</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>X.</given-names></string-name>,&#x2026;&#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2013a</year>). <article-title>A dynamic framework for quantifying the genetic architecture of phenotypic plasticity</article-title>. <source>Briefings in bioinformatics</source>, <volume>14</volume>(<issue>1</issue>), <fpage>82</fpage>-<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Luo</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Fu</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2013b</year>). <article-title>Stochastic modeling of systems mapping in pharmacogenomics</article-title>. <source>Advanced drug delivery reviews</source>, <volume>65</volume>(<issue>7</issue>), <fpage>912</fpage>-<lpage>917</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name>, &#x0026; <string-name><surname>Lin</surname>, <given-names>M.</given-names></string-name> (<year>2006</year>). <article-title>Functional mapping&#x2014;how to map and study the genetic architecture of dynamic complex traits</article-title>. <source>Nature Reviews Genetics</source>, <volume>7</volume>(<issue>3</issue>), <fpage>229</fpage>-<lpage>237</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Mao</surname>, <given-names>D.</given-names></string-name>, &#x0026; <string-name><surname>Chen</surname>, <given-names>Q.</given-names></string-name> (<year>2002</year>). <article-title>Mapping of quantitative trait loci based on growth models</article-title>. <source>Theoretical and Applied Genetics</source>, <volume>105</volume>(<issue>6-7</issue>), <fpage>1043</fpage>-<lpage>1049</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Xiong</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Goulding</surname>, <given-names>E. H.</given-names></string-name>, <string-name><surname>Carlson</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Tecott</surname>, <given-names>L. H.</given-names></string-name>, <string-name><surname>McCulloch</surname>, <given-names>C. E.</given-names></string-name>, &#x0026; <string-name><surname>Sen</surname>, <given-names>&#x015A;.</given-names></string-name> (<year>2011</year>). <article-title>A flexible estimating equations approach for mapping function-valued traits</article-title>. <source>Genetics</source>, <volume>189</volume>(<issue>1</issue>), <fpage>305</fpage>-<lpage>316</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Yap</surname>, <given-names>J. S.</given-names></string-name>, <string-name><surname>Fan</surname>, <given-names>J.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2009</year>). <article-title>Nonparametric modeling of longitudinal covariance structure in functional mapping of quantitative trait loci</article-title>. <source>Biometrics</source>, <volume>65</volume>(<issue>4</issue>), <fpage>1068</fpage>-<lpage>1077</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name>, &#x0026; <string-name><surname>Casella</surname>, <given-names>G.</given-names></string-name> (<year>2009</year>). <article-title>Nonparametric functional mapping of quantitative trait loci</article-title>. <source>Biometrics</source>, <volume>65</volume>(<issue>1</issue>), <fpage>30</fpage>-<lpage>39</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tian</surname>, <given-names>Q.</given-names></string-name>, &#x0026; <string-name><surname>Xu</surname>, <given-names>S.</given-names></string-name> (<year>2006</year>). <article-title>Mapping quantitative trait loci for longitudinal traits in line crosses</article-title>. <source>Genetics</source>, <volume>173</volume>(<issue>4</issue>), <fpage>2339</fpage>-<lpage>2356</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>X.</given-names></string-name>, &#x0026; <string-name><surname>Zhou</surname>, <given-names>X.</given-names></string-name> (<year>2011</year>). <article-title>Bayesian functional mapping of dynamic quantitative traits</article-title>. <source>Theoretical and applied genetics</source>, <volume>123</volume>(<issue>3</issue>), <fpage>483</fpage>-<lpage>492</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Ma</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Cheverud</surname>, <given-names>J. M.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2004a</year>). <article-title>A unifying statistical model for QTL mapping of genotype<sup>x</sup> sex interaction for developmental trajectories</article-title>. <source>Physiological Genomics</source>, <volume>19</volume>(<issue>2</issue>), <fpage>218</fpage>-<lpage>227</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gallo-Meagher</surname>, <given-names>M.</given-names></string-name>, &#x0026; <string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> (<year>2004b</year>). <article-title>A unified statistical model for functional mapping of environment-dependent genetic expression and genotype<sup>x</sup> environment interactions for ontogenetic development</article-title>. <source>Genetics</source>, <volume>168</volume>(<issue>3</issue>), <fpage>1751</fpage>-<lpage>1762</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>