<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/173146</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>chewBBACA: A complete suite for gene-bygene schema creation and strain identification</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Silva</surname><given-names>Mickael</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Machado</surname><given-names>Miguel</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Rossi</surname><given-names>Mirko</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Moran-Gilad</surname><given-names>Jacob</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Santos</surname><given-names>Sergio</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Ramirez</surname><given-names>Mario</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Carri&#x00E7;o</surname><given-names>Jo&#x00E3;o Andr&#x00E9;</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x2217;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Instituto de Microbiologia, Instituto de Medicina Molecular, Faculdade de Medicina, Universidade de Lisboa</institution>, Lisbon, <country>Portugal</country></aff>
<aff id="a2"><label>2</label><institution>Department of Food Hygiene and Environmental Health, Faculty of Veterinary Medicine, University of Helsinki</institution>, <country>Finland</country></aff>
<aff id="a3"><label>3</label><institution>Faculty of Health Sciences, Ben-Gurion University of the Negev</institution>, Beer Sheva, <country>Israel</country></aff>
<aff id="a4"><label>4</label><institution>Public Health Services, Ministry of Health</institution>, Jerusalem, <country>Israel</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x2217;</label>To whom correspondence should be addressed.</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>173146</elocation-id>
<history>
<date date-type="received">
<day>07</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>07</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>08</day>
<month>8</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="173146.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<sec><title>Motivation</title>
<p>Gene-by-gene (GbG) approaches are becoming increasingly popular in bacterial genomic epidemiology and outbreak detection. However, there is a lack of open source software for schema definition and allele calling.</p>
</sec>
<sec><title>Results</title>
<p>The chewBBACA suite was designed to assist users in the creation and evaluation of novel whole-genome or core-genome GbG schemas and allele calling in bacterial strains of interest. The alleles called by chewBBACA are potential coding sequences, allowing the user to evaluate the possible consequences of the observed diversity. The software can run in a laptop or in high performance clusters making it useful for both small laboratories and large reference centers.</p>
</sec>
<sec sec-type="availability"><title>Availability</title>
<p><ext-link ext-link-type="uri" xlink:href="https://github.com/B-UMMI/chewBBACA/">https://github.com/B-UMMI/chewBBACA/</ext-link></p>
</sec>
<sec><title>Contact</title>
<p><email>jcarrico@fm.ul.pt</email></p>
</sec>
<sec sec-type="supplementary-material"><title>Supplementary information</title>
<p>Supplementary data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/B-UMMI/chewBBACA/wiki">https://github.com/B-UMMI/chewBBACA/wiki</ext-link></p>
</sec>
</abstract>
<counts>
<page-count count="2"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><label>1</label><title>Introduction</title>
<p>Read mapping approaches using Single Nucleotide Polymorphisms (SNP)/Single Nucleotide Variants (SNV) have been used for studying bacterial genomes (<xref ref-type="bibr" rid="c8">Lynch et al. 2016</xref>). However, gene-by-gene (GbG) approaches are advantageous in the context of genomic epidemiology as an expansion of Multilocus Sequence Typing (MLST) (<xref ref-type="bibr" rid="c9">Maiden et al. 1998</xref>) thus allowing portability, scalability, and independence from a defined reference strain. For these reasons, GbG has been adopted by PulseNet International as the method for bacterial strain discrimination using high throughput sequencing (<xref ref-type="bibr" rid="c12">Nadon et al. 2017</xref>). GbG relies on comparing the draft genome of a strain of interest against a pre-defined schema, typically using a BLAST (<xref ref-type="bibr" rid="c1">Altschul et al. 1990</xref>) based approach. This schema can be composed of core loci, present in all or the great majority (e.g. 95&#x0025;) of the analysed strains (core genome MLST schemas or cgMLST), or including all loci detected in the strains of interest. The latter are referred to as whole genome or pan genome MLST schemas (wgMLST or pgMLST).</p>
<p>A locus in a schema can be a complete coding sequence (CDS) or a subsequence of it, as in traditional MLST. Defining a locus as a CDS, allows linking the variability found to potential changes in proteins and thus, possibly with phenotype. The definition of the locus is currently dependent on the algorithm used for comparing loci and defining the schema, hampering the comparison between different GbG approaches.</p>
<p>Only few software are available for GbG allele calling and no tools are available for schema creation and validation. Two commercial platforms offer GbG analyses: Ridom SeqSphere&#x002B; (<ext-link ext-link-type="uri" xlink:href="http://ridom.de/seqsphere/">http://ridom.de/seqsphere/</ext-link>) and Bionumerics (<ext-link ext-link-type="uri" xlink:href="http://www.applied-maths.com/applications/wgmlst">http://www.applied-maths.com/applications/wgmlst</ext-link>). Since these are proprietary, closed source software, their GbG allele calling algorithms are incompletely described (<xref ref-type="bibr" rid="c11">Moura et al. 2016</xref>),(<xref ref-type="bibr" rid="c14">Ruppitsch et al. 2015</xref>), although Ridom schemas are public (<ext-link ext-link-type="uri" xlink:href="http://www.cgmlst.org/">http://www.cgmlst.org/</ext-link>).</p>
<p>BIGSdb was the first open-source freely available platform allowing cgMLST analysis (<xref ref-type="bibr" rid="c4">Jolley &#x0026; Maiden 2010</xref>) and currently it is the basis of the PubMLST website (<ext-link ext-link-type="uri" xlink:href="https://pubmlst.org/">https://pubmlst.org/</ext-link>). More recently, EnteroBase provides comprehensive cgMLST and wgMLST schemas and allele calling engine for three major foodborne bacterial pathogens (<ext-link ext-link-type="uri" xlink:href="https://enterobase.Warwick.ac.uk/">https://enterobase.Warwick.ac.uk/</ext-link>), A limitation is the requirement to submit reads to the website or to public repositories (NCBI SRA/EBI ENA), since no stand-alone versions of their allele calling algorithm are available. Currently, the only published open-source stand-alone GpG allele calling algorithm is Genome Profiler (<xref ref-type="bibr" rid="c15">Zhang et al. 2015</xref>) which, however, uses a single CPU core making it unsuitable for large analyses.</p>
<p>We developed chewBBACA to be a complete stand-alone pipeline for GbG analyses, including constructing and validating novel cg/wgMLST schemas and performing CDS allele calling suitable for large scale studies.</p>
</sec>
<sec id="s2"><label>2</label><title>Implementation</title>
<p>chewBBACA is composed of three interconnected modules/workflows:</p>
<list list-type="order">
<list-item><p><bold>Schema Creation</bold> workflow defines wg/cgMLST schemas from user provided complete genomes or draft assemblies, focusing on excluding paralog loci, detection of contaminated/bad quality assemblies and supporting user decisions towards the identification of the most appropriate schema through interactive graphic data analysis. This module uses an iterative approach for CDS comparison for selection of loci that is more computationally efficient than the Markov Clustering Step typically used in software such as OrthoMCL(<xref ref-type="bibr" rid="c7">Li et al. 2003</xref>) or CD-hit (<xref ref-type="bibr" rid="c2">Fu et al. 2012</xref>).</p></list-item>
<list-item><p><bold>Allele Calling</bold> algorithm is based on CDSs identified by Prodigal (<xref ref-type="bibr" rid="c3">Hyatt et al. 2010</xref>) with similarity determined using a BLASTP Blast Score Ratio (BSR) (<xref ref-type="bibr" rid="c13">Rasko et al. 2005</xref>), allowing the detection of alleles with divergent DNA sequences but similar encoded proteins. This allows identifying alleles that would be considered absent loci with BLASTN, but retains the full diversity found at the DNA sequence level.</p>
</list-item>
<list-item><p><bold>Schema Evaluation</bold> allows the assessment of the suitability of including each locus in a schema through a suite of functions to graphically explore and evaluate the type and extent of allelic variation detected in each of the chosen loci. This module also creates multiple sequence alignments for each locus using MAFFT (<xref ref-type="bibr" rid="c5">Katoh et al. 2002</xref>) and constructs neighbor-joining trees using ClustalW2 (<xref ref-type="bibr" rid="c6">Larkin et al. 2007</xref>) allowing evaluating schemas created by other methodologies and can be further used for exploring the potential consequences of the variability of each locus.</p>
</list-item>
</list>
<p>A complete description of each module and functionalities is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/B-UMM1/chewBBACA/wiki">https://github.com/B-UMM1/chewBBACA/wiki</ext-link></p>
</sec>
<sec id="s3"><label>3</label><title>Usage Example</title>
<p>A tutorial providing a complete usage example demonstrating the creation of a schema for <italic>Streptococcus agalactiae</italic>, from publicly available complete genomes and assemblies available at NCBI/ENA is provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/mickaelsilva/chewBBACA_tutorial">https://github.com/mickaelsilva/chewBBACA_tutorial</ext-link></p>
</sec>
<sec id="s4"><label>4</label><title>Conclusions</title>
<p>The chewBBACA suite was developed to allow GbG analyses to be performed on high-end Unix based laptops but also in high performance servers, facilitating its adoption into large-scale automated analysis pipelines. The allele calling engine of chewBBACA uses FASTA files with draft assemblies or complete genomes as input and returns as output an allelic profile matrix and a set of FASTA files containing the full allelic diversity of each locus. For a 2MB bacterial genome and a schema of 1,300 loci it takes approximately 15 seconds to run using 6 cores. Currently available cg/wgMLST schemas, can be adapted to run using chewBBACA&#x2019;s allele calling engine. chewBBACA is the first suite to provide schema creation tools and to enforce CDS allele calling, which can be important to evaluate phenotype diversity. Since there is an urgent need for bioinformatics solutions that will facilitate development of nomenclature-based schemas (<xref ref-type="bibr" rid="c10">Moran-Gilad 2017</xref>)), future work will focus on centralized repositories for schemas and allele definitions that can be synchronized with local allele calling outputs to facilitate the development of common schemas and nomenclatures for cg/wgMLST to benefit public health.</p>
</sec>
</body>
<back>
<ack><title>Acknowledgements</title>
<p>The authors would like to thank Eduardo Taboada and Peter Kruczkiewicz from National Microbiology Laboratory at Lethbridge, Public Health Agency of Canada, Lethbridge, Alberta, Canada., for insightful discussions.</p></ack>
<sec sec-type="funding"><title>Funding</title>
<p>Mickael Silva and Miguel Machado have been supported by INNUENDO project (<ext-link ext-link-type="uri" xlink:href="https://www.innuendoweb.org">https://www.innuendoweb.org</ext-link>) co-funded by the European Food Safety Authority (EFSA), grant agreement GP/EFSA/AFSCO/2015/01/CT2 (&#x201C;New approaches in identifying and characterizing microbial and chemical hazards&#x201D;).&#x201D; The conclusions, findings, and opinions expressed in this review paper reflect only the view of the authors and not the official position of the European Food Safety Authority (EFSA). This work was partially supported by the following projects: ONEIDA project (LISBOA-01-0145-FEDER-016417) co-funded by FEEI - &#x201C;Fundos Europeus Estruturais e de Investimento&#x201D; from &#x201C;Programa Operacional Regional Lisboa 2020&#x201D; and by national funds from FCT - &#x201C;Funda&#x00E7;&#x00E3;o para a Ci&#x00EA;ncia e a Tecnologia&#x201D;and BacGenTrack (TUBITAK/0004/2014) [FCT/ Scientific and Technological Research Council of Turkey (T&#x00FC;rkiye Bilimsel ve Teknolojik Ara&#x015F;rrma Kurumu, T&#x00DC;BiTAK)],</p>
</sec>
<sec><title>Conflict of Interest</title>
<p>none declared.</p>
</sec>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Altschul</surname>, <given-names>S.F.</given-names></string-name> <etal>et al.</etal>, <year>1990</year>. <article-title>Basic local alignment search tool</article-title>. <source>Journal of molecular biology</source>, <volume>215</volume>(<issue>3</issue>), pp.<fpage>403</fpage>&#x2013;<lpage>410</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Fu</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal>, <year>2012</year>. <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>(<issue>23</issue>), pp.<fpage>3150</fpage>&#x2013;<lpage>3152</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Hyatt</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal>, <year>2010</year>. <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>(<issue>1</issue>), p. <fpage>119</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Jolley</surname>, <given-names>K.A.</given-names></string-name> &#x0026; <string-name><surname>Maiden</surname>, <given-names>M.C.J.</given-names></string-name>, <year>2010</year>. <article-title>BIGSdb: Scalable analysis of bacterial genome variation at the population level</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, p.<fpage>595</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Katoh</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal>, <year>2002</year>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Research</source>, <volume>30</volume>(<issue>14</issue>), pp.<fpage>3059</fpage>&#x2013;<lpage>3066</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Larkin</surname>, <given-names>M.A.</given-names></string-name> <etal>et al.</etal>, <year>2007</year>. <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>, <volume>23</volume>(<issue>21</issue>), pp.<fpage>2947</fpage>&#x2013;<lpage>2948</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Stoeckert</surname>, <given-names>C.J.</given-names></string-name> &#x0026; <string-name><surname>Roos</surname>, <given-names>D.S.</given-names></string-name>, <year>2003</year>. <article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>. <source>Genome Research</source>, <volume>13</volume>(<issue>9</issue>), pp.<fpage>2178</fpage>&#x2013;<lpage>2189</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Lynch</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal>, <year>2016</year>. <article-title>A Primer on Infectious Disease Bacterial Genomics</article-title>. <source>Clinical Microbiology Reviews</source>, <volume>29</volume>(<issue>4</issue>), pp.<fpage>881</fpage>&#x2013;<lpage>913</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Maiden</surname>, <given-names>M.C.</given-names></string-name> <etal>et al.</etal>, <year>1998</year>. <article-title>Mlultilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>95</volume>(<issue>6</issue>), pp.<fpage>3140</fpage>&#x2013;<lpage>3145</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Moran-Gilad</surname>, <given-names>J.</given-names></string-name>, <year>2017</year>. <article-title>Whole genome sequencing (WGS) for food-borne pathogen surveillance and control - taking the pulse</article-title>. <source>Euro surveillance: bulletin europ&#x00E9;en sur les maladies transmissibles = European communicable disease bulletin</source>, <volume>22</volume>(<issue>23</issue>), p.<fpage>30547</fpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Moura</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal>, <year>2016</year>. <article-title>Whole genome-based population biology and epidemiological surveillance of <italic>Listeria monocytogenes</italic></article-title>. <source>Nature Microbiology</source>, pp. <fpage>1</fpage>&#x2013;<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Nadon</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal>, <year>2017</year>. <article-title>PulseNet International: Vision for the implementation of whole genome sequencing (WGS) for global food-borne disease surveillance</article-title>. <source>Euro surveillance: bulletin europ&#x00E9;en sur les maladies transmissibles = European communicable disease bulletin</source>, <volume>22</volume>(<issue>23</issue>), pp. <fpage>13</fpage>&#x2013;<lpage>24</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Rasko</surname>, <given-names>D.A.</given-names></string-name>, <string-name><surname>Myers</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Ravel</surname>, <given-names>J.</given-names></string-name>, <year>2005</year>. <article-title>Visualization of comparative genomic analyses by BLAST score ratio</article-title>. <source>BMC Bioinformatics</source>, <volume>6</volume>(<issue>1</issue>).</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Ruppitsch</surname>, <given-names>W.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <source>Defining and Evaluating a Core Genome Multilocus Sequence Typing Scheme for Whole-Genome Sequence-Based Typing of Listeria monocytogenes</source>. <person-group><string-name><given-names>D. J.</given-names> <surname>Diekema</surname></string-name></person-group>, ed., <volume>53</volume>(<issue>9</issue>), pp.<fpage>2869</fpage>&#x2013;<lpage>2876</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <source>Refinement of whole-genome multilocus sequence typing analysis by addressing gene paralogy</source>., <volume>53</volume>(<issue>5</issue>), pp. <fpage>1765</fpage>&#x2013;<lpage>1767</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
