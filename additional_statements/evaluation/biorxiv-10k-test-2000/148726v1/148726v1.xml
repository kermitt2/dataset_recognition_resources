<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/148726</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group><article-title>Enhancer Linking by Methylation/Expression Relationships with the R package <italic>ELMER</italic> version 2</article-title></title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1343-6850</contrib-id>
<name><surname>Silva</surname> <given-names>Tiago Chedraoui</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a2">2</xref><xref ref-type="corresp" rid="cor1">&#x002A;</xref></contrib>
<contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4267-5930</contrib-id>
<name><surname>Coetzee</surname> <given-names>Simon G.</given-names></name><xref ref-type="aff" rid="a2">2</xref></contrib>
<contrib contrib-type="author"><name><surname>Yao</surname> <given-names>Lijing</given-names></name><xref ref-type="aff" rid="a4">4</xref></contrib>
<contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0749-9935</contrib-id>
<name><surname>Hazelett</surname> <given-names>Dennis J.</given-names></name><xref ref-type="aff" rid="a2">2</xref></contrib>
<contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4051-8114</contrib-id>
<name><surname>Noushmehr</surname> <given-names>Houtan</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a3">3</xref></contrib>
<contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2099-9005</contrib-id>
<name><surname>Berman</surname> <given-names>Benjamin P.</given-names></name><xref ref-type="aff" rid="a2">2</xref><xref ref-type="corresp" rid="cor1">&#x002A;</xref></contrib>
<aff id="a1"><label>1</label><institution>Department of Genetics, Ribeir&#x00E3;o Preto Medical School</institution>, University of S&#x00E3;o Paulo, Ribeir&#x00E3;o Preto, <country>Brazil</country></aff>
<aff id="a2"><label>2</label><institution>Center for Bioinformatics and Functional Genomics</institution>, Cedars-Sinai Medical Center, Los Angeles, CA, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Neurosurgery, Henry Ford Hospital</institution>, Detroit, MI, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Roche Sequencing Solutions</institution></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding authors, email <email>tiago.chedraouisilva@cshs.org</email> or <email>Benjamin.Berman@cshs.org</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>148726</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>10</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>6</month>
<year>2017</year>
</date>
</history><permissions><copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions>
<self-uri xlink:href="148726.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Recent studies indicate that DNA methylation can be used to identify changes at transcriptional enhancers and other cis-regulatory elements in primary human samples. A systematic approach to inferring gene regulatory networks has been provided by the R/Bioconductor package <italic>ELMER</italic> (Enhancer Linking by Methylation/Expression Relationships), which first identifies DNA methylation changes in distal regulatory elements and correlates these with expression of nearby genes to identify direct transcriptional targets. Next, <italic>ELMER</italic> performs a transcription factor binding motif analysis and integrates with expression profiling of all human transcription factors, to identify master regulatory TFs and place each differentially methylated regulatory element into the context of an altered gene regulatory network (GRN).</p>
<p>Here we present a completely updated version of the package <italic>(ELMER</italic> v. 2.0), which uses the latest Bioconductor data structures including the popular <monospace>MultiAsssayExperiment</monospace>, supports multiple reference genome assemblies as well as the DNA methylation platforms Infinium MethylationEPIC and Infinium HumanMethylation450, and provides a &#x201C;Supervised&#x201D; analysis mode for paired sample study designs (such as treated vs. untreated replicate samples). It also supports data import from the new NCI Genomic Data Commons (GDC) database. The new version is substantially re-written, improving stability, performance, and extensibility. It also uses improved databases for transcription factor binding domain families and binding motif specificities, and has newly designed output plots for publication-quality figures.</p>
<p>Below, we describe the methods and new features of ELMER v. 2.0, and present two use case demonstrating how the tool can be used to analyze TCGA data in either Unsupervised or Supervised mode. <italic>ELMER</italic> (v2.0.0) is available as an R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER">https://github.com/tiagochst/ELMER.</ext-link> Also, <italic>ELMER. data</italic> (v2.0.0), which provides auxiliary data required to perform the analysis, is available at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER.data">https://github.com/tiagochst/ELMER.data</ext-link>.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>DNA methylation</kwd>
<kwd>gene regulatory networks</kwd>
<kwd>enhancers</kwd>
<kwd>chromatin interactions</kwd>
<kwd>chromQTLs</kwd>
<kwd>transcription factor binding sites</kwd>
<kwd>epigenetics</kwd>
<kwd>computational tools</kwd>
</kwd-group>
<counts>
<page-count count="26"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Motivated by our discovery of transcriptional enhancers in tissue DNA methylation data [<xref ref-type="bibr" rid="c1">1</xref>], and subsequent approaches to linking these enhancers to transcriptional targets using a chromQTL approach [<xref ref-type="bibr" rid="c2">2</xref>] (reviewed in [<xref ref-type="bibr" rid="c3">3</xref>]), we developed the the R/Bioconductor <italic>ELMER</italic> (Enhancer Linking by Methylation/Expression Relationships) package, a tool which infers regulatory element landscapes and transcription factor networks from cancer methylomes [<xref ref-type="bibr" rid="c4">4</xref>].</p>
<p>This tool combined DNA methylation and gene expression data from human tissues to infer multi-level cis-regulatory networks through several steps which included the identification of distal enhancer probes with significantly altered DNA methylation levels in primary tumor tissues compared to normal tissues, followed by the identification of putative target genes, and a comprehensive gene regulatory network analysis which combined transcription factor motifs at the altered enhancers with TF expression to identify the underlying master regulators. This approach identified several known and unknown master regulators in TCGA data, such as GATA3 and FOXA1 in breast cancer, and P63 and SOX2 in squamous cell lung carcinoma. [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>].</p>
<p>Based on user feedback and a full review of the source code, we identified and implemented a number of software improvements, which are summarized in <xref ref-type="table" rid="tbl1">table 1</xref>: (i) The original package contained no standard data structure to handle multiple assays (DNA methylation, gene expression and clinical data), which would be required for an integrative genomic data analysis. Recently, the Bioconductor team provided such a data structure through the MultiAssayExperiment package. (ii) All auxiliary databases (human TF list, classification of TF in families, gene annotation, DNA methylation annotation and motif occurrences within probe sites) used in the package were created and maintained manually, thereby making the upgrade process laborious; thus, we automated this process. (iii) The package was developed to analyze primary tumor tissue samples compared to normal tissues samples, thus not allowing arbitrary subgroups to be compared (for instance mutants vs. non-mutants, treated vs. untreated, etc.) (iv) Our original approach used known epigenomic markers for enhancers to constrain the genomic regions searched for differential methylation. However, this selection could limit our algorithm to identifying regulatory networks for tissue types that exist in the epigenomic databases; we found this constraint problematic, and thus now search <italic>all</italic> distal regulatory regions without any such filter. (v) The function used to download data from The Cancer Genome Atlas (TCGA) data portal [<xref ref-type="bibr" rid="c6">6</xref>] broke when the TCGA site was shutdown and its data transfered to The NCI&#x2019;s Genomic Data Commons (GDC) [<xref ref-type="bibr" rid="c7">7</xref>]; we now have a more general data provider interface that supports GDC as the default provider. (vi) The package only supported data aligned to Genome Reference Consortium GRCh37 (hg19), and we now provide support for Genome Reference Consortium GRCh38 (hg38). (vii) There was no support to the recent HumanMethylationEPIC (EPIC) array [<xref ref-type="bibr" rid="c8">8</xref>]. In addition to the specific improvements listed above, we substantially re-wrote most of the code to be more efficient and maintainable, and improved most of the output plots generated.
<table-wrap id="tbl1" position="float" orientation="portrait"><label>Table 1.</label><caption><p>Main differences between ELMER old version (v.1) and the new version (v.2)</p></caption>
<graphic xlink:href="148726_tbl1.tif"/>
</table-wrap>
</p>
<p>Here, we present a new version of the R <italic>ELMER</italic> package, which addresses all the issues described above. The new version of <italic>ELMER</italic> (v2.0.0) is available as an R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER">https://github.com/tiagochst/ELMER.</ext-link> And, the new version of <italic>ELMER.data</italic> (v2.0.0), which provides auxiliary data required to perform the analysis, is available at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER.data">https://github.com/tiagochst/ELMER.data</ext-link>.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Operation</title>
<p>The R <italic>ELMER</italic> package version 2.0.0 requires R version 3.4.0 or higher. It is open-source under the The GNU General Public License v3.0 (GPL-3) and can run on any operating system. It depends mainly on two R/Bioconductor packages: <italic>TCGAbiolinks</italic> [<xref ref-type="bibr" rid="c12">12</xref>] to download cancer data from NCI Genomic Data Commons (GDC), and <italic>MultiAssayExperiment</italic> [<xref ref-type="bibr" rid="c13">13</xref>] to create an R object with an integrative data structure. Finally, we provide a pipeline to perform <italic>ELMER</italic> analysis on cancer samples compared to normal tissue samples from GDC; however, it should be noted that to perform its analysis for some cancer types, a minimum of 16 Gb memory in R is required.</p>
<p>The latest development version can be installed in an R session from GitHub using the <italic>devtools</italic> package [<xref ref-type="bibr" rid="c14">14</xref>]:</p>
<statement>
<label>Listing 1.</label>
<title>&#x201C;Install ELMER version 2.0 from github&#x201D;</title>
<p><preformat preformat-type="dialog">
install.packages(&#x201C;devtools&#x201D;, dependencies = TRUE)
devtools::install_github(&#x201C;tiagochst/ELMER&#x201D;, dependencies = TRUE, build_vignettes
= TRUE)
devtools::install_github(&#x201C;tiagochst/ELMER.data&#x201D;, dependencies = TRUE, build_
vignettes = TRUE)
</preformat></p>
</statement>
<p>Having successfully installed the <italic>ELMER</italic> package, it can be loaded using <monospace>library</monospace> (<monospace>&#x201C;ELMER&#x201D;</monospace>) and a detailed vignette is available which can be viewed by typing <monospace>browseVignettes</monospace> (<monospace>&#x201C;ELMER&#x201D;</monospace>) and <monospace>browseVignettes</monospace> (<monospace>&#x201C;ELMER. data&#x201D;</monospace>). <xref ref-type="fig" rid="fig1">Figure 1</xref> shows an overview of the workflow of the <italic>ELMER</italic> package.
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1.</label><caption><p>ELMER workflow: ELMER receives as input a DNA methylation object, a gene expression object (both can be either a matrix or a SummarizedExperiment object) and a Genomic Ranges (GRanges) object with distal probes to be used as filter which can be retrieved using the <italic>get.feature.probe</italic> function. The function <italic>createMAE</italic> will create a <italic>Multi Assay Experiment</italic> object keeping only samples that have both DNA methylation and gene expression data. Genes will be mapped to genomic position and annotated using ENSEMBL database [<xref ref-type="bibr" rid="c15">15</xref>], while for probes it will add annotation from <ext-link ext-link-type="uri" xlink:href="http://zwdzwd.github.io/InfiniumAnnotation">http://zwdzwd.github.io/InfiniumAnnotation.</ext-link> This <italic>MAE</italic> object will be used as input to the next analysis functions. First, it identifies differentially methylated probes followed by the identification of their nearest genes (10 upstream and 10 downstream) through the <italic>get.diff.meth</italic> and <italic>GetNearGenes</italic> functions respectively. For each probe it will verify if any of the nearby genes were affected by its change in the DNA methylation level and a list of gene and probes pairs will be outputted from <italic>get.pair</italic> function. For the probes in those pairs, it will search for enriched regulatory Transcription Factors motifs with the <italic>get. enriched. motif</italic> function. Finally, the enriched motifs will be correlate with the level of the transcription factor through the <italic>get.TFs</italic> function. In the figure green Boxes represents user input data, blue boxes represents output object, orange boxes represents auxiliary pre-computed data and gray boxes are functions.</p></caption><graphic xlink:href="148726_fig1.tif"/></fig>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2.</label><caption><p>Probe cg00001809 DNA methylation boxplot. Due to the distribution of DNA methylation levels, if considered all samples in the comparison the probe would not be identified as differently methylated, but if considered the existence of different molecular subtypes and using only the 20&#x0025; of samples, this probe will be identified as differently methylated.</p></caption><graphic xlink:href="148726_fig2.tif"/></fig>
</p>
</sec>
</sec>
<sec id="s2b">
<title>Implementation</title>
<p>Here we describe each of following analysis steps showed in <xref ref-type="fig" rid="fig1">figure 1</xref>. For more details, please also check the original ELMER paper Yao et al. [<xref ref-type="bibr" rid="c4">4</xref>].
<list list-type="bullet">
<list-item><p>Organize data as a <italic>MultiAssayExperiment</italic> object</p></list-item>
<list-item><p>Identify distal probes with significantly different DNA methylation level when comparing two sample groups.</p></list-item>
<list-item><p>Identify putative target genes for differentially methylated distal probes, using methylation vs. expression correlation</p></list-item>
<list-item><p>Identify enriched motifs for each probe belonging to a significant probe-gene pair</p></list-item>
<list-item><p>Identify master regulatory Transcript Factors (TF) whose expression associate with DNA methylation changes at multiple regulatory regions.</p></list-item>
</list></p>
<p>Organization of data as a <italic>MultiAssayExperiment</italic> object</p>
<p>To facilitate the analysis of experiments and studies with multiple samples the Bioconductor team created the <italic>SummarizedExperiment</italic> class [<xref ref-type="bibr" rid="c16">16</xref>], a data structure able to store data and metadata for a single experiment but not for data spanning several experiments for the same sample. To overcome this problem, recently, the MultiAssay SIG (Special Interest Group) created the MultiAssayExperiment class[<xref ref-type="bibr" rid="c13">13</xref>] a data structure to manage and preprocess multiple assays for integrated genomic analysis. This data structure is now an input for all main functions of <italic>ELMER</italic>, and can be generated by <italic>createMAE</italic> function.</p>
<p>To perform <italic>ELMER</italic> analyses, we need to populate a <italic>MultiAssayExperiment</italic> with a DNA methylation matrix or <italic>SummarizedExperiment</italic> object from HM450K or EPIC platform; a gene expression matrix or SummarizedExperiment object for the same samples; a matrix mapping DNA methylation samples to gene expression samples; and a matrix with sample metadata (i.e. clinical data, molecular subtype, etc.). If TCGA data are used, the the last two matrices will be automatically generated. If using non-TCGA data, the matrix with sample metadata should be provided with at least a column with a patient identifier and another one identifying its group which will be used for analysis, if samples in the methylation and expression matrices are not ordered and with same names, a matrix mapping for each patient identifier their DNA methylation samples and their gene expression samples should be provided to the <italic>createMAE</italic> function. Based on the genome of reference selected, metadata for the DNA methylation probes, such as genomic coordinates, will be added from Zhou et al. [<xref ref-type="bibr" rid="c17">17</xref>] [<xref ref-type="bibr" rid="c17">17</xref>]; and metadata for gene expression and annotation is added from Ensembl database [<xref ref-type="bibr" rid="c15">15</xref>] using biomaRt [<xref ref-type="bibr" rid="c18">18</xref>].</p>
<sec id="s2c">
<title>Selecting distal probes</title>
<p>Probes from HumanMethylationEPIC (EPIC) array and Infinium HumanMethylation450 (HM450) array are removed from the analysis if they have either internal SNPs close to the 3&#x2019; end of the probe; non-unique mapping to the bisulfite-converted genome; or off-target hybridization due to partial overlap with non-unique elements [<xref ref-type="bibr" rid="c19">19</xref>]. This probe metadata information is included in <italic>ELMER.data</italic> package, populated from the source file at <ext-link ext-link-type="uri" xlink:href="http://zwdzwd.github.io/InfiniumAnnotation">http://zwdzwd.github.io/InfiniumAnnotation</ext-link> [<xref ref-type="bibr" rid="c19">19</xref>]. To limit ELMER to the analysis of distal elements, probes located in regions of &#x00B1;2<italic>kb</italic> around transcription start sites (TSSs) were removed.</p>
</sec>
<sec id="s2d">
<title>Identification of differentially methylated CpGs (DMCs)</title>
<p>For each distal probe, samples of each group (group 1 and group 2) are ranked by their DNA methylation beta values, those samples in the lower quintile (20&#x0025; samples with the lowest methylation levels) of each group are used to identify if the probe is hypomethylated in group 1 compared to group 2, using an unpaired one-tailed t-test. The 20&#x0025; is a parameter to the <italic>diff.meth</italic> function called <italic>minSubgroupFrac</italic>. For the (ungrouped) cancer case, this is set to 20&#x0025; as in [<xref ref-type="bibr" rid="c4">4</xref>], because we typically wanted to be able to detect a specific molecular subtype among the tumor samples; these subtypes often make up only a minority of samples, and 20&#x0025; was chosen as a lower bound for the purposes of statistical power (high enough sample numbers to yield t-test p-values that could overcome multiple hypothesis correction, yet low enough to be able to capture changes in individual molecular subtypes occurring in 20&#x0025; or more of the cases.) This number can be set arbitrarily as an input to the <italic>diff.meth</italic> function and should be tuned based on sample sizes in individual studies. In the <italic>Supervised</italic> mode, where the comparison groups are implicit in the sample set and labeled, the <italic>minSubgroupFrac</italic> parameter is set to 100&#x0025;. An example would be a cell culture experiment with 5 replicates of the untreated cell line, and another 5 replicates that include an experimental treatment.</p>
<p>To identify hypomethylated DMCs, a one tailed t-test is used to rule out the null hypothesis: <italic>&#x03BC;<sub>group</sub></italic><sub>1</sub> &#x2265; <italic>&#x03BC;<sub>group</sub></italic><sub>2</sub>, where <italic>&#x03BC;<sub>group</sub></italic><sub>1</sub> is the mean methylation within the lowest group 1 quintile (or other percentile as specified by the <italic>minSubgroupFrac</italic> parameter) and <italic>&#x03BC;<sub>group</sub></italic><sub>2</sub> is the mean within the lowest group 2 quintile. Raw p-values are adjusted for multiple hypothesis testing using the Benjamini-Hochberg method [<xref ref-type="bibr" rid="c20">20</xref>], and probes are selected when they had adjusted p-value less than 0.01 (which can be configured using the <italic>pvalue</italic> parameter). For additional stringency, probes are only selected if the methylation difference: &#x0394; = <italic>&#x03BC;<sub>group</sub></italic><sub>1</sub> &#x2013; <italic>&#x03BC;<sub>group</sub></italic><sub>2</sub> was greater than 0.3. The same method is used to identify hypermethylated DMCs, except we use the <italic>upper</italic> quintile, and the opposite tail in the t-test is chosen.</p>
</sec>
<sec id="s2e">
<title>Identification of putative target gene(s)</title>
<p>For each differentially methylated distal probe (DMC), the closest 10 upstream genes and the closest 10 downstream genes are tested for inverse correlation between methylation of the probe and expression of the gene (the number 10 can be changed using the <italic>numFlanking Genes</italic> parameter). To select these genes, the probe-gene distance is defined as the distance from the probe to the transcription start site specified by the ENSEMBLE gene level annotations [<xref ref-type="bibr" rid="c15">15</xref>] accessed via the R/Bioconductor package biomaRt [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c21">21</xref>]. By choosing a constant number of genes to test for each probe, our goal is to avoid systematic false positives for probes in gene rich regions. This is especially important given the highly non-uniform gene density of mammalian genomes. Thus, exactly 20 statistical tests were performed for each probe, as follows.</p>
<p>For each probe-gene pair, the samples (all samples from both groups) are divided into two groups: the M group, which consisted of the upper methylation quintile (the 20&#x0025; of samples with the highest methylation at the enhancer probe), and the U group, which consists of the lowest methylation quintile (the 20&#x0025; of samples with the lowest methylation.) The 20&#x0025; ile cutoff is a configurable parameter <italic>minSubgroupFrac</italic> in the <italic>get.pair</italic> function. As with its usage in the <italic>diff.meth</italic> function, the default value of 20&#x0025; is a balance, allowing for the identification of changes in a molecular subtype making up a minority (i.e. 20&#x0025;) of cases, while also yielding enough statistical power to make strong predictions. For larger sample sizes or other experimental designs, this could be set even lower.</p>
<p>For each candidate probe-gene pair, the Mann-Whitney U test is used to test the null hypothesis that overall gene expression in group M is greater than or equal than that in group U. This non-parametric test was used in order to minimize the effects of expression outliers, which can occur across a very wide dynamic range. For each probe-gene pair tested, the raw p-value <italic>P<sub>r</sub></italic> is corrected for multiple hypothesis using a permutation approach as follows. The gene in the pair is held constant, and <italic>x</italic> random methylation probes are chosen to perform the same one-tailed U test, generating a set of <italic>x</italic> permutation p-values <italic>P<sub>p</sub></italic>. We chose the x random probes only from among those that were &#x201C;distal&#x201D; (farther than 2<italic>kb</italic> from an annotated transcription start site), in order to draw these null-model probes from the same set as the probe being tested. An empirical p-value <italic>P<sub>e</sub></italic> value was calculated using the following formula (which introduces a pseudo-count of 1):
<disp-formula id="ueqn1"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="148726_ueqn1.gif"/></alternatives></disp-formula></p>
<p>Notice that in the <italic>Supervised</italic> mode, no additional filtering is necessary to ensure that the M and U group segregate by sample group labels. The two sample groups are segregated by definition, since these probes were selected for their differential methylation, with the same directionality, between the two groups.</p>
</sec>
<sec id="s2f">
<title>Characterization of chromatin state context of enriched probes using FunciVar</title>
<p>Unlike version 1 of <italic>ELMER</italic>, we now consider <italic>all</italic> distal probes in the identification of regulatory elements. DNA methylation is known to affect several different classes of distal chromatin state element, including active enhancers, poised enhancers, and insulators. In order to provide functional interpretation of the regulatory elements identified by <italic>ELMER</italic>, we perform a chromatin state enrichment analysis of the probes within significant probe-gene pairs, using the <italic>statePaintR</italic> tools from the <monospace>statehub.org</monospace> suite[<xref ref-type="bibr" rid="c22">22</xref>], along with our new FunciVar package [<xref ref-type="bibr" rid="c23">23</xref>]. Enrichment of the putative pairs within chromatin states is calculated against a background model that uses the distal probe set that the putative pairs are drawn from.</p>
</sec>
<sec id="s2g">
<title>Motif enrichment analysis</title>
<p>In order to identify enriched motifs and potential upstream regulatory TFs, all probes with occurring in significant probe-gene pairs are combined for motif enrichment analysis. HOMER (Hypergeometric Optimization of Motif EnRichment) [<xref ref-type="bibr" rid="c24">24</xref>] is used to find motif occurrences in a &#x00B1;250<italic>bp</italic> region around each probe, using HOCOMOCO (HOmo sapiens COmprehensive MOdel COllection) v10 [<xref ref-type="bibr" rid="c10">10</xref>]. Transcription factor (TF) binding models are available at <ext-link ext-link-type="uri" xlink:href="http://hocomoco.autosome.ru/downloads">http://hocomoco.autosome.ru/downloads</ext-link> (using the HOMER specific format with threshold score levels corresponding to p-value &#x003C; 1<sup>&#x2212;4</sup>).</p>
<p>For each probe set tested (i.e. the set of all probes occurring in significant probe-gene pairs), a motif enrichment Odds Ratio and a 95&#x0025; confidence interval are calculated using following formulas:
<disp-formula id="ueqn2"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="148726_ueqn2.gif"/></alternatives></disp-formula>
where <italic>a</italic> is the number of probes within the selected probe set that contain one or more motif occurrences; <italic>b</italic> is the number of probes within the selected probe set that do not contain a motif occurrence; <italic>c</italic> and <italic>d</italic> are the same counts within the entire array probe set (drawn from the same set of distal-only probes using the same definition as the primary analysis). A probe set was considered significantly enriched for a particular motif if the 95&#x0025; confidence interval of the Odds Ratio was greater than 1.1 (specified by option <italic>lower.OR</italic>, 1.1 is default), and the motif occurred at least 10 times (specified by option <italic>min.incidence</italic>, 10 is default) in the probe set.</p>
</sec>
<sec id="s2h">
<title>Identification of master regulator TFs</title>
<p>When a group of enhancers is coordinately altered in a specific sample subset, this is often the result of an altered upstream <italic>master regulator</italic> transcription factor in the gene regulatory network. <italic>ELMER</italic> tries to identify such transcription factors corresponding to each of the TF binding motifs enriched from the previous analysis step. For each enriched motif, <italic>ELMER</italic> takes the average DNA methylation of all distal probes (in significant probe-gene pairs) that contain that motif occurrence (within a &#x00B1;250<italic>bp</italic> region), and compares this average DNA methylation to the expression of each gene annotated as a human TF.</p>
<p>A statistical test is performed for each motif-TF pair, as follows. All samples are divided into two groups: the M group, which consists of the 20&#x0025; of samples with the highest average methylation at all motif-adjacent probes, and the U group, which consisted of the 20&#x0025; of samples with the lowest methylation. This step is performed by the <italic>get</italic>. <italic>TFs</italic> function, which takes <italic>minSubgroupFrac</italic> as an input parameter, again with a default of 20&#x0025;. For each candidate motif-TF pair, the Mann-Whitney U test is used to test the null hypothesis that overall gene expression in group M is greater or equal than that in group U. This non-parametric test was used in order to minimize the effects of expression outliers, which can occur across a very wide dynamic range. For each motif tested, this results in a raw p-value (<italic>P<sub>r</sub></italic>) for each of the human TFs. All TFs are ranked by their &#x2013;<italic>log</italic><sub>10</sub>(<italic>Pr</italic>) values, and those falling within the top 5&#x0025; of this ranking were considered candidate upstream regulators. The best upstream TFs which are known to recognize to specific binding motif are automatically extracted as putative regulatory TFs, and rank ordered plots are created to visually inspect these relationships, as shown in the example below. Because the same motif can be recognized by many transcription factors of the same binding domain family, we define these relationships at both the family and subfamily classification level using the classifications from TFClass database [<xref ref-type="bibr" rid="c11">11</xref>]. Use of this database is a major change from version 1 of ELMER, which used custom curations for DNA binding domain families. Use of the TFClass database is preferable because it is well curated and regularly updated to reflect new findings.</p>
</sec>
</sec>
<sec id="s3">
<title>Use Case 1: Breast Invasive Carcinoma (unsupervised approach)</title>
<p>Here, we describe how to perform <italic>ELMER</italic> analysis on TCGA BRCA (Breast Invasive Carcinoma) data retrieved from the GDC server. We assume that the user has an R environment with the packages <italic>ELMER</italic> (v2.0.0 or newer) and <italic>ELMER.data</italic> (v2.0.0 or newer) installed (see Installation documentation on the Bioconductor website). We first describe how the data can be downloaded and organized to the default <italic>ELMER</italic> input, followed by the following analysis steps:
<list list-type="bullet">
<list-item><p>Identification of distal probes with significant differential DNA methylation (i.e. DMCs) in tumor vs. normal samples</p></list-item>
<list-item><p>Identification of putative target gene(s) for differentially methylated distal probes</p></list-item>
<list-item><p>Characterization of chromatin state context of significant probe regions using FunciVar</p></list-item>
<list-item><p>Identification of enriched motifs within set of probes in significant probe-gene pairs</p></list-item>
<list-item><p>Identification of master regulator Transcription Factors (TF) for each enriched motif</p></list-item>
</list></p>
<p>In addition to these standard steps, we also show how to compare the putative probe-gene pairs to those derived from deep-sequenced ChIA-PET data from MCF7 cells (as shown in [<xref ref-type="bibr" rid="c4">4</xref>]). This use case uses all data available with the recommended thresholds, and can take up to 10 hours to complete and requires a machine with more than 16GB of RAM. For a simpler example, please take a look at the included vignette (see supplemental files).</p>
<sec id="s3a">
<title>Downloading TCGA data</title>
<p>The function <italic>getTCGA</italic> uses the TCGAbiolinks package [<xref ref-type="bibr" rid="c12">12</xref>] to download TCGA data for all samples for a given disease (such as BLCA, LGG, GBM). Its main arguments are the <italic>genome</italic> that if set to &#x201C;hg19&#x201D; will download data from GDC legacy archive, and if set to &#x201C;hg38&#x201D; it will download data from the main GDC harmonized data portal.</p>
<statement>
<label>Listing 2.</label>
<title>&#x201C;Step 1: Downloading TCGA data from GDC database&#x201D;</title>
<p><preformat preformat-type="dialog">
library(ELMER)
getTCGA(disease = &#x201C;BRCA&#x201D;, # TCGA disease abbreviation (BRCA,BLCA,GBM, LGG, etc)
basedir = &#x201C;DATA&#x201D;, # Where data will be downloaded
genome = &#x201C;hg38&#x201D;) # Genome of refenrece &#x201C;hg38&#x201D; or &#x201C;hg19&#x201D;
</preformat></p>
</statement>
<p>If the <italic>getTCGA</italic> function called before was successful it will create the following objects and folders:</p>
<p><preformat preformat-type="dialog">
--- DATA/BRCA/
&#x007C;----------- BRCA_meth_hg38.rda (object with DNA methylation)
&#x007C;----------- BRCA_RNA_hg38.rda (object with gene expression)
&#x007C;----------- BRCA_clinic.rda (object with indexed clinical information)
&#x007C;----------- Raw/ (folder: contains All raw data from GDC)
</preformat></p>
</sec>
<sec id="s3b">
<title>Selecting distal probes</title>
<p>The function <italic>get.feature.probe</italic>, shown in Listing 3, is used to select HM450K/EPIC probes located away from any TSS (at least 2<italic>Kb</italic> away). Its main arguments are the genome of reference (&#x201C;hg38&#x201D;/&#x201C;hg19&#x201D;) and DNA methylation platform (&#x201C;450K&#x201D;/&#x201C;EPIC&#x201D;). The <italic>feature</italic> argument is used to limit the region of probes; as we want all distal probes, we set it to NULL.</p>
<statement>
<label>Listing 3.</label>
<title>&#x201C;Step 2: Selection of probes within biofeatures&#x201D;</title>
<p><preformat preformat-type="dialog">
# get distal probes that are 2kb away from TSS
distal.probes &#x003C;- get.feature.probe(feature = NULL,
genome = &#x201C;hg38&#x201D;,
met.platform = &#x201C;450K&#x201D;)
# 168644 probes
</preformat></p>
</statement>
</sec>
<sec id="s3c">
<title>Organizing data into a MultiAssayExperiment object</title>
<p>The function <italic>createMAE</italic> is used to organize the gene expression and DNA methylation data into a MultiAssayExperiment (MAE) object. Listing 4 shows how to use it with the data created in the previous steps. Its main arguments are described below:
<list list-type="bullet">
<list-item><p><italic>exp</italic>: An R object or a path to a file containing a gene expression matrix or SummarizedExperiment with with gene counts.</p></list-item>
<list-item><p><italic>met</italic>: An R object or a path to a file containing a DNA methylation matrix or SummarizedExperiment with beta values.</p></list-item>
<list-item><p><italic>met.platform:</italic> DNA methylation platform. &#x201C;EPIC&#x201D; for Infinium MethylationEPIC or&#x201D;450K&#x201D; for Infinium HumanMethylation450.</p></list-item>
<list-item><p><italic>genome:</italic> The genome of reference (&#x201C;hg19&#x201D; or &#x201C;hg38&#x201D;) used to select the correct metadata. Genes genomic ranges will be annotated using ENSEMBL database and DNA methylation probes using metadata available at <ext-link ext-link-type="uri" xlink:href="http://zwdzwd.github.io/InfiniumAnnotation">http://zwdzwd.github.io/InfiniumAnnotation</ext-link>.</p></list-item>
<list-item><p><italic>linearize.exp:</italic> this step will take the <italic>log2 (gene expression&#x002B;</italic> 1) in order to linearize the relationship between gene expression and DNA methylation.</p></list-item>
<list-item><p><italic>filter.probes:</italic> genomic ranges (i.e. distal regions) within which probes from DNA methylation data should be kept.</p></list-item>
<list-item><p><italic>met.na.cut:</italic> maximum percentage of empty values (NA) a probe might have to be considered in the analysis. Default is 20&#x0025; (i.e if 50&#x0025; of samples has empty values for a given probe, it will be removed).</p></list-item>
<list-item><p><italic>colData:</italic> A matrix with samples metadata (i.e. clinical data, molecular subtype information). If argument TCGA is set to <italic>TRUE</italic> this matrix will be created automatically. In this case <italic>colData</italic> argument is optional.</p></list-item>
<list-item><p><italic>sampleMap:</italic> A matrix mapping DNA methylation data and gene expression data to samples. <italic>ELMER</italic> uses only samples with both data. Otherwise it will be removed. If argument TCGA is set to <italic>TRUE</italic> this matrix will be created automatically. In this case <italic>sampleMap</italic> argument is optional.</p></list-item>
</list></p>
<statement>
<label>Listing 4.</label>
<title>&#x201C;Step 3: Create MultiAssayExperiment&#x201D;</title>
<p><preformat preformat-type="dialog">
mae &#x003C;- createMAE(exp = &#x201C;DATA /BRCA/BRCA_RNA_hg38.rda&#x201D;,
met = &#x201C;DATA /BRCA/BRCA_meth_hg38.rda&#x201D;,
met.platform = &#x201C;450K&#x201D;,
genome = &#x201C;hg38&#x201D;,
linearize.exp = TRUE,
filter.probes = distal.probes,
met.na.cut = 0.2,
save = TRUE,
TCGA = TRUE)
</preformat></p>
</statement>
<p>Listing 5 shows information about the object created. There are 866 samples with both gene expression and DNA methylation data, and among those 5 are metastatic samples, 778 are Primary Solid Tumor and 83 are Solid Tissue Normal.</p>
<statement>
<label>Listing 5.</label>
<title>&#x201C;Verifying MultiAssayExperiment&#x201D;</title>
<p><preformat preformat-type="dialog">
&#x003E; mae
A MultiAssayExperiment object of 2 listed
experiments with user-defined names and respective classes.
Containing an ExperimentList class object of length 2:
[1] DNA methylation: Range dSummarizedExperiment with 135331 rows and 866 columns
[2] Gene expression: Range dSummarizedExperiment with 57035 rows and 866 columns
Features:
experiments() - obtain the ExperimentList instance
colData() - the primary/phenotype DataFrame
sampleMap() - the sample availability DataFrame
&#x2018;&#x0024;&#x2019;, &#x2018;[&#x2019;, &#x2018;[[&#x2019; - extract colData columns, subset, or experiment
&#x002A; Format() - convert ExperimentList into a long or wide DataFrame
assays() - convert ExperimentList to a list of rectangular matrices
&#x003E; table(mae&#x0024;definition)
Metastatic Primary solid Tumor Solid Tissue Normal
5 778 83
</preformat></p>
</statement>
</sec>
<sec id="s3d">
<title>Identification of distal probes with significant differential DNA methylation (i.e. DMCs) in tumor vs. normal samples</title>
<p>The function <italic>get.diff.meth</italic> is used to identify regions differently methylation between two groups. Listing 6 shows how to use it to select hypomethylated probes in &#x201C;Primary solid tumor&#x201D; samples when compared to &#x201C;solid tissue normal&#x201D; samples <italic>(FDR &#x003C;</italic> 0.01,Amean <italic>&#x003E;</italic> 0.3), using those samples in the lower quintile <italic>(percentage</italic> = 0.2) of DNA methylation levels for each probe. Its main arguments are described below:
<list list-type="bullet">
<list-item><p><italic>data</italic> A multiAssayExperiment with DNA methylation and Gene Expression data.</p></list-item>
<list-item><p><italic>group. col</italic> A column defining the groups of the sample. You can view the available columns using: colnames(MultiAssayExperiment::colData(data)).</p></list-item>
<list-item><p><italic>group1</italic> A group from group.col. <italic>ELMER</italic> will run group1 vs group2. That means, if direction is hyper, get probes hypermethylated in group 1 compared to group 2.</p></list-item>
<list-item><p><italic>group2</italic> A group from group.col. <italic>ELMER</italic> will run group1 vs group2. That means, if direction is hyper, get probes hypermethylated in group 1 compared to group 2.</p></list-item>
<list-item><p><italic>diff.dir</italic> Differential methylation direction. It can be &#x201C;hypo&#x201D; which is only selecting hypomethylated probes in group 1 when compared to group 2; &#x201C;hyper&#x201D; which is only selecting hypermethylated probes;</p></list-item>
<list-item><p><italic>minSubgroupFrac</italic> A number ranging from 0 to 1, specifying the fraction of extreme samples from group 1 and group 2 that are used to identify the differential DNA methylation. The default is 0.2 because we typically want to be able to detect a specific (possibly unknown) molecular subtype among tumor; these subtypes often make up only a minority of samples, and 20&#x0025; was chosen as a lower bound for the purposes of statistical power. If you are using pre-defined group labels, such as treated replicates vs. untreated replicated, use a value of 1.0 (<italic>Supervised</italic> mode)</p></list-item>
<list-item><p><italic>pvalue</italic> A number specifying the significant P value (adjusted P value by Benjamini-Hochberg procedure) cutoff for selecting significant hypo/hyper-methylated probes. Default is 0.01.</p></list-item>
<list-item><p><italic>sig.dif</italic> A number specifying the smallest DNA methylation difference as a cutoff for selecting significant hypo/hyper-methylated probes. Default is 0.3.</p></list-item>
</list></p>
<statement>
<label>Listing 6.</label>
<title>&#x201C;Identify significantly different DNA methylation probes in tumor and normal samples&#x201D;</title>
<p><preformat preformat-type="dialog">
diff.probes &#x003C;- get.diff&#x00B7;meth(data = mae,
group.col = &#x201C;definition&#x201D;,
group1 = &#x201C;Primary solid Tumor&#x201D;,
group2 = &#x201C;Solid Tissue Normal&#x201D;,
diff.dir = &#x201C;hypo&#x201D;, # Get probes hypometh. in group 1
cores = 1,
minSubgroupFrac = 0.2, # &#x0025; group samples used.
pvalue = 0.01,
sig.dif = 0.3,
dir.out = &#x201C;Results_hypo/&#x201D;,
save = TRUE)
</preformat></p>
</statement>
<p>If the <italic>save</italic> argument is set to TRUE, in the <italic>dir. out</italic> folder two files will be created: <italic>getMethdiff.hypo.probes.csv</italic> containing all probes from the DNA methylation data with the difference means of the groups and the significance values, <italic>getMethdiff. hypo.probes. significant. csv</italic> will contain only probes that respect the thresholds. <xref ref-type="table" rid="tbl2">Table 2</xref> shows the first rows of <italic>getMethdiff. hypo.pro bes. significant. csv</italic> file.
<table-wrap id="tbl2" position="float" orientation="portrait"><label>Table 2.</label><caption><p>First three rows of getMethdiff.hypo. probes. significant. csv file.</p></caption>
<graphic xlink:href="148726_tbl2.tif"/>
</table-wrap>
</p>
<p>Also, users are able to verify the DNA methylation levels of a selected probe using the auxiliary function <italic>metBoxPlot</italic>, as showed in Listing 7. This function creates a boxplot for all samples and another one for the 20&#x0025; of samples used in the analysis for each probe as showed in plots 2 and 6.</p>
<statement>
<label>Listing 7.</label>
<title>&#x201C;Verify probes used in the comparison&#x201D;</title>
<p><preformat preformat-type="dialog">
metBoxPlot(mae,
group.col = &#x201C;definition&#x201D;,
group1 = &#x201C;Primary solid Tumor&#x201D;,
group2 = &#x201C;Solid Tissue Normal&#x201D;,
diff.dir = &#x201C;hypo&#x201D;,
probe = &#x201C;cg14058239&#x201D;,
minSubgroupFrac = 0.2)
</preformat></p>
</statement>
</sec>
<sec id="s3e">
<title>Identification of putative target gene(s) for differentially methylated distal probes</title>
<p>The function <italic>get.pair</italic> is used to link enhancer probes with methylation changes to target genes with expression changes and report the putative target gene for selected probes. Listing 8 shows how to select the 20 nearest genes (10 downstream and 10 upstream) and evaluate if each pair is anti-correlated (probes with higher methylation levels have lower gene expression levels). Its main arguments are described below:
<list list-type="bullet">
<list-item><p><italic>nearGenes</italic> Output of <italic>GetNearGenes</italic> function.</p></list-item>
<list-item><p><italic>minSubgroupFrac</italic> A number ranging from 0 to 1, specifying the fraction of extreme samples that define group U (unmethylated) and group M (methylated), which are used to link probes to genes. The default is 0.4 (the lowest quintile of samples is the U group and the highest quintile samples is the M group) because we typically want to be able to detect a specific (possibly unknown) molecular subtype among tumor; these subtypes often make up only a minority of samples, and 20&#x0025; was chosen as a lower bound for the purposes of statistical power. If you are using pre-defined group labels, such as treated replicates vs. untreated replicated, use a value of 1.0 (<italic>Supervised</italic> mode).</p></list-item>
<list-item><p><italic>permu.size</italic> Number of permutation. Default is 10000. <italic>Note:</italic> This parameter can strongly impact run time.</p></list-item>
<list-item><p><italic>pvalue</italic> Raw p-value cutoff for defining significant pairs. Default is 0.001.</p></list-item>
<list-item><p><italic>Pe</italic> Empirical p-value cutoff for defining significant pairs. Default is 0.001.</p></list-item>
<list-item><p><italic>filter.probes</italic> Should probes be filtered by selecting only those which has at least a certain number of samples below and above a certain cut-off? If true, arguments <italic>filter.probes</italic> and <italic>filter.percentage</italic> will be used.</p></list-item>
<list-item><p><italic>filter.portion</italic> A number specify the cut point to define binary methylation level for probe loci. Default is 0.3. When beta value is above 0.3, the probe is methylated and vice versa. For one probe, the percentage of methylated and unmethylated samples should be above filter. percentage value. Only used if <italic>filter.probes</italic> is TRUE.</p></list-item>
<list-item><p><italic>filter.percentage</italic> Minimum percentage of samples to be considered in methylated and unmethylated for the filter.portion option. Default 5&#x0025;. Only used if <italic>filter.probes</italic> is TRUE.</p></list-item>
</list></p>
<statement>
<label>Listing 8.</label>
<title>&#x201C;Step 5: Identify putative target genes for differentially methylated distal probes&#x201D;</title>
<p><preformat preformat-type="dialog">
# For each differently methylated probes we will get the
# 20 nearby genes (10 downstream and 10 upstream)
nearGenes &#x003C;- GetNearGenes(data = mae,
probes = diff.probes&#x0024;probe,
numFlankingGenes = 20,
cores = 1)
# This step is the most time consuming. Depending on the size of the groups
# and the number of probes found previously it migh take
Hypo.pair &#x003C;- get.pair(data = mae,
nearGenes = nearGenes,
group.col = &#x201C;definition&#x201D;,
group1 = &#x201C;Primary solid Tumor&#x201D;,
group2 = &#x201C;Solid Tissue Normal&#x201D;,
permu.dir = &#x201C;Results_hypo/permu&#x201D;,
permu.size = 10000,
minSubgroupFrac = 0.4, # 40&#x0025; of samples to create U and M
pvalue = 0.001,
Pe = 0.001,
filter.probes = TRUE,
filter.percentage = 0.05, filter.portion = 0.3,
dir.out = &#x201C;Results_hypo&#x201D;,
cores = 1,
label = &#x201C;hypo&#x201D;)
# Number of pairs: 2950
</preformat></p>
</statement>
<p>The output of this function is shown in <xref ref-type="table" rid="tbl3">table 3</xref>. Probe and GeneID columns shows the significant pair and <italic>P<sub>e</sub></italic> shows the adjusted p-value.
<table-wrap id="tbl3" position="float" orientation="portrait"><label>Table 3.</label><caption><p>First three rows of getPair.hypo.pairs.significant.csv file.</p></caption>
<graphic xlink:href="148726_tbl3.tif"/>
</table-wrap>
</p>
<p>To visualize the relationship between the probe-gene pairs inferred, there are two auxiliary functions in ELMER. The function <italic>schematic.plot</italic>, showed in Listing 9, which will plot genes and probes in a specified genomic region, highlighting the significant pairs identified by plotting a genomic interactions track and highlight the genes in the pair in red (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Also, using the function <italic>scatter.plot</italic> (Listing 10) it is possible to visualize the correlation between gene expression and DNA methylation levels at probe (<xref ref-type="fig" rid="fig4">Figure 4</xref>).
<fig id="fig3" position="float" orientation="portrait" fig-type="figure"><label>Figure 3.</label><caption><p>Plot probe gene pairs with annotation track for MCF-7 cell line from <monospace>StateHub.org.</monospace> Significant probes and gene pairs are highlighted in red.</p></caption><graphic xlink:href="148726_fig3.tif"/></fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure"><label>Figure 4.</label><caption><p>Scatter plot for significant probe (cg04723436) gene (GATA3) pair.</p></caption><graphic xlink:href="148726_fig4.tif"/></fig>
</p>
<statement>
<label>Listing 9.</label>
<title>&#x201C;Schematic plot to visualize gene-probe pairs&#x201D;</title>
<p><preformat preformat-type="dialog">
# by probe and with detail about DNA methylation
schematic&#x00B7;plot (data = mae,
group.col = &#x201C;definition&#x201D;,
group1 = &#x201C;Primary solid Tumor&#x201D;,
group2 = &#x201C;Solid Tissue Normal&#x201D;,
pair = Hypo.pair,
statehub.tracks = &#x201C;hg38/ENCODE/mcf-7.16mark.segmentation.bed&#x201D;,
byProbe = &#x201C;cg04723436&#x201D;)
</preformat></p>
</statement>
<statement>
<label>Listing 10.</label>
<title>&#x201C;Scatter plot to visualize correlation between gene expression and DNA methylation levels at probe&#x201D;</title>
<p><preformat preformat-type="dialog">
scatter. plot (data = mae,
byPair = list(probe = &#x201C;cg04723436&#x201D;,
gene = &#x201C;ENSG00000107485&#x201D;),
save = T,
category = &#x201C;definition&#x201D;,
lm = TRUE)
</preformat></p>
</statement>
</sec>
<sec id="s3f">
<title>Characterization of chromatin state context of significant probe regions using FunciVar</title>
<p>To understand and compare our set of probes identified in the probe-gene pairs inferred we used chromatin state of IHEC cell types from <ext-link ext-link-type="uri" xlink:href="http://statehub.org/,">http://statehub.org/,</ext-link> to calculate the relative enrichment of different states (see Additional file for the code). This procedure uses code from the statepaintR [<xref ref-type="bibr" rid="c22">22</xref>] and FunciVar [<xref ref-type="bibr" rid="c23">23</xref>] packages. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows the enrichment for 14 encode cells lines. The plot shows enrichment for active region (AR),enhancer active region (EAR), weak enhancer (EWR) and active promoter region (PAR) in MCF-7 cell (human breast adenocarcinoma cell line) while for other cell lines this enrichment is not visible.
<fig id="fig5" position="float" orientation="portrait" fig-type="figure"><label>Figure 5.</label><caption><p>Enrichment of paired probes and chromatin states of encode cells. The plot shows enrichment for active region (AR),enhancer active region (EAR), weak enhancer (EWR) and active promoter region (PAR) for MCF-7 cell. Acronyms - AR: Active region, EAR: active enhancer, EWR: Weak Enhancer, EPR: poised enhancer, PAR: active promoter, PWR: Weak Promoter, PPR: poised promoter, PPWR: Weak Poised Promoter, CTCF: architectural complex, TRS: transcribed, HET: heterochromatin, SCR: Polycomb Repressed Silenced</p></caption><graphic xlink:href="148726_fig5.tif"/></fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure"><label>Figure 6.</label><caption><p>Motif enrichment plot shows the enrichment levels (<italic>OR</italic> &#x2265; 2.0) for the selected motifs. This plot represents a subset of the enriched motifs for <italic>lower.or</italic> = 1.1, only selected for representational purposes.</p></caption><graphic xlink:href="148726_fig6.tif"/></fig>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure"><label>Figure 7.</label><caption><p>TF ranking plot shows statistic &#x2013;<italic>log</italic><sub>10</sub>(<italic>P</italic> &#x2013; <italic>value)</italic> assessing the anti-correlation level of TFs expression level with average DNA methylation level at sites with a given motif. By default, the top 3 associated TFs and the TF family members (dots in red) that are associated with that specific motif are labeled in the plot. But there is also a option show highlight only TF sub-family members (TCClass database classification) which is showed in the vignette.</p></caption><graphic xlink:href="148726_fig7.tif"/></fig>
</p>
</sec>
<sec id="s3g">
<title>Identification of enriched motifs within set of probes in significant probe-gene pairs</title>
<p>The function <italic>get.enriched.motif</italic> is used to identify enriched motif in a set of probes. The main arguments are described below:
<list list-type="bullet">
<list-item><p><italic>lower.OR</italic> The motif with lower boundary of 95&#x0025; confidence interval for Odds Ratio &#x2265; <italic>lower.OR</italic> are the significantly enriched motifs.</p></list-item>
<list-item><p><italic>min.incidence</italic> Minimum number of probes having the motif signature (default: 10) required for a motif to be enriched.</p></list-item>
</list></p>
<statement>
<label>Listing 11.</label>
<title>&#x201C;Step 6: Motif enrichment analysis on the selected probes&#x0022;</title>
<p><preformat preformat-type="dialog">
enriched.motif &#x003C;- get. enriched.motif (data = mae,
min.motif.quality = &#x0022;DS&#x0022;,
probes = unique (Hypo&#x00B7;pair &#x0024; Probe),
dir&#x00B7;out = &#x0022; Results_hypo &#x0022;,
label = &#x0022; hypo &#x0022;,
min&#x00B7;incidence = 10,
lower.OR = 1.1
</preformat></p>
</statement>
</sec>
<sec id="s3h">
<title>Identification of master regulator Transcription Factors (TF) for each enriched motif</title>
<p>The function <italic>get. TFs</italic> is used to identify regulatory TF whose expression associates with TF binding motif DNA methylation which.</p>
<statement>
<label>Listing 12.</label>
<title>&#x201C;Step 7: Identify regulatory Transcript Factors&#x201D;</title>
<p><preformat preformat-type="dialog">
TF &#x003C;- get.TFs(data = mae,
group.col = &#x201C;definition&#x201D;,
group1 = &#x201C;Primary solid Tumor&#x201D;,
group2 = &#x201C;Solid Tissue Normal&#x201D;,
minSubgroupFrac = 0.4, # Set to 1 if supervised mode
enriched.motif = enriched.motif,
dir.out = &#x201C;Results_hypo&#x201D;,
cores = 1,
label = &#x201C;hypo&#x201D;)
paste(sort(unique(TF&#x0024;top.potential.TF.family)),collapse = &#x201C;,&#x201D;)
# &#x201C;EMX1,ESR1,FOXA1,GATA3,HOMEZ,LMX1B,MYB,MZF1,NR2F6,OVOL1,PBX1,RARA,SPDEF,ZKSCAN1,ZSCAN16&#x201D;
paste (sort (unique (TF&#x0024;top. potential. TF. subfamily)),collapse = &#x201C;,&#x201D;)
# &#x201C;AR,EMX1,FOXA1,FOXD2,GATA3,HOMEZ,LMX1B,MYB,NR2E3,PBX1,ZKSCAN1,ZSCAN16&#x201D;
</preformat></p>
</statement>
<p>The result of this function is shown in <xref ref-type="table" rid="tbl4">table 4</xref> and in <xref ref-type="fig" rid="fig7">figure 7</xref>.
<table-wrap id="tbl4" position="float" orientation="portrait"><label>Table 4.</label><caption><p>First twenty rows of the <italic>get TF. hypo. significant. TFs. with. motif. summary. csv</italic> file created by <italic>get. Tfs</italic> function (suffix &#x201C;_HUMAN.H10MO&#x201D; was removed from motifs names). First column shows the enriched motif, &#x201C;top_5percent_TFs&#x201D; shows the top 5&#x0025; TFs ranked (the same as all TFs to the left of the dashed line in <xref ref-type="fig" rid="fig7">figure 7</xref>), &#x201C;potential.TFs.family&#x201D; are the TF from the &#x201C;top_5percent&#x201D; that belongs to the same family as the TF of the motif, &#x201C;top. potential.TFs.family&#x201D; is the highest ranked TF belonging to the same family as the TF of the motif (same as the first TF from &#x201C;potential.TFs.family&#x201D; column). The columns &#x201C;potential.TFs.subfamily&#x201D; and &#x201C;top.potential.TFs.subfamily&#x201D; are the same as &#x201C;potential.TFs.family&#x201D; and &#x201C;top.potential.TFs.family&#x201D; but considering the subfamily classification instead. For example, the motif ANDR has two TFs in the top 5&#x0025; that belongs to the same TF family (Steroid hormone receptors): ESR1 and AR, but if considering subfamilies only AR in considered.</p></caption>
<graphic xlink:href="148726_tbl4.tif"/>
</table-wrap>
</p>
</sec>
<sec id="s3i">
<title>Comparing inferred results with MCF-7 chIA-PET</title>
<p>As shown in Yao et al. [<xref ref-type="bibr" rid="c4">4</xref>], we compared the putative pairs inferred to the chromatin loops derived from deep-sequenced ChIA-PET data from MCF7 cells [<xref ref-type="bibr" rid="c25">25</xref>]. First, we identify the number of <italic>ELMER</italic> pairs overlapping the ChIA-PET loops, then we repeat using randomly generated pairs with properties similar to the <italic>ELMER</italic> pairs. For each true ELMER probe in a probe-gene pair, we randomly select a different probe from the complete set of distal probes. We then choose the nth nearest gene to the random probe, where n is the same as the adjacency of the true ELMER probe (i.e. if the true probe is linked to the second gene upstream, the random probe will also be linked to its second gene upstream). Thus, the random linkage set has both the same number of probes and the same number of linked genes as the true set. One hundred such random datasets were generated to arrive at a 95&#x0025; CI (&#x002B;/-1.96&#x002A; SD). The result is shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>. Of the 2108 putative pairs identified in breast cancer tumors 321 (approximately 15.2&#x0025;) were also identified as loops in the MCF7 ChIA-PET data. This was a three-fold enrichment over randomized probe-gene pairs (see Additional file for the code).
<fig id="fig8" position="float" orientation="portrait" fig-type="figure"><label>Figure 8.</label><caption><p>The graph shows the comparison of the number of probe-gene pairs identified within MCF7 ChIA-PET data using the putative pairs from BRCA vs. random pairs</p></caption><graphic xlink:href="148726_fig8.tif"/></fig>
</p>
</sec>
</sec>
<sec id="s4">
<title>Use Case 2: G-CIMP-low and G-CIMP-high (supervised approach)</title>
<p>We also performed <italic>ELMER</italic> analysis on GBM (glioblastoma multiforme) and LGG (Low grade glioma) data retrieved from TCGA comparing two know groups (IDH mutant and wild-type) [<xref ref-type="bibr" rid="c26">26</xref>]. The main arguments changed were the percentage of samples used to identify the differently methylated probes in function <italic>get.diff.meth</italic> which was set to 100&#x0025; (use all samples from each group) and the percentage of samples used to identify the putative gene-probe pairs in function <italic>get.pair</italic> and the regulatory TFs in function <italic>get.TFs</italic> which were also set to 100&#x0025; (Results and code can be found in the supplemental files.</p>
</sec>
<sec id="s5">
<title>Discussion</title>
<p>We present a new version of <italic>ELMER</italic>, an R/Bioconductor package that allows users to infer altered gene regulatory networks and master regulators, by linking expression changes to DNA methylation changes of nearby cis-regulatory elements. This version is greatly improved in terms of stability, performance, and extensibility. It also adds a number of new features, including support for support Human genome build 38, to the Infinium MethylationEPIC BeadChip array, import of datasets from the NCI Genomic Data Commons (GDC), and a new Supervised mode for analysis of paired sample study designs. It also performs motif and master regulator analysis using an expanded set of motifs and a well-maintained database for TF binding domain families and binding site preferences. It also provides greater support for Bioconductor standards (such as MultiAssayExperiment), and improved user interaction by improving messages and error handling, as well as newly designed, publication quality output plots. Our case study performed on a TCGA Breast Invasive Carcinoma (BTCGA-BRCA) dataset showed that GATA3, ESR1, FOXA1 were identified, consistent with research presented by Theodorou et al. [<xref ref-type="bibr" rid="c27">27</xref>] and our earlier work [<xref ref-type="bibr" rid="c4">4</xref>].</p>
</sec>
<sec id="s6" sec-type="availability">
<title>Data availability</title>
<p>The TCGA data was downloaded from the NCI Genomic Data Commons (GDC) data portal [<xref ref-type="bibr" rid="c7">7</xref>] using TCGAbiolinks R/Bioconductor package [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c28">28</xref>]. Gene annotations were retrieved from ENSEMBLE [<xref ref-type="bibr" rid="c15">15</xref>] database via biomaRt R/Bioconductor package[<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c21">21</xref>]. DNA methylation microarrays metadata were retrieved from <ext-link ext-link-type="uri" xlink:href="http://zwdzwd.github.io/InfiniumAnnotation">http://zwdzwd.github.io/InfiniumAnnotation</ext-link> [<xref ref-type="bibr" rid="c19">19</xref>]. Transcription factor (TF) binding models can be downloaded at HOCOMOCO database (<ext-link ext-link-type="uri" xlink:href="http://hocomoco.autosome.ru/">http://hocomoco.autosome.ru/</ext-link>) [<xref ref-type="bibr" rid="c10">10</xref>]. The list of human TF can be accessed at <ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org/">http://www.uniprot.org/</ext-link> [<xref ref-type="bibr" rid="c9">9</xref>]. The classification of human transcription factors (TFs) can be viewed at <ext-link ext-link-type="uri" xlink:href="http://tfclass.bioinf.med.uni-goettingen.de/tfclass">http://tfclass.bioinf.med.uni-goettingen.de/tfclass</ext-link> [<xref ref-type="bibr" rid="c11">11</xref>].</p>
</sec>
<sec id="s7" sec-type="availability">
<title>Software availability</title>
<p>This section will be generated by the Editorial Office before publication. Authors are asked to provide some initial information to assist the Editorial Office, as detailed below.
<list list-type="order">
<list-item><p>URL link to where the software can be downloaded from or used by a non-coder (AUTHOR TO PROVIDE; optional)</p></list-item>
<list-item><p>The source code of <italic>ELMER</italic> is available at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER">https://github.com/tiagochst/ELMER</ext-link> and the auxiliary data files are available <ext-link ext-link-type="uri" xlink:href="http://https://github.com/tiagochst/ELMER.data">https://github.com/tiagochst/ELMER.data</ext-link>.</p></list-item>
<list-item><p>Link to source code as at time of publication <italic>(F1000Research</italic> TO GENERATE)</p></list-item>
<list-item><p>Link to archived source code as at time of publication <italic>(F1000Research</italic> TO GENERATE)</p></list-item>
<list-item><p><italic>ELMER</italic> is available under the GNU General Public License version 3 (GNU GPL3)</p></list-item>
</list></p>
</sec>
</body>
<back>
<sec id="s8">
<title>Author contributions</title>
<p>BPB and HN conceived the study. TCS developed the new version of <italic>ELMER</italic> and <italic>ELMER.data</italic> package. TCS, SC and DH prepared the first draft of the manuscript. All authors were involved in the revision of the draft manuscript and have agreed to the final content. LY conceived and developed the original version of the <italic>ELMER</italic> package, and graciously advised on the improvements in this new version. BPB, TCS, SC are authors of the <italic>ELMER</italic> Bioconductor package.</p>
</sec>
<sec sec-type="COI-statement">
<title>Competing interests</title>
<p>No competing interests were disclosed</p>
</sec>
<sec id="s9" sec-type="funding">
<title>Grant information</title>
<p>This work has been supported by a grant from Henry Ford Hospital (H.N.) and by the S&#x00E3;o Paulo Research Foundation (FAPESP) (2016/01389-7 to T.C.S. &#x0026; H.N. and 2015/07925-5 to H.N.), T.C.S. and B.P.B. were supported by the NCI Informatics Technology for Cancer Research program, NIH/NCI grant 1U01CA184826, and Genomic Data Analysis Network NIH/NCI grant 1U24CA210969.</p>
</sec>
<ack><title>Acknowledgments</title>
<p>Lijing Yao for her assistance assistance with explanation of the codes of the initial version of <italic>ELMER</italic> tool available at <ext-link ext-link-type="uri" xlink:href="http://https://github.com/lijingya/ELMER">https://github.com/lijingya/ELMER</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://https://github.com/lijingya/ELMER.data">https://github.com/lijingya/ELMER.data</ext-link>.</p>
</ack>
<ref-list><title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><given-names>Benjamin P</given-names> <surname>Berman</surname></string-name>, <string-name><given-names>Daniel J</given-names> <surname>Weisenberger</surname></string-name>, <string-name><given-names>Joseph F</given-names> <surname>Aman</surname></string-name>, <string-name><given-names>Toshinori</given-names> <surname>Hinoue</surname></string-name>, <string-name><given-names>Zachary</given-names> <surname>Ramjan</surname></string-name>, <string-name><given-names>Yaping</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>Houtan</given-names> <surname>Noushmehr</surname></string-name>, <string-name><given-names>Christopher PE</given-names> <surname>Lange</surname></string-name>, <string-name><given-names>Cornelis M van</given-names> <surname>Dijk</surname></string-name>, <string-name><given-names>Rob AEM</given-names> <surname>Tollenaar</surname></string-name>, <etal>et al.</etal> <article-title>Regions of focal dna hypermethylation and long-range hypomethylation in colorectal cancer coincide with nuclear lamina-associated domains</article-title>. <source>Nature genetics</source>, <volume>44</volume>(<issue>1</issue>):<fpage>40</fpage>&#x2013;<lpage>46</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><given-names>Dvir</given-names> <surname>Aran</surname></string-name> and <string-name><given-names>Asaf</given-names> <surname>Hellman</surname></string-name>. <article-title>Dna methylation of transcriptional enhancers and cancer predisposition</article-title>. <source>Cell</source>, <volume>154</volume>(<issue>1</issue>):<fpage>11</fpage>&#x2013;<lpage>13</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><given-names>Lijing</given-names> <surname>Yao</surname></string-name>, <string-name><given-names>Benjamin P</given-names> <surname>Berman</surname></string-name>, and <string-name><given-names>Peggy J</given-names> <surname>Farnham</surname></string-name>. <article-title>Demystifying the secret mission of enhancers: linking distal regulatory elements to target genes</article-title>. <source>Critical reviews in biochemistry and molecular biology</source>, <volume>50</volume>(<issue>6</issue>):<fpage>550</fpage>&#x2013;<lpage>573</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><given-names>Lijing</given-names> <surname>Yao</surname></string-name>, <string-name><given-names>Hui</given-names> <surname>Shen</surname></string-name>, <string-name><given-names>Peter W</given-names> <surname>Laird</surname></string-name>, <string-name><given-names>Peggy J</given-names> <surname>Farnham</surname></string-name>, and <string-name><given-names>Benjamin P</given-names> <surname>Berman</surname></string-name>. <article-title>Inferring regulatory element landscapes and transcription factor networks from cancer methylomes</article-title>. <source>Genome biology</source>, <volume>16</volume>(<issue>1</issue>):<fpage>105</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><given-names>Tiago C</given-names> <surname>Silva</surname></string-name>, <string-name><given-names>Antonio</given-names> <surname>Colaprico</surname></string-name>, <string-name><given-names>Catharina</given-names> <surname>Olsen</surname></string-name>, <string-name><given-names>Fulvio</given-names> <surname>D&#x2019;Angelo</surname></string-name>, <string-name><given-names>Gianluca</given-names> <surname>Bontempi</surname></string-name>, <string-name><given-names>Michele</given-names> <surname>Ceccarelli</surname></string-name>, and <string-name><given-names>Houtan</given-names> <surname>Noushmehr</surname></string-name>. <article-title>Tcga workflow: Analyze cancer genomics and epigenomics data using bioconductor packages</article-title>. <source>F1000Research</source>, <volume>5</volume>, <year>2016</year>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><given-names>Katarzyna</given-names> <surname>Tomczak</surname></string-name>, <string-name><given-names>Patrycja</given-names> <surname>Czerwinska</surname></string-name>, <string-name><given-names>Maciej</given-names> <surname>Wiznerowicz</surname></string-name>, <etal>et al.</etal> <article-title>The cancer genome atlas (tcga): an immeasurable source of knowledge</article-title>. <source>Contemp Oncol (Pozn)</source>, <volume>19</volume>(<issue>1A</issue>):<fpage>A68</fpage>&#x2013;<lpage>A77</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><given-names>Robert L</given-names> <surname>Grossman</surname></string-name>, <string-name><given-names>Allison P</given-names> <surname>Heath</surname></string-name>, <string-name><given-names>Vincent</given-names> <surname>Ferretti</surname></string-name>, <string-name><given-names>Harold E</given-names> <surname>Varmus</surname></string-name>, <string-name><given-names>Douglas R</given-names> <surname>Lowy</surname></string-name>, <string-name><given-names>Warren A</given-names> <surname>Kibbe</surname></string-name>, and <string-name><given-names>Louis M</given-names> <surname>Staudt</surname></string-name>. <article-title>Toward a shared vision for cancer genomic data</article-title>. <source>New England Journal of Medicine</source>, <volume>375</volume>(<issue>12</issue>):<fpage>1109</fpage>&#x2013;<lpage>1112</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="website"><collab>Infinium methylationepic kit</collab>. <ext-link ext-link-type="uri" xlink:href="https://www.illumina.com/products/by-type/microarray-kits/infinium-methylation-epic.html">https://www.illumina.com/products/by-type/microarray-kits/infinium-methylation-epic.html</ext-link>. <date-in-citation>Accessed: <year>2017</year>-05-<day>30</day></date-in-citation>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><given-names>Rolf</given-names> <surname>Apweiler</surname></string-name>, <string-name><given-names>Amos</given-names> <surname>Bairoch</surname></string-name>, <string-name><given-names>Cathy H</given-names> <surname>Wu</surname></string-name>, <string-name><given-names>Winona C</given-names> <surname>Barker</surname></string-name>, <string-name><given-names>Brigitte</given-names> <surname>Boeckmann</surname></string-name>, <string-name><given-names>Serenella</given-names> <surname>Ferro</surname></string-name>, <string-name><given-names>Elisabeth</given-names> <surname>Gasteiger</surname></string-name>, <string-name><given-names>Hongzhan</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>Rodrigo</given-names> <surname>Lopez</surname></string-name>, <string-name><given-names>Michele</given-names> <surname>Magrane</surname></string-name>, <etal>et al.</etal> <article-title>Uniprot: the universal protein knowledgebase</article-title>. <source>Nucleic acids research</source>, <volume>32</volume>(<issue>suppl 1</issue>):<fpage>D115</fpage>&#x2013;<lpage>D119</lpage>, <year>2004</year>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><given-names>Ivan V</given-names> <surname>Kulakovskiy</surname></string-name>, <string-name><given-names>Ilya E</given-names> <surname>Vorontsov</surname></string-name>, <string-name><given-names>Ivan S</given-names> <surname>Yevshin</surname></string-name>, <string-name><given-names>Anastasiia V</given-names> <surname>Soboleva</surname></string-name>, <string-name><given-names>Artem S</given-names> <surname>Kasianov</surname></string-name>, <string-name><given-names>Haitham</given-names> <surname>Ashoor</surname></string-name>, <string-name><given-names>Wail</given-names> <surname>Ba-Alawi</surname></string-name>, <string-name><given-names>Vladimir B</given-names> <surname>Bajic</surname></string-name>, <string-name><given-names>Yulia A</given-names> <surname>Medvedeva</surname></string-name>, <string-name><given-names>Fedor A</given-names> <surname>Kolpakov</surname></string-name>, <etal>et al.</etal> <article-title>Hocomoco: expansion and enhancement of the collection of transcription factor binding sites models</article-title>. <source>Nucleic acids research</source>, <volume>44</volume>(<issue>D1</issue>):<fpage>D116</fpage>&#x2013;<lpage>D125</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><given-names>Edgar</given-names> <surname>Wingender</surname></string-name>, <string-name><given-names>Torsten</given-names> <surname>Schoeps</surname></string-name>, and <string-name><given-names>J&#x00FC;rgen</given-names> <surname>D&#x00F6;nitz</surname></string-name>. <article-title>Tfclass: an expandable hierarchical classification of human transcription factors</article-title>. <source>Nucleic acids research</source>, <volume>41</volume>(<issue>D1</issue>):<fpage>D165</fpage>&#x2013;<lpage>D170</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><given-names>Antonio</given-names> <surname>Colaprico</surname></string-name>, <string-name><given-names>Tiago C</given-names> <surname>Silva</surname></string-name>, <string-name><given-names>Catharina</given-names> <surname>Olsen</surname></string-name>, <string-name><given-names>Luciano</given-names> <surname>Garofano</surname></string-name>, <string-name><given-names>Claudia</given-names> <surname>Cava</surname></string-name>, <string-name><given-names>Davide</given-names> <surname>Garolini</surname></string-name>, <string-name><given-names>Thais S</given-names> <surname>Sabedot</surname></string-name>, <string-name><given-names>Tathiane M</given-names> <surname>Malta</surname></string-name>, <string-name><given-names>Stefano M</given-names> <surname>Pagnotta</surname></string-name>, <string-name><given-names>Isabella</given-names> <surname>Castiglioni</surname></string-name>, <etal>et al.</etal> <article-title>Tcgabiolinks: an r/bioconductor package for integrative analysis of tcga data</article-title>. <source>Nucleic acids research</source>, page gkv1507, <year>2015</year>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="website"><string-name><surname>MultiAssay</surname> <given-names>SIG</given-names></string-name>. <source>MultiAssayExperiment: Software for the integration of multi-omics experiments in Bioconductor</source>, <year>2017</year>. URL <ext-link ext-link-type="uri" xlink:href="http://https://github.com/waldronlab/MultiAssayExperiment/wiki/MultiAssayExperiment-API">https://github.com/waldronlab/MultiAssayExperiment/wiki/MultiAssayExperiment-API</ext-link>. R package version 1.2.0.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="website"><string-name><given-names>Hadley</given-names> <surname>Wickham</surname></string-name> and <string-name><given-names>Winston</given-names> <surname>Chang</surname></string-name>. <source>devtools: Tools to Make Developing R Packages Easier</source>, <year>2016</year>. URL <ext-link ext-link-type="uri" xlink:href="http://https://CRAN.R-project.org/package=devtools">https://CRAN.R-project.org/package=devtools</ext-link>. R package version 1.12.0.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="other"><string-name><given-names>Andrew</given-names> <surname>Yates</surname></string-name>, <string-name><given-names>Wasiu</given-names> <surname>Akanni</surname></string-name>, <string-name><given-names>M</given-names> <surname>Ridwan Amode</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Barrell</surname></string-name>, <string-name><given-names>Konstantinos</given-names> <surname>Billis</surname></string-name>, <string-name><given-names>Denise</given-names> <surname>Carvalho-Silva</surname></string-name>, <string-name><given-names>Carla</given-names> <surname>Cummins</surname></string-name>, <string-name><given-names>Peter</given-names> <surname>Clapham</surname></string-name>, <string-name><given-names>Stephen</given-names> <surname>Fitzgerald</surname></string-name>, <string-name><given-names>Laurent</given-names> <surname>Gil</surname></string-name>, <etal>et al.</etal> <article-title>Ensembl 2016</article-title>. <source>Nucleic acids research</source>, page gkv1157, <year>2015</year>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><given-names>Wolfgang</given-names> <surname>Huber</surname></string-name>, <string-name><given-names>Vincent J</given-names> <surname>Carey</surname></string-name>, <string-name><given-names>Robert</given-names> <surname>Gentleman</surname></string-name>, <string-name><given-names>Simon</given-names> <surname>Anders</surname></string-name>, <string-name><given-names>Marc</given-names> <surname>Carlson</surname></string-name>, <string-name><given-names>Benilton S</given-names> <surname>Carvalho</surname></string-name>, <string-name><given-names>Hector Corrada</given-names> <surname>Bravo</surname></string-name>, <string-name><given-names>Sean</given-names> <surname>Davis</surname></string-name>, <string-name><given-names>Laurent</given-names> <surname>Gatto</surname></string-name>, <string-name><given-names>Thomas</given-names> <surname>Girke</surname></string-name>, <etal>et al.</etal> <article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>. <source>Nature methods</source>, <volume>12</volume>(<issue>2</issue>):<fpage>115</fpage>&#x2013;<lpage>121</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><given-names>Wanding</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>Peter W</given-names> <surname>Laird</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Shen</surname></string-name>. <article-title>Comprehensive characterization, annotation and innovative use of infinium dna methylation beadchip probes</article-title>. <source>Nucleic Acids Research</source>, page gkw967, <year>2016</year>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><given-names>Steffen</given-names> <surname>Durinck</surname></string-name>, <string-name><given-names>Paul T</given-names> <surname>Spellman</surname></string-name>, <string-name><given-names>Ewan</given-names> <surname>Birney</surname></string-name>, and <string-name><given-names>Wolfgang</given-names> <surname>Huber</surname></string-name>. <article-title>Mapping identifiers for the integration of genomic datasets with the r/bioconductor package biomart</article-title>. <source>Nature protocols</source>, <volume>4</volume>(<issue>8</issue>): <fpage>1184</fpage>&#x2013;<lpage>1191</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><given-names>Wanding</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>Peter W.</given-names> <surname>Laird</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Shen</surname></string-name>. <article-title>Comprehensive characterization, annotation and innovative use of infinium dna methylation beadchip probes</article-title>. <source>Nucleic Acids Research</source>, <volume>45</volume>(<issue>4</issue>):<fpage>e22</fpage>, <year>2017</year>. doi: <pub-id pub-id-type="doi">10.1093/nar/gkw967</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkw967">http://dx.doi.org/10.1093/nar/gkw967</ext-link>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="other"><string-name><given-names>Yoav</given-names> <surname>Benjamini</surname></string-name> and <string-name><given-names>Yosef</given-names> <surname>Hochberg</surname></string-name>. <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the royal statistical society. Series B (Methodological)</source>, pages <fpage>289</fpage>&#x2013;<lpage>300</lpage>,<year>1995</year>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><given-names>Steffen</given-names> <surname>Durinck</surname></string-name>, <string-name><given-names>Yves</given-names> <surname>Moreau</surname></string-name>, <string-name><given-names>Arek</given-names> <surname>Kasprzyk</surname></string-name>, <string-name><given-names>Sean</given-names> <surname>Davis</surname></string-name>, <string-name><given-names>Bart De</given-names> <surname>Moor</surname></string-name>, <string-name><given-names>Alvis</given-names> <surname>Brazma</surname></string-name>, and <string-name><given-names>Wolfgang</given-names> <surname>Huber</surname></string-name>. <article-title>Biomart and bioconductor: a powerful link between biological databases and microarray data analysis</article-title>. <source>Bioinformatics</source>, <volume>21</volume>(<issue>16</issue>):<fpage>3439</fpage>&#x2013;<lpage>3440</lpage>, <year>2005</year>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="other"><string-name><given-names>Simon G</given-names> <surname>Coetzee</surname></string-name>, <string-name><given-names>Zachary</given-names> <surname>Ramjan</surname></string-name>, <string-name><given-names>Huy Q</given-names> <surname>Dinh</surname></string-name>, <string-name><given-names>Benjamin P</given-names> <surname>Berman</surname></string-name>, and <string-name><given-names>Dennis J</given-names> <surname>Hazelett</surname></string-name>. <article-title>Statehub-statepaintr: rapid and reproducible chromatin state evaluation for custom genome annotation</article-title>. <source>bioRxiv</source>, page <fpage>127720</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="website"><collab>Funcirvar</collab>. <ext-link ext-link-type="uri" xlink:href="http://https://github.com/Simon-Coetzee/funcivar">https://github.com/Simon-Coetzee/funcivar</ext-link>. <date-in-citation>Accessed: <year>2017</year>-06-<day>09</day></date-in-citation>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><given-names>Sven</given-names> <surname>Heinz</surname></string-name>, <string-name><given-names>Christopher</given-names> <surname>Benner</surname></string-name>, <string-name><given-names>Nathanael</given-names> <surname>Spann</surname></string-name>, <string-name><given-names>Eric</given-names> <surname>Bertolino</surname></string-name>, <string-name><given-names>Yin C</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Peter</given-names> <surname>Laslo</surname></string-name>, <string-name><given-names>Jason X</given-names> <surname>Cheng</surname></string-name>, <string-name><given-names>Cornelis</given-names> <surname>Murre</surname></string-name>, <string-name><given-names>Harinder</given-names> <surname>Singh</surname></string-name>, and <string-name><given-names>Christopher K</given-names> <surname>Glass</surname></string-name>. <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and b cell identities</article-title>. <source>Molecular cell</source>, <volume>38</volume>(<issue>4</issue>):<fpage>576</fpage>&#x2013;<lpage>589</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><given-names>Guoliang</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Xiaoan</given-names> <surname>Ruan</surname></string-name>, <string-name><given-names>Raymond K</given-names> <surname>Auerbach</surname></string-name>, <string-name><given-names>Kuljeet Singh</given-names> <surname>Sandhu</surname></string-name>, <string-name><given-names>Meizhen</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>Ping</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Huay Mei</given-names> <surname>Poh</surname></string-name>, <string-name><given-names>Yufen</given-names> <surname>Goh</surname></string-name>, <string-name><given-names>Joanne</given-names> <surname>Lim</surname></string-name>, <string-name><given-names>Jingyao</given-names> <surname>Zhang</surname></string-name>, <etal>et al.</etal> <article-title>Extensive promoter-centered chromatin interactions provide a topological basis for transcription regulation</article-title>. <source>Cell</source>, <volume>148</volume>(<issue>1</issue>):<fpage>84</fpage>&#x2013;<lpage>98</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><given-names>Michele</given-names> <surname>Ceccarelli</surname></string-name>, <string-name><given-names>Floris P</given-names> <surname>Barthel</surname></string-name>, <string-name><given-names>Tathiane M</given-names> <surname>Malta</surname></string-name>, <string-name><given-names>Thais S</given-names> <surname>Sabedot</surname></string-name>, <string-name><given-names>Sofie R</given-names> <surname>Salama</surname></string-name>, <string-name><given-names>Bradley A</given-names> <surname>Murray</surname></string-name>, <string-name><given-names>Olena</given-names> <surname>Morozova</surname></string-name>, <string-name><given-names>Yulia</given-names> <surname>Newton</surname></string-name>, <string-name><given-names>Amie</given-names> <surname>Radenbaugh</surname></string-name>, <string-name><given-names>Stefano M</given-names> <surname>Pagnotta</surname></string-name>, <etal>et al.</etal> <article-title>Molecular profiling reveals biologically discrete subsets and pathways of progression in diffuse glioma</article-title>. <source>Cell</source>, <volume>164</volume> (<issue>3</issue>):<fpage>550</fpage>&#x2013;<lpage>563</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><given-names>Vasiliki</given-names> <surname>Theodorou</surname></string-name>, <string-name><given-names>Rory</given-names> <surname>Stark</surname></string-name>, <string-name><given-names>Suraj</given-names> <surname>Menon</surname></string-name>, and <string-name><given-names>Jason S</given-names> <surname>Carroll</surname></string-name>. <article-title>Gata3 acts upstream of foxa1 in mediating esr1 binding by shaping enhancer accessibility</article-title>. <source>Genome research</source>, <volume>23</volume>(<issue>1</issue>):<fpage>12</fpage>&#x2013;<lpage>22</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><given-names>TC</given-names> <surname>Silva</surname></string-name>, <string-name><given-names>A</given-names> <surname>Colaprico</surname></string-name>, <string-name><given-names>C</given-names> <surname>Olsen</surname></string-name>, <string-name><given-names>F</given-names> <surname>D&#x2019;Angelo</surname></string-name>, <string-name><given-names>G</given-names> <surname>Bontempi</surname></string-name>, <string-name><given-names>M</given-names> <surname>Ceccarelli</surname></string-name>, and <string-name><given-names>H</given-names> <surname>Noushmehr</surname></string-name>. <article-title>Tcga workflow: Analyze cancer genomics and epigenomics data using bioconductor packages [version 2; referees: 1 approved, 2 approved with reservations]</article-title>. <source>F1000Research</source>, <volume>5</volume>(<year>1542</year>), <fpage>2016</fpage>. doi: <pub-id pub-id-type="doi">10.12688/f1000research.8923.2</pub-id>.</mixed-citation></ref>
</ref-list></back>
</article>