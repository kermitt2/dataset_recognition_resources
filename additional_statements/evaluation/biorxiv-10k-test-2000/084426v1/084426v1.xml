<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/084426</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Ancestry in adapting, spatially-extended populations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7799-1573</contrib-id>
<name>
<surname>Weissman</surname>
<given-names>Daniel B.</given-names>
</name>
</contrib>
<aff id="aff1"><institution>Dept. of Physics, Emory University</institution>, Atlanta, GA 30322</aff>
</contrib-group>
<pub-date pub-type="epub">
<year>2016</year>
</pub-date>
<elocation-id>084426</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>10</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="084426.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Selective sweeps affect neutral genetic diversity through hitchhiking. While this effect is limited to the local genomic region of the sweep in panmictic populations, we find that in spatially-extended populations the combined effects of many unlinked sweeps can affect patterns of ancestry (and therefore neutral genetic diversity) across the whole genome. Even low rates of sweeps can be enough to skew the spatial locations of ancestors such that neutral mutations that occur in individuals living outside a small region in the center of the range have virtually no chance of fixing in the population.</p>
</abstract>
<counts>
<page-count count="15"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>In large populations even a fairly low rate of selective sweeps is sufficient to reduce diversity across most of the genome via hitchhiking [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>]. Most modeling of the effects of hitchhiking on diversity has considered well-mixed populations. However, the effects are potentially quite different in spatially-extended populations, because instead of quickly fixing through logistic growth, sweeps must spread out in a spatial wave of advance over the whole range [<xref ref-type="bibr" rid="c3">3</xref>]. [<xref ref-type="bibr" rid="c4">4</xref>] recently showed that this increase in the time to sweep tends to reduce the size of the genomic region over which diversity is depressed by a sweep.</p>
<p>While the effect of sweeps on genetic diversity at linked loci is therefore reduced by spatial structure, we show here that collective effect of sweeps on the diversity at <italic>unlinked</italic> loci can be much stronger than in panmictic populations. Surprisingly, this effect is dependent on the geometry of the range - it only appears for realistic range shapes with relatively well-defined central regions, not for the perfectly symmetric idealizations of ring-shaped and toroidal ranges often used in theoretical models. In particular, we find that probability of fixation of an allele can be strongly position-dependent, with alleles near the center of the range orders of magnitude more likely to fix than those at typical locations. This can produce a false signal of a population expansion (in number, not space) even at loci on chromosomes where no adaptation is taking place. The basic mechanism driving this effect is that sweeps tend to arrive at each location from the direction of the center of the range, and so bias the ancestry back towards the center.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<p>We wish to find the expected number of copies that an allele found in an individual at spatial position x will leave far in the future, i.e., its reproductive value [<xref ref-type="bibr" rid="c5">5</xref>], which we denote &#x03D5;(x). Equivalently, &#x03D5;(x)&#x03C1;(x), where &#x03C1; is the population density, is the probability density of a present-day individual's ancestor being at location x at some time in the distant past. [<xref ref-type="bibr" rid="c6">6</xref>] showed that in the absence of selection, &#x03D5;(x)&#x2261;1 regardless of the details of the population structure, as long as dispersal does not change expected allele frequencies. Here we show that this result does not extend to populations undergoing selection. Populations living in perfectly symmetric ranges (circles in one dimension, tori in two) necessarily have &#x03D5;(x)&#x2261;1, but when this symmetry is broken, recurrent sweeps can create a substantial imbalance, making much higher in a small region in the center of the range and decreasing it everywhere else.</p>
</sec>
<sec id="s3">
<title>Model</title>
<p>We consider a population with uniform, constant density &#x03C1; distributed over a d-dimensional range with radius L, with uniform local dispersal with diffusion constant D. We assume that selective sweeps with advantage s occur in the population at a rate per generation, originating at points uniformly distributed over time and space. As long as the density is sufficiently high (&#x03C1; &#x0226B;(s/D)<sup>d/2</sup>/s, [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c4">4</xref>]), they will spread roughly deterministically in waves with speed <inline-formula><alternatives><inline-graphic xlink:href="084426_inline1.gif"/></alternatives></inline-formula> with characteristic wavefront width <inline-formula><alternatives><inline-graphic xlink:href="084426_inline2.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="c3">3</xref>], which we take to be much smaller than the range size, l&#x226A; L. We assume that A is low enough compared to the frequency of outcrossing, <italic>f</italic>, and the average number of crossovers per outcrossing, <italic>K</italic>, that the waves do not interfere with each other. The definitions of symbols are collected in <xref ref-type="table" rid="tbl1">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Symbol definitions</p></caption>
<graphic xlink:href="084426_tbl1.tif"/>
</table-wrap>
<sec id="s3a">
<title>One and two dimensions</title>
<p>We consider both one-dimensional ranges (lines with length 2L) and two-dimensional ranges. In two dimensions, the shape of the range will have some effect on many of our results; however, as long as the shape is fairly &#x201C;nice&#x201D;, with a clear center and single characteristic length scale <italic>L</italic>, this effect will be modest. We will therefore ignore it for simplicity. For our purposes, the main difference between one and two dimensions will be in the density of individuals a distance <italic>x</italic> from the center, &#x03C1;(<italic>x</italic>). Since we are assuming a uniform spatial density, in one dimension this is just, &#x03C1;, a constant. In two dimensions, however, we must account for the fact that there is more area at larger <italic>x</italic>, and thus <inline-formula><alternatives><inline-graphic xlink:href="084426_inline3.gif"/></alternatives></inline-formula>. (Obviously, &#x03C1;(<italic>x &#x003E; L</italic>) = 0 in both one and two dimensions.)</p>
</sec>
</sec>
<sec id="s5">
<title>Results</title>
<p>A sweep at a tightly-linked locus a genetic map distance r &#x226A;s away pulls a lineage a distance that is approximately exponentially distributed with mean c/r, going backwards in time. This is only approximate, because actually there is an upper cutoff at the distance to the origin of the sweep [<xref ref-type="bibr" rid="c4">4</xref>]. For sweeps at loosely-linked loci with r&#x226B;s, the lineage is only pulled an expected distance c/2r (see Appendix A). However, since the average displacement still only falls off like 1/r, and since there is an upper cutoff on the effect of sweeps as <italic>r</italic> &#x2192; 0, the total average displacement for a typical locus can be dominated by the effect of the many unlinked sweeps rather than the few linked ones, assuming that sweeps are uniformly distributed over the genome, and that the genome is long. We will make the approximation that the expected displacement is solely due to unlinked sweeps, with <italic>r = f/2</italic>; we will consider the additional effects of the rare, tightly-linked sweeps below.</p>
<p>For a lineage a distance <italic>x</italic> from the center, there is an excess of approximately &#x007E;A<italic>x/L</italic> sweeps per generation pulling it back toward the center, each of which pulls it an expected distance c/f. (Note that the effect of the upper cutoff on the displacement from these sweeps is negligible as long as <italic>L &#x226B; c/f.</italic>) The expected distance from the center therefore decays exponentially (backwards in time) like
<disp-formula id="eqn1"><alternatives><graphic xlink:href="084426_eqn1.gif"/></alternatives></disp-formula></p>
<p>This implies that there is a time <italic>t</italic><sub>con</sub> before which individuals' ancestors are unlikely to be found outside the center of the range, with
<disp-formula id="eqn2"><alternatives><graphic xlink:href="084426_eqn2.gif"/></alternatives></disp-formula></p>
<p>This deterministic move back to the center is opposed by dispersal, and also by the effect of occasional tightly-linked sweeps which pull the lineage a distance &#x007E;<italic>L</italic>, effectively randomizing its position. The balances between these forces means that the ancestry of the population is not completely concentrated at the center of the range, but is instead distributed around it in some region of size &#x007E;<italic>x<sub>c</sub></italic>.</p>
</sec>
<sec id="s6">
<title>Balance with dispersal</title>
<p>If tightly-linked sweeps are relatively rare, either because the overall rate of sweeps is low or because the focal locus lies in a region of the genome that is not undergoing much adaptation, the main balance will be between the diffusive effect of dispersal and the pull of unlinked sweeps. In this case, the position of the ancestry is an Ornstein-Uhlenbeck process. The stationary distribution is therefore normal and concentrated in the center of the range according to:
<disp-formula id="eqn3"><alternatives><graphic xlink:href="084426_eqn3.gif"/></alternatives></disp-formula></p>
<p>If <italic>x<sub>c</sub>&#x226A;L</italic>, then the reproductive value of an individual at the center of the range can be orders of magnitude higher than than one at a typical distance &#x007E;<italic>L/2</italic> from the center (<xref ref-type="fig" rid="fig1">Fig. 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Unlinked sweeps concentrate ancestry in the center of the range. The plot shows the long-term probability of finding the ancestor of a neutral allele at a given deme in a linear range. The purple histogram shows full-population forward simulations, the blue histogram shows approximate backwards simulations, and the blue curve shows the predicted distribution, <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>. The dotted black line shows a uniform distribution. Parameters are <italic>L = 500,&#x03C1; = 100,s = 0:05, D = 0:125, = 0:1, f = 1, K = 100</italic>; see Appendix D for simulation methods.</p></caption>
<graphic xlink:href="084426_fig1.tif"/>
</fig>
<p>From <xref ref-type="disp-formula" rid="eqn1">Eq. (3)</xref>, we see that the ancestral range will be substantially reduced by selection if the rate of sweeps per sexual generation is greater than the ratio of the cline width to the range size: &#x2227;/<italic>f &#x003E; l/L</italic>. It is unclear what ranges these ratios take in natural populations. &#x2227;/<italic>(fK)</italic> is unlikely to be much more than <inline-formula><alternatives><inline-graphic xlink:href="084426_inline4.gif"/></alternatives></inline-formula> (1) [<xref ref-type="bibr" rid="c2">2</xref>], but in organisms with many chromosomes (large <italic>K</italic>), &#x2227;/<italic>f</italic> may be substantial. Looking at the right-hand side of the inequality, modeling sweeping alleles by waves spreading across the range necessarily requires <italic>l/L &#x226A;1</italic>, so even small values of A/f may be enough to distort the distribution of ancestry. Surprisingly little is known about typical values of l for the waves of advance of sweeping alleles in nature, but it seems plausible that for many species it should be much smaller than the total species range [<xref ref-type="bibr" rid="c3">3</xref>]. For the spread of insecticide resistance in <italic>Culex pipiens</italic> in southern France, the width of the wave of advance was &#x007E;20 km [<xref ref-type="bibr" rid="c8">8</xref>], much smaller than the global scale of the species range, but the dynamics were more complex than a simple selective sweep [<xref ref-type="bibr" rid="c9">9</xref>]. Much more is known about the width of stable clines and hybrid zones, which are frequently much smaller than species ranges [<xref ref-type="bibr" rid="c10">10</xref>]. To the extent that the selection maintaining them is comparable in strength to the selection driving sweeps, these should have roughly the same width as the wavefronts.</p>
</sec>
<sec id="s7">
<title>Balance with tightly-linked sweeps</title>
<p>Finding the balance between concentrating effect of unlinked sweeps and the randomizing effect of tightly-linked sweeps is slightly trickier. Indeed, finding an exact expression for &#x03D5;(<italic>x</italic>) is intractable. However, we can find an approximate expression by using the fact that the mean squared displacement of the ancestral lineage due to linked sweeps is dominated by rare very tightly-linked sweeps rather than the many loosely-linked ones [<xref ref-type="bibr" rid="c4">4</xref>]. This suggests that for large <italic>x</italic>, the probability that an individual's ancestor was farther than <italic>x</italic> from the center at time <italic>t</italic><sub>0</sub> in the distant past is roughly just the probability that a single very tightly-linked sweep pulled it there at some time within &#x007E; <italic>t</italic><sub>con</sub> generations of t<sub>0</sub>. Since the distance that a sweep at recombination fraction <italic>r</italic> pulls the lineage goes like 1/<italic>r</italic>, the rate of sweeps close enough on the genome to pull the ancestry a distance of at least <italic>x</italic> falls off like 1/<italic>x</italic>. Therefore, the probability of finding the ancestry at a distance of at least <italic>x</italic> should also fall off like 1/<italic>x</italic>; the probability density of being exactly at <italic>x</italic>, &#x03D5;(<italic>x</italic>)&#x03C1;(<italic>x</italic>), should then fall off like 1/<italic>x</italic><sup>2</sup>.</p>
<p>In the appendix, we calculate this more formally, and find
<disp-formula id="eqn4"><alternatives><graphic xlink:href="084426_eqn4.gif"/></alternatives></disp-formula></p>
<p>The factor 1&#x2013;(<italic>x/L</italic>)<sup>d</sup> (where <italic>d</italic> = 1 or 2 is the dimension of the habitat) reflects the fact that for very large <italic>x, x&#x007E;L</italic>, most sweeps start at distances less than <italic>x</italic> and cannot pull the lineage that far from the center. For <italic>x&#x226A;x<sub>c</sub> = 2L/K</italic>, lineages will tend to experience many sweeps pulling them distances greater than <italic>x</italic> in time <italic>t<sub>con</sub></italic>, so the approximation used to derive <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> breaks down; for these small values of <italic>x</italic>, the randomizing effects of moderately-linked sweeps smooth out &#x03D5;(<italic>x</italic>) and make it roughly constant.</p>
<p>Barton et al. describe the randomizing effect of tightly-linked sweeps by &#x201C;D<sub>e</sub>,&#x201D; an effective dispersal rate, with <inline-formula><alternatives><inline-graphic xlink:href="084426_inline5.gif"/></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> of [<xref ref-type="bibr" rid="c4">4</xref>]). Comparing <xref ref-type="disp-formula" rid="eqn3">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>, however, we see that their effect cannot simply be described as an increase in the dispersal rate, since they create a much longer tail in the spatial distribution of ancestry. Because of this, it is possible that while the bulk of the distribution of ancestry is determined by a balance between unlinked sweeps and dispersal, with linked sweeps too rare to make a difference, linked sweeps make the dominant contribution to the tails of the ancestry distribution (<xref ref-type="fig" rid="fig3">Fig. 3</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Tracing the ancestry of an individual back through time. Individuals throughout the range rapidly trace their ancestry at a neutral locus back to a small region in the center of the range. The width of this region is determined by strength of dispersal. The occasional excursions out of the center are due to hitchhiking on tightly-linked sweeps. Parameters are <italic>L = 500, s = 0:05, D = 0:125, A= 1, f = 1, K = 300</italic>. Each curve is an independent simulation.</p></caption>
<graphic xlink:href="084426_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>The long-term probability of finding the ancestor of a neutral allele at a given deme in a linear range. The blue histogram shows approximate backwards simulations, the dotted black line shows a uniform distribution, and the blue curve shows the predicted distribution, <xref ref-type="disp-formula" rid="eqn3">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>. Typical loci are in the center of the range, in a balance between the pull of unlinked sweeps and dispersal (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>), but the (small) probability that the ancestor is found outside the center of the range is dominated by the probability that there has recently been a tightly-linked sweep (<xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>). Parameters are as in <xref ref-type="fig" rid="fig2">Fig. 2</xref>.</p></caption>
<graphic xlink:href="084426_fig3.tif"/>
</fig>
</sec>
<sec id="s8">
<title>Combining dispersal and tightly-linked sweeps</title>
<p>Combining <xref ref-type="disp-formula" rid="eqn3">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>, we see that unlinked sweeps reduce the effective size of the ancestral range by a factor <italic>x<sub>c</sub>/L</italic>:
<disp-formula id="eqn5"><alternatives><graphic xlink:href="084426_eqn5.gif"/></alternatives></disp-formula></p>
<p>For typical numbers of chromosomes <italic>K</italic>, it would seem that ancestry could be concentrated by about an order of magnitude. However, the result 2/K was derived under the assumption that sweeps are distributed uniformly across the genome. If, on the other hand, adaptation is mostly occurring in just a few genes, the rest of the genome will not experience any tightly-linked sweeps, and ordinary dispersal will be the only force counteracting the concentration, meaning that the effect could potentially be much stronger. This has the surprising implication that selection can have a stronger effect on some features of the spatial distribution of ancestry at far-away loci than at those nearby.</p>
</sec>
<sec id="s9">
<title>Effect on diversity</title>
<p>While the effect of recurrent sweeps on neutral diversity can be quite large, detecting the effect in data from real populations may be tricky. It might seem to be indistinguishable from a range expansion in the absence of time-series data, but there is a simple way to tell them apart: under recurrent sweeps, there is no serial founder effect reducing diversity away from the center. One way to see this is by looking at isolation by distance. The probability &#x03D5;(<italic>x</italic>) that two individuals separated by a distance <italic>x</italic> are genetically identical can be written in terms of the neutral mutation rate and their coalescence time <italic>T</italic> as
<disp-formula id="eqn6"><alternatives><graphic xlink:href="084426_eqn6.gif"/></alternatives></disp-formula></p>
<p>For <italic>x</italic> large compared to the size of a single deme (i.e., the spatial scale over which individuals interact within a generation) and loci far on the genome from any recent sweeps, there are two simple regimes for <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref>. If <italic>x&#x226A;x<sub>c</sub></italic>, then we expect that the pull due to sweeps should be unimportant, and &#x03D5;(<italic>x</italic>) is just given by the neutral value, <inline-formula><alternatives><inline-graphic xlink:href="084426_inline6.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="c11">11</xref>], which says that the probability of identity falls off rapidly with distance. On the other hand, larger values of x are quickly collapsed by the pull of sweeps in time &#x007E;log(<italic>x</italic>)/<italic>t<sub>con</sub></italic>, so we expect that &#x03D5; should be of the form <inline-formula><alternatives><inline-graphic xlink:href="084426_inline7.gif"/></alternatives></inline-formula>. A detailed calculation in Appendix C con rms that this is true for <italic>x</italic> &#x226B; <inline-formula><alternatives><inline-graphic xlink:href="084426_inline8.gif"/></alternatives></inline-formula>. The probability of identity thus has a long tail in distance - individuals at opposite sides of the range (separated by &#x2248;2<italic>L</italic>) are nearly as related as individuals separated by, say, L/2. Notice that &#x03D5; does not depend on from where in the range we sampled the pair of individuals. This implies that, while reproductive value is concentrated in the center of the range, genetic diversity is more evenly spread, distinguishing this scenario from a range expansion.</p>
<p>Above, we have ignored loci that are close to recent sweeps. If we are considering large enough loci so that <italic>&#x03BC;t<sub>con</sub></italic> &#x226B; 1, then usually only these recently swept regions will be identical between individuals from different parts of the range. In this case, because each sweep causes coalescence between individuals separated by a large distance x over a region of genome with length<inline-formula><alternatives><inline-graphic xlink:href="084426_inline9.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="c4">4</xref>], &#x03D5; should still have a long tail, but with an exponent that is independent of the population parameters,<inline-formula><alternatives><inline-graphic xlink:href="084426_inline10.gif"/></alternatives></inline-formula> (see Appendix C.1). This characteristic exponent is another effect of rare, tightly-linked sweeps that cannot be accounted for by any effective dispersal rate <italic>D</italic><sub>eff</sub>.</p>
</sec>
<sec id="s10">
<title>Discussion</title>
<p>Because selection and demography are often difficult or impossible to measure directly in natural populations, both are typically inferred from patterns of genetic diversity. This inference can be difficult, because the two processes can produce similar signals. For instance, both purifying selection and population expansion tend to produce site frequency spectra with a relative excess of rare alleles. In order to tease apart the two factors, demography is often first inferred using data from loci that are thought to be neutral, and then the answer is used to infer the pattern of selection at the remaining loci. However, in order for the demography to be inferred correctly, this method requires that the first set of loci be not just neutral, but also unaffected by selection at linked loci. Typically, this is done by using loci that are far from sites where selection is thought to have been important (e.g., [<xref ref-type="bibr" rid="c12">12</xref>]). Our results suggest that this may be problematic in spatially-structured populations - even diversity at these loci may be strongly affected by unlinked sweeps.</p>
</sec>
<sec id="s11">
<title>Geometry, not topology, of range is important</title>
<p>Our results might seem to show that the genetic diversity in a population depends sensitively on the topology of the range and can therefore change drastically as the result of small perturbations to the environment. For example, a circular range (which has no concentration of ancestry since it is perfectly symmetric) can be transformed into a linear one (with very concentrated ancestry) by removing a single point. However, this is a misleading interpretation. In fact, a &#x201C;circular&#x201D; range is an annulus with radius large compared to its thickness (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>). A small perturbation that slightly reduces the population in one part of the range will only have a correspondingly small effect on the distribution of ancestry (<xref ref-type="fig" rid="fig4">Fig. 4b</xref>), and the bias of the ancestry ancestry increases smoothly as the perturbation grows (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>), until the annulus is completely pinched off (<xref ref-type="fig" rid="fig4">Fig. 4d</xref>). More generally, the common-sense intuition that the pattern of diversity should not depend on the details of the shape of the range is correct. All that matters is the extent to which there is a &#x201C;central region&#x201D; that sweeps tend to pass through on their way to dominating the population.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p>The distribution of ancestry depends smoothly on the shape of the range as it deforms from a perfectly symmetric circle (a) to a curve with endpoints (d). Shading represents the reproductive value of each location, from high (dark) to low (light). In (a), the ancestry is necessarily evenly distributed. Slight asymmetries in the shape of the range introduce slight differences in the distribution of ancestry (b). When the range has a well-defined middle (d), the ancestry is concentrated there; including a weak connection between the end of the range (c) does not change this much.</p></caption>
<graphic xlink:href="084426_fig4.tif"/>
</fig>
</sec>
<sec id="s12">
<title>Extensions</title>
<p>We have focused on a very simple population model. Here we consider several possible modifications. First, we have assumed that the density &#x03C1; is constant in time. If density fluctuations typically occur on timescales longer than <italic>t<sub>con</sub></italic>, this approximation should be accurate, and if they are rapid compared to the sweep time L/c they should average out, but it is unclear how fluctuations on moderate timescales should interact with dynamics discussed here.</p>
<p>We have also neglected the possibility of rare long-range dispersal. Tightly-linked sweeps already effec-tively produce occasional long-range jumps in the ancestry of neutral sites, so adding long-range dispersal might not have a large direct effect, but it is likely to have dramatic effects on how sweeps spread [<xref ref-type="bibr" rid="c13">13</xref>], and therefore a large indirect effect on the hitchhiking dynamics. It is not at all clear what this effect should be - on the one hand, the sweeps will spread faster, increasing their pull, but on the other hand, the direction of that pull may be less reliably towards the center.</p>
<p>We have also neglected the possibility that many sweeps may be &#x201C;soft&#x201D;, starting from multiple alleles [<xref ref-type="bibr" rid="c14">14</xref>]. If these alleles typically descend from a recent single ancestor, i.e, are concentrated in a small region at the time when they begin to sweep, then the results should be essentially unchanged, with the possible exception of the coalescent effects of tightly-linked sweeps (Appendix C.1). The same should be true if sweeps are &#x201C;firm&#x201D;, i.e., multiple mutant lineages contribute to each sweep, but the most successful one typically colonizes most of the population. But sweeps in which many widely-spread mutations contribute equally would likely not consistently concentrate ancestry in space.</p>
<p>We have focused on the effect of sweeps on neutral variation, but they will of course also a ect selected alleles. Most obviously, if recombination is limited they will interfere with each other [<xref ref-type="bibr" rid="c15">15</xref>]. They will interfere even more strongly with weakly-selected variants. We are currently preparing a manuscript addressing these issues. It is also important to consider how the concentration of reproductive value interacts with spatially-varying selection. It seems plausible that it would reduce the potential for local adaptation and thereby limit population ranges.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work would not have been possible without Nick Barton's generous assistance at all stages.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[<xref ref-type="bibr" rid="c1">1</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname> <given-names>JH</given-names></string-name> (<year>2000</year>) <article-title>Genetic drift in an in nite population: the pseudohitchhiking model</article-title>. <source>Genetics</source> <volume>155</volume>: <fpage>909</fpage>&#x2013;<lpage>919</lpage>.</mixed-citation></ref>
<ref id="c2"><label>[<xref ref-type="bibr" rid="c2">2</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Weissman</surname> <given-names>DB</given-names></string-name>, <string-name><surname>Barton</surname> <given-names>NH</given-names></string-name> (<year>2012</year>) <article-title>Limits to the rate of adaptive substitution in sexual populations</article-title>. <source>PLoS Genetics</source> <volume>8</volume>: <fpage>e1002740</fpage>.</mixed-citation></ref>
<ref id="c3"><label>[<xref ref-type="bibr" rid="c3">3</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Fisher</surname> <given-names>RA</given-names></string-name> (<year>1937</year>) <article-title>The wave of advance of advantageous genes</article-title>. <source>Annals of Eugenics</source> <volume>7</volume>: <fpage>355</fpage>&#x2013;<lpage>369</lpage>.</mixed-citation></ref>
<ref id="c4"><label>[<xref ref-type="bibr" rid="c4">4</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Barton</surname> <given-names>NH</given-names></string-name>, <string-name><surname>Etheridge</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Kelleher</surname> <given-names>J</given-names></string-name>, <string-name><surname>V&#x00E9;ber</surname> <given-names>A</given-names></string-name> (<year>2013</year>) <article-title>Genetic hitchhiking in spatially extended pop-ulations</article-title>. <source>Theoretical Population Biology</source> <volume>87</volume>: <fpage>75</fpage>&#x2013;<lpage>89</lpage>.</mixed-citation></ref>
<ref id="c5"><label>[<xref ref-type="bibr" rid="c5">5</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Barton</surname> <given-names>NH</given-names></string-name>, <string-name><surname>Etheridge</surname> <given-names>AM</given-names></string-name> (<year>2011</year>) <article-title>The relation between reproductive value and genetic contribution</article-title>. <source>Genetics</source> <volume>188</volume>: <fpage>953</fpage>&#x2013;<lpage>973</lpage>.</mixed-citation></ref>
<ref id="c6"><label>[<xref ref-type="bibr" rid="c6">6</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Maruyama</surname> <given-names>T</given-names></string-name> (<year>1970</year>) <article-title>On the fixation probability of mutant genes in a subdivided population</article-title>. <source>Genet Res</source> <volume>15</volume>: <fpage>221</fpage>&#x2013;<lpage>225</lpage>.</mixed-citation></ref>
<ref id="c7"><label>[<xref ref-type="bibr" rid="c7">7</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Nagylaki</surname> <given-names>T</given-names></string-name> (<year>1978</year>) <article-title>Random genetic drift in a cline</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>75</volume>: <fpage>423</fpage>&#x2013;<lpage>426</lpage>.</mixed-citation></ref>
<ref id="c8"><label>[<xref ref-type="bibr" rid="c8">8</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Lenormand</surname> <given-names>T</given-names></string-name>, <string-name><surname>Bourguet</surname> <given-names>D</given-names></string-name>, <string-name><surname>Guillemaud</surname> <given-names>T</given-names></string-name>, <string-name><surname>Raymond</surname> <given-names>M</given-names></string-name> (<year>1999</year>) <article-title>Tracking the evolution of insecticide resistance in the mosquito Culex pipiens</article-title>. <source>Nature</source> <volume>400</volume>: <fpage>861</fpage>&#x2013;<lpage>864</lpage>.</mixed-citation></ref>
<ref id="c9"><label>[<xref ref-type="bibr" rid="c9">9</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Labb&#x00E9;</surname> <given-names>P</given-names></string-name>, <string-name><surname>Berticat</surname> <given-names>C</given-names></string-name>, <string-name><surname>Berthomieu</surname> <given-names>A</given-names></string-name>, <string-name><surname>Unal</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bernard</surname> <given-names>C</given-names></string-name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Forty years of erratic insecticide resistance evolution in the mosquito Culex pipiens</article-title>. <source>PLOS Genetics</source> <volume>3</volume>: <fpage>e205</fpage>.</mixed-citation></ref>
<ref id="c10"><label>[<xref ref-type="bibr" rid="c10">10</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Barton</surname> <given-names>NH</given-names></string-name>, <string-name><surname>Hewitt</surname> <given-names>GM</given-names></string-name> (<year>1985</year>) <article-title>Analysis of hybrid zones</article-title>. <source>Annual review of Ecology and Systematics</source> <volume>16</volume>: <fpage>113</fpage>&#x2013;<lpage>148</lpage>.</mixed-citation></ref>
<ref id="c11"><label>[<xref ref-type="bibr" rid="c11">11</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Barton</surname> <given-names>NH</given-names></string-name>, <string-name><surname>Depaulis</surname> <given-names>F</given-names></string-name>, <string-name><surname>Etheridge</surname> <given-names>AM</given-names></string-name> (<year>2002</year>) <article-title>Neutral evolution in spatially continuous populations</article-title>. <source>Theoretical Population Biology</source> <volume>61</volume>: <fpage>31</fpage>&#x2013;<lpage>48</lpage>.</mixed-citation></ref>
<ref id="c12"><label>[<xref ref-type="bibr" rid="c12">12</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Sattath</surname> <given-names>S</given-names></string-name>, <string-name><surname>Elyashiv</surname> <given-names>E</given-names></string-name>, <string-name><surname>Kolodny</surname> <given-names>O</given-names></string-name>, <string-name><surname>Rinott</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Sella</surname> <given-names>G</given-names></string-name> (<year>2011</year>) <article-title>Pervasive adaptive protein evolution apparent in diversity patterns around amino acid substitutions in Drosophila simulans</article-title>. <source>PLoS Genetics</source> <volume>7</volume>: <fpage>e1001302</fpage>.</mixed-citation></ref>
<ref id="c13"><label>[<xref ref-type="bibr" rid="c13">13</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name>, <string-name><surname>Fisher</surname> <given-names>DS</given-names></string-name> (<year>2014</year>) <article-title>Acceleration of evolutionary spread by long-range dispersal</article-title>. <source>Proceed-ings of the National Academy of Sciences</source> <volume>111</volume>: <fpage>E4911</fpage>&#x2013;<lpage>4919</lpage>.</mixed-citation></ref>
<ref id="c14"><label>[<xref ref-type="bibr" rid="c14">14</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Hermisson</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pennings</surname> <given-names>PS</given-names></string-name> (<year>2005</year>) <article-title>Soft sweeps: Molecular population genetics of adaptation from standing genetic variation</article-title>. <source>Genetics</source> <volume>169</volume>: <fpage>2335</fpage>&#x2013;<lpage>2352</lpage>.</mixed-citation></ref>
<ref id="c15"><label>[<xref ref-type="bibr" rid="c15">15</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Martens</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name> (<year>2011</year>) <article-title>Interfering waves of adaptation promote spatial mixing</article-title>. <source>Genetics</source> <volume>189</volume>: <fpage>1045</fpage>&#x2013;<lpage>1060</lpage>.</mixed-citation></ref>
<ref id="c16"><label>[<xref ref-type="bibr" rid="c16">16</xref>]</label> <mixed-citation publication-type="book"><string-name><surname>Pham</surname> <given-names>H</given-names></string-name> (<year>2009</year>) <chapter-title>Continuous-Time Stochastic Control and Optimization with Financial Applications</chapter-title>. <source>Stochastic modelling and applied probability</source>. <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation></ref>
<ref id="c17"><label>[<xref ref-type="bibr" rid="c17">17</xref>]</label> <mixed-citation publication-type="journal"><collab>Wolfram Research</collab> (<year>2016</year>). <source>Hermite function</source>. URL <ext-link ext-link-type="uri" xlink:href="http://functions.wolfram.com/07.01.02.0001.01">http://functions.wolfram.com/07.01.02.0001.01</ext-link>. Online; <date-in-citation>accessed 30-Oct-2016</date-in-citation>.</mixed-citation></ref>
<ref id="c18"><label>[<xref ref-type="bibr" rid="c18">18</xref>]</label> <mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Stephan</surname> <given-names>W</given-names></string-name> (<year>2003</year>) <article-title>Selective sweeps in the presence of interference among partially linked loci</article-title>. <source>Genetics</source> <volume>164</volume>: <fpage>389</fpage>&#x2013;<lpage>98</lpage>.</mixed-citation></ref>
</ref-list>
<sec id="s13">
<label>A</label>
<title>Calculating the &#x201C;pull&#x201D; of an loosely-linked sweep</title>
<p>We would like to find the expected spatial displacement of a lineage caused by an loosely-linked sweep, tracing backwards in time. To do so, suppose that we sample an allele in a present-day individual in the middle of a very large one-dimensional range, and that a long time ago a selective sweep occurred at a locus a recombination fraction r away from the focal allele, starting a very long distance away from our sample. We wish to find the expected location of the ancestor of the sampled allele before the sweep began. Let <italic>p(x,&#x03C4;)</italic> be the probability density for finding the ancestor at location <italic>x&#x03C4;</italic> generations in the past, with <italic>x = 0</italic> corresponding to the present location. We want to find
<disp-formula id="eqn7"><alternatives><graphic xlink:href="084426_eqn7.gif"/></alternatives></disp-formula></p>
<p>To find <italic>&#x2202;<sub>&#x03C4;p</sub></italic>, first define <italic>p<sub>i</sub>(x,&#x03C4;)</italic> as the probability density that the ancestor was at location <italic>x</italic> and in genetic background <italic>i</italic>, where <italic>i = 0</italic> is the ancestral genetic background, and <italic>i = 1</italic> is the background with the allele that swept. (Note <italic>p = p<sub>0</sub> &#x002D; p<sub>1</sub></italic>.) If we define <italic>u(x,&#x03C4;)&#x2261; u<sub>1</sub>(x,&#x03C4;)</italic> and <italic>u<sub>0</sub>(x,&#x03C4;)</italic> to be the frequencies of the sweeping allele and the background allele, respectively, with <italic>u<sub>1</sub> &#x002D; u<sub>0</sub> = 1, p<sub>i</sub></italic> satis es the partial differential equation
<disp-formula id="eqn8"><alternatives><graphic xlink:href="084426_eqn8.gif"/></alternatives></disp-formula></p>
<p>Technically, in models with discrete generations, <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> only applies when the recombination rate per generation is small, but we will use it for unlinked loci anyway.</p>
<p>The equivalent of linkage disequilibrium in this system is <italic>&#x0393;&#x2261;u<sub>0</sub>p<sub>1</sub>&#x00D7; u<sub>1</sub>p<sub>0</sub></italic> we expect it to be small for large <italic>r</italic>. Using &#x03B4; to change variables back to <italic>p</italic>, <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> becomes
<disp-formula id="eqn9"><alternatives><graphic xlink:href="084426_eqn9.gif"/></alternatives></disp-formula>
<disp-formula id="eqn10"><alternatives><graphic xlink:href="084426_eqn10.gif"/></alternatives></disp-formula></p>
<p>Plugging <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> into <xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref>, we have
<disp-formula id="eqn11"><alternatives><graphic xlink:href="084426_eqn11.gif"/></alternatives></disp-formula> where we have used integration by parts and the fact that p(&#x00B1;&#x221E;,&#x03C4; 1,) = 0. It now remains to find an expression for &#x0393;. <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> is quite complicated, but for large <italic>r</italic> we will have &#x03B4;&#x226A;<italic>p</italic> and the dominant balance will be between the first and third terms on the right-hand side, giving
<disp-formula id="eqn12"><alternatives><graphic xlink:href="084426_eqn12.gif"/></alternatives></disp-formula> where <italic>p<sub>neut</sub></italic> is the value of <italic>p</italic> ignoring the perturbation caused by the sweep, i.e., <inline-formula><alternatives><inline-graphic xlink:href="084426_inline11.gif"/></alternatives></inline-formula>.</p>
<p>We can simplify this further by noting that <italic>u</italic> solves the differential equation<inline-formula><alternatives><inline-graphic xlink:href="084426_inline12.gif"/></alternatives></inline-formula></p>
<p>(Recall that &#x03C4; is backwards time.) Using this relation and substituting <xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref> into <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref>, we have<disp-formula id="eqn13"><alternatives><graphic xlink:href="084426_eqn13.gif"/></alternatives></disp-formula></p>
<p>Recall that we are interested in the effect of a long-past sweep. Let <italic>&#x03C4;<sub>0</sub></italic> be the time at which the wave of advance passed the point where we sampled the allele; we will take <italic>&#x03C4;<sub>0</sub></italic> to be extremely large. At time <italic>&#x03C4;<sub>0</sub></italic>, <italic>p<sub>neut</sub></italic> has width <inline-formula><alternatives><inline-graphic xlink:href="084426_inline13.gif"/></alternatives></inline-formula>, so the wave crosses the region where the ancestor might have lived in a time <inline-formula><alternatives><inline-graphic xlink:href="084426_inline14.gif"/></alternatives></inline-formula>, and the integral in <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> is dominated by times <italic>&#x03C4;</italic> in the approximate range <inline-formula><alternatives><inline-graphic xlink:href="084426_inline15.gif"/></alternatives></inline-formula>. Since <italic>&#x03C4;</italic> does not vary by much (proportionately) in this interval, <italic>p<sub>neut</sub>(x,<italic>&#x03C4;</italic>) &#x2261; p<sub>neut</sub>(x, &#x03C4;<sub>0</sub></italic>) is approximately constant in &#x03C4;. Using this approximation in <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> yields
<disp-formula id="eqn14"><alternatives><graphic xlink:href="084426_eqn14.gif"/></alternatives></disp-formula></p>
<p>Note that this result did not depend on the form of <italic>p<sub>neut</sub></italic>, only that it was approximately constant in time; in particular, it also holds if the ancestry settles down to a stationary distribution, as in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>.</p>
<sec id="s14a">
<label>A.1</label>
<title>Other kinds of loosely-linked sweep</title>
<p>Above, we have assumed that the sweeping allele spread according to the FKPP equation, &#x2202;<sub>&#x03C4;</sub>u &#x002D; D&#x2202;<sub>x</sub><sup>2</sup>u = su(1&#x00D7;u), which describes an allele with a constant selective advantage s. However, the allele may have a varying selective advantage if, for instance, dominance or frequency-dependent effects are important, or if there is environmental variation. More generally, the changing allele frequency is described by
<disp-formula id="eqn15"><alternatives><graphic xlink:href="084426_eqn15.gif"/></alternatives></disp-formula> for some function <italic>f</italic>.</p>
<p>Otherwise, the derivation of the expected displacement is the same as above, and we have
<disp-formula id="eqn16"><alternatives><graphic xlink:href="084426_eqn16.gif"/></alternatives></disp-formula></p>
<p>Assuming that <italic>f</italic> is such that <italic>u(x,&#x03C4;)</italic> is still a traveling wave moving at some speed <italic>c</italic>, we can change variables in the second integral to obtain:
<disp-formula id="eqn17"><alternatives><graphic xlink:href="084426_eqn17.gif"/></alternatives></disp-formula></p>
</sec>
</sec>
<sec id="s15">
<label>B</label>
<title>Effect of tightly-linked sweeps</title>
<p>We wish to calculate &#x03D5;(<italic>x</italic>) for large <italic>x</italic>, including the effect of occasional tightly-linked sweeps. It is easiest to consider <inline-formula><alternatives><inline-graphic xlink:href="084426_inline16.gif"/></alternatives></inline-formula>, which we can think of as the probability that at some time <italic>t<sub>0</sub></italic> in the distant past, the ancestor of a present-day individual was at a distance greater than <italic>x</italic> from the center. For large <italic>x</italic>, we expect that this is dominated by the probability that it was pulled there by a &#x2018;recent&#x2019; tightly-linked sweep <italic>t</italic> generations &#x2018;before&#x2019; <italic>t<sub>0</sub></italic> (i.e., <italic>t</italic> generations closer to the present), with t not too large. This sweep must have pulled the lineage out to a distance of at least <italic>xe<sup>t/tcon</sup></italic> for it still to be at a distance of at least <italic>x t</italic> generations &#x2018;later&#x2019;, and therefore the sweep must have originated a distance <italic>z &#x003E; xe<sup>t/tcon</sup></italic> from the center. Given that it did, the probability that it pulled the lineage out far enough is exp <inline-formula><alternatives><inline-graphic xlink:href="084426_inline17.gif"/></alternatives></inline-formula>. Putting this all together, and using that the density of sweeps per generation per unit map length per distance (or area in two dimensions) at distance <italic>z</italic> from the center and genetic map distance r from the focal locus is 2A/(<italic>fKL</italic>) (or 4 A<italic>z/(fKL<sup>2</sup>)</italic> in two dimensions), the expected number of sweeps that would have left the lineage more than <italic>x</italic> from the center at time <italic>t<sub>0</sub></italic> is
<disp-formula id="eqn18"><alternatives><graphic xlink:href="084426_eqn18.gif"/></alternatives></disp-formula></p>
<p>Taking the derivative of both sides of <xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref> with respect to <italic>x</italic> gives the probability density, <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>.</p>
<p>Note that <xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref> approximates the probability that there is at least one tightly-linked sweep by the expected number of such sweeps, so it is only valid when the right-hand side is small, <italic>x &#x226B;L/K</italic>. It also obviously typically breaks down as <italic>x</italic> approaches <italic>L</italic> and the particular geometry of the habitat begins to matter.</p>
</sec>
<sec id="s16">
<label>C</label>
<title>Isolation by distance</title>
<p>We wish to find the probability &#x03D5;(<italic>x</italic>) that a pair of lineages a distance <italic>x</italic> apart will be identical at a neutral locus. Let us assume that the locus is far from any recent sweeps. (We relax this assumption below.) Then tracing the ancestry back in time, the separation <italic>X<sub>&#x03C4;</sub></italic> between them can be approximated by a Brownian motion, with diffusion constant 2D (since it combines the motion of both lineages), and with the lineages moving together at a mean rate of &#x2248;-Ac<italic>X/fL=-X/t<sub>con</sub></italic> from (unlinked) sweeps that start in between them. In other words, we can approximate the motion by
<disp-formula id="eqn19"><alternatives><graphic xlink:href="084426_eqn19.gif"/></alternatives></disp-formula> where <italic>B</italic> is a Brownian motion. We write <italic>Y</italic> to emphasize that this is not quite the same as the real path of the lineages <italic>X</italic>. In particular, unlike <italic>X, Y</italic> does not include coalescence. (In two dimensions, <italic>Y</italic> fails to approximate <italic>X</italic> even when the lineages are just very close together, but since most of the coalescence time will be spent at some distance away, it is still a useful approximation.)</p>
<p>We would like to find an explicit form for <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref>. To do this, we can rewrite in terms of the behavior of <italic>Y</italic>. First, note that the rate of coalescence for the two lineages when they are in the same place is 1/&#x03C1;, and <italic>Y</italic> therefore the probability density of coalescence at time &#x03C4; is <inline-formula><alternatives><inline-graphic xlink:href="084426_inline18.gif"/></alternatives></inline-formula>, where &#x03B4; is the Dirac delta. (The exponential factor accounts for the possibility that the two lineages have already coalesced.)</p>
<p>Plugging this into <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> gives:
<disp-formula id="eqn20"><alternatives><graphic xlink:href="084426_eqn20.gif"/></alternatives></disp-formula></p>
<p>We can use the Feynman-Kac formula ([<xref ref-type="bibr" rid="c16">16</xref>], p25) to rewrite <xref ref-type="disp-formula" rid="eqn20">Eq. (20)</xref> as an ordinary differential equation:
<disp-formula id="eqn21"><alternatives><graphic xlink:href="084426_eqn21.gif"/></alternatives></disp-formula> where &#x03B4; is the Dirac delta. <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> breaks down for x &#x2192; 0 in d = 2 dimensions; in this case, some kind of small-scale cutoff is needed, but this does not change the shape of &#x03D5;(<italic>x</italic>) at larger scales [<xref ref-type="bibr" rid="c11">11</xref>]. The last term in <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> is just a boundary condition that sets the overall normalization of &#x03D5;.</p>
<p>The solution to <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> can be written exactly in terms of special functions. (For d = 1, <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> is the Hermite equation, with solution <inline-formula><alternatives><inline-graphic xlink:href="084426_inline19.gif"/></alternatives></inline-formula>, where <italic>H<sub>v</sub> (z)</italic> is a Hermite function [<xref ref-type="bibr" rid="c17">17</xref>].) However, approximate asymptotic solutions are more useful. For <inline-formula><alternatives><inline-graphic xlink:href="084426_inline20.gif"/></alternatives></inline-formula>, the dominant balance is <inline-formula><alternatives><inline-graphic xlink:href="084426_inline21.gif"/></alternatives></inline-formula> with solution <inline-formula><alternatives><inline-graphic xlink:href="084426_inline22.gif"/></alternatives></inline-formula>. For <inline-formula><alternatives><inline-graphic xlink:href="084426_inline23.gif"/></alternatives></inline-formula>. For <italic>x &#x226A;x<sub>x</sub></italic> the pull of unlinked sweeps is negligible, and the solutions are close to the neutral solutions in [<xref ref-type="bibr" rid="c11">11</xref>]. At intermediate distances, there is a crossover regime where the form of the dependence of &#x03D5; on <italic>x</italic> is independent of the mutation rate.</p>
<sec id="s16a">
<label>C.1</label>
<title>Tightly-linked sweeps</title>
<p>Above, we have focused on regions of the genome far from any recent sweeps. Ideally, however, we would like to be able to extend our analysis to include recently-swept regions. As a first approximation, we can say that the main effect of tightly-linked sweeps is that they can cause two widely-separated lineages to rapidly coalesce. The probability that a sweep recombining at rate r with the focal neutral locus will cause coalescence between two lineages separated by <italic>x</italic> is <inline-formula><alternatives><inline-graphic xlink:href="084426_inline24.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xlink:href="084426_inline25.gif"/></alternatives></inline-formula> is mean coalescence time for two lineages inside the wavefront of the sweep [<xref ref-type="bibr" rid="c4">4</xref>]. We can therefore account for the effect of sweeps uniformly distributed over the genome by changing the coalescence kernel in <xref ref-type="disp-formula" rid="eqn20">Eq. (20)</xref> from <italic>&#x03B4;(x)/&#x03C1;</italic> to
<disp-formula id="ueqn1"><alternatives><graphic xlink:href="084426_ueqn1.gif"/></alternatives></disp-formula></p>
<p>For <inline-formula><alternatives><inline-graphic xlink:href="084426_inline26.gif"/></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> then becomes
<disp-formula id="ueqn2"><alternatives><graphic xlink:href="084426_ueqn2.gif"/></alternatives></disp-formula></p>
<p>For large <italic>x</italic>, there are two possible tail behaviors for the solution. If 2&#x03BC;<italic>t<sub>con</sub> &#x003C; 1</italic>, then the pull of unlinked sweeps is strong enough that it is likely to bring lineages close together before they mutate, and <inline-formula><alternatives><inline-graphic xlink:href="084426_inline27.gif"/></alternatives></inline-formula> as above. For <italic>2&#x03BC;t<sub>con</sub> &#x003E; 1</italic>, only recently-swept loci share recent enough ancestry to be likely to be identical in distant individuals, and<inline-formula><alternatives><inline-graphic xlink:href="084426_inline28.gif"/></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="s18">
<label>D</label>
<title>Simulation methods</title>
<p>Forward-time simulations (purple histogram in <xref ref-type="fig" rid="fig1">Fig. 1</xref>) were conducted using the algorithm from [<xref ref-type="bibr" rid="c2">2</xref>] (which draws on that of [<xref ref-type="bibr" rid="c18">18</xref>]), modified so that population was subdivided into a line of <italic>L</italic> demes of &#x03C1; individuals each, with random dispersal between adjacent demes. Because these simulations were extremely computa-tionally demanding, we also conducted approximate backwards-time simulations to get better statistics and investigate rare events (blue histogram in <xref ref-type="fig" rid="fig1">Fig. 1</xref>, and <xref ref-type="fig" rid="fig2">Figs. 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>). These simulations followed a single lineage back in time at one neutral locus as it diffused through a continuous one-dimensional space. Sweeps were treated as instantaneous events arising uniformly at random in space and time and across the genome. Sweeps occurring at a recombination fraction r from the focal locus pulled the lineage an exponentially-distributed distance with mean <italic>c/r</italic> or <italic>c/(2r)</italic> (for <italic>r &#x003C; s</italic> and <italic>r &#x003E; s</italic>, respectively), truncated at the origin of the sweep. For both sets of simulations, the focal locus was at the center of a linear genome with map length <italic>K</italic> Morgans.</p>
</sec>
</back>
</article>