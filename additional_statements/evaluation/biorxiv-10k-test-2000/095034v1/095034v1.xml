<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/095034</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Molecular Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Helical reconstruction in RELION</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author"><name><surname>He</surname><given-names>Shaoda</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes"><name><surname>Scheres</surname><given-names>Sjors H.W.</given-names></name><xref ref-type="corresp" rid="cor1">&#x002A;</xref></contrib>
<aff id="a1"><label>1</label><institution>MRC Laboratory of Molecular Biology</institution>, Francis Crick Avenue, Cambridge Biomedical Campus, CB2 0QH, Cambridge, <country>UK</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label> Correspondence to: <email>scheres@mrc-lmb.cam.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2016</year>
</pub-date>
<elocation-id>095034</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>12</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="095034.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>We describe a new implementation for the reconstruction of helical assemblies in the empirical Bayesian framework of RELION. Our approach calculates optimal linear filters for the 3D reconstruction by embedding helical symmetry operators in Fourier-space, and deals with deviations from perfect helical symmetry through Gaussian-shaped priors on the orientations of individual segments. By incorporating our approach into the standard pipeline for single-particle analysis in RELION, our implementation aims to be easily accessible for non-experienced users. Although our implementation does not solve the problem that grossly incorrect structures can be obtained when the wrong helical symmetry is imposed, we show for four different test cases that it is capable of reconstructing structures to near-atomic resolution.</p>
<sec>
<title>Abbreviations</title>
<def-list>
<def-item>
<term>CARD</term>
<def><p>Caspase Activation and Recruitment Domain</p></def>
</def-item>
<def-item>
<term>EM</term>
<def><p>Electron Microscopy</p></def>
</def-item>
<def-item>
<term>FSC</term>
<def><p>Fourier Shell Correlation</p></def>
</def-item>
<def-item>
<term>IHRSR</term>
<def><p>Iterative Helical Real-Space Reconstruction</p></def>
</def-item>
<def-item>
<term>MAVS</term>
<def><p>Mitochondrial Antiviral Signaling Protein</p></def>
</def-item>
<def-item>
<term>TMV</term>
<def><p>Tobacco Mosaic Virus</p></def>
</def-item>
</def-list>
</sec>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Helical symmetry</kwd>
<kwd>single-particle analysis</kwd>
<kwd>cryo-electron microscopy</kwd>
<kwd>image processing</kwd>
<kwd>regularised likelihood optimisation</kwd>
</kwd-group>
<counts>
<page-count count="27"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>The first biological structure to be determined by three-dimensional electron microscopy (3D-EM), the extended tail of the T4 bacteriophage, had helical symmetry (<xref ref-type="bibr" rid="c8">De Rosier and Klug, 1968</xref>; <xref ref-type="bibr" rid="c10">DeRosier and Moore, 1970</xref>). An important advantage for structure determination of helical objects over asymmetrical particles lies in the observation that a single projection image of a helical specimen will typically contain all necessary information to perform a 3D reconstruction. Moreover, for helical reconstructions the number of parameters to be determined is, in principle, strongly reduced compared to singleparticle analysis. That is because in single-particle analysis one needs to determine the relative orientations for every individual particle projection image, while for helical structures many copies of the repeating, asymmetrical unit have fixed relative orientations. Therefore, once the parameters describing helical symmetry and the orientation of the image of an entire filament with respect to that symmetry have been determined, one can reduce the experimental noise efficiently by averaging over a large number of asymmetrical units.</p>
<p>The determination of helical symmetry and the subsequent calculation of a 3D reconstruction were initially performed in Fourier space. The mathematical description of the Fourier transform of an object with helical symmetry was first proposed by Crick, Cochran and Vand (<xref ref-type="bibr" rid="c6">Cochran et al., 1952</xref>), and Klug generalised the theory afterwards (<xref ref-type="bibr" rid="c24">Klug et al., 1958</xref>). The initial step is to inspect 2D Fourier diffraction patterns of, sometimes averaged, and preferably long and straight, helical filaments. The helical lattice can be considered as a 2D surface lattice that is curled into a cylinder (also see <xref ref-type="fig" rid="fig1">Figure 1</xref>). The curling effect causes a convolution of the Fourier transform of the 2D surface lattice with a cylindrical harmonic called the Bessel function. In the 3D Fourier transform of a helical object, discrete horizontal lines, called layer lines, arise from the periodicity along the helical axis. Through the central slice theorem, the radially oscillating ring-like amplitudes on each plane perpendicular to the Z axis in 3D Fourier space give rise to symmetrical maxima across the meridian on each layer line in the Fourier transforms of 2D projections. The position of the maxima along these lines, combined with the realspace width of the helical object, can be used to infer the 2D lattice parameters in a process called Fourier-Bessel indexing. After the Fourier transform of a helix has been indexed, a 3D reconstruction can be obtained through Fourier inversion (<xref ref-type="bibr" rid="c10">DeRosier and Moore, 1970</xref>). For more detailed reviews on Fourier-Bessel analysis, the reader is referred to (<xref ref-type="bibr" rid="c12">Diaz et al., 2010</xref>; <xref ref-type="bibr" rid="c40">Stewart, 1988</xref>).</p>
<fig id="fig1" position="float">
<label>Figure 1.</label>
<caption><title>Definition of helical symmetry for <italic>n</italic>-start helices.</title>
<p><bold>A.</bold> Example of a 1-start helix with no point group symmetry (C1). The 3D helical structure on the left can be &#x2018;unfolded&#x2019; into a 2D plot of the <italic>z</italic>-height against the azimuthal angle &#x03C6; on the right. The dots represent the centres of the subunits in the 2D surface lattice. <bold>B)</bold> Example of a 3-start helix (with C1 point group symmetry), where instead of using the original twist and rise of the individual three strands (in black), RELION expresses the helical symmetry using a third of the original rise (in red).</p>
</caption>
<graphic xlink:href="095034_fig1.tif"/></fig>
<p>Computer programs for Fourier-Bessel analysis were first developed in the MRC image processing package (<xref ref-type="bibr" rid="c7">Crowther et al., 1996</xref>), and have since been adapted in many other packages, such as the Brandeis Helical Package (<xref ref-type="bibr" rid="c28">Owen et al., 1996</xref>), Phoelix (<xref ref-type="bibr" rid="c41">Whittaker et al., 1995</xref>) and for objects with a break in helical symmetry known as a seam in Ruby-helix (<xref ref-type="bibr" rid="c27">Metlagel et al., 2007</xref>). Fourier-Bessel analysis of helices is often considered laborious and difficult, as small inaccuracies in the indexing may lead to incorrect reconstructions. Indexing is particularly prone to errors when the filaments are not lying flat, the lattice is somehow distorted by bending or flattening of the filaments, or by short-range disorder in the helical symmetry. Therefore, the Fourier-Bessel approach only performs well when the specimen adopts a close to perfect helical structure. In practice, many helical assemblies are far from perfect due to molecular flexibility and distortions induced by the sample preparation process. To reduce the effects of long-range distortions on the Fourier-Bessel reconstruction of AChR filaments, Beroukhim and Unwin introduced the idea of dividing helical filaments into short segments, which are independently aligned against a reference structure (<xref ref-type="bibr" rid="c3">Beroukhim and Unwin, 1997</xref>).</p>
<p>The introduction of an iterative helical real-space reconstruction (IHRSR) algorithm by Egelman opened up new horizons (<xref ref-type="bibr" rid="c16">Egelman, 2000</xref>). Analogous to standard single-particle analysis, the IHRSR algorithm is based on iterative projection matching, where computer-generated projections of a 3D reference in many different orientations are compared with small segments that are cut out from the micrographs in overlapping square boxes along the helical filaments. After the optimal orientations of all segments have been determined in this way, the aligned segments are back-projected into an (asymmetric) 3D reconstruction. The helical twist and rise are then determined by least-square fit within a user-defined search range, and the best symmetry is imposed to generate a symmetric 3D reference for the next iteration. For favourable cases, this method was shown to converge to the correct solution when starting from a solid cylinder (<xref ref-type="bibr" rid="c15">Egelman, 2007</xref>), thereby reducing human intervention and enabling helical reconstruction without expertise in Fourier-Bessel analysis. The original IHRSR approach was implemented in the SPIDER package (<xref ref-type="bibr" rid="c19">Frank et al., 1996</xref>). More recent implementations were made in FREALIX (<xref ref-type="bibr" rid="c29">Rohou and Grigorieff, 2014</xref>) and in SPARX (<xref ref-type="bibr" rid="c2">Behrmann et al., 2012</xref>). The SPRING package provides a combination of Fourier-based symmetry analysis and iterative real-space helical processing (<xref ref-type="bibr" rid="c11">Desfosses et al., 2014</xref>).</p>
<p>In this paper, we describe an implementation of single-particle-like analysis for helical assemblies in the RELION program (<xref ref-type="bibr" rid="c35">Scheres, 2012a</xref>). RELION is based on an empirical Bayesian approach to single-particle analysis in Fourier-space, where a marginalised likelihood function is augmented with a Gaussian prior on the reconstruction (<xref ref-type="bibr" rid="c36">Scheres, 2012b</xref>). Optimisation of the corresponding regularised likelihood target is performed using the expectation maximisation algorithm (<xref ref-type="bibr" rid="c9">Dempster et al., 1977</xref>). Because parameters of a statistical model for both the signal and the noise are estimated from the data themselves, optimal filters for both the reconstruction and the alignment are determined automatically. Thereby the need for user expertise in devising <italic>ad hoc</italic> filters is strongly reduced. Although helical reconstructions using RELION have been described previously (<xref ref-type="bibr" rid="c5">Clemens et al., 2015</xref>; <xref ref-type="bibr" rid="c38">Short et al., 2016</xref>; <xref ref-type="bibr" rid="c42">Xu et al., 2015</xref>), these approaches relied on external software to impose helical symmetry, so that RELION could not incorporate the additional averaging into its calculation of optimal filters. Moreover, previous versions of RELION were unaware of the signal extending to the edges of the boxed images, and did not exploit statistical priors on the orientations of individual segments to describe deviations from perfect helical symmetry.</p>
<p>Below, in the Methods section, we first describe the modifications to RELION that were made to implement helical reconstruction. Then, in the Results section, we describe how this implementation behaves for four different helical test specimens. We start the Results section with a description of the structure determination procedures for these four test cases, and we describe more detailed analyses of various features of the RELION implementation in the second half of the Results section. Finally, in the Discussion section we analyse the benefits and the remaining pitfalls of our implementation. The approach described in this paper has been implemented in RELION version 2.0, and was accelerated for execution on graphics cards along with the code for standard single-particle analysis of asymmetric particles (<xref ref-type="bibr" rid="c23">Kimanius et al., 2016</xref>). RELION is distributed as open-source and can be downloaded for free by both academic and non-academic users from <ext-link ext-link-type="uri" xlink:href="http://www2.mrc-lmb.cam.ac.uk/relion">http://www2.mrc-lmb.cam.ac.uk/relion</ext-link>.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Definition of helical symmetry</title>
<p>Helical symmetry in RELION is described by two parameters (<xref ref-type="fig" rid="fig1">Figure 1A</xref>): helical <italic>twist</italic> (between &#x2212;180 and 180 degrees, with positive values corresponding to right-handed helices along the Z-axis) and helical <italic>rise</italic> (&#x003E; 0 &#x00C5;ngstroms, along the z-axis). Therefore, for any point in real space, the voxel values of a perfectly helical object have the following relationship under cylindrical coordinates with radial distance <italic>r</italic>, angular coordinate <italic>&#x03C6;</italic>, and height <italic>z</italic> (also see <xref ref-type="fig" rid="fig1">Figure 1A</xref>):
<disp-formula id="ueqn1">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="095034_ueqn1.gif"/></alternatives>
</disp-formula>
</p>
<p>Apart from helical symmetry, additional point group symmetry may also be present. That is, the sample may have an additional <italic>n</italic>-fold rotational symmetry axis along the helical axis (C<italic>n</italic>-symmetry with <italic>n</italic> &#x2265; 2), and/or it may have a 2-fold rotational axis perpendicular to the symmetry axis (D<italic>n</italic>-symmetry with <italic>n</italic> &#x2265; 1, where D1 stands for a single 2-fold axis perpendicular to the helical axis but no rotational symmetry along the helical axis). Helices with D<italic>n</italic> symmetry lack polarity, whereas helices with C<italic>n</italic> symmetry typically consist of <italic>n</italic> separate strands of molecules that are packed against each other and that all start at the same level along the z-axis.</p>
<p>In some helical structures the subunit shape and packing may make a particular <italic>n</italic>-start helical family especially prominent, even though the structure does not have C<italic>n</italic> point group symmetry. In such a case the <italic>n</italic> separate helical strands do not all start at the same level along the z-axis. To maintain an intact helical lattice, the difference in translation between the <italic>n</italic> strands have to be multiples of the <italic>rise/n.</italic> Thereby, it becomes possible to describe these so-called <italic>n</italic>-start helical families by a 1-start helix with the following twist and rise (<xref ref-type="fig" rid="fig1">Figure 1B</xref>):
<disp-formula id="ueqn2">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="095034_ueqn2.gif"/></alternatives>
</disp-formula>
</p>
<p>RELION uses the 1-start description of such structures. Although mathematically correct, the 1-start helical lattice may not have an intuitive biological interpretation. The handedness of the 1-start lattice is not necessarily the same as for the <italic>n</italic>-start lattice, and neighbouring molecules do not necessarily contact each other on the 1-start helical lattice.</p>
</sec>
<sec id="s2b"><title>Fourier-space symmetrisation and the inter-box distance</title>
<p>In order to estimate the signal-to-noise ratio in the experimental images, which is an intricate part of the empirical Bayesian approach, RELION needs to know over how many asymmetric units a reconstruction is calculated. For asymmetrical particles, each experimental projection contributes a single asymmetric unit to the reconstruction. For helical segments, the amount of overlap between adjacent boxes defines how many new asymmetric units are contained in each new box. Therefore, upon the extraction of helical segments from the micrographs, RELION will ask the user for an interbox distance that is an integer <italic>H</italic> times the helical rise (also see below), so that each new box will contain <italic>H</italic> new asymmetric units. At early stages of processing, when an exact rise may not yet be known, a best guess may be used instead.</p>
<p>For values of <italic>H</italic> larger than one, during the alignment of each segment in the expectation step one could in principle set the 2D Fourier slice <italic>H</italic> times back into the 3D Fourier transform, each time applying a rotation of <italic>h</italic> &#x002A; <italic>twist</italic> and phase shifts that would correspond to a translation of <italic>h</italic> &#x002A; <italic>rise</italic> along Z, with <italic>h</italic> &#x003D; <italic>0,&#x2026;, H &#x2212;1</italic> (<xref ref-type="fig" rid="fig2">Figure 2</xref>). RELION implements the computationally cheaper, mathematically equivalent option to apply these rotations and phase shifts to the accumulated sum of all slices in 3D Fourier space at the end of every iteration, immediately prior to performing the reconstruction.</p>
<fig id="fig2" position="float">
<label>Figure 2:</label>
<caption><p><bold>A.</bold> A schematic representation of a helical filament with 18 asymmetrical units. <bold>B.</bold> Extracted segments with 1 (top) or 2 (bottom) new asymmetrical units per box lead to similar reconstructed volumes after symmetrisation in Fourier-space. Fourier-space symmetrisation is not necessary if the inter-box distance is one helical rise. Otherwise, the reconstructed volume from the helical segments is rotated and translated according to the helical symmetry, and summed up in Fourier space. <bold>C.</bold> The reconstruction of MAVS from manually picked filaments and an inter-box distance corresponding to 6 new asymmetrical units per segment. Without Fourier-space symmetrisation, one does not average over all asymmetrical units. <bold>D.</bold> The MAVS reconstruction after Fourier-space symmetrisation. The central section along the helical axis (within the red box) is averaged over all available asymmetrical units. At the top and the bottom of the helix, blurring is caused by Fourier artefacts (also see main text).</p>
</caption>
<graphic xlink:href="095034_fig2.tif"/></fig>
<p>Since the information content of a given set of micrographs is invariant of the inter-box distance, different values of the latter should in principle lead to identical signal-to-noise estimates and 3D reconstructions. Larger inter-box distances, or larger values of <italic>H</italic>, will result in fewer segments and are thus computationally cheaper. However, in practice the useful inter-box distance is limited by artefacts caused by our symmetrisation operations in Fourier-space. For values of <italic>H</italic> larger than 1, translations through phase shifts in the 3D Fourier transform will cause densities at the top of the helix in real-space to &#x0022;wrap around&#x0022; to the bottom and <italic>vice versa</italic>. Because the densities at the top and the bottom will typically not coincide, this will lead to additional blurring at the helix ends. Consequently, only the central z-slices in the real-space reconstruction will be intact after the symmetrisation in Fourier space, which places a strict maximum on the inter-box distance of 50&#x0025; of the box size.</p>
</sec>
<sec id="s2c">
<title>Real-space symmetrisation and local optimisation of twist and rise</title>
<p>Apart from the artefacts caused by our symmetrisation in Fourier space, other factors will further blur the reconstructed density: helical segments that are not perfectly straight, have varying twist, rise, shrinkage or expansion along the helical axis and inaccuracies in the alignment. Bent helices can be described better by using smaller inter-box distances, which will lead to more segments, and thus more orientational parameters to describe the deviations from a straight helix. But because bent helices can only be approximated with a straight helix in a sufficiently small central section, the top and bottom parts of the reconstructed helix will be more blurred than the central part. The same happens with alignment errors, where the density that is further away from the centre of rotation will be more blurred. As a result, the central part of the reconstructed helix will be better defined than the top and bottom ends. Therefore, it is beneficial to calculate a symmetric structure using only the central z-sections in real-space, and to extend the symmetric structure over the length of the entire box.</p>
<p>As was originally introduced for the IHRSR approach (<xref ref-type="bibr" rid="c16">Egelman, 2000</xref>), this real-space symmetrisation can also be accompanied with a local optimisation of the helical twist and rise. This may be necessary, as estimates from traditional Fourier-Bessel indexing or other methods are often not accurate enough for high-resolution reconstruction. Therefore, RELION optionally performs a two-dimensional grid search of the helical twist and rise to find the smallest variance between the averaged sections of the map. Initial search range and step size parameters are provided by the user, and the 2D grid search is iterated with increasingly fine steps around the best twist and rise from the previous iteration. Because the refinement of twist and rise is a local optimisation process, and the energy landscape may contain many local minima, the optimisation of helical parameters should not be considered as a substitute for Fourier-Bessel indexing, asymmetric refinements from featureless cylinders, or experimental approaches like tomography.</p>
</sec>
<sec id="s2d">
<title>2D and 3D masks</title>
<p>Masks are used during refinement on both the 2D experimental images and on the 3D reconstruction. Masking the 2D experimental images helps to reduce the influence of noise or the neighbouring particles on the alignment in the expectation step, and the same mask is also used to determine the mean and standard deviation in the background area for the normalisation of boxed segments. Masking the 3D reconstruction reduces the noise in the solvent region, and thus leads to a better reference for the next iteration. For the analysis of helical structures, a circular 2D mask from standard single-particle analysis is multiplied with an additional rectangular mask across the entire particle image with a width according to the <italic>outer_tube_diameter</italic> parameter (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This mask is no longer rotationally invariant, but is rotated according to the most likely in-plane rotation angle for each experimental image. Prior to any refinement, this in-plane rotation is estimated from the manual or template-based particle picking procedures (also see below).</p>
<fig id="fig3" position="float">
<label>Figure 3:</label>
<caption><p>Masks for 2D images (<bold>A</bold>) and 3D maps (<bold>B</bold>). Areas of a filament inside the mask are shown in grey, areas outside the mask in white. In panel A, the helical axis runs at a 45&#x00B0; angle with the horizontal direction, which represents an arbitrary in-plane rotation angle. The helical axis (i.e. the Z-axis) runs parallel to the vertical direction in B. Panels C-F illustrate the need for the circular (or spherical) component of these masks. Rotation of a unmasked segment (<bold>C</bold>) leads to artefacts (top and bottom in <bold>D</bold>), due to wrapping effects caused by rotations in the Fourier domain. The application of a circular mask to the original image (<bold>E</bold>) allows rotation without artefacts (<bold>F</bold>).</p>
</caption>
<graphic xlink:href="095034_fig3.tif"/></fig>
<p>Likewise, a spherical solvent mask on the 3D reconstruction from standard single-particle analysis is multiplied with a hollow cylinder mask with the same <italic>outer_tube_diameter</italic> parameter describing the width of the 2D mask. An optional <italic>inner_tube_diameter</italic> parameter also allows to mask away densities inside hollow helices (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p>
<p>One could argue that because helical segments extend all the way across the image, one would not need the circular or spherical components of these masks. However, as all reference projections are taken as 2D slices from the 3D Fourier transform of the reference map, real-space artefacts may again arise from non-empty corners of the reference upon rotation. To make comparisons between the reference projections and the experimental images consistent, the corners are removed from both the 3D map and the 2D images (<xref ref-type="fig" rid="fig3">Figure 3C-F</xref>).</p>
</sec>
<sec id="s2e">
<title>Incorporating prior information about the orientations</title>
<p>The statistical framework provides an elegant way to express prior information about the relative rotations and translations of each experimental image. For example, in both single-particle analysis and the processing of helical filaments, (manual or automated) particle picking will yield residual translational offsets around the approximate centre of the images. RELION expresses this information as a Gaussian prior probability function, and estimates its standard deviation from the data during the iterative refinement. For helical processing, this distribution is changed into an anisotropic function (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Along the helical axis, the prior probability is a tophat distribution with non-zero values from &#x2212;<italic>rise</italic>/2 to &#x002B;<italic>rise</italic>/2 around the centre of the image. This distribution prevents segments from translating into the next asymmetric unit, which would lead to averaging multiple times over the same signal in overlapping segments. In the orthogonal direction, a Gaussian distribution is used, for which the standard deviation is re-estimated at every iteration of the expectation maximisation algorithm in the same way as in the single-particle approach (<xref ref-type="bibr" rid="c35">Scheres, 2012a</xref>).</p>
<fig id="fig4" position="float">
<label>Figure 4:</label>
<caption><p>Priors on the orientational parameters. <bold>A.</bold> A top-hat prior on the in-plane translations along the helical axis, and a Gaussian prior on the in-plane translations perpendicular to the helical axis. <bold>B.</bold> A mono-modal Gaussian prior on the tilt angle, which describes the out-of-plane rocking of filaments in the ice layer. <bold>C.</bold> A bi-modal Gaussian prior on the psi angle, which describes the in-plane rotation of the filament.</p>
</caption>
<graphic xlink:href="095034_fig4.tif"/></fig>
<p>Unlike in single-particle analysis, there is also ample prior knowledge about the relative rotations of helical segments. Firstly, because the long filaments tend to lie approximately horizontal inside the ice layer, we use a Gaussian distribution that is centred at 90&#x00B0; on the tilt angle in RELION (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Distributions with a wider standard deviation can be used to account for increasing degrees of rocking, but at present this parameter is fixed at a value provided by the user. Alternatively, the user can choose to allow the centre of the tilt prior for each particle to move to the most likely angle from the previous iteration. In principle, if the helical twist and rise are known, there are also strong relationships for neighbouring segments between the rotations along the helical axis, i.e. the &#x2018;rot&#x2019; angle in RELION. However, as the rot angle is strongly coupled with the translation along the helical axis, expressing this information into a prior is more complicated, and this is not done in the current implementation.</p>
<p>For the in-plane rotations, the &#x2018;psi&#x2019; angle in RELION, we introduce a bimodal prior for helical segments that expresses the prior knowledge that the particle picking provides about the direction of the helix, but with an ambiguity in its polarity (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). This prior consists of two opposing Gaussian distributions that are clipped at 3 standard deviations. The ambiguity in polarity is absent for helices with D<italic>n</italic> point group symmetry. For helices with C<italic>n</italic> symmetry, this polarity is typically resolved during the refinement process. One can also express the prior knowledge that all segments from the same helix should have the same polarity. In our implementation, one starts the refinement with symmetrical priors on the in-plane rotations, where the two opposing Gaussian distributions have equal weights. As the refinement progresses, and particles accumulate a stronger probability for one of the two polarities, the difference in the weights on the two opposing Gaussians becomes correspondingly larger. In 3D auto-refinement, and sometimes also in 2D or 3D classification, initial iterations of exhaustive orientational searches are followed by iterations where only local orientational searches are performed. At this point, the local searches are only performed around the in-plane rotation with the largest weight.</p>
<p>For both the in-plane rotation and the tilt-angle, we also implemented an option to centre the prior on the optimal orientations from the previous iteration for all neighbouring segments within a user-defined distance. A Gaussian function (with a standard deviation of one third of the user-defined distance) is used to assign lower weights to segments that are further away. This local averaging option is implemented in the <monospace>relion&#x005F;refine</monospace> program as <monospace>--helical&#x005F;sigma&#x005F;distance X</monospace>, where X is the standard deviation of the Gaussian weight function. Local averaging reduces discontinuities in the orientational assignments along a single filament.</p>
</sec>
<sec id="s2f">
<title>Particle picking and extraction</title>
<p>Apart from modifications to the refinement program that underlies the 2D/3D classification and 3D auto-refinement options of RELION, we also modified the programs for manual and template-based particle picking and particle extraction. The program for manual picking allows the user to identify the start and end points of helices by subsequent left-mouse clicks in the micrographs. For the template-based picking algorithm, the figure-of-merit calculation, which expresses the fit between the template and any local area in the micrograph, remains unchanged from the single-particle approach (<xref ref-type="bibr" rid="c33">Scheres, 2015</xref>). The adaptation of the algorithm lies in the detection of filaments and cross-overs between filaments. The latter requires additional parameters for the helix diameter, the inter-box distance (in multiples of the estimated helical rise), and the maximum curvature of the filaments (which is expressed as the fraction, between 0 and 1, of the curvature of a circle with the particle radius). The algorithm to detect filaments searches for peaks in the figure-of-merit map for the entire micrograph, and considers neighbouring peaks within a distance of half the template box size. Peaks that have too few neighbours, or neighbours that do not satisfy the maximum curvature requirement, are discarded. Then, the algorithm iteratively extends candidates for helical tracks in both directions, starting from the peak with the highest figure-of-merit, until no new segments can be at the ends. Once all helical tracks have been identified, the program calculates output segment coordinates according to the specified inter-box distance. At this stage, regions in the micrographs where two different helical filaments overlap are excluded.</p>
<p>Upon extraction of the segments from the micrographs, apart from the corresponding X-Y coordinates and the figure-of-merit, the particle extraction program also outputs for each segment its in-plane rotation along the helical track, a distinct number for the helix it belongs to, and its position within that helix. The latter information is then used to construct the relevant priors on the orientations of each segment as described above. This process does not require any additional user input when RELION is used for all steps from particle picking to refinement. However, if users have previously picked particles in a program outside the RELION workflow, then the additional metadata should be provided through an imported STAR file in RELION format. In that case, it may be more convenient to re-pick and/or re-extract the segments inside RELION.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Test data sets</title>
<p>To test the different aspects of our implementation we used four data sets (<xref ref-type="table" rid="tbl1">Table 1</xref>). Three of these data sets are available from the EMPIAR data base (<xref ref-type="bibr" rid="c22">Iudin et al., 2016</xref>): EMPIAR-10020 on tobacco mosaic virus (TMV) (<xref ref-type="bibr" rid="c20">Fromm et al., 2015</xref>); EMPIAR-10019 of the contractile sheath of the bacterial type-VI secretion system, which is composed of the proteins VipA/VipB (<xref ref-type="bibr" rid="c25">Kudryashev et al., 2015</xref>); and EMPIAR-10031 on prion-like aggregates of the mitochondrial antiviral signalling protein that are mediated by the N-terminal caspase activation and recruitment domain (MAVS/CARD) (<xref ref-type="bibr" rid="c42">Xu et al., 2015</xref>). The fourth data set was collected as part of an in-house research project on the bacterial actin homolog, MamK (<xref ref-type="bibr" rid="c26">L&#x00F6;we et al., 2016</xref>). These test data sets were collected on different direct-electron detectors, while the filaments have different helical and point group symmetries and vary in their levels of order. TMV has been used as a test specimen for other helical reconstruction programs, e.g. (<xref ref-type="bibr" rid="c11">Desfosses et al., 2014</xref>; <xref ref-type="bibr" rid="c29">Rohou and Grigorieff, 2014</xref>), and consists of straight and regular helical assemblies that are interspersed with disc-like structures that break the helical symmetry. VipA/VipB filaments are also relatively straight and regular, while MAVS/CARD and MamK filaments are more flexible.</p>
<table-wrap id="tbl1" position="float">
<label>Table 1:</label>
<caption><p>Test data set characteristics</p></caption>
<graphic xlink:href="095034_tbl1.tif"/>
</table-wrap>
</sec>
<sec id="s3b">
<title>Particle picking and 2D classification</title>
<p><xref ref-type="fig" rid="fig5">Figure 5</xref> shows a representative micrograph for each of the four test samples. Because the discs in TMV filaments are hard to distinguish using the template-based picking approach, we performed the picking of TMV filaments manually. The relatively straight VipA/VipB filaments were also picked manually. MAVS/CARD and MamK filaments are increasingly bent. Because the manual picking approach assumes straight filaments, template-based particle picking is more suitable for these cases. The corresponding templates were generated from initial 2D classification runs on segments that were obtained by manually picking of the straighter filaments in a subset of the micrographs.</p>
<fig id="fig5" position="float">
<label>Figure 5:</label>
<caption><p>Representative micrographs, particle picking and 2D classification results for the four test cases. <bold>A.</bold> Manually picked coordinates (yellow) for a TMV micrograph. Non-helical discs are indicated with a red arrow. <bold>B.</bold> Manually picked coordinates (yellow) for a VipA/VipB micrograph. <bold>C.</bold> Autopicked coordinates (green) for a MAVS/CARD micrograph. <bold>D.</bold> Auto-picked coordinates (green) for a MamK micrograph. For each test case, four 2D class averages are shown as insets. Good class averages are indicated with a tick, suboptimal ones with a cross.</p>
</caption>
<graphic xlink:href="095034_fig5.tif"/></fig>
<p>After manual or template-based particle picking of the entire data sets, all extracted segments were subjected to a single round of reference-free 2D classification, which was used to separate suboptimal segments from segments that contribute to high-resolution class averages (<xref ref-type="fig" rid="fig5">Fig. 5A-D</xref>, insets).</p>
<p>For the VipA/VipB and the MAVS/CARD filaments, we also compared how manual and template-based particle picking affected the resolution of the final reconstruction after 3D auto-refinement (Supplementary table 1). For this comparison, we used the manually picked coordinates of MAVS/CARD that were available in the EMPIAR-10031 entry. For both test cases, auto-picking was again performed with 2D class averages from a small subset of manually picked segments. Template-based particle picking performed at least as well as manual particle picking. In particular for the more bent MAVS/CARD filaments, template-based particle picking selected many more particles, which gave rise to a higher resolution map after 3D auto-refinement.</p>
</sec>
<sec id="s3c">
<title>Initial model generation</title>
<p>Because the expectation maximisation algorithm in RELION is a local optimiser, the initial 3D reference needs to be within the radius of convergence of the optimisation algorithm in order to yield a correct structure. This is also true for alternative IHRSR implementations. In particular, providing incorrect helical twist and rise has been associated with nasty false minima that lead to grossly incorrect structures, even at apparently relatively high resolutions (reviewed by <xref ref-type="bibr" rid="c14">Egelman, 2010</xref>, <xref ref-type="bibr" rid="c13">2014</xref>; <xref ref-type="bibr" rid="c31">Sachse et al., 2007</xref>). Thereby, initial model generation and the corresponding estimation of helical parameters probably represent the most critical steps in successful helical reconstruction, and the user has multiple options here. Additional experimental data, e.g. from tomograms, sub-tomogram averages, or from homologous structures may be an efficient way to obtain initial 3D models. For example, in the original publication on the MamK structure (<xref ref-type="bibr" rid="c26">L&#x00F6;we et al., 2016</xref>), we placed the atomic coordinates of a crystal structure of the MamK subunit in a helical lattice that was similar to actin, using the <monospace>-- pdb&#x005F;helix</monospace> option in the <monospace>relion&#x005F;helix&#x005F;toolbox</monospace> program. Nevertheless, for all four test data sets described here, we chose to calculate initial models <italic>de novo</italic> (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p>
<fig id="fig6" position="float">
<label>Figure 6:</label>
<caption><p>Initial model generation for TMV (<bold>A</bold>), VipA/VipB (<bold>B</bold>), MAVS/CARD (<bold>C</bold>) and MamK (<bold>D</bold>). In A and B, on the left the amplitudes of Fourier-space diffraction pattern of a selected 2D class average image is shown, with the layer lines numbered and the vector pair that constructs the helical lattice indicated with red arrows. The helical lattice and its mirror counterpart are shown with red and green boxes, respectively. The corresponding initial spheres-only models are shown on the right. In C and D, the featureless cylinder (the width of which is estimated from the 2D class averages) that was used as an initial model is shown on the left, and the result from a 3D refinement without imposing any symmetry is shown on the right.</p>
</caption>
<graphic xlink:href="095034_fig6.tif"/></fig>
<p>For both TMV and VipA/VipB, we obtained initial estimates for the helical twist and rise from indexing the diffraction pattern of a 2D class average image (<xref ref-type="fig" rid="fig6">Fig 6A,B</xref>). In brief, we first calculate the helical repeat distance, which is the distance between two subunits which are (approximately) registered along the z-axis, from the reciprocal distance from the equator to the first layer-line (see blue dashed lines in <xref ref-type="fig" rid="fig6">Fig 6A,B</xref>). Then, to determine how many subunits there are in a single turn, we mark the first maxima along each layer-line and find a 2D lattice that links half of these maxima, while the mirrored lattice across the meridian links the other half of the maxima. This mirror symmetry can be thought of as representing two overlapping lattices from the near and far sides of the cylindrical structure (shown with red and green boxes in <xref ref-type="fig" rid="fig6">Fig 6A,B</xref>). For the two unit vectors that span this lattice, we then estimate the order of their Bessel functions from their distances to the meridian and the realspace diameter of the helix as observed in the 2D class averages. The Bessel orders and the geometry of the lattice in reciprocal space, are then used to calculate the helical pattern in real-space (Supplementary Figure 1), from which the helical twist and rise can be derived.</p>
<p>For TMV, the unit vectors of the lattice on layer lines 1 and 3, have estimated Bessel orders &#x002B;16 and &#x2212;1, respectively. This leads to 16&#x2153; subunits in a full turn in real-space, and hence an estimated twist of 22.04&#x00B0;. The 16&#x2153; subunits per turn results in the same structure being in register along the z-axis after 3 turns. Therefore, the estimated repeat distance of 71 &#x00C5; is divided by 3&#x00D7;16&#x2153;&#x003D;49 to yield an estimated rise of 1.45 &#x00C5;. For VipA/VipB, the unit vectors of the lattice both lie on the first lattice line, and have estimated orders of &#x002B;12. so initial estimates for twist and rise were 30&#x00B0; and 21.4 &#x00C5;. Initial 3D models were then generated for both test cases by placing spheres in a helical pattern with the estimated twist and rise. The latter functionality has been implemented through the <monospace>--simulate&#x005F;helix</monospace> option in the <monospace>relion&#x005F;helix&#x005F;toolbox</monospace> program, where the user also provides the diameter of each sphere (so that neighbouring spheres touch each other to form the helical lattice) and the diameter of the helix (as obtained from 2D class averages). Subsequent refinement of these multi-sphere models, while imposing helical symmetry and performing local optimisations of the helical twist and rise, then led to correctly converged structures at near-atomic resolution for both TMV and VipA/VipB. The final, refined values of twist and rise were 22.03&#x00B0; and 1.410 &#x00C5; for TMV, and 29.41&#x00B0; and 21.79 &#x00C5; for VipA/VipB.</p>
<p>For the MAVS/CARD and the MamK helices, we started 3D refinements from a featureless cylinder. The <monospace>relion&#x005F;helix&#x005F;toolbox</monospace> program implements functionality to create such models through the <monospace>--cylinder</monospace> option, where the user only needs to provide its diameter. For both test cases, refining a cylindrical model in C1, without imposing any helical symmetry (using the <monospace>-- ignore&#x005F;helical&#x005F;symmetry</monospace> option in the <monospace>relion&#x005F;refine</monospace> program), yielded a map in which helical symmetry was already apparent. The <monospace>--search</monospace> option in the <monospace>relion&#x005F;helix&#x005F;toolbox</monospace> program was then used to estimate the helical twist and rise from these asymmetrical reconstructions. This yielded estimates of &#x2212;101.1&#x00B0; and 5.150 &#x00C5; for MAVS/CARD and 18.29&#x00B0; and 55.24 &#x00C5; for MamK. Using a symmetrised version of the asymmetrical map, while again imposing helical symmetry and performing local optimisations of the helical twist and rise, then also led to correct convergence. The final, refined values of twist and rise were &#x2212;101.2&#x00B0; and 5.071 &#x00C5; for MAVS/CARD, and 23.75&#x00B0; and 52.11 &#x00C5; for MamK.</p>
</sec>
<sec id="s3d">
<title>High-resolution structure determination</title>
<p>At this stage of the structure determination process, the workflow of high-resolution structure determination becomes more similar to the standard approach to single-particle analysis, see (<xref ref-type="bibr" rid="c32">Scheres, 2016</xref>) for a recent review. For each of the four test cases, we performed an initial 3D auto-refinement with the selected segments. For the TMV and MAVS/CARD data sets, we then extracted movie-frames for the selected particles and performed per-particle beam-induced motion correction and resolution dependent radiation-damage weighting for each movie frame, which is known as particle polishing in the RELION work flow (<xref ref-type="bibr" rid="c34">Scheres, 2014</xref>). Although movie frames were available for our MamK data set, and particle polishing was performed when we initially published this data set (<xref ref-type="bibr" rid="c26">L&#x00F6;we et al., 2016</xref>), we chose not to re-process the movie frames of this large data set for this paper. The VipA/VipB EMPIAR entry does not contain movies, so no movie processing was performed.</p>
<p>After 3D auto-refinement of the polished particles, we attempted further selection of the best segments by 3D classification. In these classifications, we did not allow further adjustments of the orientations. However, for none of the four test cases 3D classification managed to identify a subset that yielded a higher resolution map than we had already calculated from all polished particles. Using RELION&#x2019;s post-processing job-type, we then applied automated B-factor sharpening (<xref ref-type="bibr" rid="c30">Rosenthal and Henderson, 2003</xref>) and corrected the FSC between the two independently refined maps of the 3D auto-refinement for the convolution effects of a solvent mask using phase randomisation (<xref ref-type="bibr" rid="c4">Chen et al., 2013</xref>). The final overall resolution estimate was based on the FSC&#x003D;0.143 threshold (<xref ref-type="bibr" rid="c37">Scheres and Chen, 2012</xref>). Variations in local resolution were estimated using phase-randomisation in combination with sliding a soft spherical mask across the entire volume (<xref ref-type="bibr" rid="c17">Fernandez-Leiro and Scheres, 2016a</xref>). After postprocessing, we used the <monospace>relion&#x005F;helix&#x005F;toolbox</monospace> program with the <monospace>--impose</monospace> option to symmetrise the (asymmetric) postprocessed map according to the refined helical twist and rise. <xref ref-type="fig" rid="fig7">Figure 7</xref> shows the final maps, the solvent-corrected FSC curves and the local resolution estimates. Parameters specific to the helical reconstruction, estimated B-factors, overall resolution estimates and other refinement characteristics are summarised in <xref ref-type="table" rid="tbl1">Table 1</xref>. 2D classification or 3D auto-refinement for the smaller data sets of TMV and VipA/VipB took a few hours on 64-128 CPU cores. Similar calculations with the larger data sets of MAVS/CARD and MamK took up to an entire day using similar computer resources. A modern GPU (like the Nvidia GTX1080) processes the equivalent of approximately 100 CPU cores in these calculations.</p>
<fig id="fig7" position="float">
<label>Figure 7:</label>
<caption><p>Reconstructions for the four test cases: TMV (<bold>A</bold>), VipA/VipB (<bold>B</bold>), MAVS/CARD (<bold>C</bold>) and MamK (<bold>D</bold>). A view of the reconstructed helix coloured according to local-resolution estimates (from 3.5 &#x00C5; in blue to 5 &#x00C5; in maroon) is shown on the left. The FSC curve between the two independently refined half-sets is shown in the middle. A detail of the structure with the corresponding atomic model is shown on the right. For TMV, VipA/VipB and MAVS/CARD, the same detail from the EMDB map is also shown.</p>
</caption>
<graphic xlink:href="095034_fig7.tif"/></fig>
</sec>
<sec id="s3e">
<title>Local optimisation of twist and rise</title>
<p>Although the local optimisation of helical twist and rise did converge to the correct solution in all four test cases, this is not necessarily the case in general. To provide insights into the robustness of the local optimisation of helical parameters, we performed multiple refinements with the MamK data set, starting from different initial estimates for the helical twist and rise (Supplementary Table 2). All these refinements were started from a cylindrical reference model that was low-pass filtered at 30 &#x00C5; resolution. For convergence to the correct symmetry, values for the initial estimate of the twist need to lie within approximately &#x00B1; 20&#x0025; or 19&#x007E;25&#x00B0; of the correct value; values for the initial estimates of the rise need to be within &#x00B1; 20&#x0025; or 42&#x007E;62&#x00C5;. Interestingly, relatively large errors in the initial estimates can still lead to correctly refined values, but in some cases the resolution of the corresponding refined map is suboptimal. This behaviour is likely due to the switching from exhaustive orientational searches in the initial stages of the refinement to local searches later on. This means that, if in a given refinement the parameters for twist and/or rise change considerably, one should probably perform a second refinement starting from the refined values of the first run. Indications for incorrectly refined symmetries are a lower resolution of the final map, and convergence of twist and/or rise to values at the edge of the user-defined search range.</p>
</sec>
<sec id="s3f">
<title>Pitfalls of imposing incorrect helical symmetry</title>
<p>To further illustrate the dangers of imposing an incorrect helical symmetry, we also re-refined the VipA/VipB data set using a twist of 64.9&#x00B0; and a rise of 3.63 &#x00C5;. This symmetry corresponds to a 6-start helix with C1 symmetry, instead of the correct helix with C6 symmetry. After 3D auto-refinement and post-processing, RELION produces a map with a reported resolution of 4.5 &#x00C5; (with refined values of twist&#x003D;65.07&#x00B0; and rise&#x003D;3.76 &#x00C5;). Despite the relatively high nominal resolution, the map is devoid of protein-like features like alpha-helices or beta-strands that one would expect at this resolution (<xref ref-type="fig" rid="fig8">Fig 8A-B</xref>, left). In addition, the FSC curve shows "spiky" artefacts (<xref ref-type="fig" rid="fig8">Fig 8C</xref>). When the correct symmetry is imposed, the achieved resolution is 3.3 &#x00C5;, the map does show the expected features (<xref ref-type="fig" rid="fig8">Fig 8A-B</xref>, right), and the FSC curve is smooth.</p>
<fig id="fig8" position="float">
<label>Figure 8:</label>
<caption><p>Effects of imposing different helical symmetries for the VipA/VipB data set. <bold>A</bold>. Reconstruction with the correct helical twist and rise imposed. B. Reconstruction with the wrong helical symmetry imposed. The maps in A and B are coloured according to local-resolution estimates (from 4 &#x00C5; in blue to 6 &#x00C5; in maroon). <bold>C</bold>. FSC curves between two independently refined half-sets for the refinement with the correct helical symmetry (red) and the wrong helical symmetry (black). <bold>D</bold>. Central slices through the unsharpened map from the refinement with the correct helical symmetry (left) and the wrong helical symmetry (right).</p>
</caption>
<graphic xlink:href="095034_fig8.tif"/></fig>
</sec>
<sec id="s3g">
<title>The inter-box distance</title>
<p>To illustrate the effect of the inter-box distance on the reconstruction results, we performed refinement with various numbers of new asymmetric units per segment for TMV and for MAVS/CARD (Supplementary figure 2). For straight helical tubes like TMV, using a relatively large inter-box distance is expected to save computation time without affecting the final resolution. For more flexible helices like MAVS/CARD, shorter inter-box distance might be needed to describe the bends in the filaments with more orientational parameters. However, the results of our experiments suggest that larger inter-box distance still perform well, even for the more flexible MAVS/CARD filaments. In fact, in both cases inter-box distances in the range of 2-30&#x0025; seem to yield structures of very similar quality. Possibly, segments corresponding to the most highly curved MAVS/CARD filaments are rejected by our auto-picking algorithm, or during the subsequent selection of 2D classes. An obvious advantage of using larger inter-box distances is that the computational costs of the refinement scale linearly with the total number of extracted segments.</p>
</sec>
<sec id="s3h">
<title>The half-sets for independent refinements</title>
<p>In 3D auto-refinement the data is divided into two half-sets, which are then refined independently in order to prevent an iterative built-up of noise due to overfitting (<xref ref-type="bibr" rid="c37">Scheres and Chen, 2012</xref>). For singleparticle analysis, the half-sets are created randomly from the extracted particles. For helical segments, random generation of the half-sets may be problematic, as the signal in one segment will partially overlap with the signal in its neighbouring segment. This overlap could introduce dependencies between the half-set refinements, and thus potentially lead to overfitting.</p>
<p>There are two aspects of our helical implementation that prevent this type of overfitting. Firstly, the prior on the translations (<xref ref-type="fig" rid="fig4">Fig 4A</xref>) only extends for a single rise in the direction of the helical axis. This will prevent the signal of any segment from translating on top of the identical, overlapping signal in the neighbouring segment. Secondly, to build in an additional safe-guard against overfitting, our implementation of helical processing divides the data set into half-sets based on a random division of helical filaments. That is, at the particle extraction stage, all segments from a single filament will be assigned to the same half-set.</p>
<p>To test both counter-overfitting measures, we performed 3D auto-refinements on the TMV data set (Supplementary Figure 3). In the first refinement, we used our implementation as intended, by both using the translational prior in the helical direction and the division of the data set into halves on the filament level. The post-processed FSC curve indicates a final resolution of 4.1 &#x00C5;, which is in agreement with the features visible in the map. Importantly, beyond 3.8 &#x00C5;, the FSC drops to values around zero for the rest of the frequencies. Secondly, we performed a refinement where we switched off both safe guards, i.e. we used an isotropic translational prior and random half-sets at the segment-level. In this case, severe overfitting of the data occurs as expected, as is evident from the FSC curve, which never drops to zero. A third refinement, where the half-sets were made at the filament-level but isotropic translational priors were used, shows no signs of overfitting. This refinement yielded a lower resolution map than the first refinement, probably as a result of a suboptimal translations along the helical axis. Finally, in a fourth refinement we made the half-sets at the segment-level and only used the anisotropic translational prior. In this case, a small amount of overfitting is present, indicating that the anisotropic translational prior alone is not enough to rigorously prevent overfitting.</p>
</sec>
<sec id="s3i">
<title>Angular and translational priors</title>
<p>In alternative refinement programs, the concept of priors on the rotations or translations are often expressed as local searches within a user-defined search range. Within the statistical framework, this corresponds to imposing a prior with a top-hat shape (i.e. with a constant, non-zero value within the search range, and a zero value outside the search range). In general, the better the shape of the prior reflects the actual distribution of the corresponding orientational parameters, the better the program is expected to perform, and the difference in performance is expected to become larger with increasing levels of noise in the data. Another advantage of the statistical framework, is that the optimal search range can be estimated from the data themselves, e.g. by optimising the variance in the translations perpendicular to the helical axis. A similar approach could in principle be implemented in the alternative approaches as well (<xref ref-type="bibr" rid="c39">Sigworth, 1998</xref>), but this is not done in many programs.</p>
<p>To test the influence of the shape of the prior on the refinement results, we compared standard refinements with Gaussian priors to refinements with top-hat priors. In the latter refinements, all tophat priors had non-zero values from &#x2212;3 to &#x002B;3 standard deviations of the corresponding Gaussian priors in the standard runs. Supplementary Figure 4 shows the resulting FSC curves after post-processing for these refinements on the MamK and VipA/VipB data sets. The difference between the Gaussian and the top-hat prior was not notable for MamK, but for VipA/VipB the Gaussian prior did yield a better structure.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>We introduce functionality for helical reconstruction in the RELION program, and show for four different data sets that it can calculate maps to near-atomic resolution. For the three test cases from the EMPIAR data base, we show that helical processing in RELION yields results that are comparable to those obtained in alternative programs. Our implementation is integrated into the standardised workflow engine of RELION version 2.0, which facilitates the design of image processing strategy for novel users, and provides convenient tools for electronic bookkeeping and file management (<xref ref-type="bibr" rid="c17">Fernandez-Leiro and Scheres, 2016a</xref>). Because of the strong parallels with single particle analysis, users already familiar with RELION should find the transition to helical processing straightforward. The interaction with the user is similar to single-particle analysis of asymmetric particles, and parameters specific for helical reconstruction are mainly provided on dedicated tabs in the main GUI. Advantages that are inherent to the empirical Bayesian approach in RELION, such as the data-driven calculation of optimal filters for 3D reconstructions and alignment, are directly carried over from standard single-particle analysis to helical processing. In addition, the existing options for classification of images in 2D or in 3D, with or without masks, and with or without subtraction of partial signal (<xref ref-type="bibr" rid="c1">Bai et al., 2015</xref>; <xref ref-type="bibr" rid="c32">Scheres, 2016</xref>), are all available to be explored for helical processing of highly heterogeneous samples.</p>
<p>In the test cases presented in this paper, 2D classification proved useful in discarding suboptimal segments from the data set, but similar classification attempts in 3D were unsuccessful. These results contrast with common observations in single-particle analysis, where 3D classification is often key in selecting subsets of the data that yield the highest resolution maps (<xref ref-type="bibr" rid="c18">Fernandez-Leiro and Scheres, 2016b</xref>). On the one hand, these results may be attributed to the relatively high quality of the test data sets. On the other hand, there are intrinsic differences in classification of helices and individual asymmetric particles. The packing interactions inside the helical lattice, for example, may impose limitations on the structural heterogeneity of the individual protein subunits. And if structural heterogeneity does exist among the neighbouring subunits, for example because a floppy domain sticks out into the solvent, then classification of that heterogeneity may be difficult. The concept of a 3D helical class is particularly inadequate when the structural heterogeneity happens independently among individual segments along each filament. Only when different types of helical structures exist, i.e. when neighbouring segments in stretches of the filaments all adopt the same conformation, is 3D classification expected to perform well. For such cases, we implemented the option to independently refine the helical twist and rise of each class. Although this option did not improve the maps for the test cases described in this paper, we envision that it will be useful in cases where these types of structural heterogeneity do exist.</p>
<p>We explicitly stress that our implementation does not provide a generally applicable solution to the problem of local minima in the optimisation of helical parameters. Similar to alternative implementations of the IHRSR approach, RELION is based on an optimisation algorithm that will converge to the nearest local minimum, and the energy landscape of helical reconstruction, in particular with respect to the twist and rise parameters, is known to be highly complex (<xref ref-type="bibr" rid="c14">Egelman, 2010</xref>, <xref ref-type="bibr" rid="c13">2014</xref>; <xref ref-type="bibr" rid="c31">Sachse et al., 2007</xref>). Thereby, the generation of a reliable initial 3D model with reasonable estimates for the helical twist and rise is likely to be the most difficult hurdle in helical reconstruction. For our test cases we employed two different methods. For MAVS/CARD and MamK, we successfully refined a featureless cylinder without imposing any point group or helical symmetry, and then estimated the helical twist and rise from the asymmetric reconstruction. This method is more likely to work for relatively simple helices, i.e. helices with few asymmetric subunits per box and few interactions between the subunits. An advantage of this method is that it has minimal user input. A drawback is that the initial few iterations of such refinements are relatively slow, as the probabilities for many orientations are significant, and these orientations thus all need to be considered in the reconstruction. For more complicated helices, asymmetric refinement of a featureless cylinder often does not work. For example, asymmetric refinement of a featureless cylinder never yielded a structure with discernable subunits for TMV or VipA/VipB. Fortunately, more complicated helices often yield more information-rich Fourier transforms, especially when these can be averaged together into high-resolution 2D class averages. Therefore, for complicated helices Fourier-Bessel indexing is a viable way to determine the initial estimate for helical twist and rise. For both TMV and VipA/VipB, placing spheres into the corresponding helical lattice then yielded an initial model within the radius of convergence of the refinement algorithm. Although computationally cheaper than refinement of a featureless cylinder, a drawback of this method is its dependence on user expertise in indexing diffraction patterns. Still, Fourier-Bessel indexing typically yields a better understanding of the structure, and may therefore help to avoid errors.</p>
<p>Our refinement of the VipA/VipB data set as a 6-start helix in C1 instead of the correct helical symmetry in C6 illustrates the pitfalls of imposing incorrect helical symmetry. Despite the incorrect symmetry, 3D auto-refinement yielded two half-maps that correlated with each other up to a resolution of 4.5 &#x00C5;. Instead of directly measuring resolution, the FSC merely measures the consistency between two maps. By imposing the same, incorrect symmetry in both half-set refinements, the resulting maps become incorrect in a consistent manner, which results in a near-atomic resolution estimation of a completely incorrect map. At closer inspection, the reconstructed map did not reveal any protein-like features, and also the FSC curve itself showed artefacts. However, the indications that something is wrong may not necessarily be so clear. Actually, the MAVS/CARD test case was the subject of controversy itself, as an initial structure by the same authors was proven to be incorrect (<xref ref-type="bibr" rid="c13">Egelman, 2014</xref>; <xref ref-type="bibr" rid="c43">Xu et al., 2014</xref>, <xref ref-type="bibr" rid="c42">2015</xref>). In our hands, starting MAVS/CARD refinements without imposing any symmetry from a featureless cylinder still led to the correct structure (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Moreover, when starting from the incorrect helical parameters described in the original MAVS/CARD paper, the helical twist and rise consistently converged to the edge of the search ranges (not shown), which is a strong indication of incorrect estimates. Nevertheless, in the general case, validation of helical symmetry will remain difficult until one can reconstruct maps to near-atomic resolution, protein features like separated beta-strands and amino acid side chains can be readily distinguished, and a stereo-chemically sound atomic model can be refined inside the map. For cases where such maps cannot be obtained, doubts about the correct helical symmetry will remain relevant.</p>
<p>Apart from the initial model and the initial estimate for the helical twist and rise, important user-defined parameters are the inter-box distance and the different options to impose priors on the orientations. Smaller inter-box distances allow modelling more flexible filaments, but come at considerable computational cost, as each filament will yield more segments. Our results with TMV and MAVS/CARD indicate that relatively larger inter-box distances (i.e. up to 30&#x0025;) may indeed be used without noticeable loss in resolution. When in doubt, one could start processing with a relatively large inter-box distance, and then re-run refinements near the end with a smaller inter-box distance to make sure the best possible resolution is obtained. Our results with VipA/VipB indicate that Gaussian-shaped priors may add useful information to the refinement when compared to top-hat priors, which are typically employed in alternative programs. This difference however was not noticeable in the case of MamK. Still, because these priors come at virtually no extra computational cost and Gaussian distributions are more likely to describe the orientational distributions in experimental data, the Gaussian priors in RELION are switched on by default.</p>
<p>Within the field of single-particle analysis, considerable concern has arisen about the accurate estimation of resolution in 3D reconstructions (<xref ref-type="bibr" rid="c21">Henderson et al., 2012</xref>). One approach to prevent the iterative build-up of high-resolution noise in the reconstruction is the independent refinement of two halves of the data (<xref ref-type="bibr" rid="c37">Scheres and Chen, 2012</xref>). In standard single-particle analysis, the two half sets are often generated randomly or based on odd/even particle numbers. When extracting overlapping segments from helical filaments, the overlap in signal between neighbouring segments could introduce spurious dependencies between the two half-sets. Our results show that a random division of the data set based on filaments rather than segments, combined with a tophat prior on the translations along the helical axis, effectively yield maps with reliable resolution estimates.</p>
<p>In conclusion, we present an implementation of the IHRSR approach to helical processing in the RELION program. The object-oriented character of RELION's code facilitates the re-use of many of its functions. This makes it relatively straightforward to extend the helical processing approach presented here to 3D data, such as sub-tomograms. This extension is something we will pursue for a future version. Another possible extension is the introduction of functionality to deal with breaks in the helical symmetry, such as the seam in microtubules (<xref ref-type="bibr" rid="c27">Metlagel et al., 2007</xref>). The code available in the current 2.0 version implements all features described in this paper, and has already been useful in calculating several new structures in our own lab. We hope this paper will help to make it similarly useful to others.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank Nigel Unwin, Tony Crowther, Jude Short and Jan L&#x00F6;we for stimulating discussions, and Jake Grimmett and Toby Darling for assistance with high-performance computing. This work was funded by the UK Medical Research Council (MC&#x005F;UP&#x005F;A025&#x005F;1013).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Bai</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Rajendra</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Shi</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.H.</given-names></string-name>, <year>2015</year>. <article-title>Sampling the conformational space of the catalytic subunit of human &#x03B3;-secretase</article-title>. <source>eLife</source> <fpage>4</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.11182</pub-id></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Behrmann</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Tao</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Stokes</surname>, <given-names>D.L.</given-names></string-name>, <string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Raunser</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Penczek</surname>, <given-names>P.A.</given-names></string-name>, <year>2012</year>. <article-title>Real-space processing of helical filaments in SPARX</article-title>. <source>J. Struct. Biol.</source> <volume>177</volume>, <fpage>302</fpage>&#x2013;<lpage>313</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.jsb.2011.12.020</pub-id></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Beroukhim</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Unwin</surname>, <given-names>N.</given-names></string-name>, <year>1997</year>. <article-title>Distortion correction of tubular crystals: improvements in the acetylcholine receptor structure</article-title>. <source>Ultramicroscopy</source> <volume>70</volume>, <fpage>57</fpage>&#x2013;<lpage>81</lpage>. doi:<pub-id pub-id-type="doi">10.1016/S0304-3991(97)00070-3</pub-id></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>McMullan</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Faruqi</surname>, <given-names>A.R.</given-names></string-name>, <string-name><surname>Murshudov</surname>, <given-names>G.N.</given-names></string-name>, <string-name><surname>Short</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <string-name><surname>Henderson</surname>, <given-names>R.</given-names></string-name>, <year>2013</year>. <article-title>High-resolution noise substitution to measure overfitting and validate resolution in 3D structure determination by single particle electron cryomicroscopy</article-title>. <source>Ultramicroscopy</source> <volume>135</volume>, <fpage>24</fpage>&#x2013;<lpage>35</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ultramic.2013.06.004</pub-id></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Clemens</surname>, <given-names>D.L.</given-names></string-name>, <string-name><surname>Ge</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>B.-Y.</given-names></string-name>, <string-name><surname>Horwitz</surname>, <given-names>M.A.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>Z.H.</given-names></string-name>, <year>2015</year>. <article-title>Atomic structure of T6SS reveals interlaced array essential to function</article-title>. <source>Cell</source> <volume>160</volume>, <fpage>940</fpage>&#x2013;<lpage>951</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2015.02.005</pub-id></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Cochran</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Crick</surname>, <given-names>F.H.</given-names></string-name>, <string-name><surname>Vand</surname>, <given-names>V.</given-names></string-name>, <year>1952</year>. <article-title>The structure of synthetic polypeptides. I. The transform of atoms on a helix</article-title>. <source>Acta Crystallogr.</source> <volume>5</volume>, <fpage>581</fpage>&#x2013;<lpage>586</lpage>. doi:<pub-id pub-id-type="doi">10.1107/S0365110X52001635</pub-id></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Crowther</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Henderson</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>J.M.</given-names></string-name>, <year>1996</year>. <article-title>MRC Image Processing Programs</article-title>. <source>J. Struct. Biol.</source> <volume>116</volume>, <fpage>9</fpage>&#x2013;<lpage>16</lpage>. doi:<pub-id pub-id-type="doi">10.1006/jsbi.1996.0003</pub-id></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>De Rosier</surname>, <given-names>D.J.</given-names></string-name>, <string-name><surname>Klug</surname>, <given-names>A.</given-names></string-name>, <year>1968</year>. <article-title>Reconstruction of Three Dimensional Structures from Electron Micrographs</article-title>. <source>Nature</source> <volume>217</volume>, <fpage>130</fpage>&#x2013;<lpage>134</lpage>. doi:<pub-id pub-id-type="doi">10.1038/217130a0</pub-id></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Dempster</surname>, <given-names>A.P.</given-names></string-name>, <string-name><surname>Laird</surname>, <given-names>N.M.</given-names></string-name>, <string-name><surname>Rubin</surname>, <given-names>D.B.</given-names></string-name>, <year>1977</year>. <article-title>Maximum-likelihood from incomplete data via the EM algorithm</article-title>. <source>J R. Stat. Soc Ser B</source> <volume>39</volume>, <fpage>1</fpage>&#x2013;<lpage>38</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>DeRosier</surname>, <given-names>D.J.</given-names></string-name>, <string-name><surname>Moore</surname>, <given-names>P.B.</given-names></string-name>, <year>1970</year>. <article-title>Reconstruction of three-dimensional images from electron micrographs of structures with helical symmetry</article-title>. <source>J. Mol. Biol.</source> <volume>52</volume>, <fpage>355</fpage>&#x2013;<lpage>369</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Desfosses</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ciuffa</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Gutsche</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Sachse</surname>, <given-names>C.</given-names></string-name>, <year>2014</year>. <article-title>SPRING &#x2013; An image processing package for single-particle based helical reconstruction from electron cryomicrographs</article-title>. <source>J. Struct. Biol.</source> <volume>185</volume>, <fpage>15</fpage>&#x2013;<lpage>26</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jsb.2013.11.003</pub-id></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="book"><string-name><surname>Diaz</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Rice</surname>, <given-names>W. J.</given-names></string-name>, <string-name><surname>Stokes</surname>, <given-names>D.L.</given-names></string-name>, <year>2010</year>. <chapter-title>Fourier&#x2013;Bessel Reconstruction of Helical Assemblies</chapter-title>, in: <source>Methods in Enzymology</source>. <publisher-name>Elsevier</publisher-name>, pp. <fpage>131</fpage>&#x2013;<lpage>165</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <year>2014</year>. <article-title>Ambiguities in helical reconstruction</article-title>. <source>eLife</source> <volume>3</volume>, <fpage>e04969</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.04969</pub-id></mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <year>2010</year>. <article-title>Reconstruction of helical filaments and tubes</article-title>. <source>Methods Enzymol.</source> <volume>482</volume>, <fpage>167</fpage>&#x2013;<lpage>183</lpage>. doi:<pub-id pub-id-type="doi">10.1016/S0076-6879(10)82006-3</pub-id></mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <year>2007</year>. <article-title>The iterative helical real space reconstruction method: Surmounting the problems posed by real polymers</article-title>. <source>J. Struct. Biol.</source> <volume>157</volume>, <fpage>83</fpage>&#x2013;<lpage>94</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.jsb.2006.05.015</pub-id></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <year>2000</year>. <article-title>A robust algorithm for the reconstruction of helical filaments using singleparticle methods</article-title>. <source>Ultramicroscopy</source> <volume>85</volume>, <fpage>225</fpage>&#x2013;<lpage>234</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="other"><string-name><surname>Fernandez-Leiro</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.</given-names></string-name>, <year>2016a</year>. <source>A pipeline approach to single-particle processing in RELION BioRxiv</source>: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/078352">https://doi.org/10.1101/078352</ext-link>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Fernandez-Leiro</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2016b</year>. <article-title>Unravelling biological macromolecules with cryo-electron microscopy</article-title>. <source>Nature</source> <volume>537</volume>, <fpage>339</fpage>&#x2013;<lpage>346</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature19948</pub-id></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Frank</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Radermacher</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Penczek</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Ladjadj</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Leith</surname>, <given-names>A.</given-names></string-name>, <year>1996</year>. <article-title>SPIDER and WEB: Processing and Visualization of Images in 3D Electron Microscopy and Related Fields</article-title>. <source>J. Struct. Biol.</source> <volume>116</volume>, <fpage>190</fpage>&#x2013;<lpage>199</lpage>. doi:<pub-id pub-id-type="doi">10.1006/jsbi.1996.0030</pub-id></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Fromm</surname>, <given-names>S.A.</given-names></string-name>, <string-name><surname>Bharat</surname>, <given-names>T.A.M.</given-names></string-name>, <string-name><surname>Jakobi</surname>, <given-names>A.J.</given-names></string-name>, <string-name><surname>Hagen</surname>, <given-names>W.J.H.</given-names></string-name>, <string-name><surname>Sachse</surname>, <given-names>C.</given-names></string-name>, <year>2015</year>. <article-title>Seeing tobacco mosaic virus through direct electron detectors</article-title>. <source>J. Struct. Biol.</source> <volume>189</volume>, <fpage>87</fpage>&#x2013;<lpage>97</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jsb.2014.12.002</pub-id></mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Henderson</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sali</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Baker</surname>, <given-names>M.L.</given-names></string-name>, <string-name><surname>Carragher</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Devkota</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Downing</surname>, <given-names>K.H.</given-names></string-name>, <string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Feng</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Frank</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Ludtke</surname>, <given-names>S.J.</given-names></string-name>, <string-name><surname>Medalia</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Penczek</surname>, <given-names>P.A.</given-names></string-name>, <string-name><surname>Rosenthal</surname>, <given-names>P.B.</given-names></string-name>, <string-name><surname>Rossmann</surname>, <given-names>M.G.</given-names></string-name>, <string-name><surname>Schmid</surname>, <given-names>M.F.</given-names></string-name>, <string-name><surname>Schr&#x00F6;der</surname>, <given-names>G.F.</given-names></string-name>, <string-name><surname>Steven</surname>, <given-names>A.C.</given-names></string-name>, <string-name><surname>Stokes</surname>, <given-names>D.L.</given-names></string-name>, <string-name><surname>Westbrook</surname>, <given-names>J.D.</given-names></string-name>, <string-name><surname>Wriggers</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Young</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Berman</surname>, <given-names>H.M.</given-names></string-name>, <string-name><surname>Chiu</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Kleywegt</surname>, <given-names>G.J.</given-names></string-name>, <string-name><surname>Lawson</surname>, <given-names>C.L.</given-names></string-name>, <year>2012</year>. <article-title>Outcome of the first electron microscopy validation task force meeting</article-title>. <source>Struct. Lond. Engl. 1993</source> <volume>20</volume>, <fpage>205</fpage>&#x2013;<lpage>214</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.str.2011.12.014</pub-id></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Iudin</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Korir</surname>, <given-names>P.K.</given-names></string-name>, <string-name><surname>Salavert-Torres</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kleywegt</surname>, <given-names>G.J.</given-names></string-name>, <string-name><surname>Patwardhan</surname>, <given-names>A.</given-names></string-name>, <year>2016</year>. <article-title>EMPIAR: a public archive for raw electron microscopy image data</article-title>. <source>Nat. Methods</source> <volume>13</volume>, <fpage>387</fpage>&#x2013;<lpage>388</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.3806</pub-id></mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Kimanius</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Forsberg</surname>, <given-names>B.O.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.H.</given-names></string-name>, <string-name><surname>Lindahl</surname>, <given-names>E.</given-names></string-name>, <year>2016</year>. <article-title>Accelerated cryo-EM structure determination with parallelisation using GPUs in RELION-2</article-title>. <source>eLife</source> <fpage>5</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.18722</pub-id></mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Klug</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Crick</surname>, <given-names>F.H.C.</given-names></string-name>, <string-name><surname>Wyckoff</surname>, <given-names>H.W.</given-names></string-name>, <year>1958</year>. <article-title>Diffraction by helical structures</article-title>. <source>Acta Crystallogr.</source> <volume>11</volume>, <fpage>199</fpage>&#x2013;<lpage>213</lpage>. doi:<pub-id pub-id-type="doi">10.1107/S0365110X58000517</pub-id></mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Kudryashev</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>R.Y.-R.</given-names></string-name>, <string-name><surname>Brackmann</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Scherer</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Maier</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Baker</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>DiMaio</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Stahlberg</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Egelman</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Basler</surname>, <given-names>M.</given-names></string-name>, <year>2015</year>. <article-title>Structure of the Type VI Secretion System Contractile Sheath</article-title>. <source>Cell</source> <volume>160</volume>, <fpage>952</fpage>&#x2013;<lpage>962</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2015.01.037</pub-id></mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>L&#x00F6;we</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>He</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <string-name><surname>Savva</surname>, <given-names>C.G.</given-names></string-name>, <year>2016</year>. <article-title>X-ray and cryo-EM structures of monomeric and filamentous actin-like protein MamK reveal changes associated with polymerization</article-title>. <source>Proc. Natl. Acad. Sci.</source> <volume>113</volume>, <fpage>13396</fpage>&#x2013;<lpage>13401</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1612034113</pub-id></mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Metlagel</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Kikkawa</surname>, <given-names>Y.S.</given-names></string-name>, <string-name><surname>Kikkawa</surname>, <given-names>M.</given-names></string-name>, <year>2007</year>. <article-title>Ruby-Helix: An implementation of helical image processing based on object-oriented scripting language</article-title>. <source>J. Struct. Biol.</source> <volume>157</volume>, <fpage>95</fpage>&#x2013;<lpage>105</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jsb.2006.07.015</pub-id></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Owen</surname>, <given-names>C.H.</given-names></string-name>, <string-name><surname>Morgan</surname>, <given-names>D.G.</given-names></string-name>, <string-name><surname>DeRosier</surname>, <given-names>D.J.</given-names></string-name>, <year>1996</year>. <article-title>Image Analysis of Helical Objects: The Brandeis Helical Package</article-title>. <source>J. Struct. Biol.</source> <volume>116</volume>, <fpage>167</fpage>&#x2013;<lpage>175</lpage>. doi:<pub-id pub-id-type="doi">10.1006/jsbi.1996.0027</pub-id></mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Rohou</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name>, <year>2014</year>. <article-title>Frealix: Model-based refinement of helical filament structures from electron micrographs</article-title>. <source>J. Struct. Biol.</source> <volume>186</volume>, <fpage>234</fpage>&#x2013;<lpage>244</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jsb.2014.03.012</pub-id></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Rosenthal</surname>, <given-names>P.B.</given-names></string-name>, <string-name><surname>Henderson</surname>, <given-names>R.</given-names></string-name>, <year>2003</year>. <article-title>Optimal determination of particle orientation, absolute hand, and contrast loss in single-particle electron cryomicroscopy</article-title>. <source>J. Mol. Biol.</source> <volume>333</volume>, <fpage>721</fpage>&#x2013;<lpage>745</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Sachse</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>J.Z.</given-names></string-name>, <string-name><surname>Coureux</surname>, <given-names>P.-D.</given-names></string-name>, <string-name><surname>Stroupe</surname>, <given-names>M.E.</given-names></string-name>, <string-name><surname>F&#x00E4;ndrich</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name>, <year>2007</year>. <article-title>Highresolution electron microscopy of helical specimens: a fresh look at tobacco mosaic virus</article-title>. <source>J. Mol. Biol.</source> <volume>371</volume>, <fpage>812</fpage>&#x2013;<lpage>835</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jmb.2007.05.088</pub-id></mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2016</year>. <article-title>Processing of Structurally Heterogeneous Cryo-EM Data in RELION</article-title>. <source>Methods Enzymol.</source> <volume>579</volume>, <fpage>125</fpage>&#x2013;<lpage>157</lpage>. doi:<pub-id pub-id-type="doi">10.1016/bs.mie.2016.04.012</pub-id></mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2015</year>. <article-title>Semi-automated selection of cryo-EM particles in RELION-1.3</article-title>. <source>J. Struct. Biol.</source> <volume>189</volume>, <fpage>114</fpage>&#x2013;<lpage>122</lpage>. doi:<pub-id pub-id-type="doi">10.1016/jjsb.2014.11.010</pub-id></mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2014</year>. <article-title>Beam-induced motion correction for sub-megadalton cryo-EM particles</article-title>. <source>eLife</source> <volume>3</volume>, <fpage>e03665</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2012a</year>. <article-title>RELION: Implementation of a Bayesian approach to cryo-EM structure determination</article-title>. <source>J. Struct. Biol.</source> <volume>180</volume>, <fpage>519</fpage>&#x2013;<lpage>530</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jsb.2012.09.006</pub-id></mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <year>2012b</year>. <article-title>A Bayesian view on cryo-EM structure determination</article-title>. <source>J. Mol. Biol.</source> <volume>415</volume>, <fpage>406</fpage>&#x2013;<lpage>418</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jmb.2011.11.010</pub-id></mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Scheres</surname>, <given-names>S.H.W.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>S.</given-names></string-name>, <year>2012</year>. <article-title>Prevention of overfitting in cryo-EM structure determination</article-title>. <source>Nat. Methods</source> <volume>9</volume>, <fpage>853</fpage>&#x2013;<lpage>854</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2115</pub-id></mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Short</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Soni</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Madhusudhan</surname>, <given-names>M.S.</given-names></string-name>, <string-name><surname>Shivji</surname>, <given-names>M.K.K.</given-names></string-name>, <string-name><surname>Venkitaraman</surname>, <given-names>A.R.</given-names></string-name>, <year>2016</year>. <article-title>High-resolution structure of the presynaptic RAD51 filament on single-stranded DNA by electron cryo-microscopy</article-title>. <source>Nucleic Acids Res.</source> <volume>44</volume>, <fpage>9017</fpage>&#x2013;<lpage>9030</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkw783</pub-id></mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Sigworth</surname>, <given-names>F.J.</given-names></string-name>, <year>1998</year>. <article-title>A maximum-likelihood approach to single-particle image refinement</article-title>. <source>J Struct Biol</source> <volume>122</volume>, <fpage>328</fpage>&#x2013;<lpage>339</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Stewart</surname>, <given-names>M.</given-names></string-name>, <year>1988</year>. <article-title>Computer image processing of electron micrographs of biological structures with helical symmetry</article-title>. <source>J. Electron Microsc. Tech.</source> <volume>9</volume>, <fpage>325</fpage>&#x2013;<lpage>358</lpage>. doi:<pub-id pub-id-type="doi">10.1002/jemt.1060090404</pub-id></mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Whittaker</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Carragher</surname>, <given-names>B.O.</given-names></string-name>, <string-name><surname>Milligan</surname>, <given-names>R.A.</given-names></string-name>, <year>1995</year>. <article-title>PHOELIX: a package for semi-automated helical reconstruction</article-title>. <source>Ultramicroscopy</source> <volume>58</volume>, <fpage>245</fpage>&#x2013;<lpage>259</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Xu</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>He</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>L.J.</given-names></string-name>, <string-name><surname>Hou</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Cruz</surname>, <given-names>M.J. de la</given-names></string-name>, <string-name><surname>Borkowski</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>Z.J.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>Q.-X.</given-names></string-name>, <year>2015</year>. <article-title>Correction: Structural basis for the prion-like MAVS filaments in antiviral innate immunity</article-title>. <source>eLife</source> <volume>4</volume>, <fpage>e07546</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.07546</pub-id></mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Xu</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>He</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>L.J.</given-names></string-name>, <string-name><surname>Hou</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>de la Cruz</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Borkowski</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>Z.J.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>Q.-X.</given-names></string-name>, <year>2014</year>. <article-title>Structural basis for the prion-like MAVS filaments in antiviral innate immunity</article-title>. <source>eLife</source> <fpage>3</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.01489</pub-id></mixed-citation></ref>
</ref-list>
</back>
</article>