<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/051755</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>UMI-tools: Modelling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Smith</surname>
<given-names>Tom</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Heger</surname>
<given-names>Andreas</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Sudbery</surname>
<given-names>Ian</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Computational Genomics Analysis and Training Programme, MRC Functional Genomics Unit, Department of Physiology, Anatomy and Genetics, University of Oxford</institution>, South Parks Road, Oxford OX1 3PT</aff>
<aff id="a2"><label>2</label><institution>Department of Molecular Biology and Biotechnology, University of Sheffield</institution>, Firth Court, Western Bank, Sheffield, <country>UK</country>, S10 2TN</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2016</year>
</pub-date>
<elocation-id>051755</elocation-id>
<history>
<date date-type="received">
<day>09</day>
<month>5</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>09</day>
<month>5</month>
<year>2016</year>
</date>
</history><permissions><copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions>
<self-uri xlink:href="051755.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Unique Molecular Identifiers (UMIs) are random oligonucleotide barcodes that are increasingly used in high-throughout sequencing experiments. Through a UMI, identical copies arising from distinct molecules can be distinguished from those arising through PCR amplification of the same molecule. However, bioinformatic methods to leverage the information from UMIs have yet to be formalised. In particular, sequencing errors in the UMI sequence are often ignored, or else resolved in an <italic>ad-hoc</italic> manner. We show that errors in the UMI sequence are common and introduce network-based methods to account for these errors when identifying PCR duplicates. Using these methods, we demonstrate improved quantification accuracy both under simulated conditions and real iCLIP and single cell RNA-Seq datasets. Reproducibility between iCLIP replicates and single cell RNA-Seq clustering are both improved using our proposed network-based method, demonstrating the value of properly accounting for errors in UMIs. These methods are implemented in the open source <italic>UMI-tools</italic> software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/CGATOxford/UMI-tools">https://github.com/CGATOxford/UMI-tools</ext-link>).</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>UMI</kwd>
<kwd>Unique Molecular Identifier</kwd>
<kwd>Random Tag</kwd>
<kwd>PCR-duplicates</kwd>
<kwd>iCLIP</kwd>
<kwd>Single Cell RNA-Seq</kwd>
<kwd>Sequencing</kwd>
</kwd-group>
<counts>
<page-count count="32"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Background</title>
<p>High throughput sequencing technologies yield vast numbers of short sequences (reads) from a pool of DNA fragments. Over the last ten years a wide variety of sequencing applications have been developed which estimate the abundance of a particular DNA fragment by the number of reads obtained in a sequencing experiment (read counting) and then compare these abundances across biological conditions. Perhaps the most widely used read counting approach is RNA-Seq, which seeks to compare the number of copies of each transcript in different cell types or conditions. Prior to sequencing, a PCR amplification step is normally performed to ensure sufficient DNA for sequencing. Biases in the PCR amplification step lead to particular sequences becoming overrepresented in the final library (<xref rid="c1" ref-type="bibr">Aird et al. 2011</xref>). In order to prevent this bias propagating to the quantification estimates, it is common to remove reads or read pairs with the same alignment coordinates as they are assumed to arise through PCR amplification of the same molecule (<xref rid="c18" ref-type="bibr">Sims et al. 2014</xref>). This is appropriate where sequencing depth is low and thus the probability of two independent fragments having the same genomic coordinates are low, as with paired-end whole genome DNA-seq from a large genome. However, the probability of generating independent fragments mapping to the same genomic coordinates increases as the distribution of the alignment coordinates deviates from a random sampling across the genome and/or the sequencing depth increases. For example, in RNA-Seq, highly expressed transcripts are more likely to generate multiple fragments with exactly the same genomic coordinates. The problem of PCR duplicates is more acute when greater numbers of PCR cycles are required to increase the library concentration, as in single cell RNA-Seq, or when the alignment coordinates are limited to a few distinct loci, as in individual-nucleotide resolution Cross-Linking and ImmunoPrecipitation (iCLIP). To resolve this issue, unique molecular identifiers (UMIs) are increasingly employed to confidently identify PCR duplicates (<xref rid="c9" ref-type="bibr">Kivioja et al. 2012</xref>; <xref rid="c7" ref-type="bibr">Islam et al. 2014</xref>). By incorporating a short random sequence into the same location in each fragment during library preparation, but prior to PCR amplification, it is possible to accurately identify true PCR duplicates as they have both identical alignment coordinates and identical UMI sequences (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). In addition to their use in single cell RNA-Seq and iCLIP (<xref rid="c11" ref-type="bibr">K&#x00F6;nig et al. 2010</xref>), UMIs may be applied to almost any sequencing method where confident identification of PCR duplicates by alignment coordinates alone is not possible and/or an accurate quantification is required, including ChIP-exo (<xref rid="c6" ref-type="bibr">He et al. 2015</xref>), DNA-Seq karyotyping (<xref rid="c8" ref-type="bibr">Karlsson et al. 2015</xref>) and antibody repertoire sequencing (<xref rid="c21" ref-type="bibr">Vollmers et al. 2013</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption>
<title>Modelling errors in UMIs</title>
<p><bold>A</bold>. Schematic representation of how UMIs are used to count unique molecules. Fragmented DNA is labelled with a random UMI sequence (short oligonucleotide; represented as coloured blocks). Following PCR amplification, sequencing and bioinformatics steps, the sequence read alignment coordinates and UMI sequences are used to identify sequence reads originating from the same initial DNA fragment (PCR duplicates) and so count the unique molecules. <bold>B</bold>. Average edit distances between UMIs with the same alignment coordinates. Genomic positions with a single UMI are not shown. Null &#x003D; Null expectation from random sampling of UMIs. <bold>C</bold>. Correlation between duplication rate and enrichment of positions with an average edit distance of 1 for iCLIP data. <bold>D</bold>. Topologies of networks formed by joining reads with the same genomic coordinates and UMIs a single edit distance apart. Single hub &#x003D; One node connected to all other nodes. Complex &#x003D; No node connected to all other nodes. <bold>E</bold>. Methods for estimating unique molecules from UMI sequences and counts at a single locus. Where the method uses the UMI counts, these are shown. Red bases are inferred to be sequencing errors, blue bases inferred to be PCR errors. The inferred number of unique molecules for each method is shown in parentheses.</p></caption>
<graphic xlink:href="051755_fig1.tif"/>
</fig>
<p>Accurate quantification with UMIs is predicated on a one-to-one relationship between the number of unique UMI barcodes at a given genomic locus and the number of unique fragments which have been sequenced. However, errors within the UMI sequence, which may originate either from errors in base calling during sequencing, or polymerase replication errors during PCR, create additional artefactual UMIs. Herein, we will refer to these errors as UMI errors. The issue of UMI errors has been considered in previous analyses (<xref rid="c14" ref-type="bibr">Macosko et al. 2015</xref>; <xref rid="c3" ref-type="bibr">Bose et al. 2015</xref>; <xref rid="c23" ref-type="bibr">Yaari &#x0026; Kleinstein 2015</xref>; <xref rid="c7" ref-type="bibr">Islam et al. 2014</xref>), however their impact on quantification accuracy has not previously been demonstrated and there is no consistency in the approach taken to resolve these errors. For example, <xref rid="c7" ref-type="bibr">Islam <italic>et al</italic> (2014)</xref> removed all UMIs where the counts were below 1 &#x0025; of the mean counts of all other non-zero UMIs at the genomic locus, whilst <xref rid="c3" ref-type="bibr">Bose <italic>et al</italic> (2015)</xref> merged together all UMIs within a hamming distance of two or less. We therefore set out to demonstrate the need to account for UMI errors, to compare different methods for resolving UMI errors and to formalise an approach for removing PCR duplicates with UMIs.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>We reasoned that UMI errors create groups of similar UMIs at a given genomic locus. To confirm this, we calculated the average number of bases different (edit distance) between UMIs at a given genomic locus and compared the distribution of average edit distances to a null distribution generated by randomly sampling (see methods). Using iCLIP data (<xref rid="c15" ref-type="bibr">M&#x00FC;ller-McNicoll et al. 2016</xref>), we confirmed that the UMIs are more similar to one another than expected according to the null, strongly suggesting PCR or sequencing errors are generating artefactual UMIs (see methods; <xref ref-type="fig" rid="fig1">Figure 1b</xref>, see <xref ref-type="fig" rid="figS1">Figure S1</xref> for other datasets). Furthermore, the enrichment of low edit distances is well correlated with the degree of PCR duplication (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). We then constructed networks between UMIs at the same genomic locus where nodes represent UMIs and edges connect UMI separated by a single nucleotide difference. Whilst most of the networks contained just a single node, we observed that 3&#x0025; to 36&#x0025; of networks contained two or more nodes, of which 4&#x0025; to 20&#x0025; did not contain a single central node, and thus could not be naively resolved (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). This indicates that the majority of networks are likely to originate from a single unique molecule prior to PCR amplification, but a minority of networks may originate from a combination of errors during PCR and sequencing or may originate from multiple unique molecules, which by chance have similar UMIs.</p>
<sec id="s2a">
<title>Methods to identify unique molecules</title>
<p>Many previous studies assume each UMI at a given genomic locus represents a different unique molecule (<xref rid="c4" ref-type="bibr">Collins et al. 2015</xref>; <xref rid="c17" ref-type="bibr">Shiroguchi et al. 2012</xref>; <xref rid="c19" ref-type="bibr">Soumillon et al. 2014</xref>). We refer to this method as &#x201C;<bold>unique</bold>&#x201D;. <xref rid="c7" ref-type="bibr">Islam <italic>et al</italic> (2014)</xref> previously identified the issue of sequencing errors and proposed removing UMIs whose counts fall below a threshold of 1&#x0025; of the mean of all non-zero UMIs at the locus, a method we refer to as &#x201C;<bold>percentile</bold>&#x201D;.</p>
<p>We have developed three methods to identify the number of unique molecules at a given locus by resolving UMI networks formed by linking UMIs separated by a single edit distance (<xref ref-type="fig" rid="fig1">Figure 1e</xref>). In all cases, the aim is to reduce the network down to a representative UMI(s) that accounts for the network; the exact sequence of the original UMI(s) is not important for the purposes of quantification. The simplest method we examined was to merge all UMIs within the network, retaining only the UMI with the highest counts. For this method, the number of networks formed at a given locus is equivalent to the estimated number of unique molecules. This is similar to the method employed by <xref rid="c3" ref-type="bibr">Bose et al (2015)</xref> where UMIs with an edit distance of 2 or less were considered to originate from an identical molecule. We refer to this method as &#x201C;<bold>cluster</bold>&#x201D;. This method is expected to underestimate the number of unique molecules, especially for complex networks. We therefore developed the &#x201C;<bold>adjacency</bold>&#x201D; method which attempts to correctly resolve a complex network by using the node counts. The most abundant node and all nodes connected to it are removed from the network. If this does not account for all the nodes in the network, the next most abundant node and its neighbours are also removed. This is repeated until all nodes in the network are accounted for. In the method, the total number of steps to resolve the network(s) formed at a given locus is equivalent to the number of estimated unique molecules. This method allows a complex network to originate from more than one UMI, although UMIs with an edit distance of two will always be removed in separate steps. The excess of UMIs pairs with an edit distance of two observed in the iCLIP datasets indicate that some of these UMIs are artefactual. Reasoning that counts for UMIs generated by a single sequencing error should be higher than those generated by two errors and UMIs resulting from errors during the PCR amplification stage should have higher counts than UMIs resulting from sequencing errors, we developed a final method, &#x201C;<bold>directional adjacency</bold>. We generated directional adjacency networks from the UMIs at a single locus, in which directional edges connect nodes only when n<sub>a</sub> &#x2265; 2n<sub>b</sub> - 1, where n<sub>a</sub> and n<sub>b</sub> are the counts of node a and node b. The entire directional network is then considered to have originated from the node with the highest counts. This method allows UMIs separated by edit distances greater than one to be merged so long as the intermediate UMI is also observed with each sequential base change from the most abundant UMI the counts decrease. For this method, the number of directional networks formed is equivalent to the estimated number of unique molecules.</p>
</sec>
<sec id="s2b">
<title>Comparing methods with simulated data</title>
<p>To compare the accuracy of the proposed methods we simulated the process of UMI amplification and sequencing and varied the simulation parameters (see methods). As the number of initial UMIs are increased, all methods show worse accuracy, with the decrease in accuracy greatest for the unique and percentile methods (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). As expected, the network-based methods tend towards slight underestimation in more extreme conditions, whereas the unique and percentile methods tend towards overestimation. A similar pattern is observed with increased UMI length and sequencing depth, with a linear relationship between the sequencing depth and the degree of overestimation for unique and percentile (<xref ref-type="fig" rid="fig2">Figure 2b, c</xref>). We expect this is because increasing either parameter leads to a linear increase in the total amount of UMI sequence which may harbour errors. In contrast, the estimates from the network-based methods remain relatively stable as the UMI length and sequencing depth are increased. Increases in the number of PCR cycles and sequencing error rates leads to exponential overestimation for unique and percentile (<xref ref-type="fig" rid="fig2">Figure 2d,e</xref>), with a 10-fold overestimation observed with 12 PCR cycles. Again, the network-based methods remain accurate with higher numbers of PCR cycles; the directional adjacency estimates were within 5&#x0025; of the ground truth even with 12 PCR cycles.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption>
<title>Comparison of methods with simulated data</title>
<p>In each panel, all but one of the simulation parameters are held constant, with the remaining parameter varied as shown on the x-axis. <bold>A</bold>. Initial UMIs. <bold>B</bold>. UMI length. <bold>C</bold>. Library sequencing depth. <bold>D</bold>. PCR cycles. <bold>E</bold>. Sequencing error rate. Right plot shows the difference between the ground truth and estimated counts. Ground truth &#x003D; 10 UMIs except in <bold>A</bold>, where ground truth &#x003D; Initial UMIs as indicated on x-axis. Left plot shows the Coefficient of Variation (standard deviation / mean). The dashed red line represents the value used for this parameter in all other simulations. The dashed grey line represents perfect accuracy.</p></caption>
<graphic xlink:href="051755_fig2.tif"/>
</fig>
<p>We also compared the variability in the estimates by computing the Coefficient of Variation (CV; standard deviation/mean) across the 10,000 simulations for each set of parameters. Using this, we observed that, although the average estimates of adjacency and directional adjacency are very similar, directional adjacency often leads to less variable estimates. For example, with a sequencing depth of 40&#x0025;, the average estimate from the two methods was identical, however, the adjacency CV was 20&#x0025; higher (0.055 vs. 0.046)</p>
<p>We observed little or no difference between percentile and unique under the conditions tested. Increasing the sequencing depth to 50&#x0025; and the number of PCR cycles to &#x003E;12, we were able to see a slight improvement in accuracy for percentile relative to unique (<xref ref-type="fig" rid="figS2">Figure S2c</xref>), however, the gains were marginal compared to the difference with directional adjacency.</p>
<p>In summary, under simulation conditions, the directional adjacency methods outperforms all other methods, while adjacency and cluster performs equally well under simulation conditions that are expected to reflect a well-designed experiment with a reasonable number of PCR cycles.</p>
</sec>
<sec id="s2c">
<title>Implementation</title>
<p>To implement our methods within the framework of removing PCR duplicates from BAM alignment files, we developed UMI-tools, with two commands, <italic>extract</italic> and <italic>dedup. extract</italic> takes the UMI from the read sequence contained in a fastq read sequence and appends it to the read identifier so it is retained in the downstream alignment. <italic>dedup</italic> takes an alignment BAM file, identifies reads with the same genomic coordinates as potential PCR duplicates, and removes PCR duplicates using the UMI sequence according to the method chosen. <italic>extract</italic> expects the UMIs to be contained at the same location in each read. Where this is not the case, e.g with sequencing techniques such as inDrop-Seq (<xref rid="c10" ref-type="bibr">Klein et al. 2015</xref>), the user will need to extract the UMI sequence from the read sequence and append it to the read identifier. Time requirements for running <italic>dedup</italic> depend on number of input reads, length of UMI and level of duplication. Memory requirements depend on the number of output reads. On a desktop with a Xeon E3-1246 CPU, it takes &#x02DC;220 seconds and &#x02DC;100Mb RAM to process a 32 million read single-end input file with 5bp UMIs to &#x02DC;700,000 unique alignments. Inputs with longer UMIs may take significantly longer.</p>
</sec>
<sec id="s2d">
<title>Comparing methods with iCLIP data</title>
<p>We next sought to examine the effect of these methods on real data, starting with the previously mentioned iCLIP data, which includes 3-6 replicates for 9 proteins (<xref rid="c15" ref-type="bibr">M&#x00FC;ller-McNicoll et al. 2016</xref>). In samples from replicate 1 of that experiment, the distribution of the average edit distance between UMIs present at each genomic locus showed enrichment for single edit distance relative to a null distribution from random sampling (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). For all samples, application of the directional adjacency method resulted in an edit-distance distribution resembling the null, whereas using the percentile method made little or no difference. The same was also true of other replicates of this dataset or other datasets (<xref ref-type="fig" rid="figS2">Figure S2</xref>). In some cases a residual enrichment of positions with an average edit distance of 2 was observed, but this was also reduced in most cases.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption>
<title>UMI-Tools improves reproducibility between iCLIP replicates</title>
<p><bold>A</bold>. Average edit distances between UMIs with the same alignment coordinates. Genomic positions with a single UMI are not shown. Null &#x003D; Null expectation from random sampling of UMIs. Only the first replicate of the dataset is shown for each pull down <bold>B</bold>. iCLIP reproducibility as represented by the percentage of positions with &#x003E;2 tags also cross-linked in at least one of 2 other replicates. <bold>C</bold>. Spearman&#x2019;s rank correlation between the numbers of significant tags in each exon</p></caption>
<graphic xlink:href="051755_fig3.tif"/>
</fig>
<p>We reasoned that if the tags eliminated were artefactual, while bases that genuinely had multiple cross-links remained intact, remaining bases would be more likely to be cross-linked in other replicates of the same pull-down. To test this we turned to a previously defined measure of iCLIP reproducibility (<xref rid="c11" ref-type="bibr">K&#x00F6;nig et al. 2010</xref>). Briefly, we identified in each sample the bases with 2 or more tags mapping at that positions and asked what percentage had a tag present in one or more other replicates for that pull-down. We limited the analysis to the first three replicates for each protein. In each case, bases with 2 or more tags after de-duplication with the directional adjacency method were more reproducible than those identified after de-duplication with the unique method (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), with the difference being very large in some cases (e.g. 21&#x0025; vs 59&#x0025; of bases reproducible for SRSF7 replicate 1). In contrast, the percentile method was little different from unique (<xref ref-type="fig" rid="figS3">Figure S3</xref>).</p>
<p>To quantify the effect that this might have on downstream analyses, we repeated one of the analyses of the data conducted by the original authors. In order to measure reproducibility of their data, the authors measured the spearman&#x2019;s rank correlation between the numbers of significant tags in each exon across the genome. We repeated this calculation with data processed using either the unique or directional adjacency method, and compared the average spearman&#x2019;s correlation between each sample and other replicates of the same pull down. In all cases we see an improvement in the correlation between replicates of the same pull down when data are processed using the directional adjacency method instead of the unique method (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). As expected, the degree of improvement for a particular sample was correlated with the enrichment of positions with an average edit distance of 1 (<xref ref-type="fig" rid="figS3">Figure S3</xref>; R<sup>2</sup>=0.4). Thus our method substantially improves the reproducibility of replicates in this iCLIP experiment.</p>
</sec>
<sec id="s2e">
<title>Comparing methods with Single Cell RNA Seq data</title>
<p>To further demonstrate the utility of our network-based method, we applied it to two differentiation single cell RNA-Seq data sets: the first reported use of single cell RNA barcoding sequencing (<xref rid="c19" ref-type="bibr">Soumillon et al. 2014</xref>), referred to here as SCRB-Seq, and a recently reported single cell RNA-Seq utilising droplet-barcoding (<xref rid="c10" ref-type="bibr">Klein et al. 2015</xref>), referred to here as inDrop-Seq. As before, network-based methods show a marked improvement in the distribution of edit distances over the percentile method and the unique method (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). Improvements are generally less pronounced than observed with the iCLIP data, likely due to a lower maximum read depth.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption>
<title>Single Cell RNA-Seq</title>
<p><bold>A</bold>. Average edit distances between UMIs with the same alignment coordinates following removal of PCR duplicates using the methods indicated on the x-axis. Genomic positions with a single UMI are not shown. Null: Null expectation from random sampling of UMIs. <bold>B &#x0026; C</bold>.Hierachical clustering based on the gene expression estimates obtained using unique and directional adjacency. Colour bars represent differentiation stage. <bold>B</bold>. SCRB-Seq. <bold>C</bold>. inDrop-DSeq. Red arrow indicates mES Cells clustering with Day 4 cells.</p></caption>
<graphic xlink:href="051755_fig4.tif"/>
</fig>
<p>We applied hierarchical clustering to the SCRB-Seq gene expression data using the unique method and observed the Day 0 and Day 14 cells separately relatively well (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). However, 7 cells clustered with cells of the wrong time point, reflecting either a failure to commit to differentiation or miss-classification event due to noise in the expression estimates. With the directional adjacency method this was reduced to 5 cells, suggesting that failure to account for UMI errors can lead to miss-classification in single cell RNA-Seq. Applying hierarchical clustering to the the inDrop-Seq gene expression estimates, we observed that 44/2717(1.6&#x0025;) of cells clustered with cells from another timepoint when using the unique method. Biological variation in the progression of differentiation may explain Day 2, Day4 and Day 7 miss-classification events. However, 19/44 events involved undifferentiated mES cells, suggesting these miss-classification events were the result of low-accuracy quantification estimates (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). With the application of the directional adjacency method, the rate of miss-classification was reduced to 0.9&#x0025; and, strikingly, all the mES cells were correctly classified. These results indicate that application of the directional adjacency method improves the quantification estimates and can improve classification by hierarchical clustering.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>UMIs can be utilised across a broad range of sequencing techniques, however bioinformatic methods to leverage the information from UMIs have yet to be standardised. In particular, others have noted the problem of UMI errors, but the solutions applied are varied (<xref rid="c3" ref-type="bibr">Bose et al. 2015</xref>; <xref rid="c7" ref-type="bibr">Islam et al. 2014</xref>). The adjacency and directional-adjacency methods we set out here are, to our knowledge, novel approaches to remove PCR duplicates when using UMIs. Comparing these methods to previous methods with simulated data, we observed that our methods are superior at estimating the true number of unique molecules. Of the three network-based methods, directional adjacency was the most robust over the simulation conditions and should be preferred. We note that the performance of all network-based methods will decrease as the number of aligned reads at a genomic locus approaches the number of possible UMIs, however this is an intrinsic issue with UMIs and not one that can be solved computationally post-sequencing. For this reason, we recommend all experiments to use UMIs of at least 8 bp in length and to use longer UMIs for higher sequencing depth experiments. The simulations also indicated that very long UMIs actually decrease the accuracy of quantification when not accounting for UMI errors, since the UMIs are more likely to accumulate errors. For experiments utilising long UMIs, network-based methods therefore show an even greater performance relative to the unique method. The simulations provide an insight into the impact on quantification accuracy and indicate that application of an error-aware method is even more important with higher sequencing depth. This is perhaps most pertinent for single cell RNA-Seq, as cost decreases continue to drive higher sequencing depths.</p>
<p>The analysis of iCLIP and single cell RNA-Seq and data sets established that UMI errors were very likely to be present in all of the data sets tested. We observed an improved distribution of edit distances for all sample when using network-based methods to detect PCR duplicates, although theoretical reasoning and empirical evidence suggests that the extent of the errors depends on the quality of the sequencing base calls and the sequencing depth, as confirmed by the simulations. Modelling UMI errors yielded improvements in single cell RNA-Seq sample clustering, demonstrating the value of considering UMI errors. Since iCLIP aims to identify specific bases bound by RNA binding proteins, datasets have a high level of PCR duplication. The effects of UMI errors are therefore particularly strong, creating the impression of reproducible cross-linking sites within a replicate but not between replicates, for example only 21&#x0025; of positions with two or more tags in SRSF7 replicate 1 had any tags in replicates 2 or 3 when naive de-duplication was used, but this increased to 59&#x0025; when the Directional adjacency method was used (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Application of the network based methods increases the correlation between replicates in all cases, with larger differences in samples where PCR duplication was higher. From the results of the simulation and real data analyses, we recommend the use of an error-aware method to identify PCR duplicates whenever UMIs are used.</p>
<p>We provide our methods within the open-source UMI-tools software (<ext-link ext-link-type="uri" xlink:href="https://github.com/CGATOxford/UMI-tools">https://github.com/CGATOxford/UMI-tools</ext-link>), which can easily be integrated into existing pipelines for analysis of sequencing techniques utilising UMIs.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Simulation</title>
<p>To simulate the effects of errors on UMI counts, an initial number of UMIs were generated at random, with a uniform random probability of amplification [0.9-1.0] assigned to each initial UMI. To simulate a PCR cycle, each UMI was selected in turn and duplicated according to its probability of amplification. Polymerase errors were also added randomly at this stage and any resulting new UMI sequences assigned new probabilities of amplification. Following multiple PCR cycles, a random proportion of UMIs were sampled to model the sampling of reads during sequencing (&#x201C;sequencing depth&#x201D;) and sequencing errors were introduced with at a given probability, with all errors (e.g A &#x002D;&#x003E; T) being equally likely. The number of true UMIs within the sampled UMIs was then estimated from the final pool of UMIs using each method. To test the performance of the methods under a variety of simulation parameters, each parameter was varied in turn. The following values are the range of the parameter values tested with the value used for all other simulations in parentheses. Sequencing depth 2-100&#x0025; (10&#x0025;), number of initial UMIs 1-50 (10), UMI length 4-12 (6), DNA polymerase error rate 1 x 10<sup>&#x2212;3</sup> &#x2013; 1 x 10<sup>&#x2212;7</sup> (1 x 10<sup>&#x2212;5</sup>), sequencing error rate 1 x 10<sup>&#x2212;2</sup> &#x2212;1 x 10<sup>&#x2212;5</sup> (1 x 10<sup>&#x2212;2</sup>), number of PCR cycles 1-12 (5), minimum amplification probability 0.5-1 (0.9). The maximum amplification probability was set at 1 with the probability of amplification for an each UMI drawn from a uniform distribution.</p>
</sec>
<sec id="s4b">
<title>Real data</title>
<p>Re-analysis of the iCLIP and Single Cell RNA-Seq data was performed with in-house pipelines following the methods described in the original publication with exceptions as highlighted below. Pipelines are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CGATOxford/UMI-tools_pipelines">https://github.com/CGATOxford/UMI-tools_pipelines</ext-link>.</p>
</sec>
<sec id="s4c">
<title>iCLIP</title>
<p>Raw sequence was obtained from the European Nucleotide Archive (accessions SRP059277 and ERR039854) (<xref rid="c15" ref-type="bibr">M&#x00FC;ller-McNicoll et al. 2016</xref>; <xref rid="c20" ref-type="bibr">Tollervey et al. 2011</xref>). Raw sequences were processed to move the UMI sequences to the read name using &#x2018;umi_tools extract&#x2019;. Sample barcodes were verified and removed, and adaptor sequence removed from the 3&#x2032; end of reads using the reaper tool from the Kraken package (version 15-065) (<xref rid="c5" ref-type="bibr">Davis et al. 2013</xref>) with parameters: &#x2018;-3p-head-to-tail 2-3p-prefix 6/2/1&#x2019;. Reads were mapped to the same genome as the original publication (mm9 for SRSF dataset, hg19 for the TDP43 dataset) using Bowtie version v1.1.2 (<xref rid="c12" ref-type="bibr">Langmead et al. 2009</xref>) with the same parameters as the original publications (-v 2-m 10-a).</p>
<p>Mapped reads were deduplicated using &#x2018;umi_tools dedup&#x2019; using each of the possible methods and edit_distance distribution produced using the &#x2018;&#x002D;&#x002D;output-stats&#x2019; option. For the &#x2018;cluster&#x2019; method only the &#x2018;&#x002D;&#x002D;further-stats&#x2019; option was used to output statistics on the distribution of network topology types.</p>
<p>Significant bases were produced by comparing tag count height at each position compared to randomised profiles (<xref rid="c11" ref-type="bibr">K&#x00F6;nig et al. 2010</xref>), and bases with FDR&#x003C;0.05 retained.</p>
<p>Coverage over exons was calculated by collapsing Ensembl 67 transcripts. Where exons overlapped, they were restricted to their intersection and the number of reads mapped to significant bases counted for each exon. Exons that contained no tags in any sample were removed (<xref rid="c11" ref-type="bibr">K&#x00F6;nig et al. 2010</xref>). Spearman&#x2019;s rho between all pairwise combinations of replicates of pulldowns for the same protein were calculated and averaged for each replicate.</p>
<p>Reproducibility between replicates was calculated as per <xref rid="c11" ref-type="bibr">K&#x00F6;nig et al. 2010</xref>. Bases with a depth greater than 2 were identified in the sample in question, and then the fraction of these bases that had one or more tags in other replicates was calculated.</p>
</sec>
<sec id="s4d">
<title>Single Cell RNA-Seq</title>
<p>For both datasets, raw data was downloaded from Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo">http://www.ncbi.nlm.nih.gov/geo</ext-link>). For The SCRB-Seq data (GSE53638) (<xref rid="c19" ref-type="bibr">Soumillon et al. 2014</xref>), a single Day 0 (SRR1058003) and Day 14 (SRR1058023) sample were obtained. For the inDrop data (GSE65525) (<xref rid="c10" ref-type="bibr">Klein et al. 2015</xref>), the mouse ES cells sample 1 (SRR1784310), mouse ES cells LIF-, 2 days (SRR1784313), mouse ES cells LIF-, 4 days (SRR1784314) and mouse ES cells LIF-, 7 days (SRR1784315) samples were obtained. Fastq files were extracted using SRA toolkit. The sequence read filtering, preparation and alignment differed for the two data sets. In both cases, one of the paired end reads contained adapter barcodes and UMI and the other read pair contained sequence for alignment. In addition, with the inDrop data, the position of the UMI within the read varied depending on the length of the cell barcode. For this reason the UMIs had to be extracted from the reads with bespoke code rather than using umi_tools extract.</p>
<p>For SCRB-Seq samples, the UMI was extracted from read 2 and appended onto the read identifier of read 1 to generate a single-end fastq. Reads were filtered out if any of the following conditions was not met. Phred sequence quality of all cell barcode bases &#x003E;=10 and all UMI bases &#x003E;=30 and cell barcode matched expected cell barcodes. A reference transcriptome was built comprising all human protein-coding genes (Ensembl v75, hg19) and the ERCC spike-ins. Since expression quantification was being performed at the gene level, overlapping transcripts from the same gene were merged so that each gene contained a single transcript covering all exons from all transcripts. Reads were aligned to the reference transcriptome using BWA Aln (<xref rid="c13" ref-type="bibr">Li &#x0026; Durbin 2009</xref>) with the following parameters: <italic>&#x201C;-l 24&#x2013;k 2&#x201D;</italic> to set seed length to 24 bp, and mismatches allowed in the seed to 2.</p>
<p>For inDrop samples, the cell barcode and UMI were extracted from read 1 and read 2 was written out to a single end fastq file with the cell barcode incorporated into the file name and the UMI appended to the read identifier. Only reads containing the adapter sequence (allowing 2 mismatches) were retained. For each sample, only reads containing one of the <italic>n</italic> most abundant cell barcodes were retained, where <italic>n</italic> was the number of cells in a given sample. The resulting single end reads were filtered using trimmomatic v0.32 (<xref rid="c2" ref-type="bibr">Bolger et al. 2014</xref>) with the following options: <italic>&#x201C;LEADING:28 SLIDINGWINDOW:4:20 MINLEN:19&#x201D;</italic> to remove bases with Phred quality scores below 28 from the 5&#x2032; end, scan the reads in 4 bp sliding windows and trim when average quality score falls below 20, and retain all reads at least 19bp in length following trimming. Our alignment procedure is a deviation to the method used by <xref rid="c10" ref-type="bibr">Klein <italic>et al</italic> (2015)</xref> which involved alignment of reads to a reference transcriptome containing all transcripts (e.g not collapsed into one gene model), reporting up to 200 alignments per read, and dealing with multi-mapping alignments in a downstream step. As this method was not compatible with our de-duplication method we took a simpler approach. A reference transcriptome was built comprising all mouse protein-coding genes (Ensembl v78, mm10). Since expression quantification was being performed at the gene level, overlapping transcripts from the same gene were merged so that each gene contained a single transcript covering all exons from all transcripts. Reads were aligned to the reference transcriptome with Bowtie v1.1.2(<xref rid="c12" ref-type="bibr">Langmead et al. 2009</xref>) with the following options: <italic>&#x201C;-n1-l 15-M 1 &#x002D;&#x002D;best &#x002D;&#x002D;strata&#x201D;</italic> to allow one mismatch, set seed length to 15 bp and report only one alignment where multiple &#x201C;best&#x201D; alignments were found. The seed length and mismatch parameters were the same as the <xref rid="c10" ref-type="bibr">Klein <italic>et al</italic> (2015)</xref> alignment method.</p>
<p>Following alignment, de-duplication was performed with UMI-tools dedup with unique, percentile and directional-adjacency used in turn. Both data sets were generated with sequencing methods which generate reads with different alignment coordinates from the same initial DNA fragment (SCRB-Seq, CEL-Seq). De-duplication was therefore performed with the <italic>&#x201C;&#x002D;&#x002D;per-contig&#x201D;</italic> option so that the UMI and the contig (in this case, gene) rather than the exact alignment coordinates were to identify duplicate reads. The &#x201C;&#x002D;&#x002D;stats-output&#x201D; and &#x201C;&#x002D;&#x002D;further-stats&#x201D; options were used to generate summary statistics for the alignment files pre and post de-duplication. Gene expression was quantified by counting the number of remaining reads per gene following de-duplication</p>
</sec>
<sec id="s4e">
<title>Exploratory gene expression analysis</title>
<p>PCA was performed in R (<xref ref-type="bibr" rid="c16">R Core Team 2015</xref>) using the <italic>prcomp</italic> function. Hierarchical clustering was performed in R using the <italic>hclust</italic> function and heatmaps generated using the <italic>heatmap.2</italic> function from the gplots package. Clustering was performed using 1 - spearman&#x2019;s correlation coefficient as the distance measure and &#x201C;ward.D2&#x201D; as the clustering method. Since many genes show very low expression in the SCRB-Seq data, the top 100 most highly expressed genes were selected for clustering and top 2000 genes for PCA.</p>
</sec>
</sec>
<sec id="s5" sec-type="availability">
<title>Data access</title>
<p>UMI-tools is available from pypy (package: umi_tools) and conda (channel: <ext-link ext-link-type="uri" xlink:href="https://conda.anaconda.org/toms,package:umi_tools">https://conda.anaconda.org/toms,package:umi_tools</ext-link>) or github (<ext-link ext-link-type="uri" xlink:href="https://github.com/CGATOxford/UMI-tools">https://github.com/CGATOxford/UMI-tools</ext-link>). Analyses conducted in this manuscript used version 0.0.8 - archived on zenodo as <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/50684">https://zenodo.org/record/50684</ext-link>. Analyses were performed using automated python pipelines. iCLIP specific analyses were completed using the iCLIPlib python library (manuscript in preparation). Figures were created by python pipelines or in Jupyter notebooks using the ggplot2 package (<xref rid="c22" ref-type="bibr">Wickham 2009</xref>) unless otherwise noted. All pipelines, notebooks and other code, along with configuration files used are available from the github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/CGATOxford/UMI-tools_pipelines">https://github.com/CGATOxford/UMI-tools_pipelines</ext-link>), archived on zenodo as <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/51199">https://zenodo.org/record/51199</ext-link>.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors. T.S and A.H are supported by an MRC programme grant [G1000902]. We thank David Sims and members of CGAT for reviewing the manuscript. We thank the Github community for helping us to improve the UMI-Tools codebase.</p>
</ack>
<sec>
<title>Author contribution:</title>
<p>T.S and I.S. conceived the study. I.S. implemented the first iteration of UMI-Tools. T.S. implemented further methods and improved the code base. A.H implemented performance improvements to UMI-Tools and advised on software development. T.S. performed the simulation and single cell RNA-Seq analyses. I.S. performed the iCLIP analysis. T.S and I.S wrote the original draft of the manuscript. T.S, I.S and A.H edited the final draft of the manuscript. I.S. supervised the study.</p>
</sec>
<sec>
<title>Disclosure Declaration</title>
<p>The authors declare that we have no competing interests</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Aird</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal>, <year>2011</year>. <article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome biology</source>, <volume>12</volume>(<issue>2</issue>), p.<fpage>R18</fpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bolger</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Lohse</surname>, <given-names>M.</given-names></string-name> &#x0026; <string-name><surname>Usadel</surname>, <given-names>B.</given-names></string-name>, <year>2014</year>. <article-title>Trimmomatic: A flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>(<issue>15</issue>), pp.<fpage>2114</fpage>&#x2013;<lpage>2120</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bose</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <article-title>Scalable microfluidics for single cell RNA printing and sequencing</article-title>. <source>Genome biology</source>, <volume>16</volume>(<issue>1</issue>), p.<fpage>120</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Collins</surname>, <given-names>J.E.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <article-title>High-throughput and quantitative genome-wide messenger RNA sequencing for molecular phenotyping</article-title>. <source>BMC genomics</source>, <volume>16</volume>, p.<fpage>578</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Davis</surname>, <given-names>M.P.A.</given-names></string-name> <etal>et al.</etal>, <year>2013</year>. <article-title>Kraken: A set of tools for quality control and analysis of high-throughput sequence data</article-title>. <source>Methods</source>, <volume>63</volume>(<issue>1</issue>), pp.<fpage>41</fpage>&#x2013;<lpage>49</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>He</surname>, <given-names>Q.</given-names></string-name>, <string-name><surname>Johnston</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Zeitlinger</surname>, <given-names>J.</given-names></string-name>, <year>2015</year>. <article-title>ChIP-nexus enables improved detection of in vivo transcription factor binding footprints</article-title>. <source>Nature Biotechnology</source>, <volume>33</volume>(<issue>4</issue>), pp.<fpage>395</fpage>&#x2013;<lpage>401</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Islam</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal>, <year>2014</year>. <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nature methods</source>, <volume>11</volume>(<issue>2</issue>), pp.<fpage>163</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Karlsson</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <article-title>Amplification-free sequencing of cell-free DNA for prenatal non-invasive diagnosis of chromosomal aberrations</article-title>. <source>Genomics</source>, <volume>105</volume>(<issue>3</issue>), pp.<fpage>150</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Kivioja</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal>, <year>2012</year>. <article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nature methods</source>, <volume>9</volume>(<issue>1</issue>), pp.<fpage>72</fpage>&#x2013;<lpage>4</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Klein</surname>, <given-names>A.M.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <article-title>Droplet Barcoding for Single-Cell Transcriptomics Applied to Embryonic Stem Cells</article-title>. <source>Cell</source>, <volume>161</volume>(<issue>5</issue>), pp.<fpage>1187</fpage>&#x2013;<lpage>1201</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>K&#x00F6;nig</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal>, <year>2010</year>. <article-title>iCLIP reveals the function of hnRNP particles in splicing at individual nucleotide resolution</article-title>. <source>Nature Structural &#x0026; Molecular Biology</source>, <volume>17</volume>(<issue>7</issue>), pp.<fpage>909</fpage>&#x2013;<lpage>915</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Langmead</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal>, <year>2009</year>. <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome biology</source>, <volume>10</volume>(<issue>3</issue>), p.<fpage>R25</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>H.</given-names></string-name> &#x0026; <string-name><surname>Durbin</surname>, <given-names>R.</given-names></string-name>, <year>2009</year>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>(<issue>14</issue>), pp.<fpage>1754</fpage>&#x2013;<lpage>1760</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Macosko</surname>, <given-names>E.Z.</given-names></string-name> <etal>et al.</etal>, <year>2015</year>. <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>, <volume>161</volume>(<issue>5</issue>), pp.<fpage>1202</fpage>&#x2013;<lpage>1214</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>M&#x00FC;ller-McNicoll</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal>, <year>2016</year>. <source>SR proteins are NXF1 adaptors that link alternative RNA processing to mRNA export</source>., pp.<fpage>553</fpage>&#x2013;<lpage>566</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><collab>R Core Team</collab>, <year>2015</year>. <source>R: A Language and Environment for Statistical Computing</source>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="confproc"><string-name><surname>Shiroguchi</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal>, <year>2012</year>. <article-title>Digital RNA sequencing minimizes sequence-dependent bias and amplification noise with optimized single-molecule barcodes</article-title>. <conf-name>Proceedings of the National Academy of Sciences of the United States of America</conf-name>, <volume>109</volume>(<issue>4</issue>), pp.<fpage>1347</fpage>&#x2013;<lpage>52</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Sims</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal>, <year>2014</year>. <article-title>Sequencing depth and coverage: key considerations in genomic analyses</article-title>. <source>Nature Reviews Genetics</source>, <volume>15</volume>(<issue>2</issue>), pp.<fpage>121</fpage>&#x2013;<lpage>32</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Soumillon</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Cacchiarelli</surname>, <given-names>D.</given-names></string-name> &#x0026; <string-name><surname>Semrau</surname>, <given-names>S.</given-names></string-name>, <year>2014</year>. <article-title>Characterization of directed differentiation by high-throughput single-cell RNA-Seq</article-title>. <source>BioRxiv</source>: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/003236">http://dx.doi.org/10.1101/003236</ext-link></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Tollervey</surname>, <given-names>J.R.</given-names></string-name> <etal>et al.</etal>, <year>2011</year>. <article-title>Characterising the RNA targets and position-dependent splicing regulation by TDP-43; implications for neurodegenerative diseases</article-title>. <source>Nature Neuroscience</source>, <volume>14</volume>(<issue>4</issue>), pp.<fpage>452</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="confproc"><string-name><surname>Vollmers</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal>, <year>2013</year>. <article-title>Genetic measurement of memory B-cell recall using antibody repertoire sequencing</article-title>. <conf-name>Proceedings of the National Academy of Sciences of the United States of America</conf-name>, <volume>110</volume>(<issue>33</issue>), pp.<fpage>13463</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name>, <year>2009</year>. <article-title>ggplot2: Elegant Graphics for Data Analysiss</article-title>, <source>Springer-Verlag, New York</source>. Available at: <ext-link ext-link-type="uri" xlink:href="http://ggplot2.org">http://ggplot2.org</ext-link>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Yaari</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Kleinstein</surname>, <given-names>S.H.</given-names></string-name>, <year>2015</year>. <article-title>Practical guidelines for B-cell receptor repertoire sequencing analysis</article-title>. <source>Genome medicine</source>, <volume>7</volume>(<issue>1</issue>), p.<fpage>121</fpage>.</mixed-citation></ref>
</ref-list>
<sec>
<title>Supplementary Figures</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Figure 1.</label>
<caption>
<title>Edit distances for all iCLIP replicates</title>
<p>Average edit distances between UMIs with the same alignment coordinates. Genomic positions with a single UMI are not shown. Null &#x003D; Null expectation from random sampling of UMIs. <bold>A</bold> Further replicates from the SRSF dataset showing that effects vary between replicates, but are not specific the replicate 1. <bold>B</bold> Results from a TDP43 iCLIP dataset showing effects are not limited to a single experiment (<xref rid="c20" ref-type="bibr">Tollervey et al., 2011</xref>)</p></caption>
<graphic xlink:href="051755_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Figure 2.</label>
<caption>
<title>Comparison of methods with simulated data</title>
<p>In each panel, all but one of the simulation parameters are held constant, with the remaining parameter varied as shown on the x-axis. Left plot shows the Coefficient of Variation (standard deviation / mean), Right plot shows the difference between ground truth (10 molecules) and estimated counts. The dashed red line represents the value used for this parameter in all other simulations. The dashed grey line represents perfect accuracy. In the bottom panel, the sequencing depth has been increased to 50&#x0025; to demonstrate the slightly increased accuracy for percentile when sequencing depth and number of PCR cycles are both high.</p></caption>
<graphic xlink:href="051755_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Figure 3.</label>
<caption>
<title>UMI-Tools improves reproducibility between iCLIP replicates</title>
<p><bold>A</bold>. iCLIP reproducibility as represented by the percentage of positions with &#x003E;2 tags also cross-linked in at least one of 2 other replicates. No improvement is observed with <bold>B</bold>. Correlation between enrichment for sites with an average edit distance of 1 following unique de-deduplication and the improvement in Spearman&#x2019;s <bold>&#x03C1;</bold> following directional adjacency de-duplication.</p></caption>
<graphic xlink:href="051755_figS3.tif"/>
</fig>
</sec>
</back>
</article>