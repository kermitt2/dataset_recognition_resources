<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/274357</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Ecology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Quantifying cell densities and biovolumes of phytoplankton communities and functional groups using scanning flow cytometry, machine learning and unsupervised clustering</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Thomas</surname>
<given-names>Mridul K.</given-names>
</name>
<xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor1"><sup>&#x002A;</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>&#x0023;a</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Fontana</surname>
<given-names>Simone</given-names>
</name>
<xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff3"><sup>&#x0023;b</sup></xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Reyes</surname>
<given-names>Marta</given-names>
</name>
<xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pomati</surname>
<given-names>Francesco</given-names>
</name>
<xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
</contrib>
<aff id="aff1"><label>1</label><institution>Department of Aquatic Ecology, Eawag: Swiss Federal Institute of Aquatic Science and Technology</institution>, D&#x00FC;bendorf, <country>Switzerland</country></aff>
<aff id="aff2"><label>&#x0023;a</label><institution>Centre for Ocean Life, DTU Aqua, Technical University of Denmark</institution>, Lyngby, <country>Denmark</country></aff>
<aff id="aff3"><label>&#x0023;b</label><institution>Biodiversity and Conservation Biology, Swiss Federal Research Institute WSL</institution>, Birmensdorf, <country>Switzerland</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1">Corresponding author. Email: <email>mrit@dtu.dk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>274357</elocation-id>
<history>
<date date-type="received">
<day>02</day>
<month>3</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>02</day>
<month>3</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>02</day>
<month>3</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="274357.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Scanning flow cytometry (SFCM) is characterized by the measurement of time-resolved pulses of fluorescence and scattering, enabling the high-throughput quantification of phytoplankton morphology and pigmentation. Quantifying variation at the single cell and colony level improves our ability to understand dynamics in natural communities. Automated high-frequency monitoring of these communities is presently limited by the absence of repeatable, rapid protocols to analyse SFCM datasets, where images of individual particles are not available. Here we demonstrate a repeatable, semi-automated method to (1) rapidly clean SFCM data from a phytoplankton community by removing signals that do not belong to live phytoplankton cells, (2) classify individual cells into trait clusters that correspond to functional groups, and (3) quantify the biovolumes of individual cells, the total biovolumes of the whole community and the total biovolumes of the major functional groups. Our method involves the development of training datasets using lab cultures, the use of an unsupervised clustering algorithm to identify trait clusters, and machine learning tools (random forests) to (1) evaluate variable importance, (2) classify data points, and (3) estimate biovolumes of individual cells. We provide example datasets and code for our analytical approach that can be adapted for analysis of datasets from other flow cytometers or scanning flow cytometers.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Key words</title>
<kwd>traits</kwd>
<kwd>phytoplankton</kwd>
<kwd>cell size</kwd>
<kwd>flow cytometry</kwd>
<kwd>automated monitoring</kwd>
</kwd-group>
<counts>
<page-count count="38"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Flow cytometry (FCM) has enabled the monitoring of natural microbial communities by capturing point estimates of cellular characteristics and images, respectively ([<xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c7">7</xref>]. Developed more recently, scanning flow cytometry (SFCM) records time-resolved pulses of fluorescence and scattering for every cell [<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c8">8</xref>&#x2013;<xref ref-type="bibr" rid="c10">10</xref>]. The fluorescence and scattering pulses are summarized using parameters that characterise changes in morphology and pigmentation over the length of a cell. This vast amount of individual-level information can be used to quantify the distributions of important cellular <italic>traits</italic> within communities. High-throughput quantification of traits governing organism-environment interactions [<xref ref-type="bibr" rid="c11">11</xref>] would increase our ability to understand ecological and evolutionary changes in microbial communities. However, the utility of traditional FCM and scanning flow cytometry (SFCM) in monitoring natural communities has been limited by a lack of protocols that allow us to automate 1) cleaning of SFCM data by removing signals that do not belong to living cells, 2) classifying individual cells into functional groups, and 3) quantifying the biovolumes of individual cells, and the total biovolumes of the whole community and major functional groups (we follow convention by referring to cyanobacteria, diatoms, etc. as &#x2018;functional groups&#x2019;, but these groups are defined taxonomically). The first two goals are a challenge in FCM and SFCM analyses because validating results from an analysis is difficult in the absence of images (which are available only in imaging flow cytometers, IFCM, for which high-throughput analytical methods are available e.g. [<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c12">12</xref>]). This paper demonstrates a protocol to achieve these three goals in FCM or SFCM datasets.</p>
<p>Cleaning datasets (i.e. remove signals that are not from live cells) and identifying functional groups in FCM has traditionally been done manually. This has involved visually identifying clusters of points with similar trait values using small numbers of bivariate plots. These manually-identified clusters are used to separate measurements of live cells from other signals (&#x2018;gating&#x2019;), and to identify distinct cell types for further analyses. However, a manual sample-by-sample approach is not practical when large numbers of samples are measured, such as in high-frequency monitoring efforts or large experiments. Additionally, the large number of variables of unknown importance captured by SFCM makes the choice of variables for plotting difficult, and the results sensitive to these choices. Previous efforts to avoid these problem in FCM and SFCM have involved (i) focusing on very small numbers of variables, (ii) the use of linear thresholds for separation of signal types, which neglects the possibility that thresholds may be nonlinear, in single or multiple dimensions, or more recently (iii) the use of a variety of clustering algorithms to identify groups of points that are similar to each other in multiple dimensions [<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c13">13</xref>&#x2013;<xref ref-type="bibr" rid="c17">17</xref>]. The use of clustering algorithms reduces subjectivity associated with cluster identification and makes analyses repeatable. We have adapted this approach to scale easily across large SFCM datasets using limited computing resources.</p>
<p>Estimating the biovolume of cells and colonies is an important goal in the phytoplankton, which are responsible for nearly half of global primary production [<xref ref-type="bibr" rid="c18">18</xref>]. Cell biovolume is also a major determinant of how individuals interact with their abiotic and biotic environment. Called a &#x2018;master trait&#x2019;, biovolume influences nutrient-uptake rates, nutrient quotas, predator avoidance, and low-light performance [<xref ref-type="bibr" rid="c19">19</xref>&#x2013;<xref ref-type="bibr" rid="c21">21</xref>]. Additionally, distributions of biovolume can - in combination with cell density (typically estimated by flow cytometers) - provide us with accurate estimates of total phytoplankton community biovolume (highly correlated with biomass), the most important algal parameter characterizing water quality. Despite its importance, quantifying biovolumes using FCM and SFCM remains a challenge because of the complex shapes that phytoplankton take [<xref ref-type="bibr" rid="c22">22</xref>]. Present approaches to estimating biovolume involve the use of a single scattering channel and are based on calibrated relationships with beads [<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c23">23</xref>]; they therefore assume that phytoplankton cells possess similar scattering properties to these beads. However, scattering properties vary between phytoplankton taxa based on differences in cell wall, vacuoles, and internal cellular structure, necessitating the development of better methods for biovolume estimation.</p>
<p>Identifying the functional groups that phytoplankton belong to is fundamental to understanding ecological patterns because members of these groups share similarities in biochemistry, edibility, toxicity and roles in biogeochemical cycles [<xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c24">24</xref>]. Although we follow convention by referring to &#x2018;functional groups&#x2019;, these groups are defined taxonomically (e.g. cyanobacteria, diatoms, chrysophytes, green algae, etc.), but at different levels in the taxonomic hierarchy (phylum Cyanobacteria as opposed to class Bacillariophyceae). The term &#x2018;functional group&#x2019; retains its usefulness because the groups are paraphyletic: some members of the clades/taxonomic groups are no longer phytoplanktonic (e.g. plants exist within the clade of the green algae). Identification of functional groups by SFCM is possible because groups differ in their autofluorescent photosynthetic pigments [<xref ref-type="bibr" rid="c24">24</xref>], leading to differences in cell absorption and emission profiles [<xref ref-type="bibr" rid="c25">25</xref>].</p>
<p>The protocol that we present here (outlined in <xref ref-type="fig" rid="fig1">Fig. 1</xref>) quantifies the cell densities and biovolumes of a phytoplankton communities and their major constituent functional groups. It relies on three tools: (i) multiple training datasets that we generated, (ii) an unsupervised clustering algorithm (flowPeaks [<xref ref-type="bibr" rid="c26">26</xref>]), and (iii) a machine learning algorithm (random forests [<xref ref-type="bibr" rid="c27">27</xref>]). These tools are used for three distinct roles: (1) identifying important variables for clustering, (2) classifying points into clusters, and (3) estimating cell biovolumes.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1.</label>
<caption>
<p>Flow chart illustrating the method we describe. We have divided this into two parts for clarity: a) Data cleaning, and b) Cell density and biovolume estimation. We use two abbreviations: RF for &#x2018;random forest&#x2019; and FG for &#x2018;functional group&#x2019;. Yellow boxes indicate datasets, purple boxes indicate algorithms, the green box indicates the final product obtained, and white boxes contain other operations, objects or data manipulations.</p>
</caption>
<graphic xlink:href="274357_fig1.tif"/>
</fig>
<p>Our advance consists in coupling these together in a manner that allows for processing and analysis of large FCM and SFCM datasets without the use of specialised computing resources such as high performance computing facilities. Unsupervised clustering algorithms identify groups of points that are similar to each other in multiple dimensions [<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref>]. Here we use one such algorithm (flowPeaks [<xref ref-type="bibr" rid="c26">26</xref>]) that has previously been shown to provide reasonable results when applied to phytoplankton populations [<xref ref-type="bibr" rid="c17">17</xref>]. Random forests are a machine learning tool composed of ensembles of decision trees that can be used to identify features that separate groups in high-dimensional data. Each component decision tree uses a random subset of 66&#x0025; of the dataset, and a randomly selected subset of variables that are assessed for correlation strength at each node. By aggregating predictions from all decision trees, random forests limit the overfitting problems associated with the use of individual decision trees [<xref ref-type="bibr" rid="c27">27</xref>]. No assumptions of linearity are required, with the algorithm capable of identifying curved boundaries in multiple dimensions. Additionally, they can be used to rank the importance of variables by assessing the differences in error rate (or tree node purity [<xref ref-type="bibr" rid="c27">27</xref>]) when individual variables are permuted across all component decision trees. While a number of machine learning approaches could be applied to FCM and SFCM data, random forests have the advantage of being flexible, fast, and robust, negating the need for specialized computing resources.</p>
<p>We rely on training datasets based on lab cultures to (1) identify the traits that are best at distinguishing live cells from other signals, (2) distinguish functional groups from each other, and (3) quantify how all measured SFCM traits relate to cell biovolume measured by microscopy. Briefly, we used the most important variables identified by a random forest (applied to the lab culture training dataset) in combination with the flowPeaks algorithm [<xref ref-type="bibr" rid="c26">26</xref>] to clean SFCM data and to identify functional groups of cells in the cleaned data. The data we used to test this protocol were collected from a natural lake community across several months of automated monitoring. We used two additional random forests trained on clustered data to classify all points from 191 files containing >20 million data points into phytoplankton cells and other particles, and subsequently classify the cells into clusters corresponding to functional groups. We used a fourth random forest trained on our lab culture training dataset to estimate the biovolume of every phytoplankton cell based on all the measured SFCM parameters.</p>
<p>We describe this procedure in detail below and validate it using 191 microscopy measurements corresponding to the same depths and times of the SFCM measurements (<xref ref-type="fig" rid="fig1">Fig. 1</xref>). We include the SFCM dataset we used to evaluate this method on the data repository Zenodo, accessible at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.977772">https://doi.org/10.5281/zenodo.977772</ext-link> [<xref ref-type="bibr" rid="c30">30</xref>]. We also include code for the entire analysis on Github, accessible at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.999747">https://doi.org/10.5281/zenodo.999747</ext-link> [<xref ref-type="bibr" rid="c31">31</xref>], implemented in the R software environment [<xref ref-type="bibr" rid="c32">32</xref>]. Associated microscopy data used in this paper may be found in the supporting information.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Overview of approach</title>
<p>Our approach is shown in flow chart form in <xref ref-type="fig" rid="fig1">Fig. 1</xref>. It involves 10 steps:
<list list-type="order">
<list-item><p>Generation of a training dataset using lab cultures with known species identity, functional group identity, and mean cell biovolume (<xref ref-type="table" rid="tbl1">Table 1</xref>).</p></list-item>
<list-item><p>Identifying the parameters that most accurately distinguish between live cells and other signals (a combination of bacteria, detritus, and electronic noise), using the training dataset.</p></list-item>
<list-item><p>Identifying clusters of similar points in a subset of the field dataset based on the parameters identified in step 2.</p></list-item>
<list-item><p>Classifying points from the complete field dataset into these clusters, and removing all points except for those from live cells (data cleaning).</p></list-item>
<list-item><p>Identifying the parameters that most accurately distinguish between different functional groups, using the training dataset.</p></list-item>
<list-item><p>Identifying clusters of similar points (corresponding to different functional groups) in a subset of the cleaned field dataset based on the parameters identified in step 5.</p></list-item>
<list-item><p>Classifying all cells from the cleaned field dataset into these clusters.</p></list-item>
<list-item><p>Training a machine learning algorithm (a random forest) to estimate the biovolumes of individual cells based on all measured SFCM parameters, using the training dataset.</p></list-item>
<list-item><p>Using the trained random forest from step 8 to estimate the biovolumes of every cell in the cleaned field dataset based on all measured SFCM parameters.</p></list-item>
<list-item><p>Estimating cell density and biovolume of the total phytoplankton community and of the major clusters (corresponding to functional groups), using the assigned clusters for each individual cell (from step 7) as well as their biovolume estimates (from step 9) and cell density estimates.</p></list-item>
</list>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption>
<p>Cultures used in biovolume estimation. Mean biovolume values were estimated by microscopy as part of this study.</p>
</caption>
<graphic xlink:href="274357_tbl1.tif"/>
</table-wrap></p>
</sec>
<sec id="s2b">
<title>Procedures</title>
<sec id="s2b1">
<label>1.</label>
<title>Sampling campaign</title>
<p>Between August 17<sup>th</sup> and October 26<sup>th</sup> 2014, we collected SFCM measurements at 6 depths (1.0, 2.5, 4.0, 5.5, 7.0 and 8.5 m) every 4 hours in Greifensee, a eutrophic lake in Switzerland (47.35&#x00B0;N, 8.68&#x00B0;E), using the automated monitoring station Aquaprobe [<xref ref-type="bibr" rid="c4">4</xref>]. We also collected weekly microscopy samples at every depth within 1 hour of an SFCM measurement, obtaining a set of paired SFCM and microscopy measurements. A small number of SFCM samples were lost, leaving us with 191 paired samples [<xref ref-type="bibr" rid="c30">30</xref>].</p>
<p>Over this time period, we saw environmental changes of approximately 15&#x00B0;C in water temperature, and variation of an order of magnitude in dissolved phosphorus concentration and N:P ratio.</p>
<p>The Office of Waste, Water, Energy and Air (AWEL) of Canton Z&#x00FC;rich provided permission for in situ monitoring.</p>
</sec>
<sec id="s2b2">
<label>2.</label>
<title>Microscopy protocol</title>
<sec id="s2b2a">
<label>2.1.</label>
<title>Microscopy sample collection and counting</title>
<p>Microscopy samples were collected manually using a Niskin bottle. The Niskin bottle collects a vertical column of water 46 cms in length, which we centred at each of the 6 depths sampled by SFCM (therefore, the microscopy samples average over a water sample 46 cms in length as opposed to 1 cm in length as in the case of SFCM). 300 mL of water was fixed using Lugol&#x2019;s solution and stored in a brown glass bottle in the dark till measurement.</p>
<p>Cells were counted using a Uterm&#x00F6;hl counting chamber (3 mL) under 200X and 400X magnification [<xref ref-type="bibr" rid="c33">33</xref>]. 40 fields were counted and identified to a species level in most cases, and to the genus level in the remaining cases. Every sample was measured under both magnifications, with different species counted in each case based on their size.</p>
</sec>
<sec id="s2b2b">
<label>2.2.</label>
<title>Microscopy biovolume estimation</title>
<p>The total biovolume of the whole community and of the individual functional groups was calculated by multiplying the density of individual species by their mean biovolume, and summing appropriately. Mean biovolume values of each species were taken from an existing database of measurements made using standard protocols on individual cells from the same lake, Greifensee (Buergi unpublished). Local environmental conditions were therefore accounted for in these measurements, but intraspecific variation and changes through time were not considered. However, as intraspecific variation is considerably lower than interspecific variation (which can be &#x003E;7 orders of magnitude, [<xref ref-type="bibr" rid="c34">34</xref>]), we believe this is likely to be a small source of error.</p>
</sec>
</sec>
<sec id="s2b3">
<label>3.</label>
<title>SFCM protocol</title>
<sec id="s2b3a">
<label>3.1.</label>
<title>Instrument description</title>
<p>SFCM measurement was performed using the CytoSense (<ext-link ext-link-type="uri" xlink:href="http://www.cytobuoy.com">http://www.cytobuoy.com</ext-link>), which is designed to characterize the scattering and fluorescence of individual particles; here we use it to study phytoplankton cells. The instrument measures particles across a large proportion of the phytoplankton length range, between approximately 2 &#x00B5;m and 1 mm in length. Although this instrument is capable of taking images, it is unable to resolve small cells clearly (approximately &#x003C;10 &#x00B5;m). As these small cells are abundant in natural systems such as freshwater lakes, it necessitated the development of the method we present here.</p>
<p>Particles cross two coherent 15mW solid-state lasers (488 nm and 642 nm). Cells absorb and scatter these wavelengths, and also fluoresce at longer wavelengths determined by their specific pigment composition. Scattering (forward and sideward; the latter is typically referred to as &#x2018;side-scatter&#x2019; in the flow cytometry literature) is measured, as well as fluorescence at each of three channels hereafter referred to as Red (668 &#x2013; 734nm), Orange (601 &#x2013; 667nm) and Yellow (536 &#x2013; 601nm). These channels are listed below, followed by a more detailed description:</p>
<list list-type="simple">
<list-item><p>Red fluorescence Channel Laser 1: 488: 701/33</p></list-item>
<list-item><p>Red fluorescence Channel Laser 2: 642: 701/33</p></list-item>
<list-item><p>Orange fluorescence Channel: 488: 634/33</p></list-item>
<list-item><p>Yellow fluorescence Channel: 488: 569/33</p></list-item>
</list>
<p>Fluorescence in the Yellow and Orange channels is exclusively stimulated by the 488nm laser, while fluorescence in the Red channel is stimulated by both lasers. Therefore, the Red channel is electronically deconvoluted into Red 1 (from the 488nm laser) and Red 2 (a weaker signal from the 642nm laser). These wavelength bands are not highly specific in terms of the pigments they target, but generally target chlorophyll-a (Red 1), phycocyanin (Red 1 and Red 2), phycoerythrin (Orange), and carotenoids and decaying pigments (Yellow).</p>
<p>Hereafter, names of parameters representing the different fluorescence channels are preceded by &#x2018;<italic>FL</italic>&#x2019;, the Red 1 channel is referred to as &#x2018;<italic>FL.Red</italic>&#x2019; and the Red 2 channel as &#x2018;<italic>X2.FL.Red</italic>&#x2019;. Names of parameters representing the scattering channels are preceded by <italic>&#x2018;FWS</italic>&#x2019; (forward scatter; typically abbreviated FSC in the flow cytometry literature) and &#x2018;<italic>SWS</italic>&#x2019; (sideward scatter or side-scatter&#x2019; typically abbreviated SSC in the flow cytometry literature).</p>
<p>The signal produced by each particle is a time series of measurements for each channel, which describe the variation in scattering and fluorescence over the length of the particle. This high-resolution time series describes a pulse for each channel (4 fluorescence and 2 scattering). These pulses may be highly irregular in shape (Fig. S1) and are therefore characterized using a number of parameters (see Table S1 for parameter descriptions).</p>
</sec>
<sec id="s2b3b">
<label>3.2.</label>
<title>Instrument configuration</title>
<p>Internal flow rates were set at 2 &#x03BC;L.s-1. A trigger threshold of 99.7 mV on the sideward scatter channel was enforced; particles whose scattering did not rise above this level were therefore not recorded. Field samples measurements were terminated when 500 &#x00B5;L was measured or 9 minutes elapsed, whichever was earlier.</p>
</sec>
<sec id="s2b3c">
<label>3.3.</label>
<title>Field sampling procedure</title>
<p>Every four hours, the sampling tube was automatically deployed to each of the 6 depths by the automated station (described in [<xref ref-type="bibr" rid="c4">4</xref>]). Water samples were pumped to a 250 mL sampling chamber at the surface through a tube with a 1-cm diameter opening, making these highly depth-specific measurements. The sampling chamber was flushed with water from the sampling depth four to five times over 2 minutes before the CytoSense collected a water sample of up to 500 &#x00B5;L for measurement.</p>
</sec>
<sec id="s2b3d">
<label>3.4.</label>
<title>Generation of training datasets using lab cultures</title>
<p>Our training dataset for the random forest served 3 purposes: (1) to enable the identification of parameters that most strongly distinguish between live cells and other signals, (2) to enable the identification of parameters that most strongly distinguish between cells belonging to different functional groups, and (3) to train the algorithm to estimate cell biovolume based on all the measured CytoSense parameters.</p>
<p>We measured ten laboratory cultures belonging to multiple functional groups (<xref ref-type="table" rid="tbl1">Table 1</xref>). In clonal lab cultures, manual identification of live cells and other signals is straightforward (examples in Fig. S2). We generated a dataset containing approximately 1,200 measurements of live cells (manually identified as in Fig. S2) and 8,400 measurements of other signals, equally sampled from all species&#x2019; measurements. The proportion was chosen to approximately mirror the low proportion of live cells expected from field measurements.</p>
<p>We note that overall performance will likely improve if the training dataset is improved. This may be done by increasing the number of species, number of functional groups, range of sizes, and range of culture conditions.</p>
</sec>
<sec id="s2b3e">
<label>3.5.</label>
<title>Data cleaning</title>
<sec id="s2b3e1">
<label>3.5.1.</label>
<title>Identifying parameters that distinguish live phytoplankton cells from other signals</title>
<p>The CytoSense measures 94 parameters for every particle. However, due to the &#x2018;curse of dimensionality&#x2019; problem for clustering algorithms, we chose to reduce the number of variables examined. We used a machine learning algorithm, a random forest [<xref ref-type="bibr" rid="c27">27</xref>], to identify the variables that most strongly distinguished between live cells and other signals. Most importantly for this purpose, random forests can be used to generate a ranking of variable importance based on the change in classification error rate when a particular variable is permuted across individual decision trees. For this and all subsequent uses of random forests, we used the R package <italic>randomForest</italic> [<xref ref-type="bibr" rid="c35">35</xref>].</p>
<p>Before analysis, we log-transformed all variables whose minimum value was &#x003E; 0, because most variables exhibited highly skewed distributions that could prove challenging for subsequent analyses. Then, to avoid problems associated with multicollinearity, we removed one member of all pairs of variables in the laboratory dataset whose correlation coefficient was > 0.8 or &#x003C; -0.8. We were left with 51 variables. We trained a random forest with 10,001 trees on this dataset and found that the 10 most important variables enabled a clear distinction between live cells and other signals (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). In descending order of importance, they were: <italic>FL.Red.Range, X2.FL.Red.Range, X2.FL.Red.Gradient, FL.Red.Number.of.cells, X2.FL.Red.Last, FWS.Range, FL.Red.Fill.factor, X2. FL.Red.Fill.factor, FL.Yellow.Range</italic>, and <italic>FL.Orange.Range</italic>. We note that the specific number of variables used is a feature of the dataset being considered, and readers are advised to explore using differing numbers of variables to identify the optimal number for their data.<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 2.</label>
<caption>
<p>Importance of different traits in distinguishing between particle types, as determined by random forests applied to laboratory training data (Fig. S2). Variable importance is assessed using a Gini coefficient that measures the change in classification error when a variable is omitted [<xref ref-type="bibr" rid="c27">27</xref>]. The 30 most important variables are shown here. a) Variables that most strongly distinguish between live cells and other signals (electronic noise, detritus and bacterial cells). The top ten were used for unsupervised clustering of the raw field data. a) Variables that most strongly distinguish between major functional groups. The top eight were used for unsupervised clustering of the cleaned field data.</p>
</caption>
<graphic xlink:href="274357_fig2.tif"/>
</fig></p>
</sec>
<sec id="s2b3e2">
<label>3.5.2.</label>
<title>Generating a random subset of the raw field data</title>
<p>The complete dataset of 191 measurements contained >20 million particles and could not be clustered simultaneously using standard computing resources. Furthermore, clustering each measurement separately would have led to the identification of different clusters as the community changed, limiting the possibility to make comparisons between measurements. We therefore generated a file containing an equal number of randomly selected data points from every measured sample, to distinguish between living phytoplankton cells and other signals. The data subset contained approximately 100,000 points which was both computationally tractable, and large enough to enable the identification of distinct clusters containing relatively low numbers of points that may be missed with smaller file sizes.</p>
</sec>
<sec id="s2b3e3">
<label>3.5.3.</label>
<title>Unsupervised clustering of the subset of raw data</title>
<p>We selected the 10 variables identified in <xref ref-type="sec" rid="s2b3e1">section 3.5.1</xref>, log-transformed them and used the <italic>flowPeaks</italic> algorithm [<xref ref-type="bibr" rid="c26">26</xref>] to identify clusters of similar data points. <italic>flowPeaks</italic> (implemented in the R statistical environment [<xref ref-type="bibr" rid="c32">32</xref>]) uses a k-means-based algorithm to first cluster the entire dataset into large numbers of small clusters, and then merges clusters based on density gradients. The smoothness of the density function is determined by tuneable parameters; we used values of 0.25 for <italic>tol</italic>, 0.05 for <italic>h0</italic>, and 2 for <italic>h</italic> [<xref ref-type="bibr" rid="c26">26</xref>] as these provided clusters that matched our expectations based on visual examination of 3D plots. However, the best parameter values may differ between datasets.</p>
<p>The algorithm identified 8 clusters, which we visually inspected using 3D plots (Fig. S3 and animated versions of S3a and S3b in the supporting information, Table S2). From these plots, we identified seven clusters corresponding to live phytoplankton cells, which together constituted 5&#x0025; of the data. The remaining cluster corresponded to signals we were uninterested in, and cannot distinguish between: a combination of bacteria, dead phytoplankton, detritus, and electronic noise. Phytoplankton clusters were primarily characterized by high pigment fluorescence, particularly <italic>FL.Red.Range</italic> (a proxy for chlorophyll-a) (Table S2) and high forward scatter (FWS).</p>
</sec>
<sec id="s2b3e4">
<label>3.5.4.</label>
<title>Using random forests to classify raw data points and clean dataset</title>
<p>We used a second random forest [<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c35">35</xref>] to classify all points in every sample into one of the eight clusters identified in the previous step using <italic>flowPeaks</italic> (code available at [<xref ref-type="bibr" rid="c31">31</xref>]). We trained the random forest with 1,001 trees on the clustered 100,000 point data subset, allowing it to identify nonlinear boundaries between the eight clusters. The out-of-bag classification error rate of this random forest was &#x003C;2&#x0025;, indicating acceptably accurate performance in this classification step. We then used this random forest to classify all points in every sample into one of the eight clusters identified earlier. Points identified as belonging to one of the seven phytoplankton clusters were retained and the remainder discarded. The retained points from each sample were saved in separate files for further analysis.</p>
</sec>
</sec>
<sec id="s2b3f">
<label>3.6.</label>
<title>Functional group identification</title>
<p>We identified the functional groups that individual cells belonged to by essentially repeating the data cleaning procedure (<xref ref-type="sec" rid="s2b3e">section 3.5</xref>) on the cleaned data. There were minor differences in procedure that we note below.</p>
<sec id="s2b3f1">
<label>3.6.1.</label>
<title>Identifying parameters that distinguish between phytoplankton functional groups</title>
<p>For this step, we used the lab culture training dataset containing 1,200 measurements of live phytoplankton cells only, belonging to five different functional groups &#x2013; chrysophytes, cryptophytes, cyanobacteria, green algae, and diatoms (<xref ref-type="table" rid="tbl1">Table 1</xref>).</p>
<p>We then used a random forest to identify the variables that most strongly distinguished between these functional groups. As earlier, we log-transformed all variables whose minimum value was &#x003E; 0 and removed one member of all pairs of variables in the laboratory dataset whose correlation coefficient was &#x003E; 0.8 or &#x003C; -0.8. We were left with 43 variables. We trained a random forest with 10,001 trees [<xref ref-type="bibr" rid="c35">35</xref>] and found that 8 variables enabled a clear distinction between cells belonging to different functional groups (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). In descending order of importance, they were: <italic>FL.Red.Range, Red1Red2.ratio, FWS.Length, FL.Orange.Range, X2.FL.Red.Range, FL.Red.First, X2.FL.Red.Gradient and FWS.Fill.factor</italic>.</p>
</sec>
<sec id="s2b3f2">
<label>3.6.2.</label>
<title>Generating a random subset of the cleaned field data</title>
<p>To identify phytoplankton cells belonging to different functional groups, we generated a file containing an equal number of randomly selected data points from every cleaned data file, for a total of approximately 100,000 points.</p>
</sec>
<sec id="s2b3f3">
<label>3.6.3.</label>
<title>Unsupervised clustering of the subset of cleaned data</title>
<p>We selected the 8 variables identified in <xref ref-type="sec" rid="s2b3f1">section 3.6.1</xref>, log-transformed them and applied <italic>flowPeaks</italic> [<xref ref-type="bibr" rid="c26">26</xref>] to identify clusters of similar data points. We used the same parameter values as earlier (<italic>tol</italic> = 0.25, <italic>h0</italic> = 0.05, and <italic>h</italic> = 2). The algorithm identified 12 clusters, which we visually inspected using 3D plots (Figs. S4 and animated versions of S4a and S4b in the supporting information, Table S3). We limited our subsequent analyses to the four clusters that formed &#x003E;5&#x0025; of the dataset (totalling &#x003E;90&#x0025; of the data), but note here that (i) functional groups may comprise multiple clusters and (ii) rarer functional groups are unassigned. The latter this is not a limitation of the method; a detailed laboratory comparison of the trait signatures of all functional groups would permit the assignment of every cluster to a functional group.</p>
</sec>
<sec id="s2b3f4">
<label>3.6.4.</label>
<title>Assignment of clusters to specific functional groups</title>
<p>Based on the fluorescence and scattering signals of these clusters and their relative abundance in the microscopy data, we assigned the four clusters to four functional groups. We note that our microscopy data showed that diatoms, dinoflagellates, euglenophytes, and desmids were almost entirely absent from the lake during the periods we sampled, leaving us with four well-represented functional groups &#x2013; chrysophytes, cryptophytes, cyanobacteria, and green algae.</p>
<p>Cyanobacteria are characterised by a low <italic>Red1Red2.ratio</italic> value (indicative of high phycocyanin content), which was characteristic of Cluster 2 (Tables S3, S4). Our assignment of the remaining clusters is necessarily more speculative and would be improved by a broader sampling of the phenotypic diversity of these groups using lab cultures. Cluster 1, the most abundant group in the SFCM data, was designated as chrysophytes, the most abundant eukaryotic group in the microscopy counts. Cluster 3 was characterized by a low <italic>X2.FL.Red.Gradient</italic> and <italic>FL.Red.First</italic> and an intermediate <italic>Red1Red2.ratio</italic>, indicative of cryptophytes. Cluster 4 was characterized by relatively high <italic>Red1Red2.ratio</italic> and <italic>FL.Red.Range</italic>, suggesting that they represent green algae. Note that in most cases other than <italic>Red1Red2.ratio</italic>, we did not have an <italic>a priori</italic> expectation relating to the importance of these variables in differentiating between functional groups. Therefore, we do not speculate on the reasons behind their importance here.</p>
</sec>
<sec id="s2b3f5">
<label>3.6.5.</label>
<title>Using random forests to classify cleaned data into trait clusters</title>
<p>We trained a random forest with 1,001 trees on the 100,000 point cleaned data subset (code available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.999747">https://doi.org/10.5281/zenodo.999747</ext-link>), allowing it to identify nonlinear boundaries between the clusters identified in the previous stage. Out-of-bag error rates for this random forest were &#x003C;2&#x0025;, again suggesting acceptably low levels of classification error. We then used this random forest to classify all cells in the cleaned data files into one of the 12 trait clusters identified earlier. We recorded the cell densities of every trait cluster in every sample.</p>
</sec>
</sec>
<sec id="s2b3g">
<label>3.7.</label>
<title>Biovolume estimation</title>
<sec id="s2b3g1">
<label>3.7.1.</label>
<title>Estimating the biovolumes of single cells and colonies</title>
<p>We trained a random forest with 10,001 trees on our lab culture training dataset (<xref ref-type="table" rid="tbl1">Table 1</xref>) to estimate the biovolumes of individual cells using all measured SFCM parameters. We used all the parameters and a training dataset with taxa from all the major functional groups in order to train a random forest that accounts for taxonomic differences in scattering and pigmentation properties. This approach was substantiated by our finding that <italic>Red1Red2.ratio</italic> (indicative of whether a cell was a cyanobacterium or a eukaryote) was the most important predictor of biovolume (Fig. S5) and not scattering, which has previously been used in biovolume estimation of phytoplankton cells by SFCM [<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c10">10</xref>]. Furthermore, the trained random forest had a model R<sup>2</sup> (based on out-of-bag estimates) of 0.93 as opposed to a linear model based on the best single scattering variable (FWS.Length), which had an R<sup>2</sup> of 0.50.</p>
<p>We used this trained random forest to predict the biovolume of every individual cell in our cleaned field data based on all their SFCM parameters.</p>
</sec>
<sec id="s2b3g2">
<label>3.7.2.</label>
<title>Estimating the density of the whole community and major functional groups</title>
<p>We first quantified the cell density of each community by multiplying the particle concentration (estimated by the CytoSense) with the proportion of particles that were cells in the sample. Subsequently, we estimated the cell density of each cluster (functional group) by multiplying the cell density of the community by the proportion of cells in the sample belonging to the cluster.</p>
</sec>
<sec id="s2b3g3">
<label>3.7.3.</label>
<title>Estimating the total biovolume of the whole community and major functional groups</title>
<p>We estimated total biovolume of each community by multiplying the cell density estimated in <xref ref-type="sec" rid="s2b3g2">section 3.7.2</xref> with the mean biovolume of all cells in the community. Similarly, we estimated the biovolume of each cluster (functional group) by multiplying the estimated cell density of each cluster by the mean biovolume of all cells belonging to that cluster.</p>
</sec>
</sec>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results and assessment</title>
<p>We assessed the accuracy of our data cleaning, functional group identification, and biovolume estimation procedures by using field data to compare SFCM estimates with microscopy estimates of (1) cell density at the whole-community level, (2) total biovolume at the whole-community level, (3) cell density of the major functional groups, and (4) total biovolume of the major functional groups.</p>
<sec id="s3a">
<label>1)</label>
<title>Cell density of the phytoplankton community</title>
<p>SFCM estimates of whole-community cell density were strongly positively correlated with microscopy estimates (<italic>r</italic> = 0.73, <italic>p</italic> &#x003C; 0.001, <xref ref-type="fig" rid="fig3">Fig. 3a</xref>). The slope of the regression between the two estimates is indistinguishable from 1 (mean = 0.99, CIs: 0.86, 1.13) and the intercept is indistinguishable from 0 (mean = -0.13, CIs: -0.65, 0.38). Quantitative estimates of cell density were extremely similar in both cases. SFCM estimates were marginally lower on average, possibly due to (i) calibration of the SFCM inlet pump, leading to lower flow rates and consequently cell density estimates, (ii) difficulties in evaluating whether a cell was alive or dead in fixed microscopy samples, leading to overestimation of the microscopy cell density, or (iii) break-up of colonial organisms during preservation for microscopy. Whatever the underlying reason, the apparent difference is small, and variation in SFCM cell density estimates accurately captures variation in cell density by microscopy measurements.<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 3.</label>
<caption>
<p>Estimates of whole-community cell density and biovolume by SFCM are strongly correlated with those by microscopy (on the log scale), and are quantitatively accurate. Each point represents a single depth-specific sample measured using both methods. The black line is the 1:1 line and the red line represents the regression relationship. a) Cell density estimates are strongly correlated (r = 0.73, p &#x003C; 0.001). b) Whole-community total biovolume estimates are strongly correlated (r = 0.67, p &#x003C; 0.001). The slope of the regression is indistinguishable from 1 (mean = 0.90, CIs: 0.76, 1.05) and the intercept is indistinguishable from 0 (mean = -0.40, CIs: -0.54, 1.33).</p>
</caption>
<graphic xlink:href="274357_fig3.tif"/>
</fig></p>
</sec>
<sec id="s3b">
<label>2)</label>
<title>Total biovolume of the phytoplankton community</title>
<p>SFCM estimates of total community biovolume are strongly correlated with microscopy estimates (<italic>r</italic> = 0.67, <italic>p</italic> &#x003C; 0.001, <xref ref-type="fig" rid="fig3">Fig. 3b</xref>). The slope of the regression is indistinguishable from 1 (mean = 0.90, CIs: 0.76, 1.05) and the intercept is indistinguishable from 0 (mean = -0.40, CIs: -0.54, 1.33). Quantitative estimates of total biovolume were similar in absolute magnitude over an approximately 30-fold range in biovolume, but appear to be slightly underestimated. This underestimation is partly driven by differences in cell density estimates (<xref ref-type="fig" rid="fig3">Fig. 3a</xref>), because density estimates are involved in total biovolume calculation. Differences in total biovolume are also influenced by our microscopy biovolume estimation procedure: estimates were generated by referring to a database of mean cell biovolumes and were not measured in the individual samples. Therefore, errors in our cell size database are propagated through to our estimates of total community biovolume by microscopy. However, intraspecific variation in cell biovolume is substantially lower than interspecific variation (which varies by &#x003E;7 orders of magnitude [<xref ref-type="bibr" rid="c34">34</xref>]), and so we expect that this is at most a small source of error.</p>
</sec>
<sec id="s3c">
<label>3)</label>
<title>Cell density of the major functional groups</title>
<p>SFCM estimates of the cell density of major functional groups were moderately to strongly correlated with microscopy estimates (<italic>r</italic> ranges from 0.44 to 0.76, <italic>p</italic> &#x003C; 0.001 in all cases, <xref ref-type="fig" rid="fig4">Fig. 4</xref>). Chrysophytes were the most abundant group overall and also show the strongest correlation and quantitative agreement between estimates.<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 4.</label>
<caption>
<p>Estimates of cell density of four major functional groups by SFCM and microscopy are moderately to strongly correlated on the log scale (r between 0.44 and 0.76, p &#x003C; 0.001 in all cases). Each point represents a single depth-specific sample measured using both methods. The black line is the 1:1 line and the red line represents the regression relationship (with confidence bands). In a small number of microscopy measurements, no cyanobacteria were found. These points are plotted with high transparency assuming that the true concentration was half the detection limit of 28 cells per mL. A small number of points were excluded from the regressions due to their being excessively influential, but the effect of this exclusion on slopes and correlation coefficients is modest.</p>
</caption>
<graphic xlink:href="274357_fig4.tif"/>
</fig></p>
<p>Cryptophytes and green algae show weaker correlations with slopes that were &#x003C;1, but also exhibited relatively low variation over the sampling period, making it challenging to compare accurately. Cyanobacterial density estimates also showed a strong positive relationship, but this relationship was influenced by a small number of microscopy measurements in which no cyanobacterial cells were identified. These samples appeared to have been substantially overestimated by SFCM or underestimated by microscopy. This may partly be explained by the lower detection limit and consequently lower sampling variability of SFCM measurements when compared to microscopy measurements, but may also be a result of cell degradation in samples which were not properly fixed. Though the quantitative estimates are substantially better if we exclude these points, the relationship remains reasonably strong even if we include them by assuming a cell density of 50&#x0025; of the detection limit.</p>
</sec>
<sec id="s3d">
<label>4)</label>
<title>Total biovolume of the major functional groups</title>
<p>SFCM estimates of the total biovolume of major functional groups were moderately to strongly correlated with microscopy estimates (<italic>r</italic> ranges from 0.41 to 0.75, <italic>p</italic> &#x003C; 0.001 in all cases, <xref ref-type="fig" rid="fig5">Fig. 5</xref>). As with cell density, chrysophytes showed not just a strong correlation between estimates, but also highly similar quantitative estimates. Cryptophytes and green algae exhibited a relatively small degree of variation and differed in absolute value, but were positively correlated in both cases. As in <xref ref-type="fig" rid="fig4">Fig. 4</xref>, cyanobacterial estimates were reasonably accurate, but a small number of measurements showed no cells in microscopy measurements even though the SFCM estimates were moderately high. Notably, slopes and correlation coefficients are relatively similar in both cell density and total biovolume. As cell density is used to estimate total biovolume, this suggests that the discrepancy is largely caused by these estimates, and that mean cell biovolume of each group is being estimated accurately. We have demonstrated that this method produces estimates of cell density and biovolume that are reasonably well-correlated with estimates by microscopy, especially at the whole community level. These correlations may have been even stronger if microscopy samples could be collected at the same depth resolution as our SFCM measurements (we sampled a 46 cm-wide water column for microscopy and a 1 cm-wide water column for SFCM). And although we ignored less abundant clusters in this analysis because of limitations in the number of lab-measured taxa, our method can easily be expanded upon to include finer-scale variation and a wider range of functional groups.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 5.</label>
<caption>
<p>Estimates of total biovolume of four major functional groups by SFCM and microscopy are moderately well-correlated on the log scale (r between 0.41 and 0.75, p &#x003C; 0.001 in all cases). Each point represents a single depth-specific sample measured using both methods. The black line is the 1:1 line and the red line represents the regression relationship (with confidence bands). In a small number of microscopy measurements, no cyanobacteria were found. These points are plotted with high transparency assuming that the true concentration was the minimum cyanobacterial biovolume detected. A small number of points were excluded from the regressions due to their being excessively influential, but the effect of this exclusion on slopes and correlation coefficients is modest.</p>
</caption>
<graphic xlink:href="274357_fig5.tif"/>
</fig>
<p>Our protocol (<xref ref-type="fig" rid="fig1">Fig. 1</xref>) is composed of three parts that can each be improved upon with more data or improved algorithms, while following essentially the same protocol. The strong agreement between SFCM results and microscopy results from a complex natural community supports our claim. It improves on existing methods by (i) reducing the subjectivity associated with manual cluster designation, and (ii) increasing the scalability of FCM and SFCM analyses by enabling the study of datasets of arbitrarily large size using basic computing facilities. This scalability is achieved by coupling unsupervised clustering with machine learning techniques (which have frequently been used independently previously) and reducing the size of the major tasks through the use of training datasets and data subsets.</p>
<p>However, there are important limitations to our method:</p>
<list list-type="order">
<list-item><p>The generation of training datasets is necessary and can be time-consuming. Training datasets must contain representatives of all groups present in the system under study (with the possible exception of taxa that are rare both in terms of abundance and biovolume contribution). Moreover, this training exercise will need to be done independently for every instrument and potentially for changes in important instrument settings (such as photomultiplier tube gain) as well. It is possible that a training dataset also includes measurements of taxa grown under a variety of environmental conditions would improve performance by accounting environment-dependent plasticity. Currently, our method might lead to biased estimates of biovolume due to plastic changes in fluorescence traits (such as due to decreases in light with depth) that our random forest does not account for. Functional groups that are similar to each other in traits may also not be distinguished well (i.e. there may be misclassification) if this plasticity leads to changes in their trait distributions. Additionally, functional groups are diverse and our training dataset contains relatively few species from each cluster, potentially biasing biovolume estimates. However, this can be solved by including more representative species from each group in the training dataset.</p></list-item>
<list-item><p>Many clustering algorithms have difficulties in identifying clusters that are highly nonlinear in multiple dimensions. Unsupervised clustering is an active area of research and future advances in density-based clustering methods and neural network-based methods may alleviate some of these problems [<xref ref-type="bibr" rid="c36">36</xref>]. However, every such algorithm has its own weaknesses and such improvements may come at the cost of other features (e.g. computational speed).</p></list-item>
<list-item><p>By clustering datasets with equal numbers of data points randomly selected from every time point, we might miss out on clusters that are present for very short periods of the time series. These clusters are poorly represented even if abundant for short time periods. This limitation is even more relevant if our approach is used to study datasets collected across space instead of time; clusters present at just one or two of a large number of sites may be difficult to detect. Addressing this issue will require careful sampling, but may also be aided by advances in clustering methods. A sequential clustering approach that re-clusters the data after the most abundant cluster is removed may also be useful in identifying these cases.</p></list-item>
<list-item><p>Our assignment of clusters to functional groups is at present provisional, except in the case of cyanobacteria, which are very strongly differentiated by their ratio of Red 1 to Red 2 fluorescence. This may be improved on by using instruments configured with more laser and detectors than the one used here, enabling the more precise targeting of pigments characterising different functional groups. In the absence of this, the problem may be mitigated by using larger training datasets with more representative species from each functional group.</p></list-item>
</list>
<p>Future work may therefore most profitably expand on our work by using a much broader training dataset to train machine learning algorithms. Capturing the entire range of functional groups and a broad sampling of the phenotypic variation within these groups would enable the classification of cells into functional groups (and potentially lower level taxonomic categories) without the need for unsupervised clustering.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>Scanning flow cytometry has the potential to enable the high-frequency monitoring of natural phytoplankton communities in real time, improving our ability to understand their ecology [<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c9">9</xref>]. For some ecological questions, such as those relating to the influence of short-term environmental changes on populations and communities, they are (along with IFCM) the only feasible measurement tool at present. Tools to automate the analysis of FCM and SFCM data will greatly increase the utility of these instruments, increasing our ability to understand the drivers of high-frequency dynamics in natural communities.</p>
<p>A very large number of unsupervised clustering algorithms exist with differing strengths and weaknesses [<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref>,<xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c38">38</xref>], and we did not attempt to compare the efficacy of different algorithms here. Instead, we use an algorithm (flowPeaks [<xref ref-type="bibr" rid="c26">26</xref>]) that has previously been applied to phytoplankton populations [<xref ref-type="bibr" rid="c17">17</xref>] and provides rapid, reasonably accurate results using relatively limited computational resources. More sophisticated algorithms that are capable of identifying points that do not below to any clear cluster (&#x2018;noise&#x2019;) such as DBSCAN [<xref ref-type="bibr" rid="c39">39</xref>] may improve on this, but they generally require computationally expensive calculations, including the distance between all pairs of points to be clustered. Our approach is flexible and alternative algorithms can be substituted here if found to be more suitable.</p>
<p>A more general problem that our approach solves is that unsupervised clustering of high-dimensional SFCM data suffers from the &#x2018;curse of dimensionality&#x2019;. Output is less reliable as dimensionality increases, and visualisation of clusters also becomes difficult beyond three dimensions [<xref ref-type="bibr" rid="c40">40</xref>]. Therefore, there is a strong need to reduce the dimensionality of the problem for both reliable clustering and for visualisation.</p>
<p>This may be done by two methods: (i) we could use a dimension-reduction algorithm such as principal components analysis, or (ii) we may limit the number of dimensions that we choose to cluster. We followed the second approach here because the former suffers from the weakness that the major principal components may not be meaningful in distinguishing between the signals we are interested in; in other words, there may be more variation in unimportant dimensions than in important ones. Although machine learning techniques have previously been applied to FCM data [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c41">41</xref>&#x2013;<xref ref-type="bibr" rid="c43">43</xref>], our work differs in using it for tasks beyond classification. We have also used machine learning to predict biovolumes of individual cells, and to identify the phenotypic features that most reliably distinguish between particle types (<xref ref-type="fig" rid="fig1">Figs. 1</xref>, <xref ref-type="fig" rid="fig2">2</xref>). When used in combination with unsupervised clustering, it constitutes a powerful and flexible tool in processing large FCM and SFCM datasets. In principle, a machine learning algorithm trained on lab cultures may be able to identify trait clusters in field data. However, in practice we need to couple this with unsupervised clustering because trait cluster boundaries differ between lab and field communities. This is because (i) natural communities contain species that may not be in the training dataset, and (ii) changes in environmental conditions may lead to plastic changes in fluorescence and scattering, shifting the boundaries between clusters.</p>
<p>Our method provides a repeatable, semi-automated protocol with which to process large FCM and SFCM datasets using readily available computing resources and free software tools (the R software environment and packages <italic>randomForest</italic> and <italic>flowPeaks</italic>). Our work integrates existing tools - lab measurements, machine learning, and unsupervised classification - from multiple fields to improve the speed, repeatability, and robustness of SFCM analysis. We believe that this protocol will greatly increase the ease and speed with which large SFCM datasets can be processed and analysed. In the future, automated (or semi-automated) analytical tools such as these may enable the monitoring of water bodies for harmful algal bloom development in real time, through classification of cells based on previously developed training datasets. Cyanobacteria, which are responsible for freshwater harmful algal blooms, possess fluorescence traits were especially easy to distinguish with our instrument configuration, making the identification and quantification of this taxon simple. Examination of a broader range of cyanobacteria may allow us to identify features that distinguish between potentially toxic cyanobacterial taxa and taxa that do not produce toxins, greatly increasing water quality monitoring efforts. However, this protocol will also improve our ability to study fundamental aspects of the physiology, ecology and evolution of phytoplankton communities, by enabling their monitoring on time-scales orders of magnitude lower than is presently feasible using microscopy methods.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work was supported by the Swiss National Science Foundation project CRSII2_147654, &#x201C;In-situ Sensing Tools for Understanding Rapid Microscale Plankton Dynamics&#x201D;. We would like to thank M. Stravs and L. Nizzetto for providing phytoplankton cultures, Esther Keller for microscopy analysis and Hannele Penson for assistance with field work, and Michael Kehoe for advice related to machine learning techniques.</p>
</ack>
<sec id="s5">
<title>Statement of author contributions</title>
<p>MKT and FP conceived of the method with input from SF. FP, SF, MR &#x0026; MKT collected the field data. MR maintained lab cultures and collected lab SFCM and microscopy measurements. MKT wrote the manuscript with substantial input from FP, SF and MR.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Hammes</surname> <given-names>F</given-names></string-name>, <string-name><surname>Egli</surname> <given-names>T</given-names></string-name>. <article-title>Cytometric methods for measuring bacteria in water: Advantages, pitfalls and applications</article-title>. <source>Anal Bioanal Chem</source>. <year>2010</year>;<volume>397</volume>: <fpage>1083</fpage>&#x2013;<lpage>1095</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s00216-010-3646-3</pub-id></mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="book"><string-name><surname>Sosik</surname> <given-names>HM</given-names></string-name>, <string-name><surname>Olson</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Armbrust</surname> <given-names>EV</given-names></string-name>. <chapter-title>Flow cytometry in phytoplankton research</chapter-title>. In: <string-name><surname>Suggest</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Pr&#x00E1;&#x0161;il</surname> <given-names>O</given-names></string-name>, <string-name><surname>Borowitzka</surname> <given-names>MA</given-names></string-name>, editors. <source>Chlorophyll a Fluorescence in Aquatic Sciences: Methods and Applications</source>. <publisher-name>Dordrecht</publisher-name>: <publisher-loc>Springer Netherlands</publisher-loc>; <year>2010</year>. pp. <fpage>171</fpage>&#x2013;<lpage>185</lpage>. doi:<pub-id pub-id-type="doi">10.1007/978-90-481-9268-7</pub-id></mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Hammes</surname> <given-names>F</given-names></string-name>, <string-name><surname>De Roy</surname> <given-names>K</given-names></string-name>, <string-name><surname>Verstraete</surname> <given-names>W</given-names></string-name>, <string-name><surname>Boon</surname> <given-names>N</given-names></string-name>. <article-title>Past, present and future applications of flow cytometry in aquatic microbiology</article-title>. <source>Trends Biotechnol</source>. <year>2010</year>;<volume>28</volume>: <fpage>416</fpage>&#x2013;<lpage>424</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.tibtech.2010.04.006</pub-id></mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Pomati</surname> <given-names>F</given-names></string-name>, <string-name><surname>Jokela</surname> <given-names>J</given-names></string-name>, <string-name><surname>Simona</surname> <given-names>M</given-names></string-name>, <string-name><surname>Veronesi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ibelings</surname> <given-names>BW</given-names></string-name>. <article-title>An automated platform for phytoplankton ecology and aquatic ecosystem monitoring</article-title>. <source>Environ Sci Technol</source>. <year>2011</year>;<volume>45</volume>: <fpage>9658</fpage>&#x2013;<lpage>65</lpage>. doi:<pub-id pub-id-type="doi">10.1021/es201934n</pub-id></mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Arnoldini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Heck</surname> <given-names>T</given-names></string-name>, <string-name><surname>Blanco-Fern&#x00E1;ndez</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hammes</surname> <given-names>F</given-names></string-name>. <article-title>Monitoring of dynamic microbiological processes using real-time flow cytometry</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>: <fpage>e80117</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0080117</pub-id></mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Hunter-Cevera</surname> <given-names>KR</given-names></string-name>, <string-name><surname>Neubert</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Solow</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Olson</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Shalapyonok</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sosik</surname> <given-names>HM</given-names></string-name>. <article-title>Diel size distributions reveal seasonal growth dynamics of a coastal phytoplankter</article-title>. <source>PNAS</source>. <year>2014</year>;<volume>111</volume>: <fpage>9852</fpage>&#x2013;<lpage>9857</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1321421111</pub-id></mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Besmer</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Weissbrodt</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Kratochvil</surname> <given-names>BE</given-names></string-name>, <string-name><surname>Sigrist</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Weyland</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Hammes</surname> <given-names>F</given-names></string-name>. <article-title>The feasibility of automated online flow cytometry for in-situ monitoring of microbial dynamics in aquatic ecosystems</article-title>. <source>Front Microbiol</source>. <year>2014</year>;<volume>5</volume>: <fpage>1</fpage>&#x2013;<lpage>12</lpage>. doi:<pub-id pub-id-type="doi">10.3389/fmicb.2014.00265</pub-id></mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Dubelaar</surname> <given-names>GBJ</given-names></string-name>, <string-name><surname>Gerritzen</surname> <given-names>PL</given-names></string-name>. <article-title>A Step Forward towards Using Flow Cytometry in Operational Oceanography</article-title>. <source>Sci Mar</source>. <year>2000</year>;<volume>64</volume>: <fpage>255</fpage>&#x2013;<lpage>265</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Pomati</surname> <given-names>F</given-names></string-name>, <string-name><surname>Kraft</surname> <given-names>NJB</given-names></string-name>, <string-name><surname>Posch</surname> <given-names>T</given-names></string-name>, <string-name><surname>Eugster</surname> <given-names>B</given-names></string-name>, <string-name><surname>Jokela</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ibelings</surname> <given-names>BW</given-names></string-name>. <article-title>Individual cell based traits obtained by scanning flow-cytometry show selection by biotic and abiotic environmental factors during a phytoplankton spring bloom</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>: <fpage>e71677</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0071677</pub-id></mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Pomati</surname> <given-names>F</given-names></string-name>, <string-name><surname>Nizzetto</surname> <given-names>L</given-names></string-name>. <article-title>Assessing triclosan-induced ecological and trans-generational effects in natural phytoplankton communities: a trait-based field method</article-title>. <source>Ecotoxicology</source>. <year>2013</year>;<volume>22</volume>: <fpage>779</fpage>&#x2013;<lpage>94</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s10646-013-1068-7</pub-id></mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Dubelaar</surname> <given-names>GBJ</given-names></string-name>, <string-name><surname>Jonker</surname> <given-names>RR</given-names></string-name>. <article-title>Flow cytometry as a tool for the study of phytoplankton</article-title>. <source>Sci Mar</source>. <year>2000</year>;<volume>64</volume>: <fpage>135</fpage>&#x2013;<lpage>156</lpage>. doi:<pub-id pub-id-type="doi">10.3989/scimar.2000.64n2135</pub-id></mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Sosik</surname> <given-names>HM</given-names></string-name>, <string-name><surname>Olson</surname> <given-names>RJ</given-names></string-name>. <article-title>Automated taxonomic classification of phytoplankton sampled with imaging in-flow cytometry</article-title>. <source>Limnol Oceanogr Methods</source>. <year>2007</year>;<volume>5</volume>: <fpage>204</fpage>&#x2013;<lpage>216</lpage>. doi:<pub-id pub-id-type="doi">10.4319/lom.2007.5.204</pub-id></mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Lo</surname> <given-names>K</given-names></string-name>, <string-name><surname>Brinkman</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Gottardo</surname> <given-names>R</given-names></string-name>. <article-title>Automated gating of flow cytometry data via robust model-based clustering</article-title>. <source>Cytom Part A</source>. <year>2008</year>;<volume>73</volume>: <fpage>321</fpage>&#x2013;<lpage>332</lpage>. doi:<pub-id pub-id-type="doi">10.1002/cyto.a.20531</pub-id></mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Aghaeepour</surname> <given-names>N</given-names></string-name>, <string-name><surname>Nikolic</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hoos</surname> <given-names>HH</given-names></string-name>, <string-name><surname>Brinkman</surname> <given-names>RR</given-names></string-name>. <article-title>Rapid cell population identification in flow cytometry data</article-title>. <source>Cytom Part A</source>. <year>2011</year>;79A: <fpage>6</fpage>&#x2013;<lpage>13</lpage>. doi:<pub-id pub-id-type="doi">10.1002/cyto.a.21007</pub-id></mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Malkassian</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nerini</surname> <given-names>D</given-names></string-name>, <string-name><surname>Van Dijk</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Thyssen</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mante</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gregori</surname> <given-names>G</given-names></string-name>. <article-title>Functional analysis and classification of phytoplankton based on data from an automated flow cytometer</article-title>. <source>Cytom Part A</source>. <year>2011</year>;<volume>79 A</volume>: <fpage>263</fpage>&#x2013;<lpage>275</lpage>. doi:<pub-id pub-id-type="doi">10.1002/cyto.a.21035</pub-id></mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="confproc"><string-name><surname>Gl&#x00FC;ge</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pomati</surname> <given-names>F</given-names></string-name>, <string-name><surname>Albert</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kauf</surname> <given-names>P</given-names></string-name>, <string-name><surname>Ott</surname> <given-names>T</given-names></string-name>. <chapter-title>The challenge of clustering flow cytometry data from phytoplankton in lakes</chapter-title>. In: <string-name><surname>Mladenov</surname> <given-names>V</given-names></string-name>, <string-name><surname>Ivanov</surname> <given-names>PC</given-names></string-name>, editors. <conf-name>Nonlinear Dynamics of Electronic Systems: 22nd International Conference, NDES 2014, Albena, Bulgaria, July 4-6, 2014 Proceedings</conf-name>. <publisher-name>Springer International Publishing Switzerland</publisher-name>; <year>2014</year>. pp. <fpage>379</fpage>&#x2013;<lpage>386</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Hyrkas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Clayton</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ribalet</surname> <given-names>F</given-names></string-name>, <string-name><surname>Halperin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Virginia Armbrust</surname> <given-names>E</given-names></string-name>, <string-name><surname>Howe</surname> <given-names>B</given-names></string-name>. <article-title>Scalable clustering algorithms for continuous environmental flow cytometry</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>32</volume>: <fpage>417</fpage>&#x2013;<lpage>423</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv594</pub-id></mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Field</surname> <given-names>CB</given-names></string-name>, <string-name><surname>Behrenfeld</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Randerson</surname> <given-names>JT</given-names></string-name>, <string-name><surname>Falkowski</surname> <given-names>PG</given-names></string-name>. <article-title>Primary production of the biosphere: Integrating terrestrial and oceanic components</article-title>. <source>Science</source>. <year>1998</year>;<volume>281</volume>: <fpage>237</fpage>&#x2013;<lpage>240</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Litchman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Klausmeier</surname> <given-names>CA</given-names></string-name>. <article-title>Trait-based community ecology of phytoplankton</article-title>. <source>Annu Rev Ecol Evol Syst</source>. <year>2008</year>;<volume>39</volume>: <fpage>615</fpage>&#x2013;<lpage>639</lpage>. doi:<pub-id pub-id-type="doi">10.1146/annurev.ecolsys.39.110707.173549</pub-id></mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Edwards</surname> <given-names>KF</given-names></string-name>, <string-name><surname>Thomas</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Klausmeier</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Litchman</surname> <given-names>E</given-names></string-name>. <article-title>Allometric scaling and taxonomic variation in nutrient utilization traits and maximum growth rate of phytoplankton</article-title>. <source>Limnol Oceanogr</source>. <year>2012</year>;<volume>57</volume>: <fpage>554</fpage>&#x2013;<lpage>566</lpage>. doi:<pub-id pub-id-type="doi">10.4319/lo.2012.57.2.0554</pub-id></mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Edwards</surname> <given-names>KF</given-names></string-name>, <string-name><surname>Thomas</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Klausmeier</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Litchman</surname> <given-names>E</given-names></string-name>. <article-title>Light and growth in marine phytoplankton: allometric, taxonomic, and environmental variation</article-title>. <source>Limnol Oceanogr</source>. <year>2015</year>;<volume>60</volume>: <fpage>540</fpage>&#x2013;<lpage>552</lpage>. doi:<pub-id pub-id-type="doi">10.1002/lno.10033</pub-id></mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Sun</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>D</given-names></string-name>. <article-title>Geometric models for calculating cell biovolume and surface area for phytoplankton</article-title>. <source>J Plankton Res</source>. <year>2003</year>;<volume>25</volume>: <fpage>1331</fpage>&#x2013;<lpage>1346</lpage>. doi:<pub-id pub-id-type="doi">10.1093/plankt/fbg096</pub-id></mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Foladori</surname> <given-names>P</given-names></string-name>, <string-name><surname>Quaranta</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ziglio</surname> <given-names>G</given-names></string-name>. <article-title>Use of silica microspheres having refractive index similar to bacteria for conversion of flow cytometric forward light scatter into biovolume</article-title>. <source>Water Res</source>. <year>2008</year>;<volume>42</volume>: <fpage>3757</fpage>&#x2013;<lpage>3766</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.watres.2008.06.026</pub-id></mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="book"><string-name><surname>Reynolds</surname> <given-names>CS</given-names></string-name>. <chapter-title>The ecology of phytoplankton</chapter-title>. <publisher-name>Cambridge University Press</publisher-name>; <year>2006</year>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="book"><string-name><surname>Steinberg</surname> <given-names>CEW</given-names></string-name>, <string-name><surname>Sch&#x00E4;fer</surname> <given-names>H</given-names></string-name>, <string-name><surname>Siedler</surname> <given-names>M</given-names></string-name>, <string-name><surname>Beisker</surname> <given-names>W</given-names></string-name>. <chapter-title>Ataxonomic assessment of phytoplankton integrity by means of flow cytometry</chapter-title>. In: <string-name><surname>Seiler</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Kroftov&#x00E1;</surname> <given-names>O</given-names></string-name>, <string-name><surname>Eybl</surname> <given-names>V</given-names></string-name>, editors. <source>Toxicology - From Cells to Man</source>. <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>; <year>1996</year>. pp. <fpage>417</fpage>&#x2013;<lpage>434</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Ge</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Sealfon</surname> <given-names>SC</given-names></string-name>. <article-title>Flowpeaks: A fast unsupervised clustering for flow cytometry data via K-means and density peak finding</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>2052</fpage>&#x2013;<lpage>2058</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts300</pub-id></mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Breiman</surname> <given-names>L</given-names></string-name>. <article-title>Random Forests</article-title>. <source>Mach Learn</source>. <year>1999</year>;<volume>45</volume>: <fpage>1</fpage>&#x2013;<lpage>35</lpage>. doi:<pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="book"><string-name><surname>Jain</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Dubes</surname> <given-names>RC</given-names></string-name>. <chapter-title>Algorithms for clustering data</chapter-title>. <publisher-name>Prentice-Hall, Inc</publisher-name>.; <year>1988</year>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Jain</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Murty</surname> <given-names>MN</given-names></string-name>, <string-name><surname>Flynn</surname> <given-names>PJ</given-names></string-name>. <article-title>Data clustering: A review</article-title>. <source>ACM Comput Surv</source>. <year>1999</year>;<volume>31</volume>: <fpage>264</fpage>&#x2013;<lpage>323</lpage>. doi:<pub-id pub-id-type="doi">10.1145/331499.331504</pub-id></mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="other"><string-name><surname>Thomas</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Fontana</surname> <given-names>S</given-names></string-name>, <string-name><surname>Reyes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pomati</surname> <given-names>F</given-names></string-name>. <source>Dataset: Quantifying cell densities and biovolumes of phytoplankton communities and functional groups using scanning flow cytometry, machine learning and unsupervised clustering</source>. <year>2017</year>. doi:<pub-id pub-id-type="doi">10.5281/zenodo.977772</pub-id>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.977772">https://doi.org/10.5281/zenodo.977772</ext-link></mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="other"><string-name><surname>Thomas</surname> <given-names>MK</given-names></string-name>. <source>R Code: Cleaning and clustering SFCM data</source>. <year>2017</year>. doi:<pub-id pub-id-type="doi">10.5281/zenodo.999747</pub-id>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.999747">https://doi.org/10.5281/zenodo.999747</ext-link></mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A language and environment for statistical computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>; <year>2017</year>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Uterm&#x00F6;hl</surname> <given-names>H von</given-names></string-name>. <article-title>Neue Wege in der quantitativen Erfassung des Planktons. (Mit besondere Beriicksichtigung des Ultraplanktons)</article-title>. <source>Verhandlungen der Int Vereinigung f&#x00FC;r Theor und Angew Limnol</source>. <year>1931</year>;<volume>5</volume>: <fpage>567</fpage>&#x2013;<lpage>596</lpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Litchman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Klausmeier</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Schofield</surname> <given-names>OME</given-names></string-name>, <string-name><surname>Falkowski</surname> <given-names>PG</given-names></string-name>. <article-title>The role of functional traits and trade-offs in structuring phytoplankton communities: Scaling from cellular to ecosystem level</article-title>. <source>Ecol Lett</source>. <year>2007</year>;<volume>10</volume>: <fpage>1170</fpage>&#x2013;<lpage>81</lpage>. doi:<pub-id pub-id-type="doi">10.1111/j.1461-0248.2007.01117.x</pub-id></mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Liaw</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wiener</surname> <given-names>M</given-names></string-name>. <article-title>Classification and Regression by randomForest</article-title>. <source>R News</source>. <year>2002</year>;<volume>2</volume>: <fpage>18</fpage>&#x2013;<lpage>22</lpage>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Stoop</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kanders</surname> <given-names>K</given-names></string-name>, <string-name><surname>Lorimer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Held</surname> <given-names>J</given-names></string-name>, <string-name><surname>Albert</surname> <given-names>C</given-names></string-name>. <article-title>Big data naturally rescaled</article-title>. <source>Chaos, Solitons and Fractals</source>. <year>2016</year>;<volume>90</volume>: <fpage>81</fpage>&#x2013;<lpage>90</lpage>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Parsons</surname> <given-names>L</given-names></string-name>, <string-name><surname>Parsons</surname> <given-names>L</given-names></string-name>, <string-name><surname>Haque</surname> <given-names>E</given-names></string-name>, <string-name><surname>Haque</surname> <given-names>E</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>H</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>H</given-names></string-name>. <article-title>Subspace clustering for high dimensional data: A review</article-title>. <source>ACM SIGKDD Explor Newsl</source>. <year>2004</year>;<volume>6</volume>: <fpage>90</fpage>&#x2013;<lpage>105</lpage>. doi:<pub-id pub-id-type="doi">10.1145/1007730.1007731</pub-id></mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Aghaeepour</surname> <given-names>N</given-names></string-name>, <string-name><surname>Finak</surname> <given-names>G</given-names></string-name>, <string-name><surname>Dougall</surname> <given-names>D</given-names></string-name>, <string-name><surname>Khodabakhshi</surname> <given-names>AH</given-names></string-name>, <string-name><surname>Mah</surname> <given-names>P</given-names></string-name>, <string-name><surname>Obermoser</surname> <given-names>G</given-names></string-name>, <etal>et al.</etal> <article-title>Critical assessment of automated flow cytometry data analysis techniques</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>228</fpage>&#x2013;<lpage>238</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2365</pub-id></mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Ester</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kriegel</surname> <given-names>HP</given-names></string-name>, J S, <string-name><surname>Xu</surname> <given-names>X</given-names></string-name>. <article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. <source>KDD</source>. <year>1996</year>;<fpage>96</fpage>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Newell</surname> <given-names>EW</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>Y</given-names></string-name>. <article-title>Mass cytometry: Blessed with the curse of dimensionality</article-title>. <source>Nat Immunol. Nature Publishing Group</source>; <year>2016</year>;<volume>17</volume>: <fpage>890</fpage>&#x2013;<lpage>5</lpage>. doi:<pub-id pub-id-type="doi">10.1038/ni.3485</pub-id></mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Balfoort</surname> <given-names>HW</given-names></string-name>, <string-name><surname>Snoek</surname> <given-names>J</given-names></string-name>, <string-name><surname>Smiths</surname> <given-names>JRM</given-names></string-name>, <string-name><surname>Breedveld</surname> <given-names>LW</given-names></string-name>, <string-name><surname>Hofstraat</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Ringelberg</surname> <given-names>J</given-names></string-name>. <article-title>Automatic identification of algae: Neural network analysis of flow cytometric data</article-title>. <source>J Plankton Res</source>. <year>1992</year>;<volume>14</volume>: <fpage>575</fpage>&#x2013;<lpage>589</lpage>. doi:<pub-id pub-id-type="doi">10.1093/plankt/14.4.575</pub-id></mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Boddy</surname> <given-names>L</given-names></string-name>, <string-name><surname>Morris</surname> <given-names>CW</given-names></string-name>, <string-name><surname>Wilkins</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Al-Haddad</surname> <given-names>L</given-names></string-name>, <string-name><surname>Tarran</surname> <given-names>G a</given-names></string-name>, <string-name><surname>Jonker</surname> <given-names>RR</given-names></string-name>, <etal>et al.</etal> <article-title>Identification of 72 phytoplankton species by radial basis function neural network analysis of flow cytometric data</article-title>. <source>Mar Ecol Prog Ser</source>. <year>2000</year>;<volume>195</volume>: <fpage>47</fpage>&#x2013;<lpage>59</lpage>. doi:<pub-id pub-id-type="doi">10.3354/meps195047</pub-id></mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Boddy</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wilkins</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Morris</surname> <given-names>CW</given-names></string-name>. <article-title>Pattern recognition in flow cytometry</article-title>. <source>Cytometry</source>. <year>2001</year>;<volume>44</volume>: <fpage>195</fpage>&#x2013;<lpage>209</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>