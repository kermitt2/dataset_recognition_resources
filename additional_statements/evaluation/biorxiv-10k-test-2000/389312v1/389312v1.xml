<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/389312</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>RNAmountAlign: efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2404-7893</contrib-id>
<name><surname>Bayegan</surname><given-names>Amir H</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3628-2874</contrib-id>
<name><surname>Clote</surname><given-names>Peter</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Biology Department, Boston College</institution>, Chestnut Hill, MA 02467, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="other"><label>&#x002A;</label><p><email>clote@bc.edu</email></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>389312</elocation-id>
<history>
<date date-type="received"><day>10</day><month>8</month><year>2018</year></date>
<date date-type="rev-recd"><day>10</day><month>8</month><year>2018</year></date>
<date date-type="accepted"><day>10</day><month>8</month><year>2018</year></date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="389312.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Alignment of structural RNAs is an important problem with a wide range of applications. Since function is often determined by molecular structure, RNA alignment programs should take into account both sequence and base-pairing information for structural homology identification. A number of successful alignment programs are heuristic versions of Sankoff&#x2019;s optimal algorithm. Most of them require <italic>O</italic>(<italic>n</italic><sup>4</sup>) run time. This paper describes <monospace>C&#x002B;&#x002B;</monospace> software, <monospace>RNAmountAlign</monospace>, for RNA sequence/structure alignment that runs in <italic>O</italic>(<italic>n</italic><sup>3</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space; moreover, our software returns a <italic>p</italic>-value (transformable to expect value <italic>E</italic>) based on Karlin-Altschul statistics for local alignment, as well as parameter fitting for local and global alignment. Using incremental mountain height, a representation of structural information computable in cubic time, <monospace>RNAmountAlign</monospace> implements quadratic time pairwise local, global and global/semiglobal (query search) alignment using a weighted combination of sequence and structural similarity. <monospace>RNAmountAlign</monospace> is capable of performing progressive multiple alignment as well. Benchmarking of <monospace>RNAmountAlign</monospace> against <monospace>LocARNA, LARA, FOLDALIGN, DYNALIGN</monospace> and <monospace>STRAL</monospace> shows that <monospace>RNAmountAlign</monospace> has reasonably good accuracy and much faster run time supporting all alignment types.</p>
<sec>
<title>Availability</title>
<p><monospace>RNAmountAlign</monospace> is publicly available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAmountAlign">http://bioinformatics.bc.edu/clotelab/RNAmountAlign</ext-link>.</p>
</sec>
</abstract>
<counts>
<page-count count="22"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>A number of different metrics exist for comparison of RNA secondary structures, including base pair distance (BP), string edit distance (SE) [<xref ref-type="bibr" rid="c1">1</xref>], mountain distance (MD) [<xref ref-type="bibr" rid="c2">2</xref>], tree edit distance (TE) [<xref ref-type="bibr" rid="c3">3</xref>], coarse tree edit distance (HTE) [<xref ref-type="bibr" rid="c4">4</xref>], morphological distance [<xref ref-type="bibr" rid="c5">5</xref>] and a few other metrics. In what appears to be the most comprehensive published comparison of various secondary structure metrics [<xref ref-type="bibr" rid="c6">6</xref>], it was shown that all of these distance measures are highly correlated when computing distances between structures taken from the Boltzmann low-energy ensemble of secondary structures [<xref ref-type="bibr" rid="c7">7</xref>] for the same RNA sequence &#x2013; so-called <italic>intra-ensemble</italic> correlation. In contrast, these distance measures have low correlation when computing distances between structures taken from Boltzmann ensembles of different RNA sequences of the same length &#x2013; so-called <italic>inter-ensemble</italic> correlation. For instance, the intra-ensemble correlation between base pair distance (BP) and mountain distance (MD) is 0.822, while the corresponding inter-ensemble correlation drops to 0.210. Intra-ensemble correlation between string edit distance (SE) and the computationally more expensive tree edit distance (TE) is 0.975, while the corresponding intra-ensemble correlation drops to 0.590 &#x2013; see <xref ref-type="table" rid="tbl1">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Correlation between various secondary structure metrics, as computed in [<xref ref-type="bibr" rid="c6">6</xref>]: base pair distance (BP), string edit distance (SE) [<xref ref-type="bibr" rid="c1">1</xref>], mountain distance (MD) [<xref ref-type="bibr" rid="c2">2</xref>], tree edit distance (TE) [<xref ref-type="bibr" rid="c3">3</xref>] and coarse tree edit distance (HTE) [<xref ref-type="bibr" rid="c4">4</xref>]. Lower triangular values indicate intra-ensemble correlations; upper triangular values indicate inter-ensemble correlations. Table values are taken from [<xref ref-type="bibr" rid="c6">6</xref>].</p></caption>
<graphic xlink:href="389312_tbl1.tif"/>
</table-wrap>
<p>Due to poor inter-ensemble correlation of RNA secondary structure metrics, and the fact that most secondary structure pairwise alignment algorithms depend essentially on some form of base pair distance, string edit distance, or free energy of common secondary structure, we have developed the first RNA sequence/structure pairwise alignment algorithm that is based on (incremental ensemble) mountain distance. Our software, <monospace>RNAmountAlign</monospace>, uses this distance measure, since the Boltzmann ensemble of all secondary structures of a given RNA of length <italic>n</italic> can represented as a length <italic>n</italic> vector of real numbers, thus allowing an adaptation of fast sequence alignment methods. Depending on the command-line flag given, our software, <monospace>RNAmountAlign</monospace> can perform pairwise alignment, (Needleman-Wunsch global [<xref ref-type="bibr" rid="c8">8</xref>], Smith-Waterman local [<xref ref-type="bibr" rid="c9">9</xref>] or semiglobal [<xref ref-type="bibr" rid="c10">10</xref>] alignment) as well as progressive multiple alignment (global and local), computed using a guide tree as in <monospace>CLUSTAL</monospace> [<xref ref-type="bibr" rid="c11">11</xref>]. Expect values <italic>E</italic> for local alignments are computed using Karlin-Altschul extreme-value statistics [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c13">13</xref>], suitably modified to account for our new sequence/structure similarity measure. Additionally, <monospace>RNAmountAlign</monospace> can determine <italic>p</italic>-values (hence <italic>E</italic>-values) by parameter fitting for the normal (ND), extreme value (EVD) and gamma (GD) distributions.</p>
<p>We benchmark the performance of <monospace>RNAmountAlign</monospace> on pairwise and multiple global sequence/structure alignment of RNAs against the widely used programs <monospace>LARA, FOLDALIGN, DYNALIGN, LocARNA</monospace> and <monospace>STRAL. LARA</monospace> (Lagrangian relaxed structural alignment) [<xref ref-type="bibr" rid="c14">14</xref>] formulates the problem of RNA (multiple) sequence/structure alignment as a problem in integer linear programming (ILP), then computes optimal or near-optimal solutions to this problem. The software <monospace>FOLDALIGN</monospace> [<xref ref-type="bibr" rid="c15">15</xref>-<xref ref-type="bibr" rid="c17">17</xref>], and <monospace>DYNALIGN</monospace> [<xref ref-type="bibr" rid="c18">18</xref>] are different <italic>O</italic>(<italic>n</italic><sup>4</sup>) approximate implementations of Sankoff&#x2019;s <italic>O</italic>(<italic>n</italic><sup>6</sup>) optimal RNA sequence/structure alignment algorithm. <monospace>FOLDALIGN</monospace> sets limits on the maximum length of the alignment as well as the maximum distance between subsequences being aligned in order to reduce the time complexity of the Sankoff algorithm. <monospace>DYNALIGN</monospace> [<xref ref-type="bibr" rid="c18">18</xref>] implements pairwise RNA secondary structural alignment by determining the common structure to both sequences that has lowest free energy, using a positive (destabilizing) energy heuristic for gaps introduced, in addition to setting bounds on the distance between subsequences being aligned. In particular, the only contribution from nucleotide information in <monospace>Dynalign</monospace> is from the nucleotide-dependent free energy parameters for base stacking, dangles, etc. <monospace>LocARNA</monospace> (local alignment of RNA) [<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c20">20</xref>] is a heuristic implementation of <monospace>PMcomp</monospace> [<xref ref-type="bibr" rid="c21">21</xref>] which compares the base pairing probability matrices computed by McCaskill&#x2019;s algorithm. Although the software is not maintained, <monospace>STRAL</monospace> [<xref ref-type="bibr" rid="c22">22</xref>] which is similar to our approach, uses up- and downstream base pairing probabilities as the structural information and combines them with sequence similarity in a weighted fashion.</p>
<p><monospace>LARA, mLocARNA</monospace> (extension of <monospace>LocARNA</monospace>), <monospace>FOLDALIGNM</monospace> [<xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c23">23</xref>] (extension of <monospace>FOLDALIGN</monospace>), <monospace>Multilign</monospace> [<xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c25">25</xref>] (extension of <monospace>DYNALIGN</monospace>) and <monospace>STRAL</monospace> support multiple alignment. <monospace>LARA</monospace> computes all pairwise sequence alignments and subsequently uses the <monospace>T-Coffee</monospace> package [<xref ref-type="bibr" rid="c26">26</xref>] to construct multiple alignments. Both <monospace>FOLDALIGNM</monospace> and <monospace>mLocARNA</monospace> implement progressive alignment of consensus base pairing probability matrices using a guide tree similar to the approach of <monospace>PMmulti</monospace> [<xref ref-type="bibr" rid="c21">21</xref>]. For a set of given sequences, <monospace>Multilign</monospace> uses <monospace>DYNALIGN</monospace> to compute the pairwise alignment of a single fixed index sequence to each other sequence in the set, and computes a consensus structure. In each pairwise alignment, only the index sequence base pairs found in previous computations are used. More iterations in the same manner with the same index sequence are then used to improve the structure prediction of other sequences. The number of pairwise alignments in <monospace>Multilign</monospace> is linear with respect to the number of sequences. <monospace>STRAL</monospace> performs multiple alignment in a fashion similar to <monospace>CLASTALW</monospace> [<xref ref-type="bibr" rid="c27">27</xref>]. <xref ref-type="table" rid="tbl2">Table 2</xref> provides an overview of various features, to the best of our knowledge, supported by the software benchmarked in this paper.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>Overview of features in software used in benchmarking tests, where &#x2713; [resp. &#x2014;] indicates the presence [resp. absence] of said feature, to the best of our knowledge. Average F1 [resp. SPS] scores for the pairwise [resp. multiple] global alignment are given, computed as explained in the text.</p></caption>
<graphic xlink:href="389312_tbl2.tif"/>
</table-wrap>
<p><monospace>RNAmountAlign</monospace> can perform semiglobal alignments in addition to global and local alignments. As in the RNA tertiary structural alignment software <monospace>DIAL</monospace> [<xref ref-type="bibr" rid="c28">28</xref>], semiglobal alignment allows the user to perform a query search, where the query is entirely matched to a local portion of the target. Quadratic time alignment using affine gap cost is implemented in <monospace>RNAmountAlign</monospace> using the Gotoh method [<xref ref-type="bibr" rid="c29">29</xref>] with the following pseudocode, shown for the case of semiglobal alignment. Let <italic>g</italic>(<italic>k</italic>) denote an affine cost for size <italic>k</italic> gap, defined by <italic>g</italic>(0) &#x003D; 0 and <italic>g</italic>(<italic>k</italic>) &#x003D; <italic>g<sub>i</sub></italic> &#x002B; (<italic>k</italic> &#x2013; 1) &#x00B7; <italic>g<sub>e</sub></italic> for positive gap initiation [resp. extension] costs <italic>g<sub>i</sub></italic> [resp. <italic>g<sub>e</sub></italic>]. For query <bold>a</bold> &#x003D; <italic>a</italic><sub>1</sub>,&#x2026;, <italic>a<sub>n</sub></italic> and target <bold>b</bold> &#x003D; <italic>b</italic><sub>1</sub>,&#x2026;, <italic>b<sub>m</sub></italic>, define (<italic>n</italic> &#x002B; 1) &#x00D7; (<italic>m</italic> &#x002B; 1) matrices <italic>M, P, Q</italic> as follows: <italic>M</italic><sub><italic>i</italic>,0</sub> &#x003D; <italic>g</italic>(<italic>i</italic>) for all 1 &#x2264; <italic>i</italic> &#x2264; <italic>n</italic>, <italic>M</italic><sub>0,<italic>j</italic></sub> &#x003D; 0 for all 1 &#x2264; <italic>j</italic> &#x2264; <italic>m</italic>, while for positive <italic>i, j</italic> we have <italic>M<sub>i,j</sub></italic> &#x003D; max (<italic>M</italic><sub><italic>i</italic>&#x2013;1,<italic>j</italic>&#x2013;1</sub> &#x002B; sim (<italic>a<sub>i</sub></italic>, <italic>b<sub>j</sub></italic>), <italic>P<sub>i,j</sub></italic>, <italic>Q<sub>i,j</sub></italic>). For 1 &#x2264; <italic>i</italic> &#x2264; <italic>n</italic>, 1 &#x2264; <italic>j</italic> &#x2264; <italic>m</italic>, let <italic>P</italic><sub>0,<italic>j</italic></sub> &#x003D; 0 and <italic>P<sub>i,j</sub></italic> &#x003D; max (<italic>M</italic><sub><italic>i</italic>&#x2013;1,<italic>j</italic></sub> &#x002B; <italic>g<sub>i</sub></italic>, <italic>P</italic><sub><italic>i</italic>&#x2013;1,<italic>j</italic></sub> &#x002B; <italic>g<sub>e</sub></italic>), and define <italic>Q</italic><sub><italic>i</italic>,0</sub> &#x003D; 0 and <italic>Q<sub>i,j</sub></italic> &#x003D; max (<italic>M</italic><sub><italic>i,j</italic>&#x2013;1</sub> &#x002B; <italic>g<sub>i</sub></italic>, <italic>Q</italic><sub><italic>i,j</italic>&#x2013;1</sub> &#x002B; <italic>g<sub>e</sub></italic>, 0). Determine the maximum semiglobal alignment score in row <italic>n</italic>, then perform backtracking to obtain an optimal semiglobal (or query search) alignment.</p>
<p>In this paper we provide a very fast, comprehensive software package capable of pairwise/multiple local/global/semiglobal alignment with <italic>p</italic>-values and <italic>E</italic>-values for statistical significance. Moreover, due to its speed and relatively good accuracy, the software can be used for whole-genome searches for homologues of a given orphan RNA as query. This is in contrast to <monospace>Infernal</monospace> [<xref ref-type="bibr" rid="c30">30</xref>], which requires a multiple alignment to construct a covariance model for whole-genome searches.</p>
</sec>
<sec id="s2">
<title>Materials and methods</title>
<sec id="s2a">
<title>Incremental ensemble expected mountain height</title>
<p>Introduced in [<xref ref-type="bibr" rid="c31">31</xref>], the <italic>mountain height</italic><sup>1</sup> <italic>h<sub>s</sub></italic>(<italic>k</italic>) of secondary structure <italic>s</italic> at position <italic>k</italic> is defined as the number of base pairs in <italic>s</italic> that lie between an external loop and <italic>k</italic>, formally given by
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="389312_eqn1.gif"/></alternatives>
</disp-formula></p>
<p>The <italic>ensemble mountain height</italic> &#x2329;<italic>h</italic>(<italic>k</italic>)&#x232A; [<xref ref-type="bibr" rid="c32">32</xref>] for RNA sequence <bold>a</bold> &#x003D; <italic>a</italic><sub>1</sub>,&#x2026;,<italic>a<sub>n</sub></italic> at position <italic>k</italic> is defined as the average mountain height, where the average is taken over the Boltzmann ensemble of all low-energy structures <italic>s</italic> of sequence <bold>a</bold>. If base pairing probabilities <italic>p<sub>i,j</sub></italic> have been computed, then it follows that
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="389312_eqn2.gif"/></alternatives>
</disp-formula>
and hence the <italic>incremental ensemble mountain height</italic>, which for values 1 &#x003C; <italic>k</italic> &#x2264; <italic>n</italic> is defined by <italic>m</italic><sub>a</sub>(<italic>k</italic>) &#x003D; &#x2329;<italic>h</italic>(<italic>k</italic>)&#x232A; &#x2013; &#x2329;<italic>h</italic>(<italic>k</italic> &#x2013; 1)&#x232A; can be readily computed by
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="389312_eqn3.gif"/></alternatives>
</disp-formula></p>
<p>It is clear that &#x2014;1 &#x2264; <italic>m</italic><sub>a</sub>(<italic>k</italic>) &#x2264; 1, and that both ensemble mountain height and incremental ensemble mountain height can be computed in time that is quadratic in sequence length <italic>n</italic>, provided that base pairing probabilities <italic>p<sub>i,j</sub></italic> have been computed. Except for the cubic time taken by a function call of <monospace>RNAfold</monospace> from Vienna RNA package [<xref ref-type="bibr" rid="c4">4</xref>], the software <monospace>RNAmountAlign</monospace> has quadratic time and space requirements. <xref ref-type="fig" rid="fig1">Figure 1</xref> depicts a global alignment of two transfer RNAs, computed by <monospace>RNAmountAlign</monospace>, shown as superimposed ensemble mountain height displays with gaps.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig 1.</label>
<caption><p>Ensemble mountain heights of 72 nt tRNA AL671879.2 and 69 nt tRNA D16387.1, aligned together by <monospace>RNAmountAlign</monospace>. Since the <monospace>BRAliBase 2.1 K2</monospace> reference (pairwise) alignment [<xref ref-type="bibr" rid="c33">33</xref>] has only 28&#x0025; sequence identity, structural similarity parameter <italic>&#x03B3;</italic> was set to 1 in our software <monospace>RNAmountAlign</monospace>, which returned the correct alignment. See Methods section for explanation of <italic>&#x03B3;</italic> and the algorithm used by <monospace>RNAmountAlign</monospace>.</p></caption>
<graphic xlink:href="389312_fig1.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Transforming distance into similarity</title>
<p>In [<xref ref-type="bibr" rid="c34">34</xref>], Seller&#x2019;s (distance-based) global pairwise alignment algorithm [<xref ref-type="bibr" rid="c35">35</xref>] was rigorously shown to be equivalent to Needleman and Wunsch&#x2019;s (similarity-based) global pairwise alignment algorithm [<xref ref-type="bibr" rid="c8">8</xref>]. Recalling that Seller&#x2019;s alignment distance is defined as the minimum, taken over all alignments of the sum of distances <italic>d</italic>(<italic>x, y</italic>) between aligned nucleotides <italic>x, y</italic> plus the sum of (positive) weights <italic>w</italic>(<italic>k</italic>) for size <italic>k</italic> gaps, while Needleman-Wunsch alignment similarity is defined as the maximum, taken over all alignments of the sum of similarities <italic>s</italic>(<italic>x, y</italic>) between aligned nucleotides <italic>x, y</italic> plus the sum of (negative) gap weights <italic>g</italic>(<italic>k</italic>) for size <italic>k</italic> gaps, Smith and Waterman [<xref ref-type="bibr" rid="c34">34</xref>] show that by defining
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="389312_eqn4.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="389312_eqn5.gif"/></alternatives>
</disp-formula>
and by taking the minimum distance, rather than maximum similarity, the Needleman-Wunsch algorithm is transformed into Seller&#x2019;s algorithm. Though formulated here for RNA nucleotides, equivalence holds over arbitrary alphabets and similarity measures (e.g. BLOSUM62).</p>
<p>For <italic>x, y</italic> &#x2208; &#x007B; (,&#x2022;,) &#x007D; from <xref ref-type="disp-formula" rid="eqn3">Eq (3)</xref> we have
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="389312_eqn6.gif"/></alternatives>
</disp-formula></p>
<p>Define the distance <italic>d</italic><sub>0</sub>(<italic>x, y</italic>) between characters <italic>x, y</italic> in the dot-bracket representation of a secondary structure by
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="389312_eqn7.gif"/></alternatives>
</disp-formula></p>
<p>Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline1.gif"/></alternatives></inline-formula> denote an alignment between two arbitrary secondary structures <italic>s, t</italic> of (possibly different) lengths <italic>n, m</italic>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline2.gif"/></alternatives></inline-formula> and &#x2013; denotes the gap symbol. We define the <italic>structural alignment distance</italic> for <italic>A</italic> by summing <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline3.gif"/></alternatives></inline-formula> over those positions <italic>i</italic> where neither character <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline4.gif"/></alternatives></inline-formula> is a gap symbol, then adding <italic>w</italic>(<italic>k</italic>) for all size <italic>k</italic> gaps in <italic>A</italic>. Using previous definitions of incremental ensemble expected mountain height from <xref ref-type="disp-formula" rid="eqn3">Eq (3)</xref>, we can generalize structural alignment distance from the simple case of comparing two dot-bracket representations of secondary structures to the more representative case of comparing the low-energy Boltzmann ensemble of secondary structures for RNA sequence <bold>a</bold> to that of RNA sequence <bold>b</bold>. Given sequences <bold>a</bold> = <italic>a</italic><sub>1</sub>,&#x2026;, <italic>a<sub>n</sub></italic> and <bold>b</bold> = <italic>b</italic><sub>1</sub>,&#x2026;,<italic>b<sub>m</sub></italic>, let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline5.gif"/></alternatives></inline-formula> denote an alignment between the incremental ensemble expected mountain height <italic>m</italic><sub>a</sub>(1) &#x00B7;&#x00B7;&#x00B7; <italic>m</italic><sub>a</sub>(<italic>n</italic>) of <bold>a</bold> and and the ensemble incremental expected mountain height <italic>m</italic><sub>b</sub>(1) &#x00B7;&#x00B7;&#x00B7; <italic>m</italic><sub>b</sub>(<italic>m</italic>) of <bold>b</bold>. Generalize structural distance <italic>d</italic><sub>0</sub> defined in <xref ref-type="disp-formula" rid="eqn7">Eq (7)</xref> to <italic>d</italic><sub>1</sub> defined by <italic>d</italic><sub>1</sub>(<italic>a<sub>i</sub></italic>, <italic>b<sub>j</sub></italic>) &#x003D; |<italic>m<sub>a</sub></italic>(<italic>i</italic>) &#x2013; <italic>m<sub>b</sub></italic>(<italic>j</italic>)|, where <italic>m<sub>a</sub></italic>(<italic>i</italic>) and <italic>m<sub>b</sub></italic>(<italic>j</italic>) are real numbers in the interval [&#x2013;1, 1], and define <italic>ensemble structural alignment distance</italic> for <italic>A</italic> by summing <italic>d</italic><sub>1</sub>(<italic>a<sub>i</sub></italic>,<italic>b<sub>j</sub></italic>) over all positions <italic>i, j</italic> for which neither character is a gap symbol, then adding positive weight <italic>w</italic>(<italic>k</italic>) for all size <italic>k</italic> gaps. By <xref ref-type="disp-formula" rid="eqn4">Eq (4)</xref> and <xref ref-type="disp-formula" rid="eqn5">Eq (5)</xref>, it follows that an equivalent <italic>ensemble structural similarity</italic> measure between two positions <italic>a<sub>i</sub></italic>, <italic>b<sub>j</sub></italic>, denoted <italic>STRSIM</italic>(<italic>a<sub>i</sub>, b<sub>j</sub></italic>), is obtained by multiplying <italic>d</italic><sub>1</sub> and <italic>w</italic>(<italic>k</italic>) by &#x2013;1:
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="389312_eqn8.gif"/></alternatives>
</disp-formula></p>
<p>This equation will be used later, since our algorithm <monospace>RNAmountAlign</monospace> combines both sequence and ensemble structural similarity. Indeed, &#x2013;|<italic>m<sub>a</sub></italic>(<italic>i</italic>) &#x2013; <italic>m<sub>b</sub></italic>(<italic>j</italic>)| &#x2208; [&#x2013;2, 0] with maximum value of 0 while RIB0SUM85-60, shown in <xref ref-type="table" rid="tbl3">Table 3</xref>, has similarity values in the interval [&#x2013;1.86, 2.22]. In order to combine sequence with structural similarity, both ranges should be rendered comparable as shown in the next section.</p>
</sec>
<sec id="s2c">
<title>Pairwise alignment</title>
<p>In order to combine sequence and ensemble structural similarity, we determine a multiplicative scaling factor <italic>&#x03B1;</italic><sub>seq</sub> and an additive shift factor <italic>&#x03B1;</italic><sub>str</sub> such that the mean and standard deviation for the distribution of sequence similarity values from a RIBOSUM matrix [<xref ref-type="bibr" rid="c36">36</xref>] (after being multiplied by <italic>&#x03B1;</italic><sub>seq</sub>) are equal to the mean and standard deviation for the distribution of structural similarity values from STRSIM (after additive shift of <italic>&#x03B1;</italic><sub>str</sub>). The RIB0SUM85-60 nucleotide similarity matrix used in this paper is given in <xref ref-type="table" rid="tbl3">Table 3</xref>, and the distributions for RIBOSUM and STRSIM values are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> for the 72 nt transfer RNA AL671879.2. Given query [resp. target] nucleotide frequencies <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline6.gif"/></alternatives></inline-formula> that sum to 1, the mean <italic>&#x03BC;</italic><sub>seq</sub> and standard deviation <italic>&#x03C3;</italic><sub>seq</sub> of RIBOSUM nucleotide similarities can be computed by
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><p>RIB0SUM85-60 similarity matrix for RNA nucleotides from [<xref ref-type="bibr" rid="c36">36</xref>].</p></caption>
<graphic xlink:href="389312_tbl3.tif"/>
</table-wrap>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>FIG. 2.</label>
<caption><p>For 72 nt tRNA query sequence AL671879.2, nucleotide frequencies are approximately <italic>p<sub>A</sub></italic> &#x003D; 0.167, <italic>p<sub>C</sub></italic> &#x003D; 0.278, <italic>p<sub>G</sub></italic> &#x003D; 0.333, <italic>p<sub>U</sub></italic> &#x003D; 0.222, and for 69 nt tRNA target sequence D16498.1, nucleotide frequencies are approximately <italic>p<sub>A</sub></italic> &#x003D; 0.377, <italic>p<sub>C</sub></italic> &#x003D; 0.174, <italic>p<sub>G</sub></italic> &#x003D; 0.174, <italic>p<sub>U</sub></italic> &#x003D; 0.275. From the base pairing probabilities computed by <monospace>RNAfold -p</monospace>, we have query frequencies <italic>p</italic> ( &#x003D; 0.3035, <italic>p</italic>&#x2022; &#x003D; 0.3930, <italic>p</italic>) &#x003D; 0.3035 and target frequencies <italic>p</italic> ( &#x003D; 0.2835, <italic>p</italic>&#x2022; &#x003D; 0.433, <italic>p</italic>) &#x003D; 0.2835, so by Eqs (9,10,11,12), we have <italic>&#x03BC;</italic><sub>seq</sub> &#x003D; &#x2013;0.9098, <italic>&#x03C3;</italic><sub>seq</sub> &#x003D; 1.4117 and <italic>&#x03BC;</italic><sub>str</sub> &#x003D; &#x2013;0.8301, <italic>&#x03C3;</italic><sub>str</sub> &#x003D; 0.6968. By Eqs (13) and (14), we determine that RIBOSUM scaling factor <italic>&#x03B1;</italic><sub>seq</sub> &#x003D; 0.4936 and <italic>&#x03B1;</italic><sub>str</sub> &#x003D; 0.3810 (values shown only to 4-decimal places). Panels (a) resp. (b) show the distribution of RIBOSUM resp. STRSIM values for the nucleotide and base pairing probabilities determined from query and target, while panels (c) resp. (d) show the distribution of <italic>&#x03B1;</italic><sub>seq</sub>-scaled RIBOSUM values resp. <italic>&#x03B1;</italic><sub>str</sub>-shifted STRSIM values. It follows that distributions in panels (c) and (d) have the same (negative) mean and standard deviation.</p></caption>
<graphic xlink:href="389312_fig2.tif"/>
</fig>
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="389312_eqn9.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="389312_eqn10.gif"/></alternatives>
</disp-formula></p>
<p>Setting <italic>s</italic><sub>0</sub>(<italic>x,y</italic>) &#x003D; &#x2013;<italic>d</italic><sub>0</sub>(<italic>x,y</italic>), where <italic>d</italic><sub>0</sub>(<italic>x,y</italic>) is defined in <xref ref-type="disp-formula" rid="eqn7">Eq (7)</xref>, for given query [resp. target] base pairing probabilities <italic>p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline7.gif"/></alternatives></inline-formula>] of dot-bracket characters, it follows that the mean <italic>&#x03BC;</italic><sub>str</sub> and standard deviation <italic>&#x03C3;</italic><sub>str</sub> of structural similarities can be computed by
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="389312_eqn11.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="389312_eqn12.gif"/></alternatives>
</disp-formula></p>
<p>Now we compute a multiplicative factor <italic>&#x03B1;</italic><sub>seq</sub> and an additive shift term <italic>&#x03B1;</italic><sub>str</sub>, both dependent on frequencies <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub></italic> and <italic>p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>), such that the mean [resp. standard deviation] of nucleotide similarity multiplied by <italic>&#x03B1;</italic><sub>seq</sub> is equal to the mean [resp. standard deviation] of structural similarity after addition of shift term <italic>&#x03B1;</italic><sub>str</sub>:
<disp-formula id="eqn13">
<alternatives><graphic xlink:href="389312_eqn13.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn14">
<alternatives><graphic xlink:href="389312_eqn14.gif"/></alternatives>
</disp-formula></p>
<p>Given the query RNA <bold>a</bold> &#x003D; <italic>a</italic><sub>1</sub>,&#x2026;,<italic>a<sub>n</sub></italic> and target RNA <bold>b</bold> &#x003D; <italic>b</italic><sub>1</sub>,&#x2026;,<italic>b<sub>m</sub></italic> with incremental ensemble expected mountain heights <italic>m</italic><sub>a</sub>(1) &#x00B7;&#x00B7;&#x00B7; <italic>m</italic><sub>a</sub>(<italic>m</italic>) of <bold>a</bold>, <italic>m</italic><sub>b</sub>(1) &#x00B7;&#x00B7;&#x00B7; <italic>m</italic><sub>b</sub>(<italic>m</italic>) of <bold>b</bold>, and user-defined weight 0 &#x2264; <italic>&#x03B3;</italic> &#x2264; 1, our final similarity measure is defined by
<disp-formula id="eqn15">
<alternatives><graphic xlink:href="389312_eqn15.gif"/></alternatives>
</disp-formula>
where <italic>&#x03B1;</italic><sub>seq</sub>, <italic>&#x03B1;</italic><sub>str</sub> are computed by Eqs (13,14) depending on probabilities <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub></italic> [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline8.gif"/></alternatives></inline-formula>] and <italic>p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline9.gif"/></alternatives></inline-formula>] of the query [resp. target]. All benchmarking computations were carried out using <italic>&#x03B3;</italic> &#x003D; 1/2, although it is possible to use position-specific weight <italic>&#x03B3;<sub>i,j</sub></italic> defined as the average probability that <italic>i</italic> is paired in <bold>a</bold> and <italic>j</italic> is paired in <bold>b</bold>.</p>
<p>Our structural similarity measure is closely related to that of <monospace>STRAL</monospace>, which we discovered only after completing a preliminary version of this paper. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline10.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline11.gif"/></alternatives></inline-formula> be the probability that position <italic>i</italic> of sequence a is paired to a position on the left or right, respectively. The similarity measure used in <monospace>STRAL</monospace> is defined by
<disp-formula id="eqn16">
<alternatives><graphic xlink:href="389312_eqn16.gif"/></alternatives>
</disp-formula></p>
<p>From <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref> and <xref ref-type="disp-formula" rid="eqn3">Eq (3)</xref> our measure can be defined as
<disp-formula id="eqn17">
<alternatives><graphic xlink:href="389312_eqn17.gif"/></alternatives>
</disp-formula></p>
<p>Though <monospace>RNAmountAlign</monospace> was developed independently much later than <monospace>STRAL</monospace>, our software offers functionalities unavailable in <monospace>STRAL</monospace>, which latter appears to be no longer maintained.<sup>2</sup> For instance, <monospace>RNAmountAlign</monospace> supports local and semiglobal alignment, and reports <italic>p</italic>-values and E-values; these features are not available in <monospace>STRAL</monospace>.</p>
<p>To illustrate the method, suppose that the query [resp. target] sequence is the 72 nt tRNA AL671879.2 [resp. 69 nt tRNA D16498.1]. Then nucleotide query [resp. target] probabilities are (approximately) <italic>p<sub>A</sub></italic> &#x003D; 0.167, <italic>p<sub>C</sub></italic> &#x003D; 0.278, <italic>p<sub>G</sub></italic> &#x003D; 0.333, <italic>p<sub>U</sub></italic> &#x003D; 0.222, [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline12.gif"/></alternatives></inline-formula>]. From the base pairing probabilities returned by <monospace>RNAfold-p</monospace> [<xref ref-type="bibr" rid="c4">4</xref>], we determine that <italic>p</italic> ( &#x003D; 0.3035, <italic>p</italic>&#x2022; &#x003D; 0.3930, <italic>p</italic>) &#x003D; 0.3035 [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline13.gif"/></alternatives></inline-formula>]. Using these probabilities in Eqs (9-12), we determine that <italic>&#x03BC;</italic><sub>seq</sub> &#x003D; &#x2013;0.9098, <italic>&#x03C3;</italic><sub>seq</sub> &#x003D; 1.4117, and <italic>&#x03BC;</italic><sub>str</sub> &#x003D; &#x2013;0.8301, <italic>&#x03C3;</italic><sub>str</sub> &#x003D; 0.6968. By <xref ref-type="disp-formula" rid="eqn13">Eq (13)</xref> and <xref ref-type="disp-formula" rid="eqn14">Eq (14)</xref>, we determine that RIBOSUM scaling factor <italic>&#x03B1;</italic><sub>seq</sub> &#x003D; 0.4936 and <italic>&#x03B1;</italic><sub>str</sub> &#x003D; 0.3810. It follows that the mean and standard deviation of <italic>&#x03B1;</italic><sub>seq</sub>-scaled RIBOSUM values are identical with that of <italic>&#x03B1;</italic><sub>str</sub>-shifted STRSIM values, hence can be combined in <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref>. Since sequence identity of the <monospace>BRAliBase 2.1</monospace> alignment of these tRNAs is only 28&#x0025;, we set structural similarity weight <italic>&#x03B3;</italic> &#x003D; 1 in <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref>, and obtained a (perfect) global alignment computed by <monospace>RNAmountAlign</monospace>. <xref ref-type="fig" rid="fig2">Figure 2</xref> depicts the distribution of RIBOSUM85-60 [resp. STRSIM] values in this case, both before and after application of scaling factor <italic>&#x03B1;</italic><sub>seq</sub> [resp. shift <italic>&#x03B1;</italic><sub>str</sub>] &#x2013; recall that <italic>&#x03B1;</italic><sub>seq</sub> and <italic>&#x03B1;</italic><sub>str</sub>] depend on <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub>,p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) of tRNA AL671879.2 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline14.gif"/></alternatives></inline-formula> of tRNA D16498.1.</p>
</sec>
<sec id="s2d">
<title>Statistics for pairwise alignment</title>
<sec id="s2d1">
<title>Karlin-Altschul statistics for local pairwise alignment</title>
<p>For a finite alphabet <italic>A</italic> and similarity measure <italic>s</italic>, suppose that the expected similarity <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline15.gif"/></alternatives></inline-formula> is negative and that <italic>s</italic>(<italic>x, y</italic>) is positive for at least one choice of <italic>x, y</italic>. In the case of <monospace>BLAST</monospace>, amino acid and nucleotide similarity scores are integers, for which the Karlin-Altschul algorithm was developed [<xref ref-type="bibr" rid="c12">12</xref>]. In contrast, <monospace>RNAmountAlign</monospace> similarity scores scores are not integers (or more generally values in a lattice), because <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref> combines real-valued <italic>&#x03B1;</italic><sub>seq</sub>-scaled RIBOSUM nucleotide similarities with real-valued <italic>&#x03B1;</italic><sub>str</sub>-shifted STRSIM structural similarities, which depend on query [resp. target] probabilities <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub>,p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) [resp. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline16.gif"/></alternatives></inline-formula>]. For that reason, we use the following reformulation of a result by Karlin, Dembo and Kawabata [<xref ref-type="bibr" rid="c13">13</xref>], the similarity score <italic>s</italic>(<italic>x, y</italic>) for RNA nucleotides <italic>x, y</italic> is defined by <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref>.</p>
<statement>
<label>Theorem 1</label>
<title>(Theorem 1 of [<xref ref-type="bibr" rid="c13">13</xref>])</title>
<p><italic>Given similarity measure s between nucleotides in alphabet A</italic> &#x003D; &#x007B;<italic>A, C, G, U</italic>&#x007D;, <italic>let &#x03BB;</italic>&#x002A; <italic>be the unique positive root of</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline17.gif"/></alternatives></inline-formula>, <italic>and let random variable S<sub>k</sub> denote the score of a length k gapless alignment. For large z</italic>,
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="389312_ueqn1.gif"/></alternatives>
</disp-formula>
<italic>where M denotes high maximal segment scores for local alignment of random RNA sequences a</italic><sub>1</sub>,&#x2026;, <italic>a<sub>n</sub> and b</italic><sub>1</sub>,&#x2026;, <italic>b<sub>m</sub>, and where</italic>
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="389312_ueqn2.gif"/></alternatives>
</disp-formula></p>
</statement>
</sec>
<sec id="s2d2">
<title>Fitting data to probability distributions</title>
<p>Data were fit to the normal distribution (ND) by the method of moments (i.e. mean and standard deviation were taken from data analysis). Data were fit to the extreme value distribution (EVD)
<disp-formula id="eqn18">
<alternatives><graphic xlink:href="389312_eqn18.gif"/></alternatives>
</disp-formula>
by an in-house implementation of maximum likelihood to determine <italic>&#x03BB;, K</italic>, as described in supplementary information to [<xref ref-type="bibr" rid="c36">36</xref>]. Data were fit to the gamma distribution by using the function <monospace>fitdistr(x,&#x2019;gamma&#x2019;)</monospace> from the package <monospace>MASS</monospace> in the <monospace>R</monospace> programming language, which determines rate and shape parameters for the density function
<disp-formula id="eqn19">
<alternatives><graphic xlink:href="389312_eqn19.gif"/></alternatives>
</disp-formula>
with where <italic>&#x03B1;</italic> is the shape parameter, the rate is 1/<italic>&#x03BB;</italic>, where <italic>&#x03BB;</italic> is known as the scale parameter.</p>
</sec>
</sec>
<sec id="s2e">
<title>Multiple alignment</title>
<p>Suppose <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub></italic> are the nucleotide probabilities obtained after the concatenation of all sequences. Let <italic>p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) be computed by individually folding each sequence and taking the arithmetic average of probabilities of (, &#x2022; and) over all sequences. The mean and standard deviation of sequence and structure similarity are computed similar to Eqs (9-12).</p>
<disp-formula id="eqn20">
<alternatives><graphic xlink:href="389312_eqn20.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn21">
<alternatives><graphic xlink:href="389312_eqn21.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn22">
<alternatives><graphic xlink:href="389312_eqn22.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn23">
<alternatives><graphic xlink:href="389312_eqn23.gif"/></alternatives>
</disp-formula>
<p>Sequence multiplicative scaling factor <italic>&#x03B1;</italic><sub>seq</sub> and the structure additive shift factor <italic>&#x03B1;</italic><sub>str</sub> are computed from these values using Eqs (13,14).</p>
<p><monospace>RNAmountAlign</monospace> implements progressive multiple alignment using <monospace>UPGMA</monospace> to construct the guide tree. In <monospace>UPGMA</monospace>, one first defines a similarity matrix <italic>S</italic>, where <italic>S</italic>[<italic>i, j</italic>] is equal to (maximum) pairwise sequence similarity of sequences <italic>i</italic> and <italic>j</italic>. A rooted tree is then constructed by progressively creating a parent node of the two closest siblings. Parent nodes are profiles (PSSMs) that represent alignments of two or more sequences, hence can be treated as pseudo-sequences in a straightforward adaptation of pairwise alignment to the alignment of profiles. Let&#x2019;s consider an alignment of <italic>N</italic> sequences <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline18.gif"/></alternatives></inline-formula> composed of <italic>M</italic> columns. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline19.gif"/></alternatives></inline-formula> denote column <italic>i</italic> of the alignment (for 1 &#x2264; <italic>i</italic> &#x2264; <italic>M</italic>). Suppose <italic>p</italic>(<italic>i, x</italic>), for <italic>x</italic> &#x2208; &#x007B;<italic>A, C, G, U</italic>, &#x2013;&#x007D;, indicates the probability of occurrence of a nucleotide or gap at column <italic>i</italic> of alignment <italic>A</italic>. Then sequence similarity SEQSIM between two columns is defined by
<disp-formula id="eqn24">
<alternatives><graphic xlink:href="389312_eqn24.gif"/></alternatives>
</disp-formula>
where
<disp-formula id="eqn25">
<alternatives><graphic xlink:href="389312_eqn25.gif"/></alternatives>
</disp-formula></p>
<p>The structural measure for a profile is computed from the incremental ensemble heights averaged over each column. Let <italic>mA</italic>(<italic>i</italic>) denote the arithmetic average of incremental ensemble mountain height at column <italic>A<sub>i</sub></italic>
<disp-formula id="eqn26">
<alternatives><graphic xlink:href="389312_eqn26.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline20.gif"/></alternatives></inline-formula> is the incremental ensemble mountain height at position <italic>i</italic> of sequence <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline21.gif"/></alternatives></inline-formula> obtained from <xref ref-type="disp-formula" rid="eqn3">Eq (3)</xref>. Here, let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline22.gif"/></alternatives></inline-formula> if <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline23.gif"/></alternatives></inline-formula> is a gap. Structural similarity between two columns is defined by
<disp-formula id="eqn27">
<alternatives><graphic xlink:href="389312_eqn27.gif"/></alternatives>
</disp-formula></p>
<p>Finally, the combined sequence/structure similarity is computed from
<disp-formula id="eqn28">
<alternatives><graphic xlink:href="389312_eqn28.gif"/></alternatives>
</disp-formula></p>
</sec>
<sec id="s2f">
<title>Benchmarking</title>
<sec id="s2f1">
<title>Accuracy measures</title>
<p>Sensitivity, positive predictive value, and F1-measure for pairwise alignments were computed as follows. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline24.gif"/></alternatives></inline-formula> denotes an alignment, where <italic>a<sub>i</sub>, b<sub>i</sub></italic> &#x2208; &#x007B;<italic>A, C, G, U</italic>, &#x2013;&#x007D;, and the aligned sequences include may contain gap symbols &#x2013; provided that it is not the case that both <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline25.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline26.gif"/></alternatives></inline-formula> are gaps. The number TP of true positives [resp. FP of false positives] is the number of alignment pairs <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline27.gif"/></alternatives></inline-formula> in the predicted alignment that belong to [resp. do not belong to] the reference alignment. The sensitivity (<italic>Sen</italic>) [resp. positive predictive value (<italic>PPV</italic>)] of a predicted alignment is TP divided by reference alignment length [resp. TP divided by predicted alignment length]. The <italic>F</italic>1-score is the harmonic mean of sensitivity and PPV, so <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline28.gif"/></alternatives></inline-formula>. For the computation of <italic>Sen, PPV</italic>, and <italic>F</italic>1, pairs of the form (<italic>X</italic>, &#x2014;) and (&#x2014;, <italic>X</italic>) are also counted. In the case of local alignment, since the size of the reference alignment is unknown, only the predicted alignment length and PPV are reported. To compute the accuracy of multiple alignment, we used sum-of-pair-scores (SPS) [<xref ref-type="bibr" rid="c11">11</xref>], defined as follows. Suppose that <italic>A</italic> denotes a multiple alignment of the form <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline29.gif"/></alternatives></inline-formula>. For 1 &#x2264; <italic>i,j</italic> &#x2264; <italic>M</italic>, 1 &#x2264; <italic>k</italic> &#x2264; <italic>N</italic> define <italic>p<sub>ijk</sub></italic> = 1 if <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline30.gif"/></alternatives></inline-formula> is aligned with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline31.gif"/></alternatives></inline-formula> in both the reference and predicted alignments, and <italic>p<sub>ijk</sub></italic> &#x003D; 0 otherwise. Sum-of-pairs score SPS is then the sum, taken over all <italic>i, j, k</italic>, of the <italic>p<sub>ijk</sub></italic>. Though SPS can be considered as the average sensitivity, taken over all sequence pairs in the alignment, this is not technically the case, since our definition of sensitivity also counts pairs of the form (<italic>X</italic>, &#x2014;) and (&#x2014;, <italic>X</italic>) from the reference alignment.</p>
<p>To measure the conservation of secondary structures in alignments, structural conservation index (SCI) was computed using <monospace>RNAalifold</monospace> [<xref ref-type="bibr" rid="c37">37</xref>]. <italic>RNAalifold</italic> computes SCI as the ratio of the free energy of the alignment, computed by <monospace>RNAalifold</monospace>, with the average minimum free energy of individual structures in the alignment. SCI values close to 1 [resp. 0] indicate high [resp. low] structural conservation. All computations made with Vienna RNA Package used version 2.1.7 [<xref ref-type="bibr" rid="c4">4</xref>] using default Turner 2004 energy parameters [<xref ref-type="bibr" rid="c38">38</xref>]).</p>
</sec>
<sec id="s2f2">
<title>Dataset for global and local alignment comparison</title>
<p>For <italic>pairwise global</italic> alignment benchmarking in <xref ref-type="table" rid="tbl4">Table 4</xref> and <xref ref-type="fig" rid="fig3">Figures 3</xref>, <xref ref-type="fig" rid="fig4">4</xref>, S2 and S3 all 8976 pairwise alignments in k2 from <monospace>BRAliBase 2.1</monospace> database [<xref ref-type="bibr" rid="c33">33</xref>] were used. For <italic>multiple global</italic> alignment benchmarking in <xref ref-type="fig" rid="fig7">Fig 7</xref>, k5 <monospace>BRAliBase 3</monospace> was used [<xref ref-type="bibr" rid="c39">39</xref>]. This dataset includes 583 reference alignments, each composed of 5 sequences. For <italic>pairwise local alignment</italic> benchmarking, 75 pairwise alignments having sequence identity &#x2264; 70&#x0025; were randomly selected from each of 20 well-known families from the Rfam 12.0 database [<xref ref-type="bibr" rid="c40">40</xref>], many of which were considered in a previous study [<xref ref-type="bibr" rid="c41">41</xref>], yielding a total of 1500 alignments. Following [<xref ref-type="bibr" rid="c42">42</xref>], these alignments were trimmed on the left and right, so that both first and last aligned pairs of the alignment do not contain a gap symbol. For sequences <bold>a</bold> &#x003D; <italic>a</italic><sub>1</sub>,&#x2026;, <italic>a<sub>n</sub></italic> [resp. <bold>b</bold> &#x003D; <italic>b</italic><sub>1</sub>,&#x2026;, <italic>b<sub>m</sub></italic>] from each alignment, random sequences <bold>a</bold>&#x2019; [resp. <bold>b</bold>&#x2019;] were generated with the same nucleotide frequencies, then a random position was chosen in <bold>a</bold>&#x2019; [resp. <bold>b</bold>&#x2019;] in which to insert <bold>a</bold> [resp. <bold>b</bold>], thus resulting in a pair of sequences of lengths 4<italic>n</italic> and 4<italic>m</italic>. Finally, since sequence identity was at most 70&#x0025;, the RIBOSUM70-25 similarity matrix was used in <monospace>RNAmountAlign</monospace>. Preparation of the benchmarking dataset for local alignment was analogous to the method used in <italic>multiple</italic> local alignment of [<xref ref-type="bibr" rid="c42">42</xref>]. We used <monospace>LocARNA</monospace> (version 1.8.7), <monospace>FOLDALIGN</monospace> (version 2.5), <monospace>LARA</monospace> (version 1.3.2) <monospace>DYNALIGN</monospace> (from version 5.7 of <monospace>RNAstructure</monospace>), and <monospace>STRAL</monospace> (in-house implementation due to unavailability) for benchmarking.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4.</label>
<caption><p>Average F1 scores (&#x00B1; one standard deviation) for <italic>pairwise global alignment</italic> of <monospace>RNAmountAlign</monospace> and four widely used RNA sequence/structure alignment algorithms on the benchmarking set of 8976 pairwise alignments from the <monospace>BRaliBase K2</monospace> database [<xref ref-type="bibr" rid="c33">33</xref>]. For each indicated Rfam family, the the number of alignments (NumAln), sequence identity (SeqId), and F1-scores for <monospace>RNAmountAlign, LocARNA, LARA, FOLDALIGN</monospace>, and <monospace>DYNALIGN</monospace> are listed, along with pooled averages over all 8976 pairwise alignments. Parameters used in <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref> for <monospace>RNAmountAlign</monospace> were similarity matrix RIBOSUM85-60, structural similarity weight <italic>&#x03B3;</italic> &#x003D; 1/2, gap initiation <italic>g<sub>i</sub></italic> &#x003D; &#x2013;3, gap extension <italic>g<sub>e</sub></italic> &#x003D; &#x2013;1.</p></caption>
<graphic xlink:href="389312_tbl4.tif"/>
</table-wrap>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig 3.</label>
<caption><p>F1-measure (Left) and structural conservation index (SCI) (Right) for <italic>pairwise global alignments</italic> using <monospace>RNAmountAlign, LocARNA, LARA, FOLDALIGN, DYNALIGN, STRAL</monospace> and sequence-only(<italic>&#x03B3;</italic> &#x003D; 0). F1-measure and SCI are shown as a function of alignment sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking.</p></caption>
<graphic xlink:href="389312_fig3.tif"/>
</fig>
</sec>
<sec id="s2f3">
<title>Dataset for correlation of <italic>p</italic>-values for different distribution fits</title>
<p>A pool of 2220 sequences from the Rfam 12.0 database [<xref ref-type="bibr" rid="c40">40</xref>] was created as follows. One sequence was selected from each Rfam family having average sequence length at most 200 nt, with the property that the base pair distance between its minimum free energy (MFE) structure and the Rfam consensus structure was a minimum. Subsequently, for each of 500 randomly selected <italic>query</italic> sequences from the pool of 2220 sequences, 1000 random <italic>target</italic> sequences of length 400 nt were generated to have the same expected nucleotide frequency as that of the query. For each query and random target, five semiglobal (query search) alignments were created using gap initiation costs of <italic>g<sub>i</sub></italic> &#x2208; &#x007B;&#x2013;1, &#x2013;2, &#x2013;3, &#x2013;4, &#x2013;5&#x007D; with gap extension cost <italic>g<sub>e</sub></italic> equal to one-third the gap initiation cost. For each alignment score <italic>x</italic> for query and random target, the <italic>p</italic>-value was computed as 1 &#x2013; <italic>CDF</italic>(<italic>x</italic>) for ND, EVD and GD, where <italic>CDF</italic>(<italic>x</italic>) is the cumulative density function evaluated at <italic>x</italic>. Additionally, a heuristic <italic>p</italic>-value was determined by calculating the proportion of alignment scores for given query that exceed <italic>x</italic>.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<p>We benchmarked <monospace>RNAmountAlign</monospace>&#x2019;s performance for pairwise and multiple alignments on <monospace>BraliBase k2</monospace> and k5 datasets, respectively.</p>
<sec id="s3a">
<title>Pairwise alignment</title>
<p><xref ref-type="fig" rid="fig3">Figures 3</xref>, S2 and S3 depict running averages of <italic>pairwise global alignment</italic> F1-measure, sensitivity, and positive predictive value (PPV) for the software described in this paper, as well as for <monospace>LocARNA, FOLDALIGN, LARA, DYNALIGN</monospace>, and <monospace>STRAL</monospace>. For pairwise benchmarking, reference alignments of size 2, a.k.a. K2, were taken from the <monospace>BRAliBase 2.1</monospace> database [<xref ref-type="bibr" rid="c33">33</xref>]. <monospace>BRAliBase 2.1 K2</monospace> data are based on seed alignments of the Rfam 7.0 database, and consist of 8976 alignments of RNA sequences from 36 Rfam families.</p>
<p>Running averages of sensitivity, positive predictive value, and F1-measure, averaging over windows of size 11 nt (interval [<italic>k</italic> &#x2013; 5, <italic>k</italic> &#x002B; 5]), were computed as a function of sequence identity, where it should be noted that the number of pairwise alignments for different values of sequence identity can vary for the <monospace>BRAliBase 2.1</monospace> data (e.g. there are only 35 pairwise alignments having sequence identity &#x003C; 20&#x0025;). Default parameters were used for all other software. For our software <monospace>RNAmountAlign</monospace>, gap initiation cost was &#x2212;3, gap extension &#x2212;1, and sequence/structure weighting parameter <italic>&#x03B3;</italic> was 0.5 (value obtained by optimizing on a small set of 300 random alignments from Rfam 12.0, not considered in training or testing set). The sequence-only alignment is computed from <monospace>RNAmountAlign</monospace> with the same gap penalties, but for <italic>&#x03B3;</italic> &#x003D; 0. While its accuracy is high, <monospace>RNAmountAlign</monospace> is faster by an order of magnitude than <monospace>LocARNA, LARA, FOLDALIGN</monospace>, and <monospace>DYNALIGN</monospace> &#x2013; indeed, algorithmic time complexity of our method is <italic>O</italic>(<italic>n</italic><sup>3</sup>) compared with <italic>O</italic>(<italic>n</italic><sup>4</sup>) for these methods. Since <monospace>STRAL</monospace> could not be compiled on any of our systems, we implemented its algorithm by modifying <monospace>RNAmountAlign</monospace> and obtained results for <monospace>STRAL</monospace>&#x2019;s default parameter settings. Therefore, the run time of <monospace>STRAL</monospace> is identical to <monospace>RNAmountAlign</monospace> but we achieve slightly higher F1-measure, sensitivity and PPV. Moreover, <monospace>RNAmountAlign</monospace> supports semiglobal and local alignments as well as reporting <italic>p</italic>-values. The right panel of <xref ref-type="fig" rid="fig4">Fig 4</xref> depicts actual run times of the fastest software, <monospace>RNAmountAlign</monospace>, with the next fastest software, <monospace>LARA</monospace>. Unlike the graph in the left panel, actual run times are shown, graphed as a function of sequence length, rather than logarithms of moving averages.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig 4.</label>
<caption><p>Run time of <italic>pairwise global alignment</italic> for <monospace>RNAmountAlign, LocARNA, LARA, FOLDALIGN</monospace>, and <monospace>DYNALIGN</monospace>. (Left) Log run time is shown as a function of seed length for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Window size of 51 is used for the computation of moving average. (Right) Actual run time for <monospace>RNAmountAlign</monospace> and <monospace>LARA</monospace> on the same data. Unlike the left panel the actual run time is shown, rather than log run time, without any moving average taken.</p></caption>
<graphic xlink:href="389312_fig4.tif"/>
</fig>
<p>In addition, <xref ref-type="table" rid="tbl4">Table 4</xref> displays average pairwise global alignment F1 scores for <monospace>RNAmountAlign, LocARNA, LARA, FOLDALIGN, DYNALIGN</monospace>, and <monospace>STRAL</monospace> when benchmarked on 36 families from the <monospace>BRaliBase K2</monospace> database comprising altogether 8976 RNA sequences with average length of 249.33. Averaging over all sequences, the F1 scores for the programs just mentioned were respectively 0.8370, 0.7808, 0.8406, 0.7977, 0.6822, 0.8247; i.e. F1 score 0.8406 of <monospace>LARA</monospace> slightly exceeded the F1 score 0.8370 of <monospace>RNAmountAlign</monospace> and 0.8247 of <monospace>STRAL</monospace>, while other methods trailed by several percentage points. Supplementary Information (SI) Tables S1 and S2 display values for global alignment sensitivity and positive predictive value, benchmarked on the same data for the same programs &#x2013; these results are similar to the F1-scores in <xref ref-type="table" rid="tbl2">Tables 2</xref> and <xref ref-type="table" rid="tbl4">4</xref>.</p>
<p>Although there appears to be no universally accepted criterion for quality of local alignments, <xref ref-type="table" rid="tbl5">Table 5</xref> shows pairwise local alignment comparisons for the above-mentioned methods supporting local alignment: <monospace>RNAmountAlign, FOLDALIGN</monospace>, and <monospace>LocARNA</monospace>. We had intended to include <monospace>SCARNA&#x005F;LM</monospace> [<xref ref-type="bibr" rid="c42">42</xref>] in the benchmarking of multiple local alignment software; however, <monospace>SCARNA&#x005F;LM</monospace> no longer appears to be maintained, since the web server is no longer functional and no response came from our request for the source code. Since the reference alignments for the local benchmarking dataset are not known, and sensitivity depends upon the length of the reference alignment, we only report local alignment length and positive predictive value. Abbreviating <monospace>RNAmountAlign</monospace> by MA, <monospace>FOLDALIGN</monospace> by FA, and <monospace>LocARNA</monospace> by LOC, <xref ref-type="table" rid="tbl5">Table 5</xref> shows average run time in seconds of MA (2.30 &#x00B1; 2.12), FA (625.53 &#x00B1; 2554.61), LOC (5317.96 &#x00B1; 8585.19), average alignment length of reference alignments (118.67 &#x00B1; 47.86), MA (50.35 &#x00B1; 42.33), FA (114.86 &#x00B1; 125.33), LOC (556.82 &#x00B1; 227.00), and average PPV scores MA (0.53 &#x00B1; 0.42), FA (0.64 &#x00B1; 0.36), LOC (0.03 &#x00B1; 0.04).</p>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5.</label>
<caption><p>Comparison of alignment length and positive predictive value (PPV) for <italic>pairwise local alignment</italic> by <monospace>RNAmountAlign</monospace> against the widely used local alignment software <monospace>FOLDALIGN</monospace> and <monospace>LocARNA</monospace>. Local alignment benchmarking was performed on 1500 pairwise alignments (75 alignments per family, 20 Rfam families) extracted from the Rfam 12.0 database [<xref ref-type="bibr" rid="c40">40</xref>], and prepared in a manner analogous to that of the dataset used in benchmarking <italic>multiple</italic> local alignment in [<xref ref-type="bibr" rid="c42">42</xref>] &#x2013; see text for details. Parameters used in <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref> of the main text for <monospace>RNAmountAlign</monospace> were structural similarity weight <italic>&#x03B3;</italic> &#x003D; 1/2, gap initiation <italic>g<sub>i</sub></italic> &#x003D; &#x2013;3, gap extension <italic>g<sub>e</sub></italic> &#x003D; &#x2013;1; since reference alignments were required to have at most 70&#x0025; sequence identity, nucleotide similarity matrix RIBOSUM8570-25 was used in <monospace>RNAmountAlign</monospace>.</p></caption>
<graphic xlink:href="389312_tbl5.tif"/>
</table-wrap>
<p>Taken together, these results suggest that <monospace>RNAmountAlign</monospace> has comparable accuracy, but much faster run time, hence making it a potentially useful tool for genome scanning applications. Here it should be stressed that all benchmarking results used equally weighted contributions of sequence and ensemble structural similarity; i.e. parameter <italic>&#x03B3;</italic> &#x003D;1/2 when computing similarity by <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref>. By setting <italic>&#x03B3;</italic> &#x003D;1, <monospace>RNAmountAlign</monospace> alignments depend wholly on structural similarity (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Indeed, for the following <monospace>BRAliBase 2.1</monospace> alignment with 28&#x0025; sequence identity, by setting <italic>&#x03B3;</italic> &#x003D;1, <monospace>RNAmountAlign</monospace> returns the correct alignment.
<preformat>
GGGGAUGUAGCUCAGUGGUAGAGCGCAUGCUUCGCAUGUAUGAGGCCCCGGGUUCGAUCCCCGGCAUCUCCA
GUUUCAUGAGUAUAGC&#x002D;&#x002D;-AGUACAUUCGGCUUCCAACCGAAAGGUUUUUGUAAACAACCAAAAAUGAAAUA
</preformat>
of 72 nt tRNA AL671879.2 with 69 nt tRNA D16387.1. <xref ref-type="fig" rid="fig1">Fig 1</xref> shows the superimposed mountain heights for this alignment.</p>
</sec>
<sec id="s3b">
<title>Statistics for pairwise alignment</title>
<p><xref ref-type="fig" rid="fig5">Fig 5</xref> shows fits of the relative frequency histogram of alignment scores with the normal (ND), extreme value (EVD) and gamma (GD) distributions, where local [resp. semiglobal] alignment scores are shown in the left [resp. right] panel. The EVD provides the best fit for local alignment sequence-structure similarity scores, as expected by Karlin-Altschul theo [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c13">13</xref>]. Moreover, <xref ref-type="fig" rid="fig6">Fig 6</xref> shows a 96&#x0025; correlation between (expect) E-values computed by our implementation of the Karlin-Altschul method, and E-values obtained by maximum likelihood fitting of local alignment scores. In contrast, the ND provides the best fit for semiglobal sequence/structure alignment similarity scores, at least for the sequence considered in <xref ref-type="fig" rid="fig5">Fig 5</xref>. This is not an isolated phenomenon, as shown in <xref ref-type="fig" rid="fig6">Fig 6</xref>, which depicts scatter plots, Pearson correlation values and sums of squared residuals (SSRs) when computing <italic>p</italic>-values for semiglobal (query search) alignment scores between Rfam sequences and random RNA. As explained earlier, a pool of 2220 sequences from the Rfam 12.0 database [<xref ref-type="bibr" rid="c40">40</xref>] was created by selecting one sequence of length at most 200 nt from each family, with the property that base pair distance between its minimum free energy (MFE) structure and the Rfam consensus structure was a minimum. Then 500 sequences were randomly selected from this pool, and for each of five gap initiation and extension costs <italic>g<sub>i</sub></italic> &#x003D; &#x2013;5, &#x2013;4, &#x2013;3, &#x2013;2, &#x2013;1 with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline32.gif"/></alternatives></inline-formula>. Taking each of the 500 sequences successively as query sequence and for each choice of parameters, 1000 random 400 nt RNAs were generated with the same expected nucleotide relative frequency as that of the query. For each alignment score <italic>z</italic> for query and random target, the <italic>p</italic>-value was computed as 1 minus the cumulative density function, 1 &#x2013; <italic>CDF</italic>(<italic>z</italic>), for fitted normal (ND), extreme value (EVD) and gamma (GD) distributions, thus defining 1000 <italic>p</italic>-values. Additionally, a heuristic <italic>p</italic>-value was determined by calculating the proportion of alignment scores for given query that exceed <italic>z</italic>. For each set of 2.5 million (500 &#x00D7; 5 &#x00D7; 1000) <italic>p</italic>-values (heuristic, ND, EVD, GD), Pearson correlation values were computed and displayed in the upper triangular portion of <xref ref-type="fig" rid="fig6">Fig 6</xref>, with SSRs shown in parentheses. Note that residuals were computed for regression equation row &#x003D; <italic>m</italic> &#x00B7; column &#x002B; <italic>b</italic>, where column values constitute the independent variable. Assuming that heuristic <italic>p</italic>-values constitute the reference standard, it follows that <italic>p</italic>-values computed from the normal distribution correlate best with semiglobal alignment scores computed by <monospace>RNAmountAlign</monospace>.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig 5.</label>
<caption><p>Fits of 30-bin relative frequency histograms of scores for <italic>local</italic> (left), <italic>semiglobal</italic> (middle) and <italic>global</italic> (right) alignments produced by <monospace>RNAmountAlign</monospace> for the randomly chosen 5S rRNA AY544430.1:375-465 from Rfam 12.0 database having A,C,G,U relative frequency of 0.25, 0.27, 0.26, 0.21. A total of 10,000 random sequences having identical expected nucleotide relative frequencies were generated, each of length 400 nt for local/semiglobal and 100 nt for global. Local (left), semiglobal (middle) and global (right) alignments were computed by <monospace>RNAmountAlign</monospace>, in each case fitting the data with the normal (ND), extreme value (EVD) and gamma (GD) distributions. As expected by Karlin-Altschul theory [<xref ref-type="bibr" rid="c12">12</xref>], local alignment scores are best fit by EVD, while semiglobal alignment scores are best fit by ND (results supported by data not shown, involving computations of variation distance, symmetrized Kullback-Leibler distance, and <italic>&#x03C7;</italic><sup>2</sup> goodness-of-fit tests).</p></caption>
<graphic xlink:href="389312_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Fig 6.</label>
<caption><p>(<bold>Left</bold>)Pearson correlation values and scatter plots for <italic>p</italic>-values of <italic>semiglobal alignment</italic> (query search) scores between Rfam sequences and random RNA. For each score in a set of 2.5 million global pairwise alignment scores, a <italic>p</italic>-value was computed by direct counts (heuristic), or by data fitting the normal (ND), extreme value (EVD), or gamma (GD) distributions. Pairwise Pearson correlation values were computed and displayed in the upper triangular portion of the figure, with sums of squared residuals shown in parentheses, and histograms of <italic>p</italic>-values along the diagonal. It follows that ND <italic>p</italic>-values correlate best with heuristic <italic>p</italic>-values, where the latter is assumed to be the gold standard. (<bold>Right</bold>)Scatter plot of expect values <italic>E</italic><sub>ML</sub>, computed by maximum likelihood, following the method described in [<xref ref-type="bibr" rid="c36">36</xref>] (<italic>y</italic>-axis) and expect values <italic>E</italic><sub>KA</sub>, computed by our implementation of the Karlin-Altschul, as described in the text. The regression equation is <italic>E</italic><sub>ML</sub> &#x003D; 0.1764 &#x002B; 0.7991 &#x00B7; <italic>E</italic><sub>KA</sub>; Pearson correlation between <italic>E</italic><sub>ML</sub> and <italic>E</italic><sub>KA</sub> is 96&#x0025;, with correlation <italic>p</italic>-value of 2 &#x00B7; 10<sup>&#x2212;16</sup>. Expect values were determined from local alignment scores computed by the genome scanning form of <monospace>RNAmountAlign</monospace> with query tRNA AB031215.1/9125-9195 and targets consisting of 300 nt windows (with 200 nt overlap) from <italic>E. coli str. K-12</italic> substr. MG1655 with GenBank accession code AKVX01000001.1. From the tRNA query sequence, the values <italic>p<sub>A</sub>,p<sub>C</sub>,p<sub>G</sub>,p<sub>U</sub></italic> for nucleotide relative frequencies, are determined, then average base pairing probabilities <italic>p</italic> (,<italic>p</italic>&#x2022;,<italic>p</italic>) are computed by RNAfold -p [<xref ref-type="bibr" rid="c4">4</xref>]. For the current 300 nt target window, the nucleotide relative frequencies <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline33.gif"/></alternatives></inline-formula> are computed, then precomputed probabilities <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="389312_inline34.gif"/></alternatives></inline-formula> are obtained from SI Table S3. From these values, scaling factor <italic>&#x03B1;</italic><sub>seq</sub> and shift <italic>&#x03B1;</italic><sub>str</sub>, were computed; with structural similarity weight <italic>&#x03B3;</italic> &#x003D; 1/2, the overall similarity function from <xref ref-type="disp-formula" rid="eqn15">Eq (15)</xref> in the text was determined.</p></caption>
<graphic xlink:href="389312_fig6.tif"/>
</fig>
<p>Earlier studies have suggested that protein global alignment similarity scores using PAM120, PAM250, BLOSUM50, and BLOSUM62 matrices appear to be fit best by the gamma distribution (GD) [<xref ref-type="bibr" rid="c43">43</xref>], and that semiglobal RNA sequence alignment similarity scores (with no contribution from structure) appear to be best fit by GD [<xref ref-type="bibr" rid="c44">44</xref>]. However, in our preliminary studies (not shown), it appears that the type of distribution (ND, EVD, GD) that best fits <monospace>RNAmountAlign</monospace> semiglobal alignment depends on the gap costs applied (indeed, for certain choices, EVD provides the best fit). Since there is no mathematical theory concerning alignment score distribution for global or semiglobal alignments, it must be up to the user to decide which distribution provides the most reasonable <italic>p</italic>-values.</p>
</sec>
<sec id="s3c">
<title>Multiple alignment</title>
<p>We benchmarked <monospace>RNAmountAlign</monospace> with the software <monospace>LARA, mLocARNA, FOLDALIGNM</monospace> and <monospace>Multilign</monospace> for <italic>multiple global</italic> K5 alignments in <monospace>Bralibase 3. STRAL</monospace> is not included since the source code could not be compiled. <xref ref-type="fig" rid="fig7">Fig 7</xref> indicates average SPS and SCI as a function of average pairwise sequence identity (APSI). We used the <monospace>-sci</monospace> flag of <monospace>RNAalifold</monospace> to compute SCI from the output of each software without reference to the reference alignment. <xref ref-type="fig" rid="fig7">Fig 7</xref> indicates that SCI values for outputs from various alignment algorithms is higher than the SCI value from reference alignments, suggesting that the consensus structure obtained from sequence/structure alignment algorithms has a larger number of base pairs than the the consensus structure obtained from reference alignments (this phenomenon was also in [<xref ref-type="bibr" rid="c45">45</xref>]). <xref ref-type="fig" rid="fig7">Fig 7</xref> indicates that <monospace>RNAmountAlign</monospace> produces SPS scores comparable to <monospace>mLocARNA</monospace> and <monospace>LARA</monospace> and higher than <monospace>Multilign</monospace> and <monospace>FOLDALIGNM</monospace> while the SCI score obtained from <monospace>RNAmountAlign</monospace> are slightly lower than other software. Averaging over all sequences, the SPS scores for <monospace>RNAmountAlign, LARA, mLocARNA, FOLDALIGNM</monospace> and <monospace>Multilign</monospace> were respectively: 0.84 &#x00B1; 0.17, 0.85 &#x00B1; 0.17, 0.84 &#x00B1; 0.17, 0.77 &#x00B1; 0.22, and 0.84 &#x00B1; 0.19. The left panel of <xref ref-type="fig" rid="fig8">Fig 8</xref> indicates the run time of all software on a logarithmic scale, while the right panel shows the actual run time in seconds for <monospace>RNAmountAlign</monospace> as well as that of the next two fastest algorithms, <monospace>mLocARNA</monospace> and <monospace>LARA</monospace>. This figure clearly shows that <monospace>RNAmountAlign</monospace> has much faster run time than all other software in our benchmarking tests, thus confirming the earlier result from pairwise benchmarking.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Fig 7.</label>
<caption><p>Sum-of-pairs(SPS) score (left) and structural conservation index (SCI) (right) for <italic>multiple global alignments</italic> using <monospace>RNAmountAlign, LARA, mLocARNA, FoldalignM</monospace> and <monospace>Multilign</monospace> . SPS and SCI are shown as a function of average pairwise sequence identity(APSI) in the k5 <monospace>BRAliBase 3</monospace> database used for benchmarking.</p></caption>
<graphic xlink:href="389312_fig7.tif"/>
</fig>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Fig 8.</label>
<caption><p>Run time of <italic>multiple global alignment</italic> for <monospace>RNAmountAlign, mLocARNA</monospace> and <monospace>LARA, FoldalignM</monospace> and <monospace>Multilign</monospace>. (Left) Log run time is as shown a function of reference alignment length for K5 alignments in <monospace>Bralibase 3.</monospace> (Right) Actual run time in seconds for <monospace>mLocARNA</monospace> and <monospace>LARA</monospace>.</p></caption>
<graphic xlink:href="389312_fig8.tif"/>
</fig>
</sec>
</sec>
<sec id="s4">
<title>Conclusion</title>
<p><monospace>RNAmountAlign</monospace> is a new <monospace>C&#x002B;&#x002B;</monospace> software package for RNA local, global, and semiglobal sequence/structure alignment, which provides accuracy comparable with that of a number of widely used programs, but provides much faster run time. <monospace>RNAmountAlign</monospace> additionally computes E-values for local alignments, using Karlin-Altschul statistics, as well as <italic>p</italic>-values for normal, extreme value and gamma distributions by parameter fitting.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>Research supported by National Science Foundation grant DBI-1262439. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the National Science Foundation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Levenshtein</surname> <given-names>VI.</given-names></string-name> <article-title>Binary Codes Capable of Correcting Deletions, Insertions and Reversals</article-title>. <source>Soviet Physics Doklady.</source> <year>1966</year>;<volume>10</volume>:<fpage>707</fpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Moulton</surname> <given-names>V</given-names></string-name>, <string-name><surname>Zuker</surname> <given-names>M</given-names></string-name>, <string-name><surname>Steel</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pointon</surname> <given-names>R</given-names></string-name>, <string-name><surname>Penny</surname> <given-names>D.</given-names></string-name> <article-title>Metrics on RNA secondary structures</article-title>. <source>Journal of Computational Biology.</source> <year>2000</year>;<volume>7</volume>:<fpage>277</fpage>&#x2013;<lpage>292</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Shapiro</surname> <given-names>BA.</given-names></string-name> <article-title>An algorithm for comparing multiple RNA secondary structures</article-title>. <source>Comput Appl Biosci.</source> <year>1988</year>;<volume>4</volume>(<issue>3</issue>):<fpage>387</fpage>&#x2013;<lpage>393</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Lorenz</surname> <given-names>R</given-names></string-name>, <string-name><surname>Bernhart</surname> <given-names>SH</given-names></string-name>, <string-name><surname>H&#x00F6;ner zu Siederdissen</surname> <given-names>C</given-names></string-name>, <string-name><surname>Tafer</surname> <given-names>H</given-names></string-name>, <string-name><surname>Flamm</surname> <given-names>C</given-names></string-name>, <string-name><surname>Stadler</surname> <given-names>PF</given-names></string-name>, <etal>et al.</etal> <article-title>ViennaRNA Package 2.0</article-title>. <source>Algorithms Mol Biol.</source> <year>2011</year>;<volume>6</volume>:<fpage>26</fpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Voss</surname> <given-names>B</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>C</given-names></string-name>, <string-name><surname>Giegerich</surname> <given-names>R.</given-names></string-name> <article-title>Evaluating the predictability of conformational switching in RNA</article-title>. <source>Bioinformatics.</source> <year>2004</year>;<volume>20</volume>(<issue>10</issue>):<fpage>1573</fpage>&#x2013;<lpage>1582</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="book"><string-name><surname>Barsacchi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ba&#x00F9;</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bechini</surname> <given-names>A.</given-names></string-name> <chapter-title>Extensive Assessment of Metrics on RNA Secondary Structures and Relative Ensembles. In: Proceedings of the 31st Annual ACM Symposium on Applied Computing. SAC &#x2018;16</chapter-title>. <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>ACM</publisher-name>; <year>2016</year>. p. <fpage>44</fpage>&#x2013;<lpage>47</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/2851613.2851868">http://doi.acm.org/10.1145/2851613.2851868</ext-link>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Ding</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Lawrence</surname> <given-names>CE.</given-names></string-name> <article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res.</source> <year>2003</year>;<volume>31</volume>(<issue>24</issue>):<fpage>7280</fpage>&#x2013;<lpage>7301</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Needleman</surname> <given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname> <given-names>CD.</given-names></string-name> <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol.</source> <year>1970</year>;<volume>48</volume>(<issue>3</issue>):<fpage>443</fpage>&#x2013;<lpage>453</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname> <given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname> <given-names>MS.</given-names></string-name> <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol.</source> <year>1981</year>;<volume>147</volume>(<issue>1</issue>):<fpage>195</fpage>&#x2013;<lpage>197</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="book"><string-name><surname>Gusfield</surname> <given-names>D.</given-names></string-name> <chapter-title>Algorithms on Strings, Trees and Sequences: Computer Science and Computational Biology</chapter-title>. <publisher-name>Cambridge University</publisher-name>; <year>1997</year>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Thompson</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Plewniak</surname> <given-names>F</given-names></string-name>, <string-name><surname>Poch</surname> <given-names>O.</given-names></string-name> <article-title>A comprehensive comparison of multiple sequence alignment programs</article-title>. <source>Nucleic Acids Res.</source> <year>1999</year>;<volume>27</volume>(<issue>13</issue>):<fpage>2682</fpage>&#x2013;<lpage>2690</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Karlin</surname> <given-names>S</given-names></string-name>, <string-name><surname>Altschul</surname> <given-names>SF.</given-names></string-name> <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title>. <source>Proc Natl Acad Sci USA.</source> <year>1990</year>;<volume>87</volume>(<issue>6</issue>):<fpage>2264</fpage>&#x2013;<lpage>2268</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Karlin</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dembo</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kawabata</surname> <given-names>T.</given-names></string-name> <article-title>Statistical composition of high-scoring segments from molecular sequences</article-title>. <source>Annals of Statistics.</source> <year>1990</year>;<volume>18</volume>(<issue>2</issue>):<fpage>571</fpage>&#x2013;<lpage>581</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Bauer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Klau</surname> <given-names>GW</given-names></string-name>, <string-name><surname>Reinert</surname> <given-names>K.</given-names></string-name> <article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>. <source>BMC Bioinformatics.</source> <year>2007</year>;<volume>8</volume>:<fpage>271</fpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Havgaard</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Lyngs&#x00F8;</surname> <given-names>R</given-names></string-name>, <string-name><surname>Stormo</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gorodkin</surname> <given-names>J.</given-names></string-name> <article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40&#x0025;</article-title>. <source>Bioinformatics.</source> <year>2005</year>;<volume>21</volume>(<issue>9</issue>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Havgaard</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kaur</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gorodkin</surname> <given-names>J.</given-names></string-name> <article-title>Comparative ncRNA gene and structure prediction using Foldalign and FoldalignM</article-title>. <source>Curr Protoc Bioinformatics.</source> <year>2012</year>;<volume>0</volume>(<issue>O</issue>):<fpage>O</fpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Sundfeld</surname> <given-names>D</given-names></string-name>, <string-name><surname>Havgaard</surname> <given-names>JH</given-names></string-name>, <string-name><surname>De Melo</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Gorodkin</surname> <given-names>J.</given-names></string-name> <article-title>Foldalign 2.5: multithreaded implementation for pairwise structural RNA alignment</article-title>. <source>Bioinformatics.</source> <year>2016</year>;<volume>32</volume>(<issue>8</issue>):<fpage>1238</fpage>&#x2013;<lpage>1240</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Mathews</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>DH.</given-names></string-name> <article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J Mol Biol.</source> <year>2002</year>;<volume>317</volume>(<issue>2</issue>):<fpage>191</fpage>&#x2013;<lpage>203</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Will</surname> <given-names>S</given-names></string-name>, <string-name><surname>Reiche</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hofacker</surname> <given-names>IL</given-names></string-name>, <string-name><surname>Stadler</surname> <given-names>PF</given-names></string-name>, <string-name><surname>Backofen</surname> <given-names>R.</given-names></string-name> <article-title>Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering</article-title>. <source>PLoS Comput Biol.</source> <year>2007</year>;<volume>3</volume>(<issue>4</issue>):<fpage>e65</fpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname> <given-names>C</given-names></string-name>, <string-name><surname>Heyne</surname> <given-names>S</given-names></string-name>, <string-name><surname>Richter</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Will</surname> <given-names>S</given-names></string-name>, <string-name><surname>Backofen</surname> <given-names>R.</given-names></string-name> <article-title>Freiburg RNA Tools: a web server integrating INTARNA, EXPARNA and LOCARNA</article-title>. <source>Nucleic Acids Res.</source> <year>2010</year>;<volume>38</volume>(Web):<fpage>W373</fpage>&#x2013;<lpage>W377</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Hofacker</surname> <given-names>IL</given-names></string-name>, <string-name><surname>Bernhart</surname> <given-names>SH</given-names></string-name>, <string-name><surname>Stadler</surname> <given-names>PF.</given-names></string-name> <article-title>Alignment of RNA base pairing probability matrices</article-title>. <source>Bioinformatics.</source> <year>2004</year>;<volume>20</volume>(<issue>14</issue>):<fpage>2222</fpage>&#x2013;<lpage>2227</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Dalli</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wilm</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mainz</surname> <given-names>I</given-names></string-name>, <string-name><surname>Steger</surname> <given-names>G.</given-names></string-name> <article-title>STRAL: progressive alignment of non-coding RNA using base pairing probability vectors in quadratic time</article-title>. <source>Bioinformatics.</source> <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1593</fpage>&#x2013;<lpage>1599</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Torarinsson</surname> <given-names>E</given-names></string-name>, <string-name><surname>Havgaard</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Gorodkin</surname> <given-names>J.</given-names></string-name> <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>. <source>Bioinformatics.</source> <year>2007</year>;<volume>23</volume>(<issue>8</issue>):<fpage>926</fpage>&#x2013;<lpage>932</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Xu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Mathews</surname> <given-names>DH.</given-names></string-name> <article-title>Multilign: an algorithm to predict secondary structures conserved in multiple RNA sequences</article-title>. <source>Bioinformatics.</source> <year>2011</year>;<volume>27</volume>(<issue>5</issue>):<fpage>626</fpage>&#x2013;<lpage>632</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Xu</surname> <given-names>ZZ</given-names></string-name>, <string-name><surname>Mathews</surname> <given-names>DH.</given-names></string-name> <article-title>Prediction of Secondary Structures Conserved in Multiple RNA Sequences</article-title>. <source>Methods Mol Biol.</source> <year>2016</year>;<volume>1490</volume>:<fpage>35</fpage>&#x2013;<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Notredame</surname> <given-names>C</given-names></string-name>, <string-name><surname>Higgins</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Heringa</surname> <given-names>J.</given-names></string-name> <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol.</source> <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>&#x2013;<lpage>217</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Thompson</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Higgins</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Gibson</surname> <given-names>TJ.</given-names></string-name> <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>. <source>Nucleic Acids Res.</source> <year>1994</year>;<volume>22</volume>(<issue>22</issue>):<fpage>4673</fpage>&#x2013;<lpage>4680</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Ferre</surname> <given-names>F</given-names></string-name>, <string-name><surname>Ponty</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Lorenz</surname> <given-names>WA</given-names></string-name>, <string-name><surname>Clote</surname> <given-names>P.</given-names></string-name> <article-title>DIAL: a web server for the pairwise alignment of two RNA three-dimensional structures using nucleotide, dihedral angle and base-pairing similarities</article-title>. <source>Nucleic Acids Res.</source> <year>2007</year>;<volume>35</volume>(Web):<fpage>W659</fpage>&#x2013;<lpage>W668</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Gotoh</surname> <given-names>O.</given-names></string-name> <article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol.</source> <year>1982</year>;<volume>162</volume>(<issue>3</issue>):<fpage>705</fpage>&#x2013;<lpage>708</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Nawrocki</surname> <given-names>EP</given-names></string-name>, <string-name><surname>Eddy</surname> <given-names>SR.</given-names></string-name> <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics.</source> <year>2013</year>;<volume>29</volume>(<issue>22</issue>):<fpage>2933</fpage>&#x2013;<lpage>2935</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Hogeweg</surname> <given-names>P</given-names></string-name>, <string-name><surname>Hesper</surname> <given-names>B.</given-names></string-name> <article-title>Energy directed folding of RNA sequences</article-title>. <source>Nucleic Acids Res.</source> <year>1984</year>;<volume>12</volume>(<issue>1</issue>):<fpage>67</fpage>&#x2013;<lpage>74</lpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Huynen</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Perelson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Vieira</surname> <given-names>WA</given-names></string-name>, <string-name><surname>Stadler</surname> <given-names>PF.</given-names></string-name> <article-title>Base pairing probabilities in a complete HIV-1 RNA</article-title>. <source>J Comput Biol.</source> <year>1996</year>;<volume>3</volume>(<issue>2</issue>):<fpage>253</fpage>&#x2013;<lpage>274</lpage>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Gardner</surname> <given-names>PP</given-names></string-name>, <string-name><surname>Wilm</surname> <given-names>A</given-names></string-name>, <string-name><surname>Washietl</surname> <given-names>S.</given-names></string-name> <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>. <source>Nucleic Acids Res.</source> <year>2005</year>;<volume>33</volume>(<issue>8</issue>):<fpage>2433</fpage>&#x2013;<lpage>2439</lpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname> <given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname> <given-names>MS.</given-names></string-name> <article-title>Comparison of biosequences</article-title>. <source>Advances in Applied Mathematics.</source> <year>1981</year>;<volume>2</volume>:<fpage>482</fpage>&#x2013;<lpage>489</lpage>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Sellers</surname> <given-names>PH.</given-names></string-name> <article-title>On the theory and computation of evolutionary distances</article-title>. <source>SIAM J Appl Math.</source> <year>1974</year>;<volume>26</volume>:<fpage>787</fpage>&#x2013;<lpage>793</lpage>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Klein</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Eddy</surname> <given-names>SR.</given-names></string-name> <article-title>Finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinformatics.</source> <year>2003</year>;<volume>4</volume>:<fpage>44</fpage>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Bernhart</surname> <given-names>SH</given-names></string-name>, <string-name><surname>Hofacker</surname> <given-names>IL</given-names></string-name>, <string-name><surname>Will</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gruber</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Stadler</surname> <given-names>PF.</given-names></string-name> <article-title>RNAalifold: improved consensus structure prediction for RNA alignments</article-title>. <source>BMC Bioinformatics.</source> <year>2008</year>;<volume>9</volume>:<fpage>474</fpage>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Turner</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Mathews</surname> <given-names>DH.</given-names></string-name> <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res.</source> <year>2010</year>;<volume>38</volume>(Database):<fpage>D280</fpage>&#x2013;<lpage>D282</lpage>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Freyhult</surname> <given-names>EK</given-names></string-name>, <string-name><surname>Bollback</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Gardner</surname> <given-names>PP.</given-names></string-name> <article-title>Exploring genomic dark matter: a critical assessment of the performance of homology search methods on noncoding RNA</article-title>. <source>Genome Res.</source> <year>2007</year>;<volume>17</volume>(<issue>1</issue>):<fpage>117</fpage>&#x2013;<lpage>125</lpage>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Nawrocki</surname> <given-names>EP</given-names></string-name>, <string-name><surname>Burge</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Bateman</surname> <given-names>A</given-names></string-name>, <string-name><surname>Daub</surname> <given-names>J</given-names></string-name>, <string-name><surname>Eberhardt</surname> <given-names>RY</given-names></string-name>, <string-name><surname>Eddy</surname> <given-names>SR</given-names></string-name>, <etal>et al.</etal> <article-title>Rfam 12.0: updates to the RNA families database</article-title>. <source>Nucleic Acids Res.</source> <year>2015</year>;<volume>43</volume>(Database):<fpage>D130</fpage>&#x2013;<lpage>D137</lpage>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Clote</surname> <given-names>P</given-names></string-name>, <string-name><surname>Ferre</surname> <given-names>F</given-names></string-name>, <string-name><surname>Kranakis</surname> <given-names>E</given-names></string-name>, <string-name><surname>Krizanc</surname> <given-names>D.</given-names></string-name> <article-title>Structural RNA has lower folding energy than random RNA of the same dinucleotide frequency</article-title>. <source>RNA.</source> <year>2005</year>;<volume>11</volume>(<issue>5</issue>):<fpage>578</fpage>&#x2013;<lpage>591</lpage>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Tabei</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Asai</surname> <given-names>K.</given-names></string-name> <article-title>A local multiple alignment method for detection of non-coding RNA sequences</article-title>. <source>Bioinformatics.</source> <year>2009</year>;<volume>25</volume>(<issue>12</issue>):<fpage>1498</fpage>&#x2013;<lpage>1505</lpage>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Pang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Tang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Tao</surname> <given-names>S.</given-names></string-name> <article-title>Statistical distributions of optimal global alignment scores of random protein sequences</article-title>. <source>BMC Bioinformatics.</source> <year>2005</year>;<volume>6</volume>:<fpage>257</fpage>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Hertel</surname> <given-names>J</given-names></string-name>, <string-name><surname>De Jong</surname> <given-names>D</given-names></string-name>, <string-name><surname>Marz</surname> <given-names>M</given-names></string-name>, <string-name><surname>Rose</surname> <given-names>D</given-names></string-name>, <string-name><surname>Tafer</surname> <given-names>H</given-names></string-name>, <string-name><surname>Tanzer</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Non-coding RNA annotation of the genome of Trichoplax adhaerens</article-title>. <source>Nucleic Acids Res.</source> <year>2009</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1602</fpage>&#x2013;<lpage>1615</lpage>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Seemann</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Quek</surname> <given-names>XC</given-names></string-name>, <string-name><surname>Mattick</surname> <given-names>JS.</given-names></string-name> <article-title>DotAligner: identification and clustering of RNA structure motifs</article-title>. <source>Genome Biol.</source> <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>244</fpage>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Lowe</surname> <given-names>TM</given-names></string-name>, <article-title>Chan PP. tRNAscan-SE On-line: integrating search and context for analysis of transfer RNA genes</article-title>. <source>Nucleic Acids Research.</source> <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W54</fpage>&#x2013;<lpage>W57</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkw413</pub-id>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Huynen</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gutell</surname> <given-names>R</given-names></string-name>, <string-name><surname>Konings</surname> <given-names>D.</given-names></string-name> <article-title>Assessing the reliability of RNA folding using statistical mechanics11</article-title> Edited by <person-group person-group-type="editor"><string-name><given-names>D. E.</given-names> <surname>Draper</surname></string-name></person-group>. <source>Journal of Molecular Biology.</source> <year>1997</year>;<volume>267</volume>(<issue>5</issue>):<fpage>1104</fpage>&#x2013;<lpage>1112</lpage>. doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.1997.0889">https://doi.org/10.1006/jmbi.1997.0889</ext-link>.</mixed-citation></ref>
</ref-list>
<fn-group>
<fn id="fn1"><label>1</label><p>We follow [<xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c31">31</xref>] in our definition of mountain height, and related notions of ensemble mountain height and distance, while [<xref ref-type="bibr" rid="c32">32</xref>] and Vienna RNA package [<xref ref-type="bibr" rid="c4">4</xref>] differ in an inessential manner by defining <italic>h<sub>s</sub></italic>(<italic>k</italic>) &#x003D; |&#x007B;(<italic>i, j</italic>) &#x2208; <italic>s</italic>: <italic>i</italic> &#x003C; <italic>k</italic>&#x007D;| &#x2013; |&#x007B;(<italic>i, j</italic>) &#x2208; <italic>s</italic>: <italic>j</italic> &#x2264; <italic>k</italic>&#x007D;|.</p></fn>
<fn id="fn2"><label>2</label><p>Since we were unable to compile <monospace>STRAL</monospace>, our benchmarking results for <monospace>STRAL</monospace> use an adaptation of our code to support <xref ref-type="disp-formula" rid="eqn16">Eq (16)</xref>. There are nevertheless some differences in how progressive alignment is implemented in <monospace>STRAL</monospace> that could affect run time.</p></fn>
</fn-group>
</back>
</article>