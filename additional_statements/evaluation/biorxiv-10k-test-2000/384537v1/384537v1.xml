<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/384537</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Biophysics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A Bayesian Approach to Beam-Induced Motion Correction in Cryo-EM Single-Particle Analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8407-0759</contrib-id>
<name>
<surname>Zivanov</surname>
<given-names>Jasenko</given-names>
</name>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2697-2767</contrib-id>
<name>
<surname>Nakane</surname>
<given-names>Takanori</given-names>
</name>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0462-6540</contrib-id>
<name>
<surname>Scheres</surname>
<given-names>Sjors H. W.</given-names>
</name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Medical Research Council Laboratory of Molecular Biology</institution>, CB2 0QH, Cambridge, <country>United Kingdom</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author</corresp>
<fn id="n1" fn-type="other"><p><monospace><email>scheres@mrc-lmb.cam.ac.uk</email></monospace></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>384537</elocation-id>
<history>
<date date-type="received">
<day>03</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>03</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>03</day>
<month>8</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="384537.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>We present a new method to estimate the trajectories of particle motion and the amount of cumulative beam damage in electron cryo-microscopy (cryo-EM) single particle analysis. We model the motion within the sample through the use of Gaussian Process regression. This allows us to associate with each hypothetical set of particle trajectories a prior likelihood that favours spatially and temporally smooth motion without imposing hard constraints. This formulation enables us to express the a-posteriori likelihood of a set of particle trajectories as a product of that prior likelihood and an observation likelihood given by the data, and to then maximise this a-posteriori likelihood. Since our smoothness prior requires three parameters that describe the statistics of the observed motion, we also propose an efficient stochastic method to estimate those parameters. Finally, we propose a practical means of estimating the average amount of cumulative radiation damage as a function of radiation dose and spatial frequency, and a robust method of fitting relative B-factors to it. We evaluate our method on three publicly available datasets, and illustrate its usefulness by comparison with state-of-the-art methods and previously published results. The new method has been implemented as Bayesian polishing in RELION-3, where it replaces the existing particle polishing method, as it outperforms the latter in all tests conducted.</p>
</abstract>
<counts>
<page-count count="17"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Recent advances in electron detector technology have allowed cryo-EM single-particle analysis to uncover the structures of many biological macromolecules to resolutions sufficient for <italic>de novo</italic> atomic modelling. The primary impediment to high-resolution reconstruction is radiation damage that is inflicted on the molecules when they are exposed to an electron beam. This requires low-dose imaging, and hence reconstructions from very noisy images. In addition, exposure to the electron beam leads to motion in the sample, which destroys information, particularly in the high spatial frequencies.</p>
<p>Because new detectors allow capturing multi-frame movies during exposure of the sample, it is possible to estimate and correct for beam-induced motion. This requires sufficient signal in the individual movie frames, which is challenging as each frame only contains a fraction of the total electron dose, resulting in even lower signal-to-noise ratios. The earliest approaches to beam-induced motion correction were performed in <italic>Frealign</italic> [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>] and <sc>relion</sc> [<xref ref-type="bibr" rid="c2">2</xref>], and estimated particle positions and orientations independently in each movie frame and for each particle. Both programs averaged the signal over multiple adjacent frames to boost the low signal-to-noise ratios. Still, these approaches were only applicable to relatively large (&#x003E; 1 MDa in molecular weight) particles (i.e. molecules or molecular complexes). These early studies revealed correlations between the direction and extent of motion of particles that are in close proximity to each other. In this paper, we will refer to this property as the <italic>spatial smoothness</italic> of motion.</p>
<p>The approach in [<xref ref-type="bibr" rid="c2">2</xref>] was subsequently extended to cover smaller molecules. This was possible by (1) still performing template matching on averages over multiple adjacent frames; (2) fitting a linear path of constant velocity through the unreliably detected positions; and (3) averaging those constant velocity vectors over local areas of the micrograph. This means that consistency with the observations and the (absolute) temporal and (partial) spatial smoothness of the trajectories were imposed one after the other. That algorithm, together with a radiation-dose weighting scheme described below, was termed particle polishing [<xref ref-type="bibr" rid="c21">21</xref>], and was implemented as the method of choice for beam-induced motion correction in the Relion package [<xref ref-type="bibr" rid="c20">20</xref>].</p>
<p>In the meantime, a second class of motion estimation algorithms have been developed that do not rely on the availability of a three-dimensional reference structure, and which, therefore, can be applied much earlier in the image-processing workflow. Instead of comparing individual particles with their reference projections, these algorithms estimate the motion entirely from the frame sequence itself, by cross-correlating individual movie frames or regions within them. This tends to work best for relatively low spatial frequencies, which can be challenging for movies that are captured close to focus, where the low frequencies are the most attenuated by the contrast transfer function.</p>
<p>Two of the early reference-free methods, <italic>MotionCorr</italic> [<xref ref-type="bibr" rid="c10">10</xref>] and <italic>Unblur</italic> [<xref ref-type="bibr" rid="c7">7</xref>], relaxed the spatial smoothness assumption, allowing for non-linear trajectories. While <italic>MotionCorr</italic> allowed completely free motion over time, it required discrete regions of the image to move as rigid blocks. <italic>Unblur</italic> imposed a certain amount of temporal smoothness on the motion and it required the entire image to move as a rigid block. The method by Abrishami et al. [<xref ref-type="bibr" rid="c1">1</xref>] was based on an iterative version of the Lucas-Kanade optical flow algorithm [<xref ref-type="bibr" rid="c12">12</xref>] and it abandoned the idea of rigid regions in favour of a model that allows for spatially smooth deformations of the image. Later, a more robust noise model was proposed in <italic>Zorro</italic> [<xref ref-type="bibr" rid="c14">14</xref>], which required uniform movement of the entire micrograph, and a variant of it, <italic>SubZorro</italic>, that worked on rigid regions.</p>
<p>An early method to formulate motion estimation as a minimisation of a cost function in order to simultaneously satisfy consistency with the observations and temporal smoothness was <italic>alignparts-lmbfgs</italic> [<xref ref-type="bibr" rid="c19">19</xref>]. It estimated the motion of each particle separately, so spatial smoothness of the motion was enforced only after the fact, by forming local averages over trajectories of neighbouring particles. Although <italic>alignparts-lmbfgs</italic> works on individual particles, the program does not use reference projections, but minimises a weighted phase difference between the Fourier components of individual movie frames of boxed out particles.</p>
<p>A reference-free method that is very popular today is <italic>MotionCor2</italic> [<xref ref-type="bibr" rid="c25">25</xref>]. This program enforces neither spatial nor temporal smoothness absolutely. Instead of working on individual particles, it splits the micrograph into tiles, and it fits the motion of each tile to a global polynomial function of time and space. This is done by picking independent, most likely positions of each block and then fitting the coefficients of the polynomial to those discrete positions. We will compare our new method to <italic>MotionCor2</italic> in the results section.</p>
<p>Unlike particle motion, radiation damage cannot be corrected for explicitly. Nevertheless, the deleterious effects of radiation damage on the reconstruction can be reduced by down-weighting the contribution of the higher spatial frequencies in the later movie frames. This is because radiation damage affects the signal at high spatial frequencies faster than the signal at low spatial frequencies [<xref ref-type="bibr" rid="c8">8</xref>]. For this reason, it was proposed to discard the later movie frames for high-resolution reconstruction [<xref ref-type="bibr" rid="c10">10</xref>]. The particle polishing program in <sc>relion</sc> [<xref ref-type="bibr" rid="c21">21</xref>] would then extend this to a continuous radiation-damage weighting scheme. This approach used a relative B-factor model (based on the temperature factors that are commonly used in X-ray crystallography) to describe the signal fall-off with resolution. Later, Grant and Grigorieff derived a more precise exponential damage model from a reconstruction of a rotavirus capsid, and proposed this as a general model for radiation damage in biological cryo-EM samples [<xref ref-type="bibr" rid="c7">7</xref>]. The latter is currently in use in many programs.</p>
<p>In this paper, we describe a new method, which we have termed Bayesian polishing, and which has been implemented in the <sc>relion</sc> package. This method still uses the original B-factor model for the relative weighting of different spatial frequencies in different movie frames, although we do propose a new method to estimate the B-factors. We chose the B-factor model because, as opposed to the exponential model by Grant and Grigorieff, it allows us to model both radiation damage and any residual motion that is not corrected for. However, as the B-factors can only be determined once the motion has been estimated, we do use the exponential model during the initial motion estimation step.</p>
<p>The two main disadvantages of the motion estimation process in the original particle polishing algorithm in <sc>relion</sc> that prompted these developments were the absolute temporal smoothness assumption and the feed-forward nature of the fitting process: a linear path that best fits the estimated noisy positions might not be the linear path that leads to the greatest overall consistency with the observed data. In other words, the per-frame maxima are picked prematurely. This is illustrated in <xref ref-type="fig" rid="fig1">Fig. 1</xref>. The same is also true for the spatially smooth velocity field that results from the averaging of multiple such linear trajectories. The motion estimation method that we propose in this paper overcomes both of these disadvantages.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p><italic>A simulated example illustrating the issue of premature maximum picking. <bold>(a)</bold>: A Ga,ussia,n representing the cross-correlation between the reference and the observation of a particle. <bold>(b)</bold>: That cross-correlation distorted by Gaussian white noise of realistic intensity for the cross-correlation between a noise-free reference and one observed frame of one single particle (&#x03C3;</italic> &#x003D; 2; <italic>the circle indicates the maximum). <bold>(c)</bold>: The average over</italic> 100 <italic>such noisy functions and its maximum. <bold>(d)</bold>: The maxima of those</italic> 100 <italic>noisy functions (small circles) and their average (big circle). Note how the average of the noisy maxima (d) is much further from the true maximum than the maximum of the average (c). Our proposed method avoids picking individual maxima of noisy functions, and it instead aims to maximise the cross-correlations of all particles and the prior smoothness assumptions simultaneously</italic>.</p></caption>
<graphic xlink:href="384537_fig1.tif"/>
</fig>
</sec>
<sec id="s2">
<label>2</label>
<title>Materials and Methods</title>
<p>In the following, we will discuss the different components of our proposed Bayesian polishing approach. We will begin by describing the motion model and the motion estimation process in 2.1. After that, we will explain how parameters for our prior, i.e. for the statistics of motion, are determined in 2.2. Although those have to be known in order to estimate the most likely motion, we chose to describe their determination afterwards, since its understanding requires knowledge of the actual motion model. We then describe the process of measuring the relative B-factors and recombining the frames in 2.3, and we conclude this section with a description of our evaluation process in 2.5.</p>
<sec id="s2a">
<label>2.1</label>
<title>Motion Estimation</title>
<sec id="s2a1">
<label>2.1.1</label>
<title>Outline</title>
<p>The central idea behind our motion estimation consists in finding a set of particle trajectories in each micrograph that maximise the a-posteriori probability given the observations. Note that we assume a reference map, the viewing angles and defoci of the particles and the parameters of the microscope to be known by this point.</p>
<p>Formally, we express the particle trajectories as a set of positions <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline1.gif"/></alternatives></inline-formula>, for each particle <italic>p</italic> &#x2208; &#x007B;1..<italic>P</italic>&#x007D; and frame <italic>f</italic> &#x2208; &#x007B;1..<italic>F</italic>&#x007D;. The corresponding per-frame particle displacements are denoted by <italic>v<sub>p,f</sub></italic> &#x003D; <italic>s</italic><sub><italic>p,f</italic> &#x002B; 1</sub> &#x2212; <italic>s<sub>p,f</sub></italic> for <italic>f</italic> &#x2208; &#x007B;1..<italic>F</italic> &#x2212; 1&#x007D;. We will refer to <italic>v<sub>p,f</sub></italic> as per-frame velocities in the following, since they are equal to the mean velocities between the two frames if time is measured in units of frames.</p>
<p>Let <italic>s</italic> &#x003D; &#x007B;<italic>s<sub>p, f</sub></italic>|<italic>p</italic> &#x2208; &#x007B;1..<italic>P</italic>&#x007D;, <italic>f</italic> &#x2208; &#x007B;1..<italic>F</italic>&#x007D;&#x007D; denote the set of all particle trajectories in a micrograph. The a-posteriori probability <italic>P</italic><sub><monospace>AP</monospace></sub>(<italic>s</italic>|<monospace>obs</monospace>) of those trajectories given the observations <monospace>obs</monospace> is then given by Bayes&#x2019; law:
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="384537_eqn1.gif"/></alternatives>
</disp-formula>
where the term <italic>P</italic><sub><monospace>prior</monospace></sub>(<italic>s</italic>) describes the prior probability of that set of trajectories and is described by the statistics of motion, while <italic>P</italic><sub><monospace>obs</monospace></sub>(<monospace>obs</monospace>|<italic>s</italic>) describes the probability of making the observations <italic>obs</italic> given those trajectories.</p>
<p>We will first describe our motion model that gives rise to <italic>P</italic><sub><monospace>prior</monospace></sub>(<italic>s</italic>) in 2.1.2, and then the observation model that defines <italic>P</italic><sub><monospace>obs</monospace></sub>(<monospace>obs</monospace>|<italic>s</italic>) in 2.1.3.</p>
</sec>
<sec id="s2a2">
<label>2.1.2</label>
<title>The Motion Model</title>
<p>We model particle motion using Gaussian-Process (GP) regression. GPs have been in use by the machine learning community for decades [<xref ref-type="bibr" rid="c17">17</xref>], and they have found applications in the fields of computer vision [<xref ref-type="bibr" rid="c13">13</xref>], computer graphics [<xref ref-type="bibr" rid="c23">23</xref>] and robotics [<xref ref-type="bibr" rid="c16">16</xref>].</p>
<p>Formally, a GP is defined as a distribution over the space of functions <italic>f</italic>(<italic>x</italic>) such that for every finite selection of <italic>x<sub>i</sub></italic>, the corresponding <italic>f</italic>(<italic>x<sub>i</sub></italic>) follow a multivariate normal distribution. A GP can therefore be thought of as an extension of the concept of a multivatiate normal distribution to cover the (infinitely-dimensional) Hilbert space of functions. Although the term process suggests <italic>x</italic> being a one-dimensional time variable, a GP can in fact be defined over any domain. In our case, we use the particle positions in the micrograph (i.e. a 2D plane) as that domain, while the function <italic>f</italic>(<italic>x</italic>) will be used to describe the velocity vectors of particles.</p>
<p>In its most general form, a GP is defined by a mean <italic>&#x03BC;</italic>(<italic>x</italic>) and a covariance function <italic>C</italic>(<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>). In our specific case, we will assume the mean velocity to be zero, and we will work with <italic>homogeneous</italic> GPs, where the covariance between two points <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> depends only on their distance <italic>d</italic> &#x003D; |<italic>x</italic><sub>2</sub> &#x2212; <italic>x</italic><sub>1</sub>|. We will use the GP to enforce spatial smoothness of the motion vectors. This means that the covariance <italic>C</italic>(<italic>d</italic>) between two velocity vectors will be greater for particles that are closer together.</p>
<p>Specifically, the covariance between the velocities of two particles <italic>p</italic> and <italic>q</italic> is modelled by the exponential kernel:
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="384537_eqn2.gif"/></alternatives>
</disp-formula>
where <italic>&#x03C3;<sub>V</sub></italic> describes the expected amount of motion, while <italic>&#x03C3;<sub>D</sub></italic> describes its spatial correlation length. Since the overall beam-induced motion of the particles is generally far smaller than their mutual distance (a few &#x00C5; vs. hundreds of &#x00C5;), we chose to compute the covariance based on the initial particle positions alone &#x2013; this is why the subscript <italic>f</italic> is missing in <xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref>.</p>
<p>We can write the covariances of all particles <italic>C</italic>(<italic>v<sub>p</sub></italic>, <italic>v<sub>q</sub></italic>) into a <italic>P &#x00D7; P</italic> covariance matrix &#x03A3;<italic><sub>V</sub></italic>, which then describes the per-frame multivariate normal distribution of all velocity vectors <italic>v<sub>p,j</sub></italic>. As is commonly done in GP regression, we perform a singular-value decomposition on &#x03A3;<italic><sub>V</sub></italic> to obtain a more practical parametrization for our problem:
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="384537_eqn3.gif"/></alternatives>
</disp-formula></p>
<p>This allows us to define a set of basis vectors <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline2.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline3.gif"/></alternatives></inline-formula> is the <italic>i<sup>th</sup></italic> singular value and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline4.gif"/></alternatives></inline-formula> is its associated singular vector (i.e. column of <italic>W</italic> or row of <italic>W<sup>T</sup></italic>). For each frame, the <italic>x</italic> and <italic>y</italic> component of the velocity vectors <italic>v<sub>p</sub></italic> of all particles <italic>p</italic> can now be expressed as linear combinations of <italic>b<sub>i</sub></italic> with a set of <italic>P</italic> coefficients <italic>c<sub>i</sub></italic>:
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="384537_eqn4.gif"/></alternatives>
</disp-formula></p>
<p>In this parametrization, the per-frame joint likelihood of that set of velocities has a particularly simple form:
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="384537_eqn5.gif"/></alternatives>
</disp-formula></p>
<p>For this reason, we use <italic>F</italic> &#x2212; 1 sets of coefficients <italic>c<sub>i,f</sub></italic> as the unknowns in our problem. Since the <italic>c<sub>i</sub></italic> only describe the velocities, they only determine the positions <italic>s<sub>p,f</sub></italic> up to a per-particle offset. The complete set of unknowns for a micrograph therefore also has to include the initial positions <italic>s</italic><sub><italic>p</italic>,0</sub>. The initial positions have no effect on the prior probability, however.</p>
<p>Formally, for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline5.gif"/></alternatives></inline-formula>, the positions are then given as a function of all <italic>c<sub>i,f</sub></italic> by:
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="384537_eqn6.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="384537_eqn7.gif"/></alternatives>
</disp-formula></p>
<p>So far, we have only modelled the spatial smoothness of the motion. To impose temporal smoothness, we define the complete prior probability as
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="384537_eqn8.gif"/></alternatives>
</disp-formula>
with
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="384537_eqn9.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="384537_eqn10.gif"/></alternatives>
</disp-formula>
where <italic>&#x03C3;<sub>A</sub></italic> is the third and final motion parameter that describes the average acceleration of a particle during a frame, i.e. the std. deviation of the change in velocity between two consecutive frames.</p>
<p>The temporal smoothness term <italic>P</italic><sub><monospace>time</monospace></sub> corresponds to the one proposed by Rubinstein and Brubaker [<xref ref-type="bibr" rid="c19">19</xref>] for individual particles. From the orthogonality of the basis <italic>b<sub>i</sub></italic>, it follows that in our parametrization,
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="384537_eqn11.gif"/></alternatives>
</disp-formula></p>
</sec>
<sec id="s2ac">
<label>2.1.3</label>
<title>The Observation Model</title>
<p>In the following, we will derive the observation likelihood <italic>P</italic><sub><monospace>obs</monospace></sub>(<monospace>obs</monospace>|<italic>x</italic>). Since we assume a 3D reference map, the viewing angles and the microscope parameters to be known, we can predict the appearance of a particle using the reference map [<xref ref-type="bibr" rid="c20">20</xref>]. This is done by integrating the reference map along the viewing direction, which can be accomplished efficiently by extracting a central slice in Fourier space, and then convolving the resulting image with the known contrast transfer function (CTF).</p>
<p>To maintain the nomenclature from previous Relion papers, we denote pixel <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline6.gif"/></alternatives></inline-formula> of frame <italic>f</italic> of the experimental image of particle <italic>p</italic> by <italic>X<sub>p,f</sub></italic>(<italic>j</italic>) and the same pixel in the prediction by <italic>V<sub>p,f</sub></italic>(<italic>j</italic>). The spectral noise power is measured from all <italic>X</italic> in a micrograph, and both <italic>X</italic> and <italic>V</italic> are filtered in order to whiten the image noise (i.e. decorrelate the noise between the pixels) and to scale it to unit variance. In addition, we use the exponential damage model [<xref ref-type="bibr" rid="c7">7</xref>] to suppress the high frequencies in the later frames in <italic>V</italic>.</p>
<p>By assuming that the noise in the pixels is Gaussian and independent, it follows that
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="384537_eqn12.gif"/></alternatives>
</disp-formula></p>
<p>Since the prediction <italic>V</italic> is zero outside of the molecule, the image area over which this sum is evaluated only influences the scale of <italic>P</italic><sub><monospace>obs</monospace></sub>, but not its shape. In practice, we cut out a square from the micrograph that contains the molecule (including a certain amount of padding around it to account for its motion) and evaluate <italic>P</italic><sub><monospace>obs</monospace></sub> on that square.</p>
<p>In order to evaluate <italic>P</italic><sub><monospace>obs</monospace></sub>(<monospace>obs</monospace>|<italic>s</italic>) efficiently for different hypothetical particle positions <italic>s</italic>, we use the following identity:
<disp-formula id="eqn13">
<alternatives><graphic xlink:href="384537_eqn13.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn14">
<alternatives><graphic xlink:href="384537_eqn14.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn15">
<alternatives><graphic xlink:href="384537_eqn15.gif"/></alternatives>
</disp-formula>
where <monospace>CC</monospace><sub><italic>p,f</italic></sub> denotes the cross-correlation between <italic>X<sub>p,f</sub></italic> and <italic>V<sub>p,f</sub></italic>, which is computed for a Cartesian grid of integral <italic>s</italic> simultaneously via a convolution in Fourier space. The constant offset <italic>K</italic> merely scales the resulting probability <italic>P</italic><sub><monospace>obs</monospace></sub>, so it does not alter the location of the maximum of <italic>P<sub>AP</sub></italic> &#x003D; <italic>P</italic><sub><monospace>prior</monospace></sub><italic>P</italic><sub><monospace>obs</monospace></sub>. We can thus define
<disp-formula id="eqn16">
<alternatives><graphic xlink:href="384537_eqn16.gif"/></alternatives>
</disp-formula></p>
<p>To determine the values of <monospace>CC</monospace><sub><italic>p,f</italic></sub> at fractional coordinates, we apply cubic interpolation. This ensures a continuous gradient.</p>
</sec>
<sec id="s2a4">
<label>2.1.4</label>
<title>Optimisation</title>
<p>To avoid numerical difficulties, we maximise <italic>P</italic><sub><monospace>AP</monospace></sub>(<italic>s</italic>|<monospace>obs</monospace>) by instead minimizing its doubled negative log, <italic>E</italic><sub>AP</sub> &#x003D; &#x2212;2log(<italic>P</italic><sub><monospace>AP</monospace></sub>). The doubling serves to simplify the terms. All the products in <italic>P</italic><sub><monospace>AP</monospace></sub> become sums in <italic>E</italic><sub><monospace>AP</monospace></sub>, yielding:
<disp-formula id="eqn17">
<alternatives><graphic xlink:href="384537_eqn17.gif"/></alternatives>
</disp-formula>
where the terms <italic>E</italic><sub><monospace>pace</monospace></sub>, <italic>E</italic><sub><monospace>time</monospace></sub> and <italic>E</italic>&#x2032;<sub><monospace>obs</monospace></sub> are defined analougously. Inserting the terms defined in 2.1.2 and 2.1.3 yields:
<disp-formula id="eqn18">
<alternatives><graphic xlink:href="384537_eqn18.gif"/></alternatives>
</disp-formula></p>
<p>The expression in <xref ref-type="disp-formula" rid="eqn18">Eq. 18</xref> is differentiated with respect to the coefficients <italic>c<sub>i,f</sub></italic> and initial positions <italic>s</italic><sub><italic>p</italic>,0</sub> for all <italic>i</italic> and <italic>f</italic>, and the combination that minimises <italic>E</italic><sub><monospace>AP</monospace></sub>(<italic>c</italic>, <italic>s</italic><sub>0</sub>|<monospace>obs</monospace>) is determined using the L-BFGS algorithm [<xref ref-type="bibr" rid="c11">11</xref>]. In order to avoid overfitting, all particles are aligned against a reference computed from their own independently refined half-set [<xref ref-type="bibr" rid="c22">22</xref>].</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Parameter Estimation for the Statistics of Motion</title>
<p>The estimation procedure described in 2.1 requires three parameters (<italic>&#x03C3;<sub>V</sub></italic>, <italic>&#x03C3;<sub>D</sub></italic> and <italic>&#x03C3;<sub>A</sub></italic>) for the prior that encapsulate the statistics of particle motion. Since the precise positions of the particles can never be observed directly, measuring those statistics requires performing a process of hyper-optimization, i.e. optimizing motion parameters that produce the best motion estimates. This renders the entire approach an empirical Bayesian one. The simplest solution would be to perform a complete motion estimation for each hypothetical triplet of motion parameters. As the motion estimation usually takes multiple hours on a non-trivial dataset, this would become prohibitive for a 3D-grid of parameters.</p>
<p>Instead, we estimate the optimal parameters using the following iterative procedure. First, we select a representative random subset <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline7.gif"/></alternatives></inline-formula> of micrographs that contain at least a pre-defined minimal number of particles (25,000 in our experiments). Then, we perform the following three steps iteratively.
<list list-type="order">
<list-item><p>Choose a hypothetical parameter triplet <italic>&#x03C3;<sub>V</sub></italic>, <italic>&#x03C3;<sub>D</sub></italic> and <italic>&#x03C3;<sub>A</sub></italic>.</p></list-item>
<list-item><p>Align all micrographs in <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline8.gif"/></alternatives></inline-formula> using those parameters.</p></list-item>
<list-item><p>Evaluate the parameters.</p></list-item>
</list></p>
<p>The iterations are performed using the Nelder-Mead uphill simplex algorithm [<xref ref-type="bibr" rid="c15">15</xref>] which does not rely on the function over which it optimises being differentiable.</p>
<p>In order to evaluate a parameter triplet, we perform the alignment only on a limited range of spatial frequencies (the <italic>alignment circle</italic>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline9.gif"/></alternatives></inline-formula>). The remainder of frequencies, the <italic>evaluation ring</italic> &#x007B;|<italic>k</italic>| &#x003E; <italic>T</italic>&#x007D;, is used to evaluate that alignment. To avoid overfitting, i.e. to retain a strict separation of the two half-sets, we perform the alignment against a reference obtained from the same half-set to which the respective particle belongs. For the evaluation, we use a reference obtained from the opposite half-set to avoid the particle &#x201C;finding itself&#x2019; [<xref ref-type="bibr" rid="c7">7</xref>] in the reference. Note that the latter does not incur any risk of overfitting, since the alignment is already known by the time it is evaluated, and the small number of parameters (i.e. three values) leaves no room for overfitting.</p>
<p>The partition of frequency space into an alignment circle and an evaluation ring is necessary: if the alignment and the evaluation were to be performed on the same frequencies <italic>k</italic>, then a weaker prior would always produce a greater correlation than a stronger one. Note that this would happen in spite of splitting of the particles into independent half-sets, because an insufficiently regularised alignment will align the noise <italic>in the images</italic> with the signal in the reference, while the two references share the same signal in the frequency range in which they are meaningful.</p>
<p>The evaluation itself is performed by measuring what we propose to call the thick-cylinder correlation <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline10.gif"/></alternatives></inline-formula> between the aligned images and the reference:
<disp-formula id="eqn19">
<alternatives><graphic xlink:href="384537_eqn19.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline11.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline12.gif"/></alternatives></inline-formula> are the Fourier-space amplitudes of frequency <italic>k</italic> of the observed image and the prediction, respectively. The indices denote frame <italic>f</italic> of particle <italic>p</italic> in micrograph <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline13.gif"/></alternatives></inline-formula>. The prediction <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline14.gif"/></alternatives></inline-formula> has been shifted according to the estimated <italic>s<sub>m,p,j</sub></italic>, i.e. <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline15.gif"/></alternatives></inline-formula>. The asterisk indicates complex conjugation and &#x2329;,&#x232A; a 2D scalar product.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Damage Weighting</title>
<p>Once the frames of a movie have been aligned, we compute a filtered average over them that aims to maximise the signal-to-noise ratio in each frequency. In the original particle polishing method [<xref ref-type="bibr" rid="c21">21</xref>], the proposed image recombination approach was based on relative B-factors. We use that same approach here, but we propose a more practical and more robust means of estimating the relative B-factors.</p>
<p>The original technique required computing two full 3D reconstructions from particle images of every frame, one for each independently refined half-set. In a typical dataset comprising 40 frames, this would amount to computing 80 individual reconstructions, which requires days of CPU time. The two corresponding reconstructions would then be used to determine the Fourier Shell Correlation (FSC) in order to estimate the spectral signal-to-noise ratio (SSNR) of the 3D reconstruction.</p>
<p>Our new method is more practical in that it avoids the computation of those 3D reconstructions. Instead, we directly measure the correlation between the aligned frames and the reference as soon as the particles in a movie have been aligned. This is done by evaluating what we have termed the Fourier-cylinder correlation <monospace>FCC</monospace>(<italic>f</italic>, <italic>&#x03BA;</italic>) for each frame index <italic>f</italic> and Fourier shell <italic>&#x03BA;</italic>. This amounts to correlating the set of Fourier rings of radius <italic>&#x03BA;</italic> against the reference for all particles simultaneously, hence the term Fourier cylinder.</p>
<p>Formally, the <monospace>FCC</monospace> is defined as follows:
<disp-formula id="eqn20">
<alternatives><graphic xlink:href="384537_eqn20.gif"/></alternatives>
</disp-formula>
for <italic>k</italic> and <italic>&#x03BA;</italic> given in pixels. It can be evaluated by iterating over the dataset only once, updating the three sums in <xref ref-type="disp-formula" rid="eqn20">Eq. 20</xref> for each particle in each micrograph.</p>
<p>The FCC allows us to estimate the SSNR of the aligned images themselves, not of the 3D reconstructions. The fact that those SSNR values are different is of no concern, as we are only interested in their relative change as a function of frame index <italic>f</italic>. Since the value of each voxel of a 3D reconstruction is an average over the pixels from many images, the relative change in the SNR of that voxel over time is the same as for the corresponding pixels.</p>
<p>Once the <monospace>FCC</monospace> has been determined, we proceed to fit the relative B-factors. This is done by finding a <italic>B<sub>f</sub></italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline16.gif"/></alternatives></inline-formula> for each frame <italic>f</italic> and a <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="384537_inline17.gif"/></alternatives></inline-formula> for each frequency ring <italic>&#x03BA;</italic> that minimise:
<disp-formula id="eqn21">
<alternatives><graphic xlink:href="384537_eqn21.gif"/></alternatives>
</disp-formula></p>
<p>Here, the coefficients <italic>D<sub>&#x03BA;</sub></italic> are nuisance parameters that encapsulate the amount of signal in the reference in each frequency band <italic>&#x03BA;</italic>. This allows the <italic>B<sub>f</sub></italic> and <italic>C<sub>f</sub></italic> factors to only express the variation in signal over the frame index <italic>f</italic>. The <italic>D<sub>&#x03BA;</sub></italic> are higher for frequencies that are more prominent in the structure (such as those of alpha-helices) and they are zero beyond the resolution of the current reference map. In the previous particle polishing formulation, the D<sub>&#x03BA;</sub> correspond to a Gaussian over <italic>&#x03BA;</italic> given by the average B-factor. The coefficients <italic>B<sub>f</sub></italic> and <italic>C<sub>f</sub></italic> maintain the same meaning as in the previous formulation, i.e. the change in high-frequency information and overall contrast over time, respectively. An illustration of the model is shown in <xref ref-type="fig" rid="fig2">Fig. 2</xref>.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p><italic>An illustration of FCC-based B-factor fitting using the <italic>&#x03B2;</italic>-galactosidase dataset as an example (best viewed in colour)</italic>. <bold>(a)</bold><italic>: The FCC computed using <xref ref-type="disp-formula" rid="eqn20">Eq. 20</xref> as a function of spatial frequency &#x03BA; and frame f</italic>. <bold>(b)</bold><italic>: A fit of B<sub>f</sub>, C<sub>f</sub> and D<sub>&#x03BA;</sub> according to <xref ref-type="disp-formula" rid="eqn21">Eq. 21</xref> with plots of B<sub>f</sub> and D<sub>&#x03BA;</sub> shown in relation</italic>. <bold>(c)</bold><italic>: The same fit with all D<sub>&#x03BA;</sub> set to 1 (i.e. the numerator of Eq.22)</italic>. <bold>(d)</bold><italic>: The normalized weights w<sub>&#x03BA;,j</sub> as given by <xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref></italic>.</p></caption>
<graphic xlink:href="384537_fig2.tif"/>
</fig>
<p>The factors <italic>B<sub>f</sub></italic>, <italic>C<sub>f</sub></italic> and <italic>D<sub>&#x03BA;</sub></italic> are estimated iteratively, by first finding the optimal <italic>D<sub>&#x03BA;</sub></italic> for each <italic>&#x03BA;</italic> given the current <italic>B<sub>f</sub></italic> and <italic>C<sub>f</sub></italic>, and then the optimal <italic>B<sub>f</sub></italic> and <italic>C<sub>f</sub></italic> given the current <italic>D<sub>&#x03BA;</sub></italic>. The optimal <italic>D<sub>&#x03BA;</sub></italic> can be determined linearly, while the <italic>B<sub>f</sub></italic> and <italic>C<sub>f</sub></italic> are found through a recursive 1D-search over <italic>B<sub>f</sub></italic> &#x2013; the optimal <italic>C<sub>f</sub></italic> for a given <italic>B<sub>f</sub></italic> can also be determined linearly. In our implementation, the entire procedure is run for 5 iterations, and it typically takes less than a second to complete.</p>
<p>The final weight of each Fourier-space pixel is then given by:
<disp-formula id="eqn22">
<alternatives><graphic xlink:href="384537_eqn22.gif"/></alternatives>
</disp-formula></p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Implementation</title>
<p>The motion estimation algorithm has been implemented using MPI, allowing it to align multiple micrographs in parallel on different computers. The processes that are run on each of those computers are further parallelised using OpenMP, which allows the user to exploit all of the available CPU cores on all of the available computers at the same time. Although it is also possible to align multiple micrographs on the same computer simultaneously by running multiple MPI processes there, we discourage this, since it requires each of those processes to maintain its own data in memory. If the multiple CPU cores of the same computer are instead allowed to cooperate in aligning the same micrograph, then the memory is only taken up once.</p>
<p>The memory footprint of the motion estimation algorithm consists primarily of the two 3D reference maps (one for each independently refined half-set) and the pixels of the micrograph that is currently being processed. In most cases, this requires approximately 20 Gb of memory for each MPI process.</p>
<p>Due to its iterative nature, the parameter hyperoptimisation algorithm does not allow for MPI par-allelisation. Furthermore, in order to avoid loading the subset of micrographs from disk in each iteration, all the necessary data are stored in memory. For this reason, the memory footprint of the parameter hyperoptimisation algorithm could exceed 60 Gb for the 25,000 particles used in our experiments. Although a smaller number of particles does reduce this footprint, it also renders the estimated optimal parameters less accurate.</p>
<p>Finally, in order to save disk space, the entire motion estimation pipeline supports micrographs stored as compressed TIFF images. Such images contain the integral numbers of counted electrons for each pixel, which enables very efficient compression: usually, by a factor of about 30. Due to the integral pixel values, an external gain reference has to be provided if such TIFF images are being used.</p>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>Experimental Design</title>
<p>We evaluated Bayesian polishing on three publicly available datasets that cover a range of particle sizes: the <italic>P. falciparum</italic> cytoplasmic ribosome (EMPIAR 10028), <italic>E. coli &#x03B2;</italic>-galactosidase (EMPIAR 10061) and human <italic>&#x03B3;</italic>-secretase (EMPIAR 10194). For all three cases, our group has previously published structures calculated using the original particle polishing approach [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c3">3</xref>]. We used the same particles and masks for both polishing and the final high-resolution refinement as were used in those papers. Further information on these datasets is shown in <xref ref-type="table" rid="tbl1">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p><italic>Properties of the three datasets. The two entries in the particle number column refer to the number used during motion estimation and refinement, respectively</italic>.</p></caption>
<graphic xlink:href="384537_tbl1.tif"/>
</table-wrap>
<p>The experiments were set up as follows. First, the input movies were aligned and dose-filtered using <italic>MotionCor2</italic> [<xref ref-type="bibr" rid="c25">25</xref>]. From these aligned micrographs, particles were extracted and an initial reference reconstruction was computed using <sc>relion</sc>&#x2019;s 3D auto-refinement procedure [<xref ref-type="bibr" rid="c20">20</xref>]. With this reference map, the three parameters that describe the statistics of motion (<italic>&#x03C3;<sub>V</sub></italic>, <italic>&#x03C3;<sub>D</sub></italic> and <italic>&#x03C3;<sub>A</sub></italic>) were determined for each dataset, and the Bayesian polishing algorithm was run on the original, unaligned micrographs. One set of B-factors were estimated for an entire dataset, assigning one B-factor value to each frame index. Using these, a set of motion-corrected and B-factor-weighted particle images were computed, called <italic>shiny</italic> particles in <sc>relion</sc>, which were then used for a second round of 3D auto-refinement to produce a final map.</p>
<p>Since the official UCSF implementation of <italic>MotionCor2</italic> does not output motion that can be easily interpolated at the positions of the individual particles, we have written our own version of <italic>MotionCor2</italic>. The two implementations are not completely identical. Specifically, our version lacks the fallback mechanism of considering larger tiles if the signal in a tile is insufficient, and it only estimates one set of polynomial coefficients for the entire frame range, while the UCSF implementation always estimates two. In Sec. 3.4, we will show direct comparisons of the FSCs resulting from the two versions to confirm that they give similar resolutions of the final reconstructions.</p>
<p>The particle trajectories for Bayesian polishing were initialised with the motion estimated by our version of <italic>MotionCor2</italic>. This initialisation does not appear to be strictly necessary, however, since in most cases the Bayesian polishing algorithm converged to the same optima if initialised with an unregularised global trajectory. As an example, 90&#x0025; of the final <italic>&#x03B2;</italic>-galactosidase particle positions showed a difference of less than 10<sup>-4</sup> pixels as a result of initialisation.</p>
<p>The resulting maps were compared with ones obtained from both versions of <italic>MotionCor2</italic> and with the previously published results. Since the resolution of the resulting maps is influenced by many different factors beyond particle motion, we assume that the estimated relative B-factors reflect the efficacy of motion estimation more reliably than the resolution alone. For that reason, we have also compared the estimated B-factors to those obtained from our version of <italic>MotionCor2</italic> and to the previously published ones. A B-factor comparsion to the UCSF version of <italic>MotionCor2</italic> is not possible, since the particle trajectories are not readily available.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results and Discussion</title>
<sec id="s3a">
<label>3.1</label>
<title>Motion Parameters</title>
<p>The motion parameters were estimated as described in Sec. 2.2. The results are shown in <xref ref-type="table" rid="tbl2">Table 2</xref>. We used 25,000 randomly selected particles to estimate the parameters. Performing these calculations multiple times showed that the random subset of micrographs that was used to select the 25,000 particles did affect the outcome of the actual values. Specifically, subsets containing micrographs that exhibited a large amount of stage drift would produce a simultaneous increase in the values of <italic>&#x03C3;<sub>V</sub></italic> and <italic>&#x03C3;<sub>D</sub></italic>, i.e. stronger and spatially smoother motion. Nevertheless, the choice among different such parameter triplets did not have a measurable impact on the resolution of the resulting reconstructions (results not shown). We assume that stage drift is also the most important reason behind the difference in parameter values among the three datasets, though other reasons might include the size of the molecule and the thickness of the ice.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p><italic>Optimal parameter values used for motion estimation. The values of &#x03C3;v and &#x03C3;<sub>A</sub> are normalised by fractional dose (which is given in e<sup>&#x2212;</sup>/&#x00C5;)</italic>.</p></caption>
<graphic xlink:href="384537_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Motion</title>
<p>Using the motion parameters from <xref ref-type="table" rid="tbl2">Table 2</xref>, we estimated the motion trajectories for all particles in the three data sets. These calculations took 128 CPU-hours for the ribosome and 778 CPU-hours for <italic>&#x03B2;</italic>-galactosidase on 3.0 GHz Intel Xeon cores, and 1,464 CPU-hours for <italic>&#x03B3;</italic>-secretase on 2.9 GHz Intel Xeon cores. This is comparable to the computational cost of the existing movie refinement implementation in RELION. Examples of trajectories estimated by Bayesian polishing and our implementation of <italic>MotionCor2</italic> are shown in <xref ref-type="fig" rid="fig3">Fig. 3</xref>. A qualitative comparison suggests that they describe the same motion, although they differ in the details. The difference is the most pronounced for <italic>&#x03B2;</italic>-galactosidase, where the motion statistics correspond to very incoherent motion (i.e. a low <italic>&#x03C3;<sub>D</sub></italic>). In addition, the trajectories from Bayesian polishing are smoother than the trajectories from <italic>MotionCor2</italic>. This is due to the fact that the global component of the motion is not regularised in <italic>MotionCor2</italic>. The latter has probably no real impact on the resolution of the reconstruction, since the irregularities are far smaller than one pixel. However, quantitative statements about the quality of motion estimation can only be made once a full reconstruction has been computed. This will be done in Sec. 3.4.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p><italic>Example trajectories using our own version of</italic> MotionCor2 <italic>(left) and Bayesian polishing (right) for the ribosome (top), <italic>&#x03B2;</italic>-galactosidase (center) and &#x03B3;-secretase (bottom). Particle motion is scaled by a factor of</italic> 30. <italic>The blue dot indicates the start of the trajectory</italic>.</p></caption>
<graphic xlink:href="384537_fig3.tif"/>
</fig>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>B-factors</title>
<p>From the particle trajectories estimated by both Bayesian polishing and our implementation of <italic>MotionCor2</italic>, we computed the FCCs as defined in <xref ref-type="disp-formula" rid="eqn20">Eq. 20,</xref> and from those the <italic>B<sub>f</sub></italic>, <italic>C<sub>f</sub></italic> and <italic>D<sub>&#x03BA;</sub></italic> factors. Since the three sums in <xref ref-type="disp-formula" rid="eqn20">Eq. 20</xref> are updated after the alignment of each micrograph, once all of them have been aligned, the computation of the B-factors only takes fractions of a second. In the previous particle polishing implementation, this step would take up multiple days of additional CPU time to calculate two half-set reconstructions for each movie frame. A comparison between the B-factors obtained by the two methods are shown in <xref ref-type="fig" rid="fig4">Fig. 4</xref>. A comparison to the previously published B-factors is shown on the left-hand side of <xref ref-type="fig" rid="fig6">Fig. 6</xref>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p><italic>Relative B-factors for the ribosome (top), &#x03B2;-galactosidase (center) and &#x03B3;-secretase (bottom). The two sets of B-factors share the same D<sub>&#x03BA;</sub> factors, making their relative vertical position meaningful. The observation that the B-factors from the Bayesian polishing are higher than the ones from our</italic> MotionCor2 <italic>implementation suggest that Bayesian polishing models the motion more accurately</italic>.</p></caption>
<graphic xlink:href="384537_fig4.tif"/>
</fig>
<p>Generally, a set of relative B-factors can be shifted by a constant offset without altering the resulting pixel-weights. Such a shift corresponds to multiplying the <italic>D<sub>&#x03BA;</sub></italic> factors by a Gaussian over <italic>&#x03BA;</italic>, and it cancels out when the division in <xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref> is performed. In order to make a meaningful comparison between the B-factors for motion estimated by Bayesian polishing and <italic>MotionCor2</italic>, we have estimated both sets of B-factor with the same <italic>D<sub>&#x03BA;</sub></italic> factors. This is equivalent to treating the movie frames aligned using Bayesian-polishing and those aligned using our implementation of the <italic>MotionCor2</italic> algorithm as a movie of twice the length. As can be seen in <xref ref-type="fig" rid="fig4">Fig. 4</xref>, the B-factors from Bayesian polishing are better over all frames for all three cases. The average improvement in B-factor over all frames is 9 &#x00C5;<sup>-2</sup> for the ribosome, 26 &#x00C5;<sup>-2</sup> for <italic>&#x03B2;</italic>-galactosidase, and 15 &#x00C5;<sup>-2</sup> for &#x03B3;-secretase. These increases suggest that more high-resolution signal is present, and hence that Bayesian polishing models motion more accurately than the <italic>MotionCor2</italic> algorithm. We will confirm this in the following section.</p>
<p>To confirm that our new technique of estimating B-factors does not yield systematically different B-factors from the original method [<xref ref-type="bibr" rid="c21">21</xref>], we also calculated the B-factors using the original method, but with the trajectories from Bayesian polishing, for comparison. These plots are shown on the left-hand side of <xref ref-type="fig" rid="fig6">Fig. 6</xref> and they indicate that the new technique produces values that are close to those obtained through the old one. The similarity between the two curves is especially striking for the ribosome dataset (top left in <xref ref-type="fig" rid="fig6">Fig. 6</xref>), where image contrast is the strongest. The greater smoothness of the curve obtained through the new technique in the <italic>&#x03B2;</italic>-galactosidase plot (center left in <xref ref-type="fig" rid="fig6">Fig. 6</xref>) indicates that the new technique is more robust than the old one. This is to be expected, since the linear Guinier-fit applied by the old technique [<xref ref-type="bibr" rid="c21">21</xref>] has to rely on the frequency range where the FSC is sufficiently large, and that range can become very small in later frames.</p>
</sec>
<sec id="s3d">
<label>3.4</label>
<title>Resolution</title>
<p>Finally, the gold-standard FSCs are compared to those from the two <italic>MotionCor2</italic> implementations in <xref ref-type="fig" rid="fig5">Fig. 5</xref> and to the previously published results on the right-hand side of <xref ref-type="fig" rid="fig6">Fig. 6</xref>.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><p><italic>Gold-standard FSC plots for the ribosome (top), &#x03B2;-galactosidase (center) and &#x03B3;-secretase (bottom). The values in parentheses indicate the</italic> 0.143-<italic>FSC resolution. The continuous orange line results from the official UCSF implementation of</italic> MotionCor2, <italic>the dotted black line from our own</italic>.</p></caption>
<graphic xlink:href="384537_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><p><italic>Comparison to previously published results for the ribosome (top), &#x03B2;-galactosidase (center) and &#x03B3;-secretase (bottom)</italic>. <bold>Left</bold><italic>: Relative B-factors. Unlike in <xref ref-type="fig" rid="fig4">Fig. 4</xref>, the vertical positions of these curves are arbitrary &#x2013; only their shape holds any meaning. The continuous black and the dotted grey lines correspond to the same motion estimate, but they have been determined using the new and the old B-factor estimation technique, respectively. Their similarity indicates that the new technique estimates the same B-factors as the old one, albeit in a more robust way. The dashed blue line corresponds to previously published B-factors. Note the stark improvement in the beginning of the sequence</italic>. <bold>Right</bold><italic>: FSC curves comparing the new results to the previously published ones. Please note that the old polishing approach estimated the motion as superimposed over that estimated by another, reference-free method, while Bayesian polishing always works on the raw unaligned micrographs and aims to model the entire motion by itself</italic>.</p></caption>
<graphic xlink:href="384537_fig6.tif"/>
</fig>
<p>The FSCs were measured under the same solvent mask as had been used in the three previous publications and the effects of mask-induced correlation were corrected for through phase-randomisation [<xref ref-type="bibr" rid="c6">6</xref>] using RELION&#x2019;s post-processing program. To further improve their precision, the resolutions indicated in the figures have been measured as the resolutions at which the linearly interpolated FSCs cross the 0.143 threshold.</p>
<p>As can be seen in the FSC plots, Bayesian polishing leads to an increase in resolution over both <italic>MotionCor2</italic> and the previously published results in all three cases. The increase over <italic>MotionCor2</italic> is the greatest for the <italic>&#x03B2;</italic>-galactosidase dataset. We assume that this is because that dataset extends to higher resolution than the other two data sets, and Bayesian polishing makes more efficient use of the high spatial frequencies by comparing the noisy movie frames with high-resolution reference projections. This assumption is further supported by the fact that <italic>&#x03B2;</italic>-galactosidase is also the only dataset on which traditional polishing applied after Unblur produces a better reconstruction than running <italic>MotionCor2</italic> alone. Compared to our previously published results, the increase in resolution is highest for the ribosome dataset. We assume that this is because of the high molecular weight of these particles, which allow for precise modelling of the motion tracks. The &#x03B3;-secretase data set yields the smallest increases in resolution, both in comparison with <italic>MotionCor2</italic> and our previous results. Possible reasons for this will be discussed in the following.</p>
<p>We have also analysed the resolution of the resulting reconstructions as a function of the number of particles, as proposed by Rosenthal and Henderson [<xref ref-type="bibr" rid="c18">18</xref>]. These plots are shown for both our results and those obtained from the UCSF implementation of MotionCor2 in <xref ref-type="fig" rid="fig7">Fig. 7</xref>. They indicate that in order to reach the same maximum resolution with Bayesian Polishing as with the UCSF implementation of MotionCor2, only 66&#x0025; of the particles are needed for the ribosome and only as little as 30&#x0025; for <italic>&#x03B2;</italic>-galactosidase. For &#x03B3;-secretase, only 60&#x0025; of the particles are needed to reach the same <italic>intermediate</italic> resolutions, although the same number of particles are required to obtain the maximum resolution. This suggests that at high resolutions, &#x03B3;-secretase is limited by additional effects beyond the experimental noise and the uncertainty in particle alignment. Such effects could include molecular heterogeneity, anisotropic magnification, an insufficient particle box size or variations in microscope parameters across the dataset. The latter is especially likely since this dataset was collected in six different sessions over a time span of half a year.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><p><italic>Plot of the inverse-squared resolution as a function of the number of particles, as proposed by Rosenthal and Henderson [18] for the ribosome (top), &#x03B2;-galactosidase (center) and &#x03B3;-secretase (bottom). The horizontal distance between the curves describes the fraction of the number of particles required to obtain the same resolution with Bayesian Polishing as with the UCSF implementation of MotionCor2. The indicated, distances correspond to 66&#x0025;, 30&#x0025; and 60&#x0025; of the particles, respectively. Note that the horizontal distance shrinks to zero at the right-hand edge of the &#x03B3;-secretase plot. This implies that the &#x03B3;-secretase dataset is limited by additional effects at high resolutions</italic>.</p></caption>
<graphic xlink:href="384537_fig7.tif"/>
</fig>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Conclusions</title>
<p>We have presented Bayesian polishing, a new method for the estimation of particle motion and of the corresponding per-frame relative B-factors. We have compared our method to <italic>MotionCor2</italic> and to the previously existing particle polishing method in RELION on three publicly available datasets. In all three cases, Bayesian polishing led to an increase in resolution over both alternatives. Since the FSC-based resolution estimates are influenced by many other factors besides particle motion, the accuracy of motion estimation was also measured by comparing the estimated relative B-factors. We have shown that Bayesian polishing produces better B-factors than our implementation of <italic>MotionCor2</italic> for all frames of all datasets, with an average improvement over all three data sets of 16 <sup>&#x00C5;</sup>A<sup>2</sup>, while the achieved resolution after refinement shows that our implementation of <italic>MotionCor2</italic> is comparable to the official UCSF implementation. The comparison of the shapes of our new B-factor curves to our previously published curves suggests that Bayesian Polishing captures significantly more of the initial motion than the existing particle polishing method in RELION. This allows the use of almost as much high-resolution data from the first few movie frames as from the intermediate movie frames, thereby obviating the need for the practice of discarding the first few movie frames [<xref ref-type="bibr" rid="c10">10</xref>]. Finally, we have shown that the new FCC-based technique of estimating B-factors measures the same B-factors as in the existing particle polishing method, but much faster and more robustly.</p>
<p>We have also presented a method that enables the user to determine the optimal parameters governing the statistics of motion. Since the final resolution of the resulting reconstructions appears to be relatively insensitive to those parameters, and the parameter hyperoptimisation algorithm requires considerable amounts of memory, we do not necessarily recommend estimating new parameters for each dataset. Instead, we expect that use of the default values should produce similar results, unless the dataset has been collected under unusual conditions. For example, re-estimating the motion parameters may be necessary for datasets that exhibit a much smaller fractional electron dose or significantly thinner or thicker ice, or if special grids are used that are designed to minimise beam-induced motion.</p>
<p>Bayesian polishing has been implemented as part of the open-source release of <sc>relion</sc>-3.0. The new implementation no longer requires storing aligned micrograph movies or movie particles, and is capable of performing on-the-fly gain correction on movies stored in compressed TIFF format. Thereby, the new implementation strongly reduces the storage requirements of performing particle polishing in <sc>relion</sc>. Because the new method has outperformed the previously existing particle polishing in all tests performed, the new approach replaces the old one on the graphical user interface (GUI) of <sc>relion</sc>-3.0.</p>
</sec>
</body>
<back>
<ack>
<label>5</label>
<title>Acknowledgements</title>
<p>We thank Jake Grimmett and Toby Darling for assistance with high-performance computing, and Christopher Russo and Richard Henderson for critical reading of the manuscript. This work was funded by the UK Medical Research Council (MC&#x005F;UP&#x005F;A025&#x005F;1013 to SHWS) and the Swiss National Science Foundation (SNF: P2BSP2&#x005F;168735 to JZ).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><given-names>Vahid</given-names> <surname>Abrishami</surname></string-name>, <string-name><given-names>Javier</given-names> <surname>Vargas</surname></string-name>, <string-name><given-names>Xueming</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Yifan</given-names> <surname>Cheng</surname></string-name>, <string-name><given-names>Roberto</given-names> <surname>Marabini</surname></string-name>, <string-name><given-names>Carlos &#x00D3;scar S&#x00E1;nchez</given-names> <surname>Sorzano</surname></string-name>, and <string-name><given-names>Jos&#x00E9; Mar&#x00ED;a</given-names> <surname>Carazo</surname></string-name>. <article-title>Alignment of direct detection device micrographs using a robust optical flow approach</article-title>. <source>Journal of structural biology</source>, <volume>189</volume>(<issue>3</issue>):<fpage>163</fpage>&#x2013;<lpage>176</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="other"><string-name><given-names>Xiao-Chen</given-names> <surname>Bai</surname></string-name>, <string-name><given-names>Israel S</given-names> <surname>Fernandez</surname></string-name>, <string-name><given-names>Greg</given-names> <surname>McMullan</surname></string-name>, and <string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name>. <article-title>Ribosome structures to near-atomic resolution from thirty thousand cryo-em particles</article-title>. <source>Elife</source>, <fpage>2</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><given-names>Xiao-Chen</given-names> <surname>Bai</surname></string-name>, <string-name><given-names>Chuangye</given-names> <surname>Yan</surname></string-name>, <string-name><given-names>Guanghui</given-names> <surname>Yang</surname></string-name>, <string-name><surname>Peilong</surname> <given-names>Lu</given-names></string-name>, <string-name><given-names>Dan</given-names> <surname>Ma</surname></string-name>, <string-name><given-names>Linfeng</given-names> <surname>Sun</surname></string-name>, <string-name><given-names>Rui</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name>, and <string-name><given-names>Yigong</given-names> <surname>Shi</surname></string-name>. <article-title>An atomic structure of human &#x03B3;-secretase</article-title>. <source>Nature</source>, <volume>525</volume>(<issue>7568</issue>):<fpage>212</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><given-names>Axel F</given-names> <surname>Brilot</surname></string-name>, <string-name><given-names>James Z</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>Anchi</given-names> <surname>Cheng</surname></string-name>, <string-name><given-names>Junhua</given-names> <surname>Pan</surname></string-name>, <string-name><given-names>Stephen C</given-names> <surname>Harrison</surname></string-name>, <string-name><given-names>Clinton S</given-names> <surname>Potter</surname></string-name>, <string-name><given-names>Bridget</given-names> <surname>Carragher</surname></string-name>, <string-name><given-names>Richard</given-names> <surname>Henderson</surname></string-name>, and <string-name><given-names>Nikolaus</given-names> <surname>Grigorieff</surname></string-name>. <article-title>Beam-induced motion of vitrified specimen on holey carbon film</article-title>. <source>Journal of structural biology</source>, <volume>177</volume>(<issue>3</issue>):<fpage>630</fpage>&#x2013;<lpage>637</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><given-names>Melody G</given-names> <surname>Campbell</surname></string-name>, <string-name><given-names>Anchi</given-names> <surname>Cheng</surname></string-name>, <string-name><given-names>Axel F</given-names> <surname>Brilot</surname></string-name>, <string-name><given-names>Arne</given-names> <surname>Moeller</surname></string-name>, <string-name><given-names>Dmitry</given-names> <surname>Lyumkis</surname></string-name>, <string-name><given-names>David</given-names> <surname>Veesler</surname></string-name>, <string-name><given-names>Junhua</given-names> <surname>Pan</surname></string-name>, <string-name><given-names>Stephen C</given-names> <surname>Harrison</surname></string-name>, <string-name><given-names>Clinton S</given-names> <surname>Potter</surname></string-name>, <string-name><given-names>Bridget</given-names> <surname>Carragher</surname></string-name>, <etal>et al</etal>. <article-title>Movies of ice-embedded particles enhance resolution in electron cryo-microscopy</article-title>. <source>Structure</source>, <volume>20</volume>(<issue>11</issue>):<fpage>1823</fpage>&#x2013;<lpage>1828</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>Shaoxia</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>Greg</given-names> <surname>McMullan</surname></string-name>, <string-name><given-names>Abdul R</given-names> <surname>Faruqi</surname></string-name>, <string-name><given-names>Garib N</given-names> <surname>Murshudov</surname></string-name>, <string-name><given-names>Judith M</given-names> <surname>Short</surname></string-name>, <string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name>, and <string-name><given-names>Richard</given-names> <surname>Henderson</surname></string-name>. <article-title>High-resolution noise substitution to measure overfitting and validate resolution in 3d structure determination by single particle electron cryomicroscopy</article-title>. <source>Ultramicroscopy</source>, <volume>135</volume>:<fpage>24</fpage>&#x2013;<lpage>35</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="other"><string-name><given-names>Timothy</given-names> <surname>Grant</surname></string-name> and <string-name><given-names>Nikolaus</given-names> <surname>Grigorieff</surname></string-name>. <article-title>Measuring the optimal exposure for single particle cryo-EM using a 2.6 &#x00E5; reconstruction of rotavirus vp6</article-title>. <source>Elife</source>, <fpage>4</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>Steven B</given-names> <surname>Hayward</surname></string-name> and <string-name><given-names>Robert M</given-names> <surname>Glaeser</surname></string-name>. <article-title>Radiation damage of purple membrane at low temperature</article-title>. <source>Ultramicroscopy</source>, <volume>4</volume>(<issue>2</issue>):<fpage>201</fpage>&#x2013;<lpage>210</lpage>, <year>1979</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="other"><string-name><given-names>Dari</given-names> <surname>Kimanius</surname></string-name>, <string-name><given-names>Bj&#x00F6;rn O</given-names> <surname>Forsberg</surname></string-name>, <string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name>, and <string-name><given-names>Erik</given-names> <surname>Lindahl</surname></string-name>. <article-title>Accelerated cryo-EM structure determination with parallelisation using gpus in relion-2</article-title>. <source>Elife</source>, <fpage>5</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><given-names>Xueming</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Paul</given-names> <surname>Mooney</surname></string-name>, <string-name><given-names>Shawn</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>Christopher R</given-names> <surname>Booth</surname></string-name>, <string-name><given-names>Michael B</given-names> <surname>Braunfeld</surname></string-name>, <string-name><given-names>Sander</given-names> <surname>Gubbens</surname></string-name>, <string-name><given-names>David A</given-names> <surname>Agard</surname></string-name>, and <string-name><given-names>Yifan</given-names> <surname>Cheng</surname></string-name>. <article-title>Electron counting and beam-induced motion correction enable near-atomic-resolution single-particle cryo-EM</article-title>. <source>Nature methods</source>, <volume>10</volume>(<issue>6</issue>):<fpage>584</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><given-names>Dong C</given-names> <surname>Liu</surname></string-name> and <string-name><given-names>Jorge</given-names> <surname>Nocedal</surname></string-name>. <article-title>On the limited memory bfgs method for large scale optimization</article-title>. <source>Mathematical programming</source>, <volume>45</volume>(<issue>1-3</issue>):<fpage>503</fpage>&#x2013;<lpage>528</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="other"><string-name><given-names>Bruce D</given-names> <surname>Lucas</surname></string-name> and <string-name><given-names>Takeo</given-names> <surname>Kanade</surname></string-name>. <article-title>An iterative image registration technique with an application to stereo vision</article-title>. <source>Proceedings DARPA Image Understanding Workshop</source>, page <fpage>121430</fpage>, <year>1981</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="other"><string-name><given-names>Marcel</given-names> <surname>L&#x00FC;thi</surname></string-name>, <string-name><given-names>Thomas</given-names> <surname>Gerig</surname></string-name>, <string-name><given-names>Christoph</given-names> <surname>Jud</surname></string-name>, and <string-name><given-names>Thomas</given-names> <surname>Vetter</surname></string-name>. <article-title>Gaussian process morphable models</article-title>. <source>IEEE transactions on pattern analysis and machine intelligence</source>, <year>2017</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><given-names>Robert A</given-names> <surname>McLeod</surname></string-name>, <string-name><given-names>Julia</given-names> <surname>Kowal</surname></string-name>, <string-name><given-names>Philippe</given-names> <surname>Ringler</surname></string-name>, and <string-name><given-names>Henning</given-names> <surname>Stahlberg</surname></string-name>. <article-title>Robust image alignment for cryogenic transmission electron microscopy</article-title>. <source>Journal of structural biology</source>, <volume>197</volume>(<issue>3</issue>):<fpage>279</fpage>&#x2013;<lpage>293</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><given-names>John A</given-names> <surname>Nelder</surname></string-name> and <string-name><given-names>Roger</given-names> <surname>Mead</surname></string-name>. <article-title>A simplex method for function minimization</article-title>. <source>The computer journal</source>, <volume>7</volume>(<issue>4</issue>):<fpage>308</fpage>&#x2013;<lpage>313</lpage>, <year>1965</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>Duy</given-names> <surname>Nguyen-Tuong</surname></string-name>, <string-name><given-names>Matthias</given-names> <surname>Seeger</surname></string-name>, and <string-name><given-names>Jan</given-names> <surname>Peters</surname></string-name>. <article-title>Model learning with local gaussian process regression</article-title>. <source>Advanced Robotics</source>, <volume>23</volume>(<issue>15</issue>):<fpage>2015</fpage>&#x2013;<lpage>2034</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="book"><string-name><given-names>Carl Edward</given-names> <surname>Rasmussen</surname></string-name>. <chapter-title>Gaussian processes in machine learning</chapter-title>. In <source>Advanced lectures on machine learning</source>, pages <fpage>63</fpage>&#x2013;<lpage>71</lpage>. <publisher-name>Springer</publisher-name>, <year>2004</year>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><given-names>Peter B</given-names> <surname>Rosenthal</surname></string-name> and <string-name><given-names>Richard</given-names> <surname>Henderson</surname></string-name>. <article-title>Optimal determination of particle orientation, absolute hand, and contrast loss in single-particle electron cryomicroscopy</article-title>. <source>Journal of molecular biology</source>, <volume>333</volume>(<issue>4</issue>):<fpage>721</fpage>&#x2013;<lpage>745</lpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><given-names>John L</given-names> <surname>Rubinstein</surname></string-name> and <string-name><given-names>Marcus A</given-names> <surname>Brubaker</surname></string-name>. <article-title>Alignment of cryo-EM movies of individual particles by optimization of image translations</article-title>. <source>Journal of Structural Biology</source>, <volume>192</volume>(<issue>2</issue>):<fpage>188</fpage>&#x2013;<lpage>195</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Sjors</surname> <given-names>HW</given-names></string-name> <article-title>Scheres. Relion: implementation of a bayesian approach to cryo-EM structure determination</article-title>. <source>Journal of structural biology</source>, <volume>180</volume>(<issue>3</issue>):<fpage>519</fpage>&#x2013;<lpage>530</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="other"><string-name><surname>Sjors</surname> <given-names>HW</given-names></string-name> <article-title>Scheres. Beam-induced motion correction for sub-megadalton cryo-EM particles</article-title>. <source>Elife</source>, <fpage>3</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name> and <string-name><given-names>Shaoxia</given-names> <surname>Chen</surname></string-name>. <article-title>Prevention of overfitting in cryo-EM structure determination</article-title>. <source>Nature methods</source>, <volume>9</volume>(<issue>9</issue>):<fpage>853</fpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><given-names>Jack M</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>David J</given-names> <surname>Fleet</surname></string-name>, and <string-name><given-names>Aaron</given-names> <surname>Hertzmann</surname></string-name>. <article-title>Gaussian process dynamical models for human motion</article-title>. <source>IEEE transactions on pattern analysis and machine intelligence</source>, <volume>30</volume>(<issue>2</issue>):<fpage>283</fpage>&#x2013;<lpage>298</lpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="other"><string-name><given-names>Wilson</given-names> <surname>Wong</surname></string-name>, <string-name><given-names>Xiao-Chen</given-names> <surname>Bai</surname></string-name>, <string-name><given-names>Alan</given-names> <surname>Brown</surname></string-name>, <string-name><given-names>Israel S</given-names> <surname>Fernandez</surname></string-name>, <string-name><given-names>Eric</given-names> <surname>Hanssen</surname></string-name>, <string-name><given-names>Melanie</given-names> <surname>Condron</surname></string-name>, <string-name><given-names>Yan Hong</given-names> <surname>Tan</surname></string-name>, <string-name><given-names>Jake</given-names> <surname>Baum</surname></string-name>, and <string-name><given-names>Sjors HW</given-names> <surname>Scheres</surname></string-name>. <article-title>Cryo-EM structure of the plasmodium falciparum 80s ribosome bound to the anti-protozoan drug emetine</article-title>. <source>Elife</source>, <fpage>3</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><given-names>Shawn Q</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>Eugene</given-names> <surname>Palovcak</surname></string-name>, <string-name><given-names>Jean-Paul</given-names> <surname>Armache</surname></string-name>, <string-name><given-names>Kliment A</given-names> <surname>Verba</surname></string-name>, <string-name><given-names>Yifan</given-names> <surname>Cheng</surname></string-name>, and <string-name><given-names>David A</given-names> <surname>Agard</surname></string-name>. <article-title>Motioncor2: anisotropic correction of beam-induced motion for improved cryoelectron microscopy</article-title>. <source>Nature methods</source>, <volume>14</volume>(<issue>4</issue>):<fpage>331</fpage>, <year>2017</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>