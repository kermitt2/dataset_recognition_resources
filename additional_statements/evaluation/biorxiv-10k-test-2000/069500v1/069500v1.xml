<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/069500</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>OncoSimulR: genetic simulation of cancer progression with arbitrary epistasis and mutator genes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6637-9039</contrib-id>
<name><surname>Diaz-Uriarte</surname><given-names>Ramon</given-names></name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Department of Biochemistry, Universidad Aut&#x00F3;noma de Madrid, Instituto de Investigaciones Biom&#x00E9;dicas &#x201C;Alberto Sols&#x201D; (UAM-CSIC), Madrid, Spain. <email>ramon.diaz@iib.uam.es</email>, <email>rdiaz02@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2016</year></pub-date>
<elocation-id>069500</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>14</day>
<month>8</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="069500.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>OncoSimulR implements forward-in-time genetic simulations of diallelic loci in asexual populations with special focus on cancer progression. Fitness can be defined as an arbitrary function of genetic interactions between multiple genes or modules of genes, including epistasis, restrictions in the order of accumulation of mutations, and order effects. Mutation rates can be made to differ between genes, and can be affected by (anti)mutator genes. Also available are sampling from single or multiple simulations, including single-cell sampling, plotting the parent-child relationships of the clones and generating and plotting random fitness landscapes.</p>
<sec sec-type="availability">
<title>Availability and implementation</title>
<p>Implemented in R and C&#x002B;&#x002B;, freely available from BioConductor for Linux, Mac, and Windows under the GNU GPL license. Version 2.3.12 or higher available from: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/OncoSimulR.html">http://www.bioconductor.org/packages/devel/bioc/html/OncoSimulR.html</ext-link>. GitHub repository at: <ext-link ext-link-type="uri" xlink:href="https://github.com/rdiaz02/OncoSimul">https://github.com/rdiaz02/OncoSimul</ext-link>.</p>
</sec>
</abstract>
<counts>
<page-count count="3"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Forward-in-time genetic simulations are widely used in population genetics and cancer research to verify analytic results, to generate data to assess the performance of statistical methods, and to examine complex models that are mathematically intractable (reviews and examples in <xref ref-type="bibr" rid="c3">Diaz-Uriarte, 2015</xref>; <xref ref-type="bibr" rid="c11">Thornton, 2014</xref>; <xref ref-type="bibr" rid="c12">Yuan <italic>et al.</italic>, 2012</xref>). In many scenarios we will want to use a wide range of populations sizes, with possibly large genomes, and with a flexible mechanism to specify the effects of mutations on both fitness and mutation rates (to model mutator/antimutator genes; <xref ref-type="bibr" rid="c4">Gerrish <italic>et al.</italic>, 2007</xref>). If the effects of sampling are relevant (e.g <xref ref-type="bibr" rid="c3">Diaz-Uriarte, 2015</xref>), we should be able to take samples under different sampling schemes and if understanding the dynamics and history matters, we will also want to track the complete history of the clones. Many forward-in-time simulators are available (see reviews in <xref ref-type="bibr" rid="c8">Peng <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="c11">Thornton, 2014</xref>; <xref ref-type="bibr" rid="c12">Yuan <italic>et al.</italic>, 2012</xref> and the page (<ext-link ext-link-type="uri" xlink:href="https://popmodels.cancercontrol.cancer.gov/gsr/">https://popmodels.cancercontrol.cancer.gov/gsr/</ext-link>). In the field of evolutionary genetics some of the tools closest to fulfil the above needs are simuPOP (<xref ref-type="bibr" rid="c8">Peng <italic>et al.</italic>, 2012</xref>), fwdpp (<xref ref-type="bibr" rid="c11">Thornton, 2014</xref>) and FFPopSim (<xref ref-type="bibr" rid="c13">Zanini and Neher, 2012</xref>); these programs, however, miss some of the above mentioned features, especially flexible ways to specify fitness and mutator effects, order effects, or gene-specific mutation rates. TTP (<xref ref-type="bibr" rid="c9">Reiter <italic>et al.</italic>, 2013</xref>), targeted to cancer progression, is limited to four genes. Motivated by these needs, I have developed OncoSimulR.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Functionality</title>
<sec id="s2a">
<label>2.1</label>
<title>Fitness and mutator effects specification</title>
<p>OncoSimulR provides two ways to specify fitness effects:</p>
<list list-type="order">
<list-item><p>Explicitly mapping genotypes to fitness.</p></list-item>
<list-item><p>Using a lego system to combine:</p>
<list list-type="alpha-lower">
<list-item><p>Effects of individual genes and epistatic effects of any order that involve an arbitrary number of genes.</p></list-item>
<list-item><p>Order effects involving arbitrary numbers of genes. With order effects, recently discovered in myeloma (<xref ref-type="bibr" rid="c7">Ortmann <italic>et al.</italic>, 2015</xref>), the fitness of a genotype with genes A and B mutated differs depending on whether A or B mutated first.</p></list-item>
<list-item><p>Directed acyclic graphs (DAGs), as used in cancer progression networks such as Oncogenetic Trees and Conjunctive Bayesian Networks (<xref ref-type="bibr" rid="c1">Beerenwinkel <italic>et al.</italic>, 2014</xref>), to represent restrictions in the order of accumulation of mutations. How the restriction is enforced and whether conjunctions in the DAG represent AND, OR, or XOR relationships is fully controllable by the user.</p></list-item>
</list></list-item></list>
<p>We can also define &#x201C;modules&#x201D; so that we model the effects on fitness in terms not of individual genes but modules or pathways. Modules can be used with all the lego system specifications (i.e., epistasis, order effects, and DAGs).</p>
<p>Mutator/antimutator genes can be specified similar to fitness effects (though DAGs and order effects are not used to avoid overengineering) and can also involve modules. Genes with (anti)mutator effects can also have direct effects on fitness. Regardless of (anti)mutator genes, mutation rates can be gene-specific or common to all genes.</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Running and sampling simulations</title>
<p>We can run simulations using exponential growth (two different types) or a model with carrying capacity that follows <xref ref-type="bibr" rid="c6">McFarland <italic>et al.</italic> (2013)</xref>. OncoSimulR uses the fast, state-of-the-art, BNB algorithm of <xref ref-type="bibr" rid="c5">Mather <italic>et al.</italic> (2012)</xref>. Running multiple simulations is parallelized by default in POSIX systems. Simulations need not start from the wildtype genotype: any genotype can be used as the starting point for a simulation. There is no pre-set limit on genome size, and the documentation shows examples with 50000 genes. Simulations can reach total populations sizes &#x003E; 10<sup>14</sup>.</p>
<p>Simulations can be stopped when total population size, number of time periods, or number of mutated driver genes in any clone are larger than user-specified values. The simulations can also be ended using a stochastic detection mechanism where the probability of detecting a tumor increases with total population size (the parameters controlling this process are modifiable by the user).</p>
<p>Once the simulation is ended, we can take samples from the simulation. It is possible to obtain single-cell samples or whole-tumor samples. In the later case, the &#x201C;genotype&#x201D; of the sample will be determined by the frequency at which each gene is mutated in the whole sample (the threshold for detection being set by the user). Regardless of how simulations have been stopped, it is possible to re-sample the history taking samples at uniformly distributed times, or as soon as the population reaches a certain size. As multiple simulations can be run, serially or in parallel, the sampling procedures deal with both single and multiple simulations.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Additional functionality</title>
<p>OncoSimulR provides additional functionality, making it suitable for exploring a wide range of research questions:</p>
<list list-type="bullet">
<list-item><p>Plotting the parent-child relationships of all clones generated during the simulation, with filtering based on clone size.</p></list-item>
<list-item><p>Generating random fitness landscapes using a three-parameter Rough Mount Fuji model that includes the House of Cards and the additive models as special cases (<xref ref-type="bibr" rid="c10">Szendro <italic>et al.</italic>, 2013</xref>).</p></list-item>
<list-item><p>Plotting fitness landscapes (inspired by MAGELLAN; <xref ref-type="bibr" rid="c2">Brouillet <italic>et al.</italic>, 2015</xref>).</p></list-item>
<list-item><p>Generating random DAGs that represent restrictions in the order of accumulation of mutations.</p></list-item>
</list>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Tests and code coverage and documentation</title>
<p>OncoSimulR includes more than 2000 tests that are run routinely at every build/check cycle. These tests provide a code coverage of more than 95&#x0025; including both the C&#x002B;&#x002B; and R code (virtually all non-covered lines correspond to code that should be triggered by as-of-yet-undetected bugs). Another set of 500 long-running (several hours) tests can be run on demand. OncoSimulR includes the standard R function documentation and a comprehensive (more than 140 pages) vignette with fully commented examples of usage.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Conclusion</title>
<p>Salient features of OncoSimulR compared to other simulators are the unparalleled flexibility to specify fitness and mutator effects and the inclusion of order effects. OncoSimulR can thus be used to address a wide range of questions that span from the effect of mutator/antimutator genes, to the interplay between fitness landscapes, population sizes and mutation rates. OncoSimulR also adds features that are particularly convenient for examining cancer evolution models, such as modules and the flexibility for sampling and stopping the simulations. OncoSimulR is thus of interest for a broad scientific readership that covers from population and evolutionary geneticists to computational oncologists.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>C. Lazaro-Perea and A. Parramon for comments on the ms. C. D. McFarland and W. Mather and L. Tsimring for answers about their models/algorithms.</p>
</ack>
<sec>
<title>Funding</title>
<p>Supported by BFU2015-67302-R (Spanish MINECO/FEDER, EU).</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Beerenwinkel</surname>, <given-names>N.</given-names></string-name>, <etal>et al.</etal> (<year>2014</year>). <article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Systematic Biology</source>, <volume>64</volume>(<issue>1</issue>), <fpage>e1</fpage>&#x2013;<lpage>e25</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Brouillet</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal> (<year>2015</year>). <article-title>MAGELLAN: a tool to explore small fitness landscapes</article-title>. <source>bioRxiv</source>, page <fpage>031583</fpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Diaz-Uriarte</surname>, <given-names>R.</given-names></string-name> (<year>2015</year>). <article-title>Identifying restrictions in the order of accumulation of mutations during tumor progression: effects of passengers, evolutionary models, and sampling</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>(<issue>41</issue>), <fpage>0</fpage>&#x2013;<lpage>36</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Gerrish</surname>, <given-names>P. J.</given-names></string-name>, <etal>et al.</etal> (<year>2007</year>). <article-title>Complete genetic linkage can subvert natural selection</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>104</volume>(<issue>15</issue>), <fpage>6266</fpage>&#x2013;<lpage>6271</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Mather</surname>, <given-names>W. H.</given-names></string-name>, <string-name><surname>Hasty</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Tsimring</surname>, <given-names>L. S.</given-names></string-name> (<year>2012</year>). <article-title>Fast stochastic algorithm for simulating evolutionary population dynamics</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>28</volume>(<issue>9</issue>), <fpage>1230</fpage>&#x2013;<lpage>1238</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>McFarland</surname>, <given-names>C. D.</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). <article-title>Impact of deleterious passenger mutations on cancer progression</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>110</volume>(<issue>8</issue>), <fpage>2910</fpage>&#x2013;<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Ortmann</surname>, <given-names>C. A.</given-names></string-name>, <etal>et al.</etal> (<year>2015</year>). <article-title>Effect of Mutation Order on Myeloproliferative Neoplasms</article-title>. <source>New England Journal of Medicine</source>, <volume>372</volume>, <fpage>601</fpage>&#x2013;<lpage>612</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Peng</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Kimmel</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Amos</surname>, <given-names>C. I.</given-names></string-name> (<year>2012</year>). <article-title>Forward-time population genetics simulations: methods, implementation, and applications</article-title>. <source>Wiley-Blackwell</source>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Reiter</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). <article-title>TTP: tool for tumor progression. In N. Sharygina and H. Veith, editors, Computer Aided Verification, Lecture Notes in Computer Science</article-title>, pages <fpage>101</fpage>&#x2013;<lpage>106</lpage>. <source>Springer-Verlag, Berlin, Heidelberg</source>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Szendro</surname>, <given-names>I. G.</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). <article-title>Quantitative analyses of empirical fitness landscapes</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2013</volume>(<issue>01</issue>), <fpage>P01005</fpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Thornton</surname>, <given-names>K. R.</given-names></string-name> (<year>2014</year>). <article-title>A C&#x002B;&#x002B; Template Library for Efficient Forward-Time Population Genetic Simulation of Large Populations</article-title>. <source>Genetics</source>, <volume>198</volume>(2013), <fpage>157</fpage>&#x2013;<lpage>166</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Yuan</surname>, <given-names>X.</given-names></string-name>, <etal>et al.</etal> (<year>2012</year>). <article-title>An Overview of Population Genetic Data Simulation</article-title>. <source>Journal of Computational Biology</source>, <volume>19</volume>(<issue>1</issue>), <fpage>42</fpage>&#x2013;<lpage>54</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Zanini</surname>, <given-names>F.</given-names></string-name> and <string-name><surname>Neher</surname>, <given-names>R. A.</given-names></string-name> (<year>2012</year>). <article-title>FFPopSim: An efficient forward simulation package for the evolution of large populations</article-title>. <source>Bioinformatics</source>, <volume>28</volume>(<issue>24</issue>), <fpage>3332</fpage>&#x2013;<lpage>3333</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>