<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/039370</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Animal Behavior and Cognition</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Detailed temporal structure of communication networks in groups of songbirds</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Stowell</surname><given-names>Dan</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Gill</surname><given-names>Lisa</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Clayton</surname><given-names>David</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Centre for Digital Music, Queen Mary University of London</institution>, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>Max Planck Institute for Ornithology, Seewiesen</institution>, <country>Germany</country></aff>
<aff id="a3"><label>3</label><institution>School of Biological and Chemical Sciences, Queen Mary University of London</institution>, <country>UK</country></aff>
</contrib-group>
<author-notes>
<fn id="n1"><label>&#x002A;</label><p><email>dan.stowell@qmul.ac.uk</email></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2016</year></pub-date>
<elocation-id>039370</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>2</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>2</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2016</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="039370.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Animals in groups often exchange calls, in patterns whose temporal structure may be influenced by contextual factors such as physical location and the social network structure of the group. We introduce a model-based analysis for temporal patterns of animal call timing, originally developed for networks of firing neurons. This has advantages over cross-correlation analysis in that it can correctly handle common-cause confounds and provides a generative model of call patterns with explicit parameters for the influences between individuals. It also has advantages over standard Markovian analysis in that it incorporates detailed temporal interactions which affect timing as well as sequencing of calls. Further, a fitted model can be used to generate novel synthetic call sequences. We apply the method to calls recorded from groups of domesticated zebra finch (<italic>Taenopyggia guttata</italic>) individuals. We find that the communication network in these groups has stable structure that persists from one day to the next, and that &#x201C;kernels&#x201D; reflecting the temporal range of influence have a characteristic structure for a calling individual&#x2019;s effect on itself, its partner, and on others in the group. We further find characteristic patterns of influences by call type as well as by individual.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>animal communication</kwd>
<kwd>Poisson process</kwd>
<kwd>point process</kwd>
<kwd>linear-nonlinear Poisson</kwd>
<kwd>communication network</kwd>
<kwd>social network analysis</kwd>
</kwd-group>
<counts>
<page-count count="34"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Many animals exhibit group calling behaviour. Patterns of calling are observable phenomena which reflect individual state and are dependent on behavioural context [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>]. Understanding the dynamics of vocalisation patterns within groups is an important growing topic in animal behaviour [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c5">5</xref>]. However, analysing the structure of the communication network in a group of animals presents a challenge which goes beyond that of analysing calls of isolated individuals or pairs, because multiple influences converge on an individual in parallel, making it harder to infer causal connections.</p>
<p>In this work we introduce a model-based method for inferring the temporal and network structure of interactions between calling individuals from the timing of call events. The paradigm was originally developed in computational neurology for analysis of spiking neural networks [<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>]. We adapted the method for the case of animal calls and applied it to data from groups of domesticated zebra finch (<italic>Taenopyggia guttata</italic>), a communal songbird that is the subject of much current research [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>]. With this approach we were able to represent zebra finch communication networks in a compact model whose attributes reflect fine details of timing and influence strengths between individuals in a group, yielding a new data-driven perspective that complements other approaches based on acoustics, neurology or ethology, and provides a useful visualisation tool.</p>
<p>Before describing our study and analysis, we first wish to set our analytical approach in context by discussing methods for modelling animal vocalisation sequences, in particular their applicability to vocalisations in groups.</p>
</sec>
<sec id="s2">
<title>Modelling the Processes that Generate Animal Vocalisations</title>
<p>Researchers analyse animal calling patterns in order to understand the processes that generated them, whether their focus is on intra-individual or interindividual mechanisms. A general paradigm with strong mathematical support is to choose a family of probabilistic generative models that might generate the phenomena of interest, and then to use model selection and/or parameter fitting to decide which model from that family best matches the data.</p>
<p>A good example of this is Markov modelling. A Markov model generates the next symbol in a sequence stochastically but with limited memory: conditional on the most recent <italic>k</italic> symbols, a <italic>k</italic>th-order Markov model chooses the next symbol independently of all prior history. Markov modelling has been applied widely to animal communications [<xref ref-type="bibr" rid="c4">4</xref>]; once vocalisations have been reduced to symbol sequences, data fitting can determine the transition probabilities between symbols, as well as the model order i.e. the length k of the &#x201C;memory&#x201D; [<xref ref-type="bibr" rid="c10">10</xref>]. A Markov model is usually an extreme simplification of the presumed underlying biological process, and neglects important aspects such as call timing. Because of this, a Markov model is unable to model some notable aspects of vocalisation such as &#x201C;bursty&#x201D; call patterns. However it is a broadly useful tool. Extensions of this approach augment the model to include unobserved state (the <italic>hidden Markov model</italic> long used for speech [<xref ref-type="bibr" rid="c11">11</xref>], [<xref ref-type="bibr" rid="c12">12</xref>, Chapter 17]), the structured repetition of symbols (the <italic>semi-Markov model</italic> [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>]) or time gaps between events (the <italic>Markov renewal process</italic> [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>]). For our present purposes, an important consideration is that Markovian models do not adapt readily to the case where multiple influences converge on an individual in parallel. They imply that each individual &#x201C;remembers&#x201D; only the most recent <italic>k</italic> calls, irrespective of whether they come from socially significant others (e.g. a breeding partner) or from socially insignificant individuals.</p>
<p>Cross-correlation analysis can be used to analyse relative timing, but is not derived from a generative model: it is descriptive rather than inferential. A particular set of cross-correlation statistics may be compatible with multiple hypotheses about the underlying process (Markovian or otherwise). Cross-correlation is an appealing alternative to standard Markov modelling because it gives some characterisation of the time gaps between events, not just the event sequences. Studies based on cross-correlation typically probe for significant patterns but do not attempt to give a formal model that could have generated those patterns [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c2">2</xref>]. As one example of potential issues with cross-correlation, a causal network with a chain structure such as A&#x2192;B&#x2192;C may well create indirect cross-correlation phenomena from A &#x2192; C, even where there is no direct causal link (<xref ref-type="fig" rid="fig1">Fig. 1</xref>), which would result in a clear instance of the maxim &#x201C;correlation is not causation&#x201D;.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1.</label>
<caption><title>A synthetic example of indirect causation. A sequence was generated using a simplified A&#x2192;B&#x2192;C causal model, and then analysed using standard methods and our proposed method. The generation procedure was deliberately designed as not a perfect match to any of the analysis models, so as not to privilege any of them. We show an example timeline of events, along with the cross-correlation plots, and then the influence strengths recovered using each method summarised as a social network diagram. Cross-correlation analysis recovers most of the influences/independences but tends to recover false-positive connections for the indirect link A&#x2192;C (see the lower-left panel of the cross-correlation plots). A simple Markov model recovers influences without timing information, and in this case also adds a connection from C back to A to take the place of the baseline event calling rate of A. Our proposed method recovers a good match for the network structure as well as timing information. It adds self-inhibitory feedback on B and C to account for the fact that in this test case a call by A leads to no more than one call by B (and likewise for B&#x2192;C). Note that the values recovered by each method are different in kind, and have been rescaled separately for each of the network plots. For further details of this synthetic example see the SI.</title></caption>
<graphic xlink:href="039370_fig1.tif"/>
</fig>
<p>A probabilistic model that is directly applicable to events on a continuous timeline is the <italic>Poisson process</italic> [<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>]. At its simplest, the (homogeneous) Poisson process outputs events stochastically but at a constant rate, meaning that the event times are random but there is a constant expected number of events per unit time (<xref ref-type="fig" rid="fig2">Fig. 2a</xref>). Most Poisson processes of interest are inhomogeneous, having a rate that can change over time (<xref ref-type="fig" rid="fig2">Fig. 2b</xref>). This Poisson process model can represent a single stream of events, but in order to capture interactions between individuals or between call types, we need to augment it with coupling such that calls from one individual can modulate the rate of calling of another (<xref ref-type="fig" rid="fig2">Fig. 2c</xref>). This will be achieved through influence <italic>kernels</italic> described in the SI and illustrated later, whose effect is that a call from one individual has a modulating &#x2018;wave&#x2019; of influence on the rates of others. Such a model can be fit to data by maximum likelihood and these models reflect both the typical time gaps between events and the typical sequencing of one event after another. These coupled processes are not necessarily Markovian, and the modelling focus is slightly different: instead of the turn-by-turn sequencing which underlies Markovian models, the emphasis here is on separate processes each generating calls, happening in parallel, and these processes can mutually influence one another.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2.</label>
<caption><title>Schematic illustration of processes generating events: (a) homogeneous Poisson process; (b) inhomogeneous Poisson process; (c) inhomogeneous Poisson process in which all changes in rate are due to the external influence of stimulus events. In each panel, the rate parameter for the process (&#x03BB;) is shown as a filled curve, continuous in time, and an example sequence of events sampled from the process is shown as a sequence of spikes.</title></caption>
<graphic xlink:href="039370_fig2.tif"/>
</fig>
<p>In the present study we wished to use exactly these point process models, with interaction kernels, to elucidate the temporal structure of networks of calling birds. We have multiple motivations for doing this. The first is that the information from the fitted model may yield information similar to that which has previously been derived through cross-correlation [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c2">2</xref>], such as the strength of pairwise influences, but with more robustness to common-cause confounds and other issues discussed above. A second is that the fitted model may yield more finely nuanced information, and information tied to an explicit model: for example, one individual may have a suppressive effect on its neighbour at some timescales, and an excitatory effect at other timescales. Another is that a fitted model can be used to make further inferences about datasets, for example to predict whether communicating partners are paired or unpaired. Another is that since the model we fit is generative, it can be used to generate new synthetic sequences having the same network characteristics, which could be used for stimuli in future studies.</p>
<p>To this end, we conducted one study with a group of female zebra finches in a standardised context, and one reanalysis of existing data from a mixed-sex group of zebra finches in a different and varying context.</p>
</sec>
<sec id="s3">
<title>Materials and Methods</title>
<sec id="s3a">
<title>Ethical Note</title>
<p>Animal housing and welfare were in compliance with the European directives for the protection of animals used for scientific purposes (2010/63/EU). Our zebra finch audio recordings did not involve any intervention that would be a regulated procedure under the UK Animals (Scientific Procedures) Act 1986. The Named Animal Care and Welfare Officer for Queen Mary University of London (QMUL) oversaw the housing and routine care.</p>
<p>In this report we also reanalyse data from Gill et al.[<xref ref-type="bibr" rid="c2">2</xref>]. Those data were collected under protocols approved by the Government of Upper Bavaria, and conditions were likewise compliant with 2010/63/EU.</p>
</sec>
<sec id="s3b">
<title>Data Collection</title>
<p>Four adult female zebra finches (at least 90 days old, with wild-type plumage) were selected from an aviary of the QMUL animal facility. The four birds were housed together in a flight cage with free access to food and water, in a room separate from the main aviary. The group of four birds were housed together for more than two weeks before the recording sessions. The birds were kept on a 12/12h light/dark cycle (7:00-19:00), and the room temperature was 20-21&#x00B0;C.</p>
<p>To perform the recordings, each bird was transferred to an individual cage (of size approx. 40 x 35 x 45 cm) with free access to food and water, and remained in visual and auditory contact with the other birds (at a distance of about 2 m). Birds were kept in the individual cages for just over one hour per day (approx 8:00-9:00) for recordings before returning to the group cage.</p>
<p>The solo cages were arranged in a square pattern so that all birds were approximately equidistant. Since we intended to investigate calling patterns as a function of bird identity, we avoided the potential confound of physical location by placing the birds in cages in different orders each of the three days, choosing the ordering by taking three rows from a four-by-four Latin square.</p>
<p>Audio was recorded during these one-hour sessions with four focal microphones (AKG C451B), one directed at each cage. All audio signals were recorded together onto a Zoom H6n multitrack sound recorder to ensure that the recordings were temporally synchronised. Recordings were made at 96 kHz sample rate and 16 bit depth. The first day of this sound recording protocol was used as a test run and for acclimation, and data were not analysed. The second and third days were taken forward for annotation.</p>
<p>We used a cross-validated semi-automatic process to label the audio events in the recordings. In a first pass, we applied automatic event detection to locate the beginning and end of events, using energy-based detection applied to spectrograms after performing median-filtering. Spectrograms were trimmed to the frequency region of interest (0.5-20 kHz). The four channels of the recording inevitably contained large amounts of &#x201C;crosstalk&#x201D; as the protocol was designed so that the birds could clearly hear each other. Hence we used the median spectrogram across all channels as a background against which to judge the signal energy. Regions of high energy exceeding a minimum duration (8 ms; 2 spectrogram frames or more) were taken forward as candidates to the second stage.</p>
<p>The second stage of processing was manual refining of the detections. Each 4-channel spectrogram was divided into one-second chunks (with an overlap of 50&#x0025;) and the proposed annotation superimposed. Annotators were then shown the one-second chunks in a random order, so that any variation in attention of the human annotators would not systematically vary across the recording duration. For each channel, annotators could listen to the audio and view spectrograms, confirm or reject the detected events, and label them as calls or other noises (such as wing flaps or cage sounds). They could also label errors such as the merging or splitting of events, or misaligned event boundaries. Two separate annotators manually processed all of the candidate annotations. We used two paid annotators who were both PhD students with critical listening skills (audio engineering backgrounds). These annotators were trained by the first author, using excerpts from the pilot session recordings as examples. Consensus decisions were accepted, and deviations from consensus were resolved by the first author. Finally, the first author listened through to the full recordings with the annotations superimposed, as a check for any remaining anomalies.</p>
<p>For the present study we then extracted the calling times for those events labelled as zebra finch calls. In this standardised recording environment our female birds did not use a wide variety of call types (cf. [<xref ref-type="bibr" rid="c8">8</xref>]), predominantly the &#x2018;Tet&#x2019;/&#x2019;Stack&#x2019; type with a very small number of &#x2018;Distance&#x2019; calls (note that female zebra finches do not sing). Therefore in order to provide a clear analysis we did not split calls into different categories. This dataset of call times we refer to as <italic>zf4f</italic>.<sup><xref ref-type="fn" rid="fn1">1</xref></sup> In this dataset there were around 2800 calls in each hour-long session (around 12 calls per bird per minute).</p>
</sec>
<sec id="s3c">
<title>Analyses</title>
<p>We analysed the call timing information using the GLM point-process model of [<xref ref-type="bibr" rid="c7">7</xref>], with specific configuration described in the SI. Our main unit of analysis was each 60-minute recording session as a whole, although we also analysed each 15-minute segment separately, to investigate whether there was continuity or change of communication patterns throughout a session. We determined from preliminary tests that 15 minutes was the smallest region we could use to have enough calls for a stable analysis.</p>
<p>We used penalised maximum likelihood (maximum <italic>a posteriori</italic>) optimisation to fit the model parameters to each dataset. We fitted two models to each of our 60-minute sessions&#x2014;one combining influences in additive fashion, one in multiplicative fashion&#x2014;and used an odds-ratio test to select the most appropriate model. In all cases the additive model was favoured. More details on the modelling are given in the Supplementary Information. Our source code to perform analyses and generate figures is available online.<sup><xref ref-type="fn" rid="fn2">2</xref></sup></p>
<p>The GLM model, after fitting to a dataset, yields a continuous curve (a &#x201C;kernel&#x201D;) for each directed pairwise influence. For four birds this gives 16 kernels, four of which represent self-self influence and twelve of which represent self-other influence. In order to make quantitative and visual comparisons, we summarised kernels in two main ways. We aggregated self-self and self-other kernels separately to look for general tendencies that might emerge independent of bird identity. Separately we used the magnitude of the strongest peak (positive or negative) as summary statistics to plot communications networks and to test for consistency within/between sessions.</p>
<p>To test for consistency between sessions, we took the peak strengths from the influence kernels, and measured the Pearson correlation from one day to the next. Since self-self and self-other kernels were different in kind (having positive and negative peaks respectively), we analysed them separately, giving <italic>N</italic> &#x003D; 12 for self-other and <italic>N</italic> &#x003D; 4 for self-self. To investigate whether any correlation was due to individual identity, to physical location of the cage, or to chance, we measured the correlation using four different ways of matching one day up with the next day. These four matchings were the combinations given by a Latin square: one matching compared the same individual across days, one matching compared the same physical location (and microphone) across days, while the remaining two were null matchings with no meaningful interpretation.</p>
<p>To test for consistency within sessions, we took the self-other peak strengths for each 15-minute segment, and measured via Pearson correlation how strongly a segment could predict the immediate next segment. For each one-hour session this gives three sequential pairs of segments.</p>
<p>All of the above analysis was applied to our own <italic>zf4f</italic> dataset. We also applied the analysis to a subset of the call data from [<xref ref-type="bibr" rid="c2">2</xref>] in which inter-individual call timings had been studied in a more complex group setting. These groups were made up of freely behaving zebra finch males (4) and females (4) whose vocalisations were individually recorded via backpack microphones, over a period of three weeks. During this time, all birds were able to interact physically, and to engage in various activities, while pair-bonding, nesting and breeding progressed. We used our GLM method as an alternative to the cross-correlation analysis of Gill et al., to investigate group calling behaviour on a finer timescale, including an investigation of self-self calling patterns. As all individuals in the analysed data formed pair-bonds, we not only distinguished between self-self and self-other interactions as in <italic>zf4f</italic>, but we also separated out the self-partner interactions to investigate any consistent patterns emerging specifically within pairs. We were provided with the data for Trial II, days 1, 7, 11, 18&#x2014;the same days as displayed in <xref ref-type="fig" rid="fig5">Fig. 5A</xref> of [<xref ref-type="bibr" rid="c2">2</xref>]&#x2014;which span the different breeding stages of that group.<sup><xref ref-type="fn" rid="fn3">3</xref></sup> Each session was just under four hours long.</p>
<p>In the data of Gill et al.[<xref ref-type="bibr" rid="c2">2</xref>], calls were categorised into types. We applied our GLM method to all calls together (as with our own data), but since this dataset contained a larger number of calls across various types, we also explored splitting the data according to call type so that each pairwise interaction could have a different kernel for each call type. Note that Gill et al. use five call categories, which implies that for each directed pair we must fit 25 different kernels rather than just one, and so in practice we found that the full analysis by call-type was less stable due to data sparsity issues. Hence the recovered per-type kernels showed larger variances and the results are in some cases less clear-cut than for the broader aggregate models.</p>
</sec>
</sec>
<sec id="s4">
<title>Results</title>
<sec id="s4a">
<title>All-Female Group (<italic>zf4f</italic>)</title>
<p>We first show results from our recordings with four female zebra finches in a standardised context. The model-selection test consistently selected the model in which influences were combined by addition (rather than multiplication). This is in contrast to Pillow et al.[<xref ref-type="bibr" rid="c7">7</xref>] applying the same method to an analysis of spiking neurons, which selected the multiplicative model.</p>
<p>We found that influence kernels exhibited consistent temporal characteristics and broadly consistent magnitudes, and that these differed very strongly between self-self and self-other interactions (<xref ref-type="fig" rid="fig3">Fig. 3</xref>). The confidence intervals, despite aggregating over individuals, are relatively narrow with little overlap between self-self and self-other. Individuals exhibited a pattern of strong self-suppression immediately after calling and for around the next 0.8 seconds, followed by a slight positive effect thereafter. In contrast, self-other interactions showed a consistent positive peak at around 0.25 seconds, before decaying to around zero at 0.7 seconds, indicating a consistent characteristic timescale for calls that occur in response to the calls of others. In this group of females, although the network influences showed consistency there was no evidence for strong structure of the network such as a hierarchy (<xref ref-type="fig" rid="fig4">Fig. 4</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure"><label>Figure 3.</label>
<caption><title>Aggregate view of the influence kernels recovered from our two study sessions with four female zebra finches.</title>
<p>HOW TO READ THESE PLOTS: These plots summarise the kernels across the entire communication network, grouping the kernels according to whether they represent a self-self (red lines) or self-other (blue) connection. For each directed pair of birds we inferred a single kernel curve; these plots show the median curve, and the 5-to-95-percentile range, across all possible pairs of individuals in the group. Hence the filled regions largely indicate the extent of variation among the network connections. The time on the x-axis can be thought of as similar to the &#x201C;lag&#x201D; in cross-correlation. The y-axis can be thought of as the &#x201C;excess calling rate&#x201D; caused by a stimulus (although this interpretation is complicated a little by the nonlinearity; see SI for detail). Imagine that a bird emits a call at time zero. The plot then shows the effect of that call over the next few seconds, increasing and/or decreasing every bird&#x2019;s tendency to call. Unlike a Markov model, the call at time zero is not considered to lead to a single call that happens as a consequence of it: another bird might call once, twice or more during the period in which it is strongly stimulated by the call at time zero. (In practice, the strong inhibition we see&#x2014;the strong negative peak for self-self interactions&#x2014;often suppresses multiple responding.) A flat kernel with a value of zero would correspond to statistical independence, indicating that one bird had no effect on the calling rate of the listener. The influences from multiple individuals are added together by the listener before being passed through a nonlinearity; the main effect of the nonlinearity (for interpretive purposes) is a soft-thresholding to prevent the rate going below zero. For self-self kernels, the lag includes the lag due to the duration of the call itself (median duration 0.1 s).</p></caption>
<graphic xlink:href="039370_fig3.tif"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure"><label>Figure 4.</label>
<caption><title>Peak inuence strengths, plotted as a social network. Standard arrows indicate postive (excitatory) peaks, flat-headed arrows (in this case only seen for the self-self arrows looping back) indicate negative (suppressive) peaks.</title></caption>
<graphic xlink:href="039370_fig4.tif"/>
</fig>
<p>The self-other peak strengths from one day to the next were strongly predicted by individual identity (<italic>p</italic> &#x003C; 0.001), and not by physical location or by the null combinations (<xref ref-type="table" rid="tbl1">Table 1</xref>). Physical location yielded a slightly stronger correlation than the null combinations, but not at a significant level (<italic>p</italic> &#x003D; 0.18). Thus, we attribute the variation in inter-individual peak influence strengths (<xref ref-type="fig" rid="fig4">Fig. 4</xref>) to individual identity. The same was true of self-self peak strengths, predictable by individual identity (<italic>p</italic> &#x003C; 0. 01) but not by the other permutations (<italic>p</italic> &#x003E; 0.05).</p>
<table-wrap id="tbl1" orientation="portrait" position="float"><label>Table 1.</label>
<caption><p>Predictability (Pearson correlation) of peak strengths, from one day to the next, measured under four different permutations for aligning the two days. The four permutations correspond to four rows of a Latin square, one of which matched individuals across days, another which matched physical cage locations across days, and two null permutations having no meaningful interpretation.</p></caption>
<graphic xlink:href="039370_tbl1.tif"/>
</table-wrap>
<p>When analysing the sessions in 15-minute segments, we found consistency but also variation in the self-other peak strengths: values did not remain constant but often were smoothly-varying with characteristic magnitudes (<xref ref-type="fig" rid="fig5">Fig. 5</xref>). The strengths in each 15-minute segment were predictable from the immediate preceding segment (Pearson correlation 0.51, <italic>p</italic> &#x003C; 10<sup>-5</sup>; <xref ref-type="fig" rid="fig5">Fig. 5</xref>), confirming that the between-day consistency can be observed on the finer scale of 15 minute segments despite the observable variation. On this timescale, we were not able to verify that the self-self peaks were as consistent (<italic>p</italic> &#x003E; 0.05).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure"><label>Figure 5.</label>
<caption><title>Inter-individual peak strengths, analysed in subsequent 15-minute time windows. Solid lines connect peak strengths for each directed pair across directly adjacent 15-minute periods, and dotted lines represent the same connection but with a gap from one day to the next.</title></caption>
<graphic xlink:href="039370_fig5.tif"/>
</fig>
</sec>
<sec id="s4b">
<title>Reanalysis of Gill <italic>et al.</italic></title>
<p>The groups studied in Gill et al.were in a very different environment&#x2014;mixed-sex and larger groups, with the ability to physically interact, to undertake nesting and breeding. This is reflected in some notable differences in the typical influence kernels compared against those from the <italic>zf4f</italic> data (<xref ref-type="fig" rid="fig6">Fig. 6</xref>).</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure"><label>Figure 6.</label>
<caption><title>Aggregate kernels as in <xref ref-type="fig" rid="fig3">Fig. 3</xref> but for the dataset of Gill et al.. Note that the &#x201C;self-partner&#x201D; category was labelled retrospectively, according to the pair bonds that eventually formed. The pairings had typically not yet formed on the first day.</title></caption>
<graphic xlink:href="039370_fig6.tif"/>
</fig>
<p>Again the different kernel types show continuity over multiple sessions. Here, however, we observed specific developments in the communication network as the pairs progressed through different stages of bonding and breeding. On the first day, when pairings were yet to stabilise, there was little difference between self-other and self-partner influence (note that the &#x201C;self-partner&#x201D; category was labelled retrospectively, so in the early days it indicates <italic>eventual</italic> partners). As partnerships formed and developed they took on specific within-pair communication characteristics: by day 7, when many of the birds were involved in nest building, communication showed a specific self-partner peak with a timescale around 0.2 s, while the typical influence of non-partner birds (self-other) had reduced down close to independence. In other words, group communication was dominated by within-pair patterns. In the later days this structured communication subsided somewhat, although self-partner influences continued to be stronger than self-other influences. In the later days, the extra-pair self-other influences showed on average a short-term suppressive effect.</p>
<p>Notably, the self-self influence kernels recovered from these data were rather different from those in the <italic>zf4f</italic> recordings. There was again a strong immediate self-inhibition effect, but in the present case this was followed by a self-excitation at around 0.2 s which was not observed in the <italic>zf4f</italic> data. The implication of short-term self-excitation is that calls are being emitted in bursts or sequences. The median self-self influences showed bumpy multimodal curves which suggested that there might be further structure in the patterns of typical gaps in the sequences, or that the aggregate plots were merging together different kernels which each had differing timescales. We inspected the detail of individual kernel plots and found that the latter was not the case: there were no observable individual differences in overall self-excitation timescales.</p>
<p>When inspecting the differences between males and females (<xref ref-type="fig" rid="fig7">Fig. 7</xref>), we found this short-term peak in self-excitation was seen more strongly in males. The pattern became clearer when inspecting the kernels derived after separating the calls into behavioural call types. It was observed to lie predominantly in cackle calls, specifically in an individual following a cackle with another cackle (<xref ref-type="fig" rid="fig9">Fig. 9</xref>). The kernel plots broken down by call type exhibited more variance than the main plots due to data sparsity, but nevertheless only the cackle&#x2192;cackle self-self influence showed this strong rapid peak (at around 0.15 s), and this was consistent across the different days analysed.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure"><label>Figure 7.</label>
<caption><title>Aggregate kernels for the dataset of Gill et al.but showing only the within-pair interactions (self-self and self-partner) and further breaking them down by sex.</title></caption>
<graphic xlink:href="039370_fig7.tif"/>
</fig>
<p>Cackles explained one component of the multi-modal self-self kernels. However we could not conclude that the overall self-self kernel was explained as merely a sum of unimodal influences varying by call type, as the broken-down kernel plots did not generally resolve to simpler structure.</p>
<p>Other aspects of the kernels broken down by call type confirm the observations of Gill et al.: In many cases the strongest effect of a particular call type was to induce responses of the same type, but with some influences from one call type to another. Around day 7 we observed a tendency for Stacks or Tets from a female to induce Tet responses in the male partner (<xref ref-type="fig" rid="fig8">Fig. 8</xref>), as was also remarked upon in [<xref ref-type="bibr" rid="c2">2</xref>], and for the male Tets to have a notable self-excitatory peak. By day 7 birds were largely in the nest-building and later nesting stages (<xref ref-type="fig" rid="fig2">Fig. 2</xref> of [<xref ref-type="bibr" rid="c2">2</xref>]).</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure"><label>Figure 8.</label>
<caption><title>Aggregate kernels specifically for the &#x201C;Tets&#x201D; and &#x201C;Stacks&#x201D; of Gill et al., and their interactions, on day 7.</title></caption>
<graphic xlink:href="039370_fig8.tif"/>
</fig>
<p>Note that dividing the calls into five types gives a 25-fold increase in the number of influence kernels to be recovered, which may lead to data sparsity in some cases. This is visible in the increased variance of the per-type kernel estimates (<xref ref-type="fig" rid="fig8">Fig. 8</xref>, <xref ref-type="fig" rid="fig9">Fig. 9</xref>). For this reason we will only discuss per-type kernels in which we observe clear patterns, or indicative patterns which triangulate against observations made in related work [<xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c21">21</xref>].</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure"><label>Figure 9.</label>
<caption><title>Aggregate kernels specifically for the &#x201C;Cackles&#x201D; of Gill et al. on day 7.</title></caption>
<graphic xlink:href="039370_fig9.tif"/>
</fig>
</sec>
</sec>
<sec id="s5">
<title>Discussion</title>
<p>When animals interact in groups, multiple influences converge on each individual in parallel, and the effects of these influences depend on social context. In groups of zebra finches we found temporal interaction patterns that were consistent: they persisted over time according to sender/receiver identity, and they had characteristic structure depending on the nature of the social bond (self-self, self-partner, self other; male-female, female-male) and on contextual status such as breeding stage.</p>
<p>We characterised these communication networks by fitting a simple general-purpose model which takes account of the parallel known influences converging on an individual. The model is flexible enough to represent a wide range of pairwise influence patterns (kernels), including kernels which show patterns of suppression <italic>and</italic> excitation together, depending on relative timing.</p>
<p>When reanalysing call data previously presented by Gill et al.[<xref ref-type="bibr" rid="c2">2</xref>] in which cross-correlation had been used to identify interactions, we were able to confirm many of the observations, but demonstrated in more detail the temporal structure of interaction patterns, including self-self interactions. In some social contexts (particularly nest-building), within-pair influences dominate and calling patterns become much less strongly influenced by extra-pair group members. The structure of the communication network changes qualitatively through the different stages of zebra finch breeding activity.</p>
<p>We also found qualitative differences in communication influence patterns between our female-only group and the mixed-sex group of [<xref ref-type="bibr" rid="c2">2</xref>]. Note that the groups differed in various ways (presence/absence of mates, ability to interact physically, group size, backpack microphones) and so we do not here attribute the differences between the two studies to specific contextual parameters; that remains for future study. However, the per-sex and per-type plots strongly suggest that sex differences in timing patterns, and the presence of specific self-partner interactions, are the dominant factors in the differences seen between the two studies.</p>
<sec id="s5a">
<title>Zebra Finch Call Types and their Use in Vocal Interactions</title>
<p>Our reanalysis adds extra detail to the use of the different call types recorded and studied in [<xref ref-type="bibr" rid="c2">2</xref>]. An example is the specific self-excitation pattern observed for Cackle calls (<xref ref-type="fig" rid="fig9">Fig. 9</xref>). This is not discussed in [<xref ref-type="bibr" rid="c2">2</xref>] because the study focused only on inter-individual timings. The specific pattern we observed corresponds with behavioural observations in the literature: &#x201C;[Cackle] calls are emitted in sequence either by one single partner (especially by the male when leading the nest search; Zann 1996a, b) or by both birds that are then performing soft duets using these calls in combination with Tet calls (Elie et al. 2010)&#x201D; [<xref ref-type="bibr" rid="c21">21</xref>]. As well as the self-excitation pattern, we found a short-term self-partner excitation effect, corresponding to the duetting mentioned.</p>
<p>Elie et al. [<xref ref-type="bibr" rid="c21">21</xref>] take issue with the categorisation of Tet/Stack calls used by [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c2">2</xref>]. They propose that the &#x201C;Stack&#x201D; of Gill et al. is not the &#x201C;Stack&#x201D; which Zann observed in wild zebra finches [<xref ref-type="bibr" rid="c8">8</xref>], but rather that it is a variant of the &#x201C;Tet&#x201D;. They argue that the &#x201C;Tet&#x201D; and &#x201C;Stack&#x201D; are used in very similar behavioural circumstances, and so should all be considered under the general category of &#x201C;Tet&#x201D;. On the other hand, their own acoustic analysis finds them to be similar but distinct clusters, and so they suggest they could be referred to as &#x201C;Tet-M&#x201D; and &#x201C;Tet-S&#x201D; to avoid confusion with the &#x201C;Stack&#x201D; of Zann.</p>
<p>In this light, our analysis may help to illuminate whether the two categories annotated in [<xref ref-type="bibr" rid="c2">2</xref>] show different interaction patterns. The question is whether the two call types are behaviourally equivalent. If this were the case, we would certainly expect the Tet&#x2014; Tet and Stack&#x2014; Stack kernels to have similar characteristics. We might also expect the cross-type influence kernels (Tet&#x2014;Stack and Stack&#x2014; Tet) to be broadly similar. Note that we would not necessarily expect the cross-type kernels to look the same as the within-type kernels: for example the cross-type kernels might show smaller influence in the hypothetical case that Tets and Stacks are behaviourally equivalent but emitted in different states of arousal, and therefore unlikely to happen in close temporal proximity.</p>
<p>Contrary to this hypothesis of equivalence, we found indications of differing influence kernels both within and between Tets and Stacks. This was particularly seen on day 7 (<xref ref-type="fig" rid="fig8">Fig. 8</xref>) in which we saw that both Tets and Stacks from a female showed a tendency to inspire a Tet response from a partner within around 0.25 seconds, but this was not seen for Stack responses. Stacks and Tets also showed differing self-excitation patterns, indicating that the short-term sequencing of bursts had different character. Our analysis does not disprove the claim of Elie et al. [<xref ref-type="bibr" rid="c21">21</xref>] that Tets and Stacks lie on a continuum and are used in similar situations. However it indicates that as well as having observable acoustic differences, Tets and Stacks are used differently within communication interactions on the time-scale of seconds.</p>
<p>Elie et al. [<xref ref-type="bibr" rid="c21">21</xref>] describe the Tet call thus: &#x201C;The Tet call is the most frequent vocalization as it appears to be produced in an almost automatic and continuous fashion when zebra finches move around on perches or on the ground. These &#x201C;background&#x201D; Tet calls form an almost continuous hum and do not appear to produce a particular response in the nearby birds.&#x201D; Contrary to this, we find that Tets do have an effect of inducing Tets from a partner on a specific timescale. In this we concur with Gill et al.[<xref ref-type="bibr" rid="c2">2</xref>].</p>
<p>It is worth noting that in our presentation we have not focussed on the resting &#x201C;base rate&#x201D; of calling, which in our model is the component that causes birds to call in absence of any stimulus. The base rates here took values of approximately &#x00B1;0.15 per individual; the peak influence spikes were on a similar or larger scale and thus had a non-trivial effect compared against the base rate. A particular appeal of our modelling approach here is that it can identify components of influence even in the presence of a base calling rate.</p>
</sec>
<sec id="s5b">
<title>Reflections on GLM Point Process Methodology</title>
<p>The GLM point process method we have used is relatively generic&#x2014;it can be applied to neurons as much as to calling animals&#x2014;and as we have shown, it is flexible enough to capture a variety of phenomena which are pertinent to the understanding of animal calling interactions. It can capture specific timescales and strengths of influence, both positive and negative and mixed, between individuals, including asymmetric influences (A&#x2192;B can be different from B&#x2192;A), and provides a useful representation separating specific influences out from the calling base rate. It can reproduce bursty/sequential calling phenomena in individuals or groups. The method has a number of advantages over cross-correlation analysis. Directed causation is directly modelled rather than implicit. (This should not be interpreted as claiming that the method uncovers the full set of factors having causal influence on an individual: the model abstracts over physiological detail, and characterises the relative strengths of the causal factors proposed by the analyst.) Multiple convergent influences are simultaneously modelled as well as a default base-rate. Thanks to this, spurious links due to common-cause effects are less likely to occur.</p>
<p>The method is not specialised for strict sequencing: for example, if birds always emitted exactly three cackles in a sequence, this could not be modelled. In fact this limitation is in common with the standard Markov model. Future modelling advances may add useful generalisations, for example the incorporation of hidden state variables. Strict sequencing can be described in a hidden Markov model or a semi-Markov model, but those are in general suitable only for independent individuals and not a good fit for situations with multiple influences within a group.</p>
<p>The point process model we have described here is closely related to a set of self-stimulating statistical models called &#x201C;Hawkes processes&#x201D; [<xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>]. For example, the method of [<xref ref-type="bibr" rid="c22">22</xref>] has an appealing property of &#x201C;streaming&#x201D; performance, meaning that the network characteristics can adapt continuously through time as the network evolves. However their model has important limitations which the GLM model does not. It does not incorporate the nonlinearity which allows for flexibility and ensures that the model remains meaningful in the presence of negative influences (which otherwise could yield meaningless negative calling rates). More importantly, under their model every link in the network must have the <italic>same</italic> kernel shape and only the magnitudes can vary. We have demonstrated clearly in this work that zebra finch calling networks require, at minimum, different kernels for self-self, self-partner and self-other interactions, which have dramatically different shapes.</p>
<p>Our method models each calling individual as an inhomogeneous Poisson process, where the changes in calling rate are due to external influences. An alternative approach is to model each individual (slightly more simply) as an inhomogenous Poisson process (<xref ref-type="fig" rid="fig2">Fig. 2b</xref>), and then look for correlations among their inferred underlying calling rates. An advantage of that approach would be to accommodate smooth modulations in the base-rate of calling; however this comes at the significant cost of probing the modelled rates only indirectly for evidence of causal influence (much as in cross-correlation analysis), rather than directly fitting a causal model to the observed data.</p>
<p>Looking slightly more broadly, there are some existing methods in the animal behaviour literature that have rough analogies to our approach, but using different types of behavioural data. Psorakis [<xref ref-type="bibr" rid="c24">24</xref>] use spatio-temporal proximity of animals as indirect indicators of affiliation, which are then used to infer a social network graph. Note that the method there can only infer undirected (symmetric) connections between pairs of individuals, not directed connections as in the case of calling patterns here. Another rough analogy is with [<xref ref-type="bibr" rid="c25">25</xref>] who infer pigeon hierarchy from delays in flock movement responses. In that case the observed data are continuous movement data and temporal cross-correlations in movements are the clues used, instead of discrete events, to infer networks.</p>
<p>The data size requirements of the GLM point process model are reasonable for our purposes, as indicated by our ability to recover stable repeatable influence kernels with 15, 60, or 180 minutes of data. (See also the SI for a simulation test on data size requirements). The approach requires the same amount of data as does cross-correlation. We note that dividing the calls down by call type as well as by individual can lead quite quickly to data sparsity issues. This is seen in the slightly rough nature of the median kernels and higher variance in <xref ref-type="fig" rid="fig8">Fig. 8</xref> versus <xref ref-type="fig" rid="fig6">Fig. 6</xref>. This is of course true for other analysis methods as well. The GLM analysis has been applied to data sets having hundreds of neurons, and so it has the ability to scale to larger groups than we have studied [<xref ref-type="bibr" rid="c7">7</xref>].</p>
<p>The computation required to fit these models is larger than to run a cross-correlation test. In our largest data fit, analysing one of the almost four-hour sessions from [<xref ref-type="bibr" rid="c2">2</xref>] and breaking each of the eight individuals&#x2019; calls down into five types&#x2014;yielding a 40-by-40 fully-connected network of influences to infer&#x2014; this took seven hours on an ordinary laptop. Analysis can be made faster if some connections can be ruled out <italic>a priori,</italic> such as the influence from whines to distance calls, which we know from behavioural observations, previous work [<xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c1">1</xref>] and the present study do not show any notable influence.</p>
<p>The paradigm that we have applied in this study is relatively abstract and generic. This has two implications. First, it means that the fitted models can and should be compared against behavioural observations and against any more customised behavioural and/or physiological models for the species being studied, to explore the convergence of these different sources of evidence. Second, it means that this approach is not limited to songbirds, nor to communal species, and may find application in other taxa such as mammals or territorial songbirds.</p>
<p>The GLM model is generative, which allows for interesting experimental designs that can be considered in future, such as generating large numbers of novel group call sequences as stimuli, synthesising background &#x201C;crowd&#x201D; sounds, or creating group interactions in which live individuals interact in real time with automatic conversational participants.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We thank Richard E. Turner and Rob Lachlan for useful discussions that influenced the work presented here. Thanks also to Maeve McMahon for lots of assistance with the zebra finch recording study. We thank Jonathan Pillow for making the GLM code available and for implementation advice.</p>
</ack>
<sec id="s7" sec-type="funding">
<title>Funding</title>
<p>This work was supported by EPSRC Early Career research fellowship EP/L020505/1.</p>
</sec>
<sec id="s8" sec-type="availability">
<title>Data Accessibility</title>
<p>Our call timing data is publicly available via Figshare:</p>
<p><list list-type="bullet">
<list-item><p><italic>zf4f</italic>: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.1613791">https://dx.doi.org/10.6084/m9.figshare.1613791</ext-link></p></list-item>
<list-item><p>Gill et al. data subset: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/73cbdf96ab156a0f0a69">https://figshare.com/s/73cbdf96ab156a0f0a69</ext-link></p></list-item>
</list></p>
<p>Our source code to perform analyses and generate figures is available online via: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/danstowell/callnets-glm">https://bitbucket.org/danstowell/callnets-glm</ext-link></p>
</sec>
<sec id="s9" sec-type="COI-statement">
<title>Competing Interests</title>
<p>We have no competing interests.</p>
</sec>
<sec id="s10">
<title>Authors&#x2019; Contributions</title>
<p>DS conceived and designed the study, carried out the lab work (<italic>zf4f</italic> dataset), performed data analysis and drafted the manuscript; LG provided data, participated in data analysis and helped draft the manuscript; DC participated in the design of the study, provided zebra finch resources, participated in data analysis and helped draft the manuscript. All authors gave final approval for publication.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Elie</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Soula</surname> <given-names>HA</given-names></string-name>, <string-name><surname>Trouv&#x00E9;</surname> <given-names>C</given-names></string-name>, <string-name><surname>Mathevon</surname> <given-names>N</given-names></string-name>, <string-name><surname>Vignal</surname> <given-names>C.</given-names></string-name> <article-title>Housing conditions and sacrifice protocol affect neural activity and vocal behavior in a songbird species, the zebra finch (Taeniopygia guttata)</article-title>. <source>Comptes Rendus Biologies</source>. <year>2015</year>;<volume>338</volume>(<issue>12</issue>). doi:<pub-id pub-id-type="doi">10.1016/j.crvi.2015.09.004</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Gill</surname> <given-names>LF</given-names></string-name>, <string-name><surname>Goymann</surname> <given-names>W</given-names></string-name>, <string-name><surname>Ter Maat</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gahr</surname> <given-names>M.</given-names></string-name> <article-title>Patterns of call communication between group-housed zebra finches change during the breeding cycle</article-title>. <source>eLife</source>. <year>2015</year>;<fpage>4</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.07770</pub-id>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Greenfield</surname> <given-names>M.</given-names></string-name> <article-title>Mechanisms and evolution of chorusing interactions in acoustic insects and anurans</article-title>. <source>Journal of the Acoustical Society of America</source>. <year>2006</year>;<volume>119</volume>(<issue>5</issue>):<fpage>3222</fpage>&#x2013;<lpage>3222</lpage>. doi:<pub-id pub-id-type="doi">10.1121/1.4785923</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Kershenbaum</surname> <given-names>A</given-names></string-name>, <string-name><surname>Blumstein</surname> <given-names>DT</given-names></string-name>, <string-name><surname>Roch</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Ak&#x00E7;ay</surname> <given-names>&#x00C7;A</given-names></string-name>, <string-name><surname>Backus</surname> <given-names>G</given-names></string-name>, <string-name><surname>Bee</surname> <given-names>MA</given-names></string-name>, <etal>et al.</etal> <article-title>Acoustic sequences in non-human animals: a tutorial review and prospectus</article-title>. <source>Biological Reviews</source>. <year>2014</year>;doi:<pub-id pub-id-type="doi">10.1111/brv.12160</pub-id>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Perez</surname> <given-names>EC</given-names></string-name>, <string-name><surname>Fernandez</surname> <given-names>MSA</given-names></string-name>, <string-name><surname>Griffith</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Vignal</surname> <given-names>C</given-names></string-name>, <string-name><surname>Soula</surname> <given-names>HA.</given-names></string-name> <article-title>Impact of visual contact on vocal interaction dynamics of pair-bonded birds</article-title>. <source>Animal Behaviour</source>. <year>2015</year>;<volume>107</volume>:<fpage>125</fpage>&#x2013;<lpage>137</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.anbehav.2015.05.019</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Paninski</surname> <given-names>L.</given-names></string-name> <article-title>Maximum likelihood estimation of cascade point-process neural encoding models</article-title>. <source>Network: Computation in Neural Systems</source>. <year>2004</year>;<volume>15</volume>(<issue>4</issue>):<fpage>243</fpage>&#x2013;<lpage>262</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Pillow</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Shlens</surname> <given-names>J</given-names></string-name>, <string-name><surname>Paninski</surname> <given-names>L</given-names></string-name>, <string-name><surname>Sher</surname> <given-names>A</given-names></string-name>, <string-name><surname>Litke</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Chichilnisky</surname> <given-names>EJ</given-names></string-name>, <etal>et al.</etal> <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source>. <year>2008</year>;<volume>454</volume>(<issue>7207</issue>):<fpage>995</fpage>&#x2013;<lpage>999</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature07140</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="book"><string-name><surname>Zann</surname> <given-names>RA.</given-names></string-name> <source>The zebra finch: a synthesis of field and laboratory studies</source>. vol. <volume>5</volume>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>1996</year>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Warren</surname> <given-names>WC</given-names></string-name>, <string-name><surname>Clayton</surname> <given-names>DF</given-names></string-name>, <string-name><surname>Ellegren</surname> <given-names>H</given-names></string-name>, <string-name><surname>Arnold</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Hillier</surname> <given-names>LW</given-names></string-name>, <string-name><surname>K&#x00FC;nstner</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>The genome of a songbird</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7289</issue>):<fpage>757</fpage>&#x2013;<lpage>762</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature08819</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Briefer</surname> <given-names>E</given-names></string-name>, <string-name><surname>Osiejuk</surname> <given-names>TS</given-names></string-name>, <string-name><surname>Rybak</surname> <given-names>F</given-names></string-name>, <string-name><surname>Aubin</surname> <given-names>T.</given-names></string-name> <article-title>Are bird song complexity and song sharing shaped by habitat structure? An information theory and statistical approach</article-title>. <source>Journal of Theoretical Biology</source>. <year>2010</year>;<volume>262</volume>(<issue>1</issue>):<fpage>151</fpage>&#x2013;<lpage>164</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.jtbi.2009.09.020</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="book"><string-name><surname>Rabiner</surname> <given-names>L</given-names></string-name>, <string-name><surname>Juang</surname> <given-names>BH.</given-names></string-name> <source>Fundamentals of Speech Recognition. Upper Saddle River</source>, <publisher-loc>NJ, USA</publisher-loc>: <publisher-name>Prentice-Hall, Inc</publisher-name>.; <year>1993</year>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="book"><string-name><surname>Murphy</surname> <given-names>KP.</given-names></string-name> <source>Machine Learning: A Probabilistic Perspective</source>. <publisher-name>MIT press</publisher-name>; <year>2012</year>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="confproc"><string-name><surname>Kershenbaum</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bowles</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Freeberg</surname> <given-names>TM</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>DZ</given-names></string-name>, <string-name><surname>Lameira</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Bohn</surname> <given-names>K.</given-names></string-name> <article-title>Animal vocal sequences: not the Markov chains we thought they were</article-title>. <conf-name>Proceedings of the Royal Society B: Biological Sciences</conf-name>. <year>2014</year>;<volume>281</volume>(<issue>1792</issue>):<fpage>20141370</fpage>. doi:<pub-id pub-id-type="doi">10.1098/rspb.2014.1370</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="website"><string-name><surname>Stowell</surname> <given-names>D.</given-names></string-name> <article-title>Renewal processes and semi-Markov processes in animal vocalisations: A response to Kershenbaum</article-title> <etal>et al.</etal> <conf-name>Proceedings of the Royal Society B</conf-name>. <year>2014</year>;<volume>281</volume>(eLetters). Available from: <ext-link ext-link-type="uri" xlink:href="http://rspb.royalsocietypublishing.org/content/281/1792/20141370.e-letters">http://rspb.royalsocietypublishing.org/content/281/1792/20141370.e-letters</ext-link>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Ball</surname> <given-names>F</given-names></string-name>, <string-name><surname>Milne</surname> <given-names>RK.</given-names></string-name> <article-title>Simple derivations of properties of counting processes associated with Markov renewal processes</article-title>. <source>Journal of Applied Probability</source>. <year>2005</year>; p. <fpage>1031</fpage>&#x2013;<lpage>1043</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="website"><string-name><surname>Stowell</surname> <given-names>D</given-names></string-name>, <string-name><surname>Plumbley</surname> <given-names>MD.</given-names></string-name> <article-title>Segregating event streams and noise with a Markov renewal process model</article-title>. <source>Journal of Machine Learning Research</source>. <year>2013</year>;<volume>14</volume>:<fpage>1891</fpage>&#x2013;<lpage>1916</lpage>. Preprint arXiv:1211.2972. Available from: <ext-link ext-link-type="uri" xlink:href="http://jmlr.org/papers/v14/stowell13a.html">http://jmlr.org/papers/v14/stowell13a.html</ext-link>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="confproc"><string-name><surname>Lasko</surname> <given-names>TA.</given-names></string-name> <article-title>Efficient Inference of Gaussian-Process-Modulated Renewal Processes with Application to Medical Event Data</article-title>. In: <conf-name>Proceedings of the 2014 Conference on Uncertainty in Artificial Intelligence</conf-name>. vol. <volume>2014</volume>; <year>2014</year>. p. <fpage>469</fpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Ter Maat</surname> <given-names>A</given-names></string-name>, <string-name><surname>Trost</surname> <given-names>L</given-names></string-name>, <string-name><surname>Sagunsky</surname> <given-names>H</given-names></string-name>, <string-name><surname>Seltmann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gahr</surname> <given-names>M.</given-names></string-name> <article-title>Zebra Finch Mates Use Their Forebrain Song System in Unlearned Call Communication</article-title>. <source>PLOS ONE</source>. <year>2014</year> <volume>10</volume>;9(<issue>10</issue>):<fpage>e109334</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0109334</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="book"><string-name><surname>Daley</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Vere-Jones</surname> <given-names>D.</given-names></string-name> <source>An Introduction to the Theory of Point Processes</source>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>New York</publisher-loc>; <year>1988</year>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="book"><string-name><surname>Dayan</surname> <given-names>P</given-names></string-name>, <string-name><surname>Abbott</surname> <given-names>LF.</given-names></string-name> <source>Theoretical Neuroscience</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2001</year>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Elie</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Theunissen</surname> <given-names>FE.</given-names></string-name> <article-title>The vocal repertoire of the domesticated zebra finch: a data-driven approach to decipher the information-bearing acoustic features of communication signals</article-title>. <source>Animal Cognition</source>. <year>2015</year>; p. <fpage>1</fpage>&#x2013;<lpage>31</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s10071-015-0933-6</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Hall</surname> <given-names>EC</given-names></string-name>, <string-name><surname>Willett</surname> <given-names>RM.</given-names></string-name> <article-title>Tracking Dynamic Point Processes on Networks</article-title>. <source>arXiv preprint arXiv:14090031</source>. <year>2014</year>;.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Moore</surname> <given-names>M</given-names></string-name>, <string-name><surname>Davenport</surname> <given-names>MA.</given-names></string-name> <article-title>Learning Network Structure with Hawkes Processes</article-title>. <source>Georgia Tech</source>; <year>2015</year>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Psorakis</surname> <given-names>I</given-names></string-name>, <string-name><surname>Voelkl</surname> <given-names>B</given-names></string-name>, <string-name><surname>Garroway</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Radersma</surname> <given-names>R</given-names></string-name>, <string-name><surname>Aplin</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Crates</surname> <given-names>RA</given-names></string-name>, <etal>et al.</etal> <article-title>Inferring social structure from temporal data</article-title>. <source>Behavioral Ecology and Sociobiology</source>. <year>2015</year>; p. <fpage>1</fpage>&#x2013;<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Nagy</surname> <given-names>M</given-names></string-name>, <string-name><surname>&#x00C1;kos</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Biro</surname> <given-names>D</given-names></string-name>, <string-name><surname>Vicsek</surname> <given-names>T.</given-names></string-name> <article-title>Hierarchical group dynamics in pigeon flocks</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7290</issue>):<fpage>890</fpage>&#x2013;<lpage>893</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature08891</pub-id>.</mixed-citation></ref>
</ref-list>
<sec id="s11">
<title>Supporting Information</title>
<sec id="s11a">
<title>GLM point process model fitting</title>
<p>Our use of the GLM point process model broadly follows that of Pillow et al.[<xref ref-type="bibr" rid="c7">7</xref>]. Here we describe specific configuration choices and adaptations we made to the model.</p>
<sec id="s11a1">
<title>Choice of nonlinearity</title>
<p>In the GLM point process model, the instantaneous firing rate &#x03BB; is given by a <italic>linear-nonlinear</italic> link function, meaning that influences are linearly summed and then passed through a nonlinearity:
<disp-formula id="eqn1"><alternatives><graphic xlink:href="039370_eqn1.gif"/></alternatives></disp-formula>
where we have used <italic>b</italic> to represent the base rate component, <italic>K<sub>i</sub></italic> the influence kernel from individual <italic>i</italic>, &#x002A; the convolution operation, and <italic>y<sub>i</sub></italic>(<italic>t</italic>) the sequence of events emitted by individual <italic>i</italic> represented as a spike train.</p>
<p>The function &#x03C3; is a nonlinear mapping which can be freely chosen within certain constraints; these include that the function must be monotonic and nonnegative [<xref ref-type="bibr" rid="c6">6</xref>]. If &#x03C3; is the exponential function, then this has the effect of transforming (1) so that the influences combine in multiplicative fashion rather than additive. If &#x03C3; is the rectifier function max(0, &#x00B7;), this preserves linear additivity except that negative values are clipped away. However, the rectifier function can be difficult to perform numerical optimisation upon, because a large part of its domain gives zero gradient, and often a smooth approximation is used in its place, which we describe shortly.</p>
<p>Within this simple model, in which animal behaviour is embedded in rather abstract form, it is not immediately clear which nonlinearity should be chosen. (Note that the method is rather robust to misspecification, meaning that under mild conditions it yields consistent kernel estimates even if the wrong link function is used [<xref ref-type="bibr" rid="c6">6</xref>, Section 5].) Hence we chose to use these simple nonlinearities and use model comparison to choose between additive and multiplicative models, as was done in [<xref ref-type="bibr" rid="c7">7</xref>]. In early tests we found that the strict rectifier function often failed in optimisation, and so in its place we used the smooth <italic>softplus</italic> function
<disp-formula id="eqn2"><alternatives><graphic xlink:href="039370_eqn2.gif"/></alternatives></disp-formula>
where we introduced the constant scaling factor <italic>c</italic> to bring the function closer to the rectifier nonlinearity. The softplus function is not scale-invariant and so its effect (and hence the desirable choice of <italic>c</italic>) depends on the dynamic range of the data. We used <italic>c</italic> &#x003D; 10, chosen to be large enough to bring the function close to a true rectifier effect without leading to numerical optimisation problems (<xref ref-type="fig" rid="fig10">Figure 10</xref>).</p>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure"><label>Figure 10.</label>
<caption><title>Nonlinearity functions.</title></caption>
<graphic xlink:href="039370_fig10.tif"/>
</fig>
<p>When given an input of zero, our softplus nonlinearity yields a rate of around 0.07 (one call expected every 15 seconds). Negative inputs suppress the rate even further: in theory the rate never quite reaches zero, while with the machine precision used here, a zero rate of emission is produced from an input of around &#x2013;4 or less. Positive inputs become increasingly close to the identity mapping; any input larger than around 0.3 is within 1 per cent deviation from identity.</p>
<p>Typical values of the base-rate parameter <italic>b</italic> in fitted models were approximately around &#x00B1;0.15. The inter-individual variation in <italic>b</italic> was smaller than the general scale of the influence kernels.</p>
</sec>
<sec id="s11a2">
<title>Kernel basis functions</title>
<p>The model works by parametrically combining a set of basis functions to create each kernel. This keeps the dimensionality of the model tractable while allowing for great flexibility in the range of kernels possible. We used a set of raised cosine functions (<xref ref-type="fig" rid="fig11">Figure 11</xref>), distributed in a warped arrangement to offer more detail at short time lags. In initial tests we first used 8 basis functions. We varied the warping factor to inspect whether the choice of bases had a strong influence on the resulting kernel fits. We found that with 8 basis functions the placement of the bases had an observable effect on the undulations of the median fitted kernels, but if we increased to 16 basis functions the recovered kernels were much more stable to the exact choice of basis. We therefore used 16 basis functions for the main analyses. The same set of basis functions was used for all network connections, including self-self and self-other.</p>
<fig id="fig11" position="float" orientation="portrait" fig-type="figure"><label>Figure 11.</label>
<caption><title>The raised-cosine basis functions used to compose each kernel.</title></caption>
<graphic xlink:href="039370_fig11.tif"/>
</fig>
</sec>
<sec id="s11a3">
<title>Regularisation</title>
<p>The model fitting method finds a single point estimate of the best fitting parameters. This is done by maximum likelihood in [<xref ref-type="bibr" rid="c7">7</xref>], but it can also be done by maximum <italic>a posteriori</italic> (MAP; also referred to as a type of penalised maximum likelihood) within the same framework [<xref ref-type="bibr" rid="c6">6</xref>]. It is widely known that maximum likelihood methods are vulnerable to overfitting in the presence of limited data. We therefore used MAP regularisation in the GLM model to help prevent over-fitting at small data sizes and to stabilise the fitted parameter estimates. We used standard <italic>L</italic><sub>2</sub> (Euclidean) regularisation when fitting the model, which is equivalent to a zero-centred Gaussian prior on the coefficients (<xref ref-type="fig" rid="fig12">Figure 12</xref>). We did not regularise the parameter <italic>b</italic>&#x2014;the fixed base-rate for each individual to emit an event in absence of stimulation&#x2014;allowing it to take any value with equal prior probability.</p>
<fig id="fig12" position="float" orientation="portrait" fig-type="figure"><label>Figure 12.</label>
<caption><title>Ten randomly-sampled examples of kernels from the prior distribution of the GLM model (i.e. without any exposure to data), to illustrate the range of kernels that can be fitted and also some qualities of the prior. Note the symmetry of the prior distribution around zero, and the relative smoothness of kernels at long lag times&#x2014;because the basis functions are distributed exponentially with respect to lag time.</title></caption>
<graphic xlink:href="039370_fig12.tif"/>
</fig>
</sec>
</sec>
<sec id="s11b">
<title>Synthetic A&#x2192;B&#x2192;C example and data size tests</title>
<p>The A&#x2192;B&#x2192;C synthetic example given in <xref ref-type="fig" rid="fig1">Figure 1</xref> was generated from a simplified model that is not an exact match to the GLM or MRP generative models, in order to provide a clear example of indirect causation and to examine how the various analyses behave. First, &#x2018;A&#x2019; events were generated from a homogeneous Poisson process with fixed rate of 0.1 Hz. Then, for the two links in the causal chain, A&#x2192;B and B&#x2192;C, each possible source event generated a target event with a probability of 0.9, and if it did so, with a time gap drawn from a log-Gaussian distribution with log-mean 0.75 and log-standard deviation 0.5 (using the natural logarithm). The parameter values here were manually chosen to be on a similar timescale as zebra finch calls, but not intended to be a likely zebra finch scenario, rather to demonstrate the common-cause phenomenon. The generative model just described does not quite match the GLM point process model since no more than one event can be generated as a result of any other event, and there is no nonlinearity in the influence on rates. Nor does it match a pure Markov model: although each A&#x2192;B&#x2192;C sequence considered on its own is Markovian, the process can generate overlapping sequences meaning the overall sequence has no upper bound on its history dependence. This was therefore a useful test of how the different analysis procedures respond to data coming from a simple causal chain. Using this procedure, a timeline of length 96,000 seconds was generated.</p>
<p>For cross-correlation, we used a custom Python script to implement cross-correlation with a maximum lag of 2.5 seconds. Spike data were smoothed using a Hann window of duration 200 ms.</p>
<p><bold>Data size tests</bold> In order to get a practical impression of the data size requirements of the GLM method compared against cross-correlation, we applied both methods to the synthetic A&#x2192;B&#x2192;C model while varying the number of data points fed into the analysis. This way we could guarantee that the source of data was a stationary system with unchanging characteristics, and inspect convergence as data size increased.</p>
<p>The analysis models are not designed to recover the same information, so they are not suitable for numerical comparison (e.g. mean squared error). Under the A&#x2192;B&#x2192;C model there are six inter-individual interactions to analyse, or three if undirected pairs are considered. We visualised the fitted parameters by allocating each of the three pairings to a colour (red/green/blue) and superimposing the three cross-correlation curves. The GLM model recovers six inter-individual kernels so we concatenated each kernel with its kernel in the opposite direction, to produce three shapes that could be colour-mapped in the same way.</p>
<p>We visualised the parameters recovered from the cross-correlation and GLM models, and also the GLM model without regularisation (i.e. maximum likelihood rather than maximum <italic>a posteriori</italic> fitting) (<xref ref-type="fig" rid="fig13">Figure 13</xref>).</p>
<fig id="fig13" position="float" orientation="portrait" fig-type="figure"><label>Figure 13.</label>
<caption><title>Visualisations of the cross-correlation curves and the inter-individual inuence kernels recovered from data generated by the ABC model, as a function of the volume of data fed in to the algorithms. Plots show cross-correlation (upper), GLM (middle) and GLM without regularisation (lower). In each case the kernels/cross-correlations are superimposed as channels of an RGB image, and then normalised for dynamic range. The lower plot appears bolder because the unregularised GLM tended to dramatically large parameter values when overfitting to small datasets.</title></caption>
<graphic xlink:href="039370_fig13.tif"/>
</fig>
<p>We found that both cross-correlation and the GLM model converged at approximately 1024 data points. As expected, the use of regularisation in the GLM model helped prevent overfitting at small data sizes, and to stabilise the fitted parameter estimates. We therefore used this same regularisation for all fits reported in the paper.</p>
</sec>
<sec id="s11b1">
<title>Simulating from the fitted models</title>
<p>Since our model is generative, we can draw newly simulated event sequences from the fitted models, which will thus be qualitatively similar to the original material. These sequences can be of arbitrary length and could even be generated in online (real-time) fashion. We can also use resimulation as another approach to inspecting and validating the fitted models.</p>
<fig id="fig14" position="float" orientation="portrait" fig-type="figure"><label>Figure 14.</label>
<caption><title>Timeline plot of an excerpt from Session 2 of <italic>zf4f.</italic></title></caption>
<graphic xlink:href="039370_fig14.tif"/>
</fig>
<p>As a simple illustration of this, we resimulated 600 seconds of calls using the models fitted to the <italic>zf4f</italic> data. We resimulated the group (<xref ref-type="fig" rid="fig15">Figure 15</xref>), and also we resimulated a single individual taken out of the group context, i.e. with only base-rate and self-self effects (<xref ref-type="fig" rid="fig16">Figure 16</xref>). Between these two different simulations, the effect of group interactions was visible in the data: the same virtual individual produced calls at a rate of one per 14 seconds when simulated alone, and at a rate of one every 6.5 seconds when simulated in the group. (The real data contained a call from that individual every 4.6 seconds.) The resimulated group data replicates qualitative aspects of the real data (<xref ref-type="fig" rid="fig14">Figure 14</xref>) such as the bursty communal calling, though appearing slightly less dense.</p>
<fig id="fig15" position="float" orientation="portrait" fig-type="figure"><label>Figure 15.</label>
<caption><title>Timeline plot of artificial data resimulated from fitted model for Session 2 of <italic>zf4f.</italic></title></caption>
<graphic xlink:href="039370_fig15.tif"/>
</fig>
<fig id="fig16" position="float" orientation="portrait" fig-type="figure"><label>Figure 16.</label>
<caption><title>Timeline plot of artificial data resimulated from fitted model for Session 2 of <italic>zf4f</italic>, in this case with only one virtual bird and no group.</title></caption>
<graphic xlink:href="039370_fig16.tif"/>
</fig>
<p>Re-running the GLM fitting procedure on the resimulated data for the group recovered kernels with the same shapes as in the source model (<xref ref-type="fig" rid="fig18">Figure 18</xref>).</p>
</sec>
<sec id="s11b2">
<title>Further plots from datasets</title>
<p>For the <italic>zf4f</italic> dataset, overall calling rates per individual ranged from 468 to 888 calls per hour (<xref ref-type="table" rid="tbl2">Table 2</xref>), and rates exhibited some modulation across each hour (<xref ref-type="fig" rid="fig17">Figure 17</xref>). A composite of all the influence kernels fitted to the dataset is shown in <xref ref-type="fig" rid="fig19">Figure 19</xref>.</p>
<fig id="fig17" position="float" orientation="portrait" fig-type="figure"><label>Figure 17.</label>
<caption><title>Density plots of the calling rates of each bird in the <italic>zf4f</italic> recording study. Rates are calculated from call times using kernel density estimation with a bandwidth of 15 seconds.</title></caption>
<graphic xlink:href="039370_fig17.tif"/>
</fig>
<table-wrap id="tbl2" orientation="portrait" position="float"><label>Table 2.</label>
<caption><p>Total calls emitted by each bird in the <italic>zf4f</italic> recording study.</p></caption>
<graphic xlink:href="039370_tbl2.tif"/>
</table-wrap>
<p>For completeness we show the fitted kernels for all possible call-type interactions, for a specific day of interest in the Gill et al.dataset (<xref ref-type="fig" rid="fig20">Figure 20</xref>).</p>
<fig id="fig18" position="float" orientation="portrait" fig-type="figure"><label>Figure 18.</label>
<caption><title>Kernels recovered from the resimulated data.</title></caption>
<graphic xlink:href="039370_fig18.tif"/>
</fig>
<fig id="fig19" position="float" orientation="portrait" fig-type="figure"><label>Figure 19.</label>
<caption><title>Aggregate view of the inuence kernels recovered from our two study sessions with four female zebra finches, as <xref ref-type="fig" rid="fig3">Figure 3</xref> but showing every one of the 16 curves fitted to each session, rather than confidence intervals.</title></caption>
<graphic xlink:href="039370_fig19.tif"/>
</fig>
<fig id="fig20" position="float" orientation="portrait" fig-type="figure"><label>Figure 20.</label>
<caption><title>Aggregate kernels for all possible call-type interactions, for the data of Gill et al.on day 7.</title></caption>
<graphic xlink:href="039370_fig20.tif"/>
</fig>
</sec>
</sec>
<fn-group>
<fn id="fn1"><label><sup>1</sup></label><p>Data available from: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.1613791">https://dx.doi.org/10.6084/m9.figshare.1613791</ext-link></p></fn>
<fn id="fn2"><label><sup>2</sup></label><p>Software available from: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/danstowell/callnets-glm">https://bitbucket.org/danstowell/callnets-glm</ext-link></p></fn>
<fn id="fn3"><label><sup>3</sup></label><p>Data available from: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/73cbdf96ab156a0f0a69">https://figshare.com/s/73cbdf96ab156a0f0a69</ext-link></p></fn>
</fn-group>
</back>
</article>