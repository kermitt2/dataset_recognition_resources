<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/244079</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A computational framework for converting high-throughput DNA sequencing data into neural circuit connectivity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Oyibo</surname>
<given-names>Hassana</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cao</surname>
<given-names>Cang</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ferrante</surname>
<given-names>Daniel D.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhan</surname>
<given-names>Huiqing</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Koulakov</surname>
<given-names>Alex</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Enquist</surname>
<given-names>Lynn</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dubnau</surname>
<given-names>Joshua</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zador</surname>
<given-names>Anthony</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Cold Spring Harbor Laboratory, Neuroscience, Cold Spring Harbor</institution>, NY, 11724</aff>
<aff id="a2"><label>2</label><institution>Princeton University, Molecular Biology</institution>, Princeton, NJ, 08540</aff>
<aff id="a3"><label>3</label><institution>Watson School of Biological Sciences</institution>, Neuroscience, Cold Spring Harbor, NY, 11724</aff>
</contrib-group>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>244079</elocation-id>
<history>
<date date-type="received">
<day>05</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>05</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>07</day>
<month>1</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="244079.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<p>There is growing interest in determining the connectivity of neural circuits&#x2014;the &#x201C;connectome&#x201D;&#x2014;at single neuron resolution. Most approaches to circuit mapping rely on either microscopy or physiology, but these approaches have very limited throughput. We have recently proposed BOINC (Barcoding of Individual Neuronal Connectivity), a radically different approach to connectivity mapping based on high-throughput DNA sequencing. Here we describe the set of computational algorithms that serve to convert sequencing data into neural connectivity. We apply our computational pipeline to the results of proof-of-principle experiments illustrating an implementation of BOINC based on pseudorabies virus (PRV). PRV is capable of traversing individual synapses and carry DNA barcodes from one cell to another. Using this high-throughput sequencing data, we obtain 456-by-486 connectivity matrix between putative neurons. An inexpensive high-throughput technique for establishing circuit connectivity at single neuron resolution would represent a major advance in neuroscience.</p>
</abstract>
<counts>
<page-count count="13"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>The mouse brain consists of tens of millions of neurons each connected by thousands of synapses; the human brain has tens of thousands of times more. The details of these connections are crucial in determining brain function. Malformation of these connections during prenatal and early postnatal development can lead to mental retardation, autism or schizophrenia (<xref ref-type="bibr" rid="c8">Dani and Nelson, 2009</xref>; <xref ref-type="bibr" rid="c20">Rinaldi et al., 2008</xref>; Testa-Silva et al., <xref ref-type="bibr" rid="c24">2012</xref>); loss of specific connections later in life is associated with neurodegenerative diseases such as Alzheimer&#x2019;s. An efficient method for determining the brain&#x2019;s wiring diagram at single neuron resolution&#x2014;its <italic>connectome</italic>&#x2014;would represent a major advance in neuroscience.</p>
<p>Current approaches to determining the connectome are based on electron microscopy. So far, the complete connectome has been established for only one organism, the tiny worm <italic>C. elegans,</italic> with 302 neurons connected by about 7000 synapses. However, determining the connectome of even this simple nervous system was a heroic task, requiring over 50 person-years of labor. Although recent technological advances (<xref ref-type="bibr" rid="c2">Bock et al., 2011</xref>; <xref ref-type="bibr" rid="c3">Briggman et al., 2011</xref>) have led to considerable increases in throughput, electron microscopic approaches to reconstructing neural circuitry remain slow, expensive and laborious.</p>
<p>To circumvent the challenges associated with determining the connectome by microscopy, we have been pursuing an alternative strategy in which neural connectivity is converted into a form that can be decoded by high-throughput DNA sequencing (<xref ref-type="bibr" rid="c26">Zador et al., 2012</xref>). The appeal of sequencing is that it is fast and inexpensive&#x2014;the cost of sequencing a human genome (&#x007E;3B nucleotides) is approaching &#x0024;1000. Thus by converting brain connectivity from a problem of microscopy to a problem of sequencing, we render it tractable using current techniques.</p>
<p>To convert connectivity into a sequencing problem, three challenges must be solved. <italic>First,</italic> each neuron must be endowed with a unique DNA or RNA &#x201C;barcode.&#x201D; The potential diversity of sequences of DNA grows exponentially with the sequence length, so that even very short sequences can be used to barcode neuronal populations uniquely. For example, a barcode consisting of a random string of 25 nucleotides has a potential diversity of 4<sup>25</sup> &#x003D; 10<sup>15</sup>, far more than the number of neurons (&#x003C;10<sup>8</sup> neurons) in a mouse brain. <italic>Second,</italic> barcodes from synaptically connected neurons must be associated into barcode pairs representing connections between neurons. <italic>Third,</italic> synaptically associated barcodes must be sequenced. The barcode pairs associated at synapses will then contain an imprint of synaptic connectivity of the entire network with single-cell resolution. This connectivity can be obtained by sequencing DNA barcodes using conventional next-generation sequencing technology, or by in situ sequencing methods such as BaristaSeq (<xref ref-type="bibr" rid="c7">Chen et al., 2017</xref>).</p>
<p>Here we present computational methods that can be used to reconstruct connectivity based on experimental data obtained in neuronal co-culture. The experimental approach adopted here is our first generation system. This system uses pseudorabies virus (PRV), a double stranded DNA virus of the herpes family, to move barcodes between connected neurons. PRV has evolved exquisite mechanisms for moving genetic material between functionally connected neurons, and has been used extensively for tracing neural circuits (<xref ref-type="bibr" rid="c4">Card and Enquist, 2012</xref>). Although there are technical limitations arising from our first generation transsynaptic approach which are mitigated in our second generation approach [synseq; (<xref ref-type="bibr" rid="c18">Peikon et al., 2017</xref>)], our results demonstrate the feasibility of each of the key components for converting neuronal connectivity into a form that can be read by next generation sequencing.</p></sec>
<sec id="s2">
<title>Materials and Methods</title>
<sec id="s2a">
<title>DNA constructs and Barcode library</title>
<p>PRV amplicons are plasmids containing a PRV origin of replication (ORI) and no other viral genes. In the presence of a PRV strain that can replicate, the amplicons replicates to high copy number. If the PRV amplicon also contains a viral DNA packaging sequence (a PAC site), the replicated amplicon will be packaged efficiently in helper virus infected cells into virus particles that can infect cells and deliver the amplicon DNA. We constructed two types of amplicons called <italic>hosts</italic> and <italic>invaders.</italic> The host amplicon did not contain a PRV PAC sequence and therefore could not be packaged into virions produced by the helper PRV. The invader replicon contained both an ORI and a PAC site. To construct the invader amplicon vector, PRV ORI and PAC sequences were amplified from pORI-PAC-GFP (a generous gift from Dr. Enrique Tabar&#x00E9;s) and subcloned together with CAGGS-dsRed Express into pSMART vector. To construct the host amplicon vector, PRV ORI was amplified from pORI-PAC-GFP and subcloned together with CAGGS-GFP into the pSMART vector. The phiC31 plasmid pCS-P (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2834998/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2834998/</ext-link>) was a generous gift from Dr. Michele P. Calos (Stanford). The oligonucleotides used for invader and invader barcode library construction were synthesized by IDT (Coralville, IA), and made double stranded by primer annealing and extension. The invader amplicons contained the Solexa II sequence from Illumina followed by 25 random nucleotides that are then followed by a library accession tag sequence (TAGC) and the truncated phiC31 integration sequence attB. The invader oligonucleotide sequence was as follows:</p>
<p><disp-quote>
<p>CAAGCAGAAGACGGCATACGAGATCGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT-N25-TAGCGTGCGGGTGCCAGGGCGTGCCCTTGGGCTCCCCGGGCGCGTACTCC.</p></disp-quote></p>
<p>The host contained the Solexa I sequence from Illumina followed by 25 random nucleotides, followed by a library accession tag sequence (GTCA) and the truncated phiC31 integration attP sequence. The host oligonucleotide sequence was as follows:</p>
<p><disp-quote>
<p>AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT-N25-GTCAACGCCCCCAACTGAGAGAACTCAAGGGCACGCCCTGGCACCCGCAC.</p></disp-quote></p>
<p>EcoRI and NheI sites were present at the ends of both oligonucleotides, and the digested oligonucleotides were ligated into their respective amplicon vectors. The resulting plasmid library was then transformed into bacteria and amplified. Assuming that each bacterial colony contained a single unique barcode, the diversity of each library was estimated by counting the number of colonies obtained from a small aliquot of transformed bacteria, and in some cases validated by high-throughput sequencing. Library diversity was typically in the range of 10<sup>6</sup>&#x2013;10<sup>7</sup>.</p>
</sec>
<sec id="s2b">
<title>Cell culture, electroporation and infection</title>
<p>Embryonic day 18 rat cortical tissue was purchased from Brainbits (Springfield, IL). After 20 minute-digestion in papain, the cortical tissue was resuspended in NbActiv4 medium (Brainbits, Springfield, IL.) and subjected to electroporation. A suspension of 5&#x00D7;10<sup>5</sup> cells was electroporated with 1&#x03BC;g of the invader or host amplicon &#x00B1; 1 &#x03BC;g of phiC31 plasmids using an Amaxa Nucleofector (Amaxa Biosystems, Lonza) following the manufacturer&#x2019;s directions. After electroporation, cells with invader or host amplicons &#x00B1; phiC31 were mixed and co-plated in a 24-well tissue culture plate pre-coated with poly-L-lysine (Sigma, St. Louis, MO). Three or 13 days after co-plating, cells were infected by the Bartha strain of PRV at a multiplicity of infection (MOI) of 1.</p>
</sec>
<sec id="s2c">
<title><italic>In utero</italic> electroporation and infection</title>
<p><italic>In utero</italic> electroporations were performed as described elsewhere (<xref ref-type="bibr" rid="c9">Dixit et al., 2011</xref>). Briefly: the amplicon plasmid electroporated included PRV-PAC, PRV-ORI and a GFP expression cassette. The amplicon DNA was prepared with a Qiagen endotoxin free maxi prep, and injected at a concentration of &#x007E;1&#x03BC;g/&#x03BC;l after mixing with &#x007E;0.025&#x0025; fast green dye. Pulled glass capillaries with an opening of &#x007E;10 &#x03BC;m were used to deliver the DNA. Pregnant FVB mice 16 days into gestation were anesthetized with isoflurane, their uterus was exposed and approximately 1&#x2013;2&#x03BC;ls of the amplicon plasmid mix was microinjected using a Picospritzer II (Parker Instruments), into the lateral ventricles of the cerebral cortex through the uterus. Electroporation was achieved by unipolar discharge of 50V in five 50ms pulses spaced 950ms apart using a BTX ECM 830 Square Wave Electroporator. The positive charged paddle was placed on the left side of the pup brain to target amplicons plasmid to left cortex. After suturing, the pregnant mice were placed on heating pads until they awoke. At P23 electroporated pups were injected in the left auditory cortex with &#x007E;200nl of PRV Becker titer 10<sup>9</sup>, Brains were harvested following transcardial perfusion 24 hours after infection. All animal protocols were in accordance with the Cold Spring Harbor Laboratory Animal Care and Use Committee and carried out in accordance with National Institutes of Health standards.</p>
</sec>
<sec id="s2d">
<title>DNA extraction, PCR and sequencing</title>
<p>DNA was extracted using the Zymo viral DNA kit (Zymo research, Irvine, CA) according to the manufacturer&#x2019;s instructions. The fused barcode pairs were amplified by PCR using Phusion Flash PCR Master Mix (Finnzymes, Vantaa, Finland) under the following conditions: 98&#x00B0;C for 10 sec, 37&#x00D7; [98&#x00B0;C for 1 sec, 72&#x00B0;C for 40 sec], 72&#x00B0;C for 1 min. 1 &#x03BC;l of the PCR product was subcloned into blunt TOPO vector (Invitrogen, Carlsbad, CA) and sequenced using conventional Sanger methods the remainder was purified and sequenced by Illumina (GA-II).</p>
</sec>
<sec id="s2e">
<title>Force directed graph drawing</title>
<p>To visualize the network in space, we minimized the following functional with respect to the 3D positions of network nodes <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline1.gif"/></alternatives></inline-formula> (<xref ref-type="bibr" rid="c11">Fruchterman and Reingold, 1991</xref>)</p>
<disp-formula>
<alternatives><graphic xlink:href="244079_ueqn1.gif"/></alternatives>
</disp-formula>
<p>Here <italic>N</italic> is the total number of nodes (456 &#x002B; 786 &#x003D; 1242 in <xref ref-type="fig" rid="fig8">Figure 8</xref>, for example) <italic>C<sub>ij</sub></italic> is the connectivity matrix between nodes <italic>i</italic> and <italic>j</italic> (1242&#x00D7;1242 for <xref ref-type="fig" rid="fig8">Figure 8</xref>), <italic>l</italic> &#x003D; 1 is the equilibrium spring length, <italic>q</italic> &#x003D; 0.016 is the repulsive constant, and <italic>U</italic><sub>0</sub> &#x003D; 0.01. Three terms in this sum describe elastic springs between connected nodes, electrostatic repulsion between all nodes, and repulsion from the center of mass, respectively. We minimized the functional using the conjugate gradient algorithm (<xref ref-type="bibr" rid="c22">Saad, 2003</xref>). This yielded positions of the nodes in the minimum <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline2.gif"/></alternatives></inline-formula> that are shown in <xref ref-type="fig" rid="fig8">Figures 8</xref> and <xref ref-type="fig" rid="fig11">11</xref>.</p></sec></sec>
<sec id="s3">
<title>Results</title>
<p>We developed methods to accomplish each of the three steps needed to convert neuronal connectivity into a DNA sequencing problem (<xref ref-type="fig" rid="fig1">Fig. 1</xref>). First, we developed a strategy to deliver DNA barcodes to neurons using PRV amplicons. Second, we devised a means to move amplicons. After amplicon movement to synaptically connected neurons, each neuron contains copies of its own barcoded amplicon, as well as copies of barcoded amplicons from synaptic partners. Finally, we used phiC31 integrase (<xref ref-type="bibr" rid="c13">Groth et al., 2000</xref>) to join the barcodes from synaptically connected partners. The joined barcode pairs are then sequenced.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Overview of the approach. (<bold>A</bold>) Individual neurons are marked with DNA barcodes&#x2014;randomly generated unique sequences of DNA. (<bold>B</bold>) Barcodes move across synapses to connected neurons. (<bold>C</bold>) Barcodes are joined together <italic>in vivo</italic> and then sequenced. (<bold>D</bold>) Joined barcode pairs indicate synaptic partners and can be used to reconstruct the circuit connectivity.</p></caption>
<graphic xlink:href="244079_fig1.tif"/>
</fig>
<sec id="s3a">
<title>Barcoding</title>
<p>We first developed a method to barcode each neuron with a random sequence of nucleotides. We used standard shotgun cloning techniques to barcode plasmids <italic>in vitro</italic> (see Methods). Briefly, a synthetic oligonucleotide encoding a sequence of 25 random nucleotides (&#x201C;N&#x201D;) was ligated into a PRV amplicon plasmid. The resulting plasmid was then transformed into bacteria and amplified. In practice, this transformation step represented the bottleneck limiting the diversity of the plasmids, with typical diversities in the range of 10<sup>6</sup>&#x2013;10<sup>7</sup> (<italic>see Methods</italic>). Barcoded plasmids were transfected into neurons, thereby endowing each transfected neuron with one or more unique barcodes.</p>
</sec>
<sec id="s3b">
<title>PRV-mediated barcode transport</title>
<p>We next developed a method based on PRV for moving barcodes between synaptically connected neurons. The PRV genome is approximately 150 kb and encodes about 70 genes (<xref ref-type="bibr" rid="c23">Szpara et al., 2011</xref>). The replication of PRV begins at the origin of replication (ORI). The PRV ORI<sub>s</sub> is encoded within a 1.9kb fragment of the PRV genome, previously identified as sufficient to enable helper virus mediated replication of a plasmid (<xref ref-type="bibr" rid="c12">Fuchs et al., 2000</xref>; <xref ref-type="bibr" rid="c19">Prieto et al., 2002</xref>). The packaging of PRV into the viral capsid requires a PAC sequence (1.2 kb). Under normal conditions the ORI and PAC signal the replication and packaging of the full-length virus, but the ORI and PAC can also signal the replication and packaging of other DNA sequences (<xref ref-type="bibr" rid="c19">Prieto et al., 2002</xref>). For example, amplicons containing the ORI and PAC of the closely related herpes simplex virus (HSV), but no other viral sequences, can be grown in high titer in the presence of HSV helper viruses and have been used widely for gene delivery (<xref ref-type="bibr" rid="c10">Fraefel, 2007</xref>).</p>
<p>To move barcodes across synapses we engineered PRV amplicons (<xref ref-type="bibr" rid="c19">Prieto et al., 2002</xref>) that contain the PRV ORI and PAC sequences. We expected that a PRV amplicon with ORI and PAC sequences transfected into a neuron would, in the presence of a helper PRV, be replicated and packaged and thus be available for movement. Because PRV amplicons are plasmids, they are amenable to the method described above to produce highly diverse populations of barcoded PRV amplicons using standard techniques. Achieving similar barcode diversity in the full-length viral genome, using BAC recombineering or other methods, would have required overcoming significant additional challenges. Although HSV amplicons are widely used to infect neuronal and non-neuronal cells, less is known about PRV amplicons. In particular, the PRV-mediated movement of amplicons across synapses has not been reported.</p>
<p>We first tested the ability of PRV to mediate the movement of PRV amplicons across synapses <italic>in vivo.</italic> We used <italic>in utero</italic> electroporation (E16) to introduce amplicons expressing GFP into layer 2/3 of the left mouse cortex. At day P23 PRV (Becker strain) was injected into the left auditory cortex. After 24 hours neurons labeled with GFP were observed in neurons in diverse brain regions (<xref ref-type="fig" rid="fig2">Fig. 2c</xref>). These experiments showed that PRV could mediate movement of amplicons in the brain.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Amplicons undergo PRV-mediated transneuronal movement. (<bold>A</bold>) Viral amplicons are produced when plasmids containing the packaging (PAC) and origin of replication (ORI) sequences of PRV are introduced into the viral packaging cell line in combination with PRV. PRV acts as a helper virus, producing proteins that replicate and package plasmids with PAC and ORI into infectious particles. The output yield after helpervirus infection is a mixture of infectious particles, some containing the viral genome and some containing the amplicon. (<bold>B</bold>) Two types of amplicons were constructed for this study. The <italic>host</italic> amplicon encodes dsRed, PRV ORI and a barcode cassette which includes an Illumina paired end primer binding site (SA2), a randomly generated barcode (N<sub>25</sub>) and a phiC31 integration site (attP). The <italic>invader</italic> includes a GFP, PRV PAC and ORI in addition to a complementary barcode cassette with an Illumina paired end binding site (SA1), a randomly generated barcode (N<sub>25</sub>) and a phiC31 integration site (attB). The absence of a PAC in the host prevents the host amplicons from being packaged and from spreading to connected neurons. (<bold>C</bold>) PRV mediates spread of amplicons <italic>in vivo.</italic> Amplicons encoding dsRed were unilaterally introduced into the right hemisphere of E16 mice using <italic>in utero</italic> electroporation (IUE). At P23 mice were injected with PRV Becker in the right hemisphere causing the replication and spread of amplicons, as evidenced by the presence of amplicons in the contralateral cortex. (<bold>D</bold>) PRV mediates spread of amplicons <italic>in vitro.</italic> E18 cortical neurons were electroporated with either invader amplicon (red) or host amplicon (green) with or without phiC31 and co-plated. PRV Bartha was added at day 3 or 13 after coplating. (<bold>E</bold>) Images were taken at 24 hours after infection. Overlap of invader and host amplicons was observed in neurons infected by PRV Bartha (upper panel), but not in uninfected neurons (lower panel).</p></caption>
<graphic xlink:href="244079_fig2.tif"/>
</fig>
<p>We next tested the ability of PRV to mediate movement of PRV amplicons <italic>in vitro.</italic> We co-cultured two populations of embryonic cortical neurons which had been transfected with two species of PRV amplicons. The first, &#x201C;host,&#x201D; species encoded dsRed, and contained an ORI but no PAC sequence, allowing replication but not packaging in the presence of a helper PRV. The second, &#x201C;invader,&#x201D; species encoded GFP, and contained both an ORI and PAC, allowing both replication and packaging in the presence of a helper PRV.</p>
<p>In 13-day cultures, many neurons expressed GFP or dsRed robustly, but as expected no neuron expressed both fluorophores, confirming that PRV amplicons require coinfection with helper PRV for movement (<xref ref-type="fig" rid="fig2">Fig. 2e</xref>). After twenty-four hours of incubation with the Bartha strain of PRV, co-labeling was observed (<xref ref-type="fig" rid="fig2">Fig. 2e</xref>), indicating movement of amplicons. No co-labeling was observed when PRV was added 4 days after plating, before the formation of synapses in these cultures (<xref ref-type="bibr" rid="c25">Weiss et al., 1986</xref>), consistent with a synapse-dependent mechanism for PRV spread (<xref ref-type="bibr" rid="c5">Card et al., 1993</xref>; <xref ref-type="bibr" rid="c15">Kim et al., 1999</xref>). These experiments indicate that PRV can mediate the movement of amplicons <italic>in vivo</italic> and <italic>in vitro.</italic></p>
</sec>
<sec id="s3c">
<title>Joining of barcodes</title>
<p>We use phiC31 integrase (<xref ref-type="bibr" rid="c13">Groth et al., 2000</xref>) to join host and invader barcodes. PhiC31 integrase is a site specific phage serine recombinase phiC31 that mediates the recombination between the asymmetric attB and attP sequences to form an attL and an attR sequence. Because phiC31 integrase does not mediate the recombination between attL and attR, phiC31 integrase mediated recombination is irreversible, unlike the tyrosine recombinases Cre and Flp.</p>
<p>We constructed invader amplicons in which diverse barcodes were placed near an attB site, and host amplicons in which diverse barcodes were placed near an attP site. Joining of the invader attB site with the host attP site by phiC31 integrase yields a product in which the two barcodes are fused, separated only by an attL site. This joined product can then be amplified by PCR and sequenced (<xref ref-type="fig" rid="fig3">Fig. 3b</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Readout of barcode connectivity by PCR amplification and sequencing of fused barcodes (<bold>A</bold>) Host and donor amplicons are fused by phiC31-mediated integration of the attB on the invader plasmid to the attP on the host plasmid to form an integration product in which the two barcodes are joined and flanked by the Illumina sequencing adaptors SA1 and SA2. (<bold>B</bold>) PCR amplification of the joined barcode (upper panel) and GFP as a control (lower panel). (<bold>C</bold>) DNA sequence of joined invader and host barcodes, with attL sequence highlighted in open box.</p></caption>
<graphic xlink:href="244079_fig3.tif"/>
</fig>
<p>To test the ability of phiC31 integrase to join barcodes from synaptically coupled neurons, we adopted a strategy similar to that used above to assess movement of amplicons. However, instead of using the co-expression of different fluorophores, we used PCR amplification of joined barcodes as the readout. Embryonic cortical neurons were transfected with either host or invader amplicons and co-cultured. Host amplicons contained a phiC31 attB site adjacent to a random 25 bp barcode, as well as an ORI for replication. Invader amplicons contained a complementary phiC31 attP site adjacent to a random 25 bp barcode, and both an ORI and a PAC. In some experiments phiC31 integrase was co-transfected.</p>
<p>Twenty-four hours after incubating with PRV, we extracted DNA and amplified the joined barcode product by PCR. <xref ref-type="fig" rid="fig3">Fig. 3a</xref> shows that the product of the expected size (223 bp, which includes a pair of 25 bp barcodes, a pair of 4 bp tags, a 58bp SA1 and 61bp SA2 illumina sequencing adaptor and a 46 bp attL site) can be detected, indicating both movement of the invader amplicon and joining of the host and invader amplicon. As expected, no product was detected in the absence of either PRV infection or phiC31 integrase, confirming the dependence of the product on both movement and phiC31-mediated joining. In addition, no product was observed in 4-day cultures, before the formation of synapses in these cultures (<xref ref-type="bibr" rid="c6">Chang and Reynolds, 2006</xref>; <xref ref-type="bibr" rid="c17">de Lima et al., 1997</xref>), consistent with a synapse-dependent mechanism for PRV spread(<xref ref-type="bibr" rid="c5">Card et al., 1993</xref>; <xref ref-type="bibr" rid="c15">Kim et al., 1999</xref>).</p>
<p>Conventional Sanger sequencing of 20 colonies of the topo-cloned PCR product confirmed that the joined product had the expected structure, consisting of the invader barcode, the attL site, and the host barcode (<xref ref-type="fig" rid="fig3">Fig. 3c</xref>). We therefore performed high-throughput paired-end (PE) sequencing with an Illumina MiSeq.</p>
</sec>
<sec id="s3d">
<title>Computational algorithms for inferring connectivity</title>
<p>We have implemented a computational pipeline that is capable to efficiently convert sequencing data into connection matrix (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The input of this pipeline is the set of sequences of barcode host-invader pairs and attL sites. Here we will call such sequences &#x2018;reads&#x2019;. High-throughput sequencing yielded approximately 8.3 million such sequences. We applied a series of preprocessing filters to these sequences that implemented several steps of error correction of the barcode pairs. First, we discarded any reads that contained unassigned nucleotides (&#x201C;N&#x201D;) at any position. Second, we removed the reads that failed to match the phiC31 attL consensus sequence perfectly. Because high-throughput sequencing is preceded by barcode amplification using PCR, each barcode pair is represented in several copies. As the next step, we identified unique barcode sequences within the list of reads. This operation yielded 376 thousand unique barcode pairs. In our dataset, each unique barcode pair was accompanied by the corresponding number of copies. Many of these reads appeared only in low copy number, consistent with errors in PRV replication, PCR amplification and sequencing. As the third step of error correction, therefore, we considered only reads that occurred in at least 5 copies. This yielded 16,622 unique barcode pairs.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><p>The overview of the computational pipeline for circuit reconstruction.</p></caption>
<graphic xlink:href="244079_fig4.tif"/>
</fig>
<p>The next step of our algorithm resulted in the construction of raw connectivity between hosts and invader barcodes. First, we identified unique invaders (n&#x003D;6,635) and unique hosts (n&#x003D;9,042) within the list of 16,622 unique barcode pairs obtained in the previous step. Second, we defined a sparse 6,635 x 9,042 raw connection matrix with 16,622 nonzero elements representing the connections from 9,042 hosts to 6,635 invaders. This operation resulted in the connectivity matrix between host and invader barcodes that may reflect real connectivity between neurons (<xref ref-type="fig" rid="fig5">Figure 5A</xref>).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Connection matrices generated by the algorithm. (A) 6,635 by 9,042 raw connection matrix resulting from step 2.2 (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Each dot represents a unique invader-host pair. (B) The forest fire algorithm identifies connected subgraphs within the raw connection matrix (step 3.1). Connectivity in the largest subgraph is shown (2,083 by 3,929).</p></caption>
<graphic xlink:href="244079_fig5.tif"/>
</fig>
<p>Several additional steps are needed to make raw connectivity understandable as neuronal connectivity. These steps are included in the set of algorithms called postprocessing (<xref ref-type="fig" rid="fig3">Figure 3</xref>). First, we identified connected subgraphs within the graph defined by the raw connectivity (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) using the forest fire algorithm (<xref ref-type="bibr" rid="c14">Hopcroft and Tarjan, 1971</xref>). We found that 16622 connections were organized into 4,077 discrete subnetworks ranging in size from 6,012 to 2 nodes (including both hosts and invaders). The largest connected subgraph contained 2,083 invaders and 3,929 hosts (6,012 nodes in total). The next largest connected subgraph contained 28 invaders and 2 hosts. We limited the subsequent analysis to the largest connected subgraph. The connectivity of this connected subgraph is defined by the matrix <italic>C<sub>ij</sub></italic>, where the invader index <italic>i</italic> runs between 1 and 2,083, and the host index <italic>j</italic> varies between 1 and 3,929 (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p></sec>
</sec>
<sec id="s4">
<title>Detection of barcoded nodes with correlated connectivity</title>
<p>Within the largest connected subgraph of the raw matrix (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), many barcodes had very similar connectivity. This likely resulted from the transfection of multiple invader or host barcodes, with distinct sequences, into single neurons. If all subsequent processes&#x2014;including PRV-mediated transsynaptic transmission, phiC31-mediated joining, PCR amplification and sequencing&#x2014;were perfectly efficient and error-free, then multiple barcodes transfected into a given neuron would have identical connectivity. We therefore developed a novel clustering algorithm to identify nodes with similar connectivity, reasoning that high similarity was more likely to occur due to multiple barcoding of a single neuron than to highly shared patterns of connections within the network of cultured neurons. This algorithm is represented by step 3.2 (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The details of the clustering algorithm are described below (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Pearson correlations in connectivity for pairs of invaders. (A) Before clustering. (B) After clustering. The ordering of invader barcodes is changed in (B) compared to (A) so that nearby barcodes belong to the same cluster, i.e. share high similarity in their connectivity patterns to the host barcodes. Clustering is produced by the greedy multidimensional clustering algorithm as described in the text.</p></caption>
<graphic xlink:href="244079_fig6.tif"/>
</fig>
<p>To detect neurons with similar connectivity, we calculated the pairwise similarity matrices of connectivity for both invaders and hosts <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline3.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline4.gif"/></alternatives></inline-formula>. Here <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline5.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline6.gif"/></alternatives></inline-formula> are square matrices, 2,083 x 2,083 and 3,929 x 3,929 respectively. An element of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline7.gif"/></alternatives></inline-formula> contains the Pearson correlation (the R-value) between connectivity of invaders <italic>i</italic> and <italic>j</italic> (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Similarly, an element of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline8.gif"/></alternatives></inline-formula> contains Pearson correlation between connectivity of host barcodes <italic>i</italic> and <italic>j</italic>. To evaluate these correlation matrices we used the binary form of invader-host connectivity that is equal to 0 or 1 depending on whether a single barcode pair with this invader and host is present in the sequencing results. To determine which host and invader barcodes belong to the same network node, we used a greedy multidimensional clustering algorithm inspired by watershed algorithm used in morphological image analysis (<xref ref-type="bibr" rid="c1">Beucher and Lantu&#x00E9;j, 1979</xref>; <xref ref-type="bibr" rid="c21">Roerdink and Meijster, 2000</xref>) and Kruskal algorithm for finding the shortest spanning tree of a graph (<xref ref-type="bibr" rid="c16">Leiserson et al., 2009</xref>). We therefore called our algorithm Kruskashed. We describe the application of the algorithm to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline9.gif"/></alternatives></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7</xref>); the application to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline10.gif"/></alternatives></inline-formula> is analogous. First, we identified pairs of invader barcodes that are correlated at the high level of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline11.gif"/></alternatives></inline-formula> and found a set of connected clusters amongst these pairs. This step is needed to alleviate the effects of noise on clustering results and is analogous to the marker control step described for the watershed algorithms. The connected clusters were used as markers that initiate the set of clusters for the subsequent greedy steps. To practically implement this step, we just set all values of connectivity correlations with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline12.gif"/></alternatives></inline-formula> to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline13.gif"/></alternatives></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Second we grew the clusters by adding pairs of invader barcodes one by one in the order of decreasing correlation <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline14.gif"/></alternatives></inline-formula>. On every step of this iterative procedure, a pair of invaders is considered to be added to the existing clusters. If only one of the invaders within the pair belongs to an existing cluster or if both invaders belong to the same cluster, this pair is attributed to this cluster. If none of the invaders within the pair belongs to an existing cluster, we initiated a new cluster. If two invaders belong to different clusters, the invaders are left untouched. This iterative procedure was repeated until all invaders are attributed to a network node cluster. The same algorithm was used to cluster the host nodes.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7.</label>
<caption><p>Greedy multidimensional clustering algorithm (Kruskashed) used here to discover clusters of barcodes with correlated connectivity assumed to represent individual neurons. (<bold>A</bold>) The flowchart of the algorithm. (<bold>B</bold>) Illustration of the algorithm clustering a set of six barcodes (dots). The distances between dots represent correlations of connectivity. At each step a pair of barcodes is considered that is next in the order of decreasing distance (correlation) from each other. Three possible scenarios for the pair assignment in (A) are illustrated in the panels two, four, and six.</p></caption>
<graphic xlink:href="244079_fig7.tif"/>
</fig>
<p>After applying this redundancy reduction procedure [step 3.2, <xref ref-type="fig" rid="fig4">Figure 4</xref>] to the 2,083 by 3,929 invader-host connectivity matrix (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), we obtained a connectivity matrix for invader-host network nodes that had dimensions of 456 by 786. We denote this reduced connection matrix <italic>S<sub>ij</sub></italic>. Indexes <italic>i</italic> and <italic>j</italic> run from 1 to 456 and 786 respectively and represent clusters of invader and host barcodes with similar connectivity. Such connectivity correlations are expected in our network if a cell is electroporated by several host or invader plasmids with different barcode sequences. Although this could not be independently verified, we assumed that these clusters of highly correlated barcodes represent individual neurons that captured several different invader or host barcodes. The reduced connection matrix, <italic>S<sub>ij</sub></italic>, therefore, attempts to capture connectivity with single neuron precision. The network represented by matrix <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="244079_inline15.gif"/></alternatives></inline-formula> is shown in <xref ref-type="fig" rid="fig8">Figure 8s</xref>.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8.</label>
<caption><p>Sequencing results can be interpreted as a network of connected barcodes. (<bold>A</bold>) The connectivity matrix between clusters of correlated barcodes that can be interpreted as individual neurons. (<bold>B</bold>) The graph defined by the connection matrix rendered by the force-directed graph drawing algorithm (green&#x003D;invaders, red&#x003D;hosts). The volume of each node represents this node&#x2019;s coordination number.</p></caption>
<graphic xlink:href="244079_fig8.tif"/>
</fig>
<sec id="s4a">
<title>Algorithms for statistical validation of the connectivity matrix</title>
<p>After obtaining connectivity between barcodes we noticed that some invaders had highly similar patterns of connectivity to the hosts, as described above. We have also made a similar observation for the invaders. This phenomenon was interpreted as multiple host or invader barcodes impregnating the same neurons, and, consequently yielding similar connectivity patterns. How similar are the networks rendered from these redundant sets of barcodes? To answer this question, we developed an algorithm that reconstructs connectivity from different non-overlapping sets of barcodes. The purpose of this algorithm is to provide internal cross-validation of individual entries in the connection matrix. If the same entry can be obtained using different sets of barcodes, this connection is likely to exist in reality. It should be noted that the opposite is not true. Our dataset includes many connections that result from a single combination of host-invader barcodes. Such connections are not expected to be replicated in the barcode resampling. Therefore, if a connection cannot be replicated from two non-overlapping sets of barcodes, this connection may still physically exists. Our analysis described here serves to validate but not to invalidate connections.</p>
<p>The details of our algorithm for validation are shown in <xref ref-type="fig" rid="fig9">Figure 9</xref>. We resample the sets of invader and host barcodes in two separate steps of the algorithms 500 times each. This is done to avoid recomputing Pearson correlation matrix (<xref ref-type="fig" rid="fig6">Figure 6</xref>), the longest step of the algorithm. Within each resampling step, we split one barcode set, say invaders, into two non-overlapping random subsets. We use the full invader-to-host connectivity matrix (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) for the subsequent steps. We then repeat the connectivity reconstruction procedure, including obtaining correlation matrix, clustering based on correlation, and computing the cluster-to-cluster connectivity matrix, for both randomly selected non-overlapping subsets of invaders. The simplification that helps streamline the algorithm is that for invader resampling, <italic>host</italic> clusters and invader-invader correlation matrix do not need to be recomputed. We then align invader barcode clusters obtained for both randomly selected sets to the clusters obtained for the full set of barcodes. To this end, for each resampled cluster we find the full set cluster with the higher overlap. This procedure allows us to identify clusters between two randomly selected subsets of barcodes and to compare the resulting connection matrices. After repeating this procedure 500 times for invader and host barcodes we find the fraction of matches, i.e. the fraction of 1000 resamples in which connectivity rendered on the basis of randomly chosen and non-overlapping sets of barcodes is the same. Our procedure cannot generate new connections between existing clusters, therefore, zero connectivity yields no matches. The matrix of matches that we call the Q-matrix is shown in <xref ref-type="fig" rid="fig10">Figure 10</xref>.</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9.</label>
<caption><p>The flowchart of the algorithm used here for internal validation of the data.</p></caption>
<graphic xlink:href="244079_fig9.tif"/>
</fig>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure">
<label>Figure 10.</label>
<caption><p>The results of internal validation. (<bold>A</bold>) The number of matches between reconstructed connectivity matrices obtained from split datasets (Q-value). (<bold>B</bold>) the distribution of non-zero Q-values in (<bold>A</bold>).</p></caption>
<graphic xlink:href="244079_fig10.tif"/>
</fig>
<p>The values of entries in the Q-matrix that we call the Q-values represent the reproducibility of our network when physically different sets of barcodes are used to reconstruct its structure. High Q-values signify connectivity that is highly reproducible. However, low Q-values do not mean an insignificant connection, because we expect that substantial number of connections is produced by single barcodes electroporated into individual neurons.</p>
</sec></sec>
<sec id="s5">
<title>Discussion</title>
<p>Here we have described the first steps of our method BOINC, demonstrating how neural connectivity can be converted into a problem amenable to high-throughput DNA sequencing. We show that (1) DNA barcodes can be introduced into neurons; (2) these barcodes can be moved by PRV to synaptic partners; and (3) barcodes from connected neurons can be joined and sequenced using high-throughput sequencing technologies. We also describe the set of computational algorithms that produces connectivity on the basis of sequencing data. These results lay the groundwork for applying the tremendous potential of DNA sequencing technologies to neural connectivity.</p>
<p>The choice of PRV was motivated by several considerations. PRV has been widely used to trace neuronal circuitry, and so was a good candidate to move genetic barcodes across synapses. Because PRV is a DNA virus, we could exploit phiC31 integrase to join DNA barcodes. Although other viruses including rabies can also move genetic material across synapses (Wickersham et al., 2007), rabies is an RNA virus and thus would have required a means to join RNA barcodes <italic>in vivo</italic> that are not available at this time. Although PRV may not be the ideal candidate for mapping the complete connectome&#x2014;for example, guaranteeing that every neuron expresses PRV would require generating transgenic animals encoding the viral genome&#x2014;PRV is ideally suited to mapping long-range connections, which are particularly challenging for microscopy-based approaches.</p>
<p>It is important to note that connectivity reconstructed by the PRV-based method is difficult to interpret as neuronal connectivity with a single synapse precision. The lack of correspondence between barcode-to-barcode and neuronal connectivity may arise from several factors. First, in this experiment we used a replicating PRV strain (Bartha) capable of mediating polysynaptic barcode movement. Some of the invader barcodes may therefore have passed through more than one synapse before joining with an immobile host barcode. Second, we cannot rule out the viral particles passing via non-synaptic contacts between cells. Although, in the imaging assays, we observe no invaders penetrating into host cells when PRV was added 4 days after cell plating, i.e. before synaptic contacts are formed in vitro, it is impossible to fully rule out non-synaptic barcode transmission in the sequencing-based approach. Third, because barcodes were introduced into neurons through transfection, a method that typically delivers many plasmids to each recipient cell, each neuron may be represented by several nodes in the graph. Although we have developed a computational clustering algorithm that discovers such occurrences, we were not able to independently confirm the accuracy of our computational findings. Because these challenges remain at present unresolved within PRV-based method, the network depicted in <xref ref-type="fig" rid="fig8">Figure 8B</xref> cannot be interpreted as a neural circuit, but must instead be treated as a formal graph describing the interaction of barcodes. It is these considerations that led us to move to a second generation experimental system, synseq (<xref ref-type="bibr" rid="c18">Peikon et al., 2017</xref>).</p>
<fig id="fig11" position="float" orientation="portrait" fig-type="figure">
<label>Figure 11.</label>
<caption><p>The connectivities rendered by force-directed graph drawing algorithm at different levels of Q-values, as indicated. Bottom: The entire connectivity combined with Q-values indicated by the nodes&#x2019; transparency.</p></caption>
<graphic xlink:href="244079_fig11.tif"/>
</fig>
<p>An additional important challenge will be to assess the accuracy of the circuits obtained using sequencing methods. All methods have false positives (i.e. inferred connections that do not exist) and false negatives (actual connections that are missed). The ideal solution would be to compare the circuit obtained using sequencing to a &#x201C;ground truth&#x201D; circuit obtained using other methods. Although the ground truth circuit is available in one case, <italic>C. elegans,</italic> PRV does not appear to propagate in invertebrates. Thus other approaches will need to be developed to validate this approach.</p>
<p>Despite these limitations, we have demonstrated the feasibility of each of the core components needed to convert neural mapping into a form amenable to DNA sequencing. In addition, we have developed a set of computational algorithms that allows to reconstruct connectivity from sequencing data. Our methods yielded a network that is described by a 456-by-786 connectivity matrix between putative neurons (<xref ref-type="fig" rid="fig8">Figure 8</xref>), which is the largest neural network reconstructed so far. This connectivity was obtained at the fraction of the cost and using a fraction of computational effort compared to conventional methods, such as electron microscopy. By encoding the connectivity of neural circuits intro DNA sequence and exploiting high throughput DNA sequencing technology, low cost circuit sequencing could be used as a routine screening method to explore the dynamics of brain circuits in health and disease. This approach could pave the way to uncover the detailed architecture of neural networks and a better understanding of neural circuit function.</p></sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="other"><string-name><surname>Beucher</surname>, <given-names>S.</given-names>,</string-name> and <string-name><surname>Lantu&#x00E9;j</surname>, <given-names>C.</given-names></string-name> (<year>1979</year>). <article-title>Workshop on image processing, real-time edge and motion detection</article-title>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bock</surname>, <given-names>D.D.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>W.-C.A.</given-names></string-name>, <string-name><surname>Kerlin</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Andermann</surname>, <given-names>M.L.</given-names></string-name>, <string-name><surname>Hood</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Wetzel</surname>, <given-names>A.W.</given-names></string-name>, <string-name><surname>Yurgenson</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Soucy</surname>, <given-names>E. R.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>H.S.</given-names>,</string-name> and <string-name><surname>Reid</surname>, <given-names>R.C.</given-names></string-name> (<year>2011</year>). <article-title>Network anatomy and in vivo physiology of visual cortical neurons</article-title>. <source>Nature</source> <volume>471</volume>, <fpage>177</fpage>&#x2013;<lpage>182</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Briggman</surname>, <given-names>K.L.</given-names></string-name>, <string-name><surname>Helmstaedter</surname>, <given-names>M.</given-names>,</string-name> and <string-name><surname>Denk</surname>, <given-names>W.</given-names></string-name> (<year>2011</year>). <article-title>Wiring specificity in the direction-selectivity circuit of the retina</article-title>. <source>Nature</source> <volume>471</volume>, <fpage>183</fpage>&#x2013;<lpage>188</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Card</surname>, <given-names>J.P.</given-names>,</string-name> and <string-name><surname>Enquist</surname>, <given-names>L.W.</given-names></string-name> (<year>2012</year>). <article-title>Use and Visualization of Neuroanatomical Viral Transneuronal Tracers</article-title>. <source>Vis. Tech</source>. <volume>70</volume>, <fpage>225</fpage>&#x2013;<lpage>268</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Card</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Rinaman</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lynn</surname>, <given-names>R.B.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>B.H.</given-names></string-name>, <string-name><surname>Meade</surname>, <given-names>R.P.</given-names></string-name>, <string-name><surname>Miselis</surname>, <given-names>R.R.</given-names>,</string-name> and <string-name><surname>Enquist</surname>, <given-names>L.W.</given-names></string-name> (<year>1993</year>). <article-title>Pseudorabies virus infection of the rat central nervous system: ultrastructural characterization of viral replication, transport, and pathogenesis</article-title>. <source>J. Neurosci</source>. <volume>13</volume>, <fpage>2515</fpage>&#x2013;<lpage>2539</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Chang</surname>, <given-names>D.T.W.</given-names>,</string-name> and <string-name><surname>Reynolds</surname>, <given-names>I.J.</given-names></string-name> (<year>2006</year>). <article-title>Differences in mitochondrial movement and morphology in young and mature primary cortical neurons in culture</article-title>. <source>Neuroscience</source> <volume>141</volume>, <fpage>727</fpage>&#x2013;<lpage>736</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="other"><string-name><surname>Chen</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Y.-C.</given-names></string-name>, <string-name><surname>Church</surname>, <given-names>G.M.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>J.H.</given-names>,</string-name> and <string-name><surname>Zador</surname>, <given-names>A.M.</given-names></string-name> (<year>2017</year>). <article-title>Efficient in situ barcode sequencing using padlock probe-based BaristaSeq</article-title>. <source>Nucleic Acids Res</source>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Dani</surname>, <given-names>V.S.</given-names>,</string-name> and <string-name><surname>Nelson</surname>, <given-names>S.B.</given-names></string-name> (<year>2009</year>). <article-title>Intact long-term potentiation but reduced connectivity between neocortical layer 5 pyramidal neurons in a mouse model of Rett syndrome</article-title>. <source>J. Neurosci</source>. <volume>29</volume>, <fpage>11263</fpage>&#x2013;<lpage>11270</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="other"><string-name><surname>Dixit</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Lu</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Cantrup</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Gruenig</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Langevin</surname>, <given-names>L.M.</given-names></string-name>, <string-name><surname>Kurrasch</surname>, <given-names>D.M.</given-names>,</string-name> and <string-name><surname>Schuurmans</surname>, <given-names>C.</given-names></string-name> (<year>2011</year>). <article-title>Efficient Gene Delivery into Multiple CNS Territories Using In Utero Electroporation</article-title>. <source>J Vis Exp</source> <fpage>e2957</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="other"><string-name><surname>Fraefel</surname>, <given-names>C.</given-names></string-name> (<year>2007</year>). <article-title>Gene delivery using helper virus-free HSV-1 amplicon vectors</article-title>. <source>Curr Protoc Neurosci</source> <italic>Chapter 4</italic>, Unit 4 14.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Fruchterman</surname>, <given-names>T.M.J.</given-names>,</string-name> and <string-name><surname>Reingold</surname>, <given-names>E.M.</given-names></string-name> (<year>1991</year>). <article-title>Graph Drawing by Force-Directed Placement</article-title>. <source>Software-Practice Exp</source>. <volume>21</volume>, <fpage>1129</fpage>&#x2013;<lpage>1164</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Fuchs</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Ehrlich</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Klupp</surname>, <given-names>B.G.</given-names>,</string-name> and <string-name><surname>Mettenleiter</surname>, <given-names>T.C.</given-names></string-name> (<year>2000</year>). <article-title>Characterization of the replication origin (OriS) and adjoining parts of the inverted repeat sequences of the pseudorabies virus genome</article-title>. <source>J. Gen. Virol</source>. <volume>81</volume>, <fpage>1539</fpage>&#x2013;<lpage>1543</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Groth</surname>, <given-names>A.C.</given-names></string-name>, <string-name><surname>Olivares</surname>, <given-names>E.C.</given-names></string-name>, <string-name><surname>Thyagarajan</surname>, <given-names>B.</given-names>,</string-name> and <string-name><surname>Calos</surname>, <given-names>M.P.</given-names></string-name> (<year>2000</year>). <article-title>A phage integrase directs efficient site-specific integration in human cells</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A.</source> <volume>97</volume>, <fpage>5995</fpage>&#x2013;<lpage>6000</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><surname>Hopcroft</surname>, <given-names>J.E.</given-names>,</string-name> and <string-name><surname>Tarjan</surname>, <given-names>R.E.</given-names></string-name> (<year>1971</year>). <article-title>Efficient algorithms for graph manipulation</article-title>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>J.S.</given-names></string-name>, <string-name><surname>Enquist</surname>, <given-names>L.W.</given-names>,</string-name> and <string-name><surname>Card</surname>, <given-names>J.P.</given-names></string-name> (<year>1999</year>). <article-title>Circuit-specific coinfection of neurons in the rat central nervous system with two pseudorabies virus recombinants</article-title>. <source>J Virol</source> <volume>73</volume>, <fpage>9521</fpage>&#x2013;<lpage>9531</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="other"><string-name><surname>Leiserson</surname>, <given-names>C.C.E.</given-names></string-name>, <string-name><surname>Rivest</surname>, <given-names>R.R.L.</given-names></string-name>, <string-name><surname>Stein</surname>, <given-names>C.</given-names>,</string-name> and <string-name><surname>Cormen</surname>, <given-names>T.H.</given-names></string-name> (<year>2009</year>). <source>Introduction to Algorithms</source>, <edition>Third</edition> Edition.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>de Lima</surname>, <given-names>A.D.</given-names></string-name>, <string-name><surname>Merten</surname>, <given-names>M.D.</given-names>,</string-name> and <string-name><surname>Voigt</surname>, <given-names>T.</given-names></string-name> (<year>1997</year>). <article-title>Neuritic differentiation and synaptogenesis in serum-free neuronal cultures of the rat cerebral cortex</article-title>. <source>J. Comp. Neurol</source>. <volume>382</volume>, <fpage>230</fpage>&#x2013;<lpage>246</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Peikon</surname>, <given-names>I.D.</given-names></string-name>, <string-name><surname>Kebschull</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Vagin</surname>, <given-names>V. V.</given-names></string-name>, <string-name><surname>Ravens</surname>, <given-names>D.I.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Y.C.</given-names></string-name>, <string-name><surname>Brouzes</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Corr&#x00EA;a</surname>, <given-names>I.R.</given-names></string-name>, <string-name><surname>Bressan</surname>, <given-names>D.</given-names>,</string-name> and <string-name><surname>Zador</surname>, <given-names>A.M.</given-names></string-name> (<year>2017</year>). <article-title>Using high-throughput barcode sequencing to efficiently map connectomes</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Prieto</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Solera</surname>, <given-names>J.</given-names>,</string-name> and <string-name><surname>Tabar&#x00E9;s</surname>, <given-names>E.</given-names></string-name> (<year>2002</year>). <article-title>Development of new expression vector based on Pseudorabies virus amplicons: application to human insulin expression</article-title>. <source>Virus Res</source>. <volume>89</volume>, <fpage>123</fpage>&#x2013;<lpage>129</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Rinaldi</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Perrodin</surname>, <given-names>C.</given-names>,</string-name> and <string-name><surname>Markram</surname>, <given-names>H.</given-names></string-name> (<year>2008</year>). <article-title>Hyper-connectivity and hyper-plasticity in the medial prefrontal cortex in the valproic Acid animal model of autism</article-title>. <source>Front. Neural Circuits</source> <volume>2</volume>, <fpage>4</fpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Roerdink</surname>, <given-names>J.</given-names>,</string-name> and <string-name><surname>Meijster</surname>, <given-names>a</given-names></string-name> (<year>2000</year>). <article-title>The Watershed Transform: Definitions, Algorithms and Parallelization Strategies</article-title>. <source>Fundam. Informaticae</source> <volume>41</volume>, <fpage>187</fpage>&#x2013;<lpage>228</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="book"><string-name><surname>Saad</surname>, <given-names>Y.</given-names></string-name> (<year>2003</year>). <source>Iterative methods for sparse linear systems</source> (<publisher-loc>Philadelphia</publisher-loc>: <publisher-name>SIAM</publisher-name>).</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Szpara</surname>, <given-names>M.L.</given-names></string-name>, <string-name><surname>Tafuri</surname>, <given-names>Y.R.</given-names></string-name>, <string-name><surname>Parsons</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Shamim</surname>, <given-names>S.R.</given-names></string-name>, <string-name><surname>Verstrepen</surname>, <given-names>K.J.</given-names></string-name>, <string-name><surname>Legendre</surname>, <given-names>M.</given-names>,</string-name> and <string-name><surname>Enquist</surname>, <given-names>L.W.</given-names></string-name> (<year>2011</year>). <article-title>A wide extent of inter-strain diversity in virulent and vaccine strains of alphaherpesviruses</article-title>. <source>PLoS Pathog</source>. <volume>7</volume>, <fpage>e1002282</fpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Testa-Silva</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Loebel</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Giugliano</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>de Kock</surname>, <given-names>C. P.J.</given-names></string-name>, <string-name><surname>Mansvelder</surname>, <given-names>H.D.</given-names>,</string-name> and <string-name><surname>Meredith</surname>, <given-names>R.M.</given-names></string-name> (<year>2012</year>). <article-title>Hyperconnectivity and slow synapses during early development of medial prefrontal cortex in a mouse model for mental retardation and autism</article-title>. <source>Cereb. Cortex</source> <volume>22</volume>, <fpage>1333</fpage>&#x2013;<lpage>1342</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Weiss</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Pin</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Sebben</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kemp</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Sladeczek</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Gabrion</surname>, <given-names>J.</given-names>,</string-name> and <string-name><surname>Bockaert</surname>, <given-names>J.</given-names></string-name> (<year>1986</year>). <article-title>Synaptogenesis of cultured striatal neurons in serum-free medium: a morphological and biochemical study</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>83</volume>, <fpage>2238</fpage>&#x2013;<lpage>2242</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Zador</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Dubnau</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Oyibo</surname>, <given-names>H.K.</given-names></string-name>, <string-name><surname>Zhan</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>G.</given-names>,</string-name> and <string-name><surname>Peikon</surname>, <given-names>I.D.</given-names></string-name> (<year>2012</year>). <article-title>Sequencing the Connectome</article-title>. <source>PLoS Biol</source>. <volume>10</volume>, <fpage>e1001411</fpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>