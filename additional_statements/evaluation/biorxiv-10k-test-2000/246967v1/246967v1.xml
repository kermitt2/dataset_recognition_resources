<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/246967</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Limitation of alignment-free tools in total RNA-seq quantification</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6179-3110</contrib-id>
<name><surname>Wu</surname> <given-names>Douglas C.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Yao</surname> <given-names>Jun</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Ho</surname> <given-names>Kevin S.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Lambowitz</surname> <given-names>Alan M.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Wilke</surname> <given-names>Claus O.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Institute for Cellular and Molecular Biology, University of Texas at Austin</institution>, 78712 Austin, Texas, <country>USA</country>.</aff>
<aff id="a2"><label>2</label><institution>Department of Molecular Biosciences, University of Texas at Austin</institution>, 78712 Austin, Texas, <country>USA</country>.</aff>
<aff id="a3"><label>3</label><institution>Department of Integrative Biology, University of Texas at Austin</institution>, 78712 Austin, Texas, <country>USA</country>.</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Correspondence: <email>wilke@austin.utexas.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>246967</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>11</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>1</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="246967.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<sec><title>Background</title>
<p>Alignment-free RNA quantification tools have significantly increased the speed of RNA-seq analysis. However, it is unclear whether these state-of-the-art RNA-seq analysis pipelines can quantify small RNAs as accurately as they do with long RNAs in the context of total RNA quantification.</p></sec>
<sec><title>Result</title>
<p>We comprehensively tested and compared four RNA-seq pipelines on the accuracies of gene quantification and fold-change estimation on a novel total RNA benchmarking dataset, in which small non-coding RNAs are highly represented along with other long RNAs. The four RNA-seq pipelines were of two commonly-used alignment-free pipelines and two variants of alignment-based pipelines. We found that all pipelines showed high accuracies for quantifying the expressions of long and highly-abundant genes. However, alignment-free pipelines showed systematically poorer performances in quantifying lowly-abundant and small RNAs.</p></sec>
<sec><title>Conclusion</title>
<p>We have shown that alignment-free and traditional alignment-based quantification methods performed similarly for common gene targets, such as protein-coding genes. However, we identified a potential pitfall in analyzing and quantifying lowly-expressed genes and small RNAs with alignment-free pipelines, especially when these small RNAs contain mutations.</p></sec>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>TGIRT-seq</kwd>
<kwd>RNA-seq</kwd>
<kwd>k-mer</kwd>
</kwd-group>
<counts>
<page-count count="28"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Background</title>
<p>RNA-seq continues to pose great computational and statistical challenges. These challenges range from accurately aligning sequencing reads to accurate inference of gene expression levels [<xref rid="c1" ref-type="bibr">1</xref>, <xref rid="c2" ref-type="bibr">2</xref>]. The central computational problem in RNA-seq remains the efficient and accurate assignment of short sequencing reads to the transcripts they originated from and using this information to infer gene expressions [<xref rid="c3" ref-type="bibr">3</xref>&#x2013;<xref rid="c6" ref-type="bibr">6</xref>]. Conventionally, read assignment is carried out by aligning sequencing reads to a reference genome, such that relative gene expressions can be inferred by the alignments at annotated gene loci [<xref rid="c2" ref-type="bibr">2</xref>, <xref rid="c7" ref-type="bibr">7</xref>]. These alignment-based methods are conceptually simple, but the read-alignment step can be time-consuming and computationally intensive despite recent advances in fast read aligners [<xref rid="c4" ref-type="bibr">4</xref>, <xref rid="c8" ref-type="bibr">8</xref>, <xref rid="c9" ref-type="bibr">9</xref>]. Recently, several novel tools introduced alignment-free transcript quantification utilizing k-mer-based counting algorithms [<xref rid="c4" ref-type="bibr">4</xref>&#x2013;<xref rid="c6" ref-type="bibr">6</xref>]. These alignment-free pipelines are orders of magnitude faster than alignment-based pipelines, and they work by breaking sequencing reads into k-mers and then performing fast matches to pre-indexed transcript databases [<xref rid="c4" ref-type="bibr">4</xref>]. To achieve fast transcript quantification without compromising quantification accuracy, different sophisticated algorithms were implemented in addition to k-mer counting, such as pseudoalignments (Kallisto [<xref rid="c5" ref-type="bibr">5</xref>]) or quasi-mapping along with GC and sequence-bias corrections (Salmon [<xref rid="c6" ref-type="bibr">6</xref>]). Given the wide variety of choices in RNA-seq tools, several studies have benchmarked subsets of read aligners and quantification software. These studies generally suggest that most of the current RNA-seq tools are comparably accurate [<xref rid="c10" ref-type="bibr">10</xref>&#x2013;<xref rid="c12" ref-type="bibr">12</xref>].</p>
<p>However, the existing benchmarking studies were generally carried out on either simulated RNA-seq datasets [<xref rid="c12" ref-type="bibr">12</xref>] or RNA-seq datasets that focused only on long RNAs, such as messenger RNAs (mRNAs) and long non-coding RNAs (lncRNAs) [<xref rid="c10" ref-type="bibr">10</xref>, <xref rid="c11" ref-type="bibr">11</xref>, <xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c14" ref-type="bibr">14</xref>]. Consequently, they did not evaluate whether these tools are suitable for total RNA quantification in datasets that include small RNAs, such as transfer RNAs (tRNAs) and small nucleolar RNAs (snoRNAs). To some extent, the lack of a comprehensive comparison between small and long RNA quantification may be due to the inability of most current RNA-seq methods to efficiently recover these small RNAs [<xref rid="c15" ref-type="bibr">15</xref>]. Recently, however, a novel method has overcome this problem by using a thermostable group II intron reverse transcriptase (TGIRT) during RNA-seq library construction [<xref rid="c15" ref-type="bibr">15</xref>]. This method enables more comprehensive profiling of full-length structured small non-coding RNAs (sncRNA) along with long RNAs in a single RNA-seq library workflow [<xref rid="c15" ref-type="bibr">15</xref>&#x2013;<xref rid="c17" ref-type="bibr">17</xref>]. Thus, it is now possible to benchmark RNA-seq quantification tools on structured small non-coding RNAs.</p>
<p>To address whether current RNA-seq tools can quantify small RNAs as accurately as they do with long RNAs, we tested four gene quantification pipelines on a previously sequenced TGIRT RNA-seq (TGIRT-seq) dataset [<xref rid="c15" ref-type="bibr">15</xref>] obtained from the well-studied microarray/sequencing quality control consortium (MAQC) sample set [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c19" ref-type="bibr">19</xref>]. Of the four tested pipelines, two are alignment-based and two are alignment-free. We found that all four pipelines are mostly concordant in quantifying common differentially-expressed gene targets, such as mRNAs and mRNA-like spike-ins. However, with respect to quantifying small or lowly-expressed genes, we found that the alignment-based pipelines significantly outperformed the alignment-free pipelines.</p>
</sec>
<sec id="s2"><title>Results</title>
<sec id="s2a"><title>Study design</title>
<p>We tested four RNA-seq quantification pipelines, including two alignment-free and two alignment-based pipelines (<xref rid="fig1" ref-type="fig">Fig. 1</xref>): (A) Kallisto, a k-mer counting software that uses pseudoalignments for reducing quantification error and improving speed [<xref rid="c5" ref-type="bibr">5</xref>]; (B) Salmon, another k-mer counting software that learns and corrects sequence-specific and GC biases on-the-fly, in addition to using quasi-mapping for further improvement in transcript quantification [<xref rid="c6" ref-type="bibr">6</xref>]; (C) HISAT2&#x002B;featureCounts, a conventional alignment-based pipeline aligning sequencing reads to human genome by a splice-aware aligner, HISAT2 [<xref rid="c9" ref-type="bibr">9</xref>], and quantifying genes by featureCounts [<xref rid="c3" ref-type="bibr">3</xref>]; and (D) TGIRT-map, a customized alignment-based pipeline using an iterative genome-mapping procedure (<xref rid="figS1" ref-type="fig">Additional File 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1</label>
<caption><title>Analysis pipelines and experimental design.</title> <p>We used two pipelines each for the alignment-based and alignment-free approach. The alignment-based pipelines consisted of (A) a HISAT2&#x002B;featureCounts pipeline using HISAT2 [9] for aligning reads to the human genome and using featureCounts [3] for gene counting, and (B) TGIRT-map, a customized pipeline for analyzing TGIRT-seq data. Further details regarding the custom TGIRT-map pipeline are provided in Methods and in <xref rid="figS1" ref-type="fig">Additional File 1</xref>. Two alignment-free tools, Kallisto [5] and Salmon [6], were used for quantifying transcripts. For alignment-free tools, gene-level abundances were summarized by T&#x00D7;import [35]. All differentially-expressed gene callings were done by DESeq2 [34].</p></caption>
<graphic xlink:href="246967_fig1.tif"/>
</fig>
<p>The benchmarking dataset we used here consists of TGIRT-seq libraries for four well-defined samples (samples A-D) from the microarray/sequencing quality control consortium (MAQC [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c19" ref-type="bibr">19</xref>]), each obtained in triplicate [<xref rid="c15" ref-type="bibr">15</xref>]. The MAQC samples A and B represent universal human reference total RNA and human brain reference total RNA, respectively, that are mixed with corresponding External RNA Controls Consortium (ERCC) spike-in transcripts. Samples C and D are mixtures of samples A and B at different ratios [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c19" ref-type="bibr">19</xref>]. This known mix ratios in samples C and D allow for the calculation of expected fold-changes between samples C and D from the measured fold-changes between samples A and B for each gene [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c19" ref-type="bibr">19</xref>]. Mapping statistics of all pipelines are summarized in Additional File 2 Supplementary Tables S1-4.</p></sec>
<sec id="s2b"><title>Gene detection and quantification</title>
<p>To test if all four pipelines produced concordant gene quantifications, we rst compared the numbers of detected genes across all methods. We considered a gene as detected if it was assigned with a transcripts per million (TPM) value &#x003E; 0.1. We found that the numbers of detected genes were similar among all tested pipelines (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>). Moreover, by comparing the identities of the detected genes, we found that the vast majority of the genes were detected by all tested pipelines (<xref rid="figS2" ref-type="fig">Additional File 3</xref>). However, we also found that Salmon and TGIRT-map consistently detected more genes compared to the other two pipelines (Friedman test, <italic>p</italic> = 4&#x00D7;10<sup>&#x2212;7</sup>; Paired Wilcoxon test, <italic>p</italic> = 0.57 for Salmon vs TGIRT-map, <italic>p</italic> = 5&#x00D7;10<sup>&#x2212;4</sup> for other pipeline comparisons).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2</label>
<caption><title>Gene detection and quantification.</title> <p>(a) Numbers and types of detected genes in every sample and pipeline. Genes with TPM &#x003E; 0.1 were labeled as being detected. The stacked bar charts indicate the numbers of genes detected by each pipeline. The bar charts are grouped by library (A1&#x2013;D3), where A&#x2013;D represent the RNA samples and the numbers represent replicate identi ers. The stacked-bars are color-coded by RNA type. (b) ERCC spike-in quantifications versus the true spike-in abundances. Log2 transcripts per million (TPM) values for every ERCC transcript from every replicate are plotted against the known spike-in concentrations, grouped by pipelines and samples. Blue lines indicate least-square regression lines. Coefficients of determination are annotated in each panel.</p></caption>
<graphic xlink:href="246967_fig2.tif"/>
</fig>
<p>Even though Salmon and TGIRT-map both detected more genes than did the other two pipelines, the additional genes detected were different. Salmon primarily recovered more long RNAs (labeled as antisense, other ncRNAs, and protein-coding genes; <xref rid="figS2" ref-type="fig">Additional File 3</xref>). This enrichment in long RNAs could be pipeline-type-specific (when compared to alignment-based pipelines) or algorithm-specific (when compared to Kallisto). Pipeline-type-specific differences could be due to the probabilistic gene quantification methods of Salmon [<xref rid="c6" ref-type="bibr">6</xref>]. While Salmon can assign fragments to multiple genes, each fragment can only be assigned to a single gene by the alignment-based pipelines under our parameters. In terms of algorithm, the result might be due to how Salmon corrects for GC and sequencing biases or how it handles equivalent classes (i.e. multiply-mapped reads) relative to Kallisto [<xref rid="c6" ref-type="bibr">6</xref>]. On the other hand, TGIRT-map recovered more miRNAs (likely to be mis-counting of fragmented exons or unannotated exons in these libraries), some long non-coding RNAs (annotated as other ncRNAs), and small non-coding RNAs (annotated as other sncRNA) (<xref rid="figS2" ref-type="fig">Additional File 3</xref>). These enrichments under TGIRT-map could be pipeline-type-specific when compared to alignment-free pipelines, which may be affected by the choice of k-mer size. The differences between TGIRT-map and HISAT2&#x002B;featureCounts were possibly the result of an additional alignment step (BOWTIE2) [<xref rid="c20" ref-type="bibr">20</xref>] after the spliced-read mapping step (HISAT2) [<xref rid="c9" ref-type="bibr">9</xref>] in TGIRT-map (<xref rid="figS1" ref-type="fig">Additional File 1</xref>).</p>
<p>To evaluate if gene expression level estimates were concordant among the tested pipelines, we made pairwise comparisons of these estimates between pipelines (<xref rid="figS3" ref-type="fig">Additional File 4</xref>). The gene expression level estimates were generally highly correlated, with Pearson&#x2019;s correlations ranging from 0.67-0.99 (<xref rid="figS3" ref-type="fig">Additional File 4</xref>). The Pearson&#x2019;s correlation coefficients were consistently very high for pairwise comparisons between alignment-free pipelines (Kallisto vs Salmon; 0.98-0.99) or between alignment-based pipelines (HISAT2&#x002B;featureCounts vs TGIRT-map; 0.94-0.95). By contrast, any pairwise correlation between an alignment-free tool and an alignment-based pipeline was generally lower (0.67-0.72; <xref rid="figS3" ref-type="fig">Additional File 4</xref>).</p>
<p>Further analyses revealed that different gene types showed distinct variations in gene expression level correlations for every pairwise pipeline comparison (<xref rid="figS3" ref-type="fig">Additional File 4</xref>). For instance, ERCC spike-ins, <italic>in vitro</italic> transcripts that mimic protein-coding transcripts, were recovered with very high correlations for all pairwise pipeline comparisons (Pearson&#x2019;s correlations: 0.99-1; <xref rid="figS3" ref-type="fig">Additional File 4</xref>). In comparison to the true abundances that were spiked into the RNA samples [<xref rid="c15" ref-type="bibr">15</xref>], the relative expression levels of these ERCC spike-ins were estimated as they were designed and tightly correlated to their true concentrations. We observed a near-perfect linear relationship between inferred TPM values and true concentrations (both log-transformed) for all pipelines (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>; <italic>R</italic><sup>2</sup> &#x003E; 0.94 for every sample and pipeline; Kruskal-Wallis-test <italic>p</italic> = 0.346). By contrast to ERCC transcripts, the gene expression level estimates of other common gene targets (antisense, protein-coding genes, etc.) were not as highly correlated among tested pipelines (<xref rid="figS3" ref-type="fig">Additional File 4</xref>). To identify the source of this discrepancy, we divided genes into quantile groups of gene lengths or gene expression levels, and found that the abundance estimation inconsistencies among pipelines were largely caused by short gene lengths and low expression levels (<xref rid="figS4" ref-type="fig">Additional File 5</xref>), as suggested previously [<xref rid="c13" ref-type="bibr">13</xref>].</p></sec>
<sec id="s2c"><title>Differential expression measurements of long genes</title>
<p>The most popular application of RNA-seq is the detection of differentially-expressed genes. To compare the accuracy of differential expression inferences among each pipeline, we plotted the deviation of measured log2 fold-changes to the expected log2 fold-changes between samples A and B for every ERCC spike-in transcript (<xref rid="fig3" ref-type="fig">Fig 3a</xref>; 23 ERCC transcripts in each expected differentially-expressed group). For all pipelines, fold-changes between samples A and B were mostly underestimated (negative &#x0394;log2 fold-changes; <xref rid="fig3" ref-type="fig">Fig. 3a</xref>). To quantify the accuracies of fold-change detections for each method, we computed root mean square errors (RMSE) for each ERCC group (Additional File 2). Comparisons of the RMSE values for each ERCC group among pipelines indicated that alignment-free pipelines had comparable performances to alignment-based pipelines in estimating differential expression of ERCC spike-ins (Friedman-test <italic>p</italic> = 0.016; two-sided paired Wilcoxon-test <italic>p</italic> &#x003E; 0.1 for all pairwise comparisons).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure"><label>Figure 3</label>
<caption><title>Differential expression analysis of ERCC spike-ins.</title> <p>(a) Violin-plots of deviations between measured and expected log2 fold-changes of ERCC transcript between samples A and B. The distributions of log2 fold-change errors for each ERCC transcript are grouped by their expected differentially-expressed groups and are color-coded by the tested pipelines. The horizontal dashed line indicates no error. (b) Receiver operating characteristic curves for calling ERCC spike-ins as differentially-expressed. Areas under the curve were computed using p-values assigned by the differential expression caller (DESeq2 [34]) on abundance estimations of each ERCC transcript from each pipeline.</p></caption>
<graphic xlink:href="246967_fig3.tif"/>
</fig>
<p>To test whether the four pipelines provided reliable gene expression level estimates for calling differentially-expressed genes, we plotted the receiver operating characteristic (ROC) curves for the prediction of ERCC spike-in transcripts differentially-expressed status. For every pipeline, we used the <italic>p</italic>-values assigned to the differential expression tests for binary prediction cutoffs and the known spike-in concentrations for assigning true differential-expression status (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>). By design, there are 23 spike-ins with same concentrations and 69 spike-ins with different concentrations between samples A and B [<xref rid="c21" ref-type="bibr">21</xref>]. Using area under the curves (AUC) of the ROC curves, we found that alignment-free tools (Kallisto and Salmon) performed slightly better than alignment-based pipelines in accurately calling differentially-expressed spike-in transcripts (AUC: 0.65, 0.65, 0.71, and 0.68 for HISAT2&#x002B;featureCounts, TGIRT-map, Kallisto, and Salmon respectively; one non-differentially-expressed and two differentially-expressed ERCC spike-ins had TPM = 0 in all pipelines). In addition to analyzing <italic>in vitro</italic> ERCC transcripts, we also verified that all pipelines performed nearly identically in terms of quantifying <italic>in vivo</italic> transcripts, by comparing estimated expression levels to TaqMan qRT-PCR results published previously (<xref rid="figS5" ref-type="fig">Additional File 6</xref>).</p></sec>
<sec id="s2d"><title>Whole transcriptome differential expression analysis</title>
<p>To benchmark the suitability of different gene quantification pipelines for differential expression analysis of all RNA types, we used the known sample mix ratios and the fold-change measurements between samples A and B to construct the expected fold-changes between samples C and D for every gene [<xref rid="c18" ref-type="bibr">18</xref>]. By comparing the measured to the expected fold-changes between samples C and D, we found that both alignment-based pipelines showed superior performances over alignment-free pipelines (<italic>R</italic><sup>2</sup> = 0.62, 0.61, 0.46, and 0.42 for HISAT2&#x002B;featureCounts, TGIRT-map, Kallisto, and Salmon, respectively; <xref rid="fig4" ref-type="fig">Fig. 4a</xref>). Further analyses showed that low correlations between measured and expected fold-changes were due to lowly-expressed genes (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>), as suggested previously [<xref rid="c15" ref-type="bibr">15</xref>, <xref rid="c19" ref-type="bibr">19</xref>]. However, to our surprise, Kallisto and Salmon had exceptionally poor ts to the corresponding models for these lowly-expressed genes (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>; <italic>R</italic><sup>2</sup> = 0.44, 0.41, 0.13, and 0.06 for the lowest 75&#x0025; expressed genes from HISAT2&#x002B;featureCounts, TGIRT-map, Kallisto, and Salmon, respectively).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure"><label>Figure 4</label>
<caption><title><italic>R</italic><sup>2</sup> of measured versus expected log2 fold-changes between samples C and D.</title> <p>(a) Gene expression level influenced accuracies of fold-change estimation. <italic>R</italic><sup>2</sup> values were computed from the expected and measured log2 fold-change values between samples C and D for each pipeline using different gene sets grouped by average gene expression levels. The first gene set, labeled &#x201C;Total RNA&#x201D;, includes all genes. The subsequent gene sets include only the genes with the top 1&#x0025;, top 10&#x0025;, top 25&#x0025;, or bottom 75&#x0025; expression levels, as indicated. Bars are color-coded by pipelines. (b) Gene lengths inuenced accuracies of fold-change estimation. Genes from each pipeline were grouped by their gene lengths into four quantile groups. For each quantile group, <italic>R</italic><sup>2</sup> values were computed from the expected and measured log2 fold-change values between samples C and D. Bars are color-coded by pipelines. Coefficients of determination (R<sup>2</sup>) were computed by R2 function from <italic>R</italic> caret package [<xref rid="c36" ref-type="bibr">36</xref>]. Negative <italic>R</italic><sup>2</sup> values indicate exceptionally bad fold-change predictions [<xref rid="c22" ref-type="bibr">22</xref>] from the software as illustrated in <xref rid="figS6" ref-type="fig">Additional File 7</xref>, where the fold-change output do not fit well to the samples mix-ratio.</p></caption>
<graphic xlink:href="246967_fig4.tif"/>
</fig>
<p>In addition to lowly-expressed genes, we also found that short gene lengths greatly decreased the accuracies in fold-change analyses, particularly for alignment-free pipelines (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>; <italic>R</italic><sup>2</sup> = 0.02, 0.05, &#x2013;0.45, and &#x2013;0.44 for the shortest 25&#x0025; genes from HISAT2&#x002B;featureCounts, TGIRT-map, Kallisto, and Salmon, respectively). As we are testing whether the measured (observed) fold-changes fit into the expected fold-changes (model) constructed by the fold-changes between samples A and B and the known mix-ratios of samples A and B in samples C and D, <italic>R</italic><sup>2</sup> values served as a metric in quantifying the measurement errors relative to the known model. Thus, a negative <italic>R</italic><sup>2</sup> indicates highly discordant measurements relative to the expected fold-changes predicted by the known mix-ratios and the measured fold-changes between samples A and B [<xref rid="c22" ref-type="bibr">22</xref>], as illustrated in <xref rid="figS6" ref-type="fig">Additional File 7</xref>. These discordant measurements reect the incapabilities of the quantification tools in making accurate fold-change predictions either between samples A and B or between samples C and D for small genes.</p>
<p>To evaluate whether the deficiency in small genes quantification was specific to certain gene types, we computed the root mean square errors (RMSE) for the expected versus measured log2 fold-changes between samples C and D for genes grouped by their gene types. Consistent with the gene quantification results, Salmon and Kallisto showed slightly better fold-change estimation performances on ERCC spike-ins while alignment-based pipelines showed slightly better fold-change estimations on protein-coding genes (<xref rid="fig5" ref-type="fig">Fig. 5a</xref> and <xref rid="tbl1" ref-type="table">Table 1</xref>). Furthermore, alignment-based and alignment-free pipelines produced similar results for the majority of small RNA types, such as snoRNAs. For snoRNAs and other small non-coding RNAs (labeled as other sncRNA), Salmon and TGIRT-map recovered more genes than did HISAT2&#x002B;featureCounts and Kallisto, but Salmon and TGIRT-map also showed similar RMSE values that were comparable to the RMSE values from HISAT2&#x002B;featureCounts and Kallisto (<xref rid="fig5" ref-type="fig">Fig. 5a</xref> and <xref rid="tbl1" ref-type="table">Table 1</xref>). However, for tRNAs, alignment-based pipelines detected higher numbers of tRNA isoacceptors compared to alignment-free pipelines and showed advantages in detecting differential tRNA expression, yielding lower RMSE values (<xref rid="fig5" ref-type="fig">Fig 5b</xref> and <xref rid="tbl1" ref-type="table">Table 1</xref>).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure"><label>Figure 5</label>
<caption><title>Pipeline performances of differential expression measurements for different gene types.</title> <p>(a) Root mean square error (RMSE) values between measured and expected log2 fold-change values for each gene type. Bars indicate RMSE values for different gene types from each pipeline and are color-coded by pipelines. (b) Cumulative absolute errors in tRNA log2 fold-change predictions. tRNAs (x-axis) were ordered ascendingly by the absolute errors in log2 fold-change predictions for each pipeline. Cumulative absolute errors for all detected tRNAs are plotted. Lines are color-coded by pipelines.</p></caption>
<graphic xlink:href="246967_fig5.tif"/>
</fig>
<table-wrap id="tbl1" position="float" orientation="portrait"><label>Table 1</label>
<caption><p>RMSE values in differential expression measurements. Numbers of detected genes are shown in parentheses. RNA-type annotations were generated from Ensembl [<xref rid="c28" ref-type="bibr">28</xref>]. &#x201C;Other ncRNA&#x201D; represents the following RNA types: sense_intronic, 3prime_overlapping_ncRNA, processed_transcript, sense_overlapping, lincRNA, and all pseudogenes. "Other sncRNA" represents the following RNA types: misc_RNA, snRNA, scaRNA, sRNA, scRNA. Mt represents all mitochondrial genes, including mitochondrial-encoded tRNAs. vaultRNA represents any Ensembl gene names with Vault or VTRNA.</p></caption>
<graphic xlink:href="246967_tbl1.tif"/>
</table-wrap>
<p>As we showed distinct performances in tRNA fold-change analysis between alignment-free and alignment-based pipelines and a performance decrease in small gene quantification for alignment-free pipelines, we anticipated the comparison in tRNA fold-change predictions among the different pipelines would give us insights into the deficiency of alignment-free pipelines in small gene quantification. We hypothesized that the deficiency of alignment-free pipelines in small gene quantification was possibly due to the choice of a long k-mer size (31-mer) relative to the sizes of the small RNA transcripts, such as 75 nt for tRNAs. To investigate whether the choice of k-mer size had any effect on small RNA quantifications, we tested Salmon with four different k-mer sizes, ranging from 11 to 31 (11, 15, 21, and 31; default is 31 for both Salmon and Kallisto). We found that at <italic>k</italic> = 21, higher <italic>R</italic><sup>2</sup> values were observed for total RNA (<xref rid="figS7" ref-type="fig">Additional Files 8</xref>). Using tRNA as a model for comparisons in small gene quantifications, we also found a performance improvement (detected higher number of tRNA and lower RMSE) using <italic>k</italic> = 21. However, Salmon with this k-mer size still yielded two-fold higher RMSE relative to TGIRT-map for tRNA fold-change prediction (Additional Files 2 and <xref rid="figS7" ref-type="fig">8</xref>).</p>
<p>To gain better understanding to the problem of small gene quantification in alignment-free pipelines, we further inspected the tRNAs that were undetected by both Salmon and Kallisto. Using TGIRT-map alignment results, we found that the read alignments mapped to these tRNAs displayed a high abundance of non-reference bases (<xref rid="figS8" ref-type="fig">Additional File 9</xref>). These non-reference bases may be caused by post-transcriptionally modified RNA bases that could introduce reverse-transcription errors by changing base-pairing interfaces [<xref rid="c23" ref-type="bibr">23</xref>, <xref rid="c24" ref-type="bibr">24</xref>], as it is known that tRNAs are post-transcriptionally-modified and have abundant base modifications [<xref rid="c15" ref-type="bibr">15</xref>, <xref rid="c17" ref-type="bibr">17</xref>, <xref rid="c25" ref-type="bibr">25</xref>]. Thus, we predict that these abundant non-reference bases in small RNAs, tRNA in this case, may have prevented k-mer-based algorithms from successfully counting these reads.</p>
</sec></sec>
<sec id="s3"><title>Discussion</title>
<p>We have performed an in-depth comparison among four RNA-seq pipelines, including two alignment-based and two alignment-free pipelines, to determine the relative performance of these tools for simultaneous quantification of long and small RNAs. The two alignment-based pipelines that we have tested were a widely-adopted align-and-count pipeline (HISAT2&#x002B;featureCounts) [<xref rid="c3" ref-type="bibr">3</xref>, <xref rid="c9" ref-type="bibr">9</xref>] and a custom gene-counting procedure with multi-step iterative alignments (TGIRT-map; <xref rid="figS1" ref-type="fig">Additional File 1</xref>); the two tested alignment-free pipelines were k-mer counting tools with and without bias corrections (Salmon [<xref rid="c6" ref-type="bibr">6</xref>] and Kallisto [<xref rid="c5" ref-type="bibr">5</xref>]). We have tested these four pipelines on quantification of both long and small RNAs in a novel benchmarking dataset generated by a thermostable group II intron reverse transcriptase (TGIRT) [<xref rid="c15" ref-type="bibr">15</xref>]. This dataset is unique in that small non-coding RNAs are highly represented, while the quality of long RNA quantification is comparable to that of other widely-adopted RNA-seq methods [<xref rid="c15" ref-type="bibr">15</xref>]. Using this dataset, we have found that while all four pipelines perform similarly on long and highly abundant RNAs, alignment-free tools have clear limitations for small and lowly-expressed RNA quantification.</p>
<p>For long gene quantification, we have found that all four pipelines quantify common gene targets (e.g. ERCC spike-ins and protein-coding genes) with similar results, confirming a previously benchmark study on poly-A selected RNA-seq [<xref rid="c13" ref-type="bibr">13</xref>]. Generally, gene quantification tends to be more similar between pipelines of the same type (i.e., HISAT2&#x002B;featureCounts and TGIRT-map, or Kallisto and Salmon) than pipelines of the other type (alignment-based versus alignment-free). This result further supports a previous finding which showed more similar transcript iso-forms quantifications were found among alignment-free or among alignment-based pipelines than among pipelines of the different types [<xref rid="c14" ref-type="bibr">14</xref>], suggesting that alignment-based pipelines may have somewhat different quantification biases than do the probabilistic models of alignment-free pipelines. Regardless of the different in gene quantifications, our results on differentially-expressed gene detections for long genes have supported that all four pipelines performed comparably for ERCC spike-ins and protein-coding genes when compared to their expected fold-changes (ERCC spike-ins) [<xref rid="c21" ref-type="bibr">21</xref>] or MAQC TaqMan assay measurements (protein-coding genes) [<xref rid="c18" ref-type="bibr">18</xref>]. This result further confirmed previous benchmark studies where alignment-free and alignment-based tools gave similar results differentially-expressed gene detection [<xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c14" ref-type="bibr">14</xref>].</p>
<p>For total gene quantification and differential expression analysis, all tested pipelines generally have performed similarly, with most disagreements occurring between pipeline comparisons of different pipeline types (i.e. an alignment-based pipeline vs an alignment-free pipeline). In the analyses of genes that were inconsistently quantified among pipelines, our results have confirmed that both high gene expression and long gene length were crucial to consistent abundance estimation, as suggested previously [<xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c26" ref-type="bibr">26</xref>]. Using fold-change analyses for comparisons in quan-tification accuracies, we have found that alignment-based tools were more accurate in quantifying lowly-expressed or small genes. This result likely reflects the nature of probabilistic assignments of k-mers and the inferences of TPM values. Although we have found that alignment-free pipelines were unreliable for quantifying extremely small RNAs (with shorter gene lengths) in total transcriptome analysis, alignment-free tools have performed comparably to alignment-based tools for most of the small RNA types, such as snoRNAs or other sncRNAs, in differential expression analyses. This disagreement between small non-coding RNAs and small mRNAs is possibly due to their differences in secondary structures and their different sensitivities to RNA fragmentations prior to RNA-seq library constructions, which over-fragmented mRNA fragments may be dropped-out from alignment-free quantifications.</p>
<p>Even though we have found that all pipelines perform similarly on the majority of small non-coding RNAs, our results have revealed that pipelines involving genome-alignment steps were superior to alignment-free tools in quantifying tRNAs speci-fically. We initially hypothesized the differences in performance were due to the choice of k-mer size in alignment-free pipelines and we have found an improvement in small gene quantifications when a moderately smaller <italic>k</italic> was chosen (<italic>k</italic> = 21). However, we have also found that the performance of alignment-free quantification at this optimal <italic>k</italic> was still not comparable to alignment-based pipelines for small genes. Using tRNA as a model, our results have suggested that this performance difference was likely due to a combinatorial effect of the choice of k-mer size and misincorporations introduced by post-transcriptionally-modified RNA bases during reverse transcriptions. We reason that a relatively long k-mer and erroneous sequencing reads likely impede matching to the indexed transcriptome even when these sequencing reads are shredded into k-mers since all k-mers inherit the same errors/mismatches. Since mismatches on sequencing reads can either be reverse transcription errors or biological variations on small RNAs [<xref rid="c27" ref-type="bibr">27</xref>], we expect the same phenomenon may occur if the small RNAs contain single-nucleotide polymorphisms or mutations.</p>
</sec>
<sec id="s4"><title>Conclusions</title>
<p>In summary, we have shown that different types of pipelines performed similarly for common differentially-expressed gene targets such as protein-coding genes. However, accurate quantification of lowly-expressed or small RNA is difficult to achieve with alignment-free pipelines. Using tRNA as a model, we have also found that k-mer counting algorithms are not compatible for quantifying small genes with abundant mutations regardless of the choice of k-mer size.</p>
</sec></body>
<back>
<glossary><title>Abbreviations</title>
<def-list>
<def-item>
<term>TGIRT</term><def><p>Thermostable group II intron reverse transcriptase</p></def></def-item><def-item>
<term>MAQC</term><def><p>microarray quality control consortium</p></def></def-item><def-item>
<term>ERCC</term><def><p>External RNA controls consortium</p></def></def-item><def-item>
<term>RMSE</term><def><p>root mean square error</p></def></def-item><def-item>
<term>ROC</term><def><p>receiver operating characteristic</p></def></def-item><def-item>
<term>AUC</term><def><p>area under the curve</p></def></def-item><def-item>
<term>TPM</term><def><p>transcripts per million</p></def></def-item></def-list></glossary>
<sec><title>Methods</title>
<sec><title>Data and reference preparation</title>
<p>Raw sequencing reads for TGIRT-seq data generated from the well-studied MAQC samples were downloaded from the NCBI Sequence Read Archive, accession number SRP066009 [<xref rid="c15" ref-type="bibr">15</xref>]. In brief, this dataset includes triplicates of four different human total RNA samples (called A{D) spiked with External RNA Control Consortium (ERCC) transcripts. ERCC spike-in transcripts are 92 <italic>in</italic> vitro transcripts with 250-2000-nt long [<xref rid="c21" ref-type="bibr">21</xref>]. Two ERCC spike-in mixes (mixes 1 and 2) with different concentrations for each transcript were spiked into RNA samples A (universal human RNA) and B (human total brain RNA), respectively, to provide known fold-changes of these spike-in transcripts between these two samples [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c21" ref-type="bibr">21</xref>]. By design, these two spike-in mixes establish four different differentially-expressed gene groups with relative ratios of 0.67:1, 1:1, 1:2, and 1:4 between samples A and B. Samples C and D are mixes of samples A and B in ratios of 3:1 and 1:3, respectively. For detailed library preparations, please refer to Nottingham, <italic>et al</italic> [<xref rid="c15" ref-type="bibr">15</xref>].</p>
<p>Human transcriptome reference sequences were obtained from Ensembl (human genome build version GRCh38.87) by downloading cDNA and non-coding RNA sequence FASTA les [<xref rid="c28" ref-type="bibr">28</xref>]. ERCC spike-in sequences were downloaded from the vendor&#x2019;s website (ThermoFisher). Transfer RNA (tRNA) annotations and sequences were downloaded from the Genomic tRNA Database [<xref rid="c29" ref-type="bibr">29</xref>]. For tRNA sequences, introns were removed, and all sequences were de-duplicated at the sequence level to reduce multiply-mapped reads and improve tRNA counting. 5S rDNA (Gen-Bank accession: X12811.1) and complete rDNA repeat unit (GenBank accession: U13369.1) sequences were downloaded from GenBank (NCBI). These sequences were merged and indexed with Kallisto v0.43.0 [<xref rid="c5" ref-type="bibr">5</xref>] and Salmon v0.8.2 [<xref rid="c6" ref-type="bibr">6</xref>] using the default k-mer size (<italic>k</italic> = 31). Human genome sequences and annotations were downloaded as FASTA and GTF files from Ensembl (human genome build version GRCh38.88) [<xref rid="c28" ref-type="bibr">28</xref>], combined with ERCC spike-in sequences and rDNA sequences, and indexed by HISAT2 v2.0.4 [<xref rid="c9" ref-type="bibr">9</xref>]. A HISAT2 splice-site file was created using the human genome build GRCh38.88 GTF file [<xref rid="c9" ref-type="bibr">9</xref>]. Gene annotations were obtained as a BED file using Ensembl biomaRt package in R [<xref rid="c30" ref-type="bibr">30</xref>, <xref rid="c31" ref-type="bibr">31</xref>] from Genome build version GRCh38.87 [<xref rid="c28" ref-type="bibr">28</xref>]. The gene annotation BED file was merged with tRNA, ERCC spike-in, and rDNA annotations for gene counting. The merged gene BED file was converted to a featureCounts SAF file [<xref rid="c3" ref-type="bibr">3</xref>] using the UNIX awk command.</p></sec>
<sec><title>Adaptor trimmings</title>
<p>Raw reads were adapter- and quality-trimmed by cutadapt v1.13 [<xref rid="c32" ref-type="bibr">32</xref>] via:
<preformat>
cutadapt -m 15 -O 5 -n 3 -q 20 \
     -b AAGATCGGAAGAGCACACGTCTGAACTCCAGTCAC \
     -B GATCGTCGGACTGTAGAACTCTGAACGTGTAGA \
     -o &#x0024;{TRIMMED_FQ1}-p &#x0024;{TRIMMED_FQ2}\
     &#x0024;{FQ1} &#x0024;{FQ2}</preformat></p></sec>
<sec><title>HISAT2 mapping</title>
<p>Reads were aligned to the genome using HISAT2 v2.0.4 [<xref rid="c9" ref-type="bibr">9</xref>] via:
<preformat>
hisat2 -k 10 &#x2010;&#x2010;no-mixed -no-discordant \
   &#x2010;&#x2010;known-splicesite-infile={SPLICESITE_FILE} \
   -1 &#x0024;{TRIMMED_FQ1} -2 &#x0024;{TRIMMED_FQ2}</preformat></p></sec>
<sec><title>HISAT2&#x002B;featureCounts</title>
<p>Trimmed reads were aligned using HISAT2 mapping. Gene counts from HISAT2 mapping were generated by featureCounts v1.5.0 [<xref rid="c3" ref-type="bibr">3</xref>] via:
<preformat>
featureCounts -F SAF -O -s 1 -M -T 24 \
       &#x2010;&#x2010;largestOverlap &#x2010;&#x2010;minOverlap 10 \
       &#x2010;&#x2010;primary -p -P -d 10 -D 10000 -B \
       -S fr -C -donotsort \
       &#x0024;{LIST_OF_BAM_FILES}</preformat></p></sec>
<sec><title>TGIRT-map</title>
<p>Our custom pipleine TGIRT-map first filters out all trimmed reads that can be aligned to tRNA or rRNA references to reduce multiply-mapped reads (<xref rid="figS1" ref-type="fig">Additional File 1</xref>). The remaining unaligned reads are then sequentially aligned to the human genome using a splice-aware aligner (HISAT2) [<xref rid="c9" ref-type="bibr">9</xref>] and a sensitive local aligner (BOWTIE2) [<xref rid="c20" ref-type="bibr">20</xref>]. A single alignment locus is picked from the multiply-mapped fragments by asserting the assumptions that (A) RNA-seq fragments are small (smallest insert size), (B) ribosomal genes are abundant in the genome (ribo-somal gene loci), and (C) fragments are unlikely to be originated from haplotype or patch sequences (as defined by Ensembl annotations) of the artificially assembled genome. Finally, gene quantification is done on genomic loci, except for tRNA and rRNA which require an additional step of re-aligning and counting.</p>
<p>Trimmed reads were first aligned to rRNA (GenBank accession numbers: X12811.1 and U13369.1) and tRNA sequences with BOWTIE2 v2.3.2 [<xref rid="c20" ref-type="bibr">20</xref>] via:
<preformat>
bowtie2 -D 20 -R 3 -N 0 \
        -L 8 -i S,1,0.50 &#x2010;&#x2010;no-mixed \
        &#x2010;&#x2010;norc &#x2010;&#x2010;no-discordant \
        -1 &#x0024;{TRIMMED_FQ1} -2 &#x0024;{TRIMMED_FQ2}</preformat></p>
<p>We define the mapped reads as tRNA and rRNA pre-mapped reads. Unmapped reads were then aligned to the genome with HISAT2 as described above in HISAT2 mapping [<xref rid="c9" ref-type="bibr">9</xref>]. Unaligned reads from HISAT2 mapping were then rescued by realigning locally to the genome with BOWTIE2 [<xref rid="c20" ref-type="bibr">20</xref>] via:
<preformat>
bowtie2 -D 20 -R 3 -N 0 -L 8 \
     -i S,1,0.50 -p 24 -k 10 \
     &#x2010;&#x2010;no-mixed &#x2010;&#x2010;no-discordant \
     -1 &#x0024;{FQ1} -2 &#x0024;{FQ2}</preformat></p>
<p>All alignment pairs with &#x003E; 10 nucleotides of soft-clipped bases on either reads or were discordant pairs were discarded. Multiply-mapped reads from the two genome-mapping steps were grouped and a pair of best alignment was chosen by the following ordered criteria: the alignment pair (A) had the smallest insert size, (B) was mapped to ribosomal gene locus, or (C) was mapped to chromosome 1-23, X or Y. If none of these criteria was met by a single alignment pair, a random alignment pair was chosen from the multiply-mapped loci. These ltered alignments were then merged with the uniquely-mapped alignments. All reads that mapped to tRNA or rRNA loci were extracted by BEDtools v2.26 using pairtobed command with options -s -f 0.01 [<xref rid="c33" ref-type="bibr">33</xref>], combined with tRNA and rRNA pre-mapped reads and re-aligned to tRNA and rRNA references. Counts were generated from the aligned BAM file. Counts for each anticodon were aggregated. Other gene counts were calculated by converting the genome alignments to fragment coordinates in a BED file using the BEDtools bamtobed command and counted using the BEDtools coverage command [<xref rid="c33" ref-type="bibr">33</xref>]. TGIRT-map pipeline is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/wckdouglas/tgirt_map">https://github.com/wckdouglas/tgirt_map</ext-link>.</p></sec>
<sec><title>Kallisto and Salmon</title>
<p>We used Kallisto v0.43.0 [<xref rid="c5" ref-type="bibr">5</xref>] and Salmon v0.8.2 [<xref rid="c6" ref-type="bibr">6</xref>] for our alignment-free pipelines. In both cases, adaptor-trimmed reads were used as input.</p>
<p>We called Salmon with the following command-line arguments:
<preformat>
salmon quant \
       &#x2010;&#x2010;seqBias &#x2010;&#x2010;gcBias \
       &#x2010;&#x2010;index &#x0024;{INDEX} &#x2010;&#x2010;libType ISF \
       &#x2010;&#x2010;writeMappings \
       &#x2010;&#x2010;threads=&#x0024;{THREADS} \
       &#x2010;&#x2010;auxDir &#x0024;{RESULTPATH} \
       &#x2010;&#x2010;numBootstraps 100 \
       &#x2010;&#x2010;mates1 &#x0024;{TRIMMED_FQ1} &#x2010;&#x2010;mates2 &#x0024;{TRIMMED_FQ2} \
       &#x2010;&#x2010;output &#x0024;{RESULTPATH}</preformat></p>
<p>We called Kallisto with the following command-line arguments:
<preformat>
kallisto quant \
      -i &#x0024;{INDEX} -o &#x0024;{OUTPUT_PATH} \
      &#x2010;&#x2010;fr-stranded &#x2010;&#x2010;threads=&#x0024;{THREADS}\
      &#x0024;{TRIMMED_FQ1} &#x0024;{TRIMMED_FQ2}</preformat></p></sec>
<sec><title>Differential expression analysis</title>
<p>DESeq2 v1.14.1 [<xref rid="c34" ref-type="bibr">34</xref>] was used for all differential expression analyses.</p>
<p>Because DESeq2 does not accept TPM values as input, transcript TPM values from Salmon and Kallisto were converted to gene-level counts using Tximport [<xref rid="c35" ref-type="bibr">35</xref>] before any differential-expression analyses.</p>
</sec></sec>
<sec><title>Competing interests</title>
<p>Thermostable group II intron reverse transcriptase (TGIRT) enzymes and methods for their use are the subject of patents and patent applications that have been licensed by The University of Texas and East Tennessee State University to InGex, LLC. A.M.L. and The University of Texas are minority equity holders in InGex, LLC, and A.M.L. and some present and former Lambowitz laboratory members receive royalty payments from the sale of TGIRT enzymes and kits and from the licensing of intellectual property.</p>
</sec>
<sec sec-type="availability"><title>Availability of data and material</title>
<p>All scripts used for data processing are deposited on GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/wckdouglas/tgirt_benchmark">https://github.com/wckdouglas/tgirt_benchmark</ext-link>.</p>
</sec>
<sec><title>Author&#x2019;s contributions</title>
<p>D.C.W., A.M.L., C.O.W. designed the experiments. D.C.W., K.S.H., J.Y., A.M.L. and C.O.W. wrote the manuscript. D.C.W., K.S.H and J.Y. conducted the experiments and analyzed the data with input from A.M.L. and C.O.W.</p>
</sec>
<sec><title>Funding</title>
<p>This work was supported by NIH R01 grant GM37949 and Welch Foundation Grant F-1607 to A.M.L&#x2025; D.C.W. was supported by University Continuing Fellowship from The University of Texas at Austin.</p></sec>
<ack><title>Acknowledgements</title>
<p>We thank Dr. Nicholas C. Wu (The Scripps Research Institute) for critical reading of the manuscript, and Ben R. Jack and Dr. Adam J. Hockenberry from the Wilke lab for fruitful discussions and useful insights. The Texas Advanced Computing Center (TACC) and the Center for Biomedical Research Support (CBRS) at the University of Texas at Austin provided high-performance computing resources.</p>
</ack>
<ref-list><title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Mortazavi</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Williams</surname>, <given-names>B.A.</given-names></string-name>, <string-name><surname>McCue</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Schaeffer</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wold</surname>, <given-names>B.</given-names></string-name>: <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nature Method</source> <volume>5</volume>(<issue>7</issue>), <fpage>621</fpage>&#x2013;<lpage>628</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Roberts</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Goff</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Pertea</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kelley</surname>, <given-names>D.R.</given-names></string-name>, <string-name><surname>Pimentel</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Rinn</surname>, <given-names>J.L.</given-names></string-name>, <string-name><surname>Pachter</surname>, <given-names>L.</given-names></string-name>: <article-title>differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cuffinks</article-title>. <source>Nature Protocols</source> <volume>7</volume> (<issue>3</issue>), <fpage>562</fpage>&#x2013;<lpage>578</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.K.</given-names></string-name>, <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name>: <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>30</volume> (<issue>7</issue>), <fpage>923</fpage>&#x2013;<lpage>930</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Patro</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Mount</surname>, <given-names>S.M.</given-names></string-name>, <string-name><surname>Kingsford</surname>, <given-names>C.</given-names></string-name>: <article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nature Biotechnology</source> <volume>32</volume> (<issue>5</issue>), <fpage>462</fpage>&#x2013;<lpage>464</lpage> (<year>2014</year>)</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Bray</surname>, <given-names>N.L.</given-names></string-name>, <string-name><surname>Pimentel</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Melsted</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Pachter</surname>, <given-names>L.</given-names></string-name>: <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nature Biotechnology</source> <volume>34</volume> (<issue>5</issue>), <fpage>525</fpage>&#x2013;<lpage>527</lpage> (<year>2016</year>)</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Patro</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Duggal</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Love</surname>, <given-names>M.I.</given-names></string-name>, <string-name><surname>Irizarry</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Kingsford</surname>, <given-names>C.</given-names></string-name>: <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat Meth</source> (<year>2017</year>)</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Pertea</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Pertea</surname>, <given-names>G.M.</given-names></string-name>, <string-name><surname>Leek</surname>, <given-names>J.T.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>: <article-title>Transcript-level expression analysis of RNA-seq experiments with HISAT, StringTie and Ballgown</article-title>. <source>Nature Protocols</source> <volume>11</volume> (<issue>9</issue>), <fpage>1650</fpage>&#x2013;<lpage>1667</lpage> (<year>2016</year>)</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Dobin</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Davis</surname>, <given-names>C.A.</given-names></string-name>, <string-name><surname>Schlesinger</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Drenkow</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zaleski</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Jha</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Batut</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Chaisson</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Gingeras</surname>, <given-names>T.R.</given-names></string-name>: <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source> <volume>29</volume> (<issue>1</issue>), <fpage>15</fpage>&#x2013;<lpage>21</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>: <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>. <source>Nature Methods</source> <volume>12</volume> (<issue>4</issue>), <fpage>357</fpage>&#x2013;<lpage>360</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Rapaport</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Khanin</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Liang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Pirun</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Krek</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zumbo</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>C.E.</given-names></string-name>, <string-name><surname>Socci</surname>, <given-names>N.D.</given-names></string-name>, <string-name><surname>Betel</surname>, <given-names>D.</given-names></string-name>: <article-title>Comprehensive evaluation of differential gene expression analysis methods for</article-title>. <source>Genome biology</source> <volume>14</volume>(<issue>9</issue>), <fpage>95</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Teng</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Love</surname>, <given-names>M.I.</given-names></string-name>, <string-name><surname>Davis</surname>, <given-names>C.A.</given-names></string-name>, <string-name><surname>Djebali</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Dobin</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Graveley</surname>, <given-names>B.R.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>C.E.</given-names></string-name>, <string-name><surname>Olson</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Pervouchine</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Sloan</surname>, <given-names>C.A.</given-names></string-name>, <string-name><surname>Wei</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Zhan</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Irizarry</surname>, <given-names>R.A.</given-names></string-name>: <article-title>A benchmark for RNA-seq quantification pipelines</article-title>. <source>Genome Biology</source> <volume>17</volume>(<issue>1</issue>), <fpage>74</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Baruzzo</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Hayer</surname>, <given-names>K.E.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>E.J.</given-names></string-name>, <string-name><surname>Di Camillo</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>FitzGerald</surname>, <given-names>G.A.</given-names></string-name>, <string-name><surname>Grant</surname>, <given-names>G.R.</given-names></string-name>: <article-title>Simulation-based comprehensive benchmarking of RNA-seq aligners</article-title>. <source>Nature Method</source> <volume>14</volume>(<issue>2</issue>), <fpage>135</fpage>&#x2013;<lpage>139</lpage> (<year>2017</year>)</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Everaert</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Luypaert</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Maag</surname>, <given-names>J.L.V.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>Q.X.</given-names></string-name>, <string-name><surname>Dinger</surname>, <given-names>M.E.</given-names></string-name>, <string-name><surname>Hellemans</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mestdagh</surname>, <given-names>P.</given-names></string-name>: <article-title>Benchmarking of RNA-sequencing analysis workflows using whole-transcriptome RT-qPCR expression data</article-title>. <source>Scientific Reports</source> <volume>7</volume>(<issue>1</issue>), <fpage>1559</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Sahraeian</surname>, <given-names>S.M.E.</given-names></string-name>, <string-name><surname>Mohiyuddin</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sebra</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tilgner</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Afshar</surname>, <given-names>P.T.</given-names></string-name>, <string-name><surname>Au</surname>, <given-names>K.F.</given-names></string-name>, <string-name><surname>Asadi</surname>, <given-names>N.B.</given-names></string-name>, <string-name><surname>Gerstein</surname>, <given-names>M.B.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>W.H.</given-names></string-name>, <string-name><surname>Snyder</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Schadt</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Lam</surname>, <given-names>H.Y.K.</given-names></string-name>: <article-title>Gaining comprehensive biological insight into the transcriptome by performing a broad-spectrum RNA-seq analysis</article-title>. <source>Nature Communications</source> <volume>8</volume>(<issue>1</issue>), <fpage>59</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Nottingham</surname>, <given-names>R.M.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>D.C.</given-names></string-name>, <string-name><surname>Qin</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Yao</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Hunicke-Smith</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Lambowitz</surname>, <given-names>A.M.</given-names></string-name>: <article-title>RNA-seq of human reference RNA samples using a thermostable group II intron reverse transcriptase</article-title>. <source>RNA</source> <volume>22</volume>(<issue>4</issue>), <fpage>597</fpage>&#x2013;<lpage>613</lpage> (<year>2016</year>)</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Mohr</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ghanem</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Sheeter</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Qin</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>King</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Polioudakis</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Iyer</surname>, <given-names>V.R.</given-names></string-name>, <string-name><surname>Hunicke-Smith</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Swamy</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kuersten</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Lambowitz</surname>, <given-names>A.M.</given-names></string-name>: <article-title>Thermostable group II intron reverse transcriptase fusion proteins and their use in cDNA synthesis and next-generation RNA sequencing</article-title>. <source>RNA</source> <volume>19</volume>(<issue>7</issue>), <fpage>958</fpage>&#x2013;<lpage>70</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Qin</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Yao</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>D.C.</given-names></string-name>, <string-name><surname>Nottingham</surname>, <given-names>R.M.</given-names></string-name>, <string-name><surname>Mohr</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hunicke-Smith</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Lambowitz</surname>, <given-names>A.M.</given-names></string-name>: <article-title>High-throughput sequencing of human plasma RNA by using thermostable group II intron reverse transcriptases</article-title>. <source>RNA</source> <volume>22</volume>(<issue>1</issue>), <fpage>111</fpage>&#x2013;<lpage>128</lpage> (<year>2016</year>)</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Consortium</surname>, <given-names>M.</given-names></string-name>: <article-title>The MicroArray Quality Control (MAQC)-II study of common practices for the development and validation of microarray-based predictive models</article-title>. <source>Nature Biotechnology</source> <volume>28</volume>(<issue>8</issue>), <fpage>827</fpage>&#x2013;<lpage>838</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><article-title>SEQC/MAQC-III Consortium: A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>. <source>Nature Biotechnology</source> <volume>32</volume>(<issue>9</issue>), <fpage>903</fpage>&#x2013;<lpage>914</lpage> (<year>2014</year>)</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Langmead</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>: <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nature Method</source> <volume>9</volume>(<issue>4</issue>), <fpage>357</fpage>&#x2013;<lpage>359</lpage> (<year>2012</year>)</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Jiang</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Schlesinger</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Davis</surname>, <given-names>C.A.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Salit</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Gingeras</surname>, <given-names>T.R.</given-names></string-name>, <string-name><surname>Oliver</surname>, <given-names>B.</given-names></string-name>: <article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome research</source> <volume>21</volume>(<issue>9</issue>), <fpage>1543</fpage>&#x2013;<lpage>1551</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Alexander</surname>, <given-names>D.L.J.</given-names></string-name>, <string-name><surname>Tropsha</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Winkler</surname>, <given-names>D.A.</given-names></string-name>: <article-title>Beware of R2: simple, unambiguous assessment of the prediction accuracy of QSAR and QSPR models</article-title>. <source>Journal of chemical information and modeling</source> <volume>55</volume>(<issue>7</issue>), <fpage>1316</fpage>&#x2013;<lpage>1322</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Ryvkin</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Leung</surname>, <given-names>Y.Y.</given-names></string-name>, <string-name><surname>Silverman</surname>, <given-names>I.M.</given-names></string-name>, <string-name><surname>Childress</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Valladares</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Dragomir</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Gregory</surname>, <given-names>B.D.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>L.-S.</given-names></string-name>: <article-title>HAMR: high-throughput annotation of modified ribonucleotides</article-title>. <source>RNA</source> <volume>19</volume>(<issue>12</issue>), <fpage>1684</fpage>&#x2013;<lpage>1692</lpage> (<year>2013</year>)</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Clark</surname>, <given-names>W.C.</given-names></string-name>, <string-name><surname>Evans</surname>, <given-names>M.E.</given-names></string-name>, <string-name><surname>Dominissini</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Pan</surname>, <given-names>T.</given-names></string-name>: <article-title>tRNA base methylation identification and quantification via high-throughput sequencing</article-title>. <source>RNA</source> (<year>2016</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Katibah</surname>, <given-names>G.E.</given-names></string-name>, <string-name><surname>Qin</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Sidote</surname>, <given-names>D.J.</given-names></string-name>, <string-name><surname>Yao</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lambowitz</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Collins</surname>, <given-names>K.</given-names></string-name>: <article-title>Broad and adaptable RNA structure recognition by the human interferon-induced tetratricopeptide repeat protein IFIT5</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>111</volume> (<issue>33</issue>), <fpage>12025</fpage>&#x2013;<lpage>12030</lpage> (<year>2014</year>)</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Robert</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Watson</surname>, <given-names>M.</given-names></string-name>: <article-title>Errors in RNA-Seq quantification affect genes of relevance to human disease</article-title>. <source>Genome Biology</source> <volume>16</volume>, <fpage>177</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Hrdlickova</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>de Almeida</surname>, <given-names>R.C.</given-names></string-name>, <string-name><surname>Borek</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Withoff</surname>, <given-names>S.</given-names></string-name>: <article-title>Genetic variation in the non-coding genome: Involvement of micro-RNAs and long non-coding RNAs in disease</article-title>. <source>Biochimica et Biophysica Acta (BBA) - Molecular Basis of Disease</source> <volume>1842</volume>(<issue>10</issue>), <fpage>1910</fpage>&#x2013;<lpage>1922</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Cunningham</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Amode</surname>, <given-names>M.R.</given-names></string-name>, <string-name><surname>Barrell</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Beal</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Billis</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Brent</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Carvalho-Silva</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Clapham</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Coates</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Fitzgerald</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Gil</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gir&#x00F3;n</surname>, <given-names>C.G.</given-names></string-name>, <string-name><surname>Gordon</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Hourlier</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Hunt</surname>, <given-names>S.E.</given-names></string-name>, <string-name><surname>Janacek</surname>, <given-names>S.H.</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Juettemann</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>K&#x00E4;h&#x00E4;ri</surname>, <given-names>A.K.</given-names></string-name>, <string-name><surname>Keenan</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Martin</surname>, <given-names>F.J.</given-names></string-name>, <string-name><surname>Maurel</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>McLaren</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Murphy</surname>, <given-names>D.N.</given-names></string-name>, <string-name><surname>Nag</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Overduin</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Parker</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Patricio</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Perry</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Pignatelli</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Riat</surname>, <given-names>H.S.</given-names></string-name>, <string-name><surname>Sheppard</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Taylor</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Thormann</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Vullo</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Wilder</surname>, <given-names>S.P.</given-names></string-name>, <string-name><surname>Zadissa</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Aken</surname>, <given-names>B.L.</given-names></string-name>, <string-name><surname>Birney</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Harrow</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kinsella</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Muffato</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ruffier</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Searle</surname>, <given-names>S.M.J.</given-names></string-name>, <string-name><surname>Spudich</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Trevanion</surname>, <given-names>S.J.</given-names></string-name>, <string-name><surname>Yates</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zerbino</surname>, <given-names>D.R.</given-names></string-name>, <string-name><surname>Flicek</surname>, <given-names>P.</given-names></string-name>: <article-title>Ensembl 2015</article-title>. <source>Nucleic Acids Research</source> <volume>43</volume>(<issue>D1</issue>), <fpage>662</fpage>&#x2013;<lpage>669</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Chan</surname>, <given-names>P.P.</given-names></string-name>, <string-name><surname>Lowe</surname>, <given-names>T.M.</given-names></string-name>: <article-title>GtRNAdb 2.0: an expanded database of transfer RNA genes identified in complete and draft genomes</article-title>. <source>Nucleic Acids Research</source> <volume>44</volume>(<issue>D1</issue>), <fpage>184</fpage>&#x2013;<lpage>189</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Durinck</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Spellman</surname>, <given-names>P.T.</given-names></string-name>, <string-name><surname>Birney</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name>: <article-title>Mapping Identifiers for the Integration of Genomic Datasets with the R/Bioconductor package biomaRt</article-title>. <source>Nature protocols</source> <volume>4</volume>(<issue>8</issue>), <fpage>1184</fpage>&#x2013;<lpage>1191</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Durinck</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Moreau</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Kasprzyk</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Davis</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>De Moor</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Brazma</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name>: <article-title>BioMart and Bioconductor: a powerful link between biological databases and microarray data analysis</article-title>. <source>Bioinformatics</source> <volume>21</volume>(<issue>16</issue>), <fpage>3439</fpage>&#x2013;<lpage>3440</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Martin</surname>, <given-names>M.</given-names></string-name>: <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>EMBnet.journal</source> <volume>17</volume>(<issue>1</issue>), <fpage>10</fpage>&#x2013;<lpage>12</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Quinlan</surname>, <given-names>A.R.</given-names></string-name>: <article-title>BEDTools: the swiss-army tool for genome feature analysis</article-title>. <source>Current protocols in bioinformatics</source> <volume>47</volume>, <fpage>11</fpage>&#x2013;<lpage>12134</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Love</surname>, <given-names>M.I.</given-names></string-name>, <string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Anders</surname>, <given-names>S.</given-names></string-name>: <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biology</source> <volume>15</volume> (<issue>12</issue>), <fpage>550</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Soneson</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Love</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Robinson</surname>, <given-names>M.</given-names></string-name>: <article-title>differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences [version 1; referees: 2 approved]</article-title>. <source>F1000Research</source> <volume>4</volume>(<issue>1521</issue>) (<year>2015</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Kuhn</surname>, <given-names>M.</given-names></string-name>: <article-title>Building Predictive Models in R Using the caret Package</article-title>. <source>Journal of Statistical Software</source> <volume>28</volume>(<issue>5</issue>), <fpage>1</fpage>&#x2013;<lpage>26</lpage> (<year>2008</year>)</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Freedman</surname>, <given-names>J.E.</given-names></string-name>, <string-name><surname>Gerstein</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mick</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Rozowsky</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Levy</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kitchen</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Das</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Shah</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Danielson</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Beaulieu</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Navarro</surname>, <given-names>F.C.P.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Galeev</surname>, <given-names>T.R.</given-names></string-name>, <string-name><surname>Holman</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kwong</surname>, <given-names>R.Y.</given-names></string-name>, <string-name><surname>Murthy</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Tanriverdi</surname>, <given-names>S.E.</given-names></string-name>, <string-name><surname>Koupenova</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mikhalev</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Tanriverdi</surname>, <given-names>K.</given-names></string-name>: <article-title>Diverse human extracellular RNAs are widely detected in human plasma</article-title>. <source>Nature Communications</source> <volume>7</volume>, <fpage>11106</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Hopper</surname>, <given-names>A.K.</given-names></string-name>, <string-name><surname>Phizicky</surname>, <given-names>E.M.</given-names></string-name>: <article-title>tRNA transfers to the limelight</article-title>. <source>Genes &#x0026; Development</source> <volume>17</volume>(<issue>2</issue>), <fpage>162</fpage>&#x2013;<lpage>180</lpage> (<year>2003</year>).</mixed-citation></ref></ref-list>
<sec><title>Additional Files</title>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure"><label>Additional File 1</label>
<caption><p>Flow chart of the custom pipeline TGIRT-map. As TGIRT-seq simultaneously recovers a large fraction of small structural RNAs in addition to regular long RNAs [15, 17], TGIRT-map was designed to optimize the quantification of these small genes. The pipeline is similar to the Genobee-exceRpt small RNA-seq pipeline [<xref rid="c37" ref-type="bibr">37</xref>], where reads are first aligned against the tRNA and rRNA sequences to avoid ambiguous assignments in later steps. Unaligned reads (red arrow) are iteratively aligned to the human genome by HISAT2 [<xref rid="c9" ref-type="bibr">9</xref>] and BOWTIE2 [<xref rid="c20" ref-type="bibr">20</xref>] to minimize unassigned reads. Multiply-mapped reads are extracted and assigned as uniquely-mapped at loci selected by the following criteria in order: the pair of alignments (A) has the smallest insert size, (B) is mapped to ribosomal gene loci, and (c) is mapped to chromosome 1-23, X or Y, otherwise a random pair of alignments is selected. From these genome alignments, reads that aligned to tRNA or rRNA loci are extracted and combined with tRNA and rRNA reads from the first step. Finally, these combined reads are realigned to the tRNA and rRNA sequences to generate gene counts.</p></caption>
<graphic xlink:href="246967_figS1.tif"/>
</fig>
<p>Additional File 2&#x2014;supplementary tables.zip Zip file containing several data tables in tab-separated format, as well as a readme file that explains the contents of each data file.</p>
<fig id="figS2" position="float" orientation="portrait" fig-type="figure"><label>Additional File 3</label>
<caption><p>Intersections of detected genes among tested pipelines. Genes with TPM &#x003E; 0.1 were defined as being detected. (a-d) UpSet graphs of intersections of detected genes among pipelines. An UpSet graph describes intersections of detected genes among subsets of tested pipelines. Each UpSet graph contains a bar chart and a sample-comparison matrix. Bars indicate the numbers of detected genes in the specific intersection specified in the sample-comparison matrix. Each bar indicates the number of genes detected only in the intersection of the set of compared pipelines. The sample-comparison matrix at the bottom describes the set of pipelines within which the comparison is made. Grey boxes in the matrix annotate the pipelines included in the comparison. (e) Uniquely-detected genes. The heights of the stacked bars indicate the numbers of genes uniquely detected by the corresponding pipeline. Stacked bars are color-coded with gene types.</p></caption>
<graphic xlink:href="246967_figS2.tif"/>
</fig>
<fig id="figS3" position="float" orientation="portrait" fig-type="figure"><label>Additional File 4</label>
<caption><p>Pearson&#x2019;s correlation coefficients for pairwise pipeline comparisons in gene quantifications. For every pairwise pipeline comparison and each sample (A{D), Pearson&#x2019;s correlation coefficients were computed using the average log2 TPM of each gene across the triplicates for each sample. Bar heights indicate average correlations among the four samples A-D. Error bars represent standard deviations among the four samples A-D. Red bars represent total RNA correlation coefficients (all genes). Grey bars indicate correlation coefficients grouped by gene type. Each panel represents a single pairwise pipeline comparison.</p></caption>
<graphic xlink:href="246967_figS3.tif"/>
</fig>
<fig id="figS4" position="float" orientation="portrait" fig-type="figure"><label>Additional File 5</label>
<caption><p>Impact of gene lengths and expression levels on gene quantification correlations among pipelines. (a) Gene lengths inuence gene expression estimation correlations. Genes were separated into quantile groups according to their lengths. For every quantile group from each sample, Pearson&#x2019;s correlation coefficients of average TPMs for each gene across replicates were computed for every pairwise pipeline comparison and then averaged across the four samples. Plotted are the average correlations versus the quantile groups. Each line represents a pairwise comparison and is color-coded accordingly. (b) Gene expression levels influence gene expression estimate correlations. Genes were separated into quantile groups according to their average expression values (TPMs). For every quantile group from each sample, Pearson&#x2019;s correlations were computed in the same way as in panel (a). Each line represents a pairwise comparison and is color-coded accordingly.</p></caption>
<graphic xlink:href="246967_figS4.tif"/>
</fig>
<fig id="figS5" position="float" orientation="portrait" fig-type="figure"><label>Additional File 6</label>
<caption><p>Differential expression analysis of protein-coding genes. (a) Comparison of measured fold-changes between samples A and B from the TGIRT-seq analysis and the MAQC TaqMan assay. MAQC TaqMan assay data for the same samples were downloaded from the NCBI Gene Expression Omnibus (GEO), accession number GSE5350 [18]. 972 unique protein-coding genes were compared. Log2 fold-changes were calculated from MAQC data and compared to the DESeq2 results for each pipeline. Distributions of the deviations between RNA-seq and MAQC data log2 fold-changes were plotted as violin-plots. Distributions are color-coded by pipelines. (b) ROC curves for calling differentially-expressed (DE) protein-coding genes. MAQC TaqMan assay genes were binary-labeled as DE if absolute log2 fold-change &#x003E;0.5 and not DE otherwise (739 DE and 225 non-DE), as suggested by a previous study [10]. ROC curves for DESeq2 results from abundance estimates computed by each pipeline were plotted. AUCs were computed for each ROC curve to quantify performances of the differential expression caller (DESeq2) [34] on abundance estimates from each pipeline. ROC curves are color-coded by pipelines. The dotted diagonal line indicates random guessing (AUC=0.5).</p></caption>
<graphic xlink:href="246967_figS5.tif"/>
</fig>
<fig id="figS6" position="float" orientation="portrait" fig-type="figure"><label>Additional File 7</label>
<caption><p>Measured versus expected log2 fold-changes between samples C and D for Kallisto. Expected log2 fold-changes for each gene (denoted by red line) were constructed from the (A) Kallisto-measured log2 fold-changes between samples A and B and (B) the known sample mix ratio of samples A and B in samples C and D, using a previously-described algorithm [18]. Each panel shows a two-dimensional kernel density estimation of the distribution of measured vs expected log2 fold-changes between samples C and D for genes grouped by quantile groups of gene lengths. Coefficients of determination for each group of genes are annotated as <italic>R</italic><sup>2</sup>. Perfectly correlated log2 fold-changes are annotated by the diagonal red lines. Panels with high <italic>R</italic><sup>2</sup> generally show denser trends along the red line, indicating the log2 fold-changes between samples C and D were accurately predicted by the software that recapitulated the sample-mixing ratio and thus, fitted better to the model (red line). For groups with lower <italic>R</italic><sup>2</sup>, a denser (lighter color) horizontal trend was observed on the right side of the red line, indicating the software either over-estimated log2 fold-changes between samples A and B that filed to construction of an incorrect model or under-estimated log2 fold-changes between samples C and D that filed to a poor fit to the model.</p></caption>
<graphic xlink:href="246967_figS6.tif"/>
</fig>
<fig id="figS7" position="float" orientation="portrait" fig-type="figure"><label>Additional File 8</label>
<caption><p>Performances of Salmon using different k-mer sizes of 11, 15, 21, and 31 (default). (a) Accuracies of fold-change estimation in quantile groups of gene lengths. All detected genes from TGIRT-map or Salmon with different k-mer sizes were grouped by their gene lengths into four quantile groups. For each quantile group, <italic>R</italic><sup>2</sup> values were computed from the expected and measured log2 fold-change values between samples C and D. Bars are color-coded by pipelines. Coefficients of determination (<italic>R</italic><sup>2</sup>) were computed by R2 function from R caret package [<xref rid="c36" ref-type="bibr">36</xref>]. (b) Cumulative absolute errors in tRNA log2 fold-change predictions for each k-mer size and TGIRT-map. tRNAs were sorted in ascending order by their absolute errors in log2 fold-change predictions. Cumulative absolute errors for all detected tRNA were plotted. Lines are color-coded by pipeline.</p></caption>
<graphic xlink:href="246967_figS7.tif"/>
</fig>
<fig id="figS8" position="float" orientation="portrait" fig-type="figure"><label>Additional File 9</label>
<caption><p>Erroneous sequencing reads may have impeded k-mer counting for tRNAs. IGV genome browser screen-shots of three tRNA alignments from Sample A1 aligned via TGIRT-map were shown. The three tRNA alignments being shown are (a) TRR-CCG, (b) TRS-ACT, and (c) TRT-AGT. Arrows on the top of each panel indicate the corresponding tRNA transcript strands (5&#x2019; to 3&#x2019;) and sizes. Bar charts below the arrows represent coverages at every position along the tRNA transcripts. Read alignments from Sample A1 aligned by TGIRT-map are shown below the bar charts. Grey colors represent read bases that match the reference bases. Other colors indicate bases on the read alignments that do not match the reference bases (purple, red, green, blue, and brown colors indicate insertions, thymidines, adenosines, cytidines, and guanosines on the read alignments, respectively). These errors may reflect post-transcriptionally-modified RNA bases, which interfere with canonical base-pairings and filead to misincorporations during TGIRT reverse transcriptions [15, 17, 25]. Errors due to misincorporations at known and unknown sites of post-transcriptionally modified RNA bases are highlighted with boxes (m<sup>2</sup> <sub>2</sub>G26: N2,N2-dimethylguanosine at position 26; m<sup>2</sup>G26: N2-methylguanosine at position 26; I34: Inosine at position 34; m<sup>1</sup>A58: 1-methyladenosine at position 58; see also [<xref rid="c15" ref-type="bibr">15</xref>, <xref rid="c17" ref-type="bibr">17</xref>, <xref rid="c38" ref-type="bibr">38</xref>]). Unannotated mismatches from both ends can be untrimmed adapters or tRNA-precusor sequences. We observe that on these tRNAs, the errors induced by RNA-base-modification occurred at positions &#x223C;20, 30, or 50 on &#x223C;75 nucleotide long tRNA transcripts. Therefore, we expect that every k-mer originating from an erroneous sequencing read inherits at least one of these errors, and therefore k-mers cannot be matched accurately to the transcript database. The effect is worse when a large k-mer size is selected, such as the default <italic>k</italic> = 31.</p></caption>
<graphic xlink:href="246967_figS8.tif"/>
</fig></sec></back></article>