<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/023622</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part IV: Incorporation of substitutions and other mutations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Ezawa</surname><given-names>Kiyoshi</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Graur</surname><given-names>Dan</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Landan</surname><given-names>Giddy</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n2">3</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biology and Biochemistry, University of Houston</institution>, Houston, TX 77204-5001, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="present-address"><label>2</label><p>Present address: Department of Bioscience and Bioinformatics, Kyushu Institute of Technology, Iizuka 820-8502, JAPAN</p></fn>
<fn id="n2" fn-type="present-address"><label>3</label><p>Present address: Institute of Genomic Microbiology, Heinrich-Heine University D&#x00FC;sseldorf, Universit&#x00E4;tsstr. 1, 40225 D&#x00FC;sseldorf, GERMANY</p></fn>
<corresp id="cor1"><label>&#x002A;</label>Corresponding Author (E-mail: <email>kezawa@bio.kyutech.ac.jp</email>, <email>kezawa.ezawa3@gmail.com</email>)</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2015</year></pub-date>
<elocation-id>023622</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>7</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="023622.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<sec><title>Background</title>
<p>Insertions and deletions (indels) account for more nucleotide differences between two related DNA sequences than substitutions do, and thus it is imperative to develop a stochastic evolutionary model that enables us to reliably calculate the probability of the sequence evolution through indel processes. In a separate paper (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>), we established the theoretical basis of our <italic>ab initio</italic> perturbative formulation of a continuous-time Markov model of the evolution of an <italic>entire</italic> sequence via insertions and deletions along time axis. In other separate papers (<xref ref-type="bibr" rid="c17">Ezawa, Graur and Landan 2015b</xref>,<xref ref-type="bibr" rid="c18">c</xref>), we also developed various analytical and computational methods to concretely calculate alignment probabilities via our formulation. In terms of frequencies, however, substitutions are usually more common than indels. Moreover, many experiments suggest that other mutations, such as genomic rearrangements and recombination, also play some important roles in sequence evolution.</p>
</sec>
<sec><title>Results</title>
<p>Here, we extend our <italic>ab initio</italic> perturbative formulation of a <italic>genuine</italic> evolutionary model so that it can incorporate other mutations. We give a sufficient set of conditions that the probability of evolution via both indels and substitutions is factorable into the product of an overall factor and local contributions. We also show that, under a set of conditions, the probability can be factorized into two sub-probabilities, one via indels alone and the other via substitutions alone. Moreover, we show that our formulation can be extended so that it can also incorporate genomic rearrangements, such as inversions and duplications. We also discuss how to accommodate some other types of mutations within our formulation.</p>
</sec>
<sec><title>Conclusions</title>
<p>Our <italic>ab initio</italic> perturbative formulation thus extended could in principle describe the stochastic evolution of an <italic>entire</italic> sequence along time axis via major types of mutations.</p>
<p>[This paper and three other papers (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>,<xref ref-type="bibr" rid="c17">b</xref>,<xref ref-type="bibr" rid="c18">c</xref>) describe a series of our efforts to develop, apply, and extend the <italic>ab initio</italic> perturbative formulation of a general continuous-time Markov model of indels.]</p>
</sec>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>Insertion/deletion (indel)</kwd>
<kwd>substitution</kwd>
<kwd>genomic rearrangement</kwd>
<kwd>inversion</kwd>
<kwd>duplication</kwd>
<kwd>pairwise sequence alignment (PWA)</kwd>
<kwd>multiple sequence alignment (MSA)</kwd>
<kwd>probability</kwd>
<kwd>likelihood</kwd>
<kwd>continuous-time Markov model</kwd>
<kwd>perturbation theory</kwd>
</kwd-group>
<counts>
<page-count count="35"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Introduction</title>
<p>The evolution of DNA, RNA, and protein sequences is driven by mutations such as base substitutions, insertions and deletions (indels), recombination, and other genomic rearrangements (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c25">Graur and Li 2000</xref>; <xref ref-type="bibr" rid="c23">Gascuel 2005</xref>; <xref ref-type="bibr" rid="c33">Lynch 2007</xref>). Thus far, analyses on substitutions have predominated in the field of molecular evolutionary study, in particular using the probabilistic (or likelihood) theory of substitutions that is now widely accepted (e.g., <xref ref-type="bibr" rid="c21">Felsenstein 1981</xref>, <xref ref-type="bibr" rid="c22">2004</xref>; <xref ref-type="bibr" rid="c49">Yang 2006</xref>). However, some recent comparative genomic analyses have revealed that indels account for more base differences between the genomes of closely related species than substitutions (<italic>e.g</italic>., <xref ref-type="bibr" rid="c4">Britten 2002</xref>; <xref ref-type="bibr" rid="c5">Britten et al. 2003</xref>; <xref ref-type="bibr" rid="c28">Kent <italic>et al</italic>. 2003</xref>; <xref ref-type="bibr" rid="c44">The International Chimpanzee Chromosome 22 Consortium 2004</xref>; <xref ref-type="bibr" rid="c43">The Chimpanzee Sequencing and Analysis Consortium 2005</xref>). It is therefore imperative to develop a stochastic model that enables us to reliably calculate the probability of sequence evolution via mutations including insertions and deletions.</p>
<p>Traditionally, the computation of probabilities of indels has been based on hidden Markov models (HMMs) or transducer theories (see, <italic>e.g</italic>., <xref ref-type="bibr" rid="c38">Rivas 2005</xref>; <xref ref-type="bibr" rid="c3">Bradley and Holmes 2007</xref>; <xref ref-type="bibr" rid="c35">Mikl&#x00F3;s et al. 2009</xref>). However, these methods have two fundamental problems, one regarding the theoretical grounds and the other regarding the biological realism. (See the &#x201C;background&#x201D; section in part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>) for more details on these problems.)</p>
<p>As an unprecedented approach to these problems on the probabilistic models of indels, we proposed an <italic>ab initio</italic> perturbative formulation of a <italic>genuine</italic> stochastic evolutionary model, which describes the evolution of an <italic>entire</italic> sequence via indels along the time axis (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>). Such a <italic>genuine</italic> evolutionary model is devoid of the aforementioned problems from the beginning. More specifically, our <italic>genuine</italic> evolutionary model is a general continuous-time Markov model of sequence evolution via indels. It allows any indel rate parameters including length distributions, but it does not impose any unnatural restrictions on indels. In part I of this series of study (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>), we gave the theoretical basis of our <italic>ab initio</italic> formulation. Especially, we derived a sufficient and nearly necessary set of conditions under which the probability of an alignment is factorable, like a sort of HMM. In part II (<xref ref-type="bibr" rid="c17">Ezawa, Graur and Landan 2015b</xref>), we developed some analytical techniques for performing concrete perturbation analyses. In part III (<xref ref-type="bibr" rid="c18">Ezawa, Graur and Landan 2015c</xref>), we developed an algorithm that can calculate the first-approximate probability of each local MSA delimited by gapless columns, given an input MSA and under a given parameter setting including a phylogenetic tree.</p>
<p>Mainly in order to avoid unnecessary confusions of the readers, these studies (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>,<xref ref-type="bibr" rid="c17">b</xref>,<xref ref-type="bibr" rid="c18">c</xref>) dealt with indels alone. In terms of frequencies, however, substitutions are usually more common than indels (<italic>e.g</italic>., <xref ref-type="bibr" rid="c31">Lunter 2007</xref>; <xref ref-type="bibr" rid="c7">Cartwright 2009</xref>). Moreover, many experiments suggest that still other mutations, such as genomic rearrangements and recombination, also play some important roles in the evolution of protein and DNA sequences (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c25">Graur and Li 2000</xref>; <xref ref-type="bibr" rid="c33">Lynch 2007</xref>; <xref ref-type="bibr" rid="c26">Gu et al. 2008</xref>). Thus, a natural question arises as to whether the methods and conclusions obtained in these papers are still valid, at least to some degree, even when we consider other types of mutations as well.</p>
<p>In this study, we extend our <italic>ab initio</italic> parturbative formulation of a <italic>genuine</italic> evolutionary model so that it can incorporate other mutations, such as substitutions and genomic rearrangements. In Section 1 of Results &#x00026; Discussion, we consider the model of sequence evolution via both indels and substitutions. We give a sufficient set of conditions that the probability of an alignment under this model is factorable into the product of an overall factor and the contributions from local evolutionary processes. We also show that, under a set of conditions, the probability can be factorized into two components. One is the &#x201C;basic&#x201D; component given by the indel processes alone, and the other is the residue component that concerns the substitution processes alone. Our set of conditions is more general than the commonly used conditions that the indigenous and inserted residue frequencies are equal to the equilibrium frequencies of the substitution model (<italic>e.g</italic>., <xref ref-type="bibr" rid="c45">Thorne et al. 1991</xref>, <xref ref-type="bibr" rid="c46">1992</xref>; <xref ref-type="bibr" rid="c34">Mikl&#x00F3;s et al. 2004</xref>; <xref ref-type="bibr" rid="c39">Rivas and Eddy 2008</xref>). In Section 2, we show that our <italic>ab initio</italic> formulation of a genuine evolutionary model can be extended to incorporate genomic rearrangements, especially inversions and duplications. In Section 3, we discuss how we can accommodate some other types of mutations within our formulation. Appendix gives mathematical details on Section 1.</p>
<p>This paper is part IV of a series of our papers that documents our efforts to develop, apply, and extend the <italic>ab initio</italic> perturbative formulation of the general continuous-time Markov model of sequence evolution via indels. Part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>) gives the theoretical basis of this entire study. Part II (<xref ref-type="bibr" rid="c17">Ezawa, Graur and Landan 2015b</xref>) describes concrete perturbation calculations and examines the applicable ranges of other probabilistic models of indels. Part III (<xref ref-type="bibr" rid="c18">Ezawa, Graur and Landan 2015c</xref>) describes our algorithm to calculate the first approximation of the probability of a given MSA and simulation analyses to validate the algorithm. Finally, part IV (this paper) discusses how our formulation can incorporate substitutions and other mutations, such as duplications and inversions.</p>
<p>This paper basically uses the same conventions as used in part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>). Briefly, a sequence state <italic>s</italic> (&#x2208; <italic>S</italic>) is represented as an array of sites, each of which is either blank or equipped with some specific attributes. And each indel event is represented as an operator acting on the bra-vector, <bold>&#x3008;</bold> <italic>s&#x007C;</italic>, representing a sequence state. More specifically, the operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline1.gif"/></alternatives></inline-formula> denotes the insertion of <italic>l</italic> sites between the <italic>x</italic> th and (<italic>x</italic> &#x002B;1) th sites, and the operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline2.gif"/></alternatives></inline-formula> denotes the deletion of a sub-array between (and including) the <italic>x</italic><sub><italic>B</italic></sub> th and the <italic>x</italic><sub><italic>E</italic></sub> th sites. See Section 2 of part I for more details. And, as in part I, the following terminology is used. The term &#x201C;an indel process&#x201D; means a series of successive indel events with both the order and the specific timings specified, and the term &#x201C;an indel history&#x201D; means a series of successive indel events with only the order specified. And, throughout this paper, the union symbol, such as in <italic>A</italic> &#x222A; <italic>B</italic> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline3.gif"/></alternatives></inline-formula>, should be regarded as the union of <italic>mutually disjoint</italic> sets (<italic>i.e.,</italic> those satisfying <italic>A</italic> &#x2229; <italic>B</italic> = &#x2205; and <italic>A</italic><sub><italic>i</italic></sub> &#x2229; <italic>A</italic><sub><italic>j</italic></sub> = &#x2205; for <italic>i</italic> &#x2260; <italic>j</italic> (&#x2208; {1,&#x2026;, <italic>I</italic>}), respectively, where &#x2205;is an empty set), unless otherwise stated.</p>
</sec>
<sec id="s2"><title>Results &#x00026; Discussion</title>
<sec id="s2a"><title>1. Incorporation of substitutions</title>
<p>For clarity, we focused on the description of indel processes and omitted substitutions in the bulk of the paper. Actually, it is not so difficult to incorporate substitutions into our framework. For this purpose, we first extend the sequence state space <italic>S</italic> (= <italic>S<sup>I</sup></italic>, <italic>S<sup>II</sup></italic>, <italic>or S<sup>III</sup></italic>) so that each site of the sequence will accommodate a residue in the set &#x2126; (see, <italic>e.g</italic>., Subsection 2.1 of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>)). When <italic>S</italic> = <italic>S<sup>I</sup></italic>(&#x2245; N<sub>0</sub>&#x2261; {0,1, 2,&#x2026;}), the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline4.gif"/></alternatives></inline-formula>, in which each site is assigned a residue <italic>&#x03C9;</italic> &#x2208; <bold>&#x2126;</bold>. When <italic>S</italic> = <italic>S<sup>II</sup></italic>(&#x2282; &#x03D2;<sup>&#x002A;</sup>), the ancestry assigned to each site, <italic>&#x03C5;</italic> &#x2208;&#x03D2;, is replaced with a pair, (<italic>&#x03C5;</italic>, <italic>&#x03C9;</italic>) &#x2208;&#x03D2; &#x00D7;<bold>&#x2126;</bold>. Thus, the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline5.gif"/></alternatives></inline-formula>. Similarly, when <italic>S</italic> = <italic>S<sup>III</sup></italic> (&#x2282; {N<sub>0</sub> &#x00D7; N<sub>1</sub>}&#x002A;), the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline6.gif"/></alternatives></inline-formula>, in which each site is assigned a trio, (<italic>&#x03C3;</italic>, <italic>&#x03BE;</italic>, <italic>&#x03C9;</italic>) &#x2208; N<sub>0</sub>&#x00D7; N<sub>1</sub>&#x00D7;&#x2126;.(Here <italic>&#x03C3;</italic> is the source identifier of the inserted (or initial) subsequence, and <italic>&#x03BE;</italic> is the relative coordinate within the inserted (or initial) subsequence.) An extended sequence state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline7.gif"/></alternatives></inline-formula> will sometimes be represented as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline8.gif"/></alternatives></inline-formula> to explicitly show that it is composed of a &#x201C;basic&#x201D; component <italic>s</italic> &#x2208; <italic>S</italic> and a residue component <inline-formula><alternatives><inline-graphic xlink:href="023622_inline9.gif"/></alternatives></inline-formula>. (Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline10.gif"/></alternatives></inline-formula> is the length of the sequence <inline-formula><alternatives><inline-graphic xlink:href="023622_inline11.gif"/></alternatives></inline-formula>.) Once we extended the sequence state space, we can now extend the indel rate operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline12.gif"/></alternatives></inline-formula> (given in Eqs.(2.4.2a-d) of part I). This is done in two steps. (1) We add the substitution component of the rate operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline13.gif"/></alternatives></inline-formula>. The operator is a generalization of the one given in Eq.(<xref ref-type="disp-formula" rid="eqn1_2">1.2.1&#x2019;</xref>) of part I to a sequence with multiple sites and to a more general substitution model. And (2) we extend the indel component <inline-formula><alternatives><inline-graphic xlink:href="023622_inline14.gif"/></alternatives></inline-formula> to take explicit account of the residue dependence of indels, including the relative probabilities among residue states filling in each inserted array of sites. See Appendix A1 for details. Then, the total rate operator of the entire evolutionary model <inline-formula><alternatives><inline-graphic xlink:href="023622_inline15.gif"/></alternatives></inline-formula> is given by adding the indel and substitution rate operators:
<disp-formula id="eqn1_1"><alternatives><graphic xlink:href="023622_eqn1_1.gif"/></alternatives></disp-formula></p>
<p>At least formally, we could apply the perturbation expansion technique to the stochastic evolution operator of the entire model, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline16.gif"/></alternatives></inline-formula> (<italic>T</italic> {&#x2026;} denotes the time-ordered product.) We can do this by decomposing <inline-formula><alternatives><inline-graphic xlink:href="023622_inline17.gif"/></alternatives></inline-formula> into two parts: <inline-formula><alternatives><inline-graphic xlink:href="023622_inline18.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xlink:href="023622_inline19.gif"/></alternatives></inline-formula> is treated as a &#x201C;perturbation&#x201D; part. There are two major ways of doing this. (A) To decompose it into <inline-formula><alternatives><inline-graphic xlink:href="023622_inline20.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline21.gif"/></alternatives></inline-formula>. And (B) to decompose it into <inline-formula><alternatives><inline-graphic xlink:href="023622_inline22.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline23.gif"/></alternatives></inline-formula>. Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline24.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline25.gif"/></alternatives></inline-formula> are the exit-rate part and the single-mutation part, respectively, of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline26.gif"/></alternatives></inline-formula>; and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline27.gif"/></alternatives></inline-formula>, are the exit-rate part, the single-insertion part and the single-deletion part, respectively, of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline28.gif"/></alternatives></inline-formula>.</p>
<p>By mainly using the decomposition (A) and by following the same line of arguments as in Sections 3 and 4 of part I, we can show that the probability of an alignment (whether it is a PWA or a MSA) is factorable into the product of an overall factor and the contributions from regions that can potentially accommodate local evolutionary histories, this time including both indels and substitutions. We showed the factorability under the following sufficient set of conditions. (I) In each region, the rate of each of the substitutions and indels is independent of the portions of the extended sequence states in the other regions. (II) In each region, the increment of the total exit rate, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline29.gif"/></alternatives></inline-formula>, due to each of the substitutions and indels is independent of the portions of the extended states in the other regions. And, if considering a MSA, (III) the factorization of the root sequence state probability (<italic>i.e</italic>., an extended version of Eq.(4.2.8) in part I) holds. See Appendix A2 for details on the derivation.</p>
<p>The factorization of the probability into the local contributions would definitely be helpful. However, it would be at least equally useful to factorize the probability under the entire evolutionary model into the &#x201C;basic component&#x201D; and the &#x201C;residue&#x201D; component.&#x201D; Here, the &#x201C;basic component&#x201D; is based only on possible indel histories, and the &#x201C;residue component&#x201D; is based only on possible substitution histories (and initial residue state distributions). Mainly using the aforementioned decomposition (B), we can show that such an &#x201C;indel-substitution factorization&#x201D; can indeed be carried out on the alignment probability if the following four conditions are satisfied. (i) The indel rates are independent of the residue states. (ii) Each finite-time evolution probability of the residue state via substitutions is factorable into the product of site-wise substitution probabilities. (iii) The residue state spectrum of each inserted sub-sequence is factorable into the product of site-wise residue probabilities over the inserted sites. And (iv) the site-wise inserted residue probabilities at each site, {<italic>p</italic><sub><italic>I</italic></sub> (<italic>&#x03C9;</italic>; <italic>&#x03C5; <sub>j</sub></italic>, <italic>t</italic>)} <sub><italic>&#x03C9;</italic>&#x2208;&#x2126;</sub>, where <italic>&#x03C5; <sub>j</sub></italic> is the ancestry of the site, should satisfy the equation:
<disp-formula id="eqn1_2"><alternatives><graphic xlink:href="023622_eqn1_2.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline30.gif"/></alternatives></inline-formula> is the site-wise stochastic evolution operator via substitutions. When dealing with a MSA, the following equation also needs to be satisfied:
<disp-formula id="eqn1_3"><alternatives><graphic xlink:href="023622_eqn1_3.gif"/></alternatives></disp-formula></p>
<p>Here, <italic>P</italic>[(<italic>&#x03C9;</italic> <bold>&#x2032;</bold>, <italic>n<sup>Root</sup></italic>)&#x007C;<italic>&#x03C5;<sub>i</sub></italic>] is the probability of the residue <italic>&#x03C9;</italic> <bold>&#x2032;</bold> at the site with ancestry <italic>&#x03C5; <sub>i</sub></italic> in the sequence at the root node (<italic>n<sup>Root</sup></italic>). See Appendix A3 for details on the proof of the &#x201C;indel-substitution factorization&#x201D; under these conditions. <xref ref-type="disp-formula" rid="eqn1_2">Eq.(1.2)</xref> means that the inserted residue frequencies must evolve according to the site-wise stochastic evolution via substitutions. And <xref ref-type="disp-formula" rid="eqn1_3">Eq.(1.3)</xref> requires that, at every point along the tree, they should coincide with the residue frequencies that would have evolved through substitutions beginning with {<italic>P</italic>[(<italic>&#x03C9;</italic>, <italic>n<sup>Root</sup></italic>)&#x007C;<italic>&#x03C5; <sub>i</sub></italic>]}<sub><italic>&#x03C9;</italic> &#x2208;&#x2126;</sub> at the root. These equations are a generalized version of the following commonly assumed pair of conditions. (a) The residue frequencies are equilibrium frequencies, {<italic>&#x03C0;</italic> (<italic>&#x03C9;</italic>)}<sub><italic>&#x03C9;</italic> &#x2208;&#x2126;</sub>, that satisfy the detailed-balance conditions, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline31.gif"/></alternatives></inline-formula>. And (b) the inserted residue frequencies must coincide with these equilibrium frequencies (see, <italic>e.g</italic>., <xref ref-type="bibr" rid="c45">Thorne et al. 1991</xref>, <xref ref-type="bibr" rid="c46">1992</xref>; <xref ref-type="bibr" rid="c34">Mikl&#x00F3;s et al. 2004</xref>; <xref ref-type="bibr" rid="c39">Rivas and Eddy 2008</xref>).</p>
<p>In order to pursue the biological realism further, however, the aforementioned conditions (i)-(iv) would be too restrictive, even though the conditions were somewhat relaxed compared to the common practice of imposing (a) and (b) (instead of (iv)). It may be relatively easy to relax the conditions (ii) and (iii) so that the substitution processes could depend on the residue states of neighboring sites, by, <italic>e.g</italic>., introducing codon models (<italic>e.g</italic>., <xref ref-type="bibr" rid="c49">Yang 2006</xref>) (but see also, <italic>e.g</italic>., <xref ref-type="bibr" rid="c32">Lunter and Hein 2004</xref>; <xref ref-type="bibr" rid="c1">Arndt and Hwa 2005</xref>). The violation of the condition (i) might be tackled at least partially, if the indel rates depend on the residue states only locally, through some motifs that sparsely scatter along the sequence. Specifically, in such a case, we may first factorize the probability into the product of local contributions and then perform the &#x201C;indel-substitution factorization&#x201D; on the contributions from regions that are likely devoid of such motifs. The violation of the condition (iv) may be more prevalent and serious, especially for large-scale insertions (see, <italic>e.g</italic>., <xref ref-type="bibr" rid="c48">Waterhouse and Russell 2006</xref>; <xref ref-type="bibr" rid="c36">Morgante et al. 2007</xref>; <xref ref-type="bibr" rid="c8">Chalopin et al. 2015</xref>). Recently, analytical methods where developed for examining the effects of deviation of the inserted residue composition from the substitution-inherent residue composition (<xref ref-type="bibr" rid="c29">L&#x00E8;bre and Michel 2010</xref>, <xref ref-type="bibr" rid="c30">2013</xref>). It may be worth trying to apply some of their methods to the situations where the condition (iv) is violated. Meanwhile, some recent data analyses showed that the substitution rate increases near the sites of indels (<xref ref-type="bibr" rid="c47">Tian et al. 2008</xref>; <xref ref-type="bibr" rid="c11">De and Babu 2010</xref>). If desired, such effects could be represented in our extended theoretical formulation (described in Appendix A4 in more details), and might be handled similarly to how the violation of the aforementioned condition (i) could be remedied. It remains to be seen whether the remedial methods suggested here actually work, or otherwise whether our formulation could be modified or further extended somehow to efficiently deal with the more biologically realistic features mentioned above.</p>
</sec>
<sec id="s2b"><title>2. Incorporation of inversions and duplications</title>
<p>At least formally, the theoretical formulation developed in this paper can be extended to incorporate other genomic rearrangements (<italic>e.g</italic>., <xref ref-type="bibr" rid="c23">Gascuel 2005</xref>; <xref ref-type="bibr" rid="c26">Gu et al. 2008</xref>). Here, we discuss the incorporation of inversions (<italic>e.g</italic>., <xref ref-type="bibr" rid="c27">Kelshner and Wendel 1996</xref>; <xref ref-type="bibr" rid="c24">Graham et al. 2000</xref>) and duplications (<italic>e.g</italic>., <xref ref-type="bibr" rid="c2">Bailey and Eichler 2006</xref>; <xref ref-type="bibr" rid="c33">Lynch 2007</xref>; <xref ref-type="bibr" rid="c14">Ezawa et al. 2011</xref>), as two most important examples.</p>
<p>To incorporate inversion processes, it is convenient to extend the space state, especially <italic>S<sup>II</sup></italic> or <italic>S<sup>III</sup></italic>, to accommodate the complement of each site. Specifically, we let a superscript &#x201C; <italic>C</italic>&#x201D; indicate that the state is of a site on the complementary strand of the site before inversion. For example, <italic>&#x03C5;<sup>C</sup></italic> denotes the ancestry of the site complementary to a site with the ancestry <italic>&#x03C5;</italic> (in the space <italic>S<sup>II</sup></italic>). And (<italic>&#x03C3;</italic>,<italic>&#x03BE;</italic>)<italic><sup>C</sup></italic> denotes the attributes of the site complementary to a site with attributes (<italic>&#x03C3;</italic>,<italic>&#x03BE;</italic>) (in the space <italic>S<sup>III</sup></italic>). And we consider that the complement of the complement is the original: (<italic>X<sup>C</sup></italic>)<italic><sup>C</sup></italic> = <italic>X</italic>. To incorporate duplication processes, we also introduce another indicator, <italic>&#x03C7;</italic>, telling that the site is on the <italic>&#x03C7;</italic> th copy of the subsequence. For example, <italic>&#x03C5;</italic>.<italic>&#x03C7;</italic> represents the ancestry of the <italic>&#x03C7;</italic> th copy of the original site with the ancestry <italic>&#x03C5;</italic> (in the space <italic>S<sup>II</sup></italic>), and (<italic>&#x03C3;</italic>,<italic>&#x03BE;</italic>, <italic>&#x03C7;</italic>) represents the attribute of the <italic>&#x03C7;</italic> th copy of the original site with the attribute (<italic>&#x03C3;</italic>,<italic>&#x03BE;</italic>) (in the space <italic>S<sup>III</sup></italic>). The state spaces formed by extending the spaces <italic>S<sup>II</sup></italic> and <italic>S<sup>III</sup></italic> this way will be represented by <italic>S<sup>IIe</sup></italic> and <italic>S<sup>IIIe</sup></italic>, respectively. [NOTE: As for the state space <italic>S<sup>I</sup></italic>, we do not need to extend it to accommodate inversions and duplications; we just invert or duplicate a sub-array of <italic>unlabeled</italic> sites of a sequence, as well as the <italic>residue states</italic> filling in the sub-array.]</p>
<p>An inversion event could be depicted by an inversion operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline32.gif"/></alternatives></inline-formula>, which inverts a sub-array of sites between (and including) the <italic>x</italic><sub><italic>B</italic></sub> th and <italic>x</italic><sub><italic>E</italic></sub> th sites.</p>
<p>For example, the action of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline33.gif"/></alternatives></inline-formula> (2,4) on the basic state
<disp-formula id="eqn2_1a"><alternatives><graphic xlink:href="023622_eqn2_1a.gif"/></alternatives></disp-formula></p>
<p>In principle, we could also define the inversion of a region sticking out of either sequence end. For example, the action of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline33a.gif"/></alternatives></inline-formula> (0, 2) on the above state could be represented by something like the following:
<disp-formula id="eqn2_1b"><alternatives><graphic xlink:href="023622_eqn2_1b.gif"/></alternatives></disp-formula></p>
<p>The point is that this operation replaces the 2nd site with the complement of the 0th site. The 0th site was outside of the region under consideration, and we formally assigned it a new attribute, (3,1)<italic><sup>C</sup></italic>, before inversion. Thus, an inversion sticking out of either sequence end is effectively equivalent to a simultaneous operation of a deletion and an insertion, and also a smaller-scale inversion when the inverted region within the sequence is longer than the region sticking out. The inversion rate operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline34.gif"/></alternatives></inline-formula>, is also defined similarly to how the indel rate operator is defined via Eqs.(2.4.1a,b) of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>):
<disp-formula id="eqn2_2a"><alternatives><graphic xlink:href="023622_eqn2_2a.gif"/></alternatives></disp-formula>
with the exit rate:
<disp-formula id="eqn2_2b"><alternatives><graphic xlink:href="023622_eqn2_2b.gif"/></alternatives></disp-formula></p>
<p>If the inversion rates, <italic>r</italic><sub><italic>V</italic></sub> (<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>; <italic>s</italic>, <italic>t</italic>), are space-homogeneous, the exit rate will be an affine function of the sequence length and the probability of a LHS equivalence class of inversion processes will be factorable. Unfortunately, inversions are known to occur preferentially on palindrome sequences or between inverted repeats (<italic>e.g</italic>., <xref ref-type="bibr" rid="c27">Kelshner and Wendel 1996</xref>; <xref ref-type="bibr" rid="c26">Gu et al. 2008</xref>). Nevertheless, even if we take account of such structural dependence, the probability may be more or less factorable. This is because a simple inversion does not change the sequence length or much of the inverted repeat structure, and thus because <inline-formula><alternatives><inline-graphic xlink:href="023622_inline35.gif"/></alternatives></inline-formula> is expected to change little due to inversions.</p>
<p>A duplication event could be depicted via a duplication operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline36.gif"/></alternatives></inline-formula> or <inline-formula><alternatives><inline-graphic xlink:href="023622_inline37.gif"/></alternatives></inline-formula>, which copies the sub-array between (and ncluding) the <italic>x</italic><sub><italic>B</italic></sub> th and <italic>x</italic><sub><italic>E</italic></sub> th sites and inserts the copy between the <italic>x</italic> th and (<italic>x</italic> &#x002B;1)th sites. The &#x201C;&#x002B;&#x201D; and &#x201C;&#x2212;&#x201D; in the 1st argument represent the insertion on the original and complementary strands, respectively. For example, the actions of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline38.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline39.gif"/></alternatives></inline-formula> on the above state could be expressed as:
<disp-formula id="eqn2_3a"><alternatives><graphic xlink:href="023622_eqn2_3a.gif"/></alternatives></disp-formula>
and
<disp-formula id="eqn2_3b"><alternatives><graphic xlink:href="023622_eqn2_3b.gif"/></alternatives></disp-formula>
respectively. Again in principle, we could also define the duplication of a region sticking out of either sequence end. For example, the action of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline40.gif"/></alternatives></inline-formula> on the above state could be depicted as:
<disp-formula id="eqn2_3c"><alternatives><graphic xlink:href="023622_eqn2_3c.gif"/></alternatives></disp-formula></p>
<p>Again, the 0th site was out of consideration before the event, and thus was assigned a new attribute, (3,1), when inserted. In general, the duplication of a region sticking out of either sequence end is effectively equivalent to the simultaneous operation of a duplication of the region within the sequence and an adjacent insertion of a new subsequence. Furthermore, we could define the duplication of a region totally out of the sequence under consideration, <italic>i.e</italic>., <italic>r</italic><sub><italic>C</italic></sub> (<italic>&#x03B5;</italic>, <italic>x</italic>, [<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>]) with <italic>&#x03B5;</italic> &#x2208; {&#x002B;, &#x2212;} and with either <italic>x</italic><sub><italic>B</italic></sub> &#x2264; <italic>x</italic><sub><italic>E</italic></sub> <bold>&#x003C;</bold> 1 or <italic>L</italic>(<italic>s</italic>) <bold>&#x003C;</bold> <italic>x</italic><sub><italic>B</italic></sub> &#x2264; <italic>x</italic><sub><italic>E</italic></sub>. Under the current formulation, its effect is indistinguishable from that of the insertion, <italic>r</italic><sub><italic>I</italic></sub> (<italic>x</italic>, <italic>x</italic><sub><italic>E</italic></sub> &#x2212; <italic>x</italic><sub><italic>B</italic></sub> &#x002B;1). Using these duplication operators, the duplication rate operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline41.gif"/></alternatives></inline-formula>, could be defined as:
<disp-formula id="eqn2_4a"><alternatives><graphic xlink:href="023622_eqn2_4a.gif"/></alternatives></disp-formula>
with the duplication exit rate:
<disp-formula id="eqn2_4b"><alternatives><graphic xlink:href="023622_eqn2_4b.gif"/></alternatives></disp-formula></p>
<p>If the duplication rates, <italic>r</italic><sub><italic>C</italic></sub> (<italic>&#x03B5;</italic>, <italic>x</italic>, [<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>]), are space-homogeneous, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline42.gif"/></alternatives></inline-formula> should ecome an affine function of the sequence length, and the probability of a LHS equivalence class of duplication processes could be factorable. But, again, it is unlikely that the duplication rates are space-homogeneous, because duplications preferentially occur between direct repeat motifs (<italic>e.g</italic>., <xref ref-type="bibr" rid="c2">Bailey and Eichler 2006</xref>; <xref ref-type="bibr" rid="c26">Gu et al. 2008</xref>). It remains to be seen whether the probability is still factorable or not even after taking account of this factor. But some situations with interspersed repeat motifs may be modeled as in Eqs.(5.3.2a,b,c) in part I, at least to some degree, and thus the probabilities may be partially factorable.</p>
<p>Some transposon insertions (<italic>e.g</italic>., <xref ref-type="bibr" rid="c36">Morgante et al. 2007</xref>; <xref ref-type="bibr" rid="c8">Chalopin et al. 2015</xref>) are essentially duplications (via copy-and-paste mechanisms). Thus, in some cases it might be beneficial to regard the transposons as duplicated using the formulation explained here, rather than handling them as simple insertions. On the other hand, the latter could be done in principle by associating particular sets of residue configurations with elevated insertion rates, via the theoretical formulation briefed in Section 1. Their description as duplications would be beneficial especially when two or more transposons belonging to the same family were inserted into positions that are close to each other, because they could induce secondary genomic rearrangements.</p>
<p>In a traditional alignment (PWA or MSA), an inversion should manifest itself as a pair of equally long gapped regions, interpreted as a deletion and an adjacent insertion, and it will normally be penalized twice. Moreover, commonly used aligners will ignore the fact that the reverse complement of the inverted region can be well aligned with its original region. Meanwhile, a duplication event should cause a gap in a normal alignment, and will be interpreted as an insertion. However, unless we take account of the fact that the duplicated region is in fact homologous to, and thus can be aligned with, its original region, the resulting alignment could often be erroneous. Therefore, by taking explicit account of inversions and deletions when reconstructing an alignment, its accuracy might improve substantially. This kind of attempts has only a short history (see, <italic>e.g</italic>, <xref ref-type="bibr" rid="c37">Paten et al. 2008b</xref>, and references therein). The theoretical formulation briefed in this subsection may be conducive to the development of likelihood-based (or Bayesian-based) alignment programs that also take account of genomic rearrangements other than indels. To do so, the rate parameters, such as <italic>r</italic><sub><italic>V</italic></sub> (<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>; <italic>s</italic>, <italic>t</italic>) and <italic>r</italic><sub><italic>C</italic></sub> (<italic>&#x03B5;</italic>, <italic>x</italic>, [<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>]), will have to be estimated accurately. It would probably be difficult to estimate them directly from the sequence data to be analyzed, because the events are relatively rare. Thus, it would be helpful to estimate the parameter distribution, or relative rates as functions of the length of the duplicated/inverted region, the distance between the original region and the copy-insertion point, residue states of the flanking regions, etc., by analyzing genome-wide data from a large sample of organisms (or individuals from populations). Although the broad dependences of the duplication frequency on the original-copy distance and the orientation were examined in the past (<italic>e.g</italic>., <xref ref-type="bibr" rid="c14">Ezawa et al. 2011</xref>), more extensive and thorough analyses will be necessary.</p>
<p>At the population genetic level, genome rearrangements are observed as genomic structural variations (SVs), including copy number variations (CNVs) (<italic>e.g</italic>., <xref ref-type="bibr" rid="c42">Teshima and Innan 2012</xref>; <xref ref-type="bibr" rid="c15">Ezawa et al. 2013</xref>). In some aspects, population genetics could be regarded as molecular evolution on a very short time scale. Thus, the theoretical formulation unfolded in this paper may be applicable, possibly via some modifications, to the analyses of SVs as well.</p>
</sec>
<sec id="s2c"><title>3. Other mutational mechanisms</title>
<p>Mechanisms of genomic mutations are not limited to substitutions and genome rearrangements. Among the most important ones would be recombination (<italic>e.g</italic>., <xref ref-type="bibr" rid="c41">Saitou and Kitano 2013</xref>) and gene conversion (<italic>e.g</italic>., <xref ref-type="bibr" rid="c9">Chen et al. 2007</xref>; <xref ref-type="bibr" rid="c13">Ezawa et al. 2010</xref>; <xref ref-type="bibr" rid="c20">Fawcett and Innan 2013</xref>). Out of them, inter-locus gene conversion (<italic>e.g</italic>., <xref ref-type="bibr" rid="c13">Ezawa et al. 2010</xref>; <xref ref-type="bibr" rid="c20">Fawcett and Innan 2013</xref>) may be depicted via something similar to the duplication operator proposed in Section 2, but with a modification. Specifically, instead of inserting a sub-sequence, a gene-conversion operator must make a sub-sequence replace another region that is usually paralogous. This description will work as long as the interacting regions are both within a single sequence to be analyzed. However, recombination between alleles (<italic>e.g</italic>., <xref ref-type="bibr" rid="c41">Saitou and Kitano 2013</xref>), including inter-allelic gene conversion (<italic>e.g</italic>., <xref ref-type="bibr" rid="c9">Chen et al. 2007</xref>), is a mechanism involving two orthologous sequences, and thus the above description will not be na&#x00EF;vely applicable to it. The description will not be applicable to inter-locus gene conversion, either, if one of the interacting regions is out of the subject sequence. A possible way to handle these cases would be to allow the phylogenetic tree to take different topologies and/or branch lengths in different regions of the sequence, as implemented in the molecular evolution simulator, Dawg (<xref ref-type="bibr" rid="c6">Cartwright 2005</xref>). This measure should work especially when the alignment probability is factorable.</p>
<p>The copy number change of short tandem repeats, or microsatellites, is another important mutational mechanism (<italic>e.g</italic>., <xref ref-type="bibr" rid="c12">Ellegren 2004</xref>; <xref ref-type="bibr" rid="c40">Sainudiin et al. 2004</xref>). However, the evolution of microsatellites would be quite refractory to a na&#x00EF;ve analysis, because they have quite high mutation rates and show complex mutation patterns (<italic>e.g</italic>., <xref ref-type="bibr" rid="c12">Ellegren 2004</xref>; <xref ref-type="bibr" rid="c40">Sainudiin et al. 2004</xref>). Thus, unless we are handling very short-term sequence evolution, we should avoid using the perturbation theory developed in this paper. Instead, we should try to solve &#x201C;exactly,&#x201D; maybe via a numerical computation, an empirical evolutionary model of microsatellite evolution (<italic>e.g</italic>., <xref ref-type="bibr" rid="c40">Sainudiin et al. 2004</xref>). Our current hunch is that, as far as an accurate alignment reconstruction is concerned, a best way would be to remove alleged microsatellites from the sequences before aligning them.</p>
</sec>
<sec id="s2d"><title>4. Boundary conditions and cut-off lengths</title>
<p>In this study, as in the previous studies (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>,<xref ref-type="bibr" rid="c17">b</xref>,<xref ref-type="bibr" rid="c18">c</xref>), we only considered simple boundary conditions. Each sequence end was either freely mutable or flanked by a biologically essential region that allows no indels. Moreover, the constant cutoff lengths were introduced just for the sake of simplicity, to broadly take account of the effects of various factors that suppress very long rearrangements (such as selection, chromosome size, genome stability, etc.). In real sequence analyses, however, the situations are unlikely to be so simple. (See Discussion of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>) for more details.) In order to pursue further biological realism and to enable further accurate sequence analyses, it would be inevitable to address these issues seriously.</p>
</sec>
</sec>
<sec id="s3"><title>Conclusions</title>
<p>In a previous study (<xref ref-type="bibr" rid="c16">Ezawa, Graur, and Landan 2015a</xref>), we established the theoretical basis of an <italic>ab initio</italic> perturbative formulation of a general continuous-time Markov model, which is a <italic>genuine</italic> stochastic model describing the evolution of an <italic>entire</italic> sequence via indels along the time axis. Then, in two other previous studies (<xref ref-type="bibr" rid="c17">Ezawa, Graur, and Landan 2015b</xref>,<xref ref-type="bibr" rid="c18">c</xref>), we demonstrated how we can analytically and computationally calculate the probabilities of concrete alignments via our formulation. In these previous studies, we dealt only with insertions/deletions (indels), mainly for clarity of the arguments.</p>
<p>Here in this study, we attempted to incorporate other types of mutations into our <italic>ab initio</italic> perturbative formulation of a <italic>genuine</italic> evolutionary model. We first extended the model to accommodate substitutions. We showed that, under a set of conditions on the model parameters similar to that for the pure indel model, the probability of an alignment is factorable into local contributions also in this extended model. We also gave a set of conditions under which an alignment probability is factorable into the product of an &#x201C;indel component&#x201D; and a &#x201C;substitution component.&#x201D; We next showed how our evolutionary model can be extended to accommodate two other types of genomic rearrangements, namely, inversions and duplications. We also discussed how to handle other types of mutations such as recombination within the framework of our formulation. Thus, at least in principle, our <italic>ab initio</italic> perturbative formulation could describe the evolution of an <italic>entire</italic> sequence via any major types of mutations along the time axis. It still remains to be seen whether all of these suggested extensions are <italic>computationally</italic> feasible and useful for <italic>practical</italic> sequence analyses, such as the reconstruction of generalized multiple sequence alignments (MSAs). If this proves to be the case, however, our formulation could open up a new venue for the theoretical study of sequence evolution.</p>
</sec>
</body>
<back>
<sec id="s4"><title>Authors&#x2019; contributions</title>
<p>KE conceived of and mathematically formulated the theoretical framework in this paper, implemented the key algorithms, participated in designing the study, performed all the mathematical analyses, and drafted the manuscript. DG and GL participated in designing the study, helped with the interpretation of the data, and helped with the drafting of the manuscript.</p>
</sec>
<ack><title>Acknowledgements</title>
<p>This study is dedicated to the late Dr. Keiji Kikkawa, who was a renowned theoretical physicist, one of the key pioneers of the string field theory of the elementary particle physics, and the best ever mentor of K.E. We are grateful to Dr. R. A. Cartwright at Arizona State University for his useful information and discussions that inspired this study. We appreciate the logistic support and the feedback of Dr. Tetsushi Yada at the Kyushu Institute of Technology. We would also like to thank the three anonymous referees of the predecessor manuscript entitled: &#x201C;Framework that enables approximate lilelihood analysis of insertions/deletions on multiple sequence alignment.&#x201D; Their comments helped drastically improve the study itself, not to mention the manuscript. This work was a part of the project, &#x201C;Error Correction in Multiple Sequence Alignments,&#x201D; which was funded by US National Library of Medicine [grant number LM010009-01 to Dan Graur and Giddy Landan at the University of Houston]. The later stage of this work was also supported by Grants-in-Aid No. 221S0002, which was awarded to Tetsushi Yada by the Ministry of Education, Culture, Sports, Science and Technology of Japan.</p>
</ack>
<sec id="s5"><title>Appendix</title>
<p>Here we give detailed arguments regarding the incorporation of substitutions into our theoretical formulation, as briefly described in Section 1 of Results. We first explain how to extend our formulation to incorporate substitutions in Section A1. Then, in Section A2, we will examine the conditions under which the probability of each alignment is factorable into the product of contributions from regions delimited by preserved ancestral sites (PASs). Next, in Section A3, we will examine the conditions under which the probability of each alignment can be factorized into the &#x201C;basic&#x201D; component concerning the indels and the residue component concerning the substitutions (and the initial residue state distribution at each site). Finally, in Section A4, we will discuss how to pursue the biological realism further.</p>
<sec id="s5a"><title>A1. Formulating sequence evolution via both indels and substitutions</title>
<p>In order to incorporate substitutions into our theoretical formulation of sequence evolution via indels, we first extend the sequence state space <italic>S</italic> (= <italic>S<sup>I</sup></italic>, <italic>S<sup>II</sup></italic>, <italic>or S<sup>III</sup></italic>) so that each site of the sequence will accommodate a residue in the set &#x2126;. (See Subsection 2.1 of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>) for details on the original sate spaces <italic>S<sup>I</sup></italic>, <italic>S<sup>II</sup> and S<sup>III</sup></italic>.) When <italic>S</italic> = <italic>S<sup>I</sup></italic>(&#x2245;N<sub>0</sub> &#x2261; {0,1, 2,&#x2026;}), the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline43.gif"/></alternatives></inline-formula>, in which each site is assigned a residue <italic>&#x03C9;</italic> &#x2208; &#x2126;. When <italic>S</italic> = <italic>S<sup>II</sup>(</italic>&#x2282; &#x03D2;<sup>&#x002A;</sup>), the ancestry assigned to each site, <italic>&#x03C5;</italic> &#x2208;&#x03D2;, is replaced with a pair, (<italic>&#x03C5;</italic>, <italic>&#x03C9;</italic>) &#x2208;&#x03D2; &#x00D7;&#x2126;. Thus, the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline44.gif"/></alternatives></inline-formula>. Similarly, when <italic>S</italic> = <italic>S<sup>III</sup></italic> (&#x2282; {N<sub>0</sub>&#x00D7; N<sub>1</sub>}&#x002A;), the extended space is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline45.gif"/></alternatives></inline-formula>, in which each site is assigned a trio, (<italic>&#x03C3;</italic>, <italic>&#x03BE;</italic>, <italic>&#x03C9;</italic>) &#x2208; N<sub>0</sub>&#x00D7; N<sub>1</sub>&#x00D7;&#x2126;. (Here <italic>&#x03C3;</italic> is the source identifier of the initial or inserted (sub)sequence, and <italic>&#x03BE;</italic> is the relative coordinate within the initial or inserted (sub)sequence.) An extended sequence state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline46.gif"/></alternatives></inline-formula> will sometimes be represented as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline47.gif"/></alternatives></inline-formula> to explicitly show that it is composed of a &#x201C;basic&#x201D; component <italic>s</italic> &#x2208; <italic>S</italic> and a residue component <inline-formula><alternatives><inline-graphic xlink:href="023622_inline48.gif"/></alternatives></inline-formula>. (Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline49.gif"/></alternatives></inline-formula> is the length of the sequence state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline278.gif"/></alternatives></inline-formula>.) Once we extended the sequence state space, we can now extend the indel rate operator (defined in Eqs.(2.4.2a-d) of part I). This is done in two steps: (1) adding the substitution component to the rate operator; and (2) extending the indel component to take explicit account of the residue dependence of indels.</p>
<p>First, we add the substitution component of the rate operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline50.gif"/></alternatives></inline-formula>, to the indel component, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline51.gif"/></alternatives></inline-formula> (defined in Eqs.(2.4.2a-d) of part I). This yields the total mutation rate operator:
<disp-formula id="eqnA1_1"><alternatives><graphic xlink:href="023622_eqnA1_1.gif"/></alternatives></disp-formula></p>
<p>Similarly to the derivation of Eqs.(2.4.2a-d) of part I, the substitution component is written as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline52.gif"/></alternatives></inline-formula> is the substitution rate operator defined on a sequence of length <italic>L</italic>. If we allow only for a single residue substitution at a time, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline53.gif"/></alternatives></inline-formula> is expanded as: <inline-formula><alternatives><inline-graphic xlink:href="023622_inline54.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xlink:href="023622_inline55.gif"/></alternatives></inline-formula> is the operator representing the effect of a substitution at the <italic>x</italic> th site at time <italic>t</italic>. Let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline56.gif"/></alternatives></inline-formula> be the operator representing the substitution from the residue <italic>&#x03C9;</italic> to <italic>&#x03C9;</italic>&#x2032; (&#x2260; <italic>&#x03C9;</italic>) at the <italic>x</italic> th site. And let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline57.gif"/></alternatives></inline-formula> be the residue state at the <italic>x</italic> th site of a sequence with the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline58.gif"/></alternatives></inline-formula>. Then, in general, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline59.gif"/></alternatives></inline-formula> is defined by the following action on the extended sequence states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline60.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023622_inline61.gif"/></alternatives></inline-formula>:
<disp-formula id="eqnA1_2"><alternatives><graphic xlink:href="023622_eqnA1_2.gif"/></alternatives></disp-formula></p>
<p>Here the position-specific exit rate, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline62.gif"/></alternatives></inline-formula> <italic>is</italic> made of the substitution rates at the <italic>x</italic> th site, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline63.gif"/></alternatives></inline-formula>, which could in general depend on the extended sequence state, site position, and time. In the special case where all indel rates are zero, the sequence states keep their length and the ancestries <italic>&#x03C5;<sub>x</sub></italic> (or attributes (<italic>&#x03C3; <sub>x</sub></italic>, <italic>&#x03BE;<sub>x</sub></italic>)) of the sites intact. Thus, the total stochastic evolution operator of the system <inline-formula><alternatives><inline-graphic xlink:href="023622_inline64.gif"/></alternatives></inline-formula> is given solely by its substitution component, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline65.gif"/></alternatives></inline-formula>. (Here <italic>T</italic> {&#x2026;} denotes the time-ordered product. See below Eq.(1.1.11) of part I for details.) If desired, we can decompose the substitution rate operator as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline66.gif"/></alternatives></inline-formula>. Here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline67.gif"/></alternatives></inline-formula> is a linear combination of substitution operators, and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline68.gif"/></alternatives></inline-formula> keeps the residue state unchanged while letting the probability decay at the exit rate. Then, in the same line of reasoning as in Subsection 4.1 of part I, the conditional probability <inline-formula><alternatives><inline-graphic xlink:href="023622_inline69.gif"/></alternatives></inline-formula> can be factorized into the product of multiplication factors, each of which is contributed from a region that is independent of the others. Actually, in this case, the stochastic evolution operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline70.gif"/></alternatives></inline-formula> itself becomes factorable into a tensor product, as long as no mutation changes the interdependence structure among the substitution rates at different sites. Especially, when each of the substitution rates depends only on the state at the site of the substitution, <italic>e.g.</italic>, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline71.gif"/></alternatives></inline-formula>, we have:
<disp-formula id="eqnA1_3"><alternatives><graphic xlink:href="023622_eqnA1_3.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline72.gif"/></alternatives></inline-formula>, supplemented by <xref ref-type="disp-formula" rid="eqnA1_2">Eq.(A1.2)</xref>, is the stochastic operator describing the evolution of the <italic>x</italic> th site via substitutions during the time interval [<italic>t</italic>, <italic>t</italic><bold>&#x2032;</bold>]. At least conceptually, <xref ref-type="disp-formula" rid="eqnA1_3">Eq.(A1.3)</xref> should be familiar to many researchers of molecular evolution (<italic>e.g</italic>., <xref ref-type="bibr" rid="c21">Felsenstein 1981</xref>, <xref ref-type="bibr" rid="c22">2004</xref>; <xref ref-type="bibr" rid="c49">Yang 2006</xref>).</p>
<p>Second, we extend the indel component of the rate operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline73.gif"/></alternatives></inline-formula> (given in Eqs.(2.4.2a-d) of part I), so that it will take <italic>explicit</italic> account of the possible residue state dependence of indels. First of all, we replace the summations, such as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline74.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline75.gif"/></alternatives></inline-formula>, with the extended ones, <italic>i.e</italic>., <inline-formula><alternatives><inline-graphic xlink:href="023622_inline76.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline77.gif"/></alternatives></inline-formula>. Then, consider the operations of indels on the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline78.gif"/></alternatives></inline-formula>, as well as their rates. Regarding deletions, it is easy; we just need to extend the deletion rates <italic>r</italic><sub><italic>D</italic></sub> (<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>; <italic>s</italic>, <italic>t</italic>) to <italic>r</italic><sub><italic>D</italic></sub> (<italic>x</italic><sub><italic>B</italic></sub>, <italic>x</italic><sub><italic>E</italic></sub>; <inline-formula><alternatives><inline-graphic xlink:href="023622_inline279.gif"/></alternatives></inline-formula>, <italic>t</italic>), which explicitly depend also on the residue state component <inline-formula><alternatives><inline-graphic xlink:href="023622_inline79.gif"/></alternatives></inline-formula> of the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline80.gif"/></alternatives></inline-formula>. Regarding insertions, however, we need something more. We first introduce a new operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline81.gif"/></alternatives></inline-formula>, that fills in an array of newly inserted sites, from the (<italic>x</italic> &#x002B;1) th through the (<italic>x</italic> &#x002B; <italic>l</italic>) th sites in the post-insertion sequence, with an array of residues, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline82.gif"/></alternatives></inline-formula>. In other words, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline83.gif"/></alternatives></inline-formula> inserts <inline-formula><alternatives><inline-graphic xlink:href="023622_inline84.gif"/></alternatives></inline-formula> between the <italic>x</italic> th and (<italic>x</italic> &#x002B;1) th residues of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline85.gif"/></alternatives></inline-formula>. Then, we replace the term <italic>r</italic><sub><italic>I</italic></sub> (<italic>x</italic>, <italic>l</italic>; <italic>s</italic>, <italic>t</italic>) <inline-formula><alternatives><inline-graphic xlink:href="023622_inline86.gif"/></alternatives></inline-formula> in Eq.(2.4.2b) of part I with <inline-formula><alternatives><inline-graphic xlink:href="023622_inline87.gif"/></alternatives></inline-formula>. And we also replace <italic>r</italic><sub><italic>I</italic></sub> (<italic>x</italic>, <italic>l</italic>; <italic>s</italic>, <italic>t</italic>) in the exit rate (Eq.(2.4.1b) or Eq.(2.4.1b&#x2019;) of part I) with <inline-formula><alternatives><inline-graphic xlink:href="023622_inline88.gif"/></alternatives></inline-formula>. If there is no correlation between the <inline-formula><alternatives><inline-graphic xlink:href="023622_inline89.gif"/></alternatives></inline-formula> to be inserted and the state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline90.gif"/></alternatives></inline-formula> to undergo the insertion, the dependence of the rates on them could be decoupled as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline91.gif"/></alternatives></inline-formula>. Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline92.gif"/></alternatives></inline-formula> is the probability (or the relative frequency) that <inline-formula><alternatives><inline-graphic xlink:href="023622_inline93.gif"/></alternatives></inline-formula> is inserted at time <italic>t</italic>, conditioned on the insertion of <italic>l</italic> sites. (The conditional probabilities satisfy <inline-formula><alternatives><inline-graphic xlink:href="023622_inline94.gif"/></alternatives></inline-formula>. This implies that <italic>r</italic><sub><italic>I</italic></sub> (<italic>x</italic>, <italic>l</italic>; <italic>s</italic>, <italic>t</italic>) used in the bulk of the paper were something like <inline-formula><alternatives><inline-graphic xlink:href="023622_inline95.gif"/></alternatives></inline-formula> above, considering that the former already <italic>implicitly</italic> depended on the residue states of the sequence before insertion. If the above decoupling holds, and if the dependence on the inserted residues can be factorized as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline96.gif"/></alternatives></inline-formula>, then the inserted residues could be handled as were done in the past (<italic>e.g</italic>., <xref ref-type="bibr" rid="c45">Thorne et al. 1991</xref>, <xref ref-type="bibr" rid="c46">1992</xref>; <xref ref-type="bibr" rid="c34">Mikl&#x00F3;s et al. 2004</xref>; <xref ref-type="bibr" rid="c39">Rivas and Eddy 2008</xref>). Here <italic>&#x03C0;</italic>(<italic>&#x03C9;</italic>) is the equilibrium frequency of a residue <italic>&#x03C9;</italic> (with &#x03A3;<sub>&#x03C9;&#x2208;&#x03A9;</sub> <italic>&#x03C0;</italic>(<italic>&#x03C9;</italic>) = 1) under a time-reversible substitution model.</p>
</sec>
<sec id="s5b"><title>A2. Factorizing probability into regional contributions</title>
<p>The perturbation theory unfolded in this paper can also be applied, with some extensions, to the entire model defined by the rate operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline97.gif"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn1_1">Eq.(1.1)</xref> of Results (<italic>i.e</italic>., <xref ref-type="disp-formula" rid="eqnA1_1">Eq.(A1.1))</xref>. Because indels are much less frequent than substitutions, a natural way would be to separate <inline-formula><alternatives><inline-graphic xlink:href="023622_inline98.gif"/></alternatives></inline-formula> as:
<disp-formula id="eqnA2_1a"><alternatives><graphic xlink:href="023622_eqnA2_1a.gif"/></alternatives></disp-formula></p>
<p>Here
<disp-formula id="eqnA2_1b"><alternatives><graphic xlink:href="023622_eqnA2_1b.gif"/></alternatives></disp-formula>
describes the sequence evolution via no indels. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline99.gif"/></alternatives></inline-formula>, which is the aforementioned extension of Eq.(3.1.1c) of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>), describes the sequence change via an insertion or a deletion. The point is that the <italic>entire</italic> substitution rate operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline100.gif"/></alternatives></inline-formula> is included in the &#x201C;unperturbed&#x201D; part of the rate operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline101.gif"/></alternatives></inline-formula>, and that <italic>only</italic> insertions/deletions are regarded as &#x201C;perturbations.&#x201D; Then, the perturbation expansion of the <italic>entire</italic> stochastic evolution operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline102.gif"/></alternatives></inline-formula>, is given by Eq.(3.1.3) of part I with the extension of the state space and with
<disp-formula id="eqnA2_2"><alternatives><graphic xlink:href="023622_eqnA2_2.gif"/></alternatives></disp-formula></p>
<p>The Eq.(3.1.13) of part I for the probability of a PWA between an ancestral and a descendant sequence, <italic>P</italic>[(<italic>&#x03B1;</italic>(<italic>s<sup>A</sup></italic>, <italic>s<sup>D</sup></italic>), [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>])&#x007C;(<italic>s<sup>A</sup></italic>, <italic>t</italic><sub><italic>I</italic></sub>)], can also be extended as follows:
<disp-formula id="eqnA2_3a"><alternatives><graphic xlink:href="023622_eqnA2_3a.gif"/></alternatives></disp-formula></p>
<p>Here we let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline103.gif"/></alternatives></inline-formula> (<italic>v</italic> = 1, 2,&#x2026;, <italic>N</italic>) be the extended sequence state &#x201C;at the time of&#x201D; the event <inline-formula><alternatives><inline-graphic xlink:href="023622_inline104.gif"/></alternatives></inline-formula>, or, more precisely, the state immediately before and after the event if the event is a deletion and an insertion, respectively. We also let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline105.gif"/></alternatives></inline-formula> be the number of sites in <inline-formula><alternatives><inline-graphic xlink:href="023622_inline106.gif"/></alternatives></inline-formula>. Let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline107.gif"/></alternatives></inline-formula> and <italic>s <sub>v</sub></italic> &#x2208; <italic>S</italic>, respectively, be the residue state component and the basic component of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline108.gif"/></alternatives></inline-formula>. And let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline109.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline110.gif"/></alternatives></inline-formula>, respectively, denote the extended sequence states immediately after and before the time <italic>t</italic><sub><italic>v</italic></sub> of the event <inline-formula><alternatives><inline-graphic xlink:href="023622_inline111.gif"/></alternatives></inline-formula> within an evolutionary process. Then, we have <inline-formula><alternatives><inline-graphic xlink:href="023622_inline112.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline113.gif"/></alternatives></inline-formula> respectively, when <inline-formula><alternatives><inline-graphic xlink:href="023622_inline114.gif"/></alternatives></inline-formula> is a deletion and insertion. This choice of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline116.gif"/></alternatives></inline-formula> automatically takes account of the summations over <inline-formula><alternatives><inline-graphic xlink:href="023622_inline117.gif"/></alternatives></inline-formula> filled in by the accompanying operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline118.gif"/></alternatives></inline-formula> when <inline-formula><alternatives><inline-graphic xlink:href="023622_inline119.gif"/></alternatives></inline-formula>. Moreover, we also used the representation <inline-formula><alternatives><inline-graphic xlink:href="023622_inline120.gif"/></alternatives></inline-formula>, with <inline-formula><alternatives><inline-graphic xlink:href="023622_inline121.gif"/></alternatives></inline-formula>, and, similarly, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline122.gif"/></alternatives></inline-formula>. Each summand on the right hand_side of <xref ref-type="disp-formula" rid="eqnA2_3a">Eq.(A2.3a)</xref> represents the probability, conditioned on an ancestral state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline123.gif"/></alternatives></inline-formula> at time <italic>t</italic><sub><italic>I</italic></sub>, that we have the following 3 outcomes at the same time: (1) an indel history <inline-formula><alternatives><inline-graphic xlink:href="023622_inline124.gif"/></alternatives></inline-formula> consistent with <italic>&#x03B1;</italic>(<italic>s<sup>A</sup></italic>, <italic>s<sup>D</sup></italic>) occurred during the time interval [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>]; (2) an array of residue states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline125.gif"/></alternatives></inline-formula> was observed &#x201C;at the time of&#x201D; each event <inline-formula><alternatives><inline-graphic xlink:href="023622_inline126.gif"/></alternatives></inline-formula>; and (3) a descendant array of residue states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline127.gif"/></alternatives></inline-formula> resulted at time <italic>t</italic><sub><italic>F</italic></sub>. The summand is an extension of Eq.(3.1.8b) of part I and is specifically expressed as:
<disp-formula id="eqnA2_3b"><alternatives><graphic xlink:href="023622_eqnA2_3b.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline128.gif"/></alternatives></inline-formula> denotes <inline-formula><alternatives><inline-graphic xlink:href="023622_inline129.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline130.gif"/></alternatives></inline-formula> respectively, if <inline-formula><alternatives><inline-graphic xlink:href="023622_inline131.gif"/></alternatives></inline-formula> is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline132.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline133.gif"/></alternatives></inline-formula>. (Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline134.gif"/></alternatives></inline-formula> denotes an array of residues filling in the sites inserted by <inline-formula><alternatives><inline-graphic xlink:href="023622_inline135.gif"/></alternatives></inline-formula>. When <inline-formula><alternatives><inline-graphic xlink:href="023622_inline136.gif"/></alternatives></inline-formula>, the combination of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline137.gif"/></alternatives></inline-formula>, the insertion position (<italic>x</italic>), and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline138.gif"/></alternatives></inline-formula> holds information equivalent to that of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline139.gif"/></alternatives></inline-formula>.) We also used the notation, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline140.gif"/></alternatives></inline-formula> if <inline-formula><alternatives><inline-graphic xlink:href="023622_inline141.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline142.gif"/></alternatives></inline-formula> (<italic>i.e</italic>., does nothing) if <inline-formula><alternatives><inline-graphic xlink:href="023622_inline143.gif"/></alternatives></inline-formula>. The factor <inline-formula><alternatives><inline-graphic xlink:href="023622_inline144.gif"/></alternatives></inline-formula> is an extension of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline145.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023622_inline146.gif"/></alternatives></inline-formula> in Eq.(3.1.8b) of part I. (Here, the notation of the latter was changed from the original, to fit in context.) It should be noted that, in the evolutionary process under consideration, the basic state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline147.gif"/></alternatives></inline-formula> remained unchanged during the open time interval (<italic>t</italic><sub><italic>v</italic></sub>, <italic>t</italic><sub>v&#x002B;1</sub>). Thus, during this time interval, the evolutionary changes of the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline148.gif"/></alternatives></inline-formula> are limited to changes in the residue state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline149.gif"/></alternatives></inline-formula> purely via substitutions. In a special case where the indel exit rate, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline150.gif"/></alternatives></inline-formula>, is independent of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline151.gif"/></alternatives></inline-formula> (and thus depends only on <italic>s</italic>(<italic>t</italic>) and <italic>t</italic>), the factor is calculated as:
<disp-formula id="eqnA2_4"><alternatives><graphic xlink:href="023622_eqnA2_4.gif"/></alternatives></disp-formula></p>
<p>Its only difference from the factor in Eq.(3.1.8b) of part I is the multiplication by the transition probability from <inline-formula><alternatives><inline-graphic xlink:href="023622_inline152.gif"/></alternatives></inline-formula> to <inline-formula><alternatives><inline-graphic xlink:href="023622_inline153.gif"/></alternatives></inline-formula> via substitutions. In more general cases where the indel exit rate <inline-formula><alternatives><inline-graphic xlink:href="023622_inline154.gif"/></alternatives></inline-formula> could depend on the residue state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline155.gif"/></alternatives></inline-formula>, we will decompose the substitution rate operator as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline156.gif"/></alternatives></inline-formula> as argued above on the pure substitution case, and follow a line of argument similar to that in Subsection 3.1 of part I. Let <inline-formula><alternatives><inline-graphic xlink:href="023622_inline157.gif"/></alternatives></inline-formula> be the set of all substitution histories consistent with the gap-free (<italic>i.e</italic>., trivial) PWA, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline158.gif"/></alternatives></inline-formula>, between the residue states at the time boundaries. Then, we get:
<disp-formula id="eqnA2_5a"><alternatives><graphic xlink:href="023622_eqnA2_5a.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline159.gif"/></alternatives></inline-formula>(with <italic>v</italic>&#x2032; = 1,&#x2026;, <italic>N</italic><sub><italic>v</italic></sub>) is the <italic>v</italic>&#x2032; th substitution event, like <inline-formula><alternatives><inline-graphic xlink:href="023622_inline160.gif"/></alternatives></inline-formula> above, in a substitution history during the open time interval (<italic>t</italic><sub><italic>v</italic></sub>, <italic>t</italic><sub><italic>v</italic>&#x002B;1</sub>). <italic>t</italic><sub><italic>v</italic>; <italic>v</italic>&#x02032;</sub> is the time at which the <italic>v</italic>&#x2032; th event occurred. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline161.gif"/></alternatives></inline-formula> is the residue state of the sequence immediately after the <italic>v</italic>&#x2032; th event, with an exception <inline-formula><alternatives><inline-graphic xlink:href="023622_inline162.gif"/></alternatives></inline-formula>. Also, <italic>&#x03C1;<sub>P</sub></italic> [&#x2026;] in <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5a)</xref> is the probability density of the substitution process <inline-formula><alternatives><inline-graphic xlink:href="023622_inline163.gif"/></alternatives></inline-formula>, conditioned on the initial residue state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline164.gif"/></alternatives></inline-formula>. It is formally similar to the integrand in Eq.(3.1.8b) of part I, and is given by:
<disp-formula id="eqnA2_5b"><alternatives><graphic xlink:href="023622_eqnA2_5b.gif"/></alternatives></disp-formula>
where we used the same notation as in <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5a)</xref>. The symbol <inline-formula><alternatives><inline-graphic xlink:href="023622_inline165.gif"/></alternatives></inline-formula> denotes the rate parameter of the substitution <inline-formula><alternatives><inline-graphic xlink:href="023622_inline166.gif"/></alternatives></inline-formula> on the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline167.gif"/></alternatives></inline-formula> at time <italic>t</italic>. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline168.gif"/></alternatives></inline-formula> is the substitution exit rate of the extended state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline169.gif"/></alternatives></inline-formula> at time <italic>t</italic>. When deriving <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5b)</xref>, we used the equation: <inline-formula><alternatives><inline-graphic xlink:href="023622_inline170.gif"/></alternatives></inline-formula>. <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5a)</xref> suggests that the factor <inline-formula><alternatives><inline-graphic xlink:href="023622_inline171.gif"/></alternatives></inline-formula> is a weighted summation of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline172.gif"/></alternatives></inline-formula> over all substitution processes (each represented by a trajectory <inline-formula><alternatives><inline-graphic xlink:href="023622_inline173.gif"/></alternatives></inline-formula> consistent with the (trivial) PWA, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline174.gif"/></alternatives></inline-formula>, with the weights given by the probability densities of the processes. Because <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5a)</xref> supplemented with <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5b)</xref> is similar in form to Eq.(3.1.13) of part I supplemented with Eq.(3.1.8b) of part I, a reasoning similar to that in Subsection 4.1 of part I is also applicable when examining the factorability of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline175.gif"/></alternatives></inline-formula>. We see that it is factorable into the product of an overall factor and contributions from separate regions if the two conditions are met. (i) The rate parameter <inline-formula><alternatives><inline-graphic xlink:href="023622_inline176.gif"/></alternatives></inline-formula> of every substitution <inline-formula><alternatives><inline-graphic xlink:href="023622_inline177.gif"/></alternatives></inline-formula> in each region is independent of the portions of the residue states in the other regions. And (ii) the increment of the total exit rate <inline-formula><alternatives><inline-graphic xlink:href="023622_inline178.gif"/></alternatives></inline-formula>, caused by every substitution <inline-formula><alternatives><inline-graphic xlink:href="023622_inline179.gif"/></alternatives></inline-formula> in each region, is independent of the portions of the residue states in the other regions.</p>
<p>Then, substituting the factorized <xref ref-type="disp-formula" rid="eqnA2_5a">Eq.(A2.5a)</xref> for <inline-formula><alternatives><inline-graphic xlink:href="023622_inline180.gif"/></alternatives></inline-formula> into <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref>, and substituting the result into <xref ref-type="disp-formula" rid="eqnA2_3a">Eq.(A2.3a)</xref>, we can examine the factorability of the total probability, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline181.gif"/></alternatives></inline-formula>, of a PWA between the extended states of the ancestral and descendant sequences. Again, we can follow a line of reasoning similar to that in Subsection 4.1 of part I, with two differences: (a) here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline182.gif"/></alternatives></inline-formula> plays the role of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline183.gif"/></alternatives></inline-formula> and (b) here, not only the basic states but also the residue states comes into question. Moreover, thanks to the preceding argument, we know that a change in <inline-formula><alternatives><inline-graphic xlink:href="023622_inline184.gif"/></alternatives></inline-formula> results from a collective effects of the changes in the substitution rates and the total exit rates in <xref ref-type="disp-formula" rid="eqnA2_5a">Eqs.(A2.5a,b)</xref>. Thus, we find the following sufficient set of conditions under which <inline-formula><alternatives><inline-graphic xlink:href="023622_inline185.gif"/></alternatives></inline-formula> is factorable into the product of an overall factor and contributions from separate regions.</p>
<p><bold>Condition (I):</bold> In each region, the rate of each of the substitutions and indels is independent of the portions of the extended states in the other regions. And <bold>Condition (II):</bold> In each region, the increment of the total exit rate,<inline-formula><alternatives><inline-graphic xlink:href="023622_inline186.gif"/></alternatives></inline-formula>, due to each of the substitutions and indels, is independent of the portions of the extended states in the other regions.</p>
<p>As argued in Subsection 3.2 of part I, we could calculate the probability of a given MSA (under a given phylogenetic tree and a given evolutionary model) by assembling the PWAs between the ancestral and descendant sequence states along all branches and by summing over all possible sets of sequence states at internal nodes that are consistent with the MSA. Thus, once we know that the probabilities of PWAs of extended sequence states are factorable, we can also factorize the probability of a given MSA of extended sequence states under a given phylogenetic tree. We can do this by extending the line of arguments unfolded in Subsection 4.2 of part I so that it will incorporate the substitution processes and the resulting residue components of the sequence states. According to such an extended line of arguments, we find that the probability of a given MSA is factorable if the above conditions (I) and (II) holds and, in addition, if we have an extended version of the factorability of the root sequence probability (given in Eq.(4.2.8) of part I):
<disp-formula id="eqnA2_6"><alternatives><graphic xlink:href="023622_eqnA2_6.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline187.gif"/></alternatives></inline-formula> is the extended state of a &#x201C;reference&#x201D; root sequence. And the set of regions, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline188.gif"/></alternatives></inline-formula>, consists not only of the regions potentially accommodating local indel histories ({<italic>C</italic><sub>K</sub>}<sub>K=1,&#x2026;,K<sub>max</sub></sub>) but also of the PASs (<italic>i.e</italic>., gapless columns), which can never experience indels but can possibly experience substitutions.</p>
</sec>
<sec id="s5c"><title>A3. Factorizing probability into basic and residue components</title>
<p>Thus far, we considered the probability of a given alignment as the summation of the probabilities with consistent indel histories, each of which, in turn, is the summation of the probabilities of substitution histories consistent with the alignment and the indel history (see, <italic>e.g</italic>., <xref ref-type="disp-formula" rid="eqnA2_3b">Eqs.(A2.3a,b))</xref>. The factorization of the probability as discussed above in Subsection A2 could substantially reduce the computational burden of the calculation. However, we will be able to improve the computational efficiency further if we can factorize the entire probability into the product of the &#x201C;basic&#x201D; component, which concerns indel processes, and the residue component, which concerns substitution processes (and the initial states of residues). This is because the residue component will then need to be computed only once, instead of as many times as the indel LHSs to be considered. Here we will consider a sufficient set of conditions for such an &#x201C;indel-substitution factorization.&#x201D; Because indels are usually at most 1/10 times as frequent as substitutions (<italic>e.g</italic>., <xref ref-type="bibr" rid="c31">Lunter 2007</xref>; <xref ref-type="bibr" rid="c7">Cartwright 2009</xref>), we will consider, as in <xref ref-type="disp-formula" rid="eqnA2_3b">Eqs.(A2.3a,b)</xref> and <xref ref-type="disp-formula" rid="eqnA2_5a">Eqs.(A2.5a,b)</xref>, that each indel history determines the &#x201C;skeleton&#x201D; of the alignment that are made up of the basic sequence states at the nodes. Hence we suppose that each substitution history determines the residue states that flesh out the &#x201C;skeleton&#x201D; to complete the alignment. First, to simplify the argument, we assume that the probability of the alignment skeleton itself does not depend on the residue states. This assumption is true if the indel rates are independent of the residue states of the sequence immediately before the indels:
<disp-formula id="eqnA3_1a-b"><alternatives><graphic xlink:href="023622_eqnA3_1a-b.gif"/></alternatives></disp-formula></p>
<p>It should be noted that the insertion rates could still depend on the residue states of the <italic>inserted</italic> subsequence through <inline-formula><alternatives><inline-graphic xlink:href="023622_inline189.gif"/></alternatives></inline-formula>, which satisfy <inline-formula><alternatives><inline-graphic xlink:href="023622_inline190.gif"/></alternatives></inline-formula>. Under the condition Eqs.(A3.1a,b), the indel exit rate <inline-formula><alternatives><inline-graphic xlink:href="023622_inline191.gif"/></alternatives></inline-formula> is independent of the residue component of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline192.gif"/></alternatives></inline-formula>, and thus the factor <inline-formula><alternatives><inline-graphic xlink:href="023622_inline193.gif"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref> can be factorized as in Eq.(A2.4). Thus, the integrand in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref> is reduced to &#x03A0;<italic><sub>ID</sub></italic> &#x00D7; &#x03A0;<italic><sub>S</sub></italic>, with
<disp-formula id="eqnA3_2a-b"><alternatives><graphic xlink:href="023622_eqnA3_2a-b.gif"/></alternatives></disp-formula>
under the same setting and notations as introduced around <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref>. Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline194.gif"/></alternatives></inline-formula> denotes <inline-formula><alternatives><inline-graphic xlink:href="023622_inline195.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline196.gif"/></alternatives></inline-formula>, respectively, if <inline-formula><alternatives><inline-graphic xlink:href="023622_inline197.gif"/></alternatives></inline-formula> is <inline-formula><alternatives><inline-graphic xlink:href="023622_inline198.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline199.gif"/></alternatives></inline-formula>. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline200.gif"/></alternatives></inline-formula> denotes <inline-formula><alternatives><inline-graphic xlink:href="023622_inline201.gif"/></alternatives></inline-formula> and 1 (unity), respectively, if <inline-formula><alternatives><inline-graphic xlink:href="023622_inline202.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline203.gif"/></alternatives></inline-formula>. The product, &#x03A0;<italic><sub>ID</sub></italic>, is of the same form as the integrand in Eq.(3.1.8b) of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>), which represents the (residue-independent) probability distribution of an indel process, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline205.gif"/></alternatives></inline-formula>. The product, &#x03A0;<italic><sub>S</sub></italic>, is the joint probability of the residue states, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline206.gif"/></alternatives></inline-formula>, &#x201C;at the times of&#x201D; the indel events and of the final residue state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline207.gif"/></alternatives></inline-formula>, conditioned on the initial residue state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline208.gif"/></alternatives></inline-formula> and the indel process. One major difference between Eq.(3.1.13) of part I and its extension, <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3a)</xref>, is that the latter performs the summation over all possible <inline-formula><alternatives><inline-graphic xlink:href="023622_inline209.gif"/></alternatives></inline-formula>. Therefore, if the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s becomes independent of the indel process, then, it can be factored out of the multiple-time integration in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref> and further be factored out of the summation over the consistent indel histories in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3a)</xref>. This means that the total probability of a PWA can be factorized into the product of the probability of the &#x201C;skeleton&#x201D; of the PWA (as in Eq.(3.1.13) of part I) and the probability of the residue component of the PWA. For the latter, the calculation techniques have been developed well (<italic>e.g</italic>., <xref ref-type="bibr" rid="c21">Felsenstein 1981</xref>, <xref ref-type="bibr" rid="c22">2004</xref>; <xref ref-type="bibr" rid="c49">Yang 2006</xref>).</p>
<p>Thus the problem is reduced to the condition under which the aforementioned summation of &#x03A0;<sub><italic>S</italic></sub>&#x2019;s over all <inline-formula><alternatives><inline-graphic xlink:href="023622_inline210.gif"/></alternatives></inline-formula> becomes independent of the indel process consistent with the PWA. It would be convenient to categorize the columns in the PWA according to their histories, <italic>i.e</italic>., whether or not they are preserved throughout [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>], and, if not, the time of insertion (<italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>) and/or the time of deletion (<italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>). (If a column has both <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub> and <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>, <italic>v</italic> (<italic>D</italic>) &#x003C; <italic>v</italic> (<italic>D</italic>) should always hold.) And here, we will make a second simplifying assumption, that is, the substitution rates within each block of contiguous columns with a shared history are assumed as independent of the portions of the residue states in the rest of the sequence. Then, the factor <inline-formula><alternatives><inline-graphic xlink:href="023622_inline211.gif"/></alternatives></inline-formula> in Eq.(A3.2b) can be factorized into the product of partial probabilities, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline212.gif"/></alternatives></inline-formula>, of such blocks with shared histories (denoted as <italic>B</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1,&#x2026;, <italic>I</italic><sub><italic>B</italic></sub>)). And we also assume that <inline-formula><alternatives><inline-graphic xlink:href="023622_inline213.gif"/></alternatives></inline-formula> can be factorized into the product of components, denoted as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline214.gif"/></alternatives></inline-formula>. Here each component <inline-formula><alternatives><inline-graphic xlink:href="023622_inline215.gif"/></alternatives></inline-formula> comes from a relevant block, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline216.gif"/></alternatives></inline-formula>. (Note that the blocks are positioned relative to the MSA (or the array of ancestries) but not relative to a particular sequence state.) These two assumptions make the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s over the intermediate residue states also factorable into the contributions from such blocks. In the following, we consider the contributions from such blocks to the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s. For this purpose, we broadly classify them into four classes: (1) when <italic>B</italic><sub><italic>i</italic></sub> was preserved throughout [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>]; (2) when it existed at <italic>t</italic><sub><italic>I</italic></sub> but was deleted at <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>; (3) when it was inserted at <italic>t</italic><sub><italic>v</italic>(<italic>I</italic>)</sub> and was deleted at <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>; when it was inserted at <italic>t</italic><sub><italic>v</italic>(<italic>I</italic>)</sub> and was preserved through <italic>t</italic><sub><italic>F</italic></sub>.</p>
<p>When <italic>B</italic><sub><italic>i</italic></sub> was preserved throughout [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>], the contribution from the block is:
<disp-formula id="eqnA3_3a"><alternatives><graphic xlink:href="023622_eqnA3_3a.gif"/></alternatives></disp-formula></p>
<p>Because <inline-formula><alternatives><inline-graphic xlink:href="023622_inline217.gif"/></alternatives></inline-formula> itself is a stochastic evolutionary operator made of the block-wise substitution rate operator <inline-formula><alternatives><inline-graphic xlink:href="023622_inline218.gif"/></alternatives></inline-formula>, it satisfies the Chapman-Kolmogorov (CK) equation:
<disp-formula id="eqnA3_4"><alternatives><graphic xlink:href="023622_eqnA3_4.gif"/></alternatives></disp-formula></p>
<p>Applying the CK equation successively regarding the intermediate residue states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline219.gif"/></alternatives></inline-formula>, Eq.(A3.3a) is reduced to <inline-formula><alternatives><inline-graphic xlink:href="023622_inline220.gif"/></alternatives></inline-formula>, which depends only on the initial and final time points, and the residue states at these time points.</p>
<p>(2) When <italic>B</italic><sub><italic>i</italic></sub> existed at <italic>t</italic><sub><italic>I</italic></sub> but was deleted at <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>, the block&#x2019;s contribution is:
<disp-formula id="eqnA3_3b"><alternatives><graphic xlink:href="023622_eqnA3_3b.gif"/></alternatives></disp-formula></p>
<p>The CK equations apply to the summations over <inline-formula><alternatives><inline-graphic xlink:href="023622_inline221.gif"/></alternatives></inline-formula>, and Eq.(A3.3b) is reduced to <inline-formula><alternatives><inline-graphic xlink:href="023622_inline222.gif"/></alternatives></inline-formula>. The summand is the probability of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline223.gif"/></alternatives></inline-formula> at time <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub> conditioned on the initial state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline224.gif"/></alternatives></inline-formula>. Thus, in this case, the summation Eq.(A3.3b) gives 1 (unity). [<italic>B</italic><sub><italic>i</italic></sub>].</p>
<p>(3) When <italic>B</italic><sub><italic>i</italic></sub> was inserted at <italic>t</italic><sub><italic>v</italic>(<italic>I</italic>)</sub> and was deleted at <italic>t</italic><sub><italic>v</italic>(<italic>D</italic>)</sub>, the block&#x2019;s contribution is:
<disp-formula id="eqnA3_3c"><alternatives><graphic xlink:href="023622_eqnA3_3c.gif"/></alternatives></disp-formula></p>
<p>The CK equations apply to the summations over <inline-formula><alternatives><inline-graphic xlink:href="023622_inline225.gif"/></alternatives></inline-formula>, and we have:
<disp-formula id="eqnA3_3ca"><alternatives><graphic xlink:href="023622_eqnA3_3ca.gif"/></alternatives></disp-formula></p>
<p>As in case (2), the summation over <inline-formula><alternatives><inline-graphic xlink:href="023622_inline226.gif"/></alternatives></inline-formula>&#x2019;s in the parentheses in Eq.(A3.3c&#x2019;) gives unity, thus the equation is reduced to <inline-formula><alternatives><inline-graphic xlink:href="023622_inline227.gif"/></alternatives></inline-formula>. This summation is nothing other than 1 (unity) thanks to the normalization condition of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline228.gif"/></alternatives></inline-formula>. Thus, in conjunction with (2), we see that the contribution from a deleted block to the <italic>conditional</italic> probability of a PWA is always unity, regardless of whether it already existed in the initial sequence or it was inserted.</p>
<p>(4) When <italic>B</italic><sub><italic>i</italic></sub> was inserted at <italic>t</italic><sub><italic>v</italic>(<italic>I</italic>)</sub> and was preserved through <italic>t</italic><sub><italic>F</italic></sub>, the block&#x2019;s contribution is:
<disp-formula id="eqnA3_3d"><alternatives><graphic xlink:href="023622_eqnA3_3d.gif"/></alternatives></disp-formula></p>
<p>The CK equations apply to the summations over <inline-formula><alternatives><inline-graphic xlink:href="023622_inline229.gif"/></alternatives></inline-formula>, and we have:
<disp-formula id="eqnA3_3da"><alternatives><graphic xlink:href="023622_eqnA3_3da.gif"/></alternatives></disp-formula></p>
<p>In order for the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s to be independent of the indel process, Eq.(A3.3d&#x2019;) needs to be independent of <italic>t</italic><sub><italic>v</italic> (<italic>I</italic>)</sub>, especially it needs to be equal to its limit under <italic>t</italic><sub><italic>v</italic> (<italic>I</italic>)</sub> &#x2192; <italic>t</italic><sub><italic>F</italic></sub>. In this limit, we have <inline-formula><alternatives><inline-graphic xlink:href="023622_inline230.gif"/></alternatives></inline-formula>, thanks to the defining property of the stochastic evolutionary operator (Eq.(1.1.10b&#x2019;) of part I). Thus, the aforementioned condition can be expressed as:
<disp-formula id="eqnA3_5"><alternatives><graphic xlink:href="023622_eqnA3_5.gif"/></alternatives></disp-formula></p>
<p>Here we used <inline-formula><alternatives><inline-graphic xlink:href="023622_inline231.gif"/></alternatives></inline-formula>. The right hand side of <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5)</xref> depends only on the final time, a fixed block, and the portion of the extended sequence state in the block at the final time, and therefore it is totally independent of the indel process, as required.</p>
<p>Thus, let us assume that the four conditions we imposed above are satisfied. Namely, (i) the indel rates are independent of the residue states; (ii) each finite-time evolution probability of the residue state via substitutions is factorable into the product of the probabilities of blocks of particular histories; (iii) the residue state spectrum of each inserted sub-sequence is factorable into the product of block-wise contributions; and (iv) each block-wise spectrum of inserted residue states satisfies <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5)</xref>. Under these conditions, the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s (given in Eq.(A3.2b)) over all possible intermediate residue states is expressed as:
<disp-formula id="eqnA3_6"><alternatives><graphic xlink:href="023622_eqnA3_6.gif"/></alternatives></disp-formula></p>
<p>Thus, those sites that didn&#x2019;t make it through <italic>t</italic><sub><italic>F</italic></sub> do not contribute to <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6)</xref>. (More precisely, each of them contributes a trivial multiplication factor of 1 (unity).) <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6)</xref> is independent of the indel process that provides the &#x201C;skeleton,&#x201D; except the possible dependence on the particular way how the indel process partitions the PWA into blocks. If we consider all indel processes that are consistent with the PWA, there could be a variety of ways of partitioning it into blocks. A simplest way to assure the independence on the way of partitioning the PWA is to assume the following two properties. (1) The stochastic evolutionary operator of substitutions is factorable into the product of site-wise operators: <inline-formula><alternatives><inline-graphic xlink:href="023622_inline232.gif"/></alternatives></inline-formula>. And (2) the residue state spectrum of inserted sub-sequence, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline233.gif"/></alternatives></inline-formula> in Eq.(A3.1b), is also factorable into the product of site-wise contributions: <inline-formula><alternatives><inline-graphic xlink:href="023622_inline234.gif"/></alternatives></inline-formula>. Here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline235.gif"/></alternatives></inline-formula> is the extended sequence state immediately <italic>after</italic> the insertion, and we used the ancestries (<italic>v</italic><sub><italic>x</italic></sub>&#x2019;s) instead of the site numbers (<italic>x</italic>&#x2019;s) as arguments because the former is invariant through an indel process. Under this assumption, the condition <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5)</xref> is reduced to the following single-site condition:
<disp-formula id="eqnA3_5a"><alternatives><graphic xlink:href="023622_eqnA3_5a.gif"/></alternatives></disp-formula>
for <sup>&#x02200;</sup><italic>t</italic> &#x2208; [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>I</italic></sub>]. Then, after partitioning the PWA, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline236.gif"/></alternatives></inline-formula>, into the columns with ancestries {<italic>v</italic><sub>1</sub>, <italic>v</italic><sub>1</sub>,&#x2026;, <italic>v</italic><sub><italic>L</italic> (<italic>&#x03B1;</italic>)}</sub>, where <italic>L</italic>(<italic>&#x03B1;</italic>) is the number of columns in the PWA, <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6)</xref> is further reduced to:
<disp-formula id="eqnA3_6a"><alternatives><graphic xlink:href="023622_eqnA3_6a.gif"/></alternatives></disp-formula></p>
<p>Here <italic>&#x03C9;<sup>A</sup></italic>(<italic>v</italic><sub><italic>i</italic></sub>) and <italic>&#x03C9;</italic><sup><italic>D</italic></sup>(<italic>v</italic><sub><italic>i</italic></sub>), respectively, denote the ancestral and the descendant residues in the PWA column (<italic>i.e</italic>., site) with ancestry <italic>v</italic>, and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline237.gif"/></alternatives></inline-formula> is the single-site evolutionary operator via substitutions in the site with ancestry <italic>v</italic><sub><italic>i</italic></sub>. On the right hand side, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline238.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline239.gif"/></alternatives></inline-formula>, respectively, symbolically represent the vector functions extracting the ancestral and descendant residue states from the PWA of extended sequence states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline240.gif"/></alternatives></inline-formula>. As desired, the left hand side of <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref> depends only on the ancestral and descendant states, as well as the homology structure of the PWA, and does not depend on any details of the indel processes. Hence, the right hand side follows. Thus, in this case, the summation of &#x03A0;<italic><sub>S</sub></italic>&#x2019;s can indeed be factored out of the multiple-time integration in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref> and also of the summation over all indel histories consistent with the PWA in <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3a)</xref>. This finally enables us to re-expresses <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3a)</xref>, supplemented by <xref ref-type="disp-formula" rid="eqnA2_3b">Eq.(A2.3b)</xref>, into the form we desire:
<disp-formula id="eqnA3_7a"><alternatives><graphic xlink:href="023622_eqnA3_7a.gif"/></alternatives></disp-formula></p>
<p>On the right hand side, the second factor is given by <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref>, and the first factor is given by:
<disp-formula id="eqnA3_7b"><alternatives><graphic xlink:href="023622_eqnA3_7b.gif"/></alternatives></disp-formula></p>
<p>Here we remind the equations, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline241.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline242.gif"/></alternatives></inline-formula> for <italic>v</italic> = 1,&#x2026;, <italic>N</italic>. Eq.(A3.7b) corresponds exactly to Eq.(3.1.13) of part I supplemented by Eq.(3.1.8b) of part I, which gives the probability of the &#x201C;skeleton&#x201D; <italic>&#x03B1;</italic>(<italic>s<sup>A</sup></italic>, <italic>s<sup>D</sup></italic>) of the PWA <inline-formula><alternatives><inline-graphic xlink:href="023622_inline243.gif"/></alternatives></inline-formula>, conditioned on the basic ancestral state <italic>s<sup>A</sup></italic> at the initial time, due to indel processes.</p>
<p>The above line of arguments implies that it would be very difficult, even if it is possible at all, to factorize a whole probability of a PWA into the product, <xref ref-type="disp-formula" rid="eqnA3_7a">Eq.(A3.7a)</xref>, of the basic component (Eq.(A3.7b)) and the residue component (<xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref>), <italic>unless</italic> the residue component of the stochastic evolution operator is factorable into the product of column-wise operators as in <xref ref-type="disp-formula" rid="eqnA1_3">Eq.(A1.3)</xref>, or <italic>unless</italic> the indel rate parameters can be expressed as in Eqs.(A3.1a,b), where <inline-formula><alternatives><inline-graphic xlink:href="023622_inline244.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline245.gif"/></alternatives></inline-formula> are independent of the residue states. Nevertheless, even if either of these conditions is violated, the whole probability of a PWA is still factorable into the product of the contributions from some separated regions, if the rate parameters of indels and substitutions in each region are independent of the portions of the extended sequence state outside of the region, as argued in Subsection A2. Therefore, even if the residue states at some sites have substantial impacts on the indel rates and/or the substitution rates, if such effects are localized in some narrow regions, we could first factorize the entire PWA probability into the product of regional contributions and then factorize most of such regional contributions into the basic and the substitution components. Then, we could separately handle the small portions whose &#x201C;indel-substitution factorizations&#x201D; are not possible. This way, the computational burden may still be mitigated considerably. Such a situation might apply to some mutagenic and/or functional motifs that are scattered along the sequence and which show quite rapid turnover. (If a motif is strongly conserved, in contrast, its effect will be well approximated by the <italic>ancestry</italic> dependence, instead of the residue dependence, of the rate parameters, and thus the &#x201C;indel-substitution factorization&#x201D; holds at least approximately.)</p>
<p>Now, let us assume the aforementioned conditions for the indel-substitution factorization of the conditional probability of PWAs, <italic>i.e</italic>., that the indel rate parameters are of the forms in Eqs.(A3.1a,b) and that the substitution evolutionary operator is factorable into the product of the column-wise operators as in <xref ref-type="disp-formula" rid="eqnA1_3">Eq.(A1.3)</xref>. Under such conditions, we will examine whether the probability of a given MSA is also factorable into the indel (<italic>i.e</italic>., &#x201C;basic&#x201D;) and substitution (<italic>i.e</italic>., residue) components. In this case, we generalize Eqs.(3.2.13a,b&#x2019;) of part I to the probability of an &#x201C;extended <italic>&#x03B1;</italic> MSA,&#x201D; <italic>i.e</italic>., an alignment of multiple extended sequence states, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline246.gif"/></alternatives></inline-formula>. The set of all sets of basic states at internal nodes consistent with the MSA, <italic>i.e</italic>., <inline-formula><alternatives><inline-graphic xlink:href="023622_inline247.gif"/></alternatives></inline-formula> in Eq.(3.2.13a) of part I, can be extended by filling in each of the sets of internal basic states with all possible residue states. Thus, the extended set is expressed as:
<disp-formula id="eqnA3_8"><alternatives><graphic xlink:href="023622_eqnA3_8.gif"/></alternatives></disp-formula></p>
<p>Hence, we have the extended version of Eq.(3.2.13a) of part I as follows:
<disp-formula id="eqnA3_9a"><alternatives><graphic xlink:href="023622_eqnA3_9a.gif"/></alternatives></disp-formula></p>
<p>Here,<inline-formula><alternatives><inline-graphic xlink:href="023622_inline248.gif"/></alternatives></inline-formula> represents the multiple summations over all possible sets of residue states at internal nodes. More precisely, in each possible set, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline249.gif"/></alternatives></inline-formula>, each component state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline250.gif"/></alternatives></inline-formula> fills in a fixed basic state (<italic>s</italic>(<italic>n</italic>)) at each internal node (<italic>n</italic> &#x2208; N<italic><sup>IN</sup></italic>(<italic>T</italic>)). And the probability, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline251.gif"/></alternatives></inline-formula>, is given by an extended version of Eq.(3.2.13b&#x2019;) of part I:
<disp-formula id="eqnA3_9b"><alternatives><graphic xlink:href="023622_eqnA3_9b.gif"/></alternatives></disp-formula></p>
<p>Here, as below Eq.(3.2.13b&#x2019;) of part I, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline252.gif"/></alternatives></inline-formula> denotes the probability of a PWA between the <italic>extended</italic> states at the ancestral and descendant nodes of branch <italic>b</italic>. Under the present assumptions, each of such probabilities can be factorized into the basic and residue components, as in <xref ref-type="disp-formula" rid="eqnA3_7a">Eq.(A3.7a)</xref>. In addition, we assume that the root state probability is also factorable as:
<disp-formula id="eqnA3_9c"><alternatives><graphic xlink:href="023622_eqnA3_9c.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="023622_inline253.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline254.gif"/></alternatives></inline-formula> denote the residue and basic components, respectively, at the <italic>x</italic> th site of the root sequence. By substituting <xref ref-type="disp-formula" rid="eqnA3_7a">Eqs.(A3.7a, 9c)</xref> into <xref ref-type="disp-formula" rid="eqnA3_9b">Eq.(A3.9b)</xref>, we see that the summand in <xref ref-type="disp-formula" rid="eqnA3_9b">Eq.(A3.9b)</xref>, <italic>i.e</italic>., <inline-formula><alternatives><inline-graphic xlink:href="023622_inline255.gif"/></alternatives></inline-formula> is factorized as:
<disp-formula id="eqnA3_10a"><alternatives><graphic xlink:href="023622_eqnA3_10a.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline256.gif"/></alternatives></inline-formula> (with <italic>j</italic> = 1, 2,&#x2026;, <italic>N</italic><sup><italic>X</italic></sup>) symbolically represents the vector function extracting the residue state of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline257.gif"/></alternatives></inline-formula> in the MSA of extended sequence states <inline-formula><alternatives><inline-graphic xlink:href="023622_inline258.gif"/></alternatives></inline-formula>. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline259.gif"/></alternatives></inline-formula> represents the vector function extracting the residue state of an extended sequence state <inline-formula><alternatives><inline-graphic xlink:href="023622_inline259a.gif"/></alternatives></inline-formula>. On the right hand side of <xref ref-type="disp-formula" rid="eqnA3_10a">Eq.(A3.10a)</xref>, the first factor, <italic>P</italic>[<italic>&#x03B1;</italic>[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>,&#x2026;, <italic>s<sub>N<sup>X</sup></sub></italic>]; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>| <italic>T</italic>], is given by an equation that exactly corresponds to Eq.(3.2.13b&#x2019;) of part I. Meanwhile, the second factor is given by:
<disp-formula id="eqnA3_10b"><alternatives><graphic xlink:href="023622_eqnA3_10b.gif"/></alternatives></disp-formula></p>
<p>Here each conditional probability in &#x03A0;<sub><italic>b</italic>&#x2208;{<italic>b</italic>}<sub><italic>T</italic></sub></sub> (&#x2026;) is given by the left hand side of <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref> slightly modified to fit the evolution along each branch <italic>b</italic>. Thus, the right hand side of <xref ref-type="disp-formula" rid="eqnA3_10b">Eq.(A3.10b)</xref> can be re-expressed as a product over contributions from single columns of <inline-formula><alternatives><inline-graphic xlink:href="023622_inline260.gif"/></alternatives></inline-formula>, where each single column&#x2019;s contribution is also a product of terms coming from different branches and nodes. If we can show that the summation of the right hand side of <xref ref-type="disp-formula" rid="eqnA3_10b">Eq.(A3.10b)</xref> over all possible internal residue states is independent of particular details of the basic states at internal nodes as long as they are consistent with the MSA, then, the summation can be factored out of the summation over &#x03A3;[<italic>&#x03B1;</italic>[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>,&#x2026; <italic>s<sub>N<sup>X</sup></sub></italic>]; {<italic>n</italic> &#x2208; <italic>N<sup>IN</sup></italic> (<italic>T</italic>)}; <italic>T</italic>] on the right hand side of <xref ref-type="disp-formula" rid="eqnA3_9a">Eq.(A3.9a).</xref> If so, the total probability of a given extended MSA, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline261.gif"/></alternatives></inline-formula> given by <xref ref-type="disp-formula" rid="eqnA3_9a">Eq.(A3.9a)</xref>, can be factorized into the basic and residue components:
<disp-formula id="eqnA3_11"><alternatives><graphic xlink:href="023622_eqnA3_11.gif"/></alternatives></disp-formula></p>
<p>Here <italic>P</italic>[<italic>&#x03B1;</italic> [<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>,&#x2026;, <italic>s<sub>N<sup>X</sup></sub></italic> &#x007C; <italic>T</italic>] is given by an equation exactly corresponding to Eq.(3.2.13a) of part I. And <inline-formula><alternatives><inline-graphic xlink:href="023622_inline262.gif"/></alternatives></inline-formula> is the summation of <xref ref-type="disp-formula" rid="eqnA3_10b">Eq.(A3.10b)</xref> over all possible internal residue states filling in a fixed set of basic internal states ({<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>) consistent with the MSA. In the following, we will show that this summation is indeed independent of the details of {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>.</p>
<p>First, because <xref ref-type="disp-formula" rid="eqnA3_10b">Eq.(A3.10b)</xref> with the reverse-substitution by <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref> is a product of single-site contributions, we can sort it into a product of column-wise probabilities (<italic>P</italic>(<italic>v</italic><sub><italic>i</italic></sub>)&#x2019;s) over all MSA columns, which are assigned ancestries <italic>v</italic><sub>1</sub>, <italic>v</italic><sub>2</sub>,&#x2026;, <italic>v</italic><sub><italic>L</italic> (<italic>&#x03B1;</italic>)</sub> (<italic>L</italic>(<italic>&#x03B1;</italic>) is the number of columns in the MSA):
<disp-formula id="eqnA3_12a"><alternatives><graphic xlink:href="023622_eqnA3_12a.gif"/></alternatives></disp-formula></p>
<p>Because each MSA column, <italic>i.e</italic>., each site with a given ancestry (<italic>v</italic><sub><italic>i</italic></sub>), can experience <italic>at most</italic> one insertion, each <italic>P</italic>(<italic>v</italic><sub><italic>i</italic></sub>) can be broadly classified into two forms, as follows.</p>
<p>(1) When the site did not experience an insertion, the site already existed at the root node. Thus, considering <xref ref-type="disp-formula" rid="eqnA3_6">Eq.(A3.6&#x2019;)</xref> and <xref ref-type="disp-formula" rid="eqnA3_9c">Eq.(A3.9c)</xref>, we have:
<disp-formula id="eqnA3_12b"><alternatives><graphic xlink:href="023622_eqnA3_12b.gif"/></alternatives></disp-formula></p>
<p>Here, <italic>&#x03C9;</italic>(<italic>n</italic>; <italic>v</italic><sub><italic>i</italic></sub>) denotes the residue state at the site with the ancestry <italic>v</italic><sub><italic>i</italic></sub> in the extended sequence state at the node <italic>n</italic>. And {<italic>b</italic>}<italic><sub>T</sub></italic> [<italic>v</italic><sub><italic>i</italic></sub>; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>] is the set of branches through which the site <italic>v</italic><sub><italic>i</italic></sub> continued to exist (<italic>i.e</italic>., the site experienced no indel event along the branch), given a set of the internal node states ({<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>). (2) When the site experienced an insertion along a branch <italic>b</italic><sub><italic>I</italic></sub>, we have:
<disp-formula id="eqnA3_12c"><alternatives><graphic xlink:href="023622_eqnA3_12c.gif"/></alternatives></disp-formula></p>
<p>Here, inevitably, {<italic>b</italic>}<italic><sub>T</sub></italic> [<italic>v</italic><sub><italic>i</italic></sub>; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>] consists solely of some, but not necessarily all, of the descendant branches of <italic>b</italic><sub><italic>I</italic></sub>.</p>
<p>Now, in a MSA column (with ancestry <italic>v</italic><sub><italic>i</italic></sub>), consider the summation of <italic>P</italic>(<italic>v</italic><sub><italic>i</italic></sub>)&#x2019;s over all possible residue states at relevant internal nodes. Let N<italic><sup>IN</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>] be the set of such internal nodes. According to the phylogenetic correctness condition (<italic>e.g</italic>., <xref ref-type="bibr" rid="c10">Childelevitch et al. 2006</xref>) (as mentioned near the bottom of Subsection 3.2 of part I), the union of N<italic><sup>IN</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>], the set of external nodes with the site of ancestry <italic>v</italic><sub><italic>i</italic></sub> (N<italic><sup>X</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>]), and {<italic>b</italic>}<sub>T</sub>[<italic>v</italic><sub><italic>i</italic></sub>; {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>] always forms a single, connected web in the tree (see the lower part of Subsection 3.4 of part I, and Figures 4 and 7 of part I). The minimum web among such webs is given by the Dollo parsimonious indel history (<xref ref-type="bibr" rid="c19">Farris 1977</xref>), and is a union of N<italic><sup>X</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>] and the shortest paths, each of which connects a pair of nodes in N<italic><sup>X</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>]. Other webs consistent with the MSA column are formed by continuously extending one or more paths from the minimum web. There are two types of web-extension: upward (toward the root) and downward (toward, but always short of, the external nodes not in N<italic><sup>X</sup></italic>[<italic>v</italic><sub><italic>i</italic></sub>]). Downward extensions could branch off, as long as the branches do not reach any external nodes. We first handle downward extensions and then handle upward extensions. At each lower-tip of a downward extension, we always encounter a summation of single conditional probabilities, such as <inline-formula><alternatives><inline-graphic xlink:href="023622_inline263.gif"/></alternatives></inline-formula>, which always gives 1 (unity). After repeating this type of summations, the residue state probabilities at nodes on each downward extension (except its origin belonging to the minimum web) leave no effects on the column-wise MSA probability via substitutions. Next, at each upper-tip of an upward extension, we encounter the following summation: either <inline-formula><alternatives><inline-graphic xlink:href="023622_inline264.gif"/></alternatives></inline-formula> if the tip is the root node (<italic>i.e.</italic>, <italic>n<sup>A</sup></italic> (<italic>b</italic>) = <italic>n<sup>Root</sup></italic>), or <inline-formula><alternatives><inline-graphic xlink:href="023622_inline265.gif"/></alternatives></inline-formula> otherwise (<italic>i.e</italic>., if <italic>n<sup>A</sup></italic>(<italic>b</italic>) = <italic>n<sup>D</sup></italic>(<italic>b</italic>)). Each of them is a summation over the initial states, and each summand is the product of an &#x201C;initial probability&#x201D; and a single probability conditioned on the initial state. Thanks to <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5&#x2019;)</xref>, the latter type of summation can be performed, yielding <italic>p</italic> (<italic>&#x03C9;</italic>(<italic>n<sup>D</sup></italic>(<italic>b</italic>); <italic>v</italic>); <italic>v</italic>, <italic>n<sup>D</sup></italic>(<italic>b</italic>)). The former type of summation can also be performed <italic>if we additionally assume</italic> the following equation:
<disp-formula id="eqnA3_13"><alternatives><graphic xlink:href="023622_eqnA3_13.gif"/></alternatives></disp-formula></p>
<p>Thus, if <xref ref-type="disp-formula" rid="eqnA3_13">Eq.(A3.13)</xref> holds, every upward extension can be receded down to its origin (<italic>n<sup>Ori</sup></italic>) belonging to the minimum web, providing <italic>p</italic><sub><italic>I</italic></sub> (<italic>&#x03C9;</italic>(<italic>n<sup>Ori</sup></italic>; <italic>v</italic><sub><italic>i</italic></sub>); <italic>v</italic><sub><italic>i</italic></sub>, <italic>n<sup>Ori</sup></italic>). Finally, consider the contribution from a &#x201C;null site&#x201D; that is not kept at any external nodes. In this case, after successively performing the summations at the lower-tips of the downward extensions, we are always left with either &#x03A3;<sub><italic>&#x03C9;</italic>&#x2032;&#x2208;&#x2126;</sub> <italic>p</italic> [(<italic>&#x03C9;&#x2032;</italic>, <italic>n<sup>Root</sup></italic>)&#x007C; <italic>v</italic><sub><italic>i</italic></sub>] or &#x03A3;<sub><italic>&#x03C9;</italic>&#x2032;&#x2208;&#x2126;</sub> <italic>p</italic><sub><italic>I</italic></sub> (<italic>&#x03C9;</italic>&#x2032;; <italic>v</italic><sub><italic>i</italic></sub>, <italic>n</italic>). Each of them always yields 1 (unity). Putting together all these arguments, we see that the probability of the residue states of a MSA column under any indel history can be reduced to that under the Dollo parsimonious indel history. This means that the residue component of the MSA probability, which is the summation of <xref ref-type="disp-formula" rid="eqnA3_10b">Eq.(A3.10b)</xref> over all possible residue states at internal nodes, is indeed independent of the basic sequence states at internal nodes, {<italic>s</italic>(<italic>n</italic>)}<sub>N<sup><italic>IN</italic></sup></sub>. Thus, under the assumptions of Eqs.(A3.1a,b), the column-wise factorization of the substitution evolutionary operators, <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5&#x2019;)</xref> and <xref ref-type="disp-formula" rid="eqnA3_13">Eq.(A3.13)</xref>, the MSA probability can indeed be factorized into the basic and residue components, as in <xref ref-type="disp-formula" rid="eqnA3_11">Eq.(A3.11)</xref>.</p>
</sec>
<sec id="s5d"><title>A4. Pursuing further biological realism</title>
<p><xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5&#x2019;)</xref> and <xref ref-type="disp-formula" rid="eqnA3_13">Eq.(A3.13)</xref> in Subsection A3 are <italic>non-equilibrium</italic> generalizations of the famous detailed-balance condition, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline266.gif"/></alternatives></inline-formula>, for a time-reversible substitution model with the equilibrium residue frequencies {<italic>&#x03C0;</italic> (<italic>&#x03C9;</italic>)}<sub><italic>&#x03C9;</italic>&#x2208;&#x03A9;</sub> and the assumption that the residue content of the inserted subsequences is also given by {<italic>&#x03C0;</italic> (<italic>&#x03C9;</italic>)}<sub><italic>&#x03C9;</italic> &#x2208;&#x03A9;</sub>. These widely accepted assumptions played important roles to facilitate the calculations in the past studies with evolutionary models incorporating both substitutions and indels (<italic>e.g</italic>., <xref ref-type="bibr" rid="c45">Thorne et al. 1991</xref>, <xref ref-type="bibr" rid="c46">1992</xref>; <xref ref-type="bibr" rid="c34">Mikl&#x00F3;s et al. 2004</xref>; <xref ref-type="bibr" rid="c39">Rivas and Eddy 2008</xref>). However, even if generalized to <xref ref-type="disp-formula" rid="eqnA3_5">Eq.(A3.5&#x2019;)</xref> and <xref ref-type="disp-formula" rid="eqnA3_13">Eq.(A3.13)</xref>, they may still be too restrictive to accommodate some biologically realistic features. For example, when transposable elements (<italic>e.g</italic>., <xref ref-type="bibr" rid="c36">Morgante et al. 2007</xref>; <xref ref-type="bibr" rid="c8">Chalopin et al. 2015</xref>) or foreign DNA sequences (<italic>e.g</italic>., <xref ref-type="bibr" rid="c48">Waterhouse and Russell 2006</xref>) are inserted, the residue content of such inserted sequences is likely to be substantially different from the residue content of the genome that underwent the insertions. It remains to be seen whether we can further relax the conditions to accommodate such situations while keeping the &#x201C;indel-substitution factorization&#x201D; enabled. Recently, <xref ref-type="bibr" rid="c29">L&#x00E8;bre and Michel (2010</xref>, <xref ref-type="bibr" rid="c30">2013</xref>) developed some analytical models to examine the effects of the base composition of inserted sequences on the evolution of the base composition of an entire genome or of its subset. It might be interesting to see if their methods are applicable to the issue at hand.</p>
<p>Another potentially important biologically realistic feature is the observation by some studies that the substitution rate increases at sites surrounding insertions/deletions (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c47">Tian et al. 2008</xref>; <xref ref-type="bibr" rid="c11">De and Babu 2010</xref>). If the incremental substitutions occurred simultaneously or almost simultaneously with the indel events, this feature could be formally incorporated into our theoretical framework by &#x201C;dressing&#x201D; each indel operator term in the action of the rate operator,<inline-formula><alternatives><inline-graphic xlink:href="023622_inline267.gif"/></alternatives></inline-formula>, with substitution operators. The deletion operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline268.gif"/></alternatives></inline-formula>, could be replaced with:
<disp-formula id="eqnA4_1"><alternatives><graphic xlink:href="023622_eqnA4_1.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023622_inline269.gif"/></alternatives></inline-formula> is the probability that the residue states of the intermediate state, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline270.gif"/></alternatives></inline-formula>, was replaced as indicated, and satisfies <inline-formula><alternatives><inline-graphic xlink:href="023622_inline271.gif"/></alternatives></inline-formula>. For notational convenience, we have also set <inline-formula><alternatives><inline-graphic xlink:href="023622_inline272.gif"/></alternatives></inline-formula>, where the subscript <italic>x</italic> in <italic>&#x03C9;<sub>x</sub></italic> and <italic>&#x03C9;</italic>&#x2032; <italic><sub>x</sub></italic> indicates that they are residue states at the <italic>x</italic> th site. The <inline-formula><alternatives><inline-graphic xlink:href="023622_inline273.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023622_inline274.gif"/></alternatives></inline-formula> are the &#x201C;cut-off&#x201D; lengths of the left-flanking and right-flanking regions, respectively, that could accommodate the incremental substitutions. The cut-offs were introduced just for convenience. If we can assume that the incremental substitution at each site is independent of those at the other sites, <xref ref-type="disp-formula" rid="eqnA4_1">Eq.(A4.1)</xref> is reduced to:
<disp-formula id="eqnA4_1a"><alternatives><graphic xlink:href="023622_eqnA4_1a.gif"/></alternatives></disp-formula></p>
<p>Here the site-wise incremental substitution probability, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline275.gif"/></alternatives></inline-formula>, satisfies the equation, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline276.gif"/></alternatives></inline-formula>. We can also &#x201C;dress&#x201D; the insertion operator, <inline-formula><alternatives><inline-graphic xlink:href="023622_inline277.gif"/></alternatives></inline-formula>, in a similar manner. The expression of a dressed insertion operator becomes bulkier than <xref ref-type="disp-formula" rid="eqnA4_1">Eq.(A4.1)</xref>, and thus is omitted here. Once the incremental substitutions are introduced as in <xref ref-type="disp-formula" rid="eqnA4_1">Eq.(A4.1)</xref>, we cannot easily perform the &#x201C;indel-substitution factorization&#x201D; of the alignment probabilities, because the expected number of substitutions increases with the number of indels in a local history.</p>
<p>Therefore, if the incremental substitutions occur commonly along the genome, the above line of arguments is no longer applicable for the separation of basic and residue components of the <italic>entire</italic> alignment probability. Nevertheless, the alignment probability may still be factorable into the product of local contributions, possibly with some modifications in the arguments (in Section 4 of part I (<xref ref-type="bibr" rid="c16">Ezawa, Graur and Landan 2015a</xref>)) and the models (given in Section 5 of part I). It remains to be seen whether we can still factorize the alignment probability into the basic and residue components by substantially extending and/or modifying the arguments given in this subsection. Unless we can, one solution might be to develop an &#x201C;effective substitution model&#x201D; that takes beforehand account of the effects of such incremental substitutions in the vicinity of indels (including invisible ones).</p>
</sec>
</sec>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Arndt</surname> <given-names>PF</given-names></string-name>, <string-name><surname>Hwa</surname> <given-names>T.</given-names></string-name> <year>2005</year>. <article-title>Identification and measurement of neighbor-dependent nucleotide substitution processes</article-title>. <source>Bioinformatics</source> <volume>21</volume>:<fpage>2322</fpage>&#x2013;<lpage>2328</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bailey</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>EE</given-names></string-name>. <year>2006</year>. <article-title>Primate segmental duplications: crucibles of evolution, diversity and disease</article-title>. <source>Nat Rev Genet</source> <volume>7</volume>:<fpage>552</fpage>&#x2013;<lpage>564</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bradley</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>I.</given-names></string-name> <year>2007</year>. <article-title>Transducers: an emerging probabilistic framework for modeling indels on trees</article-title>. <source>Bioinformatics</source> <volume>23</volume>:<fpage>3258</fpage>&#x2013;<lpage>3262</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Britten</surname> <given-names>RJ</given-names></string-name>. <year>2002</year>. <article-title>Divergence between samples of chimpanzee and human DNA sequences is 5&#x0025;, counting indels</article-title>. <source>Proc. Natl. Acad. Sci. USA</source> <volume>99</volume>:<fpage>13633</fpage>&#x2013;<lpage>13635</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Britten</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Rowen</surname> <given-names>L</given-names></string-name>, <string-name><surname>Willians</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cameron</surname> <given-names>RA</given-names></string-name>. <year>2003</year>. <article-title>Majority of divergence between closely related DNA samples is due to indels</article-title>. <source>Proc. Natl. Acad. Sci. USA</source> <volume>100</volume>:<fpage>4661</fpage>&#x2013;<lpage>4665</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Cartwright</surname> <given-names>RA</given-names></string-name>. <year>2005</year>. <article-title>DNA assembly with gap (Dawg): simulating sequence evolution</article-title>. <source>Bioinformatics</source> <volume>21</volume>:<fpage>iii31</fpage>&#x2013;<lpage>iii38</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Cartwright</surname> <given-names>RA</given-names></string-name>. <year>2009</year>. <article-title>Problems and solutions for estimating indel rates and length distribution</article-title>. <source>Mol Biol Evol</source>. <volume>26</volume>:<fpage>473</fpage>&#x2013;<lpage>480</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Chalopin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Naville</surname> <given-names>M</given-names></string-name>, <string-name><surname>Plard</surname> <given-names>F</given-names></string-name>, <string-name><surname>Galiana</surname> <given-names>D</given-names></string-name>, <string-name><surname>Volff</surname> <given-names>JN</given-names></string-name>. <year>2015</year>. <article-title>Comparative analysis of transposable elements highlights mobilome diversity and evolution in vertebrates</article-title>. <source>Genome Biol Evol</source>. <volume>7</volume>:<fpage>567</fpage>&#x2013;<lpage>580</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>DN</given-names></string-name>, <string-name><surname>Chuzhanova</surname> <given-names>N</given-names></string-name>, <string-name><surname>F&#x00E9;rec</surname> <given-names>C</given-names></string-name>, <string-name><surname>Patrionos</surname> <given-names>GP</given-names></string-name>. <year>2007</year>. <article-title>Gene conversion: mechanisms, evolution and human disease</article-title>. <source>Nat Rev Genet</source>. <volume>8</volume>:<fpage>762</fpage>&#x2013;<lpage>775</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Chindelevitch</surname> <given-names>L.</given-names></string-name> <string-name><surname>Li</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Blais</surname> <given-names>E</given-names></string-name>, <string-name><surname>Blanchette</surname> <given-names>M.</given-names></string-name> <year>2006</year>. <article-title>On the inference of parsimonious evolutionary scenarios</article-title>. <source>J Bioinform Comput Biol</source>. <volume>4</volume>:<fpage>721</fpage>&#x2013;<lpage>744</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>De</surname> <given-names>S</given-names></string-name>, <string-name><surname>Babu</surname> <given-names>M.</given-names></string-name> <year>2010</year>. <article-title>A time-invariant principle of genome evolution</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>107</volume>:<fpage>13004</fpage>&#x2013;<lpage>13009</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Ellegren</surname> <given-names>H.</given-names></string-name> <year>2004</year>. <article-title>Microsatellites: simple sequences with complex evolution</article-title>. <source>Nat Rev Genet</source>. <volume>5</volume>:<fpage>435</fpage>&#x2013;<lpage>445</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ikeo</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gojobori</surname> <given-names>T</given-names></string-name>, <string-name><surname>Saitou</surname> <given-names>N.</given-names></string-name> <year>2010</year>. <article-title>Evolutionary pattern of gene homogenization between primate-specific paralogs after human and macaque speciation using the 4-2-4 method</article-title>. <source>Mol Biol Evol</source>. <volume>27</volume>:<fpage>2152</fpage>&#x2013;<lpage>2171</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ikeo</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gojobori</surname> <given-names>T</given-names></string-name>, <string-name><surname>Saitou</surname> <given-names>N.</given-names></string-name> <year>2011</year>. <article-title>Evolutionary patterns of recently emerged animal duplogs</article-title>. <source>Genome Biol Evol</source>. <volume>3</volume>:<fpage>1119</fpage>&#x2013;<lpage>1135</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D.</given-names></string-name> <year>2013</year>. <article-title>Detecting negative selection on recurrent mutations using gene genealogy</article-title>. <source>BMC Genetics</source> <volume>14</volume>:<fpage>37</fpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015a</year>. <article-title>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part I: Theoretical basis</article-title>. <source>(unpublished, to be posted on bioRxiv.)</source></mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015b</year>. <article-title>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part II: Perturbation analyses</article-title>. <source>(unpublished, to be posted on bioRxiv.)</source></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015c</year>. <article-title>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part III: Algorithm for first approximation</article-title>. <source>(unpublished, to be posted on bioRxiv.)</source></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Farris</surname> <given-names>JS</given-names></string-name>. <year>1977</year>. <article-title>Phylogenetic analysis under Dollo&#x2019;s law</article-title>. <source>Syst Zool</source>. <volume>26</volume>:<fpage>77</fpage>&#x2013;<lpage>88</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Fawcett</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Innan</surname> <given-names>H.</given-names></string-name> <year>2013</year>. <article-title>The role of gene conversion in preserving rearrangement hotspots in the human genome</article-title>. <source>Trends in Genetics</source> <volume>29</volume>:<fpage>561</fpage>&#x2013;<lpage>568</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1981</year>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source>. <volume>17</volume>:<fpage>368</fpage>&#x2013;<lpage>376</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="book"><string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>2004</year>. <source>Inferring Phylogenies</source>. <publisher-loc>Sunderland (MA)</publisher-loc>, <publisher-name>Sinauer Associates</publisher-name>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="book"><person-group person-group-type="editor"><string-name><surname>Gascuel</surname> <given-names>O</given-names></string-name></person-group> (editor). <year>2005</year>. <source>Mathematics of Evolution and Phylogeny</source>. <publisher-loc>New York</publisher-loc>, <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Graham</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Reeves</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Burns</surname> <given-names>ACE</given-names></string-name>, <string-name><surname>Olmstead</surname> <given-names>RG</given-names></string-name>. <year>2000</year>. <article-title>Microstructural changes in noncoding chloroplast DNA: Interpretation, evolution, and utility of indels and inversions in basal angiosperm phylogenetic inference</article-title>. <source>Int J Plant Sci</source> <volume>161</volume>:<fpage>S83</fpage>&#x2013;<lpage>S96</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="book"><string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Li</surname> <given-names>WH</given-names></string-name>. <year>2000</year>. <source>Fundamentals of Molecular Evolution</source>, <edition>2nd ed.</edition> <publisher-loc>Sunderland (MA)</publisher-loc>, <publisher-name>Sinauer Associates</publisher-name>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Gu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Lupski</surname> <given-names>JR</given-names></string-name>. <year>2008</year>. <article-title>Mechanisms for human genomic rearrangements</article-title>. <source>PathoGenetics</source> <volume>1</volume>:<fpage>4</fpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Kelshner</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Wendel</surname> <given-names>JF</given-names></string-name>. <year>1996</year>. <article-title>Hairpins create minute inversions in non-coding regions of chloroplast DNA</article-title>. <source>Curr Genet</source> <volume>30</volume>:<fpage>259</fpage>&#x2013;<lpage>262</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Kent</surname> <given-names>WJ</given-names></string-name>, <string-name><surname>Baertsch</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hinrichs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>W</given-names></string-name>, and <string-name><surname>Haussler</surname> <given-names>D.</given-names></string-name> <year>2003</year>. <article-title>Evolution&#x2019;s cauldron: duplication, deletion, and rearrangement in the mouse and human genomes</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>100</volume>:<fpage>11484</fpage>&#x2013;<lpage>11489</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>L&#x00E8;bre</surname> <given-names>S</given-names></string-name>, <string-name><surname>Michel</surname> <given-names>CJ</given-names></string-name>. <year>2010</year>. <article-title>A stochastic evolution model for residue insertion-deletion independent from substitution</article-title>. <source>Comput Biol Chem</source>. <volume>34</volume>:<fpage>259</fpage>&#x2013;<lpage>267</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>L&#x00E8;bre</surname> <given-names>S</given-names></string-name>, <string-name><surname>Michel</surname> <given-names>CJ</given-names></string-name>. <year>2013</year>. <article-title>A new molecular evolution model for limited insertion independent of substitution</article-title>. <source>Math Biosci</source>. <volume>245</volume>:<fpage>137</fpage>&#x2013;<lpage>147</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Lunter</surname> <given-names>G.</given-names></string-name> <year>2007</year>. <article-title>Probabilistic whole-genome alignments reveal high indel rates in the human and mouse genomes</article-title>. <source>Bioinformatics</source> <volume>23</volume>:<fpage>i289</fpage>&#x2013;<lpage>i296</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Lunter</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hein</surname> <given-names>J.</given-names></string-name> <year>2004</year>. <article-title>A nucleotide substitution model with nearest-neighbour interactions</article-title>. <source>Bioinformatics</source> <volume>20</volume>:<fpage>i216</fpage>&#x2013;<lpage>i223</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="book"><string-name><surname>Lynch</surname> <given-names>M.</given-names></string-name> <year>2007</year>. <source>The Origins of Genome Architecture</source>. <publisher-loc>Sunderland (MA)</publisher-loc>, <publisher-name>Sinauer Associates</publisher-name>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Mikl&#x00F3;s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Lunter</surname> <given-names>GA</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>I.</given-names></string-name> <year>2004</year>. <article-title>A &#x201C;long indel&#x201D; model for evolutionary sequence alignment</article-title>. <source>Mol Biol Evol</source>. <volume>21</volume>:<fpage>529</fpage>&#x2013;<lpage>540</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Mikl&#x00F3;s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Nov&#x00E1;k</surname> <given-names>&#x00C1;</given-names></string-name>, <string-name><surname>Satija</surname> <given-names>R</given-names></string-name>, <string-name><surname>Lyngs&#x00F8;</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hein</surname> <given-names>J.</given-names></string-name> <year>2009</year>. <article-title>Stochastic models of sequence evolution including insertion-deletion events</article-title>. <source>Stat Methods Med Res</source>. <volume>18</volume>:<fpage>453</fpage>&#x2013;<lpage>485</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Morgante</surname> <given-names>M</given-names></string-name>, <string-name><surname>De Paoli</surname> <given-names>E</given-names></string-name>, <string-name><surname>Radovic</surname> <given-names>S.</given-names></string-name> <year>2007</year>. <article-title>Transposable elements and the plant pan-genomics</article-title>. <source>Curr Opin Plant Biol</source>. <volume>10</volume>:<fpage>149</fpage>&#x2013;<lpage>155</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Paten</surname> <given-names>B</given-names></string-name>, <string-name><surname>Herrero</surname> <given-names>J</given-names></string-name>, <string-name><surname>Beal</surname> <given-names>K</given-names></string-name>, <string-name><surname>Fitzgerald</surname> <given-names>S</given-names></string-name>, <string-name><surname>Birney</surname> <given-names>E.</given-names></string-name> <year>2008b</year>. <article-title>Enredo and Pecan: Genome-wide mammalian consistency-based multiple alignment with paralogs</article-title>. <source>Genome Res</source>. <volume>18</volume>:<fpage>1814</fpage>&#x2013;<lpage>1828</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Rivas</surname> <given-names>E.</given-names></string-name> <year>2005</year>. <article-title>Evolutionary models for insertions and deletions in a probabilistic modeling framework</article-title>. <source>BMC Bioinformatics</source> <volume>6</volume>:<fpage>63</fpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Rivas</surname> <given-names>E</given-names></string-name>, <string-name><surname>Eddy</surname> <given-names>SR</given-names></string-name>. <year>2008</year>. <article-title>Probabilistic phylogenetic inference with insertions and deletions</article-title>. <source>PLoS Comput Biol</source>. <volume>4</volume>:<fpage>e1000172</fpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Sainudiin</surname> <given-names>R</given-names></string-name>, <string-name><surname>Durrett</surname> <given-names>RT</given-names></string-name>, <string-name><surname>Aquadro</surname> <given-names>CF</given-names></string-name>, <string-name><surname>Nielsen</surname> <given-names>R.</given-names></string-name> <year>2004</year>. <article-title>Microsatellite mutation models: insights from a comparison of humans and chimpanzees</article-title>. <source>Genetics</source> <volume>168</volume>:<fpage>383</fpage>&#x2013;<lpage>395</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Saitou</surname> <given-names>N</given-names></string-name>, <string-name><surname>Kitano</surname> <given-names>T.</given-names></string-name> <year>2013</year>. <article-title>The PNarec method for detection of ancient recombinations through phylogenetic network analysis</article-title>. <source>Mol Phylogen Evol</source>. <volume>66</volume>:<fpage>507</fpage>&#x2013;<lpage>514</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Teshima</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Innan</surname> <given-names>H.</given-names></string-name> <year>2012</year>. <article-title>The coalescent with selection on copy number variants</article-title>. <source>Genetics</source> <volume>190</volume>:<fpage>1077</fpage>&#x2013;<lpage>1086</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><collab>The Chimpanzee Sequencing and Analysis Consortium</collab>. <year>2005</year>. <article-title>Initial sequence of the chimpanzee genome and comparison with the human genome</article-title>. <source>Nature</source> <volume>437</volume>:<fpage>69</fpage>&#x2013;<lpage>87</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><collab>The International Chimpanzee Chromosome 22 Consotrium</collab>. <year>2004</year>. <article-title>DNA sequence and comparative analysis of chimpanzee chromosome 22</article-title>. <source>Nature</source> <volume>429</volume>:<fpage>382</fpage>&#x2013;<lpage>388</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Thorne</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Kishino</surname> <given-names>H</given-names></string-name>, <string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1991</year>. <article-title>An evolutionary model for maximum likelihood alignment of DNA sequences</article-title>. <source>J Mol Evol</source>. <volume>33</volume>:<fpage>114</fpage>&#x2013;<lpage>124</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Thorne</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Kishino</surname> <given-names>H</given-names></string-name>, <string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1992</year>. <article-title>Inching toward reality: an improved likelihood model of sequence evolution</article-title>. <source>J Mol Evol</source>. <volume>34</volume>:<fpage>3</fpage>&#x2013;<lpage>16</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Tian</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>P</given-names></string-name>, <string-name><surname>Araki</surname> <given-names>H</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kreitman</surname> <given-names>M</given-names></string-name>, <string-name><surname>Nagylaki</surname> <given-names>T</given-names></string-name>, <string-name><surname>Hudson</surname> <given-names>R</given-names></string-name>, <string-name><surname>Bergelson</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>JQ</given-names></string-name>. <year>2008</year>. <article-title>Single-nucleotide mutation rate increases close to insertions/deletions in eukaryotes</article-title>. <source>Nature</source> <volume>455</volume>:<fpage>105</fpage>&#x2013;<lpage>108</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Waterhouse</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Russell</surname> <given-names>RR</given-names></string-name>. <year>2006</year>. <article-title>Dispensable genes and foreign DNA in Streptococcus mutants</article-title>. <source>Microbiology</source> <volume>152</volume>:<fpage>1777</fpage>&#x2013;<lpage>1788</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="book"><string-name><surname>Yang</surname> <given-names>Z.</given-names></string-name> <year>2006</year>. <source>Computational Molecular Evolution</source>. <publisher-loc>New York (NY)</publisher-loc>, <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
</ref-list>
</back>
</article>
