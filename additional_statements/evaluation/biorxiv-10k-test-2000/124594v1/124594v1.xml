<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/124594</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Developmental Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Mouse embryonic stem cells can differentiate via multiple paths to the same state</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Briggs</surname>
<given-names>James A.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Li</surname>
<given-names>Victor C.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref></contrib>
<contrib contrib-type="author">
<name>
<surname>Lee</surname>
<given-names>Seungkyu</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Woolf</surname>
<given-names>Clifford J.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Klein</surname>
<given-names>Allon M.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002B;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6540-6130</contrib-id>
<name>
<surname>Kirschner</surname>
<given-names>Marc W.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002B;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Systems Biology, Harvard Medical School</institution>, Boston, MA 02115.</aff>
<aff id="a2"><label>2</label><institution>Department, of Neurobiology, Harvard Medical School, and FM Kirby Neurobiology Center Boston Children&#x2019;s Hospital</institution>, Boston, MA 02115.</aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>&#x002A;</label><p>These authors contributed equally to this work.</p></fn>
<corresp id="cor1"><label>&#x002B;</label>Correspondence: <email>marc@hms.harvard.edu</email>; <email>Allon_Klein@hms.harvard.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>124594</elocation-id>
<history>
<date date-type="received">
<day>05</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>05</day>
<month>4</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="124594.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>In embryonic development, cells must differentiate through stereotypical sequences of intermediate states to generate mature states of a particular fate. By contrast, direct programming can generate similar fates through alternative routes, by directly expressing terminal transcription factors. Yet the cell state transitions defining these new routes are unclear. We applied single-cell RNA sequencing to compare two mouse motor neuron differentiation protocols: a standard protocol approximating the embryonic lineage, and a direct programming method. Both undergo similar early neural commitment. Then, rather than transitioning through spinal intermediates like the standard protocol, the direct programming path diverges into a novel transitional state. This state has specific and abnormal gene expression. It opens a &#x2018;loop&#x2019; or &#x2018;worm hole&#x2019; in gene expression that converges separately onto the final motor neuron state of the standard path. Despite their different developmental histories, motor neurons from both protocols structurally, functionally, and transcriptionally resemble motor neurons from embryos.</p>
</abstract>
<counts>
<page-count count="31"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Embryonic development proceeds through defined intermediate states, such as germ layer intermediates, and lineage-specific progenitors. Intermediates bifurcate into multiple states over time, and specialize their behaviors, ultimately producing a lineage tree that defines each mature cell type by a particular sequence of intermediates. This was first appreciated through classical lineage tracing and cell ablation studies. These studies showed that specifically labeled intermediate states generate stereotyped sets of downstream cell types, and that these downstream cell types fail to form if an intermediate that is upstream in their lineage is ablated<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup>. Furthermore, embryos in general do not produce a mature cell type through multiple differentiation paths.</p>
<p>In contrast to this rigid and hierarchical process, recent protocols that experimentally directly program cell fate suggest that the exact sequence of intermediates defining a lineage may be more flexible<sup><xref ref-type="bibr" rid="c3">3</xref>-<xref ref-type="bibr" rid="c11">11</xref></sup>. These studies reveal that mature cell states can be reached through paths that do not involve activation of the intermediate progenitor genes that are essential in embryos. Mouse embryonic stem cells (mESCs), for example, can be converted into motor neurons (MNs) by a process that involves overexpression of three transcription factors, Ngn2&#x002B;Isl1&#x002B;Lhx3<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c12">12</xref></sup>, and that never expresses the neural progenitor transcription factors Sox1 and Olig2<sup><xref ref-type="bibr" rid="c3">3</xref></sup>. mESCs can also be driven rapidly into a terminal muscle phenotype without normal upregulation of intermediate genes such as Pax7 and Myf5, through a combination of cell-cycle inhibition and MyoD overexpression<sup><xref ref-type="bibr" rid="c4">4</xref></sup>. This plasticity of differentiation extends further, to the interconversion of mature cell states. Fibroblasts can be converted into mature neuron phenotypes<sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup>, including MNs<sup><xref ref-type="bibr" rid="c5">5</xref></sup>, seemingly without completely dedifferentiating and retracing the embryonic lineage, as indicated by lack of expression of specific core pluripotency (Oct4, Sox2 and Nanog) and neural progenitor genes (Nestin)<sup><xref ref-type="bibr" rid="c5">5</xref></sup>.</p>
<p>Although these direct programming (DP) experiments imply the existence of differentiation paths that differ from those in embryos, much of what actually occurs in these new programs remains mysterious. Does DP bypass normal intermediates by short-circuiting the natural lineage, or does it transition through alternative intermediates (<xref ref-type="fig" rid="fig1">Fig. 1a</xref>)? Does it diverge only briefly to bypass specific early or late states, or does it utilize an entirely distinct path (<xref ref-type="fig" rid="fig1">Fig. 1b</xref>)? And can DP converge fully to the same final state that is produced in embryos despite taking an alternative path (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>)? These questions have been challenging to answer in part due to the high degree of heterogeneity in direct programming experiments, where unbiased bulk measurements of global gene expression obscure changes, and also because marker genes allowing the isolation of new but potentially important DP-specific intermediates are not known in advance. Here we aimed to overcome these issues by applying single cell RNA sequencing to compare the gene expression trajectories of DP and growth factor guided differentiation of mESCs over time into MNs. Our core research questions are summarized in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Summary of core research questions.</title>
<p>a) Direct programming could in principle skip progenitor states in one of two ways. It may either transition from early states directly into later states through a &#x2018;short-circuit&#x2019; of the natural lineage, or it might utilize an alternative path involving new and potentially abnormal or unstable intermediate states. In the schematic, a conceptual depiction of the natural lineage is shown first, followed by two lineages that bypass the <italic>i2</italic> intermediate from the normal lineage, either through short-ciruit or through a new alternative intermediate, b) DP might diverge from the natural lineage only briefly, or it might access an entirely distinct path. In the schematic, three different possibilities are shown: i) DP bypasses specific early intermediates, and then converges to the final state through a conserved seqeunce of terminal cell state transitions; ii) DP transitions through conserved early stages of differentiation, before diverging into an alternate path that converges separately to the final state; iii) DP takes an entirely distinct path with no resemblance to the natural lineage. Dashed lines represent a potential direct transition while solid lines represent an alternate path (as shown in the left panel), c) It is possible that the price paid for taking an alternate differentiation path during direct programming is that cells retain subtle gene expression defects, thus converging only partially to the desired final state. Alternatively, convergence could be near perfect which would imply that differentiation into mature cell states is at least partially history independent. In the schematic, circles are an abstract representation of gene expression state and are used to represent the extent of overlap between MNs generated by either DP or by the natural lineage.</p>
</caption>
<graphic xlink:href="124594_fig1.tif"/>
</fig>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Dissection of two MN differentiation protocols using InDrops single cell RNA sequencing</title>
<p>We compared two <italic>in vitro</italic> differentiation protocols that convert mESCs into MNs. Spinal MNs were chosen for study because these protocols have been highly optimized. The first, standard protocol (SP) is a widely used method that attempts to recapitulate the known embryonic intermediates through sequential exposure of developmental signals (Fgfs, Retinoic Acid, and Sonic hedgehog)(<xref ref-type="fig" rid="fig1">Fig. 1A</xref>)<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. It provides an approximation of the lineage through which motor neurons develop in the embryo. The second, direct programming (DP) protocol involves driving the expression of transcription factors (Ngn2&#x002B;Isl1&#x002B;Lhx3)<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c12">12</xref></sup> that characterize the mature motor neuron state and at the same time favoring and stabilizing the G1 state by incubating in a growth factor free medium<sup><xref ref-type="bibr" rid="c4">4</xref></sup>.</p>
<p>We used single-cell RNA sequencing (InDrops)<sup><xref ref-type="bibr" rid="c15">15</xref></sup> to track the differentiation trajectories of both protocols over time (<xref ref-type="fig" rid="fig1">Figs. 1B</xref> and <xref ref-type="fig" rid="fig1">1C</xref>). Single-cell data has emerged as a powerful way to trace differentiation processes, particularly in populations that are not pure and that contain rare intermediates<sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c16">16</xref>-<xref ref-type="bibr" rid="c20">20</xref></sup>. We profiled a total of 4,590 cells sampled from early (day 4/5) and late (day 11/12) timepoints for each protocol, and also used our previously published data from 975 mES cells<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. To visualize the single cell data and identify cell states we applied t-distributed stochastic neighbor embedding (tSNE) to reduce dimensionality<sup><xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c22">22</xref></sup>, defined cell states using an unsupervised density gradient clustering approach, and then found specific marker genes with known annotations to reveal the identity of each state (<xref ref-type="fig" rid="fig2">Fig. 2B</xref> - <xref ref-type="fig" rid="fig2">2E</xref>; <xref ref-type="fig" rid="figS1">Supp. Figs. S1</xref> and <xref ref-type="fig" rid="figS2">S2</xref>; Supplementary methods). For each protocol, the dominant feature was a continuous gene expression trajectory sweeping across the 2D plot. These trajectories correlate with chronology: they begin with mESCs, pass through neural progenitor states and terminate in mature MN states. In both protocols we also observed a mixture of off-target differentiation byproducts from all three germ layers.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Dissection of DP and SP motor neuron differentiation strategies using InDrops single cell RNA sequencing.</title>
<p>a) Summary of the direct programming (DP) and standard protocol (SP) differentiation strategies, b-c) tSNE visualization of single cell RNA sequencing data from each differentiation strategy. Timepoints are shown inset. Cell state clusters are color coded and annotated with their identities: ESC &#x003D; embryonic stem cell; NP &#x003D; neural progenitor; PNP &#x003D; posterior neural progenitor; PVNP &#x003D; posterior and ventral neural progenitor; MNP &#x003D; motor neuron progenitor; EMN &#x003D; early motor neuron; LMN &#x003D; late motor neuron; CN &#x003D; cortical neuron; DSCN &#x003D; dorsal spinal cord neuron; Gil &#x003D; glia type 1; GI2 &#x003D; glia type 2; Mus &#x003D; muscle; Meso &#x003D; mesoderm; Endo &#x003D; endoderm; Oligo &#x003D; oligodendrocyte; Astro &#x003D; astrocyte; Stro &#x003D; stromal. Arrows inside the bounded area indicate the hypothesized cell state progression during MN differentiation for each method, d-e) Expression heatmap of marker genes used to identify each subpopulation. Colors and annotations for the subpopulations are the same, f-g) Subpopulation abundances for each protocol over time. DP has significantly high MN production efficiency than SP (66&#x0025; vs. 9&#x0025;) at the late timepoint. MN &#x003D; EMN or LMN; NP &#x003D; NP, PNP, or PVNP; Other &#x003D; everything else. Colors and labels match b-e).</p>
</caption>
<graphic xlink:href="124594_fig2.tif"/>
</fig>
<p>Our single cell data allowed us to define the efficiency of MN production for each method. For DP, MN production was observed as early as day 4 (19&#x0025;), and increased over time to 66&#x0025; by day 11 (<xref ref-type="fig" rid="fig2">Fig. 2F</xref>). A minority of off-target neuron subtypes, glia, and miscellaneous cells were also identified. In the SP 23&#x0025; and 9&#x0025; of the population resembled MNs at days 5 and 12 respectively (<xref ref-type="fig" rid="fig2">Fig. 2G</xref>). This lower efficiency was accompanied by a far larger fraction of off-target products including oligodendrocytes (7.2&#x0025;), astrocytes (8.6&#x0025;), muscle (30.6&#x0025;), and stroma (8.9&#x0025;) that together accounted for 55.3&#x0025; of the population by day 12.</p>
</sec>
<sec id="s2b">
<title>The DP differentiation trajectory lacks intermediates expressing Olig2 and Nkx6-1</title>
<p>What are the differentiation paths taken by each protocol? In the SP differentiation path, cells transit through seven states (<xref ref-type="fig" rid="fig2">Fig. 2C</xref> and <xref ref-type="fig" rid="fig2">2E</xref>). These state transitions parallel patterning events in the embryo<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref></sup>: cells first commit to the neural lineage (Sox1&#x002B;/Sox3&#x002B;), then are posteriorized (Hoxb8&#x002B;/Hoxd4&#x002B;), ventralized (Nkx6-1&#x002B;/Olig2&#x002B;), enter the committed MN progenitor state (Mnx1&#x002B;), and then mature into a neuronal phenotype (Tubb3&#x002B;/Map2&#x002B;). This is not a surprise as the growth factor cocktail defining this method was designed to reflect the signaling events taking place in the embryo. By contrast, we found that the path produced by DP was condensed relative to the SP path (<xref ref-type="fig" rid="fig2">Fig. 2B</xref> and <xref ref-type="fig" rid="fig2">2D</xref>), consisting of only four states as opposed to seven. After neural commitment (Sox1&#x002B;), cells immediately began expressing committed MN markers (Mnx1&#x002B;/Tubb3&#x002B;), seemingly without the typical spinal embryonic intermediates (Olig2-/Nkx6-1-). A lack of Olig2 expression during DP has been observed previously<sup><xref ref-type="bibr" rid="c3">3</xref></sup>, and our results confirm at the single cell level that intermediates expressing Olig2 and Nkx6-1 appear entirely absent. Olig2 is necessary for MN development in embryos<sup><xref ref-type="bibr" rid="c1">1</xref></sup>, indicating the DP drives differentiation from ESC into MNs through a new route.</p>
<p>We confirmed that our inferred dynamics from snapshot single-cell data correspond to the actual underlying differentiation dynamics by performing a dense qPCR time course for a panel of MN genes (<xref ref-type="fig" rid="figS3">Supp. Fig. S3</xref>). These bulk measurements confirmed that, for DP, committed MN markers are upregulated immediately following early neural progenitor genes in real time.</p>
</sec>
<sec id="s2c">
<title>The DP and SP trajectories bifurcate after early neural commitment and converge separately to the MN state</title>
<p>Since the DP omits spinal embryonic intermediates characteristic of the SP path, there must be one of two possible trajectories. Either DP must discontinuously transition from an early neural progenitor into a MN, or it must transit through alternate intermediate state(s). To determine which of these possibilities was the case, we employed a data visualization technique called SPRING<sup><xref ref-type="bibr" rid="c25">25</xref></sup> to directly compare the topology of both paths. While tSNE is a powerful method for identifying discrete cell states, SPRING provides a complementary description emphasizing continuum gene expression topologies. SPRING builds a k-nearest-neighbor graph over cells in high-dimensional gene expression space, and then renders an interactive 2D visualization of the cell graph using a force directed layout. This representation revealed that the DP and SP trajectories overlap during early neural commitment, but that they then bifurcate and transit distinct paths that converge independently to the same MN state (<xref ref-type="fig" rid="fig3">Fig. 3A</xref>). The dynamics of gene expression over these trajectories resembled the behavior inferred using tSNE, with DP omitting intermediate progenitor genes following its bifurcation from the SP path (<xref ref-type="fig" rid="fig3">Fig. 3B</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>DP and SP induce distinct differentiation paths to the motor neuron state.</title>
<p>a) Visualization of differentiation paths for both protocols using SPRING reveals two paths to the same state. DP and SP overlap during early neural commitment, but then bifurcate and converge to the same final MN state separately. Reds &#x003D; direct programming path; Blues &#x003D; standard protocol path; arrows indicate hypothezed differentiation trajectories. Cell states are colored and labeled by according to their definition in <xref ref-type="fig" rid="fig1">Figure 1</xref> for comparison, b) Gene expression of key marker genes along each differentiation path confirms exit from the pluripotent state (Oct4) and progression towards the MN state (Tubb3, Stmn2) for both protocols. Only the SP upregulates Olig2 and Nkx6-1, which mark important MN lineage intermediates in the embryo; this occurs following the bifurcation of both paths. Expression in cells from each sample are colored using either a blue (ESC), red (DP), or green (SP) colormap to allow tracking of each path separately, c) Pairwise cosine similarity of cell state centroids. Note early and late similarity of states, but prominent differences during intermediate state transitions, d) Every individual cell of the DP trajectory was assigned to its most similar SP state using a maximum likelihood method. DP cells map to early and late but not intermediate states of the SP cell state progression.</p>
</caption>
<graphic xlink:href="124594_fig3.tif"/>
</fig>
<p>The bifurcation and subsequent convergence of the two differentiation paths can also be appreciated by two other complementary analyses. Pairwise cosine similarities between the cell states from both trajectories (<xref ref-type="fig" rid="fig3">Fig. 3C</xref>; Supplementary methods) indicate similarities between the early states (ESC and NP; cosine similarity &#x003E; 0.64) and late states (LMN; cosine similarity &#x003D; 0.55), but not the intermediate states (PNP, PVNP, and MNP; cosine similarity &#x003C; &#x2212;0.28, &#x2212;0.09, and 0.06 respectively). We also assigned every individual cell along the DP path to its most similar cluster in the SP path using a maximum likelihood method (<xref ref-type="fig" rid="fig3">Fig. 3D</xref>; Supplementary methods). This showed that it was virtually impossible to find a single cell resembling the SP intermediate progenitors in the DP approach. Similarity was again seen only at the early and late states.</p>
</sec>
<sec id="s2d">
<title>DP transitions through an abnormal intermediate state with forebrain gene expression</title>
<p>The bifurcation of the SP and DP trajectories leads to different intermediate cell states in each case. A total of 26 transcription factors (TFs) are differentially expressed between the DP and SP intermediate states (<xref ref-type="fig" rid="fig4">Fig. 4A</xref>). A majority of these (61&#x0025;) were involved in an anterior-posterior positional gene expression axis. The SP intermediates were enriched more than 6-fold for nine posterior and spinal TFs including Olig2, Nkx6-1, Lhx3, and six Hox genes with a corrected p-value &#x003C; 0.001. Each of these TFs is expressed in embryonic MNs. By contrast, the DP intermediates were enriched for seven forebrain TFs including Otx2, Otx1, Crx, Six1, Dmrta2, Zic1, and Zic3 at the same stringency, despite the absence of MNs in the forebrain of embryos. Anterior gene expression was previously observed through bulk measurements of DP<sup><xref ref-type="bibr" rid="c3">3</xref></sup>, and our results reveal that it occurs within a specific subpopulation of cells in the process of differentiating into MNs. We validated these expression differences by isolating intermediate populations of each differentiation path using a Mnx1::GFP reporter cell line, since Mnx1 expression is localized precisely to the distinct intermediate populations of each path (<xref ref-type="fig" rid="fig3">Fig. 3B</xref>). Bulk comparisons of these two populations confirmed the enrichment of forebrain TFs, and depletion of spinal progenitor and positional genes in the DP intermediates with just one exception &#x2013; Zic1 was enriched in DP by our single cell comparison but in SP by microarray (<xref ref-type="fig" rid="fig4">Fig. 4A</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>The DP differentiation trajectory involves an abnormal transitional state characterized by a transient positional gene expression defect.</title>
<p>a) The DP (red, EMN) and SP (black, PVNP&#x002B;MNP&#x002B;EMN) differentiation paths diverge into distinct intermediate states following early neural commitment. These distinct populations were compared by <italic>in silico</italic> differential expression analysis using single cell data (bottom left), or by FACS purification of the intermediate populations using and Mnx1::GFP reporter cell line followed by microarray analysis (bottom right). <xref ref-type="fig" rid="fig3">Fig. 3b</xref>. shows that Mnx1 expression localizes to the distinct intermediate populations of both protocols, making it an appropriate target for their purification. Differential expression analysis revealed a total of 26 differentially expressed TFs between the intermediate populations (&#x003E;6-fold differentially expressed, p&#x003C;0.001), of which (61&#x0025;) were involved in either forebrain positional identity (Otx2, Crx, Zic1, Six1, Dmrta2, Otx1, and Zic3) and enriched in DP, or in posterior spinal identity (Hoxb8, Hoxb3, Hoxb2, Hoxb4, Hoxb5, Hoxd4, Lhx3, Olig2, and Nkx6-1) and enriched in SP. The independent microarray comparison confirmed this differences with only one exception - Zic1. It also revealed that the SP intermediates are enriched for additional spinal neural progenitor genes including Ascl1, Nkx6-2, Olig1, and Nkx2-2. b) Before forebrain genes are expressed, DP cells have a high proliferation score and low cell-cycle exit score (computed as the sum of a panel of cell-cycle-associated or tumor supressor genes respectively). They reduce cell cycle gene expression as they enter the abnormal transitional state, and upregulate forebrain genes including Otx2 and Crx. This abnormal forebrain expression is shut off as cells exit the transitional state into the final MN state. The final transition into a MN state is also accompanied by upregulation of posterior positional genes including Hoxb4 and Hoxd3, thus correcting the transient forebrain positional expression defect. Expression in cells from each sample are colored using either a blue (ESC), red (DP), or green (SP) colormap to allow tracking of each path separately.</p>
</caption>
<graphic xlink:href="124594_fig4.tif"/>
</fig>
<p>The abnormal positional gene expression signature that characterizes the DP intermediate state appears transient. Forebrain gene expression is upregulated along the DP differentiation path as cells exit the early NP state into the EMN intermediate state (<xref ref-type="fig" rid="fig4">Fig. 4B</xref>). This transition is also accompanied by the downregulation of proliferation-associated genes (<xref ref-type="fig" rid="fig4">Fig. 4B</xref>; <xref ref-type="fig" rid="figS4">Supp. Fig. S4</xref>). By the time cells exit the EMN state and transition into the more differentiated LMN state, they downregulate forebrain genes and replace this abnormal positional signature with a spinal Hox expression signature characteristic of normal MNs (<xref ref-type="fig" rid="fig4">Fig. 4B</xref>). Thus cells converge to the MN state in positional as well as neuronal identity gene expression in the final stages of DP.</p>
</sec>
<sec id="s2e">
<title>Both DP and SP approach a transcriptional state similar to <italic>bona-fide</italic> MNs in embryos</title>
<p>Given that the two protocols induce distinct &#x2013; and in the case of DP, unnatural &#x2013; differentiation paths, we were curious how their final products compared with primary MNs. We harvested MNs from the embryo of a Mnx1::GFP reporter mouse and performed inDrops measurements on 874 E13.5 MNs after FACS purification. Though the majority of Hb9&#x002B; sorted cells were MNs (73.8&#x0025;), this population also contained glia (20.1&#x0025;), fibroblast-like cells (1.8&#x0025;), and immune-type cells (1.2&#x0025;; <xref ref-type="fig" rid="fig5">Fig. 5A</xref>; <xref ref-type="fig" rid="figS5">Supp. Fig. S5</xref>). Using only the cells identified as <italic>bona-fide</italic> MNs, we probed the similarity of the <italic>in vitro</italic> derived cells to the primary MNs, using three measures: global similarity of the transcriptomes (cosine similarity); co-clustering frequency; and differential gene expression analysis. In both paths, neurons become more similar to primary MNs over time (<xref ref-type="fig" rid="fig5">Fig. 5B</xref>). The clusters most highly correlated with primary MNs were the LMN state from the DP protocol (cosine similarity &#x003D; 0.62), and the LMN state from the SP (cosine similarity &#x003D; 0.37). Notably, only 2.7&#x0025; of output cells from the SP were in the LMN state, compared to 62.7&#x0025; for DP. Thus, the ratio of the efficiency of forming LMNs by the DP protocol to the SP protocol is 23 fold, seven-fold higher than what we calculated based on a comparison of marker genes alone. At the level of single cells, co-clustering of the different experiments showed that 95&#x0025; of DP MNs robustly co-cluster with primary MNs compared with 26&#x0025; for SP derived MNs (<xref ref-type="fig" rid="figS6">Supp. Fig. S6</xref>). However, differential gene expression analysis revealed that neither protocol perfectly recapitulates the gene expression profile of MNs isolated from the mouse. Both protocols showed a depletion of the most posterior Hox genes, perhaps indicating an anterior spinal cord identity of <italic>in vitro</italic> MNs, and a small enrichment of several genes related to microtubule function and cell cycle exit that may indicate subtle differences in neuronal maturation (<xref ref-type="fig" rid="figS7">Supp. Fig. S7</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>Validation that DP and SP trajectories both approach a <italic>bona-fide</italic> MN state.</title>
<p>a) tSNE visualization of 874 single cell transciptomes from FACS purified Mnx1&#x002B; MNs from embryos reveals heterogeneity within this population. b) Comparison of cell states along both trajectories with true primary MNs (orange population in a). In both DP and SP similarity increases as differentiation proceeds. Late DP states are the most similar to embryonic MNs. c) Immunostaining of MN markers in DP MNs confirming expression and correct subcellular localization of Tubb3, Map2, VACht, Isl1, and Hb9. DP MNs also: d) can fire single or multiple action potentials upon stimulation, e) show sodium and potassium channel currents, and f) are responsive to multiple MN neurotransmitters - AMPA, kainate, GABA, and glycine. g) Co-culture experiments show that DP MNs can induce clustering of acetylcholine receptors on muscle myotubes (indicated by &#x03B1;-BGT staining) and induce their contractions. The induced contractions are dependent on MN activity as they can be blocked by addition of the acetylcholine antagonist curare.</p>
</caption>
<graphic xlink:href="124594_fig5.tif"/>
</fig>
</sec>
<sec id="s2f">
<title>DP MNs have structural and functional properties of true MNs</title>
<p>Having established that MNs derived via both gene expression trajectories reach roughly the same MN transcriptional state, we wished to validate that their function and structural organization was also independent of their distinct developmental histories. The SP has been characterized extensively as giving rise to functional MNs<sup><xref ref-type="bibr" rid="c13">13</xref></sup>, so here we examined structural and functional characteristics following DP. We confirmed that selected protein content matches the mRNA markers by immunostaining for Tubb3, Map2, VACht, Isl1, and Hb9 (<xref ref-type="fig" rid="fig5">Fig. 5C</xref>). Tubb3 and Map2 were present, and VACht was seen at discrete puncta on the axons (suggesting localization to acetylcholine secretory vesicles). TFs Isl1 and Hb9 were localized in the nucleus. Finally, the GFP from the Mnx1::GFP reporter was activated and expressed in the cytoplasm. To test the functional properties of the DP MNs, we performed whole-cell patch clamp recordings. Depolarization induced single or multiple action potentials in current-clamp experiments (<xref ref-type="fig" rid="fig5">Fig. 5D</xref>). Depolarizing voltage steps induced fast inward currents and slow outward currents characteristic of sodium and potassium channels, respectively (<xref ref-type="fig" rid="fig5">Fig. 5E</xref>). Exposure to 500 nM Tetrodotoxin (TTX) blocked the inward current, indicating sodium channel involvement. We then tested whether our DP neurons would respond to neurotransmitters that act on MN (<xref ref-type="fig" rid="fig4">Fig. 4F</xref>). Exposure of the neurons to AMPA, kainate, GABA, and glycine (100 &#x03BC;M each) induced in each case inward currents similar to that seen in primary embryonic MNs. To see if the DP neurons could also form neuromuscular junctions, we co-cultured the neurons with differentiated C2C12 skeletal muscle myotubes and incubated them for 7 days. We observed clustering of acetylcholine receptors on the C2C12 myotubes near contact points with the DP neurons, which can be seen with alpha-bungarotoxin (&#x03B1;-BGT), which binds to acetylcholine receptors (<xref ref-type="fig" rid="fig4">Fig. 4G</xref>). We then observed regular contractions of some C2C12 myotubes that began after several days in co-culture (<xref ref-type="fig" rid="fig4">Fig. 4G</xref>, Supp. Video 1). These contractions could be stopped by the addition of 300 &#x03BC;M Tubocurarine (curare), an antagonist of acetylcholine receptors, indicating that the contractions were induced by the acetylcholine release from the MNs. Similarly, we noticed that the DP MNs could induce contractions in DP muscle myotubes that we previously generated with MyoD (Supp. Video 2)<sup><xref ref-type="bibr" rid="c4">4</xref></sup>. These results confirm that DP MNs have the expected functional properties of <italic>bona-fide</italic> MNs.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>The results we have described provide evidence at the single cell level that differentiation can proceed by multiple routes yet converge onto similar transcriptional states. We show that while using the SP cells are driven to retrace the embryonic lineage, DP induces cells to differentiate through a dramatically different path. The DP path bypasses multiple intermediate progenitor-states that evolved in the embryo, and yet still converges to the same discrete and recognizable MN phenotype. This convergence occurs from an abnormal intermediate state, and does not appear to involve a shared set of terminal cell state transitions; it is highly orthogonal. Moreover, as cells converge they manage to not only establish gene expression related to MN functions, but they also correct positional gene expression defects (exchanging forebrain for spinal gene expression) in the absence of external signals. Relative to our initial research questions (<xref ref-type="fig" rid="fig1">Fig. 1</xref>), we conclude that DP of mESCs into MNs occurs via a late bypass that involves alternative intermediate states not seen in the embryo, and that this new route converges near perfectly to the same final state. Convergence into a MN therefore does not appear to depend rigidly on the precise history of intermediate states through which cells differentiate.</p>
<p>This &#x2018;history independence&#x2019; of the final state is consistent with a dynamical view of gene regulation in which cell states correspond to &#x2018;attractor basins&#x2019;, i.e. stable states of gene expression that are robust to modest perturbations. If attractor basins do not exist, the precision of the observed overlap between DP and SP MNs would require a special coincidence, like finding a needle in a high dimensional haystack. The concept of cell states behaving as attractors has been proposed previously to explain several properties of blood cell types<sup><xref ref-type="bibr" rid="c26">26</xref>-<xref ref-type="bibr" rid="c28">28</xref></sup>. There are at least two important corollaries of this behavior applying in development. From a practical perspective, it is a common concern that DP methods may generate cell types with subtle defects due to their unusual developmental histories<sup><xref ref-type="bibr" rid="c9">9</xref></sup>. Attractors would be robust to this vulnerability and indeed our results show that it is not necessary to recreate the precise sequences of steps taken in embryos to generate <italic>bona-fide</italic> MNs. It could also hint at a mechanism that might help animal body plans evolve flexibly. Specifically, by decoupling the identity of mature cell state attractors from their developmental histories evolution would be able to act on each independently. In principle this could contribute to evolvability by allowing mature cell states to be transposed onto new lineages in new body locations.</p>
<p>The mechanisms that define the MN attractor basin and allow the artificial DP trajectory to converge onto the correct final state are largely unclear. The MN state is thought to be stabilized by a network of self-reinforcing TFs<sup><xref ref-type="bibr" rid="c24">24</xref></sup>, involving Mnr2, Mnx1, Lim3, Isl1, Isl2, and Lhx3, Ngn2, Myt1l, Nefl, and Nefm. DP aims to kick-start this network by activating a subset of important components. Yet, far from immediately activating this network, our data show that DP initially drives cells to differentiate into an early NP state through the same pathway as the SP trajectory, seemingly oblivious to the DP TFs, and then even activates non-MN genes in the transitional state. Understanding why the activation of the MN program lags behind TF induction may provide important clues into how the DP factors act. One possible source for a lag is that activating a complete neuronal program requires first activating additional core TFs (so-called &#x2018;feed-forward&#x2019; circuitry). Indeed, recent studies have shown that Ebf and Onecut are activated by Ngn2 (one of the DP TFs), and that both are required to subsequently direct binding of Isl1 and Lhx3 (the other two DP TFs) to MN target genes across the genome during DP<sup><xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c29">29</xref></sup>. A second possible source of lag is that extracellular signaling provides inputs that immediately affect cell state, but take time to sensitize cells to the DP factors. For example, signaling changes might activate DP TFs through post-translational modifications, by activating co-factors, or by inducing chromatin state changes. We have indeed observed that MNs are not generated if DP TFs are induced in cells cultured in pluripotency media, indicating a requirement for changes in signaling (not shown). Conversely, when mES cells are transferred to minimal media without inducing DP factors, they acquire a forebrain neural progenitor identity by default<sup><xref ref-type="bibr" rid="c30">30</xref>-<xref ref-type="bibr" rid="c32">32</xref></sup>. This suggests that the early dynamics and abnormal forebrain / MN expression of the DP transitional state might in fact be driven by the signaling environment and not the DP TFs. These alternatives suggest future experiments to better resolve the mechanisms driving the DP, by re-mapping the trajectory induced during DP after changing signaling conditions, or the choice of DP TFs.</p>
<p>As a methodology, DP is significantly more efficient than the SP without loss of quality in the MN populations produced (<xref ref-type="fig" rid="fig2">Fig. 2F-G</xref>; <xref ref-type="fig" rid="fig5">Fig. 5</xref>). The high-efficiency of DP likely derives from both its more uniform experimental conditions as well as its more direct differentiation path. Experimentally, DP: relies on 2D rather than 3D tissue culture (as in the SP), minimizing uncontrolled cell-cell communication; forces every individual cell to express MN TFs from a genetically integrated construct, increasing uniformity; and employs a defined-media without growth factors that may minimize proliferation of progenitor states. The more direct differentiation path induced by DP should also itself increase MN conversion efficiency by minimizing error propagation through chained opportunities for off-target fate choices. During sequences of intermediate cell state transitions, each transition can have competing off-target fates. Thus, differentiation processes that involve many sequential intermediate transitions suffer from multiplicative efficiency losses. Indeed, the longer sequence of intermediate states the in SP generates a far larger fraction of off-target populations that increases with time, suggesting a progressive loss of efficiency. Targeting terminal attractor basins through the shortest possible differentiation paths may prove to be a generally effective strategy to generate desired cell states.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We are grateful to Esteban Mazzoni for providing the transcription factor cassette containing ES cell line used in the DP experiments presented here.</p>
</ack>
<sec sec-type="COI-statement">
<title>Competing interests</title>
<p>V.L. and M.K. are cofounders of StemCellerant, LLC. A.K. and M.K. are cofounders of 1CellBio, Inc.</p>
</sec>
<sec>
<title>Author contributions</title>
<p>All authors helped design the study and its experimental questions. V. L. established the MN differentiation protocols and performed their molecular characterization. J. B. performed the single-cell data collection and analysis. S.L. did the electrophysiology recordings. M. K., A. K. and C.W. assisted with analysis and interpretation of experimental results. All authors contributed to the writing of the manuscript and preparation of figures.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><string-name><surname>Takebayashi</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>The basic helix-loop-helix factor olig2 is essential for the development of motoneuron and oligodendrocyte lineages</article-title>. <source>Current biology: CB</source> <volume>12</volume>, <fpage>1157</fpage>&#x2013;<lpage>1163</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><string-name><surname>Kretzschmar</surname>, <given-names>K.</given-names></string-name> &#x0026; <string-name><surname>Watt</surname>, <given-names>F. M.</given-names></string-name> <article-title>Lineage tracing</article-title>. <source>Cell</source> <volume>148</volume>, <fpage>33</fpage>&#x2013;<lpage>45</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cell.2012.01.002</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><string-name><surname>Mazzoni</surname>, <given-names>E. O.</given-names></string-name> <etal>et al.</etal> <article-title>Synergistic binding of transcription factors to cell-specific enhancers programs motor neuron identity</article-title>. <source>Nat Neurosci</source> <volume>16</volume>, <fpage>1219</fpage>&#x2013;<lpage>1227</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nn.3467</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>V. C.</given-names></string-name> &#x0026; <string-name><surname>Kirschner</surname>, <given-names>M. W.</given-names></string-name> <article-title>Molecular ties between the cell cycle and differentiation in embryonic stem cells</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>111</volume>, <fpage>9503</fpage>&#x2013;<lpage>9508</lpage>, doi:<pub-id pub-id-type="doi">10.1073/pnas.1408638111</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><string-name><surname>Son</surname>, <given-names>E. Y.</given-names></string-name> <etal>et al.</etal> <article-title>Conversion of mouse and human fibroblasts into functional spinal motor neurons</article-title>. <source>Cell stem cell</source> <volume>9</volume>, <fpage>205</fpage>&#x2013;<lpage>218</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.stem.2011.07.014</pub-id> (<year>2011</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><string-name><surname>Vierbuchen</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>Direct conversion of fibroblasts to functional neurons by defined factors</article-title>. <source>Nature</source> <volume>463</volume>, <fpage>1035</fpage>&#x2013;<lpage>1041</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature08797</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><string-name><surname>Ieda</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Direct reprogramming of fibroblasts into functional cardiomyocytes by defined factors</article-title>. <source>Cell</source> <volume>142</volume>, <fpage>375</fpage>&#x2013;<lpage>386</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cell.2010.07.002</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><string-name><surname>Szabo</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Direct conversion of human fibroblasts to multilineage blood progenitors</article-title>. <source>Nature</source> <volume>468</volume>, <fpage>521</fpage>&#x2013;<lpage>526</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature09591</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><string-name><surname>Cohen</surname>, <given-names>D. E.</given-names></string-name> &#x0026; <string-name><surname>Melton</surname>, <given-names>D.</given-names></string-name> <article-title>Turning straw into gold: directing cell fate for regenerative medicine</article-title>. <source>Nature reviews. Genetics</source> <volume>12</volume>, <fpage>243</fpage>&#x2013;<lpage>252</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nrg2938</pub-id> (<year>2011</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname>, <given-names>Q.</given-names></string-name> &#x0026; <string-name><surname>Melton</surname>, <given-names>D. A.</given-names></string-name> <article-title>Extreme makeover: converting one cell into another</article-title>. <source>Cell stem cell</source> <volume>3</volume>, <fpage>382</fpage>&#x2013;<lpage>388</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.stem.2008.09.015</pub-id> (<year>2008</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><string-name><surname>Treutlein</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Dissecting direct reprogramming from fibroblast to neuron using single-cell RNA-seq</article-title>. <source>Nature</source> <volume>534</volume>, <fpage>391</fpage>&#x2013;<lpage>395</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature18323</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="other"><string-name><surname>Velasco</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>A Multi-step Transcriptional and Chromatin State Cascade Underlies Motor Neuron Programming from Embryonic Stem Cells</article-title>. <source>Cell stem cell</source>, doi:<pub-id pub-id-type="doi">10.1016/j.stem.2016.11.006</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><string-name><surname>Wichterle</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lieberam</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Porter</surname>, <given-names>J. A.</given-names></string-name> &#x0026; <string-name><surname>Jessell</surname>, <given-names>T. M.</given-names></string-name> <article-title>Directed differentiation of embryonic stem cells into motor neurons</article-title>. <source>Cell</source> <volume>110</volume>, <fpage>385</fpage>&#x2013;<lpage>397</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="other"><string-name><surname>Wu</surname>, <given-names>C. Y.</given-names></string-name>, <string-name><surname>Whye</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>R. W.</given-names></string-name> &#x0026; <string-name><surname>Wang</surname>, <given-names>W.</given-names></string-name> <article-title>Efficient differentiation of mouse embryonic stem cells into motor neurons</article-title>. <source>Journal of visualized experiments: JoVE</source>, <fpage>e3813</fpage>, doi:<pub-id pub-id-type="doi">10.3791/3813</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><string-name><surname>Klein</surname>, <given-names>A. M.</given-names></string-name> <etal>et al.</etal> <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source> <volume>161</volume>, <fpage>1187</fpage>&#x2013;<lpage>1201</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><string-name><surname>Treutlein</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source> <volume>509</volume>, <fpage>371</fpage>&#x2013;<lpage>375</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature13173</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><string-name><surname>Scialdone</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Resolving early mesoderm diversification through single-cell expression profiling</article-title>. <source>Nature</source> <volume>535</volume>, <fpage>289</fpage>&#x2013;<lpage>293</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature18633</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nature biotechnology</source> <volume>32</volume>, <fpage>381</fpage>&#x2013;<lpage>386</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><string-name><surname>Setty</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nature biotechnology</source> <volume>34</volume>, <fpage>637</fpage>&#x2013;<lpage>645</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.3569</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><string-name><surname>Bendall</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal> <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source> <volume>157</volume>, <fpage>714</fpage>&#x2013;<lpage>725</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><string-name><surname>Amir el</surname>, <given-names>A. D.</given-names></string-name> <etal>et al.</etal> <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nature biotechnology</source> <volume>31</volume>, <fpage>545</fpage>&#x2013;<lpage>552</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><string-name><surname>van der Maaten</surname>, <given-names>L.</given-names></string-name> &#x0026; <string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name> <article-title>Visualizing Data using t-SNE</article-title>. <source>J Mach Learn Res</source> <volume>9</volume>, <fpage>2579</fpage>&#x2013;<lpage>2605</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><string-name><surname>Davis-Dusenbery</surname>, <given-names>B. N.</given-names></string-name>, <string-name><surname>Williams</surname>, <given-names>L. A.</given-names></string-name>, <string-name><surname>Klim</surname>, <given-names>J. R.</given-names></string-name> &#x0026; <string-name><surname>Eggan</surname>, <given-names>K.</given-names></string-name> <article-title>How to make spinal motor neurons</article-title>. <source>Development</source> <volume>141</volume>, <fpage>491</fpage>&#x2013;<lpage>501</lpage>, doi:<pub-id pub-id-type="doi">10.1242/dev.097410</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><string-name><surname>Jessell</surname>, <given-names>T. M.</given-names></string-name> <article-title>Neuronal specification in the spinal cord: inductive signals and transcriptional codes</article-title>. <source>Nature reviews. Genetics</source> <volume>1</volume>, <fpage>20</fpage>&#x2013;<lpage>29</lpage>, doi:<pub-id pub-id-type="doi">10.1038/35049541</pub-id> (<year>2000</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="other"><string-name><surname>Weinreb</surname>, <given-names>C. W.</given-names></string-name>, S; <string-name><surname>Klein</surname>, <given-names>A.</given-names></string-name> <article-title>SPRING: a kinetic interface for visualizing high dimensional single-cell expression data</article-title>. <source>bioRxiv</source>, doi: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1101/090332">https://doi.org/10.1101/0903321</ext-link> (<year>2016</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><string-name><surname>Chang</surname>, <given-names>H. H.</given-names></string-name>, <string-name><surname>Hemberg</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Barahona</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ingber</surname>, <given-names>D. E.</given-names></string-name> &#x0026; <string-name><surname>Huang</surname>, <given-names>S.</given-names></string-name> <article-title>Transcriptome-wide noise controls lineage choice in mammalian progenitor cells</article-title>. <source>Nature</source> <volume>453</volume>, <fpage>544</fpage>&#x2013;<lpage>547</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature06965</pub-id> (<year>2008</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><string-name><surname>Huang</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Guo</surname>, <given-names>Y. P.</given-names></string-name>, <string-name><surname>May</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Enver</surname>, <given-names>T.</given-names></string-name> <article-title>Bifurcation dynamics in lineage-commitment in bipotent progenitor cells</article-title>. <source>Developmental biology</source> <volume>305</volume>, <fpage>695</fpage>&#x2013;<lpage>713</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.ydbio.2007.02.036</pub-id> (<year>2007</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><string-name><surname>Huang</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Eichler</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Bar-Yam</surname>, <given-names>Y.</given-names></string-name> &#x0026; <string-name><surname>Ingber</surname>, <given-names>D. E.</given-names></string-name> <article-title>Cell fates as high-dimensional attractor states of a complex gene regulatory network</article-title>. <source>Phys Rev Lett</source> <volume>94</volume>, <fpage>128701</fpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><string-name><surname>Rhee</surname>, <given-names>H. S.</given-names></string-name> <etal>et al.</etal> <article-title>Expression of Terminal Effector Genes in Mammalian Neurons Is Maintained by a Dynamic Relay of Transient Enhancers</article-title>. <source>Neuron</source> <volume>92</volume>, <fpage>1252</fpage>&#x2013;<lpage>1265</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.neuron.2016.11.037</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><string-name><surname>Pankratz</surname>, <given-names>M. T.</given-names></string-name> <etal>et al.</etal> <article-title>Directed neural differentiation of human embryonic stem cells via an obligated primitive anterior stage</article-title>. <source>Stem cells</source> <volume>25</volume>, <fpage>1511</fpage>&#x2013;<lpage>1520</lpage>, doi:<pub-id pub-id-type="doi">10.1634/stemcells.2006-0707</pub-id> (<year>2007</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><string-name><surname>Smukler</surname>, <given-names>S. R.</given-names></string-name>, <string-name><surname>Runciman</surname>, <given-names>S. B.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>S.</given-names></string-name> &#x0026; <string-name><surname>van der Kooy</surname>, <given-names>D.</given-names></string-name> <article-title>Embryonic stem cells assume a primitive neural stem cell fate in the absence of extrinsic influences</article-title>. <source>The Journal of cell biology</source> <volume>172</volume>, <fpage>79</fpage>&#x2013;<lpage>90</lpage>, doi:<pub-id pub-id-type="doi">10.1083/jcb.200508085</pub-id> (<year>2006</year>).</mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><string-name><surname>Okada</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Shimazaki</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Sobue</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Okano</surname>, <given-names>H.</given-names></string-name> <article-title>Retinoic-acid-concentration-dependent acquisition of neural cell identity during in vitro differentiation of mouse embryonic stem cells</article-title>. <source>Developmental biology</source> <volume>275</volume>, <fpage>124</fpage>&#x2013;<lpage>142</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.ydbio.2004.07.038</pub-id> (<year>2004</year>).</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Fig. S1.</label>
<caption><title>tSNE visualization of marker genes for DP subpopulations.</title>
<p>This figure relates to main text <xref ref-type="fig" rid="fig2">Fig. 2.</xref> It shows the raw expression of sample marker genes that were used to identify each subpopulation. Two marker genes are shown per state.</p>
</caption>
<graphic xlink:href="124594_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Fig. S2.</label>
<caption><title>tSNE visualization of marker genes for SP subpopulations.</title>
<p>This figure relates to main text <xref ref-type="fig" rid="fig2">Fig. 2.</xref> It shows the raw expression of sample marker genes that were used to identify each subpopulation. Two marker genes are shown per state.</p>
</caption>
<graphic xlink:href="124594_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Fig. S3.</label>
<caption><title>qPCR validation of inferred MN differentiation gene expression dynamics.</title>
<p>Measurement of the bulk population gene expression over time helps to confirm that the trajectory inferred from single-cell analysis matches the true dynamical events of our system. These results confirm that key MN differentiation markers are induced on a real timescale that matches their ordering in our Inferred trajectory. Terminal genes such as Mnx1 and Tubb3 are upregulated Immediately after Induction of early progenitor genes such as Sox1. The values plotted are shown In units of fold change relative to their expression In day 0 mESC cultures.</p>
</caption>
<graphic xlink:href="124594_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Fig. S4.</label>
<caption><title>Cell-cycle gene expression is restricted to early progenitor states.</title>
<p>This figure relates to main text <xref ref-type="fig" rid="fig4">Fig. 4B</xref>. a) Cell cycle gene expression score overlayed on SPRING trajectory shown in main text. The score is the summed expression of a panel of 21 cell-cycle related genes. Cell cycle expression is high in ES cells and neural progenitors from both protocols, but drops sharply upon entry into the transitional states preceding terminal differentiation.b) Shows the average proliferation score along both DP and SP trajectories computed by state (and max normalized). Arrows indicate the same transition as the arrows shown above in panel a. c-d) Example raw expression data for representative individual cell cycle or tumor suppressor / cell-cycle exit genes. Some genes appear to be enriched in specific states, such as Ccnd3 in ES cells and Ccnd2 in neural progenitors from the SP. Expression in cells from each sample are colored using either a blue (ESC), red (DP), or green (SP) colormap.</p>
</caption>
<graphic xlink:href="124594_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Fig. S5.</label>
<caption><title>Heterogeneity within the Mnx1&#x002B; E13.5 primary motor neuron population.</title>
<p>This figure shows the raw expression of a set of marker genes that were used to identify the subpopulations indicated in main text <xref ref-type="fig" rid="fig5">Fig. 5A</xref>. Two markers are shown per subpopulation, with their expression intensity overlaid on the original tSNE embedding.</p>
</caption>
<graphic xlink:href="124594_figS5.tif"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Fig. S6.</label>
<caption><title>Co-clustering analysis of MNs from embryos versus DP and SP MNs.</title>
<p>a) Neuron populations (LMN) from both protocols were pooled with Mnx1&#x002B; FACS purified E13.5&#x002B; motor neurons (pMNs), visualized using tSNE, and clustered using density-gradient clustering, b) For each of DP, SP, and pMNs, the percentage of cells belonging to each cluster in a) was calculated. 95&#x0025; of both DP MNs and pMNs group together in cluster 4, indicating a high degree of similarity, while MNs from the SP are more mixed in their memberships. Pie chart colors and cluster numbers match a). Note that unassigned cells are not plotted in a).</p>
</caption>
<graphic xlink:href="124594_figS6.tif"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Fig. S7.</label>
<caption><title>Differential gene expression between DP or SP MNs and E13.5 MNs from embryos.</title>
<p>This figure relates to <xref ref-type="fig" rid="fig5">Fig. 5</xref>. of the main text. It shows the transcription factors that are differentially expressed between the final MN states of each protocol and E13.5 Mnx1&#x002B; FACS-purified MNs from the embryo, computed from single cell expression data. The dominant transcriptional signature for both protocols is a depletion of the most posterior Hox genes (Hox&#x002A;7 and higher), indicating that both DP and SP MNs may have a trunk or more anterior (not hindlimb / tail) identity. Overexpressed genes common to both protocols include a small number related to neuronal maturation such as Mid1, Ndn, Pbx1, and Pbx3. Each panel is a volcano plot for the indicated comparisons. Only genes with a corrected p-value &#x003C; 001 and an expression ratio &#x003E;2 are shown. A colorbar is used to indicate the highest mean expression of each gene in the states being compared.</p>
</caption>
<graphic xlink:href="124594_figS7.tif"/>
</fig>
</sec>
<sec sec-type="supplementary-material">
<title>Supplementary Methods</title>
<sec>
<title>ESC culture</title>
<p>The mouse ES cell line containing doxycycline-inducible Ngn2&#x002B;Isl1&#x002B;Lhx3 (NIL) and the Hb9::GFP reporter was graciously provided by Esteban Mazzoni. ESCs were cultured in standard media (DMEM with LIF &#x002B; 15&#x0025; fetal bovine serum) on 0.2&#x0025; gelatin-coated dishes.</p>
</sec>
<sec>
<title>Differentiation into motor neurons: direct and standard programming</title>
<p>Twenty-four hours before starting differentiation, ESCs were trypsinized and seeded onto plates precoated with a mix of poly-d-lysine (100 &#x03BC;g/ml) and laminin (50 &#x03BC;g/ml) instead of gelatin for adherence. ESCs were counted by a Beckman Coulter Counter and seeded at a density of approximately 200,000 cells per well of a 6-well dish. At day 0 (ESCs), the media was switched from standard ES media to N2B27 media (Invitrogen). Doxycycline was also added at 3 &#x03BC;g/ml starting to induce expression of the NIL transcription factors. Media was changed daily. For the standard programming protocol, the steps described in Wu et al. were followed strictly.</p>
</sec>
<sec>
<title>Mouse embryonic motor neuron cultures</title>
<p>The B6.Cg-Tg(Hlxb9-GFP)1Tmj/J mice (JAX# 005029) were bred with C57BL/6J (JAX# 000664) for embryonic motor neurons dissection. All animal protocols were approved the Institutional Animal Care and Use Committee at Boston Children&#x2019;s Hospital. On gestational day 13 (E13), the female mice were anesthetized and all embryos were collected by caesarian section. Only GFP embryos were used for further dissection. The spinal cords were isolated and their meninges were removed. Each isolated spinal cord was dissociated by trypsin and mechanical trituration. After filtering the cells with 100 &#x03BC;m strainers, the cells were spun down and re-suspended in PBS, and subjected to flow cytometry. Cells were run through a 100 &#x03BC;m nozzle at low pressure (20 p.s.i.) on a BD FACSaria II machine (Becton Dickinson, USA). A neural density filter (2.0 setting) was used to allow visualization of large cells.</p>
</sec>
<sec>
<title>Single cell transcriptomics using InDrops</title>
<p>We dissociated differentiating mESC cultures using a 0.25&#x0025; Trypsin 2mM EDTA solution (Gibco). Primary HB9&#x002B; sorted motor neurons were dissociated as above. Dissociated cell suspensions were verified to be monodisperse and of viability &#x003E;95&#x0025; using a coulter counter with trypan blue staining (BioRad). We then performed droplet-based barcoding reverse transcription (RT) reactions and prepared massively multiplexed sequencing libraries using InDrops as described in Klein et al. Briefly: cells, lysis and RT reagents, and barcoding primers attached to hydrogel beads are combined in nanoliter sized droplets suspended in an oil emulsion using the InDrops microfluidic device. A barcoding RT reaction is then carried out in the droplet emulsion, uniquely labeling the RNA contents of every cell using a cell barcode and unique molecular identifier (UMI). Following RT, barcoded emulsions are split into batches, and the emulsion is broken. Combined material is amplified into a nanomolar Illumina sequencing library through a series of bulk reactions: second strand synthesis, in vitro transcription (IVT), fragmentation, RT2, and a final low cycle number PCR. The majority of the amplification takes place during IVT ensuring uniform library coverage. Single cell libraries were then sequenced on either the Illumina HiSeq or NextSeq platforms. Reads were demultiplexed using an updated version of the custom bioinformatics pipeline described in Klein et al&#x02D9;. A python implementation of this pipeline is now publically available on GitHub. Briefly, it filters for reads with the expected barcode structure, splits reads according to their cell barcode, aligns them to a reference transcriptome (we used GRCm38 with some added mitochondrial genome transcripts), and then counts the number of different UMIs appearing for each gene in each cell. The final output is a counts matrix of cells vs. genes that we loaded into MATLAB for further analysis.</p>
</sec>
<sec>
<title>Single-cell data clean up: minimum expression threshold, total count normalization, stressed cell removal</title>
<p>Before performing the analyses described below, three steps were taken to ensure that the data was of high quality. First, we required all cells to have at least 1000 UMIs detected. This removed any signal potentially coming from empty droplets. Second, data were total count normalized to ensure differences between cells were not due to technical variation in mRNA capture efficiency or cell size. Finally, cells that had a high stress gene signature were excluded from analysis. Stressed cells were initially recognized as a small percentage of cells (&#x003C;10&#x0025;) that clustered apart from everything else and specifically expressed very high levels of a mitochondrial gene set that is associated with cellular stress. Masks that convert raw counts into our filtered set are provided online.</p>
</sec>
<sec>
<title>Visualization of single-cell data using tSNE</title>
<p>To visualize high-dimensional single cell data, dimensionality reduction is essential. We chose to implement tSNE as described in Klein et al. The core steps are summarized as follows. Steps 1-2 preceed tSNE, and focus the algorithm on genes that best describe differences between cell populations.
<list list-type="order">
<list-item><p>Extract the top 1000 highly variable genes. We do this using a statistical test derived specifically for InDrops data (Klein et al.).</p></list-item>
<list-item><p>Extract principal variable genes. Principal variable genes are a subset of the highly variable genes from step 2 that we find best describes the cell population structure. The steps to find principal variable genes are:
<list list-type="alpha-lower">
<list-item><p>Perform PCA using the top 1000 biologically variable genes.</p></list-item>
<list-item><p>Identify the number of non-trivial principal components. This is done by comparing the eigenvalue of each principal component from a. to the eigenvalue distribution for the same data after being randomized. Only principal components with eigenvalues higher than those observed on random data are retained.</p></list-item>
<list-item><p>Extract genes that contribute most highly to these principal components by imposing a threshold on the gene loadings for each non-trivial PC.</p></list-item>
</list></p></list-item>
<list-item><p>Perform tSNE. We used the MATLAB implementation of tSNE from Van de Marteen et al. As input, we supplied z-score normalized principal variable genes, and asked tSNE to perform an initial PCA to a number of dimensions equal to the number of non-trivial principal components in step 4. tSNE then takes cells embedded in this PCA space and nonlinearly projects them onto two dimensions for visualization.</p></list-item>
</list></p>
</sec>
<sec>
<title>Subpopulation analysis</title>
<p>The first goal of our single cell analysis was to describe the identity and proportions of cell states generated by each of two motor neuron differentiation strategies. For this purpose we found that good results were achieved using local-density gradient clustering on the 2D tSNE representation of the data. This approach provided a clear and natural cell state classification that was well aligned with prior knowledge about marker gene expression domains. The steps we took are summarized as follows:
<list list-type="order">
<list-item><p>Perform tSNE (as above) on cells pooled from all timepoints for each protocol (e.g. <xref ref-type="fig" rid="fig2">Fig. 2B</xref>).</p></list-item>
<list-item><p>Apply local density gradient clustering to define cell states.</p></list-item>
<list-item><p>Identify genes specifically expressed by each cell state, and use prior knowledge on their expression domains to generate a cell type annotation (e.g. <xref ref-type="fig" rid="fig2">Fig. 2D</xref>).</p></list-item>
<list-item><p>Quantify the fraction of cells in each state at each timepoint (e.g. <xref ref-type="fig" rid="fig2">Fig. 2F</xref>).</p></list-item>
</list></p>
<p>We identified genes that were specifically expressed by each subpopulation through pairwise t-tests and visually inspected their expression over the tSNE embedding. In <xref ref-type="fig" rid="fig2">Figure 2D-E</xref> of the main text, we show the z-score normalized expression of a selection of marker genes that we used as a heatmap. Z-score normalization preserves differences between populations while putting the expression level of every gene on the same scale. In <xref ref-type="fig" rid="figS1">Supplementary Figs. S1</xref> and <xref ref-type="fig" rid="figS2">S2</xref>, we show the un-normalized expression of each of these genes individually so that the reader may compare.</p>
</sec>
<sec>
<title>Initial identification of differentiation trajectories</title>
<p>During our subpopulation analysis we observed, for both protocols, a continuous progression of cells that spanned the initial ES cell state through the early and late differentiation timepoints. This progression was punctuated by familiar progenitor states that were ordered in a way that was consistent with known events in motor neuron differentiation (<xref ref-type="fig" rid="fig2">Figure 2D-E</xref>), and was correlated with chronology (<xref ref-type="fig" rid="fig2">Figure 2B-C</xref> inset). We interpreted these progressions as differentiation trajectories. Each is reconstructed from three population snapshots (day 0, day 4/5, and day 11/12). Because differentiation <italic>in vitro</italic> is asynchronous, the single cell data overlapped from one timepoint to the next. We deduce from this that intermediate states were not missed due to the spacing of our timepoints. We also validated that important intermediate genes were not detected over a densely sampled timecourse using qPCR (see below).</p>
</sec>
<sec>
<title>Differential gene expression analysis between cell states from single-cell data</title>
<p>We identified differentially expressed genes between cell states by using two-tailed t-tests with a multiple hypothesis testing correction. We defined differentially expressed genes conservatively at a FDR of 5&#x0025; and a significance level of p&#x003C;0.0001. We only considered genes where at least one of the states being compared had &#x003E;=10 cells with non-zero expression. To find marker genes of a population we asked for genes that were enriched in that population versus everything else. For several comparisons we restricted our analysis to Riken transcription factors. This list contains <sup>&#x223C;</sup>1,500 genes with manually annotated transcription factor activity. We represented differential expression data using volcano plots, and colored the expression intensity of each gene using a colorbar; the mean of the higher expressing state was used.</p>
</sec>
<sec>
<title>Comparison of differentiation paths I: Visualization of alternate differentiation trajectories using SPRING</title>
<p>After our initial identification of the differentiation paths for the standard protocol and for direct programming we wished compare their routes. One of the most powerful ways to begin addressing such a problem is to simply visualize the data. Yet, we found tSNE gave unclear results for a direct comparison of the paths; visualizing both protocols together resulted in some mixed clusters, and some distinct clusters, but no overall coherence to the representation as we had found looking at one or the other trajectory separately. The limitations of tSNE for analyzing continuous processes are well known.</p>
<p>We therefore turned to a new method developed in parallel to this work in our lab called SPRING, that in our experience does better in analyzing continuous processes in single cell data. SPRING has three core steps: first, it reduces dimensionality to a 50 dim PCA space; second, it constructs a k-nearest-neighbor (kNN) graph in this space; finally, it renders an interactive 2D visualization of this kNN graph using a force directed layout. In this visualization edges of the kNN graph are literally springs that pull together similar cells, while every cell has a magnetic repulsion force that pushes it away from other cells and an intrinsic gravity. The balance of these forces illuminates the topology of how cells are positioned in high-dimension with respect to one another. In this visualization nodes can be moved around to rotate the projection and find the clearest representation; in each new position the graph re-relaxes according to the underlying physics of the force directed layout. The specific steps we took to generate <xref ref-type="fig" rid="fig3">Fig. 3A</xref> are as follows. Note that a small manual correction was made to the position of the ESC and LMN populations to reduce white space, but did not distort relationships between populations.
<list list-type="order">
<list-item><p>Load the cells along each differentiation path into SPRING separately.</p></list-item>
<list-item><p>Remove doublets. Doublets were identified by three criteria. 1) they are rare, in line with our experimental expectation for cell doublets, 2) they formed long range connections between large cell groups in the same timepoint and sample, 3) they do not possess any unique marker genes; all genes they express are a linear combination of two other cell states. We identified approximately 80 doublets in the standard protocol (&#x003C;3&#x0025; of all cells), and approximately 40 in the direct programming approach (&#x003C;2&#x0025; of all cells).</p></list-item>
<list-item><p>Load the filtered cells from both protocols into SPRING together. To make plots the coordinates from the SPRING representation were exported into MATLAB; cells were either colored by cell state (<xref ref-type="fig" rid="fig3">Fig. 3A</xref>), or gene expression (<xref ref-type="fig" rid="fig3">Fig. 3B</xref>).</p></list-item>
</list></p>
</sec>
<sec>
<title>Comparison of differentiation paths II: Pairwise cosine similarity of cell state centroids</title>
<p>We also asked how the direct programming and standard motor neuron differentiation paths were related to each other by performing a pairwise comparison of cell state centroids. Centroids are the average or center of mass in gene expression space for a collection of cells. Centroids can provide a very accurate estimate of global gene expression that averages over the noise intrinsic to single-cell RNA sequencing at the level of individual cells. By computing the cosine similarity between two cell state centroids we are asking how similar these states are in average gene expression. If the paths do indeed split and then reconverge our expectation was to see similarity between early and late states in both progressions, but not between the intermediate states. We chose to perform these comparisons in a PV-gene space constructed from cells in both protocols to make our comparisons as sensitive as possible. We obtained similar but less sensitive results using all genes above a minimum expression value (not shown). A summary of the steps of this analysis is:
<list list-type="order">
<list-item><p>Combine all cells from both protocols, extract PV-genes (as described above), and z-score normalize their expression.</p></list-item>
<list-item><p>Calculate the centroid of every cluster from each trajectory in this PV-gene space.</p></list-item>
<list-item><p>Compute the pairwise cosine similarity for all direct programming clusters versus all standard protocol clusters.</p></list-item>
<list-item><p>Visualize: we chose to use a heatmap (<xref ref-type="fig" rid="fig3">Fig. 3C</xref>).</p></list-item>
</list></p>
</sec>
<sec>
<title>Comparison of differentiation paths III: Maximum likelihood assignment of single cells to cell state centroids between trajectories</title>
<p>Finally, we performed an independent comparison of the differentiation paths that did not depend on our definition of cluster boundaries in the direct programming trajectory. We asked whether any potentially rare individual cells or subpopulations in the direct programming trajectory resemble the intermediate states of the standard trajectory. Because we were now dealing with single cells, not averages of many measurements, care was necessary in this analysis to remain robust relative to the noise in single cell measurements. We therefore took a Bayesian approach and reasoned as follows. In our data, each cell is a vector of counts, with one element for every gene. These counts can be viewed as a multinomial sample from some underlying distribution of gene expression. Since each state of the standard differentiation trajectory is defined by a particular gene expression distribution, we can ask: what is the probability a given direct programming protocol cell was sampled from each standard differentiation trajectory cluster? In this usage, probability amounts to a measure of similarity, with high probability indicating high similarity. We obtained similar results working in either a PV-gene expression space, or considering all genes expressed above a minimum counts threshold. The results of this analysis using PV-genes are presented in <xref ref-type="fig" rid="fig3">Figure 3D</xref>. We also obtained similar (but more noisy) results using cosine similarity as an alternative distance metric (not shown). The specific steps of our computation are as follows:
<list list-type="order">
<list-item><p>Extract a set of genes with which to make comparisons (either PV-genes or all genes above a minimum expression threshold).</p></list-item>
<list-item><p>For each cluster of the standard trajectory, calculate the probability of observing a given gene (i.e. the fraction of counts in that cluster from the gene). For genes that are not detected add 1e-07 total counts.</p></list-item>
<list-item><p>For each cell in the direct programming trajectory, calculate the log-likelihood that it was drawn from each of these clusters. This log-likelihood is from the multinomial distribution function using the probabilities obtained in step 2.</p></list-item>
<list-item><p>Identify and tally the maximum likelihood assignments of all direct programming cells. Normalize raw assignments so that they sum to 100 (giving the percentage). Plot the percentage of direct programming cells assigned to each standard protocol state.</p></list-item>
</list></p>
</sec>
<sec>
<title>Cell cycle gene expression analysis</title>
<p>Cell-cycle activity can be estimated from a cell cycle associated gene expression signature; populations that express higher average levels of cell cycle genes are most likely cycling at higher frequency than a population with lower level expression of these genes. In <xref ref-type="fig" rid="fig4">Fig. 4b</xref> and <xref ref-type="fig" rid="figS4">Fig. S4</xref> we performed an analysis in this spirit to determine which parts of the DP and SP differentiation trajectories appeared to be proliferative, and to estimate where cells are exiting the cell cycle. We computed a proliferation score that was the aggregate expression of a panel of 21 cell cycle related genes: Aurka, Top2a, Ccna2, Ccnd1, Ccnd2, Ccnd3, Ccne1, Ccne2, Ccnb1, Cdk4, Cdk6, Cdk2, Cdk1, Cdkn2b, Cdkn2a, Cdkn2c, Cdkn2d, Cdkn1a, Cdkn1b, Cdkn1c, Mcm6, Cdc20, Plk1, and Pcna. We also computed a cell cycle exit score on the basis of the aggregate expression of a panel of 4 tumor suppressor genes that inhibit the cell cycle: Cdkn1c, Cdkn1b, Cdkn1a, and Cdkn2d. In <xref ref-type="fig" rid="figS4">Fig. S4</xref> we show the expression of representative individual genes from this score; in general cell cycle genes were correlated with each other in their expression over cells, as were cell cycle exit genes.</p>
</sec>
<sec>
<title>Comparison of motor neurons <italic>in vitro</italic> with primary motor neurons using single-cell data</title>
<p>How does the transcriptional state of motor neurons produced by both protocols compare to that of motor neurons <italic>in vivo</italic>? To answer this question we leveraged the ability of single-cell RNA sequencing to compare cell states even within populations that are not pure (also see below for functional comparisons of the phenotypes). We performed three analyses. First, we computed the cosine similarity between the centroids of each cell state in both protocols and primary motor neurons (<xref ref-type="fig" rid="fig5">Fig. 5B</xref>). The specific steps of this analysis were as follows:
<list list-type="order">
<list-item><p>Combine all cell states from both protocols, and from HB9&#x002B; E13.5 primary tissue, extract PV-genes (as described above), and z-score normalize their expression.</p></list-item>
<list-item><p>Calculate the centroid of every cluster from each trajectory, and from primary motor neurons, in this PV-gene space.</p></list-item>
<list-item><p>Compute the cosine similarity for all <italic>in vitro</italic> populations versus primary motor neurons, and visualize as a bar graph.</p></list-item>
</list></p>
<p>Second, we performed a co-clustering analysis (<xref ref-type="fig" rid="figS6">Supp. Fig. 6</xref>). If cells cluster together this is an indication of similarity. An advantage of co-clustering is that it allows one to make statements at a single cell level about the fraction of cells within a state that resemble another state, for example. The specific steps of our coclustering analysis were:
<list list-type="order">
<list-item><p>For standard protocol, direct programming, and primary HB9&#x002B; cells, filter for neurons: in this analysis we defined neurons as cells with &#x003E; 2.5 UMIs from universal neuronal marker Tubb3.</p></list-item>
<list-item><p>Perform tSNE and local density gradient clustering (as above; <xref ref-type="fig" rid="figS6">Supp. Fig. 6A</xref>).</p></list-item>
<list-item><p>For every condition, count the fraction of cells belonging to each cluster. Similar states should belong to the same cluster.</p></list-item>
<list-item><p>Visualize: we chose to use a pie chart.</p></list-item>
</list></p>
<p>Third, we performed differential gene expression analysis, comparing the most mature motor neuron states from each protocol with primary HB9&#x002B; motor neurons (<xref ref-type="fig" rid="figS7">Supp. Fig. 7</xref>). This analysis was performed as described above. We also performed differential expression analysis of these populations using bulk microarrays as validation (see below).</p>
</sec>
<sec>
<title>qPCR</title>
<p>RNA was isolated using Qiagen Rneasy Plus Kit. Purified RNA was then reverse transcribed using Biorad&#x2019;s iSCRIPT cDNA synthesis kit. Quantitative PCR was performed using Bio-rad&#x2019;s SYBR green Supermix on a CFX96 Real-Time PCR system.</p>
</sec>
<sec>
<title>Immunostaining</title>
<p>Antibodies used for immunostaining were anti-Tubb3 (Cell Signaling D71G9; 1:100), anti-Map2 (Sigma M9942; 1:200), anti-VACht (Synaptic Systems 139 103; 1:200), anti-Isl1 (Abcam ab109517; 1:1000), and anti-Hb9 (DSHB 81.5C10; 1:100). Differentiated cells were fixed in 4&#x0025; paraformaldehyde for 20 minutes and then permeabilized with 0.1&#x0025; Triton-X for 15 minutes. After primary incubation for 1 hour, samples were labeled with a secondary antibody conjugated to AlexaFluor647. Samples were co-stained with DAPI before imaging on a Nikon Eclipse TE2000-E microscope.</p>
</sec>
<sec>
<title>Electrophysiology</title>
<p>All recordings were carried out at room temperature within 6 days of plating the neurons in 35 mm dish. Whole-cell voltage clamp recordings were made with a Multiclamp 700B amplifier (Molecular Devices) and patch pipettes with resistances of 2-3 &#x039C;&#x03A9;. Pipette solution was 135 mM K-Gluconate, 10 mM KCl, 1 mM MgCl<sub>2</sub>, 5 mM EGTA, 10 mM HEPES, pH 7.2, adjusted with NaOH. The external solution was 140 mM NaCl, 5 mM KCl, 2 mM CaCl<sub>2</sub>, 2 mM MgCl<sub>2</sub>, 10 mM HEPES, and 10 mM D-glucose, pH 7.4, adjusted with NaOH. We used gravity perfusion system connected with Perfusion Pencil<sup>&#x00AE;</sup> with Multi-Barrel Manifold Tip (AutoMate Scientific) to externally apply 0.5 &#x03BC;M tetrodotoxin, 100 &#x03BC;M AMPA, kainate, GABA, or glycine to the cells. Command protocols were generated and data was digitized with a Digidata 1440A A/D interface with pCLAMP10 software.</p>
</sec>
<sec>
<title>Co-culture muscle contraction assays</title>
<p>C2C12 myoblasts were grown in 10&#x0025;FBS&#x002B;DMEM media and then differentiated into myotubes by incubating in differentiation medium (2&#x0025; horse serum &#x002B; DMEM). After myotubes were formed, the neurons were dissociated by trypsinization and reseeded on top of the differentiated muscle to allow contractions to develop. Video of contractions were taken using Metamorph software and manually counted over 5 second intervals. For stopping assay, 300 &#x03BC;M Tubocurarine (Sigma) was added to the media as an acetylcholine competitor. For labeling of acetylcholine receptors, bungarotoxin (Invitrogen) was used after cells were fixed with paraformaldehyde. Similarly to C2C12 cells, ES cells over-expressing MyoD were also differentiated to myotubes using differentiation medium and subjected to co-culture with neurons.</p>
</sec>
<sec>
<title>Microarray Analysis</title>
<p>The mRNA of undifferentiated iNIL ES cells and NIH 3T3 cells (grow in DMEM&#x002B;10&#x0025;FBS) were collected and purified by RNA extraction using RNeasy Plus Extraction Kit (Qiagen). Neurons differentiated by either protocol were first sorted by flow cytometry on a BD FACSaria II machine (Beckton Dickinson, USA) to collect Hb9::GFP&#x002B; cells, and then were subjected to RNA extraction in a similar fashion. Collected RNA was then amplified and hybridized to Affymetrix GeneChip Mouse Transcriptome Arrays (MTA 1.0). Results were processed by the Children&#x2019;s Hospital Microarray Core Facility, and were analyzed using Affrymetrix&#x2019;s Transcriptome Analysis Console and Expression Console software.</p>
</sec>
</sec>
<ref-list>
<title>Methods references</title>
<ref id="r1"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>V.C.</given-names></string-name>, and <string-name><surname>Kirschner</surname>, <given-names>M.W.</given-names></string-name> <article-title>Molecular ties between the cell cycle and differentiation in embryonic stem cells</article-title>. <source>P.N.A.S</source>. <volume>111</volume>, <fpage>9503</fpage>&#x2013;<lpage>8</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="r2"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>C.Y.</given-names></string-name>, <string-name><surname>Whye</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>R.W.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>W.</given-names></string-name> <article-title>Efficient Differentiation of Mouse Embryonic Stem Cells into Motor Neurons</article-title>. <source>J. Vis. Exp</source>. <volume>64</volume>, <fpage>e3813</fpage>, DOI: <pub-id pub-id-type="doi">10.3791/3813</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="r3"><mixed-citation publication-type="journal"><string-name><surname>Treutlein</surname>, <given-names>B.</given-names></string-name>, <etal>et al.</etal> <article-title>Dissecting direct reprogramming from fibroblast to neuron using single-cell RNA-seq</article-title>. <source>Nature</source>. <volume>534</volume>, <fpage>391</fpage>&#x2013;<lpage>5</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="r4"><mixed-citation publication-type="journal"><string-name><surname>Wichterle</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lieberam</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Porter</surname>, <given-names>J.A.</given-names></string-name>, and <string-name><surname>Jessell</surname>, <given-names>T.M.</given-names></string-name> <article-title>Directed differentiation of embryonic stem cells into motor neurons</article-title>. <source>Cell</source>. <volume>110</volume>, <fpage>385</fpage>&#x2013;<lpage>397</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="r5"><mixed-citation publication-type="journal"><string-name><surname>Boulting</surname>, <given-names>G.L.</given-names></string-name>, <etal>et al.</etal> <article-title>A functionally characterized test set of human induced pluripotent stem cells</article-title>. <source>Nature Biotechnology</source>. <volume>29</volume>, <fpage>279</fpage>&#x2013;<lpage>286</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="r6"><mixed-citation publication-type="journal"><string-name><surname>Karunbayaram</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal> <article-title>Directed differentiation of human induced pluripotent stem cells generates active motor neurons</article-title>. <source>Stem Cells</source>. <volume>27</volume>, <fpage>806</fpage>&#x2013;<lpage>811</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="r7"><mixed-citation publication-type="journal"><string-name><surname>Davis-Dusenbery</surname>, <given-names>B.N.</given-names></string-name>, <string-name><surname>Williams</surname>, <given-names>L.A.</given-names></string-name>, <string-name><surname>Klim</surname>, <given-names>J.R.</given-names></string-name>, and <string-name><surname>Eggan</surname>, <given-names>K.</given-names></string-name> <article-title>How to make spinal motor neurons</article-title>. <source>Development</source>. <volume>141</volume>, <fpage>491</fpage>&#x2013;<lpage>501</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="r8"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Directed differentiation and transplantation of human embryonic stem cell-derived motoneurons</article-title>. <source>Stem Cells</source>. <volume>25</volume>, <fpage>1931</fpage>&#x2013;<lpage>9</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="r9"><mixed-citation publication-type="journal"><string-name><surname>Soundararajan</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Miles</surname>, <given-names>G.B.</given-names></string-name>, <string-name><surname>Rubin</surname>, <given-names>L.L.</given-names></string-name>, <string-name><surname>Brownstone</surname>, <given-names>R.M.</given-names></string-name>, and <string-name><surname>Rafuse</surname>, <given-names>V.F.</given-names></string-name> <article-title>Motoneurons derived from embryonic stem cells express transcription factors and develop phenotypes characteristic of medial motor column neurons</article-title>. <source>J. Neurosci</source>. <volume>26</volume>, <fpage>3256</fpage>&#x2013;<lpage>3268</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="r10"><mixed-citation publication-type="journal"><string-name><surname>Mazzoni</surname>, <given-names>E.O.</given-names></string-name>, <etal>et al.</etal> <article-title>Synergistic binding of transcription factors to cell-specific enhancers programs motor neuron identity</article-title>. <source>Nat. Neurosci</source>. <volume>16</volume>, <fpage>1219</fpage>&#x2013;<lpage>27</lpage> (<year>2013</year>).</mixed-citation></ref>
</ref-list>
</back>
</article>
