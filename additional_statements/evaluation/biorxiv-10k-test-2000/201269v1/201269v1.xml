<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/201269</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Imbalanced amplification: A mechanism of amplification and suppression from local imbalance of excitation and inhibition in cortical circuits</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Ebsch</surname><given-names>Christopher</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2105-9282</contrib-id>
<name><surname>Rosenbaum</surname><given-names>Robert</given-names></name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Applied and Computational Mathematics and Statistics, University of Notre Dame</institution>, Notre Dame, Indiana, <country>USA</country>.</aff>
<aff id="a2"><label>2</label><institution>Interdisciplinary Center for Network Science and Applications, University of Notre Dame</institution>, Notre Dame, Indiana, <country>USA</country>.</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author (<email>Robert.Rosenbaum@nd.edu</email>).</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>201269</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>10</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="201269.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Understanding the relationship between external stimuli and the spiking activity of cortical populations is a central problem in neuroscience. Dense recurrent connectivity in local cortical circuits can lead to counterintuitive response properties, raising the question of whether there are simple arithmetical rules for relating circuits&#x2019; connectivity structure to their response properties. One such arithmetic is provided by the mean field theory of balanced networks, which is derived in a limit where excitatory and inhibitory synaptic currents precisely balance on average. However, balanced network theory is not applicable to some biologically relevant connectivity structures. We show that cortical circuits with such structure are susceptible to an amplification mechanism arising when excitatory-inhibitory balance is broken at the level of local subpopulations, but maintained at a global level. This amplification, which can be quantified by a linear correction to the classical mean field theory of balanced networks, explains several response properties observed in cortical recordings.</p>
</abstract>
<counts>
<page-count count="26"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><label>1</label><title>Introduction</title>
<p>Understanding of how the brain encodes and processes stimuli is a central problem in neuro science. Information about a sensory stimulus is passed along a hierarchy of neural populations, from subcortical areas to the cerebral cortex where it propagates through multiple cortical areas and layers. Within each layer, lateral synaptic connectivity shapes the response to synaptic input from upstream layers and populations. In a similar manner, lateral connectivity shapes the response of cortical populations to artificial, optogenetic stimuli. The densely recurrent structure of local cortical circuits can lead to counter-intuitive response properties [<xref rid="c57" ref-type="bibr">57</xref>, <xref rid="c41" ref-type="bibr">41</xref>, <xref rid="c2" ref-type="bibr">2</xref>, <xref rid="c43" ref-type="bibr">43</xref>, <xref rid="c10" ref-type="bibr">10</xref>], making it difficult to predict or interpret a population&#x2019;s response to natural or artificial stimuli. This raises the question of whether there are underlying arithmetic principles through which one can understand the relationship between a local circuit&#x2019;s connectivity structure and its response properties.</p>
<p>In principle this relationship could be deduced from detailed computer simulations of the neurons and synapses that comprise the circuit. In practice, such detailed simulations can be computationally expensive, depend on a large number of unconstrained physiological parameters, and their complexity can make it difficult to pinpoint mechanisms underlying observed phenomena. In many cases, however, one is not interested in how the response of each neuron is related to the detailed connectivity between every pair of neurons. Relevant questions are often more macroscopic in nature, <italic>e.g.</italic> &#x201C;How does increased excitation to population A affect the average firing rate of neurons in population B?&#x201D; For such questions, it is sufficient to establish a relationship between macroscopic connectivity structure and macroscopic response properties.</p>
<p>One such approach is provided by the mean-field theory of balanced networks [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>, <xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c45" ref-type="bibr">45</xref>, <xref rid="c30" ref-type="bibr">30</xref>], which is derived in the limit of a large number of neurons and a resulting precise balance of strong excitation with strong inhibition. This notion of precise balance implies a simple relationship between the macroscopic structure of connectivity and firing rates, and balanced network models naturally produce the asynchronous, irregular spiking activity that is characteristic of cortical recordings [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>, <xref rid="c47" ref-type="bibr">47</xref>, <xref rid="c49" ref-type="bibr">49</xref>]. However, classical balanced network theory has some critical limitations. While cortical circuits do appear to balance excitation with inhibition, this balance is not always as precise and spike trains are not as asynchronous as the theory predicts [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c16">16</xref>]. Moreover, precise balance is mathematically impossible under some biologically relevant connectivity structures [<xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c45" ref-type="bibr">45</xref>, <xref rid="c30" ref-type="bibr">30</xref>], implying that the classical theory of balanced networks is limited in its ability to model the complexity of real cortical circuits.</p>
<p>We show that cortical circuits with structure that is incompatible with balance are susceptible to an amplification mechanism arising when excitatory-inhibitory balance is broken at the level of local subpopulations, but maintained at a global level. This mechanism of &#x201C;imbalanced amplification&#x201D; can be quantified by a linear, finite-size correction to the classical mean field theory of balanced networks that accounts for imperfect balance and local imbalance. Through several examples, we show that imbalanced amplification explains several experimentally observed cortical responses to natural and artificial stimuli.</p>
</sec>
<sec id="s2"><label>2</label><title>Results</title>
<sec id="s2a"><label>2.1</label><title>The arithmetic of imprecise balance in cortical circuits</title>
<p>We begin by reviewing and demonstrating the classical mean-field theory of balanced networks and a linear correction to the large network limit that the theory depends on. A typical cortical neuron receives synaptic projections from thousands of neurons in other cortical layers, cortical areas or thalamus. These long range projections are largely excitatory and provide enough excitation for the postsynaptic neuron to spike at a much higher rate than the sparse spiking typically observed in cortex. The notion that excitation to cortical populations can be excessively strong has been posed in numerous studies and is typically resolved by accounting for local, lateral synaptic input that is net-inhibitory and partially cancels the strong, net-excitatory external synaptic input [<xref rid="c19" ref-type="bibr">19</xref>, <xref rid="c53" ref-type="bibr">53</xref>, <xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c3" ref-type="bibr">3</xref>, <xref rid="c51" ref-type="bibr">51</xref>, <xref rid="c41" ref-type="bibr">41</xref>]. Balanced network theory takes this cancellation to its extreme by considering the limit of large external, feedforward synaptic input that is canceled by similarly large local, recurrent synaptic input. In this limit, a linear mean-field analysis determines population-averaged firing rates in terms of the macroscopic connectivity structure of the network [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>].</p>
<p>To demonstrate these notions, we first simulated a recurrent network of <italic>N</italic><sub><italic>E</italic></sub> &#x003D; 4000 excitatory (population <italic>E</italic>) and <italic>N</italic><sub><italic>I</italic></sub> &#x003D; 1000 inhibitory spiking neurons (population <italic>I</italic>) receiving synaptic connections from an &#x201C;external&#x201D; population (<italic>X</italic>) of <italic>N</italic><sub><italic>X</italic></sub> &#x003D; 4000 excitatory neurons modeled as Poisson processes. Cortical circuits are often probed using optogenetic methods to stimulate or suppress targeted neuronal sub-populations [<xref rid="c7" ref-type="bibr">7</xref>, <xref rid="c15" ref-type="bibr">15</xref>]. As a simple model of optogenetic stimulation of cortical pyramidal neurons, we added an extra inward current to all neurons in population <italic>E</italic> halfway through the simulation (<xref ref-type="fig" rid="fig1">Fig. 1a</xref>). Neurons in the local population (<italic>E</italic> and <italic>I</italic>) were modeled using the adaptive exponential integrate-and-fire (AdEx) model, which accurately captures the responses of real cortical neurons [<xref rid="c8" ref-type="bibr">8</xref>, <xref rid="c25" ref-type="bibr">25</xref>, <xref rid="c26" ref-type="bibr">26</xref>]. Connectivity was random with each neuron receiving 800 synaptic inputs on average and postsynaptic potential amplitudes between 0.19 and 1.0 mV in amplitude. The recurrent network produced asynchronous, irregular spiking (<xref ref-type="fig" rid="fig1">Fig. 1b</xref>), similar to that observed in cortical recordings [<xref rid="c53" ref-type="bibr">53</xref>, <xref rid="c52" ref-type="bibr">52</xref>, <xref rid="c47" ref-type="bibr">47</xref>, <xref rid="c17" ref-type="bibr">17</xref>]. Firing rates in populations <italic>E</italic> and <italic>I</italic> were similar in magnitude to those in population <italic>X</italic> and were increased by optogenetic stimulation (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>). As predicted by balanced network theory, local synaptic input (from <italic>E</italic> and <italic>I</italic> combined) was net-inhibitory and approximately canceled the external input from population <italic>X</italic> and artificial stimulation combined (<xref ref-type="fig" rid="fig1">Fig. 1d</xref>).</p>
<fig id="fig1" position="float" fig-type="figure"><label>Figure 1:</label>
<caption><title>Imprecise balance under optogenetic stimulation.</title>
<p><bold>a)</bold> Schematic. A population of recurrently connected excitatory (red) and inhibitory (blue) spiking neuron models receive synaptic input from an external population (<italic>X</italic>; green) of Poisson-spiking neurons. Optogenetic stimulation of excitatory neurons was modeled by an extra inward current to the excitatory population at 5s. <bold>b)</bold> Spike rasters from 50 randomly selected excitatory (red) and inhibitory (blue) neurons from recurrent network. <bold>c)</bold> Average firing rate of excitatory (red) and inhibitory (blue) neurons in the recurrent network from simualtions (light solid), from the balanced network approximation (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>; solid dark) and from the corrected approximation (<xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>; dashed). <bold>d)</bold> Mean synaptic currents to 200 randomly selected excitatory neurons in the recurrent network from external inputs (<italic>X</italic>; green), from the local population (<italic>E</italic> &#x002B; <italic>I</italic>; purple) and the total synaptic current (black). Currents are measured in units of the neurons&#x2019; rheobase here and elsewhere (rheobase/<italic>C</italic><sub><italic>m</italic></sub>=10.5 V/s). <bold>e)</bold> Mean firing rates plotted against mean input currents to all neurons in populations <italic>E</italic> and <italic>I</italic> (gray dots) and a rectified linear fit to their relationship (black line). <bold>f)</bold> Mean firing rates from identical simulations without stimulation except the total number of neurons, <italic>N</italic>, in the recurrent network was modulated while scaling synaptic weights and connection probabilities so that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline1.gif"/></alternatives></inline-formula> (see <xref ref-type="sec" rid="s4">Methods</xref>). Solid light curves are from simulations, solid dark from <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>, and dashed from <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>.</p></caption>
<graphic xlink:href="201269_fig1.tif"/>
</fig>
<sec id="s2a1"><label>2.1.1</label><title>A review of the mean field theory of balanced networks</title>
<p>To capture the notion that the net external synaptic input to neurons is strong, we define the small number,
<disp-formula id="ueqn1"><alternatives><graphic xlink:href="201269_ueqn1.gif"/></alternatives></disp-formula>
where <italic>K</italic><sub><italic>EX</italic></sub> &#x003D; <italic>p</italic><sub><italic>EX</italic></sub> <italic>N</italic><sub><italic>X</italic></sub> is the average number of external synaptic projections received by each neuron in <italic>E</italic> from all neurons in <italic>X</italic>, <italic>p</italic><sub><italic>EX</italic></sub> is connection probability, and <italic>J</italic><sub><italic>EX</italic></sub> is the synaptic strength of each connection. Specifically, <italic>J</italic><sub><italic>EX</italic></sub> is the total postsynaptic current induced in a postsynaptic neuron in <italic>E</italic> by a single spike in a presynaptic neuron in <italic>X</italic>. Hence, 1/<italic>&#x03F5;</italic> quantifies the synaptic current that would be induced in each neuron in <italic>E</italic> (on average) if <italic>every</italic> neuron in <italic>X</italic> spiked once simultaneously. Using this convention, the mean synaptic input to each neuron in populations <italic>E</italic> and <italic>I</italic> from all sources can be written in vector form as
<disp-formula id="eqn1"><alternatives><graphic xlink:href="201269_eqn1.gif"/></alternatives></disp-formula>
where <bold>I</bold> &#x003D; [<italic>I</italic><sub><italic>E</italic></sub> <italic>I</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup> (superscript <italic>T</italic> denotes the transpose) is the vector of mean synaptic input to neurons in each population and similarly for their mean rates, <bold>r</bold> &#x003D; [<italic>r</italic><sub><italic>E</italic></sub> <italic>r</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>. The rescaled external synaptic input, <bold>X</bold> &#x003D; [<italic>X</italic><sub><italic>E</italic></sub> <italic>X</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>, is given by
<disp-formula id="ueqn2"><alternatives><graphic xlink:href="201269_ueqn2.gif"/></alternatives></disp-formula>
where <italic>r</italic><sub><italic>X</italic></sub> is the average rate of neurons in population <italic>X</italic> and <italic>s</italic>/<italic>&#x03F5;</italic> is the strength of the inward current induced by optogenetic stimulation (<italic>s</italic> &#x003D; 0 when stimulation is off). The recurrent and feedforward mean-field connectivity matrices are given by
<disp-formula id="eqn2"><alternatives><graphic xlink:href="201269_eqn2.gif"/></alternatives></disp-formula>
respectively where <italic>w</italic><sub><italic>ab</italic></sub> &#x003D; <italic>K</italic><sub><italic>ab</italic></sub><italic>J</italic><sub><italic>ab</italic></sub>/(<italic>K</italic><sub><italic>EX</italic></sub><italic>J</italic><sub><italic>EX</italic></sub>) quantifies the relative number, <italic>K</italic><sub><italic>ab</italic></sub> &#x003D; <italic>p</italic><sub><italic>ab</italic></sub><italic>N</italic><sub><italic>b</italic></sub>, and strength, <italic>J</italic><sub><italic>ab</italic></sub>, of synaptic connections from population <italic>b</italic> to <italic>a</italic>. To achieve moderate firing rates when <italic>&#x03F5;</italic> is small, local input, <italic>W</italic> <bold>r</bold>, must be net-inhibitory and partially cancel the strong external excitation, <bold>X</bold>, in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>.</p>
<p>Balanced network theory [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>] takes this cancellation to its extreme by considering the limit of large number of neurons, <italic>N</italic> &#x003D; <italic>N</italic><sub><italic>E</italic></sub> &#x002B; <italic>N</italic><sub><italic>I</italic></sub>, while scaling connection strengths and probabilities in such a way that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline2.gif"/></alternatives></inline-formula>. Under this scaling, <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> would seem to imply that mean synaptic currents diverge in the limit, but this divergence is avoided in balanced networks by a precise cancellation between external and recurrent synaptic input. To achieve this cancellation, firing rates must satisfy the mean-field balance equation,
<disp-formula id="ueqn3"><alternatives><graphic xlink:href="201269_ueqn3.gif"/></alternatives></disp-formula>
in the large <italic>N</italic> limit, so that [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>, <xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c45" ref-type="bibr">45</xref>, <xref rid="c30" ref-type="bibr">30</xref>]
<disp-formula id="eqn3"><alternatives><graphic xlink:href="201269_eqn3.gif"/></alternatives></disp-formula>
</p>
<p>Hence, balanced network theory provides a closed form, linear expression for firing rates in the large network limit. Generally speaking, the firing rate of a neuron depends nonlinearly on the mean and variance of its input current [<xref rid="c3" ref-type="bibr">3</xref>, <xref rid="c9" ref-type="bibr">9</xref>, <xref rid="c46" ref-type="bibr">46</xref>]. Notably, however, the derivation of the fixed point in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> did not require us to specify the exact form of this dependence. Instead, <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> represents the unique fixed point firing rates for which synaptic currents remain bounded as <italic>N</italic> &#x2192; &#x221E;. More specifically, if <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> is not satisfied as <italic>N</italic> &#x2192; &#x221E; then &#x007C;&#x007C;<bold>I</bold>&#x007C;&#x007C; &#x2192; &#x221E; (where &#x007C;&#x007C; &#x00B7; &#x007C;&#x007C; is the Euclidean norm). The existence of this fixed point does not guarantee that it is stable. Precise, general conditions on the accuracy of <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> for spiking network models are not known and the investigation of such conditions is outside the scope of this study. However, the approximation tends to be accurate in the <italic>N</italic> &#x2192; &#x221E; limit whenever all eigenvalues of <italic>W</italic> have negative real part, the solution in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> is strictly positive, and inhibitory synaptic kinetics are sufficiently fast [<xref rid="c58" ref-type="bibr">58</xref>, <xref rid="c59" ref-type="bibr">59</xref>, <xref rid="c46" ref-type="bibr">46</xref>, <xref rid="c32" ref-type="bibr">32</xref>, <xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c45" ref-type="bibr">45</xref>, <xref rid="c30" ref-type="bibr">30</xref>]. Indeed, <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> provides a reasonable, but imperfect approximation to firing rates in our spiking network simulation (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>, compare light and dark solid).</p>
<p>Balanced network theory has some critical limitations. Local cortical circuits are, of course, finite in size so the <italic>N</italic> &#x2192; &#x221E; (equivalently <italic>&#x03F5;</italic> &#x2192; 0) limit may not be justified. Moreover, excitation and inhibition in cortex may not be as perfectly balanced and spike trains not as asynchronous as predicted by balanced network theory [<xref rid="c20" ref-type="bibr">20</xref>, <xref rid="c40" ref-type="bibr">40</xref>, <xref rid="c11" ref-type="bibr">11</xref>, <xref rid="c12" ref-type="bibr">12</xref>, <xref rid="c55" ref-type="bibr">55</xref>, <xref rid="c37" ref-type="bibr">37</xref>, <xref rid="c14" ref-type="bibr">14</xref>, <xref rid="c16" ref-type="bibr">16</xref>]. More importantly, under many biologically relevant connectivity structures, precise cancellation cannot be realized so <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> cannot even be applied [<xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c45" ref-type="bibr">45</xref>, <xref rid="c30" ref-type="bibr">30</xref>]. We next review a simple, linear correction to <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> that partially resolves these issues.</p>
</sec>
<sec id="s2a2"><label>2.1.2</label><title>A linear correction to precise balance</title>
<p>A correction to <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> can be obtained by considering <italic>&#x03F5;</italic> non-zero, but this requires making assumptions on the relationship between neurons&#x2019; input statistics and firing rates. A simple approximation is obtained by assuming that population-averaged firing rates, <bold>r</bold>, depend only on population-averaged mean inputs, <bold>I</bold>, yielding the fixed points problem <bold>r</bold> &#x003D; <italic>f</italic>(<bold>I</bold>) &#x003D; <italic>f</italic>([<italic>W</italic><bold>r</bold> &#x002B; <bold>X</bold>]/<italic>&#x03F5;</italic>) where <italic>f</italic> is the population-level f-I curve. When <italic>f</italic> is an increasing function over relevant ranges of <bold>I</bold>, this fixed point equation can be re-written as
<disp-formula id="ueqn4"><alternatives><graphic xlink:href="201269_ueqn4.gif"/></alternatives></disp-formula>
</p>
<p>Hence, in strongly coupled networks (<italic>&#x03F5;</italic> small), the shape of f-I curves has a small effect on steady-state firing rates under such an approximation. Indeed, in the <italic>&#x03F5;</italic> &#x2192; 0 limit, the f-I curve has no effect and firing rates are determined by <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>. This conclusion easily generalizes to the case where <italic>f</italic> also depends on the average temporal variance of neurons&#x2019; inputs.</p>
<p>A simple case of this approximation is obtained by using a rectified linear approximation, <bold>r</bold> &#x003D; <italic>g</italic>[<bold>I</bold>]<sub>&#x002B;</sub> where [&#x00B7;]<sub>&#x002B;</sub> denotes the positive part. We fit such a function to the relationship between neurons&#x2019; mean synaptic inputs and firing rates from our spiking network simulation (<xref ref-type="fig" rid="fig1">Fig. 1e</xref>). Assuming that the average firing rates of all populations are positive, this rectified linear approximation produces a linear rate model [<xref rid="c13" ref-type="bibr">13</xref>] with mean firing rates given by solving <italic>W</italic><bold>r</bold> &#x002B; <bold>X</bold> &#x003D; <italic>&#x03F5;</italic>/<italic>g</italic> <bold>r</bold> to obtain
<disp-formula id="eqn4"><alternatives><graphic xlink:href="201269_eqn4.gif"/></alternatives></disp-formula>
where
<disp-formula id="ueqn5"><alternatives><graphic xlink:href="201269_ueqn5.gif"/></alternatives></disp-formula>
</p>
<p>The AdEx neuron model used in our simulations has a nonlinear f-I curve (<xref ref-type="fig" rid="fig1">Fig. 1e</xref>; gray dots) and its firing rate depends on all statistics of its input, not just the mean [<xref rid="c8" ref-type="bibr">8</xref>, <xref rid="c21" ref-type="bibr">21</xref>]. Nevertheless, the linear approximation in <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> was accurate in predicting firing rates in our simulations (<xref ref-type="fig" rid="fig1">Fig. 1c</xref>, solid), outperforming the balanced network approximation from <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>. This can be explained by the fact that the balanced approximation in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> is already somewhat accurate and the linear approximation in <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> corrects for some of the error introduced by imperfect balance, even though the true dependence of <bold>r</bold> on <bold>I</bold> is nonlinear.</p>
<p>To further investigate the relative accuracy of <xref ref-type="disp-formula" rid="eqn3">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>, we repeated the spiking network simulations from <xref ref-type="fig" rid="fig1">Fig. 1a-d</xref> while proportionally scaling the number of neurons (<italic>N</italic><sub><italic>E</italic></sub>, <italic>N</italic><sub><italic>I</italic></sub>, and <italic>N</italic><sub><italic>X</italic></sub>) in each population and scaling connection weights and probabilities in such a way that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline3.gif"/></alternatives></inline-formula> (see <xref ref-type="sec" rid="s4">Methods</xref>). As predicted by balanced network theory, excitatory and inhibitory firing rates increased toward the limit in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> (<xref ref-type="fig" rid="fig1">Fig. 1f</xref>, compare light and dark solid lines). The linear correction in <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> tracks this increase in firing rates and is more accurate than the approximation in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>, particularly for smaller <italic>N</italic> (<xref ref-type="fig" rid="fig1">Fig. 1f</xref>, dashed). It is worth noting that, in applying <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> to obtain the dashed curve in <xref ref-type="fig" rid="fig1">Fig. 1f</xref>, we fixed the value of <italic>g</italic> to the one obtained from the simulation in <xref ref-type="fig" rid="fig1">Figs. 1a-e</xref>. Hence, a single estimate of the gain yields an accurate approximation even under different parameter values.</p>
<p>The predictive power of <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> in these examples is, of course, limited by the fact that it was only applied after estimating the gain of the neurons using firing rates obtained in simulations. Moreover, highly nonlinear f-I curves could introduce additional error. However, the purpose of <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> in this work is to provide a first-order approximation to and general understanding of firing rates in networks under which <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> cannot be applied. For these purposes, <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> is sufficient.</p>
</sec>
</sec>
<sec id="s2b"><label>2.2</label><title>Imbalanced amplification under partial optogenetic stimulation</title>
<p>We next show that a more realistic model of optogenetic stimulation breaks the classical balanced state, providing a demonstrative and experimentally relevant example of imbalanced amplification and suppression that explains phenomena observed in recordings from mouse somatosensory cortex.</p>
<sec id="s2b1"><label>2.2.1</label><title>Firing rates are increased by stimulating fewer neurons</title>
<p>The model of optogenetic stimulation considered in <xref ref-type="fig" rid="fig1">Fig. 1</xref> is somewhat inaccurate since opto-genetic stimulation of excitatory neurons is often incomplete. For example, only a fraction of cortical pyramidal neurons express the channelrhodopsin 2 (ChR2) protein targeted in many optogenetic experiments [<xref rid="c7" ref-type="bibr">7</xref>, <xref rid="c42" ref-type="bibr">42</xref>, <xref rid="c44" ref-type="bibr">44</xref>, <xref rid="c2" ref-type="bibr">2</xref>]. To more accurately model optogenetic stimulation, we modified the example above so the extra inward current was provided to only 20&#x0025; of the excitatory neurons (<xref ref-type="fig" rid="fig2">Fig. 2a</xref>), modeling ChR2-expressing pyramidal cells. This change produced surprising results. The ChR2-expressing neurons increased their firing rates by a larger amount than they did when all excitatory neurons received the current (<xref ref-type="fig" rid="fig2">Fig. 2b,c</xref>; compare to <xref ref-type="fig" rid="fig1">Fig. 1b,c</xref>). Hence, counterintuitively, stimulating fewer neurons actually <italic>amplifies</italic> the effects of stimulation on the targeted cells. In contrast, non-expressing excitatory neurons were <italic>suppressed</italic> during stimulation and inhibitory neurons increased their rates, but by a smaller amount than they did under complete stimulation (<xref ref-type="fig" rid="fig2">Fig. 2e</xref>; compare to <xref ref-type="fig" rid="fig1">Fig. 1c</xref>).</p>
<fig id="fig2" position="float" fig-type="figure"><label>Figure 2:</label>
<caption><title>Imbalanced amplification and suppression under partial optogenetic stimulation.</title>
<p>Same as <xref ref-type="fig" rid="fig2">Fig. 2</xref> except the inward current was only provided to 20&#x0025; of the excitatory neurons, modeling ChR2-expressing pyramidal cells. Firing rates of and input current to excitatory neurons are shown separately for ChR2-expressing (c,d) and non-expressing (e,f) neurons, as well as the average over all neurons (g,h). Firing rates predicted by <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> are not shown in c and e because <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> is not applicable to those cases.</p></caption>
<graphic xlink:href="201269_fig2.tif"/>
</fig>
<p>Similar effects were observed in experiments by Adesnik and Scanziani [<xref rid="c2" ref-type="bibr">2</xref>]. In that study, pyramidal neurons in layers (L) 2/3 of mouse somatosensory cortex (S1) were stimulated opto-genetically, but only about 23&#x0025; of the pyramidal neurons expressed ChR2. During stimulation, non-expressing L2/3 pyramidal neurons were suppressed and inhibitory synaptic currents increased, implying an increase in inhibitory neuron firing rates.</p>
<p>To understand these effects, we first extended the mean-field theory above to account for multiple subpopulations by defining
<disp-formula id="ueqn6"><alternatives><graphic xlink:href="201269_ueqn6.gif"/></alternatives></disp-formula>
to be the vector of average firing rates for the ChR2-expressing (<italic>exp</italic>), non-expressing (<italic>nexp</italic>) excitatory neurons and inhibitory (<italic>I</italic>) neurons. The vector of average input to the network is again given by <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> where
<disp-formula id="ueqn7"><alternatives><graphic xlink:href="201269_ueqn7.gif"/></alternatives></disp-formula>
<italic>W</italic><sub><italic>X</italic></sub> &#x003D; [<italic>w</italic><sub><italic>EX</italic></sub> <italic>w</italic><sub><italic>EX</italic></sub> <italic>w</italic><sub><italic>IX</italic></sub>]<sup><italic>T</italic></sup>,
<disp-formula id="ueqn8"><alternatives><graphic xlink:href="201269_ueqn8.gif"/></alternatives></disp-formula>
and <italic>q</italic> &#x003D; 0.2 represents the proportion of neurons that express ChR2.</p>
<p>Importantly, <italic>W</italic> is singular (<italic>i.e.</italic>, not invertible), so classical balanced network theory fails for this example since <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> cannot be evaluated. More specifically, it is impossible for <bold>I</bold> in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> to remain finite as <italic>&#x03F5;</italic> &#x2192; 0 since there is no vector, <bold>r</bold>, such that <italic>W</italic><bold>r</bold> &#x003D; &#x2212;<italic>X</italic>. Intuitively, this can be understood by noting that expressing and non-expressing excitatory neurons receive the same local input on average (<xref ref-type="fig" rid="fig2">Fig. 2d,f</xref>, purple), since local connectivity is not specific to ChR2 expression, but they receive different external input during stimulation (<xref ref-type="fig" rid="fig2">Fig. 2d,f</xref>, green). Therefore, local synaptic input cannot simultaneously cancel the external input to both subpopulations, so the precise cancellation required by classical balanced network theory cannot be achieved (<xref ref-type="fig" rid="fig2">Fig. 2d,f</xref>, black). A similar mechanism has been used to explain a lack of cancellation between positive and negative correlations in balanced networks [<xref rid="c60" ref-type="bibr">60</xref>, <xref rid="c49" ref-type="bibr">49</xref>].</p>
</sec>
<sec id="s2b2"><label>2.2.2</label><title>Amplification in the nullspace: a general analysis</title>
<p>We now give a general analysis of network responses when <italic>W</italic> is singular. The example of partial optogenetic stimulation is then considered as a special case. If <italic>W</italic> is a singular matrix then only vectors, <bold>X</bold>, that are in the column space of <italic>W</italic> admit solutions to <italic>W</italic><bold>r</bold> &#x002B; <bold>X</bold> &#x003D; 0. The column space of <italic>W</italic> is defined as the linear space of all vectors, <bold>u</bold>, such that <bold>u</bold> &#x003D; <italic>W</italic><bold>r</bold> for some <bold>r</bold>. The column space of a matrix, <italic>W</italic>, is the orthogonal complement of the nullspace of <italic>W</italic><sup><italic>T</italic></sup>. We can therefore decompose
<disp-formula id="ueqn9"><alternatives><graphic xlink:href="201269_ueqn9.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline4.gif"/></alternatives></inline-formula> is the projection of <bold>X</bold> onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> and <bold>X</bold><sub>1</sub> &#x003D; proj<sub><italic>C</italic>(<italic>W</italic></sub>) <bold>X</bold> is the projection onto the column space of <italic>W</italic>. Moreover, note that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline5.gif"/></alternatives></inline-formula> since <italic>W</italic><bold>r</bold> is in the column space of <italic>W</italic>. Therefore, the projection of the total input onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is
<disp-formula id="eqn5"><alternatives><graphic xlink:href="201269_eqn5.gif"/></alternatives></disp-formula>
</p>
<p>Hence, the projection of the total synaptic input onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is &#x1D4AA;(1/<italic>&#x03F5;</italic>) whenever <bold>X</bold> has an &#x1D4AA;(1) component in the nullspace of <italic>W</italic><sup><italic>T</italic></sup>. Note that, despite the 1/<italic>&#x03F5;</italic> term in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, the total synaptic input, <bold>I</bold>, is &#x1D4AA;(1) when balance is realized due to cancellation (as in <xref ref-type="fig" rid="fig1">Fig. 1d</xref>). Hence, the singularity of <italic>W</italic> introduces large, &#x1D4AA;(1/<italic>&#x03F5;</italic>) synaptic currents where they would not occur if <italic>W</italic> was non-singular. In other words, external input in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> produces strong synaptic currents in the network. Importantly, this conclusion does not rely on any assumptions about neurons&#x2019; f-I curves or other properties. This result is a fundamental property of balanced networks or, more generally, networks receiving strong feedforward input.</p>
<p>To understand the implications of this result on firing rates in the network, however, we must specify an f-I curve. We again consider the linear rate approximation quantified by <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>. Importantly, unlike <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> from classical balanced network theory, the approximation in <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> is applicable to this example because it accounts for imperfect cancellation between local and external inputs. Specifically, the regularized matrix, <italic>&#x03F5;D</italic> &#x2212; <italic>W</italic>, is invertible so <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> can be evaluated even though <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> cannot. The resulting firing rate solution from <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> agrees well with spiking network simulations (<xref ref-type="fig" rid="fig2">Fig. 2c,e</xref>). Hence, <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> provides an accurate approximation to firing rates in networks to which classical balanced network theory is not applicable at all.</p>
<p><xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> also provides a concise mathematical quantification of firing rates when <italic>W</italic> is singular. Namely, if <bold>X</bold><sub>0</sub>, <bold>X</bold><sub>1</sub> &#x007E; &#x1D4AA;(1) then firing rates can be expanded as
<disp-formula id="eqn6"><alternatives><graphic xlink:href="201269_eqn6.gif"/></alternatives></disp-formula>
where <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic> and <bold>r</bold><sub>0</sub>, <bold>r</bold><sub>0</sub> &#x007E; &#x1D4AA;(1). To derive this result, first note that <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> can be rewritten as
<disp-formula id="eqn7"><alternatives><graphic xlink:href="201269_eqn7.gif"/></alternatives></disp-formula>
If <bold>X</bold> has components in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> then we can project both sides of this equation onto this nullspace to obtain
<disp-formula id="ueqn10"><alternatives><graphic xlink:href="201269_ueqn10.gif"/></alternatives></disp-formula>
where we again used the fact that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline6.gif"/></alternatives></inline-formula> since <italic>W</italic><bold>r</bold> is in the column space of <italic>W</italic>. Since <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline7.gif"/></alternatives></inline-formula> and <italic>D</italic> are assumed &#x1D4AA;(1), this equation is only consistent when <bold>r</bold> &#x007E; &#x1D4AA;(1/<italic>&#x03F5;</italic>). We can therefore decompose <bold>r</bold> &#x003D; (1/<italic>&#x03F5;</italic>)<bold>r</bold><sub>0</sub> &#x002B; <bold>r</bold><sub>1</sub> where <bold>r</bold><sub>0</sub>,<bold>r</bold><sub>1</sub> &#x007E; &#x1D4AA;(1). We next show that <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>. From <xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref>, we have
<disp-formula id="ueqn11"><alternatives><graphic xlink:href="201269_ueqn11.gif"/></alternatives></disp-formula>
</p>
<p>Isolating the &#x1D4AA;(1/<italic>&#x03F5;</italic>) terms gives <italic>W</italic><bold>r</bold><sub>0</sub> &#x003D; 0 and therefore <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>. In summary, components of external input in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> partially break balance to evoke amplified firing rates in the nullspace of <italic>W</italic>.</p>
<p>In the special case that <italic>W</italic> has a one-dimensional nullspace, a more precise characterization of <bold>r</bold><sub>0</sub> is possible. Let <bold>v</bold><sub>0</sub> be in the nullspace of <italic>W</italic> with &#x007C;&#x007C;<bold>v</bold><sub>0</sub>&#x007C;&#x007C; &#x003D; 1. Note that W<sup><italic>T</italic></sup> also has a one-dimensional nullspace (since <italic>W</italic> is a square matrix). Let <bold>v</bold><sub><italic>2</italic></sub> be in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> with &#x007C;&#x007C;<bold>v</bold><sub>2</sub>&#x007C;&#x007C; &#x003D; 1. Since <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>, we can write <bold>r</bold><sub>0</sub> &#x003D; <italic>a</italic><bold>v</bold><sub>0</sub> for some scalar, <italic>a.</italic> Now, dot product both sides of <xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref> by <bold>v</bold><sub>2</sub> to obtain
<disp-formula id="ueqn12"><alternatives><graphic xlink:href="201269_ueqn12.gif"/></alternatives></disp-formula>
where we have used that <bold>v</bold><sub>2</sub> &#x00B7; <italic>W</italic><bold>r</bold> &#x003D; 0 since <bold>v</bold><sub>2</sub> is in the nullspace of <italic>W</italic><sup><italic>T</italic></sup>, which is orthogonal to <italic>W</italic><bold>r</bold> in the column space of <italic>W</italic>. Keeping only &#x1D4AA;(1) terms and making the substitution <bold>r</bold><sub>0</sub> &#x003D; <italic>a</italic><bold>v</bold><sub>0</sub>, we get
<disp-formula id="ueqn13"><alternatives><graphic xlink:href="201269_ueqn13.gif"/></alternatives></disp-formula>
so that
<disp-formula id="eqn8"><alternatives><graphic xlink:href="201269_eqn8.gif"/></alternatives></disp-formula>
yielding a concise expression for the amplified component of firing rates when <italic>W</italic> has a one-dimensional nullspace. Note that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline8.gif"/></alternatives></inline-formula> and <bold>v</bold><sub>0</sub> is in the nullspace of <italic>W</italic>, so this result is consistent with the more general conclusions above.</p>
</sec>
<sec id="s2b3"><label>2.2.3</label><title>Amplification in the nullspace under partial optogenetic stimulation</title>
<p>For the specific example of partial optogenetic stimulation considered in <xref ref-type="fig" rid="fig2">Fig. 2</xref>, the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is spanned by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline9.gif"/></alternatives></inline-formula> and the projection of <bold>X</bold> onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is <bold>X</bold><sub>0</sub> &#x003D; [<italic>s</italic>/2 &#x2212;<italic>s</italic>/2 0]<sup><italic>T</italic></sup>. The nullspace of <italic>W</italic> is spanned by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline10.gif"/></alternatives></inline-formula>. We therefore have <bold>r</bold> &#x003D; (1/<italic>&#x03F5;</italic>)<bold>r</bold><sub>0</sub> &#x002B; <bold>r</bold><sub>1</sub> where <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> gives
<disp-formula id="ueqn14"><alternatives><graphic xlink:href="201269_ueqn14.gif"/></alternatives></disp-formula>
</p>
<p>Hence, ChR2-expressing neurons are amplified and non-expressing neurons are suppressed by optogenetic stimulation, as observed in simulations. A more precise result is given by expanding the full approximation from <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> to obtain
<disp-formula id="eqn9"><alternatives><graphic xlink:href="201269_eqn9.gif"/></alternatives></disp-formula>
</p>
<p>Here, &#x1D4AA;(<italic>s</italic>) is a constant proportional to <italic>s</italic>, <italic>c</italic> &#x003D; &#x007C;<italic>w</italic><sub><italic>IE</italic></sub>/<italic>w</italic><sub><italic>II</italic></sub>&#x007C; and <bold>r</bold><sub>off</sub> is the vector of firing rates in the balanced, <italic>&#x03F5;</italic> &#x2192; 0, limit when stimulation is off (<italic>s</italic> &#x003D; 0). Specifically, <bold>r</bold><sub>off</sub> is the unique vector that satisfies <italic>W</italic><bold>r</bold><sub>off</sub> &#x002B; <italic>W</italic><sub><italic>X</italic></sub><italic>r</italic><sub><italic>X</italic></sub> &#x003D; 0, which is solvable even though <italic>W</italic> is singular because W<sub><italic>X</italic></sub><italic>r</italic><sub><italic>X</italic></sub> is in the column space of <italic>W</italic>, so balance can be maintained when <italic>s</italic> &#x003D; 0.</p>
<p>The &#x1D4AA;(<italic>s</italic>/<italic>&#x03F5;</italic>) term in <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> quantifies the amplification and suppression observed in simulations: Non-expressing neurons are suppressed by stimulation since &#x2212;<italic>q</italic> &#x003C; 0 and the response of ChR2-expressing neurons is amplified since 1 &#x2212;<italic>q</italic> &#x003E; 0 and <italic>s</italic>/<italic>&#x03F5;</italic> is large. The &#x1D4AA;(<italic>s</italic>) term shows why inhibitory neurons increase their rates by a smaller amount. In summary, the optogenetically induced suppression observed experimentally by Adesnik and Scanziani [<xref rid="c2" ref-type="bibr">2</xref>] is a generic feature of balanced or strongly coupled networks under partial stimulation.</p>
</sec>
<sec id="s2b4"><label>2.2.4</label><title>Local imbalance with global balance explains intralaminar suppression and interlaminar facilitation</title>
<p>Interestingly, despite the break of balance at the level of ChR2-expressing and non-expressing subpopulations, global balance is maintained in this example. This can be understood by repeating the mean-field analysis above without partitioning neurons into ChR2-expressing and non-expressing sub-populations, thereby quantifying the global average of firing rate of all excitatory neurons. In particular, the average synaptic input, <bold>I</bold> &#x003D; [<italic>I</italic><sub><italic>E</italic></sub> <italic>I</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>, to excitatory and inhibitory neurons is given by <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> where <italic>W</italic> and <italic>W</italic><sub><italic>X</italic></sub> are as in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, and
<disp-formula id="ueqn15"><alternatives><graphic xlink:href="201269_ueqn15.gif"/></alternatives></disp-formula>
to account for the fact that only a proportion <italic>q</italic> of the excitatory neurons receive the inward current from optogenetic stimulation. In this case, <italic>W</italic> is non-singular so the balanced solution in <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> is applicable. Indeed, the average firing rates of all excitatory neurons in our spiking network simulation is close to the prediction from <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> and even closer to the prediction from <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> (<xref ref-type="fig" rid="fig2">Fig. 2g</xref>; compare to <xref ref-type="fig" rid="fig1">Fig. 1c</xref>). The average feedforward input to all excitatory neurons is canceled by net-inhibitory local input (<xref ref-type="fig" rid="fig2">Fig. 2h</xref>; compare to <xref ref-type="fig" rid="fig1">Fig. 1d</xref>). Hence, balance is maintained globally even though the network is imbalanced at the level of ChR2-expressing and non-expressing populations.</p>
<p>In the same study by Adesnik and Scanziani considered above [<xref rid="c2" ref-type="bibr">2</xref>], recordings were made in L5, which was not directly stimulated optogenetically, but receives synaptic input from L2/3. Interestingly, despite the fact that most excitatory neurons in L2/3 were suppressed during stimulation, firing rates in L5 increased.</p>
<p>To model these experiments, we interpreted the recurrent network from <xref ref-type="fig" rid="fig2">Fig. 2</xref> as a local neural population in L2/3, which sends synaptic projections to L5 (<xref ref-type="fig" rid="fig3">Fig. 3a</xref>). We modeled a neural population in L5 identically to the L2/3 population, except its feedforward input came from excitatory neurons in the L2/3 network, instead of from Poisson-spiking neurons. As in experiments [<xref rid="c2" ref-type="bibr">2</xref>], L5 neurons increased their firing rates during stimulation (<xref ref-type="fig" rid="fig3">Fig. 3b</xref>) and approximate balance was maintained (<xref ref-type="fig" rid="fig3">Fig. 3c</xref>). This can be understood by noting that L5 receives synaptic input sampled from all excitatory neurons in L2/3. Hence, the feedforward excitatory current to L5 neurons increases proportionally to the average excitatory firing rates in L2/3 during stimulation. As we showed above, this average rate increases (<xref ref-type="fig" rid="fig2">Fig. 2e</xref>), despite the fact that most excitatory neurons in L2/3 are suppressed by stimulation. Hence, the combination of intralaminar suppression and interlaminar facilitation observed during optogenetic stimulation in experiments [<xref rid="c2" ref-type="bibr">2</xref>] results from the fact that the stimulated layer is locally imbalanced, but globally balanced during partial stimulation.</p>
<fig id="fig3" position="float" fig-type="figure"><label>Figure 3:</label>
<caption><title>Interlaminar facilitation despite intralaminar suppression under optogenetic stimulation.</title>
<p><bold>a)</bold> Multi-layer network schematic. L2/3 was identical to the recurrent network in <xref ref-type="fig" rid="fig2">Fig. 2</xref> and provided external excitatory input to L5, which had the same internal structure as the L2/3 model. <bold>b)</bold> Excitatory and inhibitory firing rates in L5. <bold>c)</bold> Average synaptic current to randomly sampled excitatory neurons in L5.</p></caption>
<graphic xlink:href="201269_fig3.tif"/>
</fig>
</sec>
<sec id="s2b5"><label>2.2.5</label><title>Imbalanced amplification of weak stimuli</title>
<p>Sufficiently small <italic>&#x03F5;</italic> or large <italic>s</italic> would introduce negative rates in <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>, representing a regime in which non-expressing neurons cease spiking and the firing rate of ChR2-expressing neurons saturate at a high value. In this sense, firing rates do not truly have a &#x1D4AA;(1/<italic>&#x03F5;</italic>) component for <italic>&#x03F5;</italic> very small. However, smaller values of <italic>&#x03F5;</italic> allow weak stimuli (small <italic>s</italic>) to be strongly amplified. Strictly speaking, if one takes <italic>s</italic> &#x007E; &#x1D4AA;(<italic>&#x03F5;</italic>), then under the linear approximation in <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>, partial optogenetic stimulation would have an &#x1D4AA;(1) effect on the average firing rate of stimulated and unstimulated subpopulations, but an &#x1D4AA;(<italic>&#x03F5;</italic>) effect on globally averaged firing rates. In practical terms, this means that, in strongly coupled networks (<italic>&#x03F5;</italic> small), partial optogenetic stimuli can have a moderate effect on the firing rates of stimulated neurons while having a negligible effect on the average firing rates of all excitatory neurons.</p>
<p>To demonstrate this idea, we repeated the simulations from <xref ref-type="fig" rid="fig2">Fig. 2</xref> in a network with four times as many neurons (<italic>N</italic> &#x003D; 2 &#x00D7; 10<sup>4</sup>) where synaptic weights and probabilities were scaled so that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline11.gif"/></alternatives></inline-formula> (as in <xref ref-type="fig" rid="fig1">Fig. 1f</xref>) and we reduced stimulus strength, <italic>s</italic>, as well. In this simulation, ChR2-expressing neurons&#x2019; firing rates nearly doubled (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>) and non-expressing neurons were noticeably suppressed (<xref ref-type="fig" rid="fig4">Fig. 4b</xref>). However, the change in the average firing rate of all excitatory neurons was nearly imperceptible (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>) and similarly for the firing rates of inhibitory neurons (<xref ref-type="fig" rid="fig4">Fig. 4b,c</xref>). As a result, the firing rates in a downstream layer were unnoticeably modulated during stimulation (<xref ref-type="fig" rid="fig4">Fig. 4d</xref>; compare to <xref ref-type="fig" rid="fig3">Fig. 3</xref>). This effect could mask the effects of optogenetic stimulation in recordings.</p>
<fig id="fig4" position="float" fig-type="figure"><label>Figure 4:</label>
<caption><title>Imbalanced amplification of weak stimuli.</title>
<p><bold>a-c)</bold> Same as <xref ref-type="fig" rid="fig2">Fig. 2b,e,g</xref> except with <italic>N</italic> increased by a factor of four, <italic>&#x03F5;</italic> decreased by a factor of two, and a weaker stimulus. <bold>d)</bold> Same as <xref ref-type="fig" rid="fig3">Fig. 3b</xref> except using excitatory neurons from the recurrent network in a-c as the feedforward input.</p></caption>
<graphic xlink:href="201269_fig4.tif"/>
</fig>
</sec>
<sec id="s2b6"><label>2.2.6</label><title>mbalanced amplification with nearly singular connectivity matrices</title>
<p>An apparent limitation of the results above is that they rely on the singularity of the connectivity matrix, <italic>W</italic>. Singularity is a fragile property of matrices that arises from structural symmetries. In the example above, singularity arises from our implicit assumption that local synaptic connectivity is independent of whether neurons express ChR2. Even a slight difference in connectivity to or from ChR2-expressing neurons would make <italic>W</italic> non-singular so that its nullspace would be empty, rendering <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> vacuous. We now show that <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> and the surrounding analysis naturally extends to connectivity matrices that are approximately singular, with similar overall conclusions.</p>
<p>A matrix, <italic>W</italic>, is singular if it has <italic>&#x03BB;</italic> &#x003D; 0 as an eigenvalue. A matrix can therefore be considered approximately singular if it has an eigenvalue with small magnitude. Specifically, let <italic>&#x03BB;</italic> be an eigenvalue of <italic>W</italic> with &#x007C;&#x03BB;&#x007C; &#x226A; 1. Note that <italic>&#x03BB;</italic> is also an eigenvalue of <italic>W</italic><sup><italic>T</italic></sup>. Now let <bold>v</bold> be the associated eigenvector so that <italic>W</italic><sup><italic>T</italic></sup>v &#x003D; <italic>&#x03BB;</italic><bold>v</bold> and assume that &#x007C;&#x007C;<bold>v</bold>&#x007C;&#x007C; &#x003D; 1 without loss of generality. Take the projection of each term in <xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref> onto the subspace spanned by v to get
<disp-formula id="ueqn16"><alternatives><graphic xlink:href="201269_ueqn16.gif"/></alternatives></disp-formula>
</p>
<p>Now note that proj<sub><bold>v</bold></sub>[<italic>W</italic><bold>r</bold>] &#x003D; <italic>&#x03BB;</italic> proj<sub><bold>v</bold></sub> <bold>r</bold>. Hence,
<disp-formula id="ueqn17"><alternatives><graphic xlink:href="201269_ueqn17.gif"/></alternatives></disp-formula>
</p>
<p>If proj<sub><bold>v</bold></sub> <italic>X</italic> &#x007E; &#x1D4AA;(1) and proj<sub><bold>v</bold></sub>[<italic>D</italic><bold>r</bold>] &#x007E; proj<sub><bold>v</bold></sub> <bold>r</bold> then this implies
<disp-formula id="ueqn18"><alternatives><graphic xlink:href="201269_ueqn18.gif"/></alternatives></disp-formula>
Hence,
<disp-formula id="ueqn19"><alternatives><graphic xlink:href="201269_ueqn19.gif"/></alternatives></disp-formula>
where &#x03B4; &#x003D; |<italic>&#x03BB;</italic>|&#x002B;<italic>&#x03F5;</italic>. This generalizes <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> to the case where <italic>W</italic> is only approximately singular. In summary, the mechanism of imbalanced amplification is a general property of strongly coupled networks with singular or nearly singular connection matrices.</p>
<p>We next show that networks with connection probabilities that depend on continuous quantities like distance or tuning preference necessarily have singular or nearly singular connectivity kernels and are therefore naturally susceptible to the amplification and suppression mechanisms described above.</p>
</sec>
</sec>
<sec id="s2c"><label>2.3</label><title>Imbalanced amplification and suppression in continuously indexed networks</title>
<p>So far we considered networks with discrete subpopulations. Connectivity in many cortical circuits depends on continuous quantities like distance in physical or tuning space. To understand how the amplification and suppression mechanisms discussed above extend to such connectivity structures, we next considered a model of a visual cortical circuit. We arranged 2 &#x00D7; 10<sup>5</sup> AdEx model neurons (80&#x0025; excitatory and 20&#x0025; inhibitory) on a square domain, modeling a patch of L2/3 in mouse primary visual cortex (V1). Neurons received external input from a similarly arranged layer of 1.6 &#x00D7; 10<sup>5</sup> Poisson-spiking neurons, modeling a parallel patch of L4 (<xref ref-type="fig" rid="fig5">Fig. 5a</xref>). We additionally assigned a random orientation preference to each neuron, modeling the &#x201C;salt&#x002D; and-pepper&#x201D; distribution of orientation preferences in mouse V1. Connectivity was probabilistic and, as in cortex [<xref rid="c23" ref-type="bibr">23</xref>, <xref rid="c28" ref-type="bibr">28</xref>, <xref rid="c33" ref-type="bibr">33</xref>], inter&#x002D; and intralaminar connections were more numerous between nearby and similarly tuned neurons. Specifically connection probability decayed like a Gaussian as a function of distance in physical and orientation space (<xref ref-type="fig" rid="fig5">Fig. 5b</xref>), where distance in both spaces was measured using periodic boundaries.</p>
<fig id="fig5" position="float" fig-type="figure"><label>Figure 5:</label>
<caption><title>Response properties of a continuously indexed network.</title>
<p><bold>a)</bold> Network diagram. Poisson spiking neurons in L4 (<italic>X</italic>) provide external synaptic input to 2 &#x00D7; 10<sup>5</sup> recurrently connected excitatory and inhibitory AdEx model neurons (<italic>E</italic> and <italic>I</italic>) in L2/3. The spatial width of synaptic projections from population <italic>a</italic> &#x003D; <italic>X</italic>, <italic>E</italic>, <italic>I</italic> is given by <italic>&#x03B2;</italic><sub><italic>a</italic></sub>. <bold>b)</bold> Neurons are assigned random orientations and connection probability also depends on the difference, <italic>d&#x03B8;</italic>, between neurons&#x2019; preferred orientation. <bold>c)</bold> An oriented stimulus in the animal&#x2019;s visual field. <bold>d,e)</bold> The location of the stimulus is modeled by firing rates in L4 that are peaked at the location of the stimulus in physical and orientation space. <bold>f,g)</bold> Synaptic current to neurons in population <italic>E</italic> from the external network (green), the local network (purple) and total (black) as a function distance from the receptive field center and as a function of neurons&#x2019; preferred orientation. <bold>h,i)</bold> Firing rate profiles of excitatory (red) and inhibitory (blue) neurons in the local network from simulations (light curves), classical balanced network theory (solid, dark curves; from <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref>) and under the linear correction (dashed; from <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref>) in physical and orientation space. <bold>j-o)</bold> Same as (d-i) except for a smaller visual stimulus, modeled by a narrower spatial firing rate profile in L4.</p></caption>
<graphic xlink:href="201269_fig5.tif"/>
</fig>
<sec id="s3c1"><label>2.3.1</label><title>Amplification and suppression from spatially narrow stimuli</title>
<p>An oriented stimulus localized in the animal&#x2019;s visual field (<xref ref-type="fig" rid="fig5">Fig. 5c</xref>) was modeled by imposing firing rate profiles in L4 that were peaked at the associated location in physical and tuning space, again with a Gaussian profile (<xref ref-type="fig" rid="fig5">Fig. 5d,e</xref>). This produced external input to L2/3 that was similarly peaked, but was nearly perfectly canceled by net-inhibitory lateral input (<xref ref-type="fig" rid="fig5">Fig. 5f,g</xref>). Excitatory and inhibitory firing rate profiles in L2/3 were also peaked at the associated location in physical and tuning space (<xref ref-type="fig" rid="fig5">Fig. 5h,i</xref>), demonstrating that neurons in L2/3 were appropriately tuned to the stimulus.</p>
<p>A smaller visual stimulus was modeled by shrinking the spatial profile of firing rates in L4 while leaving the orientation-dependence of L4 rates unchanged (<xref ref-type="fig" rid="fig5">Fig. 5j,k</xref>). As above, synaptic inputs and firing rate profiles were appropriately peaked in physical and orientation tuning space (<xref ref-type="fig" rid="fig5">Fig. 5l-o</xref>). However, the smaller stimulus produced a surprising change to firing rates in L2/3. Despite the fact that L2/3 neurons at all locations received less excitation from L4 (<xref ref-type="fig" rid="fig5">Fig. 5l</xref>), peak firing rates in L2/3 increased and a surround suppression dynamic emerged (<xref ref-type="fig" rid="fig5">Fig. 5n</xref>). Hence, a more localized external input produced an amplification and suppression dynamic similar to the one observed in our model of optogenetic stimulation (compare to <xref ref-type="fig" rid="fig2">Fig. 2</xref>). On the other hand, responses in orientation tuning space were mostly unchanged by the smaller stimulus size (<xref ref-type="fig" rid="fig5">Fig. 5m,o</xref>).</p>
</sec>
<sec id="s2c2"><label>2.3.2</label><title>Mean-field theory of balance in two-dimensional spatial networks with orientation-tuning-specific connectivity</title>
<p>The mean-field theory of balanced networks was previously extended to continuously indexed networks in one and two dimensions [<xref rid="c34" ref-type="bibr">34</xref>, <xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c49" ref-type="bibr">49</xref>]. We now review a straightforward extension to two spatial dimensions and one orientation dimension. <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> generalizes naturally to
<disp-formula id="eqn10"><alternatives><graphic xlink:href="201269_eqn10.gif"/></alternatives></disp-formula>
where <bold>r</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>) &#x003D; [<italic>r</italic><sub><italic>E</italic></sub> (<italic>x</italic>, <italic>&#x03B8;</italic>) <italic>r</italic><sub><italic>I</italic></sub>(<italic>x</italic>, <italic>&#x03B8;</italic>)]<sup><italic>T</italic></sup> is the vector of mean firing rates of excitatory and inhibitory L2/3 neurons near spatial coordinates <bold>x</bold> &#x003D; (<italic>x</italic>, <italic>y</italic>) with preferred orientation near <italic>&#x03B8;</italic>, and similarly for the neurons&#x2019; external input, <bold>X</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>), and total input, <bold>I</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>). The external input is given by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline12.gif"/></alternatives></inline-formula> where <italic>r</italic><sub><italic>X</italic></sub> (<bold>x</bold>, <italic>&#x03B8;</italic>) is the profile of firing rates in L4 The connectivity kernels, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline13.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline14.gif"/></alternatives></inline-formula>, are convolution integral operators defined by
<disp-formula id="ueqn20"><alternatives><graphic xlink:href="201269_ueqn20.gif"/></alternatives></disp-formula>
and
<disp-formula id="ueqn21"><alternatives><graphic xlink:href="201269_ueqn21.gif"/></alternatives></disp-formula>
</p>
<p>Here, <italic>w</italic><sub><italic>ab</italic></sub>(<italic>x</italic>, <italic>&#x03B8;</italic>) is the mean-field connection strength between neurons separated by <bold>x</bold> in physical space and <italic>&#x03B8;</italic> in orientation space (see <xref ref-type="sec" rid="s4">Methods</xref>), and [<italic>w</italic><sub><italic>ab</italic></sub> &#x2217; <italic>r</italic><sub><italic>b</italic></sub>](<bold>x</bold>, <italic>&#x03B8;</italic>) denotes circular convolution with respect to <bold>x</bold> and <italic>&#x03B8;</italic>, <italic>i.e.</italic>, convolution with periodic boundaries. These convolution operators implement low-pass filters in orientation and physical space, capturing the effects of synaptic divergence and tuning-specific connection probabilities. Similar filters describe feedforward connectivity in artificial convolutional neural networks used for image recognition [<xref rid="c31" ref-type="bibr">31</xref>].</p>
<p>Taking <italic>&#x03F5;</italic> &#x2192; 0 in <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> shows that that firing rates must satisfy
<disp-formula id="eqn11"><alternatives><graphic xlink:href="201269_eqn11.gif"/></alternatives></disp-formula>
</p>
<p>This is an analogue to <xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref> for spatial networks. From here, one may be tempted to invert the integral operator <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline15.gif"/></alternatives></inline-formula> to obtain a spatial analogue of <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>. However, integral operators are never invertible [<xref rid="c56" ref-type="bibr">56</xref>]. Specifically, since <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> is an integral equation of the first kind, there necessarily exist external input profiles, <bold>X</bold>(<bold>x</bold>, 0), for which <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> does not admit a solution so that the classical balanced state cannot be realized [<xref rid="c48" ref-type="bibr">48</xref>]. This implies that there always exist inputs that prevent a continuously indexed network from maintaining excitatory-inhibitory balance. To better understand why this is the case, we follow previous work [<xref rid="c5" ref-type="bibr">5</xref>, <xref rid="c34" ref-type="bibr">34</xref>, <xref rid="c48" ref-type="bibr">48</xref>, <xref rid="c50" ref-type="bibr">50</xref>, <xref rid="c49" ref-type="bibr">49</xref>] in transitioning to the spatial Fourier domain to rewrite <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> as
<disp-formula id="eqn12"><alternatives><graphic xlink:href="201269_eqn12.gif"/></alternatives></disp-formula>
</p>
<p>Here, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline16.gif"/></alternatives></inline-formula> is a Fourier coefficient of <bold>r</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>) and similarly for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline17.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline18.gif"/></alternatives></inline-formula> where <bold>n</bold> &#x003D; (<italic>n</italic><sub>1</sub>,<italic>n</italic><sub>2</sub>) is the two-dimensional spatial Fourier mode and <italic>k</italic> is the Fourier mode in tuning space. Importantly, the convolution operators above become ordinary matrices in the Fourier domain. Specifically,
<disp-formula id="ueqn22"><alternatives><graphic xlink:href="201269_ueqn22.gif"/></alternatives></disp-formula>
and
<disp-formula id="ueqn23"><alternatives><graphic xlink:href="201269_ueqn23.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline19.gif"/></alternatives></inline-formula> is a Fourier coefficient of <italic>w</italic><sub><italic>ab</italic></sub>(<bold>x</bold>, <italic>&#x03B8;</italic>). Note that going from <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> to <xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref> requires that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline20.gif"/></alternatives></inline-formula> is a convolution operator and that the boundaries of the network are treated periodically, <italic>i.e.</italic>, the convolutions are circular.</p>
<p>Solving <xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref> gives an analogue to <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> for spatial networks in the Fourier domain,
<disp-formula id="eqn13"><alternatives><graphic xlink:href="201269_eqn13.gif"/></alternatives></disp-formula>
</p>
<p>This equation gives all Fourier coefficients, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline21.gif"/></alternatives></inline-formula>. However, this solution is only viable when the inverse transform exists, <italic>i.e.</italic>, when the Fourier series of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline22.gif"/></alternatives></inline-formula> converges, which in turn requires that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline23.gif"/></alternatives></inline-formula> converges to zero faster than <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline24.gif"/></alternatives></inline-formula> as <bold>n</bold> &#x2192; 0 and <italic>k</italic> &#x2192; 0. More specifically, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline25.gif"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> must be square-summable. Hence, balance can only be realized when recurrent connectivity, quantified by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline26.gif"/></alternatives></inline-formula>, has more power at high spatial frequencies than external input, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline27.gif"/></alternatives></inline-formula>. In other words, for balance to be realized, external input, <bold>X</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>), cannot have &#x201C;sharper&#x201D; spatial features than the recurrent connectivity kernels, <italic>w</italic><sub><italic>ab</italic></sub>(<bold>x</bold>, <italic>&#x03B8;</italic>) for <italic>a, b</italic> &#x003D; <italic>E, I</italic>.</p>
</sec>
<sec id="s2c3"><label>2.3.3</label><title>Balance and imbalance in networks with Gaussian-shaped connectivity kernels</title>
<p>A more intuitive understanding of when and why balance is broken is provided by considering the Gaussian-shaped connectivity and firing rate profiles used in our spiking network simulations. This explanation applies equally to the spatial profile of firing rates and connectivity in physical and orientation space, so we do not distinguish between the two in this discussion. Similar calculations were performed previously for spatial networks [<xref rid="c48" ref-type="bibr">48</xref>], so we only review the results here and discuss some of their implications here.</p>
<p>Let <italic>&#x03C3;</italic><sub><italic>a</italic></sub> be the width of the Gaussian firing rate profile in population <italic>a</italic>, <italic>&#x03B1;</italic><sub><italic>a</italic></sub> the width of outgoing synaptic connections from the presynaptic neurons in population <italic>a</italic>, and <italic>&#x03B2;</italic><sub><italic>a</italic></sub> the width of the spatial profile of synaptic input from population <italic>a</italic> (<xref ref-type="fig" rid="fig5">Fig. 5a,d,f,h</xref>). Synaptic divergence broadens the profile of synaptic currents so that
<disp-formula id="eqn14"><alternatives><graphic xlink:href="201269_eqn14.gif"/></alternatives></disp-formula>
</p>
<p>For balance to be maintained, feedforward synaptic input from L4 must be precisely canceled by lateral synaptic input in L2/3. This, in turn, requires that
<disp-formula id="ueqn24"><alternatives><graphic xlink:href="201269_ueqn24.gif"/></alternatives></disp-formula>
</p>
<p>Combined with <xref ref-type="disp-formula" rid="eqn14">Eq. (14)</xref>, this implies that balance requires the widths of firing rate profiles in L2/3 to satisfy [<xref rid="c48" ref-type="bibr">48</xref>]
<disp-formula id="eqn15"><alternatives><graphic xlink:href="201269_eqn15.gif"/></alternatives></disp-formula>
</p>
<p>This approximation accurately predicted firing rate profiles in our first spiking network simulation (<xref ref-type="fig" rid="fig5">Fig. 5h,i</xref>, solid, dark curves have widths given by <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>). Hence, by <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>, the requirement of cancellation in balanced networks implies that recurrent connectivity sharpens neurons&#x2019; tuning, both in physical and orientation space.</p>
<p>Interestingly, <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref> implies that the amount by which excitatory and inhibitory firing rate profiles are sharpened in balanced networks is determined by the width of their <italic>outgoing</italic> synaptic projections. Pyramidal neurons in L2/3 of mouse V1 preferentially target similarly tuned neurons in L2/3, but the tuning of these lateral connection probabilities is much broader than the tuning of pyramidal neurons&#x2019; firing rates [<xref rid="c28" ref-type="bibr">28</xref>] (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003E; <italic>&#x03C3;</italic><sub><italic>E</italic></sub> in orientation space). This observation is consistent with <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>: Excitatory neuron tuning curves are sharpened precisely because their outgoing connections are broadly tuned. Hence, sharpening of excitatory neuron tuning curves in L2/3 is naturally achieved in balanced networks with lateral excitation, without requiring lateral inhibition. Following the same line of reasoning, the broader orientation tuning of inhibitory neurons [<xref rid="c23" ref-type="bibr">23</xref>] (<italic>&#x03C3;</italic><sub><italic>I</italic></sub> larger) suggests that they project more locally in orientation tuning space than pyramidal neurons (<italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003C; <italic>&#x03B1;</italic><sub><italic>E</italic></sub> in orientation space).</p>
<p><xref ref-type="disp-formula" rid="eqn15">Eqs. (15)</xref> also clarify when and why balanced network theory fails for continuously indexed networks. If external inputs are sharper than lateral connectivity (<italic>&#x03B2;</italic><sub><italic>X</italic></sub> &#x003C; <italic>&#x03B1;</italic><sub><italic>E</italic></sub> or <italic>&#x03B2;</italic><sub><italic>X</italic></sub> &#x003C; <italic>&#x03B1;</italic><sub><italic>I</italic></sub>) in physical or orientation space, then <xref ref-type="disp-formula" rid="eqn15">Eqs. (15)</xref> do not yield real solutions for <italic>&#x03C3;</italic><sub><italic>E</italic></sub> or <italic>&#x03C3;</italic><sub><italic>I</italic></sub>. In other words, balance requires that
<disp-formula id="ueqn25"><alternatives><graphic xlink:href="201269_ueqn25.gif"/></alternatives></disp-formula>
because <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> does not admit a solution when these inequalities are broken [<xref rid="c48" ref-type="bibr">48</xref>]. In other words, the classical balanced state cannot be realized when external synaptic input is too localized for the recurrent network to cancel with its broader connectivity. As a result, balanced network theory cannot be applied to the example in <xref ref-type="fig" rid="fig5">Fig. 5j-o</xref> with a smaller visual stimulus.</p>
</sec>
<sec id="s2c4"><label>2.3.4</label><title>A linear correction to balance quantifies amplification and suppression in continuously indexed networks</title>
<p>We next derive a linear correction to <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> that accounts for imperfect cancellation and, in doing so, gives firing rate approximations where classical balanced network theory fails. Specifically, we generalize the derivation of <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> to continuously indexed networks. Under this linear approximation, firing rate profiles are given by solving
<disp-formula id="eqn16"><alternatives><graphic xlink:href="201269_eqn16.gif"/></alternatives></disp-formula>
</p>
<p>This is an integral equation of the second kind, which generically admits firing rate solutions, <bold>r</bold>, even when <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> does not [<xref rid="c56" ref-type="bibr">56</xref>]. We again transition to the Fourier domain so <xref ref-type="disp-formula" rid="eqn16">Eq. (16)</xref> becomes
<disp-formula id="eqn17"><alternatives><graphic xlink:href="201269_eqn17.gif"/></alternatives></disp-formula>
</p>
<p>From <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref>, firing rates, <bold>r</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>), can be computed numerically through an inverse transform (the Fourier series over <bold>n</bold> and <italic>k</italic>), yielding an accurate approximation to firing rates from spiking network simulations even where classical balanced network theory fails (<xref ref-type="disp-formula" rid="eqn5">Fig. 5n,o</xref>).</p>
<p>The amplification and suppression caused by the smaller visual stimulus can be roughly explained by the balanced amplification mechanism discussed previously. Since <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline28.gif"/></alternatives></inline-formula> is a low-pass filter, it approximately cancels high frequency components of firing rate profiles. Hence, high frequency components are in the approximate nullspace of the local connectivity operator, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline29.gif"/></alternatives></inline-formula>, and are therefore amplified by the network through the same mechanism discussed for discrete networks previously.</p>
<p>A more precise explanation is given by first averaging firing rates over orientation preference by setting <italic>k</italic> &#x003D; 0 in <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref> to give <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline30.gif"/></alternatives></inline-formula> that depends only on spatial frequency, and similarly for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline31.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline32.gif"/></alternatives></inline-formula>. The convolution operator, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline33.gif"/></alternatives></inline-formula>, implements a low-pass filter, so <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline34.gif"/></alternatives></inline-formula> is &#x1D4AA;(1) in magnitude at low spatial frequencies and converges to zero at higher frequencies (large &#x007C;&#x007C;<bold>n</bold>&#x007C;&#x007C;). The regularized inverse, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline35.gif"/></alternatives></inline-formula>, is therefore &#x1D4AA;(1) in magnitude at low frequencies and &#x1D4AA;(1/<italic>&#x03F5;</italic>) at higher frequencies (<xref ref-type="fig" rid="fig6">Fig. 6a</xref>, purple). When external input, <bold>X</bold>(<italic>x</italic>), has sharp features, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline36.gif"/></alternatives></inline-formula> has power at higher spatial frequencies (<xref ref-type="fig" rid="fig6">Fig. 6a</xref>, green), which are amplified by the &#x1D4AA;(1/<italic>&#x03F5;</italic>) component of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline37.gif"/></alternatives></inline-formula> while low frequencies remain &#x1D4AA;(1). The result is that the magnitude of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline38.gif"/></alternatives></inline-formula> has a &#x1D4AA;(1/<italic>&#x03F5;</italic>) peak at a non-zero spatial frequency (<xref ref-type="fig" rid="fig6">Fig. 6a</xref>, black), introducing a high-amplitude, non-monotonic rate profile (as in <xref ref-type="fig" rid="fig5">Fig. 5n</xref>; see [<xref rid="c50" ref-type="bibr">50</xref>] for a similar analysis). When <bold>X</bold>(<bold>x</bold>) has spatially broad features, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline39.gif"/></alternatives></inline-formula> has little power at high spatial frequencies so that this amplification dynamic is weak or absent (as in <xref ref-type="fig" rid="fig5">Fig. 5h)</xref>. An identical argument applies in orientation space. In summary, high-frequency components of external input profiles are transmitted more strongly than low-frequency components in strongly coupled networks, and the cutoff frequency is determined by the width (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> or <italic>&#x03B1;</italic><sub><italic>I</italic></sub>) of lateral synaptic projections.</p>
<fig id="fig6" position="float" fig-type="figure"><label>Figure 6:</label>
<caption><title>Spatial filtering of external input and the dependence of suppression on outgoing synaptic projection width.</title>
<p><bold>a)</bold> The magnitude of the spatial filter, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline40.gif"/></alternatives></inline-formula>, imposed by recurrent connections (purple), the external input (<inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline41.gif"/></alternatives></inline-formula>, green) and the resulting firing rate profile (<inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline42.gif"/></alternatives></inline-formula>, black) as a function of the spatial frequency, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline43.gif"/></alternatives></inline-formula>, from the simulation in <xref ref-type="fig" rid="fig5">Fig. 5j-o</xref>. Magnitude is measured by the Frobenius norm for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline44.gif"/></alternatives></inline-formula>. Curves normalized by their peaks. <bold>b)</bold> Firing rates of excitatory (red) and inhibitory (blue) neurons with receptive fields at the center of a grating stimulus plotted as the width of the stimulus increases (represented by increasing <italic>&#x03C3;</italic><sub><italic>X</italic></sub>) using parameters from <xref ref-type="fig" rid="fig5">Fig. 5j-o</xref>. <bold>c)</bold> Same as b, but the excitatory rate is plotted for different widths of the excitatory synaptic projection width, <italic>&#x03B1;</italic><sub><italic>E</italic></sub>. <bold>d)</bold> Same as c, but firing rates in L4 are shaped like a disc with radius <italic>&#x03C3;</italic><sub><italic>X</italic></sub> instead of a Guassian with width parameter <italic>&#x03C3;</italic><sub><italic>X</italic></sub>.</p></caption>
<graphic xlink:href="201269_fig6.tif"/>
</fig>
<p>It is worth noting that the average firing rates (over all orientations and spatial positions) are given by the zero Fourier coefficient <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline45.gif"/></alternatives></inline-formula>. When balance is broken by sharp external input features, the zero Fourier mode is not affected as long as mean firing rates, <bold>r</bold>(<bold>x</bold>, <italic>&#x03B8;</italic>), remain non-zero at all locations and orientations. Hence, sharp input features can break balance locally without breaking global, network-averaged, balance. This is analogous to the global balance obtained in the optogenetic example when local balance was broken at the level of subpopulations (<xref ref-type="fig" rid="fig2">Fig. 2</xref>).</p>
</sec>
<sec id="s2c5"><label>2.3.5</label><title>Implications of imbalanced amplification on receptive field tuning</title>
<p>We next considered a study by Adesnik et al. [<xref rid="c1" ref-type="bibr">1</xref>] in which drifting grating stimuli of varying sizes were presented to mice while recording from neurons in L2/3 of V1. In that study, pyramidal neurons&#x2019; firing rates first increased then decreased as the stimulus size was increased. On the other hand, somatostatin-expressing (SOM) neuron&#x2019;s firing rates increased monotonically with stimulus size. Intracellular recordings combined with optogenetic stimulation in that study showed that SOM neurons project locally and pyramidal neurons form longer range projections.</p>
<p>To test our model against these findings, we applied <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref> to a network with local inhibition and longer-range excitation (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003E; <italic>&#x03B1;</italic><sub><italic>I</italic></sub>) with increasing size of a visual stimulus (increasing <italic>&#x03C3;</italic><sub><italic>X</italic></sub>). Our results are consistent with recordings in Adesnik <italic>et al.,</italic> 2012 [<xref rid="c1" ref-type="bibr">1</xref>]: Excitatory neuron firing rates changed non-monotonically with stimulus size, while inhibitory neuron firing rates monotonically increased (<xref ref-type="fig" rid="fig6">Fig. 6b</xref>). The non-monotonic dependence of excitatory firing rates on stimulus size in <xref ref-type="fig" rid="fig6">Fig. 6b</xref> is explained by the mechanism of imbalanced amplification. When <italic>&#x03C3;</italic><sub><italic>X</italic></sub> is sufficiently small, balance is broken so imbalanced amplification introduces a large peak firing rate surrounded by suppression (as in <xref ref-type="fig" rid="fig5">Fig. 5n</xref>). However, the total amount of external excitation introduced by the stimulus is proportional to the size of the stimulus, so a very small <italic>&#x03C3;</italic><sub><italic>X</italic></sub> introduces very little excitation and peak firing rates are small. As <italic>&#x03C3;</italic><sub><italic>X</italic></sub> increases, more excitation is recruited and the network is still imbalanced, which leads to increasingly large peak firing rates (as in <xref ref-type="fig" rid="fig5">Fig. 5n</xref>). Once <italic>&#x03C3;</italic><sub><italic>X</italic></sub> becomes large, balance begins to be restored and the peak excitatory firing rate decreases to moderate values (as in <xref ref-type="fig" rid="fig5">Fig. 5h</xref>).</p>
<p>The degree to which excitatory neurons suppress depends on the spatial width, <italic>&#x03B1;</italic><sub><italic>E</italic></sub>, of lateral excitatory projections (<xref ref-type="fig" rid="fig6">Fig. 6c</xref>) and suppression of inhibitory neurons similarly depends on the spatial width, <italic>&#x03B1;</italic><sub><italic>I</italic></sub>, of lateral inhibition (not pictured). Specifically, suppression occurs when lateral connectivity is broader than feedforward input (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003E; <italic>&#x03B2;</italic><sub><italic>X</italic></sub> or <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003E; <italic>&#x03B2;</italic><sub><italic>X</italic></sub>) because this is when the balanced solution in <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref> disappears. When a sub-population&#x2019;s lateral connectivity is more localized than feedforward connectivity from L4 (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003C; <italic>&#x03B1;</italic><sub><italic>X</italic></sub> as in the lightest gray curve in <xref ref-type="fig" rid="fig6">Fig. 6c</xref>; or <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003C; <italic>&#x03B1;</italic><sub><italic>X</italic></sub>), that sub-population cannot exhibit suppression since feedforward input width <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline46.gif"/></alternatives></inline-formula> is always larger than lateral connectivity, regardless of the stimulus size (<italic>&#x03C3;</italic><sup><italic>X</italic></sup>).</p>
<p>A similar line of reasoning explains why peak inhibitory neuron firing rates increase mono-tonically with stimulus size in <xref ref-type="fig" rid="fig6">Fig. 6b</xref>. Inhibitory neurons in that example project locally (<italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003D; <italic>&#x03B1;</italic><sub><italic>X</italic></sub>), so the inequality <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003C; <italic>&#x03B2;</italic><sub><italic>X</italic></sub> is always satisfied because <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline47.gif"/></alternatives></inline-formula> whenever <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x2264; <italic>&#x03B1;</italic><sub><italic>X</italic></sub>. Whenever <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003C; <italic>&#x03B2;</italic><sub><italic>x</italic></sub>, inhibitory firing rates reflect their balanced state values which increase monotonically with the increase in total excitation induced by a larger stimulus.</p>
<p>Unlike SOM neurons, parvalbumin-expressing (PV) neurons were found to exhibit suppression by Adesnik <italic>et al.,</italic> 2012 [<xref rid="c1" ref-type="bibr">1</xref>]. Hence, our theory predicts that PV neurons project more broadly in space than SOM neurons. Indeed, PV interneurons in L2/3 are primarily basket cells whose axons project to larger lateral distances than other inhibitory neuron subtypes such as Martinotti cells that comprise most SOM neurons [<xref rid="c24" ref-type="bibr">24</xref>].</p>
<p>We observed a unimodal dependence of firing rate on stimulus size (<xref ref-type="fig" rid="fig6">Fig. 6c</xref>, all curves have a single peak). However, Rubin, <italic>et al.</italic> [<xref rid="c50" ref-type="bibr">50</xref>] observed a multi-modal, oscillatory dependence of firing rate on stimulus size in recordings and in a computational model. In that study, the drifting grating stimuli were disc-shaped with a sharp cutoff of contrast at the edges of the disc. Above, we considered a Gaussian-shaped contrast profile with soft edges (<xref ref-type="fig" rid="fig6">Fig. 6c</xref>, inset). Repeating our calculations with a sharp-edged, disc-shaped stimulus (<xref ref-type="fig" rid="fig6">Fig. 6d</xref>, inset) produced an oscillatory dependence of firing rate on stimulus size (<xref ref-type="fig" rid="fig6">Fig. 6d</xref>), as observed by Rubin <italic>et al.&#x2024;</italic> This oscillation only arose when lateral synaptic projections were narrower than the stimulus size (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> small). The oscillation results from a Gibbs phenomenon: The sharp edge in the stimulus produces high-frequency power in <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline48.gif"/></alternatives></inline-formula>, which passes through the high-pass filter <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline49.gif"/></alternatives></inline-formula> when <italic>&#x03B1;</italic><sub><italic>E</italic></sub> is small.</p>
<p>We next explored the functional consequences of these results on receptive field tuning. We first considered a disc-shaped grating stimulus (<xref ref-type="fig" rid="fig7">Fig. 7a</xref>), producing a disc-shaped firing rate profile in L4 (<xref ref-type="fig" rid="fig7">Fig. 7b</xref>). Synaptic divergence causes the profile of synaptic input from L4 to L2/3 to be &#x201C;blurred&#x201D; at the edges (<xref ref-type="fig" rid="fig7">Fig. 7c</xref>), as quantified by the low-pass filter, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline50.gif"/></alternatives></inline-formula>. This illustrates a fundamental problem in receptive field tuning: Synaptic divergence from one layer to another implements a low-pass filter that blurs sharp features. This problem is resolved by our observation above that lateral, recurrent connectivity implements a high-pass filter. If the width of lateral, excitatory connections in L2/3 is similar to that of feedforward connections from L4, the high-pass filter implemented by the recurrent network cancels the low-pass filter implemented by feedforward connectivity, effectively implementing a deconvolution that can recover the sharpness of firing rate profiles in L4 (<xref ref-type="fig" rid="fig7">Fig. 7d-f</xref>). Hence, counterintuitively, <italic>broader</italic> lateral excitation actually <italic>sharpens</italic> receptive field tuning. Broadening lateral connections further increases the sharpness of the firing rate profiles, but introduce oscillatory, Gibbs phenomena near sharp features (<xref ref-type="fig" rid="fig7">Fig. 7f</xref>). These points are illustrated more clearly in an example with an asymmetrically shaped stimulus (<xref ref-type="fig" rid="fig7">Fig. 7g-l</xref>). Hence, the high-pass filter described above corrects the blurring caused by synaptic divergence between layers in V1.</p>
<fig id="fig7" position="float" fig-type="figure"><label>Figure 7:</label>
<caption><title>Imbalanced amplification and suppression reverse the blurring introduced by inter-laminar synaptic divergence.</title>
<p><bold>a)</bold> A disc-shaped grating stimulus gives rise to <bold>b)</bold> a disc-shaped firing rate profile, <italic>r</italic><sub><italic>X</italic></sub>(<bold>x</bold>), in L4 with slightly blurred edges (achieved by convolving contrast from a with a Gaussian kernel). <bold>c)</bold> Input, <italic>X</italic><sub><italic>E</italic></sub>(<italic>X</italic>), from L4 to excitatory neurons in L2/3 is blurred by synaptic divergence, which effectively applies a low-pass filter, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline51.gif"/></alternatives></inline-formula>, to the L4 rates. <bold>c)</bold> Excitatory firing rates in L2/3 are sharper than external input when lateral excitation is similar, but smaller, in width than interlaminar excitation (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003D; 0.85<italic>&#x03B1;</italic><sub><italic>X</italic></sub>). bf d) Same as c, but lateral excitation is exactly as broad as interlaminar excitation (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003D; <italic>&#x03B1;</italic><sub><italic>X</italic></sub>), which sharpens the edges further, making firing rates in L2/3 similar to those in L4. <bold>d)</bold> Same as c, but lateral excitation is broader than interlaminar excitation (<italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003D; 1.1<italic>&#x03B1;</italic><sub><italic>X</italic></sub>), which sharpens the edges even further, but also introduced suppressed regions due to Gibbs phenomena. <bold>g-l)</bold> Same as a-f, but contrast was determined by the brightness of a photograph. Horizontal and vertical axes are neurons&#x2019; receptive fields.</p></caption>
<graphic xlink:href="201269_fig7.tif"/>
</fig>
<p>In summary, imbalanced amplification and linear rate models provide a concise and parsimonious theoretical basis for understanding how suppression, amplification and tuning depends on the profile of neuron&#x2019;s incoming and outgoing synaptic projections in physical and orientation tuning space.</p>
</sec>
</sec>
</sec>
<sec id="s3"><label>3</label><title>Discussion</title>
<p>We described a theory of imbalanced amplification in cortical circuits arising from a local imbalance that occurs when recurrent connectivity structure cannot cancel feedforward input. We showed that imbalanced amplification is evoked by optogenetic stimuli in somatosensory cortex and sensory stimuli in visual cortex, since these stimuli cannot be canceled by the connectivity structure in those areas. Our theoretical analysis of imbalanced amplification explains several observations from cortical recordings in those areas.</p>
<p>Even though firing rates in balanced networks in the large <italic>N</italic> limit do not depend on neurons&#x2019; f-I curves (see <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>), quantifying firing rates under imbalanced amplification relies on a finite size correction that requires an assumption on how firing rates depend on neurons&#x2019; input. For simplicity, we used an approximation that assumes populations&#x2019; mean firing rates depend linearly on their average input currents, giving rise to <xref ref-type="disp-formula" rid="eqn4">Eqs. (4)</xref> and (<xref ref-type="disp-formula" rid="eqn17">17</xref>). In reality, neurons&#x2019; firing rates depend nonlinearly on their mean input currents, and also depend on higher moments of their input currents. However, the salient effects of imbalanced amplification are not sensitive to our assumption of linearity. For instance, <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>, which quantifies the strong synaptic currents evoked under imbalanced amplification, does not depend on any assumption about neurons&#x2019; f-I curves. The precise value of the firing rates elicited by this strong input does depend on neurons&#x2019; f-I curves, however. We found that the linear approximation to f-I curves in <xref ref-type="disp-formula" rid="eqn4">Eqs. (4)</xref> and (<xref ref-type="disp-formula" rid="eqn17">17</xref>) performed well at approximating firing rates in our spiking network simulations and also explained several observations from cortical recordings. This may be partly explained due to the fact that our spiking network simulations used neuron models that exhibit spike frequency adaptation, which is known to linearize f-I curves [<xref rid="c18" ref-type="bibr">18</xref>, <xref rid="c29" ref-type="bibr">29</xref>] and help networks maintain balance [<xref rid="c30" ref-type="bibr">30</xref>]. However, the linear approximation we used cannot explain some phenomena that rely on thresholding and other nonlinear transfer properties [<xref rid="c50" ref-type="bibr">50</xref>, <xref rid="c38" ref-type="bibr">38</xref>]. The notion of imbalanced amplification extends naturally to models with nonlinear transfer functions and future work will consider the implications of nonlinearities.</p>
<p>Balanced networks are related to, but distinct from, inhibitory stabilized networks (ISNs) [<xref rid="c41" ref-type="bibr">41</xref>, <xref rid="c50" ref-type="bibr">50</xref>, <xref rid="c36" ref-type="bibr">36</xref>] and stabilized supralinear networks that can transition between ISN and non-ISN regimes [<xref rid="c50" ref-type="bibr">50</xref>]. The primary distinction is that ISNs are defined by moderately strong recurrent excitation (strong <italic>E</italic> &#x2192; <italic>E</italic>) whereas balanced networks are defined by very strong external, feedforward excitation (strong <italic>X</italic> &#x2192; <italic>E</italic>) canceled by similarly strong net-inhibitory recurrent connectivity. Classical balanced networks are necessarily inhibitory stabilized at sufficiently large <italic>N</italic> (small <italic>&#x03F5;</italic>) unless <italic>w</italic><sub><italic>EE</italic></sub> &#x003D; 0. However, strongly coupled (approximately balanced) networks can be non-ISN at moderately large <italic>N</italic> (small <italic>&#x03F5;</italic>) if W<sub><italic>EE</italic></sub> is small. Cat V1 is believed to be inhibitory stabilized, which can be used to explain its surround suppression dynamic [<xref rid="c41" ref-type="bibr">41</xref>]. However, evidence from optogenetic and electrophysiological studies, suggests that mouse L2/3 V1 might not be inhibitory stabilized: Lateral connection probability is small between pyramidal neurons (small <italic>w</italic><sub><italic>EE</italic></sub>) [<xref rid="c24" ref-type="bibr">24</xref>], stimulation of PV neurons does not produce the paradoxical effects that characterize ISNs [<xref rid="c4" ref-type="bibr">4</xref>], and modulating pyramidal neuron firing rates only weakly modulates excitatory synaptic currents in local pyramidal neurons [<xref rid="c4" ref-type="bibr">4</xref>, <xref rid="c1" ref-type="bibr">1</xref>]. Nonetheless, pyramidal neurons and PV neurons in mouse V1 exhibit surround suppression [<xref rid="c1" ref-type="bibr">1</xref>], which we showed is explained by imbalanced amplification.</p>
<p>Despite the similarity in their names, the mechanism of imbalanced amplification studied here is fundamentally different from the mechanism of balanced amplification [<xref rid="c39" ref-type="bibr">39</xref>]. First, imbalanced amplification is related to steady-state firing rates, while balanced amplification is a dynamical phenomenon. Moreover, balanced amplification is intrinsic to the local, recurrent circuit: It produces large firing rate transients when local, recurrent inhibition is inefficient at canceling local, recurrent excitation. Imbalanced amplification, on the other hand, produces large steady state firing rates when local, recurrent input is unable to effectively cancel feedforward, external excitation.</p>
<p>The analysis of our spatially extended network model relied on an assumption of periodic boundaries in space, which are not biologically realistic, but approximate networks with more realistic boundary conditions [<xref rid="c48" ref-type="bibr">48</xref>]. Without periodic boundary conditions, the integral equations, <xref ref-type="disp-formula" rid="eqn10">(10)</xref>, <xref ref-type="disp-formula" rid="eqn11">(11)</xref>, and <xref ref-type="disp-formula" rid="eqn16">(16)</xref> are equally valid, but the integrals are defined by regular convolutions in space instead of circular convolutions. As a result, the spatial Fourier modes do not de-couple, so <xref ref-type="disp-formula" rid="eqn12">Eqs. (12)</xref>, (<xref ref-type="disp-formula" rid="eqn13">13</xref>), and (<xref ref-type="disp-formula" rid="eqn17">17</xref>) are no longer valid, though they should still offer a good approximation when connectivity is much narrower than the the spatial domain [<xref rid="c48" ref-type="bibr">48</xref>]. In addition, anisotropic connectivity statistics, arising for example from tuning dependent connectivity in visual cortical circuits with coherent orientation maps [<xref rid="c6" ref-type="bibr">6</xref>], would prevent the integral operator in <xref ref-type="disp-formula" rid="eqn10">Eqs. (10)</xref>, <xref ref-type="disp-formula" rid="eqn11">(11)</xref>, and <xref ref-type="disp-formula" rid="eqn16">(16)</xref> from being a convolution operator, and therefore preclude the use of Fourier series for the solution. Future work will consider the effects of non-periodic boundaries and non-convolutional connectivity kernels on spatially extended balanced networks.</p>
<p>We focused on firing rates, but sensory coding also depends on variability and correlations in neurons&#x2019; spike trains. Our previous work derived the structure of correlated variability in heterogeneous and spatially extended balanced networks when connectivity structure prevents positive and negative correlations from cancelling, effectively providing an analogous theory of imbalanced amplification of correlated variability [<xref rid="c49" ref-type="bibr">49</xref>]. Combining those findings with the theory of steady-state firing rates presented here could yield a more complete theory of neural coding in cortical circuits and the effects of imbalanced amplification on coding.</p>
</sec>
</body><back><ack><title>Acknowledgments</title>
<p>This work was supported by National Science Foundation grants DMS-1517828, DMS-1654268, and DBI-1707400. We thank Ashok Litwin-Kumar for helpful comments on a draft of the manuscript.</p>
</ack>
<sec id="s4"><title>Methods</title>
<p>We modeled recurrently connected networks with <italic>N</italic> neurons, composed of <italic>N</italic><sub><italic>E</italic></sub> &#x003D; 0.8<italic>N</italic> excitatory and <italic>N</italic><sub><italic>I</italic></sub> &#x003D; 0.2<italic>N</italic> inhibitory neurons. The recurrent network receives external input from a network of <italic>N</italic><sub><italic>X</italic></sub> neurons that drive the recurrent network. The membrane potential of neuron j from the excitatory (<italic>a</italic> &#x003D; <italic>E</italic>) or inhibitory (<italic>a</italic> &#x003D; <italic>I</italic>) population has Adaptive Exponential integrate-and-fire dynamics,
<disp-formula id="ueqn26"><alternatives><graphic xlink:href="201269_ueqn26.gif"/></alternatives></disp-formula>
</p>
<p>Whenever <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline52.gif"/></alternatives></inline-formula>, a spike is recorded, the membrane potential is held for a refractory period <italic>&#x03C4;</italic><sub>ref</sub> then reset to a fixed value <italic>V</italic><sub>re</sub>, and <italic>w</italic> is incremented by <italic>B</italic>. Neuron model parameters for all simulations were <italic>&#x03C4;</italic><sub><italic>m</italic></sub> &#x003D; <italic>C</italic><sub><italic>m</italic></sub>/<italic>g</italic><sub><italic>L</italic></sub> &#x003D; 15ms, <italic>E</italic><sub><italic>L</italic></sub> &#x003D; &#x2014;72mV, <italic>V</italic><sub><italic>T</italic></sub> &#x003D; &#x2014;60mV, <italic>V</italic><sub>th</sub> &#x003D; &#x2212; 15mV, &#x0394;<sub><italic>T</italic></sub> &#x003D; 1.5mV, <italic>V</italic><sub>re</sub> &#x003D; &#x2212;72mV, <italic>&#x03C4;</italic><sub>ref</sub> &#x003D; 1ms, <italic>&#x03C4;</italic><sub><italic>w</italic></sub> &#x003D; 150ms and <italic>B</italic>/<italic>C</italic><sub><italic>m</italic></sub> &#x003D; 0.267mV/ms. Membrane potentials were also bounded below by <italic>V</italic><sub><italic>lb</italic></sub> &#x003D; &#x2212;100mV. Synaptic input currents were defined by
<disp-formula id="eqn18"><alternatives><graphic xlink:href="201269_eqn18.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline53.gif"/></alternatives></inline-formula> is the feedforward input and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline54.gif"/></alternatives></inline-formula> the recurrent input to neuron <italic>j</italic> in population <italic>a</italic> &#x003D; <italic>E</italic>, <italic>I</italic>. The recurrent input was defined by
<disp-formula id="ueqn27"><alternatives><graphic xlink:href="201269_ueqn27.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline55.gif"/></alternatives></inline-formula> is the nth spike time of neuron k in population <italic>b</italic> &#x003D; <italic>E, I</italic>. The external input to the recurrent network is defined similarly by
<disp-formula id="eqn19"><alternatives><graphic xlink:href="201269_eqn19.gif"/></alternatives></disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline56.gif"/></alternatives></inline-formula> is the nth spike time of neuron <italic>k</italic> &#x003D; 1,&#x2026;, <italic>N</italic><sub><italic>X</italic></sub> in population <italic>X</italic>. Each coefficient, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline57.gif"/></alternatives></inline-formula>, represents the synaptic weight from presynaptic neuron <italic>k</italic> in population <italic>b</italic> to postsynaptic neuron <italic>j</italic> in population <italic>a</italic>. For all simulations, we modeled synaptic kinetics using <italic>&#x03B7;</italic><sub><italic>b</italic></sub>(<italic>t</italic>) &#x003D; exp(&#x2212;t/<italic>&#x03C4;</italic><sub><italic>b</italic></sub>)/<italic>&#x03C4;</italic><sub><italic>b</italic></sub> for <italic>t</italic> &#x003E; 0 where <italic>&#x03C4;</italic><sub><italic>E</italic></sub> &#x003D; 8ms, <italic>&#x03C4;</italic><sub><italic>I</italic></sub> &#x003D; 4ms, and <italic>&#x03C4;</italic><sub><italic>X</italic></sub> &#x003D; 10ms. Note that the integral of <italic>&#x03B7;</italic><sub><italic>b</italic></sub>(<italic>t</italic>) over time is equal to 1 for all three kernels, so the choice of time constant, <italic>&#x03C4;</italic><sub><italic>b</italic></sub>, does not effect time-averaged synaptic currents. We used <italic>&#x03C4;</italic><sub><italic>I</italic></sub> &#x003C; <italic>&#x03C4;</italic><sub><italic>E</italic></sub> &#x003C; <italic>&#x03C4;</italic><sub><italic>X</italic></sub> to prevent excessive synchronous events that break the balanced state. While inhibition may be faster than excitation in many cortical circuits, excitatory neurons are more likely to contact distal dendrites and inhibitory neurons are more likely to contact the soma [<xref rid="c27" ref-type="bibr">27</xref>, <xref rid="c22" ref-type="bibr">22</xref>], which could make inhibition functionally faster than excitation. In any case, using fast inhibition is common practice in spiking network simulations with strong or dense connectivity [<xref rid="c47" ref-type="bibr">47</xref>, <xref rid="c35" ref-type="bibr">35</xref>, <xref rid="c50" ref-type="bibr">50</xref>, <xref rid="c49" ref-type="bibr">49</xref>, <xref rid="c54" ref-type="bibr">54</xref>] and a complete resolution of this issue is outside the scope of this study.</p>
<p>In <xref ref-type="fig" rid="fig1">Figs. 1</xref>, 2 and 3 an extra term, <italic>S</italic> &#x003D; 2 mV/ms, was added to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline58.gif"/></alternatives></inline-formula> for stimulated neurons during the second half of the simulation to model optogenetic stimulation. We used <italic>N</italic><sub><italic>E</italic></sub> &#x003D; 4000, <italic>N</italic><sub><italic>I</italic></sub> &#x003D; 1000 and <italic>N</italic><sub><italic>X</italic></sub> &#x003D; 4000 (so <italic>N</italic> &#x003D; 5000) except for <xref ref-type="fig" rid="fig1">Fig. 1f</xref> where all <italic>N</italic><sub><italic>b</italic></sub> values were scaled. Connections were drawn randomly with connection probabilities <italic>p</italic><sub><italic>EE</italic></sub> &#x003D; <italic>p</italic><sub><italic>IE</italic></sub> &#x003D; <italic>p</italic><sub><italic>IX</italic></sub> &#x003D; 0.1, <italic>p</italic><sub><italic>EI</italic></sub> &#x003D; <italic>p</italic><sub><italic>II</italic></sub> &#x003D; <italic>p</italic><sub><italic>EX</italic></sub> &#x003D; 0.2. Since outgoing connections were sampled with replacement, some neurons connected multiple times to other neurons. Synaptic weights were then defined by
<disp-formula id="ueqn28"><alternatives><graphic xlink:href="201269_ueqn28.gif"/></alternatives></disp-formula>
where <italic>J</italic><sub><italic>EE</italic></sub> &#x003D; 0.4mV, <italic>J</italic><sub><italic>IE</italic></sub> = 0.83 mV, <italic>J</italic><sub><italic>II</italic></sub> = <italic>J</italic><sub><italic>EI</italic></sub> &#x003D; &#x2212;1.67 mV, <italic>J</italic><sub><italic>EX</italic></sub> &#x003D; <italic>J</italic><sub><italic>IX</italic></sub> &#x003D; 0.47 mV. This gives postsynaptic potential amplitudes between 0.19 and 1.0 mV. For <xref ref-type="fig" rid="fig1">Figs. 1f</xref> and <xref ref-type="fig" rid="fig4">4</xref>, the values of <italic>J</italic><sub><italic>ab</italic></sub> and the values of <italic>p</italic><sub><italic>ab</italic></sub> were each multiplied by (5000/N)<sup>1/4</sup> so that they were unchanged at <italic>N</italic> &#x003D; 5000 and so that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline59.gif"/></alternatives></inline-formula>. This is slightly different from the more common practice of fixing small connection probabilities and scaling <italic>J</italic><sub><italic>ab</italic></sub> like <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline60.gif"/></alternatives></inline-formula>. We instead fixed a relatively dense connectivity at <italic>N</italic> &#x003D; 5000 and the network became increasingly sparse and weakly connected at increased <italic>N</italic>. Both approaches have the same mean-field (since the mean-field only depends on the product of <italic>p</italic><sub><italic>ab</italic></sub> and <italic>J</italic><sub><italic>ab</italic></sub>), but our approach prevents excessively small synaptic weights at large <italic>N</italic> and prevents dense connectivity at large <italic>N</italic>, which is computationally expensive and susceptible to oscillatory and synchronous spiking.</p>
<p>Spike times in the external population were modeled as independent Poisson processes with <bold>r</bold><sub><italic>X</italic></sub> &#x003D;5 Hz. In <xref ref-type="fig" rid="fig3">Fig. 3</xref>, external input to the L5 population was created using the spike times of excitatory neurons from the simulations in <xref ref-type="fig" rid="fig2">Fig. 2</xref>. Simulations for <xref ref-type="fig" rid="fig4">Fig. 4</xref> were identical to those in <xref ref-type="fig" rid="fig2">Figs. 2</xref> and <xref ref-type="fig" rid="fig3">3</xref> except there were <italic>N</italic> &#x003D; 2 &#x00D7; 10<sup>4</sup> neurons in the L2/3 model, synaptic weights to neurons in that population were multiplied by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline61.gif"/></alternatives></inline-formula>, and connections probabilities were also multiplied by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline62.gif"/></alternatives></inline-formula>. Hence, in relation to <xref ref-type="fig" rid="fig2">Fig. 2</xref>, <italic>N</italic> was increased by a factor of four and <italic>&#x03F5;</italic> was halved.</p>
<p>Simulations for <xref ref-type="fig" rid="fig5">Figure 5</xref> used algorithms adapted from previous work [<xref rid="c49" ref-type="bibr">49</xref>]. The recurrent network (L2/3) contained <italic>N</italic> &#x003D; 2 &#x00D7; 10<sup>5</sup> AdEx model neurons, <italic>N</italic><sub><italic>E</italic></sub> &#x003D; 1.6 &#x00D7; 10<sup>5</sup> of which were excitatory and <italic>N</italic><sub><italic>I</italic></sub> &#x003D; 4 &#x00D7; 10<sup>4</sup> inhibitory. Excitatory and inhibitory neurons in L2/3 were arranged on a uniform grid covering the unit square [0,1] &#x00D7; [0,1] (arbitrary spatial units). The external population (L4) contained <italic>N</italic><sub><italic>X</italic></sub> &#x003D; 1.6 &#x00D7; 10<sup>5</sup> neurons arranged on an identical, parallel square. Each neuron in each population was assigned a preferred orientation chosen randomly and uniformly from 0 to 180&#x00B0;. Connections were chosen randomly as above, but connection probabilities depended on the neurons&#x2019; distances in physical and orientation tuning space. Specifically, the connection probability from a neuron in population <italic>b</italic> &#x003D; <italic>E,I,X</italic> at coordinates <bold>x</bold> &#x003D; (<italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>) to a neuron in population <italic>a</italic> &#x003D; <italic>E,I</italic> at coordinates <bold>y</bold> &#x003D; (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>) was
<disp-formula id="ueqn29"><alternatives><graphic xlink:href="201269_ueqn29.gif"/></alternatives></disp-formula>
where <italic>d&#x03B8;</italic> is the difference between neurons&#x2019; preferred orientation,
<disp-formula id="ueqn30"><alternatives><graphic xlink:href="201269_ueqn30.gif"/></alternatives></disp-formula>
is a one-dimensional wrapped Gaussian and <italic>G</italic>(<bold>u</bold>; <italic>&#x03B1;</italic>) &#x003D; <italic>g</italic>(<italic>u</italic><sub>1</sub>; <italic>&#x03B1;</italic>)<italic>g</italic>(<italic>u</italic><sub>2</sub>; <italic>&#x03B1;</italic>) is a two dimensional wrapped Gaussian. The connection probability averaged over all distances is <italic>&#x03B2;</italic><sub><italic>ab</italic></sub>, which were chosen to be the same as in previous figures, <italic>p</italic>&#x0305;<sub><italic>EE</italic></sub> &#x003D; <italic>p</italic>&#x0305;<sub><italic>IE</italic></sub> &#x003D; <italic>p</italic>&#x0305;<sub><italic>IX</italic></sub> &#x003D;0.1 and <italic>p</italic>&#x0305;<sub><italic>EI</italic></sub> &#x003D; <italic>p</italic>&#x0305;<sub><italic>II</italic></sub> &#x003D; <italic>p</italic>&#x0305;<sub><italic>EX</italic></sub> &#x003D; 0.2. As above, outgoing connections were chosen with replacement, so some neurons made multiple contacts onto other neurons. Connection widths in physical space were <italic>&#x03B1;</italic><sub><italic>E</italic></sub> &#x003D; 0.15 and <italic>&#x03B1;</italic><sub><italic>I</italic></sub> &#x003D; <italic>&#x03B1;</italic><sub><italic>X</italic></sub> &#x003D; 0.04 (as measured on the unit square). Connection widths in orientation space were <italic>&#x03B1;</italic><sub><italic>E,&#x03B8;</italic></sub> &#x003D; <italic>&#x03B1;</italic><sub><italic>E,&#x03B8;</italic></sub> &#x003D; 0.1 and <italic>&#x03B1;</italic><sub><italic>X,&#x03B8;</italic></sub> &#x003D; 0.125 (corresponding to widths of 18&#x00B0; and 22.5&#x00B0; when measured in degrees). Connection strengths, <italic>J</italic><sub><italic>ab</italic></sub>, were the same as in <xref ref-type="fig" rid="fig1">Figs. 1</xref>, 2 and 3 except multiplied by a factor of 1.2. Each neuron in L4 was modeled as a Poisson process with rate given by
<disp-formula id="ueqn31"><alternatives><graphic xlink:href="201269_ueqn31.gif"/></alternatives></disp-formula>
where <bold>x</bold> is the location of the neuron, <italic>&#x03B8;</italic> is its preferred orientation,
<disp-formula id="ueqn32"><alternatives><graphic xlink:href="201269_ueqn32.gif"/></alternatives></disp-formula>
and
<disp-formula id="ueqn33"><alternatives><graphic xlink:href="201269_ueqn33.gif"/></alternatives></disp-formula>
</p>
<p>This models a stimulus with orientation <italic>&#x03B8;</italic><sub>0</sub> &#x003D; 0.5 (representing 90&#x00B0;) and centered at spatial coordinates <bold>x</bold><sub>0</sub> &#x003D; (0.5, 0.5). The parameters <italic>&#x03C3;</italic><sub><italic>X</italic></sub> and <italic>&#x03B1;</italic><sub><italic>X,&#x03B8;</italic></sub> quantify the width of L4 firing rates in physical and orientation space. For all panels in <xref ref-type="fig" rid="fig5">Fig. 5</xref>, we used <italic>&#x03B1;</italic><sub><italic>X,&#x03B8;</italic></sub> &#x003D; 0.1 (width 18&#x00B0;) and <italic>c</italic><sub><italic>&#x03B8;</italic></sub> &#x003D; 0.75. We used <italic>&#x03C3;</italic><sub><italic>X</italic></sub> &#x003D; 0.2 for <xref ref-type="fig" rid="fig5">Fig. 5d-i</xref> and <italic>&#x03C3;</italic><sub><italic>X</italic></sub> &#x003D; 0.06 for <xref ref-type="fig" rid="fig5">Fig. 5j-o</xref>. In both cases, we chose <italic>c</italic> so that the minimum and maximum of <italic>r</italic><sub><italic>X,x</italic></sub>(<bold>x</bold>) were 10 and 20 Hz respectively.</p>
<p>For the spatially extended network, the connectivity kernels, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline63.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline64.gif"/></alternatives></inline-formula>, are defined in Results where <italic>w</italic><sub><italic>ab</italic></sub>(<bold>x</bold>,<italic>&#x03B8;</italic>) &#x003D; <italic>J</italic><sub><italic>ab</italic></sub><italic>N</italic><sub><italic>b</italic></sub><italic>p</italic><sub><italic>ab</italic></sub>(<bold>x</bold>,<italic>&#x03B8;</italic>)/(<italic>J</italic><sub><italic>EX</italic></sub><italic>p</italic><sub><italic>EX</italic></sub><italic>N</italic><sub><italic>X</italic></sub>). The Fourier series in physical and orientation tuning space is defined by
<disp-formula id="ueqn34"><alternatives><graphic xlink:href="201269_ueqn34.gif"/></alternatives></disp-formula>
where the triple integral is over the two dimensions of physical space and one dimensional orientation space. The Fourier series of the convolution kernels defined above turns convolution into multiplication in the Fourier domain, from which <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> gives <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline65.gif"/></alternatives></inline-formula> where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline66.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline67.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline68.gif"/></alternatives></inline-formula> are defined in Results with with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline69.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline70.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline71.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="201269_inline72.gif"/></alternatives></inline-formula>. Using the linear approximation, <bold>r</bold> &#x003D; <italic>g</italic><bold>I</bold> then gives <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref>. Firing rates for dashed curves in <xref ref-type="fig" rid="fig5">Fig. 5</xref> and all firing rates in <xref ref-type="fig" rid="fig6">Figs. 6</xref> and <xref ref-type="fig" rid="fig7">7</xref> were obtained by first computing <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref>, then inverting the Fourier transform numerically using an inverse fast Fourier transform. Solid curves in <xref ref-type="fig" rid="fig5">Fig. 5</xref> were computed similarly, except using <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> in place of <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref>.</p>
<p>All simulations and numerical computations were performed on a MacBook Pro running OS X 10.9.5 with a 2.3 GHz Intel Core i7 processor. All simulations were written in a combination of C and Matlab (Matlab R 2015b, MathWorks). The differential equations defining the neuron model were solved using a forward Euler method with time step 0.1 ms.</p>
</sec>
<ref-list><title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Adesnik</surname></string-name>, <string-name><given-names>W</given-names> <surname>Bruns</surname></string-name>, <string-name><given-names>H</given-names> <surname>Taniguchi</surname></string-name>, <string-name><given-names>Z J</given-names> <surname>Huang</surname></string-name>, and <string-name><given-names>M</given-names> <surname>Scanziani</surname></string-name>. <article-title>A neural circuit for spatial summation in visual cortex</article-title>. <source>Nature</source>, <volume>490</volume>(<issue>7419</issue>):<fpage>226</fpage>&#x2013;<lpage>31</lpage>, <month>oct</month> <year>2012</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Adesnik</surname></string-name> and <string-name><given-names>M</given-names> <surname>Scanziani</surname></string-name>. <article-title>Lateral competition for cortical space by layer-specific horizontal circuits</article-title>. <source>Nature</source>, <volume>464</volume>(<issue>7292</issue>):<fpage>1155</fpage>&#x2013;<lpage>60</lpage>, <month>apr</month> <year>2010</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><given-names>DJ</given-names> <surname>Amit</surname></string-name> and <string-name><given-names>N</given-names> <surname>Brunel</surname></string-name>. <article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex</article-title>. <source>Cereb Cortex</source>, <volume>7</volume>(<issue>3</issue>):<fpage>237</fpage>&#x2013;<lpage>252</lpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><given-names>BV</given-names> <surname>Atallah</surname></string-name>, <string-name><given-names>W</given-names> <surname>Bruns</surname></string-name>, <string-name><given-names>M</given-names> <surname>Carandini</surname></string-name>, and <string-name><given-names>M</given-names> <surname>Scanziani</surname></string-name>. <article-title>Parvalbumin-Expressing Interneurons Linearly Transform Cortical Responses to Visual Stimuli</article-title>. <source>Neuron</source>, <volume>73</volume>(<issue>1</issue>):<fpage>159</fpage>&#x2013;<lpage>170</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Ben-Yishai</surname></string-name>, <string-name><given-names>R L</given-names> <surname>Bar-Or</surname></string-name>, and <string-name><given-names>H</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Theory of orientation tuning in visual cortex</article-title>. <source>Proc Natl Acad Sci USA</source>, <volume>92</volume>(<issue>9</issue>):<fpage>3844</fpage>&#x2013;<lpage>3848</lpage>, <year>1995</year>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>W H</given-names> <surname>Bosking</surname></string-name>, <string-name><given-names>Y</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>B</given-names> <surname>Schofield</surname></string-name>, and <string-name><given-names>D</given-names> <surname>Fitzpatrick</surname></string-name>. <article-title>Orientation selectivity and the arrangement of horizontal connections in tree shrew striate cortex</article-title>. <source>J Neurosci</source>, <volume>17</volume>(<issue>6</issue>):<fpage>211227</fpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><given-names>E S</given-names> <surname>Boyden</surname></string-name>, <string-name><given-names>F</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>E</given-names> <surname>Bamberg</surname></string-name>, <string-name><given-names>G</given-names> <surname>Nagel</surname></string-name>, and <string-name><given-names>K</given-names> <surname>Deisseroth</surname></string-name>. <article-title>Millisecond-timescale, genetically targeted optical control of neural activity</article-title>. <source>Nature Neurosci</source>, <volume>8</volume>(<issue>9</issue>):<fpage>1263</fpage>&#x2013;<lpage>1268</lpage>, <year>2005</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Brette</surname></string-name> and <string-name><given-names>W</given-names> <surname>Gerstner</surname></string-name>. <article-title>Adaptive exponential integrate-and-fire model as an effective description of neuronal activity</article-title>. <source>J Neurophysiol</source>, <volume>94</volume>(<issue>5</issue>):<fpage>3637</fpage>&#x2013;<lpage>3642</lpage>, <year>2005</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><given-names>N</given-names> <surname>Brunel</surname></string-name> and <string-name><given-names>V</given-names> <surname>Hakim</surname></string-name>. <article-title>Fast global oscillations in networks of integrate-and-fire neurons with low firing rates</article-title>. <source>Neural Comput</source>, <volume>11</volume>(<issue>7</issue>):<fpage>1621</fpage>&#x2013;<lpage>1671</lpage>, <year>1999</year>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><given-names>B</given-names> <surname>Chambers</surname></string-name> and <string-name><given-names>J N</given-names> <surname>MacLean</surname></string-name>. <article-title>Higher-order synaptic interactions coordinate dynamics in recurrent networks</article-title>. <source>PLoS Comput Biol</source>, <volume>12</volume>(<issue>8</issue>):<fpage>e1005078</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><given-names>MR</given-names> <surname>Cohen</surname></string-name> and <string-name><given-names>A</given-names> <surname>Kohn</surname></string-name>. <article-title>Measuring and interpreting neuronal correlations</article-title>. <source>Nature Neurosci</source>, <volume>14</volume>(<issue>7</issue>):<fpage>811</fpage>&#x2013;<lpage>819</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><given-names>K Cohen-Kashi</given-names> <surname>Malina</surname></string-name>, <string-name><given-names>M</given-names> <surname>Jubran</surname></string-name>, <string-name><given-names>Y</given-names> <surname>Katz</surname></string-name>, and <string-name><given-names>I</given-names> <surname>Lampl</surname></string-name>. <article-title>Imbalance between excitation and inhibition in the somatosensory cortex produces postadaptation facilitation</article-title>. <source>J Neurosci</source>, <volume>33</volume>(<issue>19</issue>):<fpage>8463</fpage>&#x2013;<lpage>8471</lpage>, <month>May</month> <year>2013</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="book"><string-name><given-names>P</given-names> <surname>Dayan</surname></string-name> and <string-name><given-names>L F</given-names> <surname>Abbott</surname></string-name>. <chapter-title>Theoretical Neuroscience</chapter-title>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-loc>MIT Press</publisher-loc>, <year>2001</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><given-names>Nima</given-names> <surname>Dehghani</surname></string-name>, <string-name><given-names>Adrien</given-names> <surname>Peyrache</surname></string-name>, <string-name><given-names>Bartosz</given-names> <surname>Telenczuk</surname></string-name>, <string-name><given-names>Michel</given-names> <surname>Le Van Quyen</surname></string-name>, <string-name><given-names>Eric</given-names> <surname>Hal-gren</surname></string-name>, <string-name><given-names>Sydney S</given-names> <surname>Cash</surname></string-name>, <string-name><given-names>Nicholas G</given-names> <surname>Hatsopoulos</surname></string-name>, and <string-name><surname>Alain</surname> <given-names>Destexhe</given-names></string-name>. <article-title>Dynamic balance of excitation and inhibition in human and monkey neocortex</article-title>. <source>Sci Rep</source>, <volume>6</volume>, <year>2016</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><given-names>K</given-names> <surname>Deisseroth</surname></string-name>. <article-title>Optogenetics: 10 years of microbial opsins in neuroscience</article-title>. <source>Nature Neurosci</source>, <volume>18</volume>(<issue>9</issue>):<fpage>1213</fpage>&#x2013;<lpage>1225</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>, <string-name><given-names>A</given-names> <surname>Litwin-Kumar</surname></string-name>, <string-name><given-names>R</given-names> <surname>Rosenbaum</surname></string-name>, <string-name><given-names>G K</given-names> <surname>Ocker</surname></string-name>, and <string-name><given-names>K</given-names> <surname>Josi&#x107;</surname></string-name>. <article-title>The mechanics of state-dependent neural correlations</article-title>. <source>Nature Neurosci</source>, <volume>19</volume>(<issue>3</issue>):<fpage>383</fpage>&#x2013;<lpage>393</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><given-names>AS</given-names> <surname>Ecker</surname></string-name>, <string-name><given-names>P</given-names> <surname>Berens</surname></string-name>, <string-name><given-names>GA</given-names> <surname>Keliris</surname></string-name>, <string-name><given-names>M</given-names> <surname>Bethge</surname></string-name>, <string-name><given-names>NK</given-names> <surname>Logothetis</surname></string-name>, and <string-name><given-names>AS</given-names> <surname>Tolias</surname></string-name>. <article-title>Decorrelated Neuronal Firing in Cortical Microcircuits</article-title>. <source>Science</source>, <volume>327</volume>(<issue>5965</issue>):<fpage>584</fpage>&#x2013;<lpage>587</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><given-names>B</given-names> <surname>Ermentrout</surname></string-name>. <article-title>Linearization of F-I curves by adaptation</article-title>. <source>Neural Comput</source>, <volume>10</volume>(<issue>7</issue>):<fpage>1721</fpage>&#x2013;<lpage>1729</lpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><given-names>G L</given-names> <surname>Gerstein</surname></string-name> and <string-name><given-names>B</given-names> <surname>Mandelbrot</surname></string-name>. <article-title>Random Walk Models for the Spike Activity of a Single Neuron</article-title>. <source>Biophys J</source>, <volume>4</volume>(<issue>c</issue>):<fpage>41</fpage>&#x2013;<lpage>68</lpage>, <month>jan</month> <year>1964</year>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><given-names>Bilal</given-names> <surname>Haider</surname></string-name>, <string-name><given-names>Alvaro</given-names> <surname>Duque</surname></string-name>, <string-name><given-names>Andrea R</given-names> <surname>Hasenstaub</surname></string-name>, and <string-name><given-names>David A</given-names> <surname>McCormick</surname></string-name>. <article-title>Neocortical network activity in vivo is generated through a dynamic balance of excitation and inhibition</article-title>. <source>J Neurosci</source>, <volume>26</volume>(<issue>17</issue>):<fpage>4535</fpage>&#x2013;<lpage>4545</lpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><given-names>L</given-names> <surname>Hert&#x00E4;g</surname></string-name>, <string-name><given-names>D</given-names> <surname>Durstewitz</surname></string-name>, and <string-name><given-names>N</given-names> <surname>Brunel</surname></string-name>. <article-title>Analytical approximations of the firing rate of an adaptive exponential integrate-and-fire neuron in the presence of synaptic noise</article-title>. <source>Frontiers in Comput Neurosci</source>, <volume>8</volume>, <year>2014</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Hioki</surname></string-name>, <string-name><given-names>S</given-names> <surname>Okamoto</surname></string-name>, <string-name><given-names>M</given-names> <surname>Konno</surname></string-name>, <string-name><given-names>H</given-names> <surname>Kameda</surname></string-name>, <string-name><given-names>J</given-names> <surname>Sohn</surname></string-name>, <string-name><given-names>E</given-names> <surname>Kuramoto</surname></string-name>, <string-name><given-names>F</given-names> <surname>Fujiyama</surname></string-name>, and <string-name><given-names>T</given-names> <surname>Kaneko</surname></string-name>. <article-title>Cell type-specific inhibitory inputs to dendritic and somatic compartments of parvalbumin-expressing neocortical interneuron</article-title>. <source>J Neurosci</source>, <volume>33</volume>(<issue>2</issue>):<fpage>544</fpage>&#x2013;<lpage>555</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><given-names>S B</given-names> <surname>Hofer</surname></string-name>, <string-name><given-names>H</given-names> <surname>Ko</surname></string-name>, <string-name><given-names>B</given-names> <surname>Pichler</surname></string-name>, <string-name><given-names>J</given-names> <surname>Vogelstein</surname></string-name>, <string-name><given-names>H</given-names> <surname>Ros</surname></string-name>, <string-name><given-names>H</given-names> <surname>Zeng</surname></string-name>, <string-name><given-names>E</given-names> <surname>Lein</surname></string-name>, <string-name><given-names>N A</given-names> <surname>Lesica</surname></string-name>, and <string-name><given-names>T D</given-names> <surname>Mrsic-Flogel</surname></string-name>. <article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title>. <source>Nature Neurosci</source>, <volume>14</volume>(<issue>8</issue>):<fpage>1045</fpage>&#x2013;<lpage>52</lpage>, <month>aug</month> <year>2011</year>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><given-names>X</given-names> <surname>Jiang</surname></string-name>, <string-name><given-names>S</given-names> <surname>Shen</surname></string-name>, <string-name><given-names>C R</given-names> <surname>Cadwell</surname></string-name>, <string-name><given-names>P</given-names> <surname>Berens</surname></string-name>, <string-name><given-names>F</given-names> <surname>Sinz</surname></string-name>, <string-name><given-names>A S</given-names> <surname>Ecker</surname></string-name>, <string-name><given-names>S</given-names> <surname>Patel</surname></string-name>, and <string-name><given-names>A S</given-names> <surname>Tolias</surname></string-name>. <article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title>. <source>Science</source>, <volume>350</volume>(<issue>6264</issue>):<fpage>aac9462</fpage> <year>2015</year>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Jolivet</surname></string-name>, <string-name><given-names>A</given-names> <surname>Rauch</surname></string-name>, <string-name><given-names>H R</given-names> <surname>L&#x00FC;ascher</surname></string-name>, and <string-name><given-names>W</given-names> <surname>Gerstner</surname></string-name>. <article-title>Integrate-and-Fire models with adaptation are good enough: predicting spike times under random current injection</article-title>. <source>Adv Neural Inf Process Syst</source>, <volume>18</volume>:<fpage>595</fpage>&#x2013;<lpage>602</lpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Jolivet</surname></string-name>, <string-name><given-names>F</given-names> <surname>Sch&#x00FC;rmann</surname></string-name>, <string-name><given-names>T K</given-names> <surname>Berger</surname></string-name>, <string-name><given-names>R</given-names> <surname>Naud</surname></string-name>, <string-name><given-names>W</given-names> <surname>Gerstner</surname></string-name>, and <string-name><given-names>A</given-names> <surname>Roth</surname></string-name>. <article-title>The quantitative single-neuron modeling competition</article-title>. <source>Biol Cybern</source>, <volume>99</volume>(<issue>4-5</issue>):<fpage>417</fpage>&#x2013;<lpage>426</lpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Kameda</surname></string-name>, <string-name><given-names>H</given-names> <surname>Hioki</surname></string-name>, <string-name><given-names>Y H</given-names> <surname>Tanaka</surname></string-name>, <string-name><given-names>T</given-names> <surname>Tanaka</surname></string-name>, <string-name><given-names>J</given-names> <surname>Sohn</surname></string-name>, <string-name><given-names>T</given-names> <surname>Sonomura</surname></string-name>, <string-name><given-names>T</given-names> <surname>Furuta</surname></string-name>, <string-name><given-names>F</given-names> <surname>Fujiyama</surname></string-name>, and <string-name><given-names>T</given-names> <surname>Kaneko</surname></string-name>. <article-title>Parvalbumin-producing cortical interneurons receive inhibitory inputs on proximal portions and cortical excitatory inputs on distal dendrites</article-title>. <source>Europ J Neurosci</source>, <volume>35</volume>(<issue>6</issue>):<fpage>838</fpage>&#x2013;<lpage>854</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Ko</surname></string-name>, <string-name><given-names>S B</given-names> <surname>Hofer</surname></string-name>, <string-name><given-names>B</given-names> <surname>Pichler</surname></string-name>, <string-name><given-names>K A</given-names> <surname>Buchanan</surname></string-name>, <string-name><given-names>P J</given-names> <surname>Sj&#x00F6;str&#x00F6;m</surname></string-name>, and <string-name><given-names>T D</given-names> <surname>Mrsic-Flogel</surname></string-name>. <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature</source>, <volume>473</volume>(<issue>7345</issue>):<fpage>87</fpage>&#x2013;<lpage>91</lpage>, <month>May</month> <year>2011</year>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><given-names>G</given-names> <surname>Koch Ocker</surname></string-name> and <string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>. <article-title>Kv7 channels regulate pairwise spiking covariability in health and disease</article-title>. <source>J Neurophysiol</source>, <volume>112</volume>(<issue>2</issue>):<fpage>340</fpage>&#x2013;<lpage>352</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><given-names>I D</given-names> <surname>Landau</surname></string-name>, <string-name><given-names>R</given-names> <surname>Egger</surname></string-name>, <string-name><given-names>V J</given-names> <surname>Dercksen</surname></string-name>, <string-name><given-names>M</given-names> <surname>Oberlaender</surname></string-name>, and <string-name><given-names>H</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>The impact of structural heterogeneity on excitation-inhibition balance in cortical networks</article-title>. <source>Neuron</source>, <year>2016</year>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><given-names>Y</given-names> <surname>LeCun</surname></string-name>, <string-name><given-names>Y</given-names> <surname>Bengio</surname></string-name>, and <string-name><given-names>G</given-names> <surname>Hinton</surname></string-name>. <article-title>Deep learning</article-title>. <source>Nature</source>, <volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage>&#x2013;<lpage>444</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><given-names>E</given-names> <surname>Ledoux</surname></string-name> and <string-name><given-names>N</given-names> <surname>Brunel</surname></string-name>. <article-title>Dynamics of networks of excitatory and inhibitory neurons in response to time-dependent inputs</article-title>. <source>Front Comput Neurosci</source>, <volume>5</volume>:<fpage>25</fpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><string-name><given-names>Robert B</given-names> <surname>Levy</surname></string-name> and <string-name><given-names>Alex D</given-names> <surname>Reyes</surname></string-name>. <article-title>Spatial profile of excitatory and inhibitory synaptic connectivity in mouse primary auditory cortex</article-title>. <source>J Neurosci</source>, <volume>32</volume>(<issue>16</issue>):<fpage>5609</fpage>&#x2013;<lpage>5619</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><string-name><given-names>S</given-names> <surname>Lim</surname></string-name> and <string-name><given-names>M S</given-names> <surname>Goldman</surname></string-name>. <article-title>Balanced cortical microcircuitry for spatial working memory based on corrective feedback control</article-title>. <source>J Neurosci</source>, <volume>34</volume>(<issue>20</issue>):<fpage>6790</fpage>&#x2013;<lpage>6806</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><given-names>A</given-names> <surname>Litwin-Kumar</surname></string-name> and <string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>. <article-title>Slow dynamics and high variability in balanced cortical networks with clustered connections</article-title>. <source>Nature Neurosci</source>, <volume>15</volume>(<issue>11</issue>):<fpage>1498</fpage>&#x2013;<lpage>1505</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><string-name><given-names>A</given-names> <surname>Litwin-Kumar</surname></string-name>, <string-name><given-names>R</given-names> <surname>Rosenbaum</surname></string-name>, and <string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>. <article-title>Inhibitory stabilization and visual coding in cortical circuits with multiple interneuron subtypes</article-title>. <source>J Neurophysiol</source>, <volume>115</volume>(<issue>3</issue>):<fpage>1399</fpage>&#x2013;<lpage>1409</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><string-name><given-names>B J</given-names> <surname>Marlin</surname></string-name>, <string-name><given-names>M</given-names> <surname>Mitre</surname></string-name>, <string-name><given-names>J A</given-names> <surname>D&#x2019;amour</surname></string-name>, <string-name><given-names>M V</given-names> <surname>Chao</surname></string-name>, and <string-name><given-names>R C</given-names> <surname>Froemke</surname></string-name>. <article-title>Oxytocin enables maternal behaviour by balancing cortical inhibition</article-title>. <source>Nature</source>, <volume>520</volume>(<issue>7548</issue>):<fpage>499</fpage>&#x2013;<lpage>504</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><string-name><given-names>K D</given-names> <surname>Miller</surname></string-name>. <article-title>Canonical computations of cerebral cortex</article-title>. <source>Curr Opin Neurobiol</source>, <volume>37</volume>:<fpage>75</fpage>&#x2013;<lpage>84</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><string-name><given-names>B K</given-names> <surname>Murphy</surname></string-name> and <string-name><given-names>K D</given-names> <surname>Miller</surname></string-name>. <article-title>Balanced amplification: a new mechanism of selective amplification of neural activity patterns</article-title>. <source>Neuron</source>, <volume>61</volume>(<issue>4</issue>):<fpage>635</fpage>&#x2013;<lpage>48</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><string-name><given-names>M</given-names> <surname>Okun</surname></string-name> and <string-name><given-names>I</given-names> <surname>Lampl</surname></string-name>. <article-title>Instantaneous correlation of excitation and inhibition during ongoing and sensory-evoked activities</article-title>. <source>Nature Neurosci</source>, <volume>11</volume>(<issue>5</issue>):<fpage>535</fpage>&#x2013;<lpage>537</lpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><string-name><given-names>H</given-names> <surname>Ozeki</surname></string-name>, <string-name><given-names>I M</given-names> <surname>Finn</surname></string-name>, <string-name><given-names>E S</given-names> <surname>Schaffer</surname></string-name>, <string-name><given-names>K D</given-names> <surname>Miller</surname></string-name>, and <string-name><given-names>D</given-names> <surname>Ferster</surname></string-name>. <article-title>Inhibitory stabilization of the cortical network underlies visual surround suppression</article-title>. <source>Neuron</source>, <volume>62</volume>(<issue>4</issue>):<fpage>578</fpage>&#x2013;<lpage>92</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><string-name><given-names>L</given-names> <surname>Petreanu</surname></string-name>, <string-name><given-names>D</given-names> <surname>Huber</surname></string-name>, <string-name><given-names>A</given-names> <surname>Sobczyk</surname></string-name>, and <string-name><given-names>K</given-names> <surname>Svoboda</surname></string-name>. <article-title>Channelrhodopsin-2-assisted circuit mapping of long-range callosal projections</article-title>. <source>Nature Neurosci</source>, <volume>10</volume>(<issue>5</issue>):<fpage>663</fpage>&#x2013;<lpage>668</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="journal"><string-name><given-names>EAK</given-names> <surname>Phillips</surname></string-name> and <string-name><given-names>AR</given-names> <surname>Hasenstaub</surname></string-name>. <article-title>Asymmetric effects of activating and inactivating cortical interneurons</article-title>. <source>eLife</source>, <volume>5</volume>:<fpage>e18383</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="journal"><string-name><given-names>F</given-names> <surname>Pouille</surname></string-name>, <string-name><given-names>A</given-names> <surname>Marin-Burgin</surname></string-name>, <string-name><given-names>H</given-names> <surname>Adesnik</surname></string-name>, <string-name><given-names>B V</given-names> <surname>Atallah</surname></string-name>, and <string-name><given-names>M</given-names> <surname>Scanziani</surname></string-name>. <article-title>Input normalization by global feedforward inhibition expands cortical dynamic range</article-title>. <source>Nature Neurosci</source>, <volume>12</volume>(<issue>12</issue>):<fpage>1577</fpage>&#x2013;<lpage>1585</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c45"><label>[45]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Pyle</surname></string-name> and <string-name><given-names>R</given-names> <surname>Rosenbaum</surname></string-name>. <article-title>Highly connected neurons spike less frequently in balanced networks</article-title>. <source>Phys Rev E</source>, <volume>93</volume>(<issue>4</issue>):<fpage>040302</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c46"><label>[46]</label><mixed-citation publication-type="book"><string-name><given-names>A</given-names> <surname>Renart</surname></string-name>, <string-name><given-names>N</given-names> <surname>Brunel</surname></string-name>, and <string-name><given-names>X-J</given-names> <surname>Wang</surname></string-name>. <chapter-title>Mean-field theory of irregularly spiking neuronal populations and working memory in recurrent cortical networks</chapter-title>. <source>In Computational Neuroscience: A Comprehensive Approach</source>, pages <fpage>431</fpage>&#x2013;<lpage>490</lpage>. <publisher-name>CRC Press</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>2004</year>.</mixed-citation></ref>
<ref id="c47"><label>[47]</label><mixed-citation publication-type="journal"><string-name><given-names>A</given-names> <surname>Renart</surname></string-name>, <string-name><given-names>J</given-names> <surname>de La Rocha</surname></string-name>, <string-name><given-names>P</given-names> <surname>Bartho</surname></string-name>, <string-name><given-names>L</given-names> <surname>Hollender</surname></string-name>, <string-name><given-names>N</given-names> <surname>Parga</surname></string-name>, <string-name><given-names>A</given-names> <surname>Reyes</surname></string-name>, and <string-name><given-names>KD</given-names> <surname>Harris</surname></string-name>. <article-title>The Asynchronous State in Cortical Circuits</article-title>. <source>Science</source>, <volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>&#x2013;<lpage>590</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c48"><label>[48]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Rosenbaum</surname></string-name> and <string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>. <article-title>Balanced networks of spiking neurons with spatially dependent recurrent connections</article-title>. <source>Phys Rev X</source>, <volume>4</volume>(<issue>2</issue>):<fpage>021039</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c49"><label>[49]</label><mixed-citation publication-type="journal"><string-name><given-names>R</given-names> <surname>Rosenbaum</surname></string-name>, <string-name><given-names>M A</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>A</given-names> <surname>Kohn</surname></string-name>, <string-name><given-names>J E</given-names> <surname>Rubin</surname></string-name>, and <string-name><given-names>B</given-names> <surname>Doiron</surname></string-name>. <article-title>The spatial structure of correlated neuronal variability</article-title>. <source>Nature Neurosci</source>, <year>2016</year>.</mixed-citation></ref>
<ref id="c50"><label>[50]</label><mixed-citation publication-type="journal"><string-name><given-names>D B</given-names> <surname>Rubin</surname></string-name>, <string-name><given-names>S D</given-names> <surname>Van Hooser</surname></string-name>, and <string-name><given-names>K D</given-names> <surname>Miller</surname></string-name>. <article-title>The stabilized supralinear network: A unifying circuit motif underlying multi-input integration in sensory cortex</article-title>. <source>Neuron</source>, <volume>85</volume>(<issue>2</issue>):<fpage>1</fpage>&#x2013;<lpage>51</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c51"><label>[51]</label><mixed-citation publication-type="journal"><string-name><given-names>M N</given-names> <surname>Shadlen</surname></string-name> and <string-name><given-names>W T</given-names> <surname>Newsome</surname></string-name>. <article-title>The variable discharge of cortical neurons: implications for connectivity, computation, and information coding</article-title>. <source>J. Neurosci.</source>, <volume>18</volume>(<issue>10</issue>):<fpage>3870</fpage>&#x2013;<lpage>96</lpage>, <month>may</month> <year>1998</year>.</mixed-citation></ref>
<ref id="c52"><label>[52]</label><mixed-citation publication-type="journal"><string-name><given-names>M N</given-names> <surname>Shadlen</surname></string-name> and <string-name><given-names>W T</given-names> <surname>Newsome</surname></string-name>. <article-title>The variable discharge of cortical neurons: implications for connectivity, computation, and information coding</article-title>. <source>J Neurosci</source>, <volume>18</volume>(<issue>10</issue>):<fpage>3870</fpage>&#x2013;<lpage>3896</lpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c53"><label>[53]</label><mixed-citation publication-type="journal"><string-name><given-names>W R</given-names> <surname>Softky</surname></string-name> and <string-name><given-names>C</given-names> <surname>Koch</surname></string-name>. <article-title>The highly irregular firing of cortical cells is inconsistent with temporal integration of random EPSPs</article-title>. <source>J Neurosci</source>, <volume>13</volume>(<issue>1</issue>):<fpage>334</fpage>&#x2013;<lpage>50</lpage>, <year>1993</year>.</mixed-citation></ref>
<ref id="c54"><label>[54]</label><mixed-citation publication-type="journal"><string-name><given-names>C</given-names> <surname>Stringer</surname></string-name>, <string-name><given-names>M</given-names> <surname>Pachitariu</surname></string-name>, <string-name><given-names>N A</given-names> <surname>Steinmetz</surname></string-name>, <string-name><given-names>M</given-names> <surname>Okun</surname></string-name>, <string-name><given-names>P</given-names> <surname>Bartho</surname></string-name>, <string-name><given-names>K D</given-names> <surname>Harris</surname></string-name>, <string-name><given-names>M</given-names> <surname>Sahani</surname></string-name>, and <string-name><given-names>Nicholas A</given-names> <surname>Lesica</surname></string-name>. <article-title>Inhibitory control of correlated intrinsic variability in cortical networks</article-title>. <source>eLife</source>, <volume>5</volume>:<fpage>e19695</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c55"><label>[55]</label><mixed-citation publication-type="journal"><string-name><given-names>AYY</given-names> <surname>Tan</surname></string-name>, <string-name><given-names>Y</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>B</given-names> <surname>Scholl</surname></string-name>, <string-name><given-names>E</given-names> <surname>Seidemann</surname></string-name>, and <string-name><given-names>N J</given-names> <surname>Priebe</surname></string-name>. <article-title>Sensory stimulation shifts visual cortex from synchronous to asynchronous states</article-title>. <source>Nature</source>, <volume>509</volume>(<issue>7499</issue>):<fpage>226</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c56"><label>[56]</label><mixed-citation publication-type="journal"><string-name><given-names>F G</given-names> <surname>Tricomi</surname></string-name>. <article-title>Integral equations</article-title>. <source>Interscience, New York</source>, <year>1957</year>.</mixed-citation></ref>
<ref id="c57"><label>[57]</label><mixed-citation publication-type="journal"><string-name><given-names>MV</given-names> <surname>Tsodyks</surname></string-name>, <string-name><given-names>WE</given-names> <surname>Skaggs</surname></string-name>, <string-name><given-names>TJ</given-names> <surname>Sejnowski</surname></string-name>, and <string-name><given-names>BL</given-names> <surname>Mcnaughton</surname></string-name>. <article-title>Paradoxical Effects of External Modulation of Inhibitory Interneurons</article-title>. <source>J Neurosci</source>, <volume>17</volume>(<issue>11</issue>):<fpage>4382</fpage>&#x2013;<lpage>4388</lpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c58"><label>[58]</label><mixed-citation publication-type="journal"><string-name><given-names>C</given-names> <surname>van Vreeswijk</surname></string-name> and <string-name><given-names>H</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science</source>, <volume>274</volume>(<issue>5293</issue>):<fpage>1724</fpage>&#x2013;<lpage>1726</lpage>, <year>1996</year>.</mixed-citation></ref>
<ref id="c59"><label>[59]</label><mixed-citation publication-type="journal"><string-name><given-names>C</given-names> <surname>van Vreeswijk</surname></string-name> and <string-name><given-names>H</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Chaotic balanced state in a model of cortical circuits</article-title>. <source>Neural Comput</source>, <volume>10</volume>(<issue>6</issue>):<fpage>1321</fpage>&#x2013;<lpage>1371</lpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c60"><label>[60]</label><mixed-citation publication-type="journal"><string-name><given-names>K</given-names> <surname>Wimmer</surname></string-name>, <string-name><given-names>A</given-names> <surname>Compte</surname></string-name>, <string-name><given-names>A</given-names> <surname>Roxin</surname></string-name>, <string-name><given-names>D</given-names> <surname>Peixoto</surname></string-name>, <string-name><given-names>A</given-names> <surname>Renart</surname></string-name>, and <string-name><given-names>J</given-names> <surname>de la Rocha</surname></string-name>. <article-title>The dynamics of sensory integration in a hierarchical network explains choice probabilities in MT</article-title>. <source>Nature Commun</source>, <volume>6</volume>:<fpage>1</fpage>&#x2013;<lpage>13</lpage>, <year>2015</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>