<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/186627</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioengineering</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Compact Standalone Platform for Neural Recording with Real-Time Spike Sorting and Data Logging</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" >
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9201-6111</contrib-id>
<name>
<surname>Luan</surname>
<given-names>Song</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Williams</surname>
<given-names>Ian</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Maslik</surname>
<given-names>Michal</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Liu</surname>
<given-names>Yan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>de Carvalho</surname>
<given-names>Felipe</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jackson</surname>
<given-names>Andrew</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Quiroga</surname>
<given-names>Rodrigo Quian</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Constandinou</surname>
<given-names>Timothy G.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Centre for Bio-Inspired Technology, EEE Department, Imperial College London</institution>, South Kensington Campus, London SW7 2BT, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>Institute of Neuroscience, Newcastle University</institution>, Newcastle upon Tyne, NE1 7RU, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>Centre for Systems Neuroscience, Department of Neuroscience</institution>, Psychology and Behaviour, University of Leicester, Leicester LE1 7QR</aff>
</contrib-group>
<author-notes>
<fn id="n1"><p>E-mail: <email>s.luan@imperial.ac.uk</email></p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>186627</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>21</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>9</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="186627.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<sec>
<title>Objective</title>
<p>Longitudinal observation of single unit neural activity from large numbers of cortical neurons in awake and mobile animals is often a vital step in studying neural network behaviour and towards the prospect of building effective Brain Machine Interfaces (BMIs). These recordings generate enormous amounts of data for transmission &#x0026; storage, and typically require offline processing to tease out the behaviour of individual neurons. Our aim was to create a compact system capable of: 1) reducing the data bandwidth by circa 3 orders of magnitude (greatly improving battery lifetime and enabling low power wireless transmission); 2) producing real-time, low-latency, spike sorted data; and 3) long term untethered operation. <italic>Approach</italic>. We have developed a headstage that operates in two phases. In the short training phase a computer is attached and classic spike sorting is performed to generate templates. In the second phase the system is untethered and performs template matching to create an event driven spike output that is logged to a micro-SD card. To enable validation the system is capable of logging the high bandwidth raw neural signal data as well as the spike sorted data. <italic>Main results</italic>. The system can successfully record 32 channels of raw neural signal data and/or spike sorted events for well over 24 hours at a time and is robust to power dropouts during battery changes as well as SD card replacement. A 24-hour initial recording in a non-human primate M1 showed consistent spike shapes with the expected changes in neural activity during awake behaviour and sleep cycles. <italic>Significance</italic> The presented platform allows neural activity to be unobtrusively monitored and processed in real-time in freely behaving untethered animals revealing insights that are not attainable through scheduled recording sessions and provides a robust, low-latency, low-bandwidth output suitable for BMIs, closed loop neuromodulation, wireless transmission and long term data logging.</p>
</sec>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Neural recording</kwd>
<kwd>spike sorting</kwd>
<kwd>spike detection</kwd>
<kwd>template matching</kwd>
<kwd>real-time</kwd>
<kwd>chronic</kwd>
<kwd>logging</kwd>
</kwd-group>
<counts>
<page-count count="18"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1.</label>
<title>Introduction</title>
<p>There is currently a global effort to expand our knowledge of the brain by recording large-scale cortical neural activity over a long period of time. The &#x2018;Brain Research through Advancing Innovative Neurotechnologies&#x2019; (BRAIN) Initiative in particular is looking to deliver a step change in our understanding of the brain&#x2019;s networks and function &#x2013; a key element of this is research to advance neural recording from the current state-ofthe-art (short term targeted recordings of in the order of 1000s of channels [<xref rid="c1" ref-type="bibr">1</xref>, <xref rid="c2" ref-type="bibr">2</xref>, <xref rid="c3" ref-type="bibr">3</xref>]) to round-the-clock recordings of more than 100,000 channels in freely behaving animals [<xref rid="c4" ref-type="bibr">4</xref>].</p>
<p>These ever increasing channel counts and recording periods naturally lead to an enormous amount of raw data to be stored and processed to extract useful information. For example a 100,000 channel system could well generate in excess of 10 Gigabits per second of data, not to mention the requirement of recording 24 hours. This presents a major obstacle for chronic operation and real-time behaviour analysis. However, raw recorded neural data is sparse and hence amenable to data compression [<xref rid="c5" ref-type="bibr">5</xref>, <xref rid="c6" ref-type="bibr">6</xref>, <xref rid="c7" ref-type="bibr">7</xref>] or techniques to extract useful information from the signal locally on the recording device [<xref rid="c8" ref-type="bibr">8</xref>, <xref rid="c9" ref-type="bibr">9</xref>, <xref rid="c10" ref-type="bibr">10</xref>]. While both these methods are effective in saving bandwidth and power [<xref rid="c11" ref-type="bibr">11</xref>], the latter also enables on-node network state analysis and triggers for controlling brain machine interfaces (BMI) without data decompression.</p>
<p>Understanding network state and correlating it with observed or desired behaviour is greatly enhanced by separating out the activity of individual neurons from the melee recorded by each electrode &#x2013; i.e. spike sorting [<xref rid="c12" ref-type="bibr">12</xref>, <xref rid="c13" ref-type="bibr">13</xref>] &#x2013; as each neuron may encode different features of a behaviour. Naive spike sorting (involving spike detection and clustering) is a computationally complex process that is normally performed offline on a computer using Principal Component Analysis or wavelet decomposition. However, in recent years a two step process has emerged: in the first step naive sorting is performed offline to identify characteristics of the spikes; and in the second step a computationally simpler form of spike sorting can be performed online based on classification rather than clustering. These classification methods include: feature extraction based on first derivative peaks [<xref rid="c8" ref-type="bibr">8</xref>]; or zero crossings [<xref rid="c14" ref-type="bibr">14</xref>]; or key differentiating points [<xref rid="c15" ref-type="bibr">15</xref>]. The system presented here utilises template matching to achieve high accuracy with exceptionally low computational cost [<xref rid="c1" ref-type="bibr">1</xref>, <xref rid="c16" ref-type="bibr">16</xref>, <xref rid="c17" ref-type="bibr">17</xref>] making it attractive for high channel count systems.</p>
<p>This paper describes a system (see <xref rid="fig1" ref-type="fig">Figure 1</xref>) capable of recording raw neural signal data and performing real-time template matching based spike sorting. The event driven spike sorted output reduces the data transmission bandwidth by circa 3 orders of magnitude (assuming a nominal spike rate of 10 spikes per second [<xref rid="c18" ref-type="bibr">18</xref>]) and provides a sub-millisecond latency control signal for closed-loop neuromodulation or brain machine interfaces.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>System concept &#x2013; the miniature head-mounted system amplifies, filters and spike sorts neural signals from electrodes inserted in the cortex, and the resulting spike events are either stored in local memory (as demonstrated here) or wirelessly transmitted. During a training phase a cable to a computer is briefly attached and raw neural signal data is recorded, clustered and the resulting characteristic spike waveforms are uploaded into the headstage to enable the template matching based spike sorting.</p></caption>
<graphic xlink:href="186627_fig1.tif"/>
</fig>
<p>A similar concept was demonstrated by Schwarz <italic>et al.</italic> [<xref rid="c1" ref-type="bibr">1</xref>], however, they identified a bidirectional wireless link as essential for on-node spike sorting and as a result their system was limited to only logging 6 channels of neural signal (plus spike sorted events) due to the limited wireless bandwidth available and also suffered from wireless transmission latency and packet loss. Here we present a system capable of lossless recording of 32 channels of neural signal by using a two phase approach to spike sorting as well as on-node data logging. Further advantages of this system include: the modular rather than monolithic design (which enables the on-node data logging to be easily replaced by a wireless transceiver or BMI); a more compact front end and spike sorting module; an increase in the number of templates per channel (and hence distinguishable neurons) from 2 to 4; and features targeted at chronic experiments such as automatic reloading of configuration data on power cycling or SD card changing. The system has been fully tested <italic>in-vivo</italic> for several 24-hour recording sessions.</p>
<p>The remainder of this paper is organised as follows: Section 2 describes the system design and implementation; Section 3 presents performance metrics from benchtop electronic testing as well as the results obtained from <italic>in-vivo</italic> experiments; and Section 4 discusses the results, limitations and expected future development of the system.</p>
</sec>
<sec id="s2">
<label>2.</label>
<title>System Design</title>
<sec id="s2a">
<label>2.1.</label>
<title>Outline system architecture</title>
<p>The system (shown in <xref rid="fig2" ref-type="fig">Figure 2</xref>) has been designed in a modular fashion with standard connectors to enable future flexibility and system reconfiguration. The core of the system is the Neural Interface board which performs the signal conditioning and on-node spike sorting. For initial system validation this has been paired with a custom micro-SD logging and standalone controller board capable of recording all the raw and spike sorted data as well as automatic reconfiguring the system when power is interrupted (e.g. during a battery change) or when the SD card is changed. These two boards have been designed to be small and lightweight to enable them to be head-mounted for long periods of time. In addition a benchtop Data Interface board can be connected through a wired link to enable data to be logged to a computer and for configuration data to be uploaded to the head-mounted boards.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>The standalone system mounted in a 3D printed support designed to fit inside a monkey&#x2019;s head cradle.</p></caption>
<graphic xlink:href="186627_fig2.tif"/>
</fig>
</sec>
<sec id="s2b">
<label>2.2.</label>
<title>Typical system operation</title>
<p>The system is designed to operate in two distinct phases of operation as shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Strategy of two-phase online spike sorting. (1) Calibration phase using a computer to generate templates offline. (2) Real-time on-node template matching where spike events are stored on an SD card.</p></caption>
<graphic xlink:href="186627_fig3.tif"/>
</fig>
<list list-type="simple">
<list-item><label>(i)</label><p>In the calibration phase, the head-mounted system is tethered to a computer and a 5-10 minute recording of raw neural signal data is recorded and clustered using offline processing (here we use Wave Clus [<xref rid="c19" ref-type="bibr">19</xref>]). Spike detection levels, characteristic templates for each of the observed spike clusters, and template matching thresholds are then uploaded for the next phase.</p></list-item>
<list-item><label>(ii)</label><p>During the online template matching phase, the headstage is untethered from the computer and a small, low-power Field Programmable Gate Array (FPGA) is used to perform template matching based spike sorting. The resulting raw and/or spike sorted data is recorded to a micro-SD card for later analysis and validation.</p></list-item>
</list>
</sec>
<sec id="s2c">
<label>2.3.</label>
<title>System design rationale</title>
<p>Real-time on-node template matching lies at the heart of this system and typically involves 3 main processing steps each of which can have a substantial effect on overall efficiency and performance. This section sets out the design rationale and chosen values for these processing steps, which was guided by the work of Navajas <italic>et al.</italic> [<xref rid="c16" ref-type="bibr">16</xref>].</p>
<sec id="s2c1">
<label>2.3.1.</label>
<title>Signal conditioning &#x0026; digitisation</title>
<p>This includes the amplification, filtering, sampling and analogue to digital conversion of the signal. An Intan RHD2132 was used to implement this step which provided the following options: a fixed gain of 192; tunable 3<sup><italic>rd</italic></sup> order Butterworth low pass filter, single order analogue high pass filter and single order IIR digital high pass filter; up to 30 kSamples/s; and a 16-bit Analogue to Digital Converter (ADC). For action potential data the high pass corner was set to approximately 300 Hz (a balance between the modelled best setting for a high pass Butterworth filter, the band of interest and the need to reject power line interference), and a low pass corner of 3 kHz (to reduce high frequency noise and balance performance against the reduced data rate of sampling at a rate of 15 kSamples/s). Modelling had also shown that the sample depth could be reduced to as low as 7-bits without significantly impacting performance, in this work we converted the 16-bit signal to a 9-bit value to retain a higher dynamic range while reducing the data rate, processing requirements, and also to make efficient use of the memory structures of the FPGA used to perform the spike detection and template matching. The 9-bits to be used are user configurable at run time, but in practice the 9-bits chosen are rarely changed as the Most Significant Bits (MSBs) of the ADC are impractically large for neural signals and the noise floor of the front end is approximately 16 times the Least Significant Bit (LSB) of the ADC (2.4 <italic>&#x00B5;</italic>V versus 0.195 <italic>&#x00B5;</italic>V).</p>
</sec>
<sec id="s2c2">
<label>2.3.2.</label>
<title>Spike windowing</title>
<p>This step includes detection of the spikes, peak alignment and the windowing of the neural spike to be compared to the template. Spike detection is not essential for template matching &#x2013; e.g. Schwarz <italic>et al.</italic> continuously test every incoming sample against templates &#x2013; however, it can greatly reduce the amount of processing required in the template matching step and therefore increases system efficiency. This is a step that is highly parallel and was a key driver for utilising an FPGA (which can run many parallel calculations at a low clock speed) rather than a microcontroller (which would have required a high clock speed and hence high power consumption). Spike detection can be achieved by a variety of approaches, but simply detecting a threshold crossing remains an efficient and high performance solution [<xref rid="c20" ref-type="bibr">20</xref>] and was the chosen approach for this system with spike thresholds user configured on a per-channel basis (automatically calculated from the standard deviation of the median filtered noise [<xref rid="c19" ref-type="bibr">19</xref>]). The detected spikes were then peak aligned and a window of 5 samples before the peak and 10 after the peak (16 samples total) were passed to the template matching processing.</p>
</sec>
<sec id="s2c3">
<label>2.3.3.</label>
<title>Template Matching</title>
<p>This step includes the scoring of the differences between an incoming windowed spike snippet and a characteristic waveform (templates) of previously observed spikes, as well as the final classification of a spike. Navajas <italic>et al.</italic> reviewed numerous methods for comparing waveforms and there were 2 clear leading algorithms in the tradeoff between performance and efficiency &#x2013; Norm 1 (sum of absolute difference) and Euclidean distance (sum of squared difference). In this instance (due to the lack of dedicated multiplication resource on the chosen FPGA) the Norm 1 implementation (shown in <xref rid="fig4" ref-type="fig">Figure 4</xref>) utilised Significantly less logic elements and was preferred.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Calculation of template matching scores &#x2013; an incoming spike waveform is compared against each of the templates and the sum of absolute difference for each pairing is calculated.</p></caption>
<graphic xlink:href="186627_fig4.tif"/>
</fig>
</sec>
</sec>
<sec id="s2d">
<label>2.4.</label>
<title>System Implementation</title>
<p><xref rid="fig5" ref-type="fig">Figure 5</xref> shows a block diagram breakdown of the key components across the 3 boards that make up the system. As shown the head-mounted boards can be powered either by a battery or from isolated USB power when tethered. When two power sources are available, a diode prevents uncontrolled current flowing into the battery and, due to its higher voltage, USB power is prioritised.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>System architecture of the proposed platform with inset photos showing the corresponding head mounted modules.</p></caption>
<graphic xlink:href="186627_fig5.tif"/>
</fig>
<sec id="s2d1">
<label>2.4.1.</label>
<title>Data flow</title>
<p>The front end neural signal acquisition provides 32 channels of signal conditioning and digitisation. The data is streamed out to a small low power FPGA over an Serial Peripheral Interface (SPI) link. The FPGA performs signal manipulation to reduce the 16-bit sample to 9-bits before performing timestamping, and in normal operation it also performs spike detection and template matching (as depicted in <xref rid="fig6" ref-type="fig">Figure 6</xref>) before packaging the sorted result and/or raw neural signal data into 16-bit words for transmission. These words flow into one or both of the FPGA&#x2019;s 2 output FIFO buffers &#x2013; a large one feeding the wired SPI link (with the FPGA as slave), and a small one feeding the SPI link to the controller board (with the FPGA as master).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Data processing in the FPGA. The red line indicates data flow for template matching, while the blue dotted line indicates the data flow for raw neural signal data.</p></caption>
<graphic xlink:href="186627_fig6.tif"/>
</fig>
</sec>
<sec id="s2d2">
<label>2.4.2.</label>
<title>Control &#x0026; Communication</title>
<p>Control and configuration of the headstage is typically performed through the wired link during the calibration phase. While this upload is happening the microcontroller receives copies of these settings and backs them up to specifically named files on the SD card. Then if power is interrupted during normal untethered operation the microcontroller will read the configuration files and upload these values to the headstage restoring the programmed configuration. This also means that it is possible to operate the system completely without the wired link by simply putting appropriately coded files onto an SD card, inserting the card and power cycling the controller board. The full list of FPGA configurable registers are listed in <xref rid="tbl1" ref-type="table">Table 1</xref>, in addition to this are the settings required for the Intan front end (as specified on datasheet).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>configurable registers on FPGA</p></caption>
<graphic xlink:href="186627_tbl1.tif"/>
</table-wrap>
</sec>
<sec id="s2d3">
<label>2.4.3.</label>
<title>Clock control</title>
<p>Reducing clock speed is a key factor in improving system power performance. Here the sampling rate of the ADC and the two FPGA clock domains are derived by integer division (between 2-16) down from an off-chip clock running at 19.2 MHz. With nominal settings the sampling rate is at <italic>&#x223C;</italic>15 kS/s per channel (with an SPI clock speed of 9.6 MHz) and the FPGA domains are in turn divided down to 4.8 MHz and 2.4 MHz. All these frequencies are intrinsically linked (based on clock cycles necessary to process the data), so for efficient capture of low frequency Local Field Potentials (LFPs) the global integer division can be set to 16 giving a sampling speed of <italic>&#x223C;</italic>2 kS/s (SPI clock at 1.2 MHz) and clock domains of 600 kHz and 300 kHz.</p>
</sec>
<sec id="s2d4">
<label>2.4.4.</label>
<title>Data logging</title>
<p>In this instance the system has been equipped with a controller board for logging data. The core component of this board is a K64F microcontroller which implements three SPI interfaces (as shown in <xref rid="fig7" ref-type="fig">Figure 7</xref>) which receive data from the wired connection and from the FPGA and also enables control of the FPGA for recovery on power cycling.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><p>Data (red lines) and configuration (blue lines) flow between the head mounted modules.</p></caption>
<graphic xlink:href="186627_fig7.tif"/>
</fig>
<p>The microcontroller receives data and uses a Direct Memory Access (DMA) channel to pass the data to the micro-SD card via an SDHC interface. For system validation purposes the aim was to record all raw and spike sorted data, as such the data output rate of the system was <italic>&#x223C;</italic>11 Mbps. This may not at first seem challenging (any class 10 SD card can write at 80 Mbps), however, the latency of typical SD cards can exceed 100 ms and presents a substantial challenge due to the data buffering requirements and limited memory on a microcontroller. As a result this system required careful code optimisation to maximise the memory available for buffering and align writing block size with sectors; and this combined with a U3 grade micro-SD card (with an average latency around 10 ms) ensured data integrity in repeated long term testing. Since the total amount of data generated for 24 hours is approximately 109 GB<xref rid="fn1" ref-type="fn">&#x2021;</xref>, a 128 GB card is required and the exFAT file system was used to enable large multi gigabyte files to be stored.</p>
</sec>
</sec>
<sec id="s2e">
<label>2.5.</label>
<title>Computer interface</title>
<p>The system can be tethered to a PC using the Data Interface board which converts between an SPI interface and USB 3.0. A USB 3.0 interface is not required for 32 channels, however, the board was designed to be scalable by connecting up to 32 Neural Interface boards simultaneously in parallel &#x2013; supporting up to 1,024 channels of raw and spike sorted data and increasing the total data rate to approximately 350 Mbps. In order to handle this high data rate, each bit sent over the 32 parallel MISO data lines from these boards is read in as a 4 byte word and this data is communicated directly to the USB interface using a DMA channel.</p>
</sec>
</sec>
<sec id="s3">
<label>3.</label>
<title>Results</title>
<sec id="s3a">
<label>3.1.</label>
<title>System specification tests</title>
<p>The system was tested with benchtop equipments including a neural signal generator before <italic>in-vivo</italic> deployment. The hardware performance is summarised in <xref rid="tbl2" ref-type="table">Table 2</xref>.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>Specifications for key components</p></caption>
<graphic xlink:href="186627_tbl2.tif"/>
</table-wrap>
<p>Data integrity was tested by replacing the ADC&#x2019;s output data with a simple counter on the FPGA &#x2013; giving a known signal with the same data bandwidth as in real recording &#x2013; and checking the sequence stored on the SD-card. A battery of 5200 mAh supports recording up to <italic>&#x223C;</italic>52 hours when recording both spike events and the raw neural signal. This differs from a simple calculation of battery capacity divided by measured power consumption due to the dropping battery output voltage over a discharge cycle.</p>
</sec>
<sec id="s3b">
<label>3.2.</label>
<title>In-vivo recording</title>
<p>The system was validated <italic>in-vivo</italic> in a rhesus macaque with moveable microwire electrodes (50 <italic>&#x00B5;</italic>m tungsten, tip-impedence <italic>&#x223C;</italic>500 k&#x2126;) [<xref rid="c18" ref-type="bibr">18</xref>] implanted into the motor cortex (M1) and protected with surgical cement and a skull mounted titanium case. A cradle to hold the platform was 3D-printed to fit inside the head case as shown in <xref rid="fig8" ref-type="fig">Figure 8</xref>. All experiments were approved by the local ethics committee and performed under appropriate UK Home Office licenses in accordance with the Animals (Scientific Procedures) Act 1986.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8.</label>
<caption><p>Experimental setup for the 24 hour recordings with a rhesus monkey. 12 tungsten wire electrodes are connected to the recording module. A cap with battery included was secured on top of the cradle.</p></caption>
<graphic xlink:href="186627_fig8.tif"/>
</fig>
<p>Two 24-hour sessions were performed. In the first session, the system was configured to record only action potentials with on-line spike sorting. Once configured, the system was left recording for a 24 hour duration while the monkey was freely moving in her home cage. A total of 12 electrodes were connected across which 21 different cells were detected. The channel with the most units detected (#5) is shown in <xref rid="fig9" ref-type="fig">Figure 9</xref>. A two minute initial recording was used for clustering and 4 different templates were generated. Template 4 was merged into template 1 due to a close similarity. <xref rid="fig10" ref-type="fig">Figure 10</xref> shows the resulting 3 spike templates (with the first 1,000 matched spikes) together with firing rates and inter-spike intervals (ISI) for channel #5 during the 24-hour session. The changes in firing rate during sleep can be clearly marked. It can however also be observed (from the ISI diagrams) that for this channel templates T1, T2 or T3 may contain more than one cell. An off-line analysis with Wave Clus yielded similar results demonstrating that this particular channel is challenging to sort for both online and offline sorters. <xref rid="fig11" ref-type="fig">Figure 11</xref> shows a different recording channel (#3) where two units can be clearly identified.</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9.</label>
<caption><p>Extracellular neural recording (for channel #5) showing sorted spike events (in real-time) during the first 24 hour session. (a) and (b) are spike events and neural signal for the whole recordings showing consistent amplitude and constant operation throughout; (c) and (d) show a 30 s segment as marked by the dashed red line; Templates (e) generated using 2 min recording before the experiment using Wave Clus.</p></caption>
<graphic xlink:href="186627_fig9.tif"/>
</fig>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10.</label>
<caption><p>Example spike event data (for channel #5) generated the during the first 24 hour recording session. Shown are: (a) peak aligned and sorted first 1000 matched spikes and the characteristic templates; (b) spike firing rates averaged over 1 second (light blue) and 1 minute (black); and (c) Inter-Spike Interval (ISI).</p></caption>
<graphic xlink:href="186627_fig10.tif"/>
</fig>
<fig id="fig11" position="float" fig-type="figure">
<label>Figure 11.</label>
<caption><p>Example spike event data (for channel #3) generated the during the first 24 hour recording session. Shown are: (a) peak aligned and sorted first 1000 matched spikes and the characteristic templates; (b) spike firing rates averaged over 1 second (light blue) and 1 minute (black); and (c) Inter-Spike Interval (ISI).</p></caption>
<graphic xlink:href="186627_fig11.tif"/>
</fig>
<p>In the second session, the micro-SD card was replaced during a behavioural training session and the system was configured to record both action potentials and LFPs. The LFP signal and its spectrogram are shown in <xref rid="fig12" ref-type="fig">Figure 12</xref>. The increased power in the low frequency (<italic>&#x003C;</italic>20 Hz) can be attributed to the activity expected during sleep. The hours of sleep are consistent with the period identified previously and individual sleep cycles can be observed.</p>
<fig id="fig12" position="float" fig-type="figure">
<label>Figure 12.</label>
<caption><p>(a) Calculated spectrogram with sleep onset and cessation annotated; (b) Recorded LFP signal with magnified insets.</p></caption>
<graphic xlink:href="186627_fig12.tif"/>
</fig>
</sec>
<sec id="s3c">
<label>3.3.</label>
<title>Power consumption</title>
<p>The power consumption was measured using an Agilent N6782A SMU (source measure unit) instrument. The idle power consumption was 52.83 mW (with SD card inserted) rising to a maximum of 99.45 mW when saving both the raw neural signal and spike event data to the SD card. The power when saving only spike events is 61.94 mW. A breakdown of the measured power budget is shown in <xref rid="fig13" ref-type="fig">Figure 13</xref>. Apart from the FPGA core which is running at 1.5 V, all other I/O and chips are running at 3.3 V. It should be noted that the idle current consumption is dominated by the microcontroller (<italic>&#x223C;</italic>82&#x0025; of idle power) and that the power consumed by the spike sorting FPGA is minimal (<italic>&#x003C;</italic>5.8&#x0025; power in the worst case spike sorting only mode).</p>
<fig id="fig13" position="float" fig-type="figure">
<label>Figure 13.</label>
<caption><p>Breakdown of the current consumption for different modes of operation.</p></caption>
<graphic xlink:href="186627_fig13.tif"/>
</fig>
</sec>
<sec id="s3d">
<label>3.4.</label>
<title>Data Reduction</title>
<p>The data storage required for recording the raw digitised neural signal for 24 hours for all 32-channels (excluding data encoding) is 32 channels <italic>&#x00D7;</italic> 15800 samples<italic>/</italic>s <italic>&#x00D7;</italic> 10bit<italic>/</italic>sample <italic>&#x00D7;</italic> 3600 seconds <italic>&#x00D7;</italic> 24 <italic>&#x00F7;</italic> 8 = 54.6048 GB(1)</p>
<p>Whereas the actual recorded spike sorted data size was merely 66.3 MBytes giving a data reduction factor of approximately 823.</p>
</sec>
</sec>
<sec id="s4">
<label>4.</label>
<title>Discussion</title>
<p>The system presented here successfully demonstrated 24-hour on-node spike sorting and captured valuable data during untethered sleep showing characteristic patterns of reduced motor cortex spiking activity and patterns of modulation of LFP power spectral density This small and low power device enables massive data compression (and hence power reduction) while also providing triggers that could be invaluable for other event driven systems.</p>
<p>The spike sorting front end was paired in this instance with miniaturised SD-card logging due to a desire to reliably record neural signal and spike sorted data from our 32-channel headstage for validation purposes while minimising power consumption and hence battery size and weight for 24-hour trials. Our estimates of likely power consumption (see <xref rid="fig14" ref-type="fig">Figure 14</xref>) indicated that flash memory represented the lowest power off-the-shelf solution to our data logging needs and also demonstrated the Significant impact that spike sorting can have on system logging capability, power consumption and battery lifetime. <xref rid="tbl3" ref-type="table">Table 3</xref> shows a comparison to similar platforms.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><p>Comparison with the State-of-the-Art</p></caption>
<graphic xlink:href="186627_tbl3.tif"/>
</table-wrap>
<fig id="fig14" position="float" fig-type="figure">
<label>Figure 14.</label>
<caption><p>Estimate of power consumption for transmission (by Bluetooth Low Energy or WiFi 802.11g/ac) or local logging of data for exponentially increasing numbers of channels of neural signal or spike sorted data. Key assumptions include: a sampling rate of 16 kHz and an average spike rate of 10 spikes/s/channel. Wifi power estimates are based on a minimum range and low congestion scenario with <italic>&#x003C;</italic>100 ms packet latency.</p></caption>
<graphic xlink:href="186627_fig14.tif"/>
</fig>
<sec id="s4a">
<label>4.1.</label>
<title>Expandability</title>
<p>Underpinning our design was the desire to create a device that rather than simply demonstrating technology, will actually be used on a day to day basis by widespread neuroscience groups. As such the system has been designed to be highly flexible and enables us to rapidly extend capability by adding, for example, a bidirectional wireless link or interfacing with a neuromodulation device. For instance, 2 Mbps supported by nRF52832 microcontroller is sufficient for streaming 7-channels of neural signal sampling at 16 kS/s with a resolution of 10-bit or 79-channels of spike events firing at 10 Hz. The microcontroller can also further processed the spike events or raw neural signal.</p>
</sec>
<sec id="s4b">
<label>4.2.</label>
<title>Recording duration</title>
<p>For compact system like the one presented here, its maximum continuous operating hours is typically limited by the capacity of the battery and/or the data storage media. This is a complex function of recording mode, number of channels enabled, filter and ADC settings and spike rate. In our case, for all 32-channels used for continuous recording in signal &#x002B; events mode, a maximum 50.97 hours was measured. The total data storage required is 185.5 GB which doesn&#x2019;t require a change of SD card. If all 32 channels operate records only spike events, the benchmarks are projected to 81.87 hours continuous recording and 225 MB of data based on the power and data reduction ratio reported in Section 3.</p>
<p>In both cases, the 5200 mAh battery used was not fully discharged but the system stopped at 3.65 V due to the required overhead of our regulators. If high efficiency DC-DC regulators are used and a 400 GB micro-SD card (the highest capacity currently available), then maximum continuous recording time for 32-channels in signal &#x002B; events modes will be <italic>&#x223C;</italic>107 hours (limited by data storage) and <italic>&#x223C;</italic>156.8 hours (limited by battery) respectively. If the system is however operated in spike events mode (i.e. recording, spike sorting, and storing only the classified spike event times), both the system power consumption (<xref rid="fig13" ref-type="fig">Fig. 13</xref>) and memory requirements are Significantly reduced, resulting in a continuous operating time of <italic>&#x223C;</italic>252 hours (around 10.5 days) that is limited only by battery.</p>
</sec>
<sec id="s4c">
<label>4.3.</label>
<title>Future work</title>
<p>Technological advances mean that there are already substantial improvements we will be making to our system design. In particular it is worth noting that all the spike detection and sorting in this system was performed on a small (5 mm <italic>&#x00D7;</italic> 5 mm), low power and relatively old technology (130 nm) FPGA, however, technology scaling offers Significant potential to increase the channel count while also reducing the power consumption and footprint. Indeed we have since successfully ported the code to an FPGA family offering 6 times smaller footprint, 30 times as much memory (a key limiting factor on channel count) and 3 times lower core power consumption. Moving to an Application Specific Integrated Circuit (ASIC) design could offer a further step change in system performance and capability. Similarly the microcontroller core power consumption tracks with the technology and reducing the current consumption to a small fraction of its current level is feasible.</p>
<p>Changes to the front end (signal conditioning) ASIC are another aspect with potential for system-wide impact [<xref rid="c24" ref-type="bibr">24</xref>, <xref rid="c25" ref-type="bibr">25</xref>]. The current front end is designed for generic biopotential recording and as a result its core power consumption is unnecessarily high (for this application). Power consumption could also be greatly reduced by moving the spike detection into the front end as this could reduce the data rate output at this stage by around 2 orders of magnitude [<xref rid="c26" ref-type="bibr">26</xref>, <xref rid="c27" ref-type="bibr">27</xref>]. Performing spike detection was a key motivator for choosing an FPGA (due to the parallel nature of spike detection) and utilised around 50&#x0025; of the FPGA resource, therefore moving spike detection to the front end potentially enables efficient microcontroller based spike sorting or reduces the FPGA requirements and required clock speed.</p>
<p>In the near term we are looking at a variety of algorithm enhancements that could improve template matching performance (e.g. by pre-manipulation of the templates [<xref rid="c28" ref-type="bibr">28</xref>]) or identify and potentially track changes in templates due to electrode drift and fibrous encapsulation &#x2013; reducing calibration requirements and enhancing system performance for chronic recordings. While in the long term we would look to leverage commercial technology scaling to enable integration of on-line naive spike sorting for hundreds of channels &#x2013; scaling, enhancing and making viable existing approaches [<xref rid="c29" ref-type="bibr">29</xref>, <xref rid="c30" ref-type="bibr">30</xref>].</p>
</sec>
</sec>
<sec id="s5">
<label>5.</label>
<title>Conclusion</title>
<p>Challenges abound for delivering the next generation of neural interface technology. As the number of recording channels increases by orders of magnitude so too will the data rate as well as the power required for data transmission and the storage requirements. It is therefore clear that simply scaling existing electrode arrays, connectors, electronic designs or wireless bandwidth will not deliver the performance required in future and that fundamentally new approaches are required. Spike sorting on the node is a key enabling capability in dealing with the coming data barrage and for creating untethered BMIs and closed loop event driven neuromodulation. The system presented here represents our first efforts to deploy this capability into the neuroscience community.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgement</title>
<p>This research is funded by Engineering and Physical Sciences Research Council (EPSRC) EP/I000569/1, EP/H051570/1, EP/H051651/1, EP/K015060/1. We thank Dr. Jennifer Tulip and Dr. Wei Xu from Newcastle University for their support on <italic>in-vivo</italic> experiments and data analysis.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><surname>Schwarz</surname> <given-names>D A</given-names></string-name>, <string-name><surname>Lebedev</surname> <given-names>M A</given-names></string-name>, <string-name><surname>Hanson</surname> <given-names>T L</given-names></string-name>, <string-name><surname>Dimitrov</surname> <given-names>D F</given-names></string-name>, <string-name><surname>Lehew</surname> <given-names>G</given-names></string-name>, <string-name><surname>Meloy</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rajangam</surname> <given-names>S</given-names></string-name>, <string-name><surname>Subramanian</surname> <given-names>V</given-names></string-name>, <string-name><surname>Ifft</surname> <given-names>P J</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Z</given-names></string-name> <etal>et al.</etal> <year>2014</year> <article-title>Chronic, wireless recordings of large-scale brain activity in freely moving rhesus monkeys</article-title> <source>Nature Methods</source> <volume>11</volume> <fpage>670</fpage>&#x2013;<lpage>676</lpage></mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><surname>Yeon</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mirbozorgi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ash</surname> <given-names>B</given-names></string-name>, <string-name><surname>Eckhardt</surname> <given-names>H</given-names></string-name> and <string-name><surname>Ghovanloo</surname> <given-names>M</given-names></string-name> <year>2016</year> <article-title>Fabrication and Microassembly of a mm-Sized Floating Probe for a Distributed Wireless</article-title> <source>Neural Interface Micromachines</source> <volume>7</volume> <fpage>154</fpage> ISSN <issn>2072-666X</issn></mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><surname>Ando</surname> <given-names>H</given-names></string-name>, <string-name><surname>Takizawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Yoshida</surname> <given-names>T</given-names></string-name>, <string-name><surname>Matsushita</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hirata</surname> <given-names>M</given-names></string-name> and <string-name><surname>Suzuki</surname> <given-names>T</given-names></string-name> <year>2016</year> <article-title>Wireless Multichannel Neural Recording With a 128-Mbps UWB Transmitter for an Implantable Brain-Machine Interfaces</article-title> <source>IEEE Transactions on Biomedical Circuits and Systems</source> <volume>10</volume> <fpage>1068</fpage>&#x2013;<lpage>1078</lpage> ISSN <issn>1932-4545</issn></mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="website"><string-name><surname>Bargmann</surname> <given-names>C</given-names></string-name>, <string-name><surname>Newsome</surname> <given-names>W</given-names></string-name>, <string-name><surname>Anderson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>E</given-names></string-name>, <string-name><surname>Deisseroth</surname> <given-names>K</given-names></string-name>, <string-name><surname>Donoghue</surname> <given-names>J</given-names></string-name>, <string-name><surname>MacLeish</surname> <given-names>P</given-names></string-name>, <string-name><surname>Marder</surname> <given-names>E</given-names></string-name>, <string-name><surname>Normann</surname> <given-names>R</given-names></string-name>, <string-name><surname>Sanes</surname> <given-names>J</given-names></string-name> <etal>et al.</etal> <year>2014</year> <source>Brain 2025: a scientific vision Brain Research Through Advancing Innovative Neurotechnologies (BRAIN) Working Group Report to the Advisory Committee to the Director, NIH</source>. Available online at: <ext-link ext-link-type="uri" xlink:href="http://www.nih.gov/science/brain/2025/">http://www.nih.gov/science/brain/2025/</ext-link>(<publisher-name>US National Institutes of Health</publisher-name>, 2014)</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname> <given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>M</given-names></string-name>, <string-name><surname>Xiong</surname> <given-names>T</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>A G</given-names></string-name>, <string-name><surname>Lucas</surname> <given-names>T H</given-names></string-name>, <string-name><surname>Chin</surname> <given-names>P S</given-names></string-name>, <string-name><surname>Etienne-Cummings</surname> <given-names>R</given-names></string-name>, <string-name><surname>Tran</surname> <given-names>T D</given-names></string-name>, <string-name><surname>Van Der Spiegel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>X</given-names></string-name>, <string-name><surname>Van Der</surname> <given-names>J</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>A G</given-names></string-name> and <string-name><surname>Lucas</surname> <given-names>T H</given-names></string-name> <year>2016</year> <article-title>A Fully Integrated Wireless Compressed Sensing Neural Signal Acquisition System for Chronic Recording and Brain Machine Interface IEEE Transactions on</article-title> <source>Biomedical Circuits and Systems</source> <volume>10</volume></mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>Aziz</surname> <given-names>J N</given-names></string-name>, <string-name><surname>Abdelhalim</surname> <given-names>K</given-names></string-name>, <string-name><surname>Shulyzki</surname> <given-names>R</given-names></string-name>, <string-name><surname>Genov</surname> <given-names>R</given-names></string-name>, <string-name><surname>Bardakjian</surname> <given-names>B L</given-names></string-name>, <string-name><surname>Derchansky</surname> <given-names>M</given-names></string-name>, <string-name><surname>Serletis</surname> <given-names>D</given-names></string-name> and <string-name><surname>Carlen</surname> <given-names>P L</given-names></string-name> <year>2009</year> <article-title>256-channel neural recording and delta compression microsystem with 3D electrodes</article-title> <source>IEEE Journal of Solid-State Circuits</source> <volume>44</volume> <fpage>995</fpage>&#x2013;<lpage>1005</lpage></mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Kamboh</surname> <given-names>A M</given-names></string-name>, <string-name><surname>Raetz</surname> <given-names>M</given-names></string-name>, <string-name><surname>Oweiss</surname> <given-names>K G</given-names></string-name> and <string-name><surname>Mason</surname> <given-names>A</given-names></string-name> <year>2007</year> <article-title>Area-power efficient VLSI implementation of multichannel DWT for data compression in implantable neuroprosthetics</article-title> <source>IEEE Transactions on Biomedical Circuits and Systems</source> <volume>1</volume> <fpage>128</fpage>&#x2013;<lpage>135</lpage></mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Chae</surname> <given-names>M S</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Yuce</surname> <given-names>M R</given-names></string-name>, <string-name><surname>Hoang</surname> <given-names>L</given-names></string-name> and <string-name><surname>Liu</surname> <given-names>W</given-names></string-name> <year>2009</year> <article-title>A 128-channel 6mW wireless neural recording IC with spike feature extraction and UWB transmitter</article-title> <source>IEEE Transactions on Neuralystems and Rehabilitation Engineering</source> <volume>17</volume> <fpage>312</fpage>&#x2013;<lpage>321</lpage></mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><surname>Karkare</surname> <given-names>V</given-names></string-name>, <string-name><surname>Gibson</surname> <given-names>S</given-names></string-name> and <string-name><surname>Markovic</surname> <given-names>D</given-names></string-name> <year>2011</year> <article-title>A 130&#x03BC;W, 64-channel neural spike-sorting DSP chip</article-title> <source>IEEE Journal of Solid-State Circuits</source> <volume>46</volume> <fpage>1214</fpage>&#x2013;<lpage>1222</lpage></mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><surname>Rizk</surname> <given-names>M</given-names></string-name>, <string-name><surname>Obeid</surname> <given-names>I</given-names></string-name>, <string-name><surname>Callender</surname> <given-names>S H</given-names></string-name> and <string-name><surname>Wolf</surname> <given-names>P D</given-names></string-name> <year>2007</year> <article-title>A single-chip signal processing and telemetry engine for an implantable 96-channel neural data acquisition system</article-title> <source>Journal of Neural Engineering</source> <volume>4</volume> <fpage>309</fpage></mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="other"><string-name><surname>Eftekhar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Paraskevopoulou</surname> <given-names>S E</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2010</year> <article-title>Towards a next generation neural interface: Optimizing power, bandwidth and data quality Biomedical Circuits and Systems Conference (BioCAS), 2010</article-title> <source>IEEE (IEEE)</source> pp <fpage>122</fpage>&#x2013;<lpage>125</lpage></mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><surname>Quian Quiroga</surname> <given-names>R</given-names></string-name> <year>2012</year> <article-title>Spike sorting</article-title> <source>Current Biology</source> <volume>22</volume> <fpage>R45</fpage>&#x2013;<lpage>R46</lpage></mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><surname>Rey</surname> <given-names>H G</given-names></string-name>, <string-name><surname>Pedreira</surname> <given-names>C</given-names></string-name> and <string-name><surname>Quian Quiroga</surname> <given-names>R</given-names></string-name> <year>2015</year> <article-title>Past, present and future of spike sorting techniques</article-title> <source>Brain Research Bulletin</source> <volume>119</volume> <fpage>106</fpage>&#x2013;<lpage>117</lpage></mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Kamboh</surname> <given-names>A M</given-names></string-name> and <string-name><surname>Mason</surname> <given-names>A J</given-names></string-name> <year>2013</year> <article-title>Computationally efficient neural feature extraction for spike sorting in implantable high-density recording systems</article-title> <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source> <volume>21</volume> <fpage>1</fpage>&#x2013;<lpage>9</lpage></mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><surname>Barsakcioglu</surname> <given-names>D Y</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2016</year> <article-title>A 32-channel mcu-based feature extraction and classification for scalable on-node spike sorting Circuits and Systems (ISCAS), 2016</article-title> <source>IEEE International Symposium on (IEEE)</source> pp <fpage>1310</fpage>&#x2013;<lpage>1313</lpage></mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><surname>Navajas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Barsakcioglu</surname> <given-names>D Y</given-names></string-name>, <string-name><surname>Eftekhar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jackson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> and <string-name><given-names>Quian</given-names> <surname>Quiroga</surname></string-name> R <year>2014</year> <article-title>Minimum requirements for accurate and efficient real-time on-chip spike sorting</article-title> <source>Journal of Neuroscience Methods</source> <volume>230</volume> <fpage>51</fpage>&#x2013;<lpage>64</lpage></mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="other"><string-name><surname>Williams</surname> <given-names>I</given-names></string-name>, <string-name><surname>Luan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jackson</surname> <given-names>A</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2015</year> <article-title>A scalable 32-channel neural recording and real-time FPGA based spike sorting system Biomedical Circuits and Systems Conference (BioCAS), 2016</article-title> <source>IEEE</source> pp <fpage>188</fpage>&#x2013;<lpage>191</lpage></mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><surname>Jackson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mavoori</surname> <given-names>J</given-names></string-name> and <string-name><surname>Fetz</surname> <given-names>E E</given-names></string-name> <year>2007</year> <article-title>Correlations between the same motor cortex cells and arm muscles during a trained task, free behavior, and natural sleep in the macaque monkey</article-title> <source>Journal of neurophysiology</source> <volume>97</volume> <fpage>360</fpage>&#x2013;<lpage>374</lpage></mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Quian Quiroga</surname> <given-names>R</given-names></string-name>, <string-name><surname>Nadasdy</surname> <given-names>Z</given-names></string-name> and <string-name><surname>Ben-Shaul</surname> <given-names>Y</given-names></string-name> <year>2004</year> <article-title>Unsupervised spike detection and sorting with wavelets and superparamagnetic clustering</article-title> <source>Neural Computation</source> <volume>16</volume> <fpage>1661</fpage>&#x2013;<lpage>1687</lpage></mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Obeid</surname> <given-names>I</given-names></string-name> and <string-name><surname>Wolf</surname> <given-names>P D</given-names></string-name> <year>2004</year> <article-title>Evaluation of spike-detection algorithms fora brain-machine interface application</article-title> <source>IEEE Transactions on Biomedical Engineering</source> <volume>51</volume> <fpage>905</fpage>&#x2013;<lpage>911</lpage></mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><surname>Miranda</surname> <given-names>H</given-names></string-name>, <string-name><surname>Gilja</surname> <given-names>V</given-names></string-name>, <string-name><surname>Chestek</surname> <given-names>C a</given-names></string-name>, <string-name><surname>Shenoy</surname> <given-names>K V</given-names></string-name> and <string-name><surname>Meng</surname> <given-names>T H</given-names></string-name> <year>2010</year> <article-title>HermesD: a high-rate long-range wireless transmission system for simultaneous multichannel neural recording applications</article-title> <source>IEEE Transactions on Biomedical Circuits and Systems</source> <volume>4</volume> <fpage>181</fpage>&#x2013;<lpage>191</lpage> ISSN <issn>1932-4545</issn></mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><surname>Zanos</surname> <given-names>S</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>A G</given-names></string-name>, <string-name><surname>Shupe</surname> <given-names>L</given-names></string-name>, <string-name><surname>Miles</surname> <given-names>F P</given-names></string-name> and <string-name><surname>Fetz</surname> <given-names>E E</given-names></string-name> <year>2011</year> <article-title>The Neurochip-2: an autonomous head-_xed computer for recording and stimulating in freely behaving monkeys</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source> <volume>19</volume> <fpage>427</fpage>&#x2013;<lpage>35</lpage> ISSN <issn>1558-0210</issn></mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><surname>Kinney</surname> <given-names>J P</given-names></string-name>, <string-name><surname>Bernstein</surname> <given-names>J G</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>A J</given-names></string-name>, <string-name><surname>Barber</surname> <given-names>J B</given-names></string-name>, <string-name><surname>Bolivar</surname> <given-names>M</given-names></string-name>, <string-name><surname>Newbold</surname> <given-names>B</given-names></string-name>, <string-name><surname>Scholvin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Moore-Kochlacs</surname> <given-names>C</given-names></string-name>, <string-name><surname>Wentz</surname> <given-names>C T</given-names></string-name>, <string-name><surname>Kopell</surname> <given-names>N J</given-names></string-name> and <string-name><surname>Boyden</surname> <given-names>E S</given-names></string-name> <year>2015</year> <article-title>A direct-to-drive neural data acquisition system</article-title> <source>Frontiers in Neural Circuits</source> <volume>9</volume> ISSN <issn>1662-5110</issn></mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Barsakcioglu</surname> <given-names>D Y</given-names></string-name>, <string-name><surname>Eftekhar</surname> <given-names>A</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2013</year> <article-title>Design optimisation of front-end neural interfaces for spike sorting systems Circuits and Systems (ISCAS), 2013</article-title> <source>IEEE International Symposium on (IEEE)</source> pp <fpage>2501</fpage>&#x2013;<lpage>2504</lpage></mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><surname>Barsakcioglu</surname> <given-names>D Y</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Bhunjun</surname> <given-names>P</given-names></string-name>, <string-name><surname>Navajas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Eftekhar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jackson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Quian Quiroga</surname> <given-names>R</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2014</year> <article-title>An analogue front-end model for developing neural spike sorting systems</article-title> <source>IEEE Transactions on Biomedical Circuits and Systems</source> <volume>8</volume> <fpage>216</fpage>&#x2013;<lpage>227</lpage></mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><surname>Luan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>I</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2016</year> <article-title>An event-driven soc for neural recording Biomedical Circuits and Systems Conference (BioCAS</article-title>), 2016 <source>IEEE (IEEE)</source> pp <fpage>404</fpage>&#x2013;<lpage>407</lpage></mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="other"><string-name><surname>Liu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Luan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>I</given-names></string-name>, <string-name><surname>Rapeaux</surname> <given-names>A</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2017</year> <article-title>(accepted, in press) A 64-channel versatile neural recording SoC with activity dependent data throughput</article-title> <source>IEEE Transactions on Biomedical Circuits and Systems</source></mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><surname>Frehlick</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>I</given-names></string-name> and <string-name><surname>Constandinou</surname> <given-names>T G</given-names></string-name> <year>2016</year> <article-title>Improving neural spike sorting performance using template enhancement Biomedical Circuits and Systems Conference (BioCAS), 2016</article-title> <source>IEEE (IEEE)</source> pp <fpage>524</fpage>&#x2013;<lpage>527</lpage></mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><surname>Rutishauser</surname> <given-names>U</given-names></string-name>, <string-name><surname>Schuman</surname> <given-names>E M</given-names></string-name> and <string-name><surname>Mamelak</surname> <given-names>A N</given-names></string-name> <year>2006</year> <article-title>Online detection and sorting of extracellularly recorded action potentials in human medial temporal lobe recordings, in vivo</article-title> <source>Journal of neuroscience methods</source> <volume>154</volume> <fpage>204</fpage>&#x2013;<lpage>224</lpage></mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><surname>Karkare</surname> <given-names>V</given-names></string-name>, <string-name><surname>Gibson</surname> <given-names>S</given-names></string-name> and <string-name><surname>Markovic</surname> <given-names>D</given-names></string-name> <year>2013</year> <article-title>A 75_W, 16-Channel Neural Spike-Sorting Processor With Unsupervised Clustering</article-title> <source>IEEE Journal of Solid-State Circuits</source> <volume>48</volume> <fpage>2230</fpage>&#x2013;<lpage>2238</lpage> ISSN <issn>0018-9200</issn></mixed-citation></ref>
</ref-list>
<fn-group>
<fn id="fn1"><label>&#x2021;</label><p>If logging all data including both the raw signal and sorted spike events.</p></fn>
</fn-group>
</back>
</article>