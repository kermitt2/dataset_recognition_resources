<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/251140</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>NormExpression: an R package to normalize gene expression data using evaluated methods</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Wu</surname> <given-names>Zhenfeng</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">&#x0024;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Liu</surname> <given-names>Weixiang</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Ji</surname> <given-names>Haishuo</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Yu</surname> <given-names>Deshui</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Wang</surname> <given-names>Hua</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Lin</surname> <given-names>Liu</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Ruan</surname> <given-names>Jishou</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Gao</surname> <given-names>Shan</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1">
<label>1</label><institution>School of Mathematical Sciences, Nankai University</institution>, Tianjin 300071, P.R.<country>China</country>.
</aff>
<aff id="a2">
<label>2</label><institution>College of Life Sciences, Nankai University</institution>, Tianjin, Tianjin 300071, P.R.<country>China</country>.
</aff>
<aff id="a3">
<label>3</label><institution>School of Biomedical Engineering, Health Science Center, Shenzhen University</institution>, Shenzhen 518060, P.R.<country>China</country>.
</aff>
<aff id="a4">
<label>4</label><institution>Guangdong Provincial Key Laboratory of Biomedical Measurements and Ultrasound Imaging</institution>, Shenzhen 518060, P.R.<country>China</country>.
</aff>
<aff id="a5">
<label>5</label><institution>Institute of Statistics, Nankai University</institution>, Tianjin 300071, P.R.<country>China</country>.
</aff>
<aff id="a6">
<label>6</label><institution>State Key Laboratory of Medicinal Chemical Biology, Nankai University</institution>, Tianjin 300071, P.R.<country>China</country>.
</aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>&#x0024;</label><p>These authors contributed equally to this paper.</p></fn>
<corresp id="cor1"><label>&#x002A;</label> The corresponding authors.</corresp>
<fn id="n2"><p>SG: <email>gao_shan@mail.nankai.edu.cn</email></p></fn>
<fn id="n3"><p>JR: <email>jsruan@nankai.edu.cn</email></p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>251140</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>20</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>1</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="251140.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Data normalization is a crucial step in the gene expression analysis as it determines the validity of its downstream analyses. Although many metrics has been designed to evaluate the relative success of these methods, the results by different metrics did not show consistency. Based on the previous work, we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) to evaluate 13 commonly used normalization methods and achieved consistency in our evaluation results using both bulk RNA-seq and scRNA-seq data from the same library construction protocol. These gene expression data, normalization methods and evaluation metrics have been included in an R package named NormExpression. NormExpression provides a framework for researchers to select normalization methods with a fast and simple way to evaluate different methods, particularly some data-driven methods or their own methods.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keyword</title>
<kwd>gene expression</kwd>
<kwd>normalization</kwd>
<kwd>evaluation</kwd>
<kwd>R package</kwd>
<kwd>scRNA-seq</kwd>
</kwd-group>
<counts>
<page-count count="14"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Global gene expression analysis provides quantitative information about the population of RNA species in cells and tissues [<xref rid="c1" ref-type="bibr">1</xref>]. High-throughput technologies to measure global gene expression levels started with Serial Analysis of Gene Expression method (SAGE) and are widely used with microarray and RNA-seq [<xref rid="c2" ref-type="bibr">2</xref>]. Recently, single-cell RNA sequencing (scRNA-seq) has been used to simultaneously measure the expression levels of genes from a single-cell and to provide a higher resolution of cellular differences than bulk RNA-seq, which can only produce an expression value for each gene by averaging its expression levels across a large population of cells [<xref rid="c3" ref-type="bibr">3</xref>]. Gene expression raw data from these high-throughput technologies must be normalized to remove technical variation so that meaningful biological comparisons can be made. Data normalization is a crucial step in the gene expression analysis as it determines the validity of its downstream analyses. Although the significance of gene expression data normalization has been demonstrated [<xref rid="c4" ref-type="bibr">4</xref>], how to successfully select a normalization method is still a controversial problem, particularly for scRNA-seq data.</p>
<p>Basically, two classes of methods are available to normalize gene expression data. They are the control-based normalization and the average-bulk normalization. The former class of methods assumes the total expression level summed over a small group of genes is approximately the same across all the samples. The latter class of methods assumes most of genes are not Differentially Expressed (DE) genes across all the samples. The control-based normalization often uses RNA from a group of internal control genes (<italic>e.g.</italic> housekeeping genes) or external spike-in RNA (<italic>e.g.</italic> ERCC RNA [<xref rid="c5" ref-type="bibr">5</xref>]), while the average-bulk normalization is more commonly used for their universality. Five average-bulk normalization methods designed to normalize bulk RNA-seq data are library size, median of the ratios of observed counts that is also referred to as the DESeq method [<xref rid="c6" ref-type="bibr">6</xref>], Relative Log Expression (RLE), upperquartile (UQ) and Trimmed Mean of M values (TMM) [<xref rid="c7" ref-type="bibr">7</xref>]. Recently, three new methods have been introduced as Total Ubiquitous (TU), Network Centrality Scaling (NCS) and Evolution Strategy (ES) with best performance among 15 tested methods [<xref rid="c8" ref-type="bibr">8</xref>].</p>
<p>Although many metrics has been designed to evaluate the relative success of these methods, the results by different metrics did not show consistency. In 2013, Gustavo <italic>et al.</italic> designed two novel and mutually independent metrics to evaluate 15 normalization methods and achieved consistent results using bulk RNA-seq data [<xref rid="c8" ref-type="bibr">8</xref>]. Based on their work, we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) and tested it using both bulk RNA-seq and scRNA-seq data from the same library construction protocol. As a result, the evaluation by both our metric AUCVC and their metrics achieved consistency. On the other hand, with many new normalization methods developed, researchers need a fast and simple way to evaluate different methods, particularly some data-driven methods or their own methods rather than obtain information from published evaluation results, which could have bias or mistakes, <italic>e.g.</italic> misunderstanding of RLE, UQ and TMM methods [<xref rid="c9" ref-type="bibr">9</xref>]. To satisfy this demand, we developed an R package NormExpression to include gene expression data, normalization methods and evaluation metrics used in this study and provide a framework for researchers to evaluate and select methods for the normalization of their gene expression data.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Normalization factor and library size</title>
<p>In total, 13 normalization methods (<bold>Materials and Methods</bold>) have been included in the R package NormExpression. They are Housekeeping Genes (HG7), External RNA Control Consortium (ERCC), Total Read Number (TN), Total Read Count (TC), Cellular RNA (CR), Nuclear RNA (NR), the ratios of observed counts (DESeq), Relative Log Expression (RLE), upperquartile (UQ), Trimmed Mean of M values (TMM), Total Ubiquitous (TU), Network Centrality Scaling (NCS) and Evolution Strategy (ES). Currently, all the commonly used methods are used to normalize a raw gene expression matrix (n samples by m genes) by the multiplication of a factor to each column of it and produce a normalized gene expression matrix (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). This factor is named as normalization factor in the package NormExpression or scaling factor in TU, NCS and ES methods. In NormExpression, the reciprocal of normalization factor is named as library size (<xref rid="fig1" ref-type="fig">Figure 1B</xref>), which is also named as size factor in the Bioconductor package DESeq [<xref rid="c6" ref-type="bibr">6</xref>]. Definitions of normalization factor and size factor in the Bioconductor package edgeR [<xref rid="c7" ref-type="bibr">7</xref>] are different from the definition of normalization factor in NormExpression and the definition of size factor in DESeq. RLE, UQ and TMM in edgeR produce normalization factors to adjust library sizes, which should be used to calculate the Counts Per Million (CPM) for the normalization of gene expression data and CPM should be calculated by one million multiplying reciprocals of adjusted library sizes (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). However, edgeR provides a function named calcNormFactors to produce normalization factors for library-size adjustment, which have been wrongly used for the normalization of gene expression data in many studies [<xref rid="c9" ref-type="bibr">9</xref>]. Since ES. HG7, ERCC, TN, TC, CR, NR and TU produce normalization factors by the estimation of library sizes as CPM, their normalization factors are amplified by one million for a uniform representation (<xref rid="fig1" ref-type="fig">Figure 1B</xref>) in NormExpression. DESeq, RLE, UQ and TMM have been modified to ignore zero values for both scRNA-seq and bulk RNA-seq data and the resulting normalization factors need be further normalized by their geometric mean values (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). UQ and TMM use library sizes estimated by NR. After modification, RLE is identical to DESeq. We verified that these modifications did not change the evaluation or normalization results.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption>
<title>Normalization factor and library size</title>
<p>(A). A raw gene expression matrix can be transformed into a normalized gene expression matrix by the multiplication of a factor fj to each column. Each column represents the expression levels of all genes from a sample and each row represents the expression levels of a gene across all samples. (B). HG7, ERCC, TN, TC, CR, NR and TU use library sizes Nj&#x002A; to calculate normalization factors. Nj represents the library size estimated by TC. DESeq, RLE, UQ and TMM have been modified in NormExpression to ignore zero values and the resulting normalization factors need be further normalized by their geometric mean values. After modification, RLE is identical to DESeq. Q3 means that about 75&#x0025; of genes in the jth sample have expression levels below Q3 and about 25&#x0025; have those above Q3. For all methods, log represents the natural logarithm.</p></caption>
<graphic xlink:href="251140_fig1.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Evaluation of 13 normalization methods</title>
<p>In the previous study [<xref rid="c8" ref-type="bibr">8</xref>], Gustavo <italic>et al.</italic> had quantified success of normalization methods by the number of uniform genes (<bold>Materials and Methods</bold>) and used the Coefficient of Variation (CV) cutoff 0.25 to determine the number of uniform genes for each method. This metric was designed based on the theory that the relative values among different normalization methods were quite stable, although the absolute number of uniform genes depended on the cutoff value. However, it is almost impossible to determine a CV cutoff for scRNA-seq data since the CV in scRNA-seq data has a much more large dynamic range than that in bulk RNA-seq data.</p>
<p>Inspired by Area Under the receiver operating characteristic Curve (AUC) [<xref rid="c10" ref-type="bibr">10</xref>], we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) to evaluate 13 normalization methods using one scRNA-seq dataset scRNA663 and one bulk RNA-seq dataset bkRNA18 (<bold>Materials and Methods</bold>). A single housekeeping gene GAPDH was also used for comparision in the evaluation of normalization methods using bulk RNA-seq data, but it was not available for that using scRNA-seq data due to zero counts of GAPDH in many samples. Parameter grid of non-zero ratio (<bold>Materials and Methods</bold>) from 0.2 to 0.9 for scRNA663 and from 0.8 to 1 for bkRNA18 was used to produce AUCVC values of all methods (<xref rid="fig2" ref-type="fig">Figure 2</xref>). For each non-zero ratio, TU used the maximum AUCVC, which had been determined by testing all possible combinations of presence rate, lower and upper cutoffs (<bold>Materials and Methods</bold>) at 5&#x0025; resolution. The presence rate was tested from 0.2 to 0.6 for scRNA663 and set 1 for bkRNA18. The lower cutoff was tested from 5&#x0025; to 40&#x0025; and the upper cutoff was tested from 60&#x0025; to 95&#x0025;. In addition, the calculation only considered each combination of lower and upper cutoffs which produced ubiquitous genes (<bold>Materials and Methods</bold>) more than 1,00 for scRNA663 and more than 1,000 for bkRNA18. For each non-zero ratio, NCS and ES used the ubiquitous genes produced by the TU method, when it achieved the maximum AUCVC. The raw gene expression matrix (None) was also used to produce AUCVC values for comparison.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption>
<title>Parameter grid to evaluate normalization methods</title>
<p>Parameter grid of non-zero ratio from 0.2 to 0.9 for scRNA663 and from 0.8 to 1 for bkRNA18 was used to produce AUCVC values All the normalization methods were classified into three groups based on their AUCVC values sorted in descending order using one scRNA-seq dataset scRNA663 (<bold>A</bold>) and one bulk RNA-seq dataset bkRNA18 (<bold>B</bold>).</p></caption>
<graphic xlink:href="251140_fig2.tif"/>
</fig>
<p>The evaluation results using both scRNA663 and bkRNA18 achieved consistency that all the normalization methods were classified into three groups (<xref rid="fig2" ref-type="fig">Figure 2</xref>) based on their AUCVC values sorted in descending order. The first group including TU, NCS and ES achieved the best performances using both scRNA663 and bkRNA18. The second group including ERCC, TC, CR, NR, DESeq, RLE, UQ and TMM achieved medial performances using both scRNA663 and bkRNA18. In the second group, ERCC, TC, CR and NR outperformed DESeq, RLE, UQ and TMM using scRNA663, while DESeq, RLE, UQ and TMM outperformed ERCC, TC, CR and NR using bkRNA18. The third group achieved the poorest performances, including TN and None for scRNA663 (<xref rid="fig2" ref-type="fig">Figure 2A</xref>) and HG7, GAPDH and None for bkRNA18 (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). HG7 and GAPDH achieved the poorest performances using bkRNA18, which suggested that a predefined set of housekeeping genes could not be appropriate guides for data normalization of bulk RNA-seq data. However, it could be coincidental that HG7 was classified into the first group using scRNA663. TN outperformed the second group of methods using bkRNA18 but was outperformed by the second group of methods using scRNA663.</p>
<p>The evaluation results by the medians of Spearman Correlation Coefficients (SCCs) (<bold>Materials and Methods</bold>) and the cluster analysis results were also consistent with the evaluation results by AUCVC. Generally speaking, a normalization method with a higher AUCVC value produced a lower median of Spearman Correlation Coefficients (SCCs) between normalized expression profiles of ubiquitous gene pairs using both scRNA-seq and bulk RNA-seq data. The hierarchical clustering result showed that 13 methods had been classified into the same groups (<xref rid="fig3" ref-type="fig">Figure 3CF</xref>) by SCCs between normalization factor pairs as those (<xref rid="fig2" ref-type="fig">Figure 2AB</xref>) by AUCVC. By our new designed metric AUCVC, TU, NCS and ES were evaluated as the best normalization methods using both scRNA-seq and bulk RNA-seq data, which enhanced the discovery using only bulk RNA-seq data in the previous study [<xref rid="c8" ref-type="bibr">8</xref>]. Since the non-zero ratio 0.2 allowed the maximum number of uniform genes for calculation, we presented this snapshot of evaluation results to show the consistency of the evaluation results using both scRNA663 (<xref rid="fig3" ref-type="fig">Figure 3ABC</xref>) and bkRNA18 (<xref rid="fig3" ref-type="fig">Figure 3DEF</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption>
<title>Consistency in the evaluation results by different metrics</title>
<p>A normalization method with a higher AUCVC value produced a lower median of Spearman Correlation Coefficients (SCCs) between normalized expression profiles of ubiquitous gene pairs using both scRNA-seq (<bold>AB</bold>) and bulk RNA-seq data (<bold>DE</bold>). The hierarchical clustering result showed that 13 methods had been classified into the same groups (<bold>CF</bold>) by SCCs between normalization factor pairs as those (<bold>Figure 2AB</bold>) by AUCVC.</p></caption>
<graphic xlink:href="251140_fig3.tif"/>
</fig>
</sec>
<sec id="s2c" sec-type="availability">
<title>Implementation and availability</title>
<p>The gene expression data (scRNA663 and bkRNA18), normalization methods and evaluation metrics (AUCVC and SCCs) have been included in the R package NormExpression. All the functions except the NCS and ES methods have been implemented in R programs [<xref rid="c2" ref-type="bibr">2</xref>] for their running on R platforms of any version. The NCS and ES methods had been implemented in Perl programs on the Linux system by Gustavo <italic>et al.</italic> [<xref rid="c8" ref-type="bibr">8</xref>] but they need be installed with many Perl modules. We have modified them into a stand-alone program (<bold>Supplementary file 2</bold>).</p>
<p>A quick evaluation is usually started with 10 normalization methods, which are HG7, ERCC (if available), TC, CR, NR, DESeq, RLE, UQ, TMM and TU. The quick evaluation produce AUCVC values of 10 methods and the raw gene expression matrix for users to evaluate and select methods. NCS and ES are not included in 10 methods, since they have a similar performance of TU but are much more time consuming. The non-zero ratio and presence rate can be set to 1 to calculate AUCVC for bulk RNA-seq data, while they need be set to appropriate values (default 0.2) for scRNA-seq data to avoid parameter grid. Based on our experiences, both non-zero ratio and presence rate need be set to the values to ensure that both the product of the sample number multiplying non-zero ratio and that of the sample number multiplying presence rate are larger than 100 for scRNA-seq data.</p>
</sec>
</sec>
<sec id="s3">
<title>Materials and Methods</title>
<sec id="s3d">
<title>Datasets</title>
<p>In the previous study by Lin Liu <italic>et al</italic>. (SRA: SRP113436), 663 single-cell samples and 18 bulk samples had been sequenced using the Smart-seq2 scRNA-seq protocol. In this study, we built a scRNA-seq dataset including 653 single cells from colon tumor tissues and 10 single cells from distal tissues (&#x003E;10 cm) as control. We also built a bulk RNA-seq dataset including nine samples from colon tumor tissues and nine samples from distal tissues. Samples with total read number less than 288,289 were removed in the data filtering step. The cleaning and quality control of both scRNA-seq and bulk RNA-seq data were performed using the pipeline Fastq_clean [15] that was optimized to clean the raw reads from Illumina platforms. Using the software STAR [<xref rid="c11" ref-type="bibr">11</xref>] v2.5.2b, we aligned all the cleaned scRNA-seq and bulk RNA-seq reads to the human genome GRCh38/hg38 and the expression levels of 57,992 annotated genes (57,955 nuclear genes and 37 mitochondrial genes) were quantified. Non-polyA RNAs were not discarded to test the robustness of normalization methods, although the Smart-seq2 protocol theoretically had only captured polyA RNAs. In addition, the expression levels of 92 ERCC RNA and the long non-coding RNA (lncRNA) MDL1 in human mitochondrial [<xref rid="c12" ref-type="bibr">12</xref>] were also quantified. ERCC RNA had been spiked into 208 single-cell samples before library construction, the expression levels of ERCC RNA in other 455 single-cell samples and 18 bulk samples were simulated by linear regression. Finally, two datasets were named scRNA663 (58085 &#x00D7; 663) and bkRNA18 (58085 &#x00D7; 18) and included into the R package NormExpression.</p>
</sec>
<sec id="s3e">
<title>Normalization methods</title>
<p>All 13 methods in the package NormExpression are HG7, ERCC, TN, TC, CR, NR, DESeq, RLE, UQ, TMM, TU, NCS and ES. HG7, ERCC, TN, TC, CR, NR and TU are based on a set of pre-selected genes and each of these methods uses the gene expression level summed over these pre-selected genes in a sample as the library size (<xref rid="fig1" ref-type="fig">Figure 1B</xref>) to calculate the normalization factor. HG7 includes seven genes (UBC, HMBS, TBP, GAPDH, HPRT1, RPL13A and ACTB), which had been used to achieve the best evaluation result among those using all possible combinations of tested housekeeping genes in the previous study by Gustavo <italic>et al.</italic> [<xref rid="c8" ref-type="bibr">8</xref>]. ERCC is a set of commonly used spike-in RNA consisting of 92 polyadenylated transcripts with short 3&#x2019; polyA tails but without 5&#x2019; caps [<xref rid="c5" ref-type="bibr">5</xref>]. The pre-selected genes used by HG7, ERCC, and TU are seven housekeeping genes, 92 ERCC RNA and ubiquitous genes (described below), respectively. NR only counts reads which have been aligned to nuclear genomes, while CR counts reads which have been aligned to both nuclear and mitochondrial genomes. The library size estimated by TC is equal to that estimated by CR plus that estimated by ERCC. TN uses the number of all reads which can be aligned to ERCC RNA, nuclear and mitochondrial genomes.</p>
<p>The DESeq method was obtained from the Bioconductor package DESeq [<xref rid="c6" ref-type="bibr">6</xref>] and modified to process scRNA-seq data. RLE, UQ and TMM were obtained from the Bioconductor package edgeR [<xref rid="c7" ref-type="bibr">7</xref>] and modified to process scRNA-seq data. TU, NCS and ES were obtained from the previous study by Gustavo <italic>et al.</italic> [<xref rid="c8" ref-type="bibr">8</xref>]. Since TU sums counts of all ubiquitous genes as the library size to calculate the normalization factor, a process to select ubiquitous genes (describe below) has been integrated into the TU method. TU maximizes AUCVC instead of the number of resulting uniform genes to select ubiquitous genes in the R package NormExpression.</p>
</sec>
<sec id="s3f">
<title>Uniform genes and ubiquitous genes</title>
<p>A uniform gene was defined if the Coefficient of Variation (CV, <bold>Formula 1</bold>) of its post-normalization expression levels across all samples was not more than a cutoff. Ubiquitous genes were defined as the intersection of a trimmed sets of all samples [<xref rid="c8" ref-type="bibr">8</xref>]. This trimmed set of genes were selected for each sample by 1) excluding genes with zero values, 2) sorting the non-zero genes by expression level in that sample, and 3) removing the upper and lower ends of the sample-specific expression distribution. Gustavo <italic>et al.</italic> determined the upper and lower cutoffs by testing all possible combinations of lower and upper cutoffs at 5&#x0025; resolution to maximize the number of resulting uniform genes using one bulk RNA-seq dataset [<xref rid="c8" ref-type="bibr">8</xref>]. The size of a scRNA-seq dataset is usually very large, which could result in a very small or even empty set of ubiquitous genes, since the number of ubiquitous genes depends on the sizes of datasets. To select ubiquitous genes using scRNA-seq data, we defined a parameter named presence rate, which required that one selected ubiquitous gene must appear in at least a proportion of the trimmed sets.</p>
</sec>
<sec id="s3g">
<title>Evaluation metrics</title>
<p>In the previous study [<xref rid="c8" ref-type="bibr">8</xref>], Gustavo <italic>et al.</italic> designed two novel and mutually independent metrics, which were the number of uniform genes and Spearman Correlation Coefficients (SCCs) between expression profiles of gene pairs. Two basic ideas to support these two evaluation metrics are sucessiful normalization methods increase the number of uniform genes and decrease the correlation between the expression profiles of gene pairs. In this study, we designed a new metric AUCVC instead of the number of uniform genes to evaluate normalization methods. We randomly selected 1,000,000 ubiquitous gene pairs to calculate the medians of SCCs. Then, we compared the evaluation results of all the normalizaiton methods by the medians of SCCs with those by AUCVC.</p>
<p>AUCVC is created by plotting the number of uniform genes (y-axis) at each normalized CV (<bold>Formula 2</bold>) threshold (x-axis). To determine the number of uniform genes using scRNA-seq data containing a high frequency of zeros, we only considered genes with non-zero expression values divided by the sample number not less than a thresthold, which was designed as a parameter non-zero ratio. Since a high or a low normalized CV threshold produces more false or less uniform genes, it is reasonable to consider the overall performance of each method at various threshold settings instead of that at one specific threshold setting. In formula 1 and 2, symbols have the same meanings as those in <xref rid="fig1" ref-type="fig">figure 1</xref> and n&#x002A; does not count zero elements in each sample.</p>
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="251140_eqn1.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="251140_eqn2.gif"/></alternatives>
</disp-formula>
</sec>
</sec>
<sec id="s4">
<title>Conclusion and Discussion</title>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We thank Professor Sui Huang and Dr. Joseph Zhou from Institute for Systems Biology (ISB) their hosts on Shan Gao&#x2019; visiting to ISB.</p>
</ack>
<sec sec-type="funding">
<title>Funding</title>
<p>This work was supported by grants from by National Key Research and Development Program of China (2016YFC0502304-03) to Defu Chen and Fundamental Research Funds for the Central Universities (for Nankai University) to Shan Gao.</p>
</sec>
<sec sec-type="COI-statement">
<title>Competing interests</title>
<p><named-content content-type="COI-statement">Non-financial competing interests are claimed in this study.</named-content></p>
</sec>
<sec>
<title>Authors&#x2019; contributions</title>
<p>SG conceived this project. SG and JR supervised this project. ZW, WL and SL performed programing. ZW, DY and HJ analyzed the data. WD prepared all the figures, tables and additional files. SG drafted the main manuscript. XX and XX revised the manuscript. <bold>All authors have read and approved the manuscript.</bold></p>
</sec>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Lov&#x00E9;n</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Orlando</surname> <given-names>D.A.</given-names></string-name>, <string-name><surname>Sigova</surname> <given-names>A.A.</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>C.Y.</given-names></string-name>, <string-name><surname>Rahl</surname> <given-names>P.B.</given-names></string-name>, <string-name><surname>Burge</surname> <given-names>C.B.</given-names></string-name>, <string-name><surname>Levens</surname> <given-names>D.L.</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>T.I.</given-names></string-name>, and <string-name><surname>Young</surname> <given-names>R.A.</given-names></string-name>, <article-title>Revisiting global gene expression analysis</article-title>. <source>Cell</source>, <year>2012</year>. <volume>151</volume>(<issue>3</issue>): <fpage>476</fpage>&#x2013;<lpage>482</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="book"><string-name><surname>Gao</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Ou</surname> <given-names>J.</given-names></string-name>, and <string-name><surname>Xiao</surname> <given-names>K.</given-names></string-name>, <source>R language and Bioconductor in bioinformatics applications(Chinese Edition)</source>. <year>2014</year>, <publisher-loc>Tianjin</publisher-loc>: <publisher-name>Tianjin Science and Technology Translation Publishing Ltd</publisher-name>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="book"><string-name><surname>Tao</surname> <given-names>H.</given-names></string-name> and <string-name><surname>Gao</surname> <given-names>S.</given-names></string-name>, <source>Computational Systems Biology: Methods and Protocols</source>. <year>2018</year>, <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Bullard</surname> <given-names>J.H.</given-names></string-name>, <string-name><surname>Purdom</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Hansen</surname> <given-names>K.D.</given-names></string-name>, and <string-name><surname>Dudoit</surname>, <given-names>S.</given-names></string-name>, <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>. <source>BMC Bioinformatics</source>, <year>2010</year>. <volume>11</volume>(<issue>1</issue>): <fpage>94</fpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Jiang</surname> <given-names>L.</given-names></string-name>, <string-name><surname>Schlesinger</surname> <given-names>F.</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>C.A.</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Salit</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Gingeras</surname> <given-names>T.R.</given-names></string-name>, and <string-name><surname>Oliver</surname> <given-names>B.</given-names></string-name>, <article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome Research</source>, <year>2011</year>. <volume>21</volume>(<issue>9</issue>): <fpage>1543</fpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Anders</surname> <given-names>S.</given-names></string-name> and <string-name><surname>Huber</surname> <given-names>W.</given-names></string-name>, <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome biology</source>, <year>2010</year>. <volume>11</volume>(<issue>10</issue>): <fpage>R106</fpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Robinson</surname> <given-names>M.D.</given-names></string-name>, <string-name><surname>McCarthy</surname> <given-names>D.J.</given-names></string-name>, and <string-name><surname>Smyth</surname> <given-names>G.K.</given-names></string-name>, <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <year>2010</year>. <volume>26</volume>(<issue>1</issue>): <fpage>139</fpage>&#x2013;<lpage>140</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Glusman</surname> <given-names>G.</given-names></string-name>, <string-name><surname>Caballero</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Robinson</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Kutlu</surname> <given-names>B.</given-names></string-name>, and <string-name><surname>Hood</surname> <given-names>L.</given-names></string-name>, <article-title>Optimal scaling of digital transcriptomes</article-title>. <source>Plos One</source>, <year>2013</year>. <volume>8</volume>(<issue>11</issue>): <fpage>e77885</fpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Piao</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Shon</surname> <given-names>H.S.</given-names></string-name>, and <string-name><surname>Ryu</surname> <given-names>K.H.</given-names></string-name>, <article-title>Comparing the normalization methods for the differential analysis of Illumina high-throughput RNA-Seq data. Bmc</article-title> <source>Bioinformatics</source>, <year>2015</year>. <volume>16</volume>(<issue>1</issue>): <fpage>347</fpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Gao</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Duan</surname> <given-names>G.Y.</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>Z.</given-names></string-name>, <string-name><surname>Ruan</surname> <given-names>J.S.</given-names></string-name>, and <string-name><surname>Zhang</surname> <given-names>T.</given-names></string-name>, <article-title>Prediction of function changes associated with single-point protein mutations using support vector machines (SVMs)</article-title>. <source>Human Mutation</source>, <year>2009</year>. <volume>30</volume>(<issue>8</issue>): <fpage>1161</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Dobin</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>C.A.</given-names></string-name>, <string-name><surname>Schlesinger</surname> <given-names>F.</given-names></string-name>, <string-name><surname>Drenkow</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Zaleski</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Jha</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Batut</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Chaisson</surname> <given-names>M.</given-names></string-name>, and <string-name><surname>Gingeras</surname> <given-names>T.R.</given-names></string-name>, <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <year>2013</year>. <volume>29</volume>(<issue>1</issue>): <fpage>15</fpage>&#x2013;<lpage>21</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Gao</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>X.</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>H.</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>Z.</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>Z.</given-names></string-name>, <string-name><surname>Dong</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>Q.</given-names></string-name>, <string-name><surname>Ruan</surname> <given-names>J.</given-names></string-name>, and <string-name><surname>Bu</surname> <given-names>W.</given-names></string-name>, <article-title>Two novel lncRNAs discovered in human mitochondrial DNA using PacBio full-length transcriptome data</article-title>. <source>Mitochondrion</source>, <year>2017</year>.</mixed-citation></ref></ref-list>
</back>
</article>