<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/104935</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>propr: An R-package for Identifying Proportionally Abundant Features Using Compositional Data Analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Quinn</surname> <given-names>Thomas</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Richardson</surname> <given-names>Mark F.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Lovell</surname> <given-names>David</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Crowley</surname> <given-names>Tamsyn</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<aff id="a1">
<label>1</label>
<institution>Bioinformatics Core Research Group, Deakin University</institution>, Geelong, Victoria, <country>Australia</country></aff>
<aff id="a2"><label>2</label>
<institution>School of Medicine, MMR, Deakin University</institution>, Geelong, Victoria, <country>Australia</country></aff>
<aff id="a3"><label>3</label>
<institution>Queensland University of Technology</institution>, Brisbane, Queensland, <country>Australia</country></aff>
</contrib-group>
<author-notes>
<fn id="n1"><label>&#x002A;</label><p><email>contacttomquinn@gmail.com</email></p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>104935</elocation-id>
<history>
<date date-type="received">
<day>31</day>
<month>1</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>01</day>
<month>2</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="104935.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>In the life sciences, many assays measure only the relative abundances of components for each sample. These data, called compositional data, require special handling in order to avoid misleading conclusions. For example, in the case of correlation, treating relative data like absolute data can lead to the discovery of falsely positive associations. Recently, researchers have proposed proportionality as a valid alternative to correlation for calculating pairwise association in relative data. Although the question of how to best measure proportionality remains open, we present here a computationally efficient R package that implements two proposed measures of proportionality. In an effort to advance the understanding and application of proportionality analysis, we review the mathematics behind proportionality, demonstrate its application to genomic data, and discuss some ongoing challenges in the analysis of relative abundance data.</p>
</abstract>
<counts>
<page-count count="12"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Advances in the technology used to assay biological systems have led to a rapid increase in the amount of data generated. However, there has not yet emerged a clear consensus over the best methodological approach for dealing with these data. In fact, some of the most commonly used methods fundamentally ignore the underlying nature of the data studied. Biological count data, such as those produced by high-throughput sequencing, belong within the domain of relative data. Other examples of relative data include data generated by RNA-sequencing (RNA-Seq), chromatin immunoprecipitation sequencing (ChIP-Seq), Methyl-Capture sequencing, 16S amplicon-sequencing, and metabolomics. Methods that wrongly assume absolute data yield erroneous results when applied to relative data, as evidenced by the spurious correlations that arise during the analysis of gene expression data [<xref rid="c10" ref-type="bibr">10</xref>].</p>
<p>Genomic count data (i.e., gene expression data from RNA-Seq), as a type of compositional data, have two key geometric properties. First, the total sum of all component values (sometimes called the library size) is an artifact of the sampling procedure [<xref rid="c17" ref-type="bibr">17</xref>]. Any number of factors, such as technical variability or differences in experiment-specific abundance, can impact the library size. Second, the distance between component values is only meaningful proportionally (e.g., the difference between 100 and 200 counts carries the same information as the difference between 1000 and 2000 counts) [<xref rid="c17" ref-type="bibr">17</xref>]. Simply dividing count data by the total library size does not address the systematic biases in RNA-Seq data. Although several normalization strategies exist, it is concerning that the choice of method can drastically change the number and identity of genes reported as differentially expressed [<xref rid="c9" ref-type="bibr">9</xref>]. This sensitivity to normalization holds true for other modes of compositional data as well [<xref rid="c16" ref-type="bibr">16</xref>]. Moreover, some methods, such as trimmed mean of M (TMM) normalization, give different results depending on how lowly expressed genes get removed from the data [<xref rid="c9" ref-type="bibr">9</xref>].</p>
<p>By not addressing the compositional nature of genomic count data, investigators implicitly assume that absolute differences between counts have meaning [<xref rid="c5" ref-type="bibr">5</xref>]. That is, they assume the data exist in real Euclidean space [<xref rid="c17" ref-type="bibr">17</xref>]. This may explain why there has emerged a number of hyper-parameterized, assay-specific normalization methods used in the calculation of differential abundance that fail to generalize to data produced by other assays [<xref rid="c5" ref-type="bibr">5</xref>]. Meanwhile, methods that accommodate compositional data, such as the ALDEx2 package for R, offer a unified way to compute differential abundance regardless of the data source [<xref rid="c5" ref-type="bibr">5</xref>]. However, the ALDEx2 package lacks an interface for calculating proportionality or any other compositionally valid measure of association.</p>
<p>The compositional nature of genomic count data also has considerable importance when measuring correlation because correlation presupposes that the data are measured as absolute abundances. Rather, many of the data studied in genomics are measured as relative abundances, making correlation a statistically invalid choice when working with genomic count data [<xref rid="c10" ref-type="bibr">10</xref>]. As Pearson warned in 1896, correlation gives spurious results when applied to relative data: i.e., given three statistically independent variables, X, Y, and Z, the ratios X/Z and Y/Z will correlate with one another because of their shared denominator [<xref rid="c12" ref-type="bibr">12</xref>]. If we consider that Z may represent, for example, the library size, we see how two uncorrelated features, X and Y, may appear correlated even when they are not. We emphasize that the topic of spurious correlation is not merely a pedantic footnote. When applied to real biological data, correlation can lead to wrong conclusions [<xref rid="c6" ref-type="bibr">6</xref>] [<xref rid="c10" ref-type="bibr">10</xref>]. For example, one might incorrectly conclude that there exists a coordinated regulation among a module of transcriptionally independent genes.</p>
<p>As an alternative to correlation, proportionality is a measure of dependence that is valid for compositional data [<xref rid="c10" ref-type="bibr">10</xref>] [<xref rid="c4" ref-type="bibr">4</xref>]. Borrowing from compositional data analysis (CoDA) principals, this approach uses a log-ratio transformation (&#x002A;LR) of the original feature vectors in order to transpose the data from a simplex into real Euclidean space [<xref rid="c1" ref-type="bibr">1</xref>] [<xref rid="c17" ref-type="bibr">17</xref>]. These transformed abundances then provide a substrate for calculating the <italic>log-ratio</italic> variance (VLR), defined as the variance of the ratio of two log-ratio transformed feature vectors (var (&#x002A;LR (<italic>X</italic>)=&#x002A;LR (<italic>Y</italic>))) [<xref rid="c1" ref-type="bibr">1</xref>]. As a compositionally coherent measure, the VLR does not change whether applied to relative values or to their absolute equivalent. However, the VLR lacks a scale that would otherwise make it possible to compare dependency across multiple feature pairs. In essence, what we call proportionality is a modification to the VLR that establishes scale.</p>
<p>The propr package, now available through the Comprehensive R Archive Network (CRAN) [<xref rid="c13" ref-type="bibr">13</xref>], implements two measures of proportionality, <italic>&#x03D5;</italic> [<xref rid="c10" ref-type="bibr">10</xref>] and <italic>&#x03C1;<sub>p</sub></italic> [<xref rid="c4" ref-type="bibr">4</xref>], defined formally in the next section. As an alternative to correlation, proportionality avoids the majority of the spurious results that come with correlation misuse, having a certain robustness in the setting of compositional data [<xref rid="c10" ref-type="bibr">10</xref>]. Between <italic>&#x03D5;</italic> and <italic>&#x03C1;<sub>p</sub></italic>, <italic>&#x03C1;<sub>p</sub></italic> has one benefit in that it provides a naturally symmetric result. However, we can make <italic>&#x03D5;</italic> naturally symmetric too by slightly altering its definition, as shown in the next section. Otherwise, <italic>&#x03C1;</italic><sub>p</sub> exists on a scale from [&#x2212;1; 1], reinforcing its analogy to correlation, while <italic>&#x03D5;</italic> exists on a scale from [0; &#x221E;), reinforcing its analogy to dissimilarity. Yet, it is the conceptual and mathematical link between <italic>&#x03D5;</italic> and <italic>&#x03C1;<sub>p</sub></italic> metrics that allows us to present the propr package as a single portal to proportionality analysis.</p>
</sec>
<sec id="s2">
<title>Design and Implementation</title>
<p>This software tool provides a programmatic framework for calculating two measures of proportionality in the R language. Proportionality, as analogous to, but distinct from, correlation, measures the dependence between two feature vectors. Unlike correlation, which can yield spurious results in the setting of relative data, proportionality borrows from the branch of mathematics known as compositional data analysis (CoDA) to offer a robust alternative for relative data types. This package includes two principal functions, phit and perb, that calculate the proportionality metrics <italic>&#x03D5;</italic> and <italic>&#x03C1;<sub>p</sub></italic>, respectively [<xref rid="c10" ref-type="bibr">10</xref>] [<xref rid="c4" ref-type="bibr">4</xref>].</p>
<p>Consider a matrix of D values measured across N samples subjected to one of any number of binary or continuous events M. The events M might represent case-control status, treatment status, treatment dose, or time. Given a dataset with N rows and D columns, the functions phit and perb return a matrix of <italic>D<sup>2</sup></italic> elements relating each combination of two vectors, <italic>A<sub>i</sub></italic> and <italic>A<sub>j</sub></italic>, according to the following definitions:</p>
<disp-formula id="eqn1">
<alternatives>
<graphic xlink:href="104935_eqn1.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn2">
<alternatives>
<graphic xlink:href="104935_eqn2.gif"/>
</alternatives>
</disp-formula>
<p>In addition, we include the phis function to calcualate <italic>&#x03D5;<sub>s</sub></italic>, a naturally symmetric variant of <italic>&#x03D5;</italic>. Interestingly, <italic>&#x03D5;<sub>s</sub></italic>, relates to <italic>&#x03C1;<sub>p</sub></italic> by a monotonic function [<xref rid="c4" ref-type="bibr">4</xref>].</p>
<p>This measure of proportionality relates the variance of the log-ratio (VLR) to the variance of the log-product (VLP), according to the following definition:</p>
<disp-formula id="eqn3">
<alternatives>
<graphic xlink:href="104935_eqn3.gif"/>
</alternatives>
</disp-formula>
<p>We refer the reader to the supplemental appendix for a demonstration of how these measures of proportionality relate to the slope, &#x03B2;, and the Pearson correlation coefficient, r, of pairwise log-transformed data. This appendix also illustrates how <italic>&#x03D5;</italic>, <italic>&#x03D5;<sub>s</sub></italic>, and <italic>&#x03C1;<sub>p</sub></italic> relate to one another S1 Appendix.</p>
<p>Above, we use <italic>A<sub>i</sub></italic> and <italic>A<sub>j</sub></italic> to denote a log-ratio transformation of the sample vectors <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic>. By default, this package uses an implementation for the centered log-ratio transformation (clr), defined as:</p>
<disp-formula id="eqn4">
<alternatives>
<graphic xlink:href="104935_eqn4.gif"/>
</alternatives>
</disp-formula>
<p>In addition, we include an implementation for the additive log-ratio transformation (alr), defined as:</p>
<disp-formula id="eqn5">
<alternatives>
<graphic xlink:href="104935_eqn5.gif"/>
</alternatives>
</disp-formula>
<p>In contrast to clr, alr uses another feature to transform the original sample vectors. When used in conjunction with an <italic>a priori</italic> known unchanged reference, alr effectively back-calculates the absolute counts from the relative components. By specifying, for example, a house-keeping gene or an experimentally fixed variable, the investigator can possibly achieve a more accurate measure of dependence than through clr [<xref rid="c4" ref-type="bibr">4</xref>]. The user can toggle alr transformation in lieu of the default clr transformation by supplying the name of the unchanged reference to the ivar argument of the perb or phis function. In either case, we wish to alert the reader that log-ratio transformation, by its nature, require non-zero elements in the data matrix. As such, any log-ratio analysis must first address any zeros. Yet, how best to do this remains an open question and a topic of active research [<xref rid="c11" ref-type="bibr">11</xref>]. For simplicity, propr automatically replaces all zero values with 1 prior to log-ratio transformation, corresponding to the multiplicative replacement strategy [<xref rid="c11" ref-type="bibr">11</xref>].</p>
<p>The R language, despite its widespread popularity, suffers from poor performance when scaling to big data. Its &#x201C;copy-on-modify&#x201D; behavior, whereby each modification of an object creates a duplication of that object, along with slow for-loops, makes it an imperfect choice for computationally expensive tasks such as the one here. Therefore, in order to speed up the run time and reduce RAM overhead, we harness the Rcpp package to draft the computationally expensive portions of this tool in C&#x002B;&#x002B; [<xref rid="c3" ref-type="bibr">3</xref>].</p>
<p>This package also offers a number of tools to visualize proportionality when working with high-dimensional data. We provide extensive documentation for these plotting methods in the package vignette, &#x201C;Understanding RNA-Seq Data through Proportionality Analysis&#x201D;, hosted with the package on CRAN [<xref rid="c13" ref-type="bibr">13</xref>]. Among these tools are those used to generate the figures included in the next section.</p>
</sec>
<sec id="s3">
<title>Results</title>
<p>As a use case, we re-analyze the raw RNA-Seq counts from an already published study on cane toad (<italic>Rhinella marina</italic>) evolution and adaptation [<xref rid="c15" ref-type="bibr">15</xref>]. Sugar cane farmers introduced cane toads to Australia in 1935 as a cane beetle pest control measure, but these toads quickly became invasive. This event now serves as a notable example of failed biological control. Initially introduced into northeastern Australia (Queensland, QLD), cane toads have since spread westwards across the continent to Western Australia (WA) [<xref rid="c15" ref-type="bibr">15</xref>]. This dataset contains muscle tissue RNA transcript counts for 20 toads sampled from two regions (10 per region) in the wild. The two regions sampled, which we will treat as the experimental groups, include the long colonized site of introduction in QLD and the front of the range expansion in WA [<xref rid="c15" ref-type="bibr">15</xref>]. In this analysis, we want to understand the differences in gene expression between the established and expanding populations. By demonstrating propr on public data, we provide a reproducible example of how proportionality analysis can converge on an established biological narrative. The reader can find these data bundled with the release of the package on CRAN [<xref rid="c13" ref-type="bibr">13</xref>].</p>
<p>We begin by constructing the proportionality matrix using all 57,580 transcript counts, yielding an <italic>N</italic><sup>2</sup> matrix 24.7 Gb in size. To minimize the number of lowly expressed transcripts included in the final result, we subset the matrix to include only those transcripts with at least 10 counts in at least 10 samples. By removing the features at this stage, we can exploit a computational trick to calculate proportionality and filter simultaneously, reducing the required RAM to only 5 Gb without altering the resultant matrix. Next, in the absence of a hypothesis testing framework, we arbitrarily select those &#x201C;highly proportional&#x201D; transcripts with <italic>&#x03C1;<sub>p</sub> &#x003E; 0:99</italic>. When plotting the pairwise log-ratio transformed abundance for these &#x201C;highly proportional&#x201D; transcript pairs, a smear of straight diagonal lines confirms that the feature pairs indexed as proportional actually show proportional abundance (<xref rid="fig1" ref-type="fig">Fig 1</xref>).</p>
<p>The procedure used to parse through the proportionality matrix now depends on the experimental question. Here, we wish to identify a highly proportional transcript module that happens to show differential abundance across the experimental groups. In this example, we take an unsupervised approach by hierarchically clustering the highly proportional feature pairs based on the matrix 1 abs(<italic>&#x03C1;<sub>p</sub> &#x003E; 0:99</italic>). We note here that one could instead cluster using <italic>&#x03D5;<sub>s</sub></italic> directly. When clustering, we call two features co-clustered if they belong to the cluster after cutting the dendrogram. Then, we project the pairs across two axes of variance, the variance of the <italic>log-ratio</italic> (VLR) and <italic>variance of the log sums</italic> (VLS) such that <inline-formula><alternatives><inline-graphic xlink:href="104935_inline1.gif"/></alternatives></inline-formula> In this formula, we see that as VLR approaches 0, <italic>&#x03C1;<sub>p</sub></italic> approaches 1. Meanwhile, the VLS, the sum of the individual variances of two features in that pair, adjusts the rate of this limit. Since we would expect a differentially expressed module to have a low VLR and a high VLS, we prioritize pairs in co-cluster 3 for subsequent analysis (<xref rid="fig2" ref-type="fig">Fig 2</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig 1.</label>
<caption>
<title>Smear plot.</title><p>This figure shows the log-ratio abundance for each feature belonging to pairs index as highly proportional (<italic>&#x03C1;<sub>p</sub> &#x003E; 0:99</italic>). A smear of straight diagonal lines confirms that the feature pairs indexed as proportional actually show proportional abu e. In other words, large deviations from <italic>y &#x003D; x</italic> indicate small values of <inline-formula><alternatives><inline-graphic xlink:href="104935_inline2.gif"/></alternatives></inline-formula> Figure produced using the smear function in propr.</p></caption>
<graphic xlink:href="104935_fig1.tif"/>
</fig>
<p>Co-clusters containing feature pairs with a low VLR and a high VLS have the potential to explain differences between the experimental groups. However, the high VLS may not necessarily have anything to do with the experimental condition. For example, this co-cluster might instead include highly proportional features that show wide individual feature variance due to batch effects. For the cane toad data, however, the experimental condition does indeed seem to drive the high individual feature variances in the module, as evidenced by the near perfect group separation when visualizing the first two components of a principal components analysis (PCA) (<xref rid="fig3" ref-type="fig">Fig 3</xref>). Note that this plot calculates PCA using the log-ratio transformed data, making it a statistically valid choice for compositional data [<xref rid="c7" ref-type="bibr">7</xref>]. The separation between groups achieved here compares to that reported in the original publication, which used features selected by the edgeR package [<xref rid="c15" ref-type="bibr">15</xref>]. In addition, gene set enrichment analysis of the gene ontologies for co-cluster 3 (S1 Table) shows an enrichment for similar molecular functions as those highlighted in the original publication [<xref rid="c15" ref-type="bibr">15</xref>]. Although the exact gene ontology terms differ by method, our approach yields a constellation of macromolecular metabolic terms that suggests a common story: &#x201C;metabolic enzymes are overwhelmingly upregulated at the invasion front&#x201D; [<xref rid="c15" ref-type="bibr">15</xref>], interpreted to mean that WA cane toads may experience more environmental stress than those from QLD [<xref rid="c15" ref-type="bibr">15</xref>]. Yet, while agreeing here, proportionality analysis offers an additional benefit in that it provides a layer of information on pairwise associations, all without requiring any kind of normalization.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig 2.</label>
<caption>
<title>Prism plot.</title><p>This figure shows the distribution of feature pairs according to the variance of the log-ratio (VLR) and the variance of the log sums (VLS) for all pairs in which at least one of the features participates in at least one highly proportional (<italic>&#x03C1;<sub>p</sub> &#x003E;</italic> 0:99) pair. If both features in a pair belong to the same cluster, they receive a non-zero color code. Clusters created hierarchically based on the matrix 1 abs (<italic>&#x03C1;<sub>p</sub></italic>). Figure produced using the prism function in propr.</p></caption>
<graphic xlink:href="104935_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig 3.</label>
<caption>
<title>PCA plot.</title><p>This figure shows all samples projected across the first two components of a principal components analysis (PCA), calculated using the log-ratio transformed data. This plot colors samples based on the experimental group. Figure produced using the pca function in propr.</p></caption>
<graphic xlink:href="104935_fig3.tif"/>
</fig>
<p>We refer the reader to the supplementary materials for a script that contains everything required to reproduce this analysis (S1 File).</p>
</sec>
<sec id="s4">
<title>Availability and Future Directions</title>
<p>The propr package for R, now available on CRAN [<xref rid="c13" ref-type="bibr">13</xref>], provides a fast implementation of two measures of proportionality previously shown to rectify the issue of spurious correlation in the setting of compositional data [<xref rid="c10" ref-type="bibr">10</xref>] [<xref rid="c4" ref-type="bibr">4</xref>]. These implementations offer a valid alternative to correlation that can accurately identify feature dependence from relative data [<xref rid="c4" ref-type="bibr">4</xref>]. By using the Rcpp package to draft the computationally expensive code in C&#x002B;&#x002B;, the propr package achieves greater performance than possible in the native R environment without altering the front-end user experience [<xref rid="c3" ref-type="bibr">3</xref>]. In this way, proportionality analysis executes nearly as fast as base R correlation while retaining a simple programming interface. Yet, proportionality analysis is not without limitations.</p>
<p>First, unlike the <italic>log-ratio variance</italic> (VLR), the values of &#x03A6; and <italic>&#x03C1;<sub>p</sub></italic> will change in the setting of missing feature data. Since biological assays rarely, if ever, capture all possible feature information, this property makes the centered log-ratio transformation (clr) a sub-optimal choice. The additive log-ratio transformation (alr), which allows the user to scale their data by a feature with a priori known fixed abundance, such as a house-keeping gene or an experimentally fixed variable (e.g., a ThermoFisher ERCC synthetic RNA &#x201C;spike-in&#x201D; [<xref rid="c8" ref-type="bibr">8</xref>]), may provide a superior alternative. In contrast to clr, proportionality calculated with alr does not change with missing feature data because it effectively back-calculates the absolute feature abundance. Still, clr remains sufficient when most features remain unchanged across samples, an assumption also built into the trimmed mean of M (TMM) normalization used with RNA-Seq data [<xref rid="c14" ref-type="bibr">14</xref>] [<xref rid="c4" ref-type="bibr">4</xref>]. Moreover, errors associated with clr transformation consist almost entirely of false negatives, rather than false positives, making it suitable for many scientific applications [<xref rid="c4" ref-type="bibr">4</xref>].</p>
<p>Second, proportionality analysis, by nature of the log-ratio transformation, fails in the presence of zero values. As such, proportionality analysis inherits the zero replacement controversy prominent in the compositional data analysis literature. By default, propr replaces all zero values with 1. If analysts wish to explore other approaches to zero replacement{including conducting analyses of the sensitivity of results to zero imputation{they can so by manipulating the data prior to running routines in propr. We stress that, depending on the number of zero values in the data, replacement of zeros can have a major impact on the conclusions drawn from any log-ratio compositional data analysis. Analysts should carefully examine their results to understand the extent to which they depend on the zero replacement strategy chosen.</p>
<p>Third, biological count data do not exist as true compositional data, but rather as a kind of &#x201C;count-compositional&#x201D; data, whereby small non-zero counts pose a unique challenge to analysis. This follows from how the log-ratio methods of compositional data analysis assume data to consist of <italic>D</italic> positive, real-valued components (i.e., a sample space of <inline-formula><alternatives><inline-graphic xlink:href="104935_inline3.gif"/></alternatives></inline-formula>. Instead, count-compositional data consist of D non-negative, <italic>integer-valued</italic> components (i.e., a sample space of <inline-formula><alternatives><inline-graphic xlink:href="104935_inline4.gif"/></alternatives></inline-formula> The smaller the counts, the more noticeable the discretization of the count-compositional data becomes. Likewise, the impact of sampling variation becomes more noticeable as well: additive variation affects the relative abundance of small counts more than large counts. Put succinctly, the difference between 1 count and 2 counts does not carry the same information as the difference between 1000 counts and 2000 counts. In practice, this means that a minor variation in small counts can have a major impact on the conclusions drawn from any log-ratio compositional data analysis. Like with zero replacement, analysts should carefully examine their results to understand this sensitivity. We note that prior work has found substantial differences in how test statistics handle low-count genes in RNA-Seq [<xref rid="c2" ref-type="bibr">2</xref>]. For the purposes of demonstrating propr, we avoid this issue by altogether removing from analysis any component with a predominance of low counts.</p>
<p>Finally, proportionality analysis currently lacks a hypothesis testing framework. Its distribution of heteroscedastic variance makes it unsuited for the z-transformation used to calculate the variance of the correlation statistic. More work is needed to create a framework for applying statistical tests to proportionality analysis. However, despite these limitations, we believe the propr package comes a long way in improving the accessibility of proportionality analysis to researchers. We hope many biological investigations will benefit from this alternative to correlation.</p>
</sec>
<sec id="s5">
<title>Supporting Information</title>
<p><bold>S1 Appendix. Examination of proportionality</bold>. This document lays out how the measures of proportionality relate to the slope, <italic>&#x03B2;</italic>, and the Pearson correlation coefficient, r, of pairwise log-transformed data, as well as how these measures relate to one another.</p>
<p><bold>S1 File. Cane toad analysis script</bold>. This R script reproduces the results and figures presented in this paper.</p>
<p><bold>S2 File. Gene ontology (GO) data object</bold>. This R object provides the gene ontology terms used by S1 File to produce S1 Table. Function annotations sourced from the Trinotate pipeline (<ext-link ext-link-type="uri" xlink:href="http://trinotate.sourceforget.net">http://trinotate.sourceforget.net</ext-link>), as described in the supplementary methods from [<xref rid="c15" ref-type="bibr">15</xref>].</p>
<p><bold>S1 Table. Gene ontology (GO) table</bold>. This table contains the gene ontology terms selected by gene set enrichment analysis of the highly proportional (<italic>&#x03C1;<sub>p</sub> &#x003E;</italic> 0:99) gene pairs.</p>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="book"><string-name><given-names>J</given-names> <surname>Aitchison</surname></string-name>. <source>The Statistical Analysis of Compositional Data</source>. <publisher-name>Chapman &#x0026; Hall, Ltd</publisher-name>, <publisher-loc>London, UK, UK</publisher-loc>, <year>1986</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><given-names>James H.</given-names> <surname>Bullard</surname></string-name>, <string-name><given-names>Elizabeth</given-names> <surname>Purdom</surname></string-name>, <string-name><given-names>Kasper D.</given-names> <surname>Hansen</surname></string-name>, and <string-name><given-names>Sandrine</given-names> <surname>Dudoit</surname></string-name>. <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>. <source>BMC Bioinformatics</source>, <fpage>11</fpage>&#x2013;<lpage>94</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><given-names>Dirk</given-names> <surname>Eddelbuettel</surname></string-name> and <string-name><given-names>Romain</given-names>, <surname>Franois</surname></string-name>. <article-title>Rcpp: Seamless R and C&#x002B;&#x002B; Integration</article-title>. <source>Journal of Statistical Software</source>, <volume>40</volume> (<issue>8</issue>):<fpage>1</fpage>&#x2013;<lpage>18</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation><string-name><given-names>Ionas</given-names> <surname>Erb</surname></string-name> and <string-name><given-names>Cedric</given-names>, <surname>Notredame</surname></string-name>. <article-title>How should we measure proportionality on relative gene expression data?</article-title> <source>Theory in Biosciences &#x003D; Theorie in Den Biowissenschaften</source>, <volume>135</volume> (<issue>1-2</issue>): <fpage>21</fpage>&#x2013;<lpage>36</lpage>, <month>June</month> <year>2016</year>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><given-names>Andrew D.</given-names> <surname>Fernandes</surname></string-name>, <string-name><given-names>Jennifer Ns</given-names> <surname>Reid</surname></string-name>, <string-name><given-names>Jean M.</given-names> <surname>Macklaim</surname></string-name>, <string-name><given-names>Thomas A.</given-names> <surname>McMurrough</surname></string-name>, <string-name><given-names>David R.</given-names> <surname>Edgell</surname></string-name>, and <string-name><given-names>Gregory B.</given-names> <surname>Gloor</surname></string-name>. <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16s rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title>. <source>Microbiome</source>, <fpage>2</fpage>&#x2013;<lpage>15</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name> and <string-name><given-names>Eric J.</given-names> <surname>Alm</surname></string-name>. <article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS computational biology</source>, <volume>8</volume>(<issue>9</issue>):<fpage>e1002687</fpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><given-names>Gregory B.</given-names> <surname>Gloor</surname></string-name> and <string-name><given-names>Gregor</given-names> <surname>Reid</surname></string-name>. <article-title>Compositional analysis: a valid approach to analyze microbiome high-throughput sequencing data</article-title>. <source>Canadian Journal of Microbiology</source>, <volume>62</volume> (<issue>8</issue>): <fpage>692</fpage>&#x2013;<lpage>703</lpage>, <month>August</month> <year>2016</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>Lichun</given-names> <surname>Jiang</surname></string-name>, <string-name><given-names>Felix</given-names> <surname>Schlesinger</surname></string-name>, Carrie A. Davis, <string-name><given-names>Yu</given-names> <surname>Zhang</surname></string-name>, <string-name><surname>Renhua</surname><given-names>Li</given-names></string-name>, <string-name><given-names>Marc</given-names> <surname>Salit</surname></string-name>, <string-name><given-names>Thomas R.</given-names> <surname>Gingeras</surname></string-name>, and <string-name><given-names>Brian</given-names> <surname>Oliver</surname></string-name>. <article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome Research</source>, <volume>21</volume> (<issue>9</issue>): <fpage>1543</fpage>&#x2013;<lpage>1551</lpage>, <month>September</month> <year>2011</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><given-names>Yanzhu</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Kseniya</given-names> <surname>Golovnina</surname></string-name>, <string-name><given-names>Zhen-Xia</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>Hang Noh</given-names> <surname>Lee</surname></string-name>, <string-name><surname>Yazmin</surname><given-names>L.</given-names></string-name><article-title>Serrano Negron, Hina Sultana, Brian Oliver, and Susan T. Harbison. Comparison of normalization and differential expression analyses using RNA-Seq data from 726 individual Drosophila melanogaster</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <month>January</month> <year>2016</year>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><given-names>David</given-names> <surname>Lovell</surname></string-name>, <string-name><given-names>Vera</given-names> <surname>Pawlowsky-Glahn</surname></string-name>, <string-name><given-names>Juan Jos</given-names> <surname>Egozcue</surname></string-name>, <string-name><given-names>Samuel</given-names> <surname>Marguerat</surname></string-name>, and <string-name><given-names>Jrg</given-names> <surname>Bhler</surname></string-name>. <article-title>Proportionality: a valid alternative to correlation for relative data</article-title>. <source>PLoS computational biology</source>, <volume>11</volume>(<issue>3</issue>):<fpage>e1004075</fpage>, <month>March</month> <year>2015</year>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="book"><string-name><given-names>Josep</given-names> <surname>Antoni Martin-Fernandez</surname></string-name>, <string-name><given-names>Javier</given-names> <surname>Palarea-Albaladejo</surname></string-name>, and <string-name><given-names>Ricardo</given-names> <surname>An-tonio Olea</surname></string-name>. <source>Chapter 4. Dealing with Zeros. In Compositional Data Analysis: Theory and Applications</source>, pages <fpage>43</fpage>&#x2013;<lpage>58</lpage>. <publisher-name>John Wiley &#x0026; Sons, Ltd</publisher-name>, <year>2011</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><given-names>Karl</given-names> <surname>Pearson</surname></string-name>. <article-title>Mathematical Contributions to the Theory of Evolution. &#x0025;2. Regression</article-title>, <source>Heredity, and Panmixia. Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</source>, <volume>187</volume>:<fpage>253</fpage>&#x2013;<lpage>318</lpage>, <year>1896</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation><string-name><given-names>Thomas</given-names> <surname>Quinn</surname></string-name>, <string-name><given-names>David</given-names> <surname>Lovell</surname></string-name>, <string-name><given-names>Anders</given-names> <surname>Bilgrau</surname></string-name>, and <string-name><given-names>Ionas</given-names> <surname>Erb</surname></string-name>. <source>propr: Calculating Proportionality Between Vectors of Compositional Data</source>, <month>December</month> <year>2016</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Mark</surname> <given-names>D.</given-names></string-name> <article-title>Robinson and Alicia Oshlack. A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biology</source>, <fpage>11</fpage>: <lpage>R25</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><given-names>Lee A.</given-names> <surname>Rollins</surname></string-name>, <string-name><given-names>Mark F.</given-names> <surname>Richardson</surname></string-name>, and <string-name><given-names>Richard</given-names> <surname>Shine</surname></string-name>. <article-title>A genetic perspective on rapid evolution in cane toads (Rhinella marina)</article-title>. <source>Molecular Ecology</source>, <volume>24</volume> (<issue>9</issue>): <fpage>2264</fpage>&#x2013;<lpage>2276</lpage>, <month>May</month> <year>2015</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>Edoardo</given-names> <surname>Saccenti</surname></string-name>. <article-title>Correlation Patterns in Experimental Data Are Affected by Normalization Procedures: Consequences for Data Analysis and Network Inference</article-title>. <source>Journal of Proteome Research</source>, <month>November</month> <year>2016</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation><string-name><given-names>K.</given-names> <surname>Gerald van den Boogaart</surname></string-name> and <string-name><given-names>R.</given-names> <surname>Tolosana-Delgado</surname></string-name>. <article-title>compositions: A unified R package to analyze compositional data</article-title>. <source>Computers &#x0026; Geosciences</source>, <volume>34</volume> (<issue>4</issue>): <fpage>320</fpage>&#x2013;<lpage>338</lpage>, <month>April</month> <year>2008</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>