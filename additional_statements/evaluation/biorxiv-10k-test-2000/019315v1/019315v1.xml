<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/019315</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Roary: Rapid large-scale prokaryote pan genome analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Page</surname><given-names>Andrew J.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Cummins</surname><given-names>Carla A.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Hunt</surname><given-names>Martin</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Wong</surname><given-names>Vanessa K.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Reuter</surname><given-names>Sandra</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Holden</surname><given-names>Matthew T. G.</given-names></name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Fookes</surname><given-names>Maria</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Keane</surname><given-names>Jacqueline A.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Parkhill</surname><given-names>Julian</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Pathogen Genomics, The Wellcome Trust Sanger Institute</institution>, Wellcome Trust Genome Campus, Hinxton, Cambridge, <country>UK</country>.</aff>
<aff id="a2"><label>2</label><institution>Department of Medicine, University of Cambridge</institution>, <country>UK</country>.</aff>
<aff id="a3"><label>3</label><institution>School of Medicine</institution>, North Haugh, St Andrews, <country>UK</country>.</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>To whom correspondence should be addressed.</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2015</year></pub-date>
<elocation-id>019315</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="019315.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<sec>
<title>Summary</title>
<p>A typical prokaryote population sequencing study can now consist of hundreds or thousands of isolates. Interrogating these datasets can provide detailed insights into the genetic structure of of prokaryotic genomes. We introduce Roary, a tool that rapidly builds large-scale pan genomes, identifying the core and dispensable accessory genes. Roary makes construction of the pan genome of thousands of prokaryote samples possible on a standard desktop without compromising on the accuracy of results. Using a single CPU Roary can produce a pan genome consisting of 1000 isolates in 4.5 hours using 13 GB of RAM, with further speedups possible using multiple processors.</p>
</sec>
<sec sec-type="availability">
<title>Availability and implementation</title>
<p>Roary is implemented in Perl and is freely available under an open source GPLv3 license from <ext-link ext-link-type="uri" xlink:href="http://sanger-pathogens.github.io/Roary">http://sanger-pathogens.github.io/Roary</ext-link></p>
</sec>
<sec>
<title>Contact</title>
<p><email>roary@sanger.ac.uk</email></p>
</sec>
<sec sec-type="supplementary-material">
<title>Supplementary information</title>
<p>Supplementary data are available at <italic>Bioinformatics</italic> online.</p>
</sec>
</abstract>
<counts>
<page-count count="3"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>INTRODUCTION</title>
<p>The term microbial pan genome was first used in 2005 (<xref ref-type="bibr" rid="c5">Medini <italic>et al.</italic>, 2005</xref>) to describe the union of genes shared by genomes of interest (<xref ref-type="bibr" rid="c9">Vernikos <italic>et al.</italic>, 2014</xref>). Since then, availability of microbial sequencing data has grown exponentially. Aligning whole genome sequenced isolates to a single reference genome can fail to incorporate non-reference sequences. By using <italic>de novo</italic> assemblies, non-reference sequence can also be analysed. Microbial organisms can rapidly acquire genes from other organisms that can increase virulence or promote antimicrobial drug resistance (<xref ref-type="bibr" rid="c5">Medini <italic>et al.</italic>, 2005</xref>). Gaining a better picture of the conserved genes of an organism, and the dispensable accessory genome, can lead to a better understanding of key processes such as selection and evolution.</p>
<p>The construction of a pan genome is NP-hard (<xref ref-type="bibr" rid="c6">Nguyen <italic>et al.</italic>, 2014</xref>) with additional difficulties from real data due to contamination, fragmented assemblies and poor annotation. Therefore any approach must employ heuristics in order to produce a pan genome (reviewed in (<xref ref-type="bibr" rid="c9">Vernikos <italic>et al.</italic>, 2014</xref>)). The most complete standalone pan genome tools are: PanOCT (<xref ref-type="bibr" rid="c3">Fouts <italic>et al.</italic>, 2012</xref>), which uses conserved gene neighborhood in addition to homology to accurately place proteins into orthologous clusters; and PGAP which takes annotated assemblies, performs an all-against-all BLAST, clusters the results, and produces a pan genome (<xref ref-type="bibr" rid="c10">Zhao <italic>et al.</italic>, 2012</xref>).</p>
<p>PanOCT and PGAP require an all-against-all comparison using BLAST, which means the running time grows non-linearly with the size of input data and is computationally infeasible with large datasets. They also have non-linear memory requirements, quickly exceeding the RAM available in high performance servers for large datasets. We have developed a method to generate the pan genome of a set of related prokaryotic isolates. It works with thousands of isolates in a computationally feasible time, beginning with annotated fragmented <italic>de novo</italic> assemblies. We address the computational issues by performing a rapid clustering of highly similar sequences, which can reduce the running time of BLAST substantially, and carefully manage RAM usage so that it increases linearly, both of which make it possible to analyse datasets with thousands of samples using commonly available computing hardware.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>DESCRIPTION</title>
<p>The input to Roary is one annotated assembly per sample in GFF3 format (<xref ref-type="bibr" rid="c8">Stein, 2013</xref>), such as that produced by Prokka (<xref ref-type="bibr" rid="c7">Seemann, 2014</xref>), where all samples are from the same species. Coding regions are extracted from the input and converted to protein sequences, filtered to remove partial sequences and iteratively pre-clustered with CD-HIT (<xref ref-type="bibr" rid="c4">Fu <italic>et al.</italic>, 2012</xref>). This results in a substantially reduced set of protein sequences. An all-against-all comparison is performed with BLASTP on the reduced sequences with a user defined percentage sequence identity (default 98&#x0025;). Low complexity regions are masked out (<xref ref-type="bibr" rid="c1">Camacho <italic>et al.</italic>, 2008</xref>). Sequences are then clustered with MCL (<xref ref-type="bibr" rid="c2">Enright <italic>et al.</italic>, 2002</xref>) and finally the pre-clustering results from CD-HIT are merged together with the results of MCL. Using conserved gene neighbourhood information, homologous groups containing paralogs are split into groups of true orthologs. A graph is constructed of the relationships of the clusters based on the order of occurrence in the input sequences, allowing for the clusters to be ordered and thus providing context for each gene. Full details of the method and outputs are provided in the Supplementary Material.</p>
</sec>
<sec id="s3">
<label>3</label>
<title>RESULTS</title>
<p>We evaluated the accuracy, running time and memory usage of Roary against two similar standalone pan genome applications. In each case we performed the analysis using a single processor (AMD Opteron 6272), and provided 60GB of RAM. Analysis was halted after two days if the applications failed to return a result for the given dataset. We constructed a simulated dataset based on <italic>Salmonella enterica</italic> serovar Typhi (<italic>S. typhi</italic>) CT18, accession AL513382 allowing us to accurately assess the quality of the clustering. We created 12 genomes with 994 identical core genes and 23 accessory genes in varying combinations. All of the applications created clusters that are within 1&#x0025; of the expected results, with Roary correctly building all genes as shown in <xref ref-type="table" rid="tbl1">Table 1</xref>. The overlap of the clusters is virtually identical in all applications.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Accuracy of each pan genome application on a dataset of simulated data</p></caption>
<graphic xlink:href="019315_tbl1.tif"/>
</table-wrap>
<p>In addition, a set of 1000 real annotated assemblies of <italic>S. typhi</italic> genomes was used. Subsets of the data were provided to each application and the running time and memory usage were noted. The running time of PGAP and PanOCT increases substantially, making only small datasets computationally feasible (<xref ref-type="fig" rid="fig1">Fig. 1</xref> and Sup. Fig. 1-8). Roary scales consistently as more samples are added (Sup. Fig. 1-8) and has been shown to work on a dataset of 1000 isolates as shown in <xref ref-type="table" rid="tbl2">Table 2</xref>. The memory usage of PGAP and PanOCT also increases rapidly as more samples are added, quickly exceeding 60GB for even small datasets. The memory usage of Roary scales consistently as more samples are added, making it feasible to process large data sets on a standard desktop computer within a few hours. We conducted similar experiments with more diverse datasets including <italic>S. pneumonia</italic>, <italic>S. aureus</italic>, and <italic>Y. enterocolitica</italic> and the results show/exhibit similar speed-ups as shown in Sup Figs 7-8.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><p>Effect of dataset size on the wall time of multiple applications.</p></caption>
<graphic xlink:href="019315_fig1.tif"/>
</fig>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>Comparison of pan genome applications using real <italic>S. typhi</italic> data (ERP001718).</p></caption>
<graphic xlink:href="019315_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s4">
<label>4</label>
<title>DISCUSSION</title>
<p>We have shown that Roary can construct the pan genomes of large collections of bacterial genomes using a desktop computer, where it was not previously computationally possible with other methods. Further speedups in running time are possible by providing more processors to Roary. On simulated data Roary is the only application to correctly identify all clusters. This increased accuracy comes from using the context provided by conserved gene neighbourhood information. Roary scales well on large real datasets, identifying large numbers of core genes, even in the presence of a varied open pan genome.</p>
</sec>
</body>
<back>
<ack>
<title>ACKNOWLEDGEMENTS</title>
<p>This work was supported by the Wellcome Trust (grant number WT 098051).</p>
</ack>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><mixed-citation publication-type="other"><string-name><surname>Camacho</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> (<year>2008</year>) <source>BLAST Command Line Applications User Manual Bethesda (MD)</source>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Enright</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal> (<year>2002</year>) <article-title>An efficient algorithm for large-scale detection of protein families</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>1575</fpage>&#x2013;<lpage>1584</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Fouts</surname>, <given-names>D.E.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>) <article-title>PanOCT: automated clustering of orthologs using conserved gene neighborhood for pan-genomic analysis of bacterial strains and closely related species</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>e172</fpage>&#x2013;<lpage>e172</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Fu</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>) <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3150</fpage>&#x2013;<lpage>3152</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Medini</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> (<year>2005</year>) <article-title>The microbial pan-genome</article-title>. <source>Curr. Opin. Genet. Dev.</source>, <volume>15</volume>, <fpage>589</fpage>&#x2013;<lpage>594</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> (<year>2014</year>) <article-title>Building a Pangenome Reference for a Population</article-title>. In, <source>Research in Computational Molecular Biology</source>., pp. <fpage>207</fpage>&#x2013;<lpage>221</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Seemann</surname>, <given-names>T.</given-names></string-name> (<year>2014</year>) <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2068</fpage>&#x2013;<lpage>2069</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Stein</surname>, <given-names>L.</given-names></string-name> (<year>2013</year>) <article-title>Generic Feature Format Version 3 (GFF3)</article-title>. <source>Seq. Ontol. Proj., 1.21</source>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Vernikos</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> (<year>2014</year>) <article-title>Ten years of pan-genome analyses</article-title>. <source>Curr. Opin. Microbiol.</source>, <volume>23C</volume>, <fpage>148</fpage>&#x2013;<lpage>154</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>) <article-title>PGAP: pan-genomes analysis pipeline</article-title>. <source>Bioinforma</source>., <volume>28</volume>, <fpage>416</fpage>&#x2013;<lpage>418</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
