<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/020966</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Tools and pipelines for BioNano data: molecule assembly pipeline and FASTA super scaffolding tool</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Shelton</surname><given-names>Jennifer M</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Coleman</surname><given-names>Michelle C</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Herndon</surname><given-names>Nic</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Lu</surname><given-names>Nanyan</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Lam</surname><given-names>Ernest T</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Anantharaman</surname><given-names>Thomas</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author">
<name><surname>Sheth</surname><given-names>Palak</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Brown</surname><given-names>Susan J</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3756-5270</contrib-id>
</contrib>
<aff id="a1"><label>1</label><institution>KSU/K-INBRE Bioinformatics Center, Division of Biology, Kansas State University</institution>, Manhattan, KS, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>BioNano Genomics</institution>, San Diego, CA, <country>USA</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Correspondence: <email>sjbrown@ksu.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2015</year></pub-date>
<elocation-id>020966</elocation-id>
<history>
<date date-type="received"><day>15</day><month>6</month><year>2015</year></date>
<date date-type="accepted"><day>15</day><month>6</month><year>2015</year></date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
</license>
</permissions>
<self-uri xlink:href="020966.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<sec>
<title>Background</title>
<p>Genome assembly remains an unsolved problem. Assembly projects face a range of hurdles that confound assembly. Thus a variety of tools and approaches are needed to improve draft genomes.</p>
</sec>
<sec>
<title>Results</title>
<p>We used a custom assembly workflow to optimize consensus genome map assembly, resulting in an assembly equal to the estimated length of the <italic>Tribolium castaneum</italic> genome and with an N50 of more than 1 Mb. We used this map for super scaffolding the <italic>T. castaneum</italic> sequence assembly, more than tripling its N50 with the program Stitch.</p>
</sec>
<sec>
<title>Conclusions</title>
<p>In this article we present software that leverages consensus genome maps assembled from extremely long single molecule maps to increase the contiguity of sequence assemblies. We report the results of applying these tools to validate and improve a 7x Sanger draft of the <italic>T. castaneum</italic> genome.</p>
</sec>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Genome map</kwd>
<kwd>BioNano</kwd>
<kwd>Genome scaffolding</kwd>
<kwd>Genome validation</kwd>
<kwd>Genome finishing</kwd>
</kwd-group>
<counts>
<page-count count="24"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Background</title>
<p>The quality and contiguity of genome assemblies, which impacts downstream analysis, varies greatly [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>]. Initial assembly drafts, whether based on lower coverage Sanger or higher coverage NGS reads, are often highly fragmented. Physical maps of BAC clones can be used to validate and scaffold sequence assemblies, but the molecular, human, and computational resources required to significantly improve a draft genome are often not available to researchers working on non-model organisms. The BioNano Irys&#x00AE; System provides affordable, high throughput physical maps of significantly higher contiguity with which to validate draft assemblies and extend scaffolds [<xref ref-type="bibr" rid="c4">4</xref>].</p>
<p>Genome assembly and scaffolding algorithms are inherently limited by the length of the DNA molecules used as starting material to generate data. Specifically, if repetitive, polymorphic or low complexity regions are longer than the single molecules used to generate data, then they cannot be resolved by bioinformatics tools with certainty. The specifications for PacBio P6-C4 chemistry [<xref ref-type="bibr" rid="c5">5</xref>] indicate that PacBio reads have an N50 of 14 kb with a maximum length of 40 kb. Illumina Long Distance Jump Libraries can also span 40 kb [<xref ref-type="bibr" rid="c6">6</xref>]. MinION nanopore sequence reads have an average read length of <italic>&#x003C;</italic> 7 kb [<xref ref-type="bibr" rid="c7">7</xref>]. Illumina TruSeq synthetic long-reads can span up to 18.5 kb; however, they fail to assemble if the sequence has problematic regions longer than the component reads used to assemble the synthetic reads (e.g. in the heterochromatin) [<xref ref-type="bibr" rid="c8">8</xref>]. The OpGen Argus [<xref ref-type="bibr" rid="c9">9</xref>] platform produces optical maps that have a length of 150 kb to 2 Mb from up to 13 Gb data collected per run [<xref ref-type="bibr" rid="c10">10</xref>]. The Irys System from BioNano Genomics produces single molecule maps that have an average length of 225 kb from up to 96 Gb data collected per run after filtering for molecules <italic>&#x003C;</italic> 150 kb [<xref ref-type="bibr" rid="c11">11</xref>]. Genomic repeats can be much longer than the 5-40 kb that many technologies can span with a single molecule. In fact, a recent study used consensus genome maps (assembled from single molecule maps <italic>&#x003E;</italic> 150 kb) to identify repeats that are hundreds of kb in the human genome [<xref ref-type="bibr" rid="c12">12</xref>].</p>
<p>Sequence-based assembly methods are fraught with platform-specific error profiles (e.g. resolving homopolyer repeats or read-position effects on base quality) [<xref ref-type="bibr" rid="c13">13</xref>]. Map-based approaches offer an orthogonal genomic resource that complements sequence-based approaches but not their error profiles. For example, map-based error profiles tend to consider errors in estimated molecule or fragment length and errors associated with restriction sites that are too close together, neither of which influence sequence-based approaches [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. Both the BioNano Irys System and OpGen Argos platform provide single molecule maps from genomic DNA. OpGen may provide higher resolution maps by using enzymes with a six rather than a seven base pair recognition site, but BioNano&#x2019;s single molecule maps still deliver a more efficient and affordable method for generating whole genome maps.</p>
<sec id="s1a">
<title>Data formats</title>
<p>The tools described make use of three file formats developed by BioNano. The Irys System images extremely long molecules of genomic DNA that are nick-labeled at seven bp motifs using one or more nicking endonucleases and fluorescently labeled nucleotides. Molecules captured in TIFF images are converted to BNX format text files that describe the detected label position for each molecule (<xref ref-type="fig" rid="fig1">Figure 1(1-2)</xref>). The individual molecules described in BNX files are referred to as single molecule maps. Consensus Map (CMAP) files include the molecule map lengths and label positions for long genomic regions that are either inferred from assembly of raw single molecule maps (<xref ref-type="fig" rid="fig1">Figure 1(7-8)</xref>) or <italic>in silico</italic> from sequence scaffolds (<xref ref-type="fig" rid="fig1">Figure 1(3-4)</xref>). Individual maps in these two types of CMAP files are referred to as a consensus genome map or an <italic>in silico</italic> map, respectively. The alignment between two CMAP files is stored as an XMAP file that includes alignment coordinates and an alignment confidence score (<xref ref-type="fig" rid="fig1">Figure 1(10)</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1</label>
<caption>
<title>Data analysis steps.</title>
<p>(1) Autodetect analyzes TIFF images of molecules and (2) outputs BNX text files. (3) Sequence scaffolds are digested <italic>in silico</italic> with fa2cmap multi producing (4) <italic>in silico</italic> maps. (5) AssembleIryscluster uses <italic>in silico</italic> maps, BNX files and estimated genome size to (6) normalize molecule stretch and set assembly parameters. (7) Assembler produces (8) a consensus genome map. (9) RefAligner aligns the consensus genome maps to the <italic>in silico</italic> maps producing (10) an XMAP alignment file. (11) XMAP, <italic>in silico</italic> maps and consensus genome maps (see arrows with dashed lines) are used by stitch to produce super scaffolded (stitched) sequence scaffolds. (13) Until no more super scaffolds are created the stitched sequence scaffolds are digested <italic>in silico</italic> with fa2cmap multi producing (14) a CMAP that is aligned to (9) the consensus genome maps and steps 10-15 are iterated. Arrows with dotted rather than dashed lines are used to as input during iterations.</p></caption>
<graphic xlink:href="020966_fig1.tif"/>
</fig>
</sec>
<sec id="s1b">
<title>Other software tools for scaffolding with BioNano data</title>
<p>BioNano Genomics developed the Hybrid Scaffold tool to create more contiguous consensus genome maps using information from both sequence and BioNano genome map data. These more contiguous maps can then be used to create more contiguous sequence assemblies. The Hybrid Scaffold software first creates hybrid <italic>in silico</italic>/consensus genome map contigs based on an alignment between the two. The output genome maps are called hybrid scaffolds and are aligned to the original <italic>in silico</italic> maps. This alignment is used to output a FASTA file of sequence super scaffolds. These sequences include seven base pair ambiguous-base motifs to indicate where labels occur within gaps. Because they extend into regions with consensus genome maps but without sequence data they may begin or end with gaps. The Hybrid Scaffold program only generates hybrid <italic>in silico</italic>/consensus genome map contigs, and therefore super scaffolds, if no conflicts (e.g. negative gap lengths or otherwise conflicting alignments) are indicated in the alignment of <italic>in silico</italic> and consensus genome maps. In this conservative approach, all conflicting alignments are excluded from the hybrid scaffold genome map and flagged for further evaluation at the sequence level.</p>
</sec>
<sec id="s1c">
<title>Motivation</title>
<p>We designed tools and workflows to optimize the use of single molecule maps in the construction of whole genome maps and then use the best resultant consensus genome map to improve contiguity of draft genome sequence assemblies. Single-molecule maps were assembled into BioNano genome maps <italic>de novo</italic> using software tools developed at BioNano [<xref ref-type="bibr" rid="c12">12</xref>]. As with sequence-based assembly algorithms, it was noted that testing a range of assembly parameters can improve final assembly quality for the BioNano Assembler. Additionally, applying error correction to molecule map stretch was found to improve assembly quality. Therefore, we created AssembleIrysCluster to normalize molecule map stretch and automate the writing of assembly scripts that use various parameters. We created the Stitch tool to super scaffold sequence-based assemblies using alignments to the optimal BioNano genome map. The Hybrid Scaffold and Stitch tools for genome finishing both take alignments from the BioNano RefAligner as input. Both tools were developed simultaneously but were ultimately found to be useful for distinct applications. We validated AssembleIrysCluster and Stitch using the <italic>Tribolium castaneum</italic> genome [<xref ref-type="bibr" rid="c15">15</xref>] because this project has genetic map resources [<xref ref-type="bibr" rid="c16">16</xref>] that offer independent corroboration.</p>
</sec>
</sec>
<sec id="s2">
<title>Implementation</title>
<sec id="s2a">
<title>Assembly Preparation</title>
<p>We developed AssembleIrysCluster to prepare BNX files for assembly and produce nine customized assembly scripts (<xref ref-type="fig" rid="fig2">Figure 2C-G</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2</label>
<caption>
<title>Assembly workflow for assemble SGE cluster.pl.</title>
<p>(A) The Irys instrument produces tiff files that are converted into BNX text files. (B) One BNX file is produced for each flowcell on a IrysChip. (C) BNX files are split by scan and aligned to the sequence reference. Stretch (bases per pixel) is recalculated for each scan from the alignment. (D) Quality check graphs are created for each pre-adjusted flowcell BNX. (E) Adjusted flowcell BNXs are merged. (F) The first assemblies are run with a variety of p-value thresholds. (G) The best first assemblies (red oval) is chosen and a version of this assembly is produced with a variety of minimum molecule length filters.</p></caption>
<graphic xlink:href="020966_fig2.tif"/>
</fig>
<sec id="s2a1">
<title>Molecule Stretch</title>
<p>In the first stage, AssembleIrysCluster adjusts single molecule map stretch (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). BioNano software operates under the assumption that imaged molecules contain 500 bases per pixel (bpp). Stretch, or bpp, can deviate from 500 bpp and this discrepancy can vary from scan to scan within a flowcell (Additional file 1). Sequence scaffolds are considered to be more accurate than raw BNX molecules in terms of label positions. Therefore molecule maps in BNX files are split by scan, and after alignment to the <italic>in silico</italic> maps, an empirical average bpp value is determined for the molecule maps in each scan. The bpp indicated by this alignment is used by RefAligner to adjust molecule map bpp to 500. Once stretch has been evaluated and normalized, the split BNX files are merged into a single file (<xref ref-type="fig" rid="fig2">Figure 2E</xref>).</p>
<p>We observed consistent patterns of empirically determined bpp between flowcells using the same flowcell model and chemistry when signal-to-noise ratios are optimal and the degree of genomic divergence between the samples used for the <italic>in silico</italic> maps and molecule maps are low (Additional file 1). To identify the low quality flowcells, bpp observed in alignments of scans are plotted as a QC graph by AssembleIrysCluster (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p>
</sec>
<sec id="s2a2">
<title>Customization of BioNano Assembly Scripts</title>
<p>In the next stage, AssembleIrysCluster creates various assembly scripts to explore a range of parameter sets with the goal of selecting the optimal assembly for down-stream analysis (<xref ref-type="fig" rid="fig2">Figure 2F-G</xref>). Single molecule maps in the adjusted merged BNX file are aligned to the <italic>in silico</italic> maps. An alignment error profile generated by RefAligner is used with the estimated genome length to calculate default assembly parameters; and the eight other scripts that include variants of these parameters. Initially, three assemblies are run, the first with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="020966_inline1.gif"/></alternatives></inline-formula>, the second with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="020966_inline2.gif"/></alternatives></inline-formula> and the third with <italic>p</italic>-<italic>ValueThresholdRelaxed</italic> &#x003D; <italic>p</italic>-<italic>ValueThreshold</italic> &#x00D7; 10 (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). The minimum molecule length is set to 150 kb. If one of these runs does not produce a satisfactory assembly, then two minimum molecule length variants (180 kb and 100 kb) are tested with the <italic>p</italic>-<italic>ValueThreshold</italic> of the current best assembly (<xref ref-type="fig" rid="fig2">Figure 2G</xref>). Between three and nine assemblies are run until a satisfactory assembly is produced.</p>
</sec>
<sec id="s2a3">
<title>BioNano Assembly Optimization</title>
<p>The ultimate goal is to produce consensus genome maps that can be used to guide sequence-based haploid reference genome assembly. While single molecule maps can be used to reconstruct haplotypes [<xref ref-type="bibr" rid="c17">17</xref>], genome assembly involves collapsing polymorphisms arbitrarily into a consensus reference genome. Therefore the cumulative length of ideal consensus genome maps should equal the haploid genome length. Additionally, 100&#x0025; of the consensus genome maps would align non-redundantly to 100&#x0025; of the <italic>in silico</italic> maps. In practice, the best BioNano assembly is selected based on similarity to the estimated haploid genome length and minimal alignment redundancy to the reference <italic>in silico</italic> maps.</p>
</sec>
<sec id="s2a4">
<title>Stitch: Alignment Filters</title>
<p>For each RefAligner alignment the user designates a reference file with <italic>in silico</italic> maps from either a draft or reference quality genome or, if the user is aligning two files that both contain consensus genome maps, then a file of consensus genome maps. Additionally, the user specifies a query file with either single molecule maps or consensus genome maps.</p>
<p>We designed the Stitch algorithm to use alignments of query consensus genome maps to reference <italic>in silico</italic> maps in order to predict the higher order arrangement of sequence scaffolds (<xref ref-type="fig" rid="fig3">Figure 3</xref>). RefAligner assumes the alignment reference has the error profile of <italic>in silico</italic> maps and the query has the error profile of consensus genome maps. Therefore alignments are run with the <italic>in silico</italic> maps as the reference, and are inverted and sorted by consensus genome map coordinates for efficient parsing by Stitch (<xref ref-type="fig" rid="fig3">Figure 3A-B</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3</label>
<caption>
<title>Steps of the stitch.pl algorithm.</title>
<p>Consensus genome maps (blue) are shown aligned to <italic>in silico</italic> maps (green). Alignments are indicated with grey lines. CMAP orientation for <italic>in silico</italic> maps is indicated with a &#x201D;&#x002B;&#x201D; or &#x201D;-&#x201D; for positive or negative orientation respectively. (A) The <italic>in silico</italic> maps are used as the reference. (B) The alignment is inverted and used as input for stitch.pl. (C) The alignments are filtered based on alignment length (purple) relative to total possible alignment length (black) and confidence. Here assuming all alignments have high confidence scores and the minimum percent aligned is 30&#x0025; two alignments fail for aligning over less than 30&#x0025; of the potential alignment length for that alignment. (D) Filtering produces an XMAP of high quality alignments with short (local) alignments removed. (E) High quality scaffolding alignments are filtered for longest and highest confidence alignment for each <italic>in silico</italic> map. The third alignment (unshaded) is filtered because the second alignment is the longest alignment for <italic>in silico</italic> map 2. (F) Passing alignments are used to super scaffold (captured gaps indicated in dark green). (G) Stitch is iterated and additional super scaffolding alignments are found using second best scaffolding alignments. (H) Iteration takes advantage of cases where <italic>in silico</italic> maps scaffold consensus genome maps as <italic>in silico</italic> map 2 does. Stitch is run iteratively all until super scaffolding alignments are found.</p></caption>
<graphic xlink:href="020966_fig3.tif"/>
</fig>
<p>Before inferring super scaffolds from XMAP files, Stitch filters low quality alignments by confidence score. Alignments of <italic>in silico</italic> and consensus genome maps are assigned a confidence score that is the &#x2212;<italic>log</italic>10 of the <italic>False Positive p</italic>-<italic>Value</italic>. Misaligned labels and sizing error increase the alignment <italic>False Positive p</italic>-<italic>Value</italic> and decrease confidence scores [<xref ref-type="bibr" rid="c18">18</xref>].</p>
<p>Super scaffolds are built from overlapping alignments. Overlapping alignments are similar to global alignments, i.e., alignments spanning from end to end for two maps of roughly equal length, but to search for overlap alignment gaps after the ends of either map are not penalized. The RefAligner scoring scheme does not currently have a parameter to favor overlapping alignments, e.g., to initialize the dynamic programming matrix with no penalties and take the maximum score of the final row or column in the matrix. RefAligner reports local alignments between two maps and applies a fixed penalty based on the user-defined likelihood of unaligned labels at the ends of the alignment. Raising or lowering this penalty selects for local or global alignments, respectively, but neither option favors overlapping alignments specifically. Stitch filters by the percent of the total possible alignment length that is aligned (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). To approximate scoring that favors overlapping alignments, Stitch uses thresholds for minimum percent of total possible aligned length, the percent aligned threshold (PAT).</p>
<p>Similar to scoring structures that favor overlapping alignments, PAT filters out local alignments. However, unlike a scoring structure, PAT is applied after alignment and therefore cannot result in the aligner exploring possible extensions into an overlap but instead favors a shorter local alignment with a higher cumulative score. Therefore Stitch accepts alignments with less than 100&#x0025; PAT. Default values for the PAT were determined empirically after reviewing the degree to which filtered alignments agreed with the independently derived genetic maps of <italic>T. castaneum</italic> and by visual inspection of alignments.</p>
<p>In practice we used two sets of alignment filters and kept alignments that passed one or both sets. The first set had a low PAT and a high confidence score threshold. The second set had a higher PAT and a lower confidence score and was intended to identify longer overlaps especially in regions of the genome where label density is low.</p>
</sec>
<sec id="s2a5">
<title>Stitch: Super scaffolding</title>
<p>Scaffolding alignments are selected from the remaining high quality alignments (i.e., more than one <italic>in silico</italic> map aligns to the same consensus genome map (<xref ref-type="fig" rid="fig3">Figure 3D</xref>)). For each <italic>in silico</italic> map with more than one high quality, scaffolding alignment the longest alignment for the <italic>in silico</italic> map is selected (<xref ref-type="fig" rid="fig3">Figure 3D-E</xref>). If alignment length is identical then the highest confidence alignment is selected. If confidence scores are identical then an alignment is chosen arbitrarily.</p>
<p>Gap lengths between <italic>in silico</italic> maps are inferred from scaffolding alignments and used to create new super scaffolds (<xref ref-type="fig" rid="fig3">Figure 3F</xref>) in a new genome FASTA file and associated AGP file. If gap lengths are estimated to be negative, Stitch adds a 100 bp spacer gap to the sequence file and indicates that the gap is type &#x201D;U&#x201D; for unknown in the AGP.</p>
<p>Stitch only makes use of one alignment per <italic>in silico</italic> map each iteration. Stitch can be run iteratively (<xref ref-type="fig" rid="fig1">Figure 1</xref>(10-15)) such that each successive output FASTA file is converted into <italic>in silico</italic> maps and aligned to the original consensus genome maps. This alignment is inverted and used as input for the next iteration. Subsequent iterations of Stitch will make use of any <italic>in silico</italic> maps that join growing super scaffolds, effectively using both sequence data and genome maps to stitch together the final super scaffolds (<xref ref-type="fig" rid="fig3">Figure 3G-H</xref>).</p>
</sec>
<sec id="s2a6">
<title>Stitch: Flagging Potential Mis-assemblies</title>
<p>This algorithm is meant to be an intermediate refinement of draft genomes prior to further fine scale refinement at the sequence level. Inconsistencies between the consensus genome maps and the <italic>in silico</italic> maps are reported in output logs to facilitate downstream sequence editing. If an alignment passes initial confidence score and PAT filtering but has a PAT less than 60&#x0025;, this is reported as a partial alignment. A partial alignment may occur if either the sequence scaffold or the consensus genome map is the result of a chimeric or erroneous assembly. Additionally, if a gap length is estimated to be negative, it may indicate that the sequence scaffolds can be joined with a local assembly or that an incorrect assembly needs to be broken within a scaffold. Assembly errors in the consensus genome maps or spurious alignments could also result in either of these cases. Ideally researchers could make use of the alignment of genomic sequence reads to the genome sequence assembly and the alignment of single molecule maps to the consensus genome maps to determine which assembly is likely to be incorrect.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results and Discussion</title>
<sec id="s3a">
<sec id="s3a1">
<title>Dataset generation</title>
<p>High molecular weight DNA was isolated from young <italic>Tribolium castaneum</italic> pupae from the GA2 line that was inbred 20 generations. The GA2 line was also used for the genome sequence-based assembly.</p>
<p>Using Knickers (BioNano Genomics), an <italic>in silico</italic> label density calculator, we estimated that the <italic>Tribolium castaneum</italic> genome had 8.66 and 5.51 labels per 100 kb for the nt.BspQI and nt.BbvCI enzymes (New England BioLabs) respectively. The ideal number of labels per 100 kb is between 10 and 15 therefore we nicked with both enzymes. DNA was nicked, labeled with fluorescent nucleotides, and repaired according to BioNano protocol; and 93 BNX files were produced from the Irys genome mapping system (<xref ref-type="fig" rid="fig4">Figure 4</xref> and Additional file 2). Four corrupted files (cumulative length &#x003D; 0) were excluded from this analysis. All <italic>T. castaneum</italic> BNX files have been deposited to labarchives (doi:10.6070/H4V69GK3).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4</label>
<caption>
<title>Cumulative length per BNX file for T. castaneum data generated over time.</title>
<p>Cumulative length of single molecule maps &#x003E; 150 kb are plotted on the y-axis (purple X), the upgrade to the V2 IrysChip (grey dashed line) is plotted and date is indicated on the x-axis. Data was generated from 03-2013 to 01-2014. Aborted runs (cumulative length &#x003D; 0) excluded.</p></caption>
<graphic xlink:href="020966_fig4.tif"/>
</fig>
<p>The high number of BNX files produced is due to several factors. Typically one BNX file is produced per flowcell; however, in certain cases after the initial number of scans, additional scans were run producing an additional BNX file. Another reason for the large number of files is that data was originally generated using the IrysChip&#x00AE; V1 while the Irys System was under beta testing. Over time, maximum cumulative length per BNX file increased (<xref ref-type="fig" rid="fig4">Figure 4</xref> and Additional file 2). After the upgrade to the IrysChip V2, an increase was also observed in maximum data per BNX file (<xref ref-type="fig" rid="fig4">Figure 4</xref> and Additional file 2).</p>
<p>Molecule map quality metrics were calculated using bnx stats (version 1.0). We generated &#x223C;250x coverage of the <italic>T. castaneum</italic> genome for single molecule maps <italic>&#x003E;</italic>150 kb, the default minimum molecule map length. The 239,558 single molecule maps with lengths <italic>&#x003E;</italic>150kb had an N50 of 202.63 kb and a cumulative length of 50.6 Gb (<xref ref-type="table" rid="tbl1">Table 1</xref>). Histograms of per-molecule quality metrics for maps after applying a minimum length filter of either 100 kb, 150 kb and 180kb are reported in Additional file 3.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1</label>
<caption><p>Single molecule maps from <italic>T. castaneum</italic> filtered by minimum length. Molecule map N50, cumulative length and number of maps are listed for all three molecule length filters for the <italic>T. castaneum</italic> genome data.</p></caption>
<graphic xlink:href="020966_tbl1.tif"/>
</table-wrap>
<p>To generate the <italic>in silico</italic> maps, we used the sequence-based assembly scaffolds from version 5.0 of the <italic>Tribolium castaneum</italic> genome (Tcas5.0). Version 5.0 (<xref ref-type="table" rid="tbl2">Table 2</xref>) of the <italic>T. castaneum</italic> genome is an updated version of the sequence assembly that was created by adding 1.03 Mb of sequence to version 3.0 [<xref ref-type="bibr" rid="c15">15</xref>]. Two hundred and twenty-three of the 2240 scaffolds within Tcas5.0 were longer than 20 kb with more than 5 labels, the minimum requirements for an <italic>in silico</italic> map. These longer sequence scaffolds represent the bulk of the sequence assembly, 152.53 of the 160.74 Mb (<xref ref-type="table" rid="tbl2">Table 2</xref>).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2</label>
<caption><p><italic>T. castaneum</italic> assembly summary. Assembly metrics for Tcas5.0 (the starting sequence scaffolds), the Tcas5.0 <italic>in silico</italic> maps, the consensus genome map of assembled molecule maps, the automated output of Stitch (Tcas5.1), the manually curated sequence assembly (Tcas5.2) and the sequence assembly produced by the BioNano Hybrid Scaffold software for the <italic>T. castaneum</italic> genome.</p></caption>
<graphic xlink:href="020966_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s3a2">
<title>Assembly: Selecting the Optimal BioNano Assembly</title>
<p>Single molecule maps were assembled <italic>de novo</italic> into five distinct BioNano genome maps for <italic>T. castaneum</italic>.</p>
<p>Molecule maps were prepared for assembly (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) and noise parameters were estimated (<xref ref-type="fig" rid="fig2">Figure 2D-E</xref>) using AssembleIrysCluster (version 1.0). Next, three genome maps were assembled using the relaxed, default and strict &#x201D;-T&#x201D; parameters (5e-10, 5e-09 and 5e-08), the stretch-adjusted molecule maps and customized noise parameters. Assemblies with these p-value thresholds are named <italic>Relaxed</italic>-<italic>T</italic>, <italic>Default</italic>-<italic>T</italic> and <italic>Strict</italic>-<italic>T</italic>, respectively.</p>
<p>In the first round of selection, the <italic>Strict</italic>-<italic>T</italic> assembly was the best of these three assemblies because it has a cumulative size close to 200 Mb (<xref ref-type="table" rid="tbl2">Table 2</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>), the estimated size of the <italic>T. castaneum</italic> genome, and a small difference between non-redundant aligned length or breadth of alignment, and total aligned length (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="table" rid="tbl3">Table 3</xref> and Additional file 4). Thus in the second round of selection, <italic>Strict</italic>-<italic>T</italic> parameter was used for two further assemblies that had relaxed minimum molecule length (<italic>Relaxed</italic>-<italic>Minlen</italic>) of 100 kb rather than the 150 kb default or a strict minimum molecule length (<italic>Strict</italic>-<italic>Minlen</italic>) of 180 kb. The <italic>Strict</italic>-<italic>T AndStrict</italic>-<italic>M inlen</italic> assembly improved alignments by reducing redundancy slightly. However the cumulative length of the assembly was 21.45 Mb smaller than the estimated genome size. The <italic>Strict</italic>-<italic>T AndRelaxed</italic>-<italic>Minlen</italic> assembly had a worse cumulative length and alignment redundancy than the <italic>Strict</italic>-<italic>T</italic> assembly. Because neither of the assemblies using 100 or 180 kb as the minimum molecule length improved both assembly metrics when compared to the <italic>Strict</italic>-<italic>T</italic> assembly, generated in the first round of selection with the default <italic>Minlen</italic> of 150 kb, the <italic>Strict</italic>-<italic>T</italic> assembly will be referred to as the <italic>T. castaneum</italic> consensus genome maps in further analysis.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3</label>
<caption><p>Alignment of <italic>T. castaneum</italic> consensus genome maps to the <italic>in silico</italic> maps of Tcas5.0. Breadth of alignment coverage (non-redundant alignment), length of total alignment (including redundant alignments) and percent of CMAP covered (non-redundantly) were calculated for the <italic>in silico</italic> maps and the consensus genome maps of the <italic>T. castaneum</italic> genome the using xmap stats.pl.</p></caption>
<graphic xlink:href="020966_tbl3.tif"/>
</table-wrap>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5</label>
<caption>
<title>Comparison of assemblies from the T. castaneum single molecule maps using five sets of parameters.</title>
<p>Relaxed, default and strict &#x201D;-T&#x201D; parameters were set to 5e-08, 5e-09 and 5e-10. Relaxed, default and strict minimum molecule length were set to 100, 150 and 180 kb.</p></caption>
<graphic xlink:href="020966_fig5.tif"/>
</fig>
<p>The <italic>T. castaneum</italic> consensus genome maps have an N50 of 1.35 Mb, a cumulative length of 200.47 Mb, and 216 genome maps (<xref ref-type="table" rid="tbl2">Table 2</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>). Assembly metrics were calculated using the BNGCompare script (version 1.0). More detailed assembly metrics for all five assembled consensus genome maps are available in Additional file 4.</p>
</sec>
<sec id="s3a3">
<title>Stitch: Automated and Manually Edited Assemblies</title>
<p>Tcas5.1 is the output of Stitch (version 1.4.4) run for five iterations with two sets of alignment filters. To select quality alignments from regions of high and low label density, the first minimum confidence was 13 and the <italic>PAT</italic> was 30 and the second minimum confidence was 8 and the <italic>PAT</italic> was 90. The resulting super scaffolds showed a greater than three-fold increase in N50 from 1.16 to 3.85 Mb (<xref ref-type="table" rid="tbl2">Table 2</xref>).</p>
<p>The Tcas5.1 super scaffolds captured an additional 92 gaps between Tcas5.0 sequence scaffolds. Sixty-six gaps were estimated to have positive gap lengths and were represented in the sequence assembly with their estimated size (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Twenty-six gaps were estimated to have negative lengths and were represented with spacers of 100 N&#x2019;s (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Extremely small negative gap lengths (<italic>&#x003C;</italic> &#x2212;20 kb) were flagged for further evaluation at a sequence level. In some cases, extremely small negative gaps lengths suggest that a chimeric sequence scaffold may need to be broken at the sequence level and its fragments incorporated into different ChLGs. For example, half of scaffold 81 from Tcas5.0 aligns between scaffolds 80 and 82 on ChLG5 (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) while the other half aligns between scaffolds 102 and 103 from ChLG7 (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). Scaffold 81 from Tcas5.0 was placed in ChLG5 in the <italic>T. castaneum</italic> genetic map. The arrangement supported by the genetic map was selected for cases like this where manual editing was required. The manually curated assembly is referred to as Tcas5.2. In Tcas5.2, joins were also manually accepted if they agreed with the genetic map but the alignment quality was low. Ultimately, Tcas5.2 had a higher N50 than the automated Stitch output, 4.46 Mb (<xref ref-type="table" rid="tbl2">Table 2</xref>), with 66 gaps with positive estimated lengths and 24 negative length gaps.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6</label>
<caption>
<title>Histogram of gap lengths in Tcas5.1.</title>
<p>Positive and negative gaps lengths for Tcas5.1 added to the automated output of stitch.pl based on filtered scaffolding alignments. The majority of gap lengths added by stitch.pl, 66, were positive (red). The remaining 26 gaps had negative lengths (purple).</p></caption>
<graphic xlink:href="020966_fig6.tif"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7</label>
<caption>
<title>Extremely small negative gap length for <italic>in silico</italic> map of scaffold 81.</title>
<p>Two XMAP alignments for <italic>in silico</italic> map of sequence scaffold 81 are shown. Consensus genome maps (blue with molecule map coverage shown in dark blue) align to the <italic>in silico</italic> maps of scaffolds (green with contigs overlaid as translucent colored squares). Sequence scaffolds 79-83 were placed within ChLG 5 and sequence scaffolds 99-103 were placed with ChLG 7 by the <italic>T. castaneum</italic> genetic map. (A) Half of the <italic>in silico</italic> map of sequence scaffold 81 aligns with its assigned ChLG (black arrow). (B) The other half aligns with ChLG 7 (red arrow) producing a negative gap length smaller than -20 kb. The alignment that places sequence scaffold 81 with ChLG 7 disagrees with the genetic map and was manually rejected for Tcas5.2.</p></caption>
<graphic xlink:href="020966_fig7.tif"/>
</fig>
<p>Nearly every ChLG was less fragmented in the Tcas5.2 assembly than in the Tcas5.0 assembly. The number of scaffolds was reduced for each ChLG (<xref ref-type="table" rid="tbl4">Table 4</xref>) except for the 26 relatively short (N50 &#x003D; 0.05 Mb) and unlocalized scaffolds from ChLGY. For example, ChLGX was reduced from 13 scaffolds (<xref ref-type="fig" rid="fig8">Figure 8B</xref>) to 2 in the final super scaffold or chromosome build (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Five scaffolds were reoriented in ChLGX based on alignment to the consensus genome maps (<xref ref-type="fig" rid="fig8">Figure 8A-B</xref>). Scaffolds were also reordered based on alignment to consensus genome maps. For example, scaffold 2 from ChLGX aligned between scaffold 36 and 37 of ChLG 3 and was therefore moved in Tcas5.2 (Additional file 5). Also, 19 previously unplaced scaffolds were anchored within a ChLG (<xref ref-type="table" rid="tbl4">Table 4</xref>). Improvements in Tcas5.2 over Tcas5.0 are shown in alignments of the respective <italic>in silico</italic> maps to consensus genome maps for all ChLGs in Additional file 5.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4</label>
<caption><p>Each <italic>T. castaneum</italic> chromosome linkage group (ChLG) before and after super scaffolding. The number of sequence scaffolds in the ordered Tcas5.0 ChLG bins and the number of sequence super scaffolds and scaffolds in the Tcas5.2 ChLG bins. The number of sequence scaffolds that were unplaced in Tcas5.0 and placed with a ChLG in Tcas5.2 is also listed.</p></caption>
<graphic xlink:href="020966_tbl4.tif"/>
</table-wrap>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8</label>
<caption>
<title>ChLGX before and after super scaffolding with Stitch and Hybrid Map creation by Hybrid Scaffold.</title>
<p>(A) Alignment of Tcas5.2 <italic>in silico</italic> maps to consensus genome maps for ChLGX. (B) Alignment of Tcas5.0 <italic>in silico</italic> maps to consensus genome maps for ChLGX. (c) Alignment of Hybrid genome maps to consensus genome maps for ChLGX. Consensus genome maps are blue with molecule map coverage shown in dark blue). The <italic>in silico</italic> maps are green with contigs overlaid as translucent colored squares. Only <italic>in silico</italic> maps that align are displayed in IrysView. The hybrid scaffold is yellow and only new &#x201D;hybridized&#x201D; maps are shown in IrysView. Labels and alignments of labels are indicated with grey lines.</p></caption>
<graphic xlink:href="020966_fig8.tif"/>
</fig>
<p>The Tcas5.2 Whole Genome Shotgun project has been deposited at DDBJ/EMBL/GenBank under the accession AAJJ00000000. The version described in this paper is version AAJJ02000000. Two scaffolds were removed from the genome assembly because they were identified as contaminants after they blasted to the <italic>Bos frontalis</italic> genome.</p>
</sec>
<sec id="s3a4">
<title>Assembly: Putative Haplotypes</title>
<p>Evidence of putative haplotypes was found during visual inspection of alignments. Although overall alignment redundancy was rare for the <italic>Strict</italic>-<italic>T</italic> assembly; when observed, it usually consisted of only two consensus genome maps aligning to the same <italic>in silico</italic> map (<xref ref-type="fig" rid="fig9">Figure 9</xref>). This redundancy might indicate collapsed repeats in the sequence-based assembly. On the other hand it could also indicate segmental duplications, assembly of alternative haplotypes, or mis-assembly producing redundant consensus genome maps. In <xref ref-type="fig" rid="fig9">Figure 9A</xref>, two consensus genome maps aligned to the same <italic>in silico</italic> map. One consensus genome map aligned across most of the <italic>in silico</italic> map while only a small region of the other consensus genome maps aligned to the the <italic>in silico</italic> map (<xref ref-type="fig" rid="fig9">Figure 9A</xref>). Molecule map coverage decreased for each consensus genome map in the region where only one of them aligned to the <italic>in silico</italic> map (<xref ref-type="fig" rid="fig9">Figure 9A-C</xref>). Taken together, the region of lower coverage and the number of consensus genome maps aligning (two) may indicate the assembly of two haplotypes.</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9</label>
<caption>
<title>Putative haplotypes assembled as consensus genome maps.</title>
<p>(A) Two consensus genome maps (blue with molecule map coverage shown in dark blue) align to the <italic>in silico</italic> map of scaffold 131 (green with contigs overlaid as translucent colored squares). (B and C) Both consensus genome maps are shown (blue) with single molecule pileups (yellow). Both consensus genome maps have similar label patterns except within the lower coverage region indicated with a black square.</p></caption>
<graphic xlink:href="020966_fig9.tif"/>
</fig>
</sec>
<sec id="s3a5">
<title>Stitch: Comparison to Other Software</title>
<p>We also ran Hybrid Scaffold (BioNano version 3076) to improve the <italic>T. castaneum</italic> sequence assembly using the <italic>T. castaneum</italic> consensus genome maps and the <italic>in silico</italic> maps from Tcas5.0. Although Hybrid Scaffold improved the scaffold N50 of the sequence-based assembly from 1.16 Mb to 1.83 Mb, the increase in N50 was not as great as the increase after running Stitch (N50 &#x003D; 3.85 Mb) (<xref ref-type="table" rid="tbl2">Table 2</xref>). The total number of scaffolds in the sequence assembly decreased by 30 after running Hybrid Scaffold; in comparison, Stitch reduced the number of scaffolds by 92. Stitch increased the length of the assembly by 4.98 Mb while Hybrid Scaffold increased assembly length by 14.80 Mb. The additional increase in length from Hybrid Scaffold is likely due to extension of sequence-based scaffolds with end gaps introduced from genome map contigs that overlap the start or end of a sequence-based scaffold.</p>
<p>Overall, we found Hybrid Scaffold to be more conservative than Stitch. For example in <xref ref-type="fig" rid="fig8">Figure 8B</xref>, the alignment of 13 <italic>in silico</italic> maps to three consensus genome maps was input into both Stitch and Hybrid Scaffold. In this alignment, the order of 11 of these <italic>in silico</italic> maps agreed with the order suggested by the genetic map (after reorienting three <italic>in silico</italic> maps). The <italic>in silico</italic> maps 12 and 13 aligned with a negative gap length between them, suggesting they may be mis-assembled or that local assembly may collapse the assembly in this region. There are several possible approaches when considering this kind of conflicting evidence. The approach of Stitch was to record that we have confirmed the relative position of these scaffolds in the larger context of the genome by creating a new super scaffold containing 100 bp spacer gaps to indicate that exact overlap or gap length is unclear (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Stitch also reports the negative gap length to indicate the need for further sequence level evaluation at a later date. Alternatively, Hybrid Scaffold only automates genome improvements that are unambiguously supported by all lines of evidence (sequence-based and genome map-based) and leaves any ambiguous decisions to a human curator. Therefore, Hybrid Scaffold would only report the conflicting alignment. This is why scaffold 13, for example, is not included in the hybrid map produced by Hybrid Scaffold (<xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p>
<p>For highly refined genome assemblies, this lack of tolerance for noisy alignments has not hindered improvement of genome projects. However, for less refined genome assemblies this may be too stringent. The Hybrid Scaffold software, for example, was developed to scaffold the human genome and has been found to work well for this application. Genome projects at earlier stages would benefit from staged release of updates (e.g., immediate release of general improvement in scaffold order and orientation followed by further refinement at the sequence level). For projects such as <italic>T. castaneum</italic>, a more aggressive algorithm such as Stitch may be preferred in order to release the bulk of the new information about the higher order arrangement of the genome to the community of <italic>T. castaneum</italic> researchers quickly. Further refinement at a sequence level can be released in subsequent genome updates as they are completed.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<title>Conclusions</title>
<p>We introduced new tools to facilitate single molecule map assembly optimization and genome finishing steps using the resultant consensus genome maps. These tools were validated using the medium-sized (200 Mb) <italic>T. castaneum</italic> beetle genome. The Tcas3.0 genome was assembled using the gold-standard Sanger assembly strategy [<xref ref-type="bibr" rid="c15">15</xref>] with the benefit of extensive genetic maps [<xref ref-type="bibr" rid="c16">16</xref>]. The Tcas5.0 assembly benefitted from the use of LongDistance Illumina Jump libraries to anchor additional scaffolds and fill gaps. Despite this, we were able to more than triple the scaffold N50 by leveraging the optimal consensus genome maps and Stitch. We demonstrated that the AssembleIrysCluster method of optimization and Stitch can be used together to improve the contiguity of a draft genome.</p>
<p>As the variety of genome assembly projects increases, we are discovering that tools appropriate for all projects (e.g. genomes of varying size and complexity, assemblies of varying quality, various taxonomic groups, etc.) do not exist. Indeed, the results of Assemblation2 indicate that no one suite of datatypes or assembly workflow may be sufficient to best assemble even the subcategory of vertebrate genomes [<xref ref-type="bibr" rid="c3">3</xref>]. Here we described two software tools and many shorter scripts to summarize and work with these new data formats. However, we anticipate the development of a variety of bioinformatics tools for extremely long, single molecule map data as more applications for these maps are explored.</p>
<p>Since completion of the <italic>T. castaneum</italic> genome update we have released updates for both Stitch and AssembleIrysCluster. Stitch (version 1.4.5) now allows the user to set a minimum negative gap length filter for alignments. In the event that two <italic>in silico</italic> maps have a negative gap length smaller than this value, which is equivalent to a longer overlap of the sequence scaffolds, Stitch will automatically exclude both <italic>in silico</italic> maps from consideration when super scaffolding. This new feature allows users to further customize the stringency of the Stitch output. In addition, BioNano Genomics has updated Assembler to automate per-scan stretch adjustment. Finally the KSU K-INBRE Bioinformatics Core has moved to producing assemblies on a Xeon Phi server with 576 cores (48x12-core Intel Xeon CPUs), 256GB of RAM, and Linux CentOS 7 operating system. Because of all of these changes we opted to create a new assembly workflow rather than update AssembleIrysCluster. The most current assembly workflow, AssembleIrysXeonPhi maintains all the functionality of AssembleIrysCluster (e.g. adjusting stretch by scan and writing assembly scripts with all combinations of three <italic>p</italic>-<italic>ValueThresholds</italic> and three <italic>Minlen</italic> parameters) but runs on our new machine with the latest release of the BioNano Assembler and RefAligner.</p>
<p>Regions where consensus genome maps disagree with sequence assemblies (e.g. negative gap lengths or partial alignments) are flagged by Stitch for investigation at a sequence level. Bioinformatics tools that could automate assembly editing based on such discrepancies are needed to fully support genome improvement with consensus genome maps.</p>
</sec>
</body>
<back>
<sec id="s5">
<title>Availability and requirements</title>
<sec id="s5a">
<title>Assembly scripts</title>
<p><bold>Project name:</bold> AssembleIrysXeonPhi.pl / AssembleIrysCluster.pl</p>
<p><bold>Project home page:</bold> AssembleIrysXeonPhi scripts are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/i5K-KINBRE-script-share">https://github.com/i5K-KINBRE-script-share</ext-link> The currently unsupported AssembleIrysCluster scripts are available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/i5K-KINBRE-script-share/Irys-scaffolding/tree/master/KSU_bioinfo_lab/assemble">https://github.com/i5K-KINBRE-script-share/Irys-scaffolding/tree/master/KSU_bioinfo_lab/assemble</ext-link></p>
<p><bold>Operating system(s):</bold> SGE Linux (tested on a Gentoo) cluster</p>
<p><bold>Programming language:</bold> Perl, Rscript, Bash</p>
<p><bold>License:</bold> AssembleIrysXeonPhi and AssembleIrysCluster.pl is available free of charge to academic and non-profit institutions.</p>
<p><bold>Any restrictions to use by non-academics:</bold> Please contact authors for commercial use.</p>
<p><bold>Dependencies:</bold> AssembleIrysXeonPhi.pl and AssembleIrysCluster.pl requires DRMAA job submission libraries. RefAligner and Assembler are also required and can be provided by request by Bionano Genomics <ext-link ext-link-type="uri" xlink:href="http://www.bionanogenomics.com/">http://www.bionanogenomics.com/</ext-link>.</p>
</sec>
<sec id="s5b">
<title>Super scaffolding scripts</title>
<p><bold>Project name:</bold> stitch.pl</p>
<p><bold>Project home page:</bold> Stitch scripts are available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/i5K-KINBRE-script-shar">https://github.com/i5K-KINBRE-script-shar</ext-link></p>
<p><bold>Operating system(s):</bold> MAC and LINUX (tested on Gentoo and Ubuntu)</p>
<p><bold>Programming language:</bold> Perl, Rscript, Bash</p>
<p><bold>License:</bold> stitch.pl is available free of charge to academic and non-profit institutions.</p>
<p><bold>Any restrictions to use by non-academics:</bold> Please contact authors for commercial use.</p>
<p><bold>Dependencies:</bold> stitch.pl requires BioPerl. RefAligner and Assembler are also required between iterations and can be provided by request by Bionano Genomics <ext-link ext-link-type="uri" xlink:href="http://www.bionanogenomics.com/">http://www.bionanogenomics.com/</ext-link>.</p>
</sec>
<sec id="s5c">
<title>Map summary scripts</title>
<p><bold>Project name:</bold> BNGCompare.pl, bnx stats.pl, cmap stats.pl and xmap stats.pl</p>
<p><bold>Project home page:</bold> all scripts are available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/i5K-KINBRE-script-share/I">https://github.com/i5K-KINBRE-script-share/I</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/i5K-KINBRE-script-share/BNGCompare">https://github.com/i5K-KINBRE-script-share/BNGCompare</ext-link></p>
<p><bold>Operating system(s):</bold> MAC and LINUX (tested on Gentoo and Ubuntu)</p>
<p><bold>Programming language:</bold> Perl, Rscript, Bash</p>
<p><bold>License:</bold> bnx stats.pl, cmap stats.pl and xmap stats.pl are available free of charge to academic and non-profit institutions.</p>
<p><bold>Any restrictions to use by non-academics:</bold> Please contact authors for commercial use.</p>
<p><bold>Dependencies:</bold> bnx stats.pl, cmap stats.pl and xmap stats.pl have no dependencies.</p>
</sec>
</sec>
<sec>
<title>Competing interests</title>
<p>The JMS, MCC, NH, NL, and SJB declare that they have no competing interests. ETL, PS and TA are employees at BioNano Genomics and hold stock options.</p>
</sec>
<sec>
<title>Author&#x2019;s contributions</title>
<p>MCC isolated the high molecular weight DNA and generated the image files on the Irys. ETL and JMS developed the assembly workflow. JMS wrote most of the code in the IrysScaffolding Github Repo (Stitch, AssembleIrysXeonPhi, AssembleIrysCluster, etc.). NH assisted with initial code review of analyze irys output (precursor to Stitch) and prepared Tcas5.0. JMS and NL manually edited Tcas5.1. JMS performed the data analyses. TA contributed to sections discussing BioNano RefAligner and Assembler. PS contributed to interpretation of results. JMS and SJB did most of the writing with contributions from all authors. All authors read and approved the final manuscript.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>This project was supported by an Institutional Development Award (IDeA) from the National Institute of General Medical Sciences of the National Institutes of Health under grant number P20 GM103418.</p>
<p>Data for Additional file 1 was kindly made available by P.A. Larsen, J. Rogers, A.D. Yoder and the Duke Lemur Center.</p>
<p>The <italic>Tribolium castaneum</italic> genome project is part of the i5k Genome Sequencing Initiative for Insects and Other Arthropods.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Phillippy</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Zimin</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Puiu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Magoc</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Koren</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Treangen</surname>, <given-names>T.J.</given-names></string-name>, <string-name><surname>Schatz</surname>, <given-names>M.C.</given-names></string-name>, <string-name><surname>Delcher</surname>, <given-names>A.L.</given-names></string-name>, <string-name><surname>Roberts</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mar&#x00E7;ais</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Pop</surname>, <given-names>M.</given-names></string-name>, A, Y.J.: <article-title>Gage: A critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Research</source> <volume>22</volume>(<issue>6</issue>) (<year>2012</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1101/gr.131383.111</pub-id></mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Vezzi</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Narzisi</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Mishra</surname>, <given-names>B.</given-names></string-name>: <article-title>Feature-by-feature &#x2013; evaluating de novo sequence assembly</article-title>. <source>PloS ONE</source> <volume>7</volume>(<issue>2</issue>) (<year>2012</year>). DOI: <pub-id pub-id-type="doi" specific-use="metadata">10.1371/journal.pone.0031002</pub-id></mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Bradnam</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Faas</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Alexandrov</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Baranay</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Bechner</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Birol</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Boisvert</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Chapman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Chapuis</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Chikhi</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Chitsaz</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Chou</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Corbeil</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Del Fabbro</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Docking</surname>, <given-names>T.R.</given-names></string-name>, <string-name><surname>Durbin</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Earl</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Emrich</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Fedotov</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Fonseca</surname>, <given-names>N.A.</given-names></string-name>, <string-name><surname>Ganapathy</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Gibbs</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Gnerre</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Godzaridis</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Goldstein</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Haimel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hall</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Haussler</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Hiatt</surname>, <given-names>J.B.</given-names></string-name>, <string-name><surname>Ho</surname>, <given-names>I.Y.</given-names></string-name>, <string-name><surname>Howard</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Hunt</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jackman</surname>, <given-names>S.D.</given-names></string-name>, <string-name><surname>Jaffe</surname>, <given-names>D.B.</given-names></string-name>, <string-name><surname>Jarvis</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>H.e.a.</given-names></string-name>: <article-title>Assemblathon 2: evaluating de novo methods of genome assembly in three vertebrate species</article-title>. <source>GigaScience</source> <volume>2</volume>(<issue>10</issue>) (<year>2013</year>). <pub-id pub-id-type="doi" specific-use="metadata">10.1186/2047-217X-2-10</pub-id></mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Das</surname>, <given-names>S.K.</given-names></string-name>, <string-name><surname>Austin</surname>, <given-names>M.D.</given-names></string-name>, <string-name><surname>Akana</surname>, <given-names>M.C.</given-names></string-name>, <string-name><surname>Deshpande</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Xiao</surname>, <given-names>M.</given-names></string-name>: <article-title>Single molecule linear analysis of dna in nano-channel labeled with sequence specific fluorescent probes</article-title>. <source>Nucleic Acids Research</source> <volume>38</volume>(<issue>e177</issue>) (<year>2010</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1093/nar/gkq673</pub-id></mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="website"><collab>PacBio P6-C4 Chemistry Specifications</collab>. <ext-link ext-link-type="uri" xlink:href="http://investor.pacificbiosciences.com/releasedetail.cfm?ReleaseID=876252">http://investor.pacificbiosciences.com/releasedetail.cfm?ReleaseID=876252</ext-link></mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="website"><collab>Illumina Long Distance Jump Library Specifications</collab>. <ext-link ext-link-type="uri" xlink:href="http://www.operon.com/services/next-generation-sequencing/illumina/libraries.aspx">http://www.operon.com/services/next-generation-sequencing/illumina/libraries.aspx</ext-link></mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Quick</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Quinlan</surname>, <given-names>A.R.</given-names></string-name>, J, L.N.: <article-title>A reference bacterial genome dataset generated on the minion portable single-molecule nanopore sequencer</article-title>. <source>GigaScience</source> <volume>3</volume>(<issue>22</issue>) (<year>2014</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1186/2047-217X-3-22</pub-id></mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>McCoy</surname>, <given-names>R.C.</given-names></string-name>, <string-name><surname>Taylor</surname>, <given-names>R.W.</given-names></string-name>, <string-name><surname>Blauwkamp</surname>, <given-names>T.A.</given-names></string-name>, <string-name><surname>Kelley</surname>, <given-names>J.L.</given-names></string-name>, <string-name><surname>Kertesz</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pushkarev</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Petrov</surname>, <given-names>D.A.</given-names></string-name>, A, F.-L.: <article-title>Illumina truseq synthetic long-reads empower de novo assembly and resolve complex, highly-repetitive transposable elements</article-title>. <source>PloS ONE</source> <volume>9</volume>(<issue>9</issue>) (<year>2014</year>). DOI: <pub-id pub-id-type="doi" specific-use="metadata">10.1371/journal.pone.0106689</pub-id></mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Teague</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Waterman</surname>, <given-names>M.S.</given-names></string-name>, <string-name><surname>Goldstein</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Potamousis</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Reslewic</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Sarkar</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Valouev</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Churas</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Kidd</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Kohn</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Runnheim</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Lamers</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Forrest</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Newton</surname>, <given-names>M.A.</given-names></string-name>, <string-name><surname>Eichler</surname>, <given-names>E.E.</given-names></string-name>, <string-name><surname>Kent-First</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Surti</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Livny</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Schwartz</surname>, <given-names>D.C.</given-names></string-name>: <article-title>High-resolution human genome structure by single-molecule analysis</article-title>. <source>PNAS</source> <volume>107</volume>(<issue>24</issue>) (<year>2012</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1073/pnas.0914638107</pub-id></mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="website"><collab>Opgen Argus MapCard Specifications</collab>. <ext-link ext-link-type="uri" xlink:href="http://www.tgac.ac.uk/sequencing-platforms/">http://www.tgac.ac.uk/sequencing-platforms/</ext-link></mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="website"><collab>BioNano IrysChips Specifications</collab>. <ext-link ext-link-type="uri" xlink:href="http://www.bionanogenomics.com/wp-content/uploads/2015/01/datasheet-web.pdf">http://www.bionanogenomics.com/wp-content/uploads/2015/01/datasheet-web.pdf</ext-link></mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Cao</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Hastie</surname>, <given-names>A.R.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Lam</surname>, <given-names>E.T.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Lin</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Andrews</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Chan</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tong</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Requa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Anantharaman</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>X.</given-names></string-name>: <article-title>Rapid detection of structural variation in a human genome using nanochannel-based genome mapping technology</article-title>. <source>GigaScience</source> <volume>3</volume>(<issue>34</issue>) (<year>2014</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1186/2047-217X-3-34</pub-id></mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Ross</surname>, <given-names>M.G.</given-names></string-name>, <string-name><surname>Russ</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Costello</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hollinger</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Lennon</surname>, <given-names>N.J.</given-names></string-name>, <string-name><surname>Hegarty</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Nusbaum</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Jaffe</surname>, <given-names>D.B.</given-names></string-name>: <article-title>Characterizing and measuring bias in sequence data</article-title>. <source>Genome Biology</source> <volume>14</volume>(<issue>R51</issue>) (<year>2013</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1186/gb-2013-14-5-r51</pub-id></mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Mendelowitz</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Pop</surname>, <given-names>M.</given-names></string-name>: <article-title>Computational methods for optical mapping</article-title>. <source>GigaScience</source> <volume>3</volume>(<issue>33</issue>) (<year>2014</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1186/2047-217X-3-33</pub-id></mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Richards</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Gibbs</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Weinstock</surname>, <given-names>G.M.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>S.J.</given-names></string-name>, <string-name><surname>Denell</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Beeman</surname>, <given-names>R.W.</given-names></string-name>, <string-name><surname>Gibbs</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Bucher</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Friedrich</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Grimmelikhuijzen</surname>, <given-names>C.J.e.a.</given-names></string-name>: <article-title>The genome of the model beetle and pest tribolium castaneum</article-title>. <source>Nature</source> <volume>452</volume>, <fpage>949</fpage>&#x2013;<lpage>955</lpage> (<year>2008</year>). <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06784">http://dx.doi.org/10.1038/nature06784</ext-link></mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Lorenzen</surname>, <given-names>M.D.</given-names></string-name>, <string-name><surname>Doyungan</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Savard</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Snow</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Crumly</surname>, <given-names>L.R.</given-names></string-name>, <string-name><surname>Shippy</surname>, <given-names>T.D.</given-names></string-name>, <string-name><surname>Stuart</surname>, <given-names>J.J.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>S.J.</given-names></string-name>, <string-name><surname>Beeman</surname>, <given-names>R.W.</given-names></string-name>: <article-title>Genetic linkage maps of the red flour beetle, tribolium castaneum, based on bacterial artificial chromosomes and expressed sequence tags</article-title>. <source>Genetics</source> <volume>170</volume>(<issue>2</issue>), <fpage>741</fpage>&#x2013;<lpage>747</lpage> (<year>2005</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1534/genetics.104.032227</pub-id></mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Lam</surname>, <given-names>E.T.</given-names></string-name>, <string-name><surname>Hastie</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Lin</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Ehrlich</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Das</surname>, <given-names>S.K.</given-names></string-name>, <string-name><surname>Austin</surname>, <given-names>M.D.</given-names></string-name>, <string-name><surname>Deshpande</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Nagarajan</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Xiao</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kwok</surname>, <given-names>P.</given-names></string-name>: <article-title>Genome mapping on nanochannel arrays for structural variation analysis and sequence assembly</article-title>. <source>Nature Biotechnology</source> <volume>30</volume>(<issue>8</issue>) (<year>2012</year>). doi: <pub-id pub-id-type="doi" specific-use="metadata">10.1038/nbt.2303</pub-id></mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="website"><string-name><surname>Anantharaman</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Mishra</surname>, <given-names>B.</given-names></string-name>: <source>A probabilistic analysis of false positives in optical map alignment and validation</source>. (<year>2001</year>). <ext-link ext-link-type="uri" xlink:href="https://cs.nyu.edu/mishra/PUBLICATIONS/01.falsepos.ps">https://cs.nyu.edu/mishra/PUBLICATIONS/01.falsepos.ps</ext-link></mixed-citation></ref>
</ref-list>
<sec>
<title>Additional Files</title>
<p>Additional file 1 &#x2014; Single molecule map stretch per scan in recent flowcells.</p>
<p>Bases per pixel (bpp) is plotted for scans 1..<italic>n</italic> for each flowcell of mouse lemur molecules (purple). The first scan of each flowcell is indicated with a grey dashed line. The pre-adjusted molecule map stretch was determined by aligning molecule maps to the <italic>in silico</italic> maps. Data made available by P.A. Larsen, J. Rogers, A.D. Yoder and the Duke Lemur Center.</p>
<p>Additional file 2 &#x2014; Cumulative length and number of single molecule maps per BNX file for <italic>T. castaneum</italic> data generated over time</p>
<p>Detailed metrics for molecule maps per BNX file (cumulative length and number of maps). Columns include cumulative length of molecule maps &#x003E; 150 kb, number of molecule maps &#x003E; 150 kb and date that BNX file was generated.</p>
<p>Additional file 3 &#x2014; Single molecule map metrics and histograms from <italic>T. castaneum</italic> DNA</p>
<p>Detailed metrics for molecule maps including map N50, cumulative length and number of maps. Figures show histograms of per molecule map quality metrics including length, molecule map SNR and intensity, label count, label SNR and label intensity. Molecule maps are filter for minimum molecule lengths of 100, 150 or 180 kb.</p>
<p>Additional file 4 &#x2014; Assembly of <italic>T. castaneum</italic> consensus genome maps with range of parameters</p>
<p>Detailed assembly metrics for assembled consensus genome maps using strict, default and relaxed &#x201D;-T&#x201D; parameter, p-value threshold are named Relaxed-T, Default-T and Strict-T respectively. The best &#x201D;-T&#x201D; parameter was used for two additional assemblies with either relaxed minimum molecule map length (relaxed-minlen) of 100 kb, rather than the 150 kb default, or a strict minimum molecule map length (strict-minlen) of 180 kb.</p>
<p>Additional file 5 &#x2014; ChLGs before and after super scaffolding</p>
<p>Alignments of Tcas5.0 and Tcas5.2 <italic>in silico</italic> maps to consensus genome maps for all ChLGs. Consensus genome maps (blue with molecule coverage shown in dark blue) aligned to the <italic>in silico</italic> maps (green with contigs overlaid as translucent colored squares). Alignment to both Tcas5.2 super scaffolds (top alignment) and Tcas5.0 scaffolds (bottom alignment) are shown.</p>
</sec>
</back>
</article>
