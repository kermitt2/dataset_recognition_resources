<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/429464</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A Bayesian model of acquisition and clearance of bacterial colonization incorporating within-host variation</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>J&#x00E4;rvenp&#x00E4;&#x00E4;</surname>
<given-names>Marko</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1912-0590</contrib-id>
<name>
<surname>Abdul Sater</surname>
<given-names>Mohamad R.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3165-7801</contrib-id>
<name>
<surname>Lagoudas</surname>
<given-names>Georgia K.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4889-8783</contrib-id>
<name>
<surname>Blainey</surname>
<given-names>Paul C.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Miller</surname>
<given-names>Loren G.</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>McKinnell</surname>
<given-names>James A.</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Huang</surname>
<given-names>Susan S.</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Grad</surname>
<given-names>Yonatan H.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">&#x2020;</xref>
<xref ref-type="author-notes" rid="n2">&#x002A;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Marttinen</surname>
<given-names>Pekka</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x2020;</xref>
<xref ref-type="author-notes" rid="n2">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Helsinki Institute for Information Technology HIIT, Department of Computer Science, Aalto University</institution>, Espoo, <country>Finland</country></aff>
<aff id="a2"><label>2</label><institution>Department of Immunology and Infectious Diseases, Harvard TH Chan School of Public Health</institution>, Boston, MA, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biological Engineering, MIT</institution>, Cambridge, MA, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Broad Institute, MIT and Harvard</institution>, Cambridge, MA, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>Infectious Disease Clinical Outcomes Research Unit (ID-CORE), Division of Infectious Diseases, Los Angeles Biomedical Research Institute</institution>, Harbor-UCLA Medical Center, Torrance, CA</aff>
<aff id="a6"><label>6</label><institution>Los Angeles County Department of Public Health</institution>, Acute Communicable Disease Control Unit</aff>
<aff id="a7"><label>7</label><institution>Division of Infectious Diseases and Health Policy Research Institute, University of California</institution>, Irvine School of Medicine, Irvine, CA, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>&#x2020;</label><p>These authors contributed equally to this work.</p></fn>
<fn id="n2" fn-type="other"><label>&#x002A;</label><p><email>ygrad@hsph.harvard.edu</email>, <email>pekka.marttinen@aalto.fi</email></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>429464</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>27</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>9</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="429464.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Bacterial populations that colonize a host can play important roles in host health, including serving as a reservoir that transmits to other hosts and from which invasive strains emerge, thus emphasizing the importance of understanding rates of acquisition and clearance of colonizing populations. Studies of colonization dynamics have been based on assessment of whether serial samples represent a single population or distinct colonization events. With the use of whole genome sequencing to determine genetic distance between isolates, a common solution to estimate acquisition and clearance rates has been to assume a fixed genetic distance threshold below which isolates are considered to represent the same strain. However, this approach is often inadequate to account for the diversity of the underlying within-host evolving population, the time intervals between consecutive measurements, and the uncertainty in the estimated acquisition and clearance rates. Here, we present a fully Bayesian model that provides probabilities of whether two strains should be considered the same, allowing us to determine bacterial clearance and acquisition from genomes sampled over time. Our method explicitly models the within-host variation using population genetic simulation, and the inference is done using a combination of Approximate Bayesian Computation (ABC) and Markov Chain Monte Carlo (MCMC). We validate the method with multiple carefully conducted simulations and demonstrate its use in practice by analyzing a collection of methicillin resistant Staphylococcus aureus (MRSA) isolates from a large recently completed longitudinal clinical study. An R-code implementation of the method is freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/mjarvenpaa/bacterial-colonization-model.git">https://github.com/mjarvenpaa/bacterial-colonization-model.git</ext-link>.</p>
<sec>
<title>Author summary</title>
<p>As colonizing bacterial populations are the source for much transmission and a reservoir for infection, they are a major focus of interest clinically and epidemiologically. Understanding the dynamics of colonization depends on being able to confidently identify acquisition and clearance events given intermittent sampling of hosts. To do so, we need a model of within-host bacterial population evolution from acquisition through the time of sampling that enables estimation of whether two samples are derived from the same population. Past efforts have frequently relied on empirical genetic distance thresholds that forgo an underlying model or employ a simple molecular clock model. Here, we present an inferential method that accounts for the timing of sample collection and population diversification, to provide a probabilistic estimate for whether two isolates represent the same colonizing strain. This method has implications for understanding the dynamics of acquisition and clearance of colonizing bacteria, and the impact on these rates by factors such as sensitivity of the sampling method, pathogen genotype, competition with other carriage bacteria, host immune response, and antibiotic exposure.</p>
</sec>
</abstract>
<counts>
<page-count count="24"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Colonizing bacterial populations are often the source of infecting strains and transmission to new hosts [<xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c5">5</xref>], making it important to understand the dynamics of these populations and the factors that contribute to persistent colonization and to the success or failure of clinical decolonization protocols. The study of colonization dynamics is based on inferring whether bacteria from samples collected over time represent the same population or distinct colonization events, thereby permitting calculation of rates of acquisition and clearance [<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>]. Whole genome sequencing has provided a detailed measure of genetic distance between isolates, which can then be used to infer the relationship between them [<xref ref-type="bibr" rid="c8">8</xref>&#x2013;<xref ref-type="bibr" rid="c11">11</xref>]. While to date most studies have used genetic distance thresholds as the basis for determining the relationship between isolates [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c10">10</xref>], here we improve on these heuristic strategies and present a robust and accurate fully Bayesian model that provides probabilities of whether two strains should be considered the same, allowing us to determine bacterial clearance and acquisition from genomes sampled over time.</p>
<p>An example of a typical individual-level longitudinally sampled data set from a study population is shown in <xref ref-type="fig" rid="fig1">Fig 1</xref>: each &#x2019;row&#x2019; represents a patient, x-axis is time, and dots are the genomes sampled at multiple time points. Dot color refers to different, easily distinguishable, sequence types (ST). The coloured number between two consecutive samples reflects the distance between the genomes, and we see that even within the same ST the distances may vary considerably, and, therefore, determining whether the changes can be explained by within-host evolution only, is challenging. Intuitively, if two genomes are very similar, we interpret this as a single strain colonizing the host. On the other hand, two very different genomes, even if the same ST, are interpreted as two different strains, obtained either jointly or separately as two acquisitions. With these data, we would like to address questions including: to what extent are people persistently colonized, cleared, and recolonized? If recolonized, what is the likelihood that it is the same or a distinct strain? To address these questions, previous works have relied on using a threshold number of single nucleotide polymorphisms (SNPs) to define a strain. Optimally, however, the SNP distance between the genomes observed and the interval between the sampling time defines a probability that the two genomes represent the same strain. Such data are critical for understanding within-host dynamics, response to interventions, and transmission.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig 1.</label>
<caption><title>Illustration of a subset of the data used in the study.</title>
<p>Each row corresponds to one patient and only the first 30 patients are shown. R0 is the initial hospital visit and V1, V2 etc. are the further visits. Red colour refers to ST5 and blue to ST8 and the coloured numbers are the amount of mutations <italic>d<sub>i</sub></italic>. Yellow colour highlights the cases where the ST changes from ST 5 to ST 8.</p>
</caption>
<graphic xlink:href="429464_fig1.tif"/>
</fig>
<p>Previously, transitions between different colonizing bacteria have been modeled using hidden Markov models [<xref ref-type="bibr" rid="c12">12</xref>] with states corresponding to different colonizing STs. However, this approach is not suitable for modeling within a single ST, where acquisition and clearance must be determined based on a small number of mutations. Crucial for interpreting such small differences is a model for within-host variation [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c13">13</xref>], specifying the number of mutations expected by evolution within the host. Population genetic models can be used for understanding the variation in an evolving population [<xref ref-type="bibr" rid="c14">14</xref>]. A major difficulty in fitting such models to data like those shown in <xref ref-type="fig" rid="fig1">Fig 1</xref> is that the information contained by the data is extremely limited regarding the variation within the host: a single time point is summarized with just a single (or a few) genomes, and must serve to represent the whole within-host population. While some studies use genome sequence from multiple isolates to achieve a more complete characterization of within-host diversity [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c10">10</xref>], these tend to be limited in terms of the number of time points and/or patients.</p>
<p>The Bayesian statistical framework can be used to combine information from multiple data sources. In the Bayesian approach, a prior distribution is updated using the laws of probability into a posterior distribution in the light of the observations, and this can be repeated multiple times with different data sets [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>]. Approximate Bayesian computation (ABC) is particularly useful with population genetic models, where the likelihood function may be difficult to specify explicitly, but simulating the model is straightforward [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>]. ABC has recently been introduced in bacterial population genetics [<xref ref-type="bibr" rid="c19">19</xref>&#x2013;<xref ref-type="bibr" rid="c22">22</xref>]. Here, we present a Bayesian model for determining whether two genomes should be considered the same strain, enabling a strategy grounded in population genetics to make inferences about acquisition and clearance from data of closely related genomes. Benefits of the fully Bayesian analysis include: rigorous quantification of uncertainty, explicit statement of modeling assumptions (open for criticism and further development when needed), and straightforward utilization of multiple data sources. We demonstrate these benefits by analyzing a large collection longitudinally collected methicillin resistant <italic>Staphylococcus aureus</italic> (MRSA) genomes, obtained through a clinical trial (Project CLEAR) to evaluate the effectiveness of an MRSA decolonization protocol [<xref ref-type="bibr" rid="c23">23</xref>]. This method for identifying strains with explicit assessment of uncertainty will enable studies of the characteristics&#x2013;both host and pathogen&#x2013;that impact colonization in the presence and absence of interventions.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Overview of the model</title>
<p>One input data item for our model consists of a pair of genomes that are of the same ST, sampled from the same individual at two consecutive time points (or possibly with an intervening time point with no samples or a sample of a different ST). Each of these data items (i.e. pairs of consecutive genomes) is summarized in terms of two quantities: the distance between the genomes and the difference between their sampling times (see <xref ref-type="fig" rid="fig1">Fig 1</xref>). Hence, the observed data <italic>D</italic> can be written as consisting of pairs (<italic>d<sub>i</sub>, t<sub>i</sub></italic>), <italic>i</italic> &#x003D; 1,&#x2026;, <italic>N</italic>, where <italic>t<sub>i</sub></italic> &#x003E; 0 is the time between the sampling of the genomes, <italic>d<sub>i</sub></italic> &#x2208; {0, 1, 2, &#x2026;} is the observed distance, and <italic>N</italic> the total number of genome pairs that satisfy the criteria (i.e. same patient, same ST, consecutive time points or possibly with an intervening time point with no samples or a sample of a different ST). The restriction to genome pairs of the same ST stems from the fact that different STs will always be considered different strains anyway.</p>
<p>There are two possible explanations for the observed distances. If the genomes are from the same strain, we expect their distance to be relatively small. If the genomes are from different strains, we expect a greater distance. Below we define two probabilistic models that represent these two alternative explanations. These models are then combined into one overall mixture model, which assumes that the distance between a certain pair of genomes is generated either from the &#x2019;same strain&#x2019; model or the &#x2019;different strain&#x2019; model, and enables calculation of the probabilities of these two alternatives for each genome pair, rather than relying on a fixed threshold to distinguish between them.</p>
<p>An essential part of our approach is a population genetic simulation which allows us to model the within-host variation, and hence make probabilistic statements of the plausibilities of the &#x2019;same strain&#x2019; vs. &#x2019;different strain&#x2019; models. For this purpose, we adopt the common Wright-Fisher (W-F) simulation model, see e.g. [<xref ref-type="bibr" rid="c24">24</xref>], with a constant mutation rate and population size, which are estimated from the data. The simulation is started with all genomes being the same, which corresponds to a biological scenario according to which a colonization begins with a single isolate multiplying rapidly until reaching the maximum &#x2019;capacity&#x2019;, followed by slow diversification of the population. This assumption is supported by the fact that in the distance distribution, in cases where the acquisition time was known and had happened recently, very little variation was observed in the population. See the Discussion section for more details on the modeling assumptions. Overview of the approach, including data sets, models, and methods for inference, is outlined in <xref ref-type="fig" rid="fig2">Fig 2</xref> and discussed below in detail.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig 2.</label>
<caption><title>Overview of the modeling and data fitting steps.</title>
<p>In Phase 1 we update our prior information on parameters (<italic>n</italic><sub>eff</sub>; <italic>&#x03BC;</italic>) based on external data <italic>D<sub>0</sub></italic>. In phase 2 we estimate all the parameters of the (mixture) model using MCMC, precomputed distance distributions <italic>pS</italic> and the information obtained in Phase 1. The fitted model can be used to e.g. obtain the same strain probability for a new (future) measurement.</p>
</caption>
<graphic xlink:href="429464_fig2.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Model <italic>pS</italic>: Same strain</title>
<p>Let (<italic>s<sub>i</sub></italic><sub>1</sub>, <italic>s<sub>i</sub></italic><sub>2</sub>) denote a pair of genomes with distance <italic>d<sub>i</sub></italic>, sampled from a patient at two consecutive time points (see the previous section) with time <italic>t<sub>i</sub></italic> between taking the samples. Here we present a model, i.e., a probability distribution <italic>p<sub>S</sub></italic>(<italic>d<sub>i</sub></italic> | <italic>t<sub>i</sub>, n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>), which tells what kind of distances we should expect if the genomes are from the same strain. The parameter <italic>n</italic><sub>eff</sub> is the effective population size and <italic>&#x03BC;</italic> is the mutation rate. We model <italic>d<sub>i</sub></italic> as <disp-formula id="eqn1"><alternatives><graphic xlink:href="429464_eqn1.gif"/></alternatives></disp-formula> where we have defined <disp-formula id="eqn2"><alternatives><graphic xlink:href="429464_eqn2.gif"/></alternatives></disp-formula> where dist(&#x00B7;,&#x00B7;) is a distance function that tells the number of mutations between its arguments, and <italic>s<sub>i</sub></italic><sub>&#x002A;</sub> is the unique ancestor of <italic>s<sub>i</sub></italic><sub>2</sub> that was present in the host when <italic>s<sub>i</sub></italic><sub>1</sub> was sampled, and which has descended within the host from the same genome as <italic>s<sub>i</sub></italic><sub>1</sub>(see <xref ref-type="fig" rid="fig3">Fig 3A</xref>). The <xref ref-type="disp-formula" rid="eqn1">Equation 1</xref> is valid when mutations between <italic>s<sub>i</sub></italic><sub>1</sub>, and <italic>s<sub>i</sub></italic><sub>&#x002A;</sub>, and <italic>s<sub>i</sub></italic><sub>&#x002A;</sub> and <italic>s<sub>i</sub></italic><sub>2</sub> have occurred in different sites, which is true with a high probability when the genomes are long (millions of bps) compared to the number of mutations (dozens or a few hundred at most). The probability distribution of <italic>d<sub>i</sub></italic><sub>1</sub> which we will denote by <italic>p<sub>sim</sub></italic>(<italic>d<sub>i</sub></italic><sub>1</sub>|<italic>n<sub>eff</sub>, &#x03BC;</italic>), and which is not available analytically and does not depend on <italic>t<sub>i</sub></italic>, represents the within-host variation at a single time point, and we approximate it as <disp-formula id="eqn3"><alternatives><graphic xlink:href="429464_eqn3.gif"/></alternatives></disp-formula></p>
<p>The distribution of <italic>d<sub>i</sub></italic><sub>2</sub> is assumed to be <disp-formula id="eqn4"><alternatives><graphic xlink:href="429464_eqn4.gif"/></alternatives></disp-formula> that is, mutations are assumed to occur according to a Poisson process with the rate parameter <italic>&#x03BC;</italic>.</p>
</sec>
<sec id="s2c">
<title>Model <italic>p<sub>D</sub></italic>: Different strains</title>
<p>Model <italic>p<sub>D</sub></italic> represents the case that the genomes si1 and si2 are from different strains, which we define to mean that their most recent common ancestor (MRCA), denoted by <italic>s<sub>iA</sub></italic>, resided outside the host. The time between <italic>s<sub>iA</sub></italic> and <italic>s<sub>i</sub></italic><sub>1</sub> is denoted by <italic>t</italic><sub>0<italic>i</italic></sub> (see <xref ref-type="fig" rid="fig3">Fig 3B</xref>). Under model <italic>p<sub>D</sub></italic>, we assume that the distribution of the distance <italic>d<sub>i</sub></italic> is</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig 3.</label><caption><title>Outline of the &#x2019;same strain&#x2019; and &#x2019;different strain&#x2019; models. Model <italic>p<sub>D</sub></italic> on the left (panel A) represents the situation where the genomes denoted by <italic>s<sub>i</sub></italic><sub>1</sub> and <italic>s<sub>i</sub></italic><sub>2</sub> are of the same strain. Model <italic>p<sub>S</sub></italic> on the right (panel B) shows the case where these genomes are of different strains. Time flows from left to right in the figures, the dots represent individual genomes, and the edges parent-offspring relationships.</title></caption>
<graphic xlink:href="429464_fig3.tif"/>
</fig>
<p><disp-formula id="eqn5"><alternatives><graphic xlink:href="429464_eqn5.gif"/></alternatives></disp-formula> where the values of <italic>t</italic><sub>0<italic>i</italic></sub> are unknown and will be estimated, but let us assume for now that they are known. One difference between the same strain model <italic>p<sub>S</sub></italic> (defined by <xref ref-type="disp-formula" rid="eqn1">Equations 1</xref>, <xref ref-type="disp-formula" rid="eqn3">3</xref>, <xref ref-type="disp-formula" rid="eqn4">4</xref>) and the different strain model <italic>p<sub>D</sub></italic> (<xref ref-type="disp-formula" rid="eqn5">Equation 5</xref>) is that the former uses Wright-Fisher simulation, whereas the latter does not. The reason is that the within-host variation is bounded, occasionally increasing and decreasing, which is reflected by the constant population size of the Wright-Fisher simulation in the same strain model. On the other hand, in the different strain model the distance between <italic>s<sub>i</sub></italic><sub>1</sub> and <italic>s<sub>i</sub></italic><sub>2</sub> can in principle increase without bound, given enough time since their common ancestor, because they diverged and evolved outside the host.</p>
</sec>
<sec id="s2d">
<title>Mixture model</title>
<p>With the two alternative models for the distance, we can write the full model, which assumes that each distance observation is distributed according to <disp-formula id="eqn6"><alternatives><graphic xlink:href="429464_eqn6.gif"/></alternatives></disp-formula> where <italic>&#x03B8;</italic> denotes jointly all the parameters of the models, i.e., <italic>&#x03B8;</italic> &#x003D; (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03C9;<sub>S</sub>, &#x03C9;<sub>D</sub>, t</italic><sub>01</sub>,&#x2026;, <italic>t</italic><sub>0<italic>N</italic></sub>). The parameter <italic>&#x03C9;<sub>S</sub></italic> represents the proportion of pairs from the same strain and <italic>&#x03C9;<sub>D</sub></italic> is the proportion of pairs from different strains, such that <italic>&#x03C9;<sub>S</sub></italic> &#x002B; <italic>&#x03C9;<sub>D</sub></italic> &#x003D; 1. To learn the unknown parameters, we need to fit the model to data, but before going into details, we discuss how to use an external data set to update the prior distribution about the mutation rate <italic>&#x03BC;</italic> and the effective sample size <italic>n</italic><sub>eff</sub>. This updated distribution will itself be used as the prior in the mixture model.</p>
</sec>
<sec id="s2e">
<title>ABC inference to update the prior using external data</title>
<p>Simulations with the W-F model are used in our approach for two purposes: 1) to incorporate information from an external data set to update the prior on the mutation rate <italic>&#x03BC;</italic> and the effective sample size <italic>n</italic><sub>eff</sub>, and 2) to define empirically the distribution <italic>p<sub>S</sub></italic>(<italic>d<sub>i</sub></italic>|<italic>t<sub>i</sub>, n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) required in the mixture model. Here we discuss the first task.</p>
<p>As external data we use measurements from eight patients colonised with MSSA [<xref ref-type="bibr" rid="c3">3</xref>], comprising nasal swabs from two time points for each patient, such that the acquisition is known to have happened approximately just before the first swab. Multiple genomes were sequenced from each sample, and the distributions of pairwise distances between the genomes provide snapshots to the within-host variability at the two time points for each individual, and these distance distributions are used as data. We exclude one patient (number 1219) because according to [<xref ref-type="bibr" rid="c3">3</xref>] this patient was likely infected already long before the first sample. The data set also contains observations from an additional 13 patients from [<xref ref-type="bibr" rid="c13">13</xref>], denoted by letters from A to M in [<xref ref-type="bibr" rid="c3">3</xref>]. For these patients, distance distributions from only one time point are available, and the acquisition times are unknown. The data comprising the distance distributions from the 7 patients (two time points) and the additional 13 patients (a single time point) are jointly denoted by <italic>D</italic><sub>0</sub>.</p>
<p>To learn about the unknown parameters <italic>n</italic><sub>eff</sub> and <italic>&#x03BC;</italic>, we first note that their values affect the distance distribution of a population resulting from a W-F simulation with the specified values (<xref ref-type="fig" rid="fig4">Fig. 4</xref>). To estimate these parameters, we try to find such values for them which make the output of the W-F similar to the observed distance distributions <italic>D</italic><sub>0</sub>. Since the corresponding likelihood function is unavailable, standard statistical techniques for model fitting do not apply. Therefore, we use Approximate Bayesian Computation (ABC), a class of methods for Bayesian inference when the likelihood is either unavailable or too expensive to evaluate but simulating the model is feasible, see [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>] for an overview on ABC. The basic ABC rejection sampler algorithm for the model fitting consists of the following steps:</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig 4.</label><caption><title>Distributions of pairwise distances for populations simulated with different parameters.</title>
<p>The histograms show the estimated probability mass functions <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline1.gif"/></alternatives></inline-formula> with selected parameter vectors (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>). Increasing <italic>&#x03BC;</italic> and/or <italic>n</italic><sub>eff</sub> tends to increase the distances. The distance distribution can also be bimodal as the subfigure in lower right corner shows. Each histogram represent variability in a simulated population at a single time point 6,000 generations after the beginning of the simulation.</p></caption>
<graphic xlink:href="429464_fig4.tif"/>
</fig>
<list list-type="order">
<list-item><p>Simulate a parameter vector (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) from the prior distribution <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>).</p></list-item>
<list-item><p>Generate a pseudo-data similar to the observed data <italic>D</italic><sub>0</sub> by running the W-F model separately for each patient using the parameter (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>).</p></list-item>
<list-item><p>Accept the parameter (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) as a sample from the (approximate) posterior distribution if the discrepancy between the observed and simulated data is smaller than a specified threshold <italic>&#x220A;</italic>.</p></list-item>
</list>
<p>The quality of the resulting ABC approximation depends on the selection of the discrepancy function, the threshold <italic>&#x220A;</italic> and the number of accepted samples. Broadly speaking, if the discrepancy summarizes the information in the data completely (e.g. it is a function of the sufficient statistics) and <italic>&#x220A;</italic> is arbitrarily small, the approximation error becomes negligible and the samples are generated from the exact posterior. In practice, choosing <italic>&#x220A;</italic> very small makes the algorithm inefficient since many simulations are needed to obtain an accepted sample even with the optimal value of the parameter. Also, finding a good discrepancy function may be difficult because sufficient statistics are typically unavailable. Many sophisticated ABC variants exist, see e.g. [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c26">26</xref>] and the references therein, but as we need to estimate only two parameters (one of which is discrete) and because running the simulations in parallel is straightforward with the basic algorithm, we use a the ABC rejection sampler outlined above, with details discussed below.</p>
<p>In [<xref ref-type="bibr" rid="c13">13</xref>], MRSA evolution was simulated using parameters derived from the following estimates: 8 mutations per genome per year and generation length of 90 minutes (the whole year is thus 5840 generations). This gives mutation rate of 0.0019 per genome per generation, approximately 6.3 &#x00D7; 10<sup>&#x2212;10</sup> mutations per site per generation assuming the genome length of 3 Mbp. We also use the generation time of 90 minutes, originally derived by [<xref ref-type="bibr" rid="c13">13</xref>] from the estimated doubling time of <italic>Staphylococcus aureus</italic> [<xref ref-type="bibr" rid="c27">27</xref>]. We use independent uniform priors for the parameters of the W-F model, so that <disp-formula id="eqn7"><alternatives><graphic xlink:href="429464_eqn7.gif"/></alternatives></disp-formula> with <italic>a<sub>&#x03BC;</sub></italic> &#x003D; 0.00005 and <italic>b<sub>&#x03BC;</sub></italic> &#x003D; 0.005 mutations per genome per generation.</p>
<p>We argue that reasonable parameters should produce populations with similar histograms of the pairwise distances compared to the observations at the corresponding times. Consequently, we use the discrepancy &#x0394; defined as <disp-formula id="eqn8"><alternatives><graphic xlink:href="429464_eqn8.gif"/></alternatives></disp-formula> where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline2.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline3.gif"/></alternatives></inline-formula> are the simulated and observed empirical distributions of pairwise distances for patient <italic>i</italic> with time point <italic>j</italic>, respectively, and <italic>l</italic><sub>1</sub>(&#x00B7;,&#x00B7;) denotes the <italic>L</italic><sup>1</sup> distance between the distributions. In principle, the unknown acquisition times for the 13 patients (A-M) could be estimated by making each of them an additional parameter. However, ABC in the resulting 15 dimensional parameter space would be difficult due to the curse of dimensionality. Instead, as shown in the <xref ref-type="disp-formula" rid="eqn8">Eq 8</xref>, we use these data such that we supplement the unknown times with values that produce the minimum discrepancy. This way, parameters that never produce enough variability to match the observations will increase the discrepancy, allowing us to gain evidence against such unreasonable values, even if the exact times are unknown and too computationally costly to infer.</p>
<p>Instead of simulating (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) samples from the prior we perform equivalent grid-based computations. That is, we consider an equidistant 50 <italic>&#x00D7;</italic> 50 grid of (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) values and simulate the model 1, 000 times at each grid point. However, in preliminary experiments we noticed that if <italic>n</italic><sub>eff</sub> and <italic>&#x03BC;</italic> are simultaneously large, the amount of mutations produced by the model increases rapidly and it is clear that the simulated pairwise distances are always greater than in the observed data, and also the computation time and memory usage become prohibitive. Thus, we do not run the full set of 1000 simulations in this parameter region because it is clear that the posterior density would be negligible. Finally, the threshold <italic>&#x220A;</italic> is chosen such that 5, 000 out of the total of almost 1 million simulations are below the threshold, corresponding to the acceptance probability of 0.0057.</p>
</sec>
</sec>
<sec id="s3">
<title>Details of the mixture model</title>
<p>We now discuss the mixture model in detail and then derive an efficient algorithm to estimate its parameters. Because the values of <italic>t</italic><sub>0<italic>i</italic></sub> in <xref ref-type="disp-formula" rid="eqn5">Eq 5</xref>, denoting the times to the MRCAs in case the sequences are different strains, are unknown, we model them as random variables and give each of them a prior distribution <disp-formula id="eqn9"><alternatives><graphic xlink:href="429464_eqn9.gif"/></alternatives></disp-formula> We further specify a weakly informative prior for &#x03BB; such that <disp-formula id="eqn10"><alternatives><graphic xlink:href="429464_eqn10.gif"/></alternatives></disp-formula></p>
<p>The parameter is thus shared between different <italic>t</italic><sub>0<italic>i</italic></sub> which allows us to learn about its distribution.</p>
<p>If <italic>k</italic> &#x003D; 1, then the Gamma distribution in <xref ref-type="disp-formula" rid="eqn9">Eq 9</xref> reduces to the Exponential, which, however, does not reflect our prior understanding of reasonable value of <italic>t</italic><sub>0<italic>i</italic></sub> because the mode of the resulting distribution is at zero, corresponding to a very recent common ancestor for genomes considered to be from different strains. Instead, we set <italic>k</italic> &#x003D; 5, <italic>&#x03B1;</italic> &#x003D; 2.5, and <italic>&#x03B2;</italic> &#x003D; 1600, which approximately correspond to the mean and standard deviation of 5800 and 8400 generations, respectively. This weakly informative prior reflects the notion that different strains diverged on average approximately a year ago, but with a large variance. Furthermore, if the time between samples, <italic>t<sub>i</sub></italic>, is three months, the prior translates to an expectation that, if the sampled genomes are from different strains, they are on average 30 mutations apart, with a large standard deviation of 50 mutations. Moreover, the density has a heavy tail to account for some possibly much greater distances. The formulas used to compute these values and other useful facts about the prior are provided in the supplementary material.</p>
<p>An equivalent way of writing the mixture model in <xref ref-type="disp-formula" rid="eqn6">Eq 6</xref>, which also simplifies the computations, is to introduce hidden labels which specify the component which generated each observation <italic>d<sub>i</sub></italic>, see [<xref ref-type="bibr" rid="c28">28</xref>]. We thus define latent variables <disp-formula id="eqn11"><alternatives><graphic xlink:href="429464_eqn11.gif"/></alternatives></disp-formula></p>
<p>The prior density for the latent variables z is <disp-formula id="eqn12"><alternatives><graphic xlink:href="429464_eqn12.gif"/></alternatives></disp-formula> where we have used vector notation t &#x003D; (<italic>t</italic><sub>1</sub>,&#x2026;, <italic>t<sub>N</sub></italic>)<sup><italic>T</italic></sup>, d &#x003D; (<italic>d</italic><sub>1</sub>,&#x2026;, <italic>d<sub>N</sub></italic>)<sup><italic>T</italic></sup>, z &#x003D; (z<sub>1</sub>,&#x2026;, z<sub><italic>N</italic></sub>)<sup><italic>T</italic></sup>, t<sub>0</sub> &#x003D; (<italic>t</italic><sub>01</sub>,&#x2026;, <italic>t</italic><sub>0<italic>N</italic></sub>)<sup><italic>T</italic></sup> and <italic>&#x03C9;</italic> &#x003D; (<italic>&#x03C9;<sub>S</sub>, &#x03C9;<sub>D</sub></italic>)<sup><italic>T</italic></sup>. We augment the parameter to represent jointly all model parameters in <xref ref-type="disp-formula" rid="eqn6">Eq 6</xref> and the prior densities specified in <xref ref-type="disp-formula" rid="eqn9">Eq 9</xref> and 10, i.e., <italic>&#x03B8;</italic> &#x003D; (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03C9;</italic>, z, t<sub>0</sub>, &#x03BB;)<sup><italic>T</italic></sup>. To complete the model specification, we must specify the prior for <italic>&#x03C9;, n</italic><sub>eff</sub> and <italic>&#x03BC;</italic>. We use <disp-formula id="eqn13"><alternatives><graphic xlink:href="429464_eqn13.gif"/></alternatives></disp-formula> that is, a Dirichlet distribution with parameter &#x03B3; &#x003D; (1,1)<sup><italic>T</italic></sup>. We use the posterior <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>|<italic>D</italic><sub>0</sub>), obtained by ABC using the external data <italic>D</italic><sub>0</sub> as discussed in the previous section, as the (joint) prior for (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>).</p>
</sec>
<sec id="s4">
<title>Bayesian inference for the mixture model</title>
<p>We now show how the mixture model can be fit efficiently to data. The joint probability distribution for the data d and the parameters <italic>&#x03B8;</italic> can be now written as <disp-formula id="eqn14"><alternatives><graphic xlink:href="429464_eqn14.gif"/></alternatives></disp-formula> <disp-formula id="eqn15"><alternatives><graphic xlink:href="429464_eqn15.gif"/></alternatives></disp-formula> We use Gibbs sampling, which is an MCMC algorithm, to sample from the posterior density. The algorithm exploits the hierarchical structure of the model and it proceeds by iteratively sampling from the conditional density of each variable (or a block of variables) at a time [<xref ref-type="bibr" rid="c29">29</xref>]. In the following we derive the conditional densities for the Gibbs sampling algorithm. We observed that some of the parameters are highly correlated which causes slow mixing of the resulting Markov chain and thus inefficient exploration of the parameter space. To make the algorithm more efficient, we reparametrise the model by defining new parameters <italic>&#x03B8;</italic>&#x2032; &#x003D; (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03C9;, z, &#x03B7;, &#x03BB;</italic>) via the transformation <italic>&#x03B7;</italic> &#x003D; <italic>&#x03BC;</italic>t<sub>0</sub> and we use the Gibbs sampler for the transformed parameters <italic>&#x03B8;</italic><sup>&#x2032;</sup>. This common strategy [<xref ref-type="bibr" rid="c29">29</xref>] resolves the problem arising from correlations between <italic>t</italic><sub>0<italic>i</italic></sub> and <italic>&#x03BC;</italic>, because the magnitudes of all <italic>&#x03B7;<sub>i</sub></italic> can now be changed simultaneously by a single <italic>&#x03BC;</italic> update. The original variables <italic>t</italic><sub>0<italic>i</italic></sub> can be obtained from the generated samples as <italic>t</italic><sub>0<italic>i</italic></sub> &#x003D; <italic>&#x03B7;<sub>i</sub></italic>/<italic>&#x03BC;</italic>.</p>
<p>The joint probability in <xref ref-type="disp-formula" rid="eqn15">Eq 15</xref> for the transformed parameters then becomes <disp-formula id="eqn16"><alternatives><graphic xlink:href="429464_eqn16.gif"/></alternatives></disp-formula> where <italic>&#x03BC;<sup>&#x2212;</sup>N</italic> is the determinant of the Jacobian of the inverse transformation. Computing the conditional density of parameter <italic>&#x03C9;</italic> is straightforward. We neglect those terms in <xref ref-type="disp-formula" rid="eqn16">Eq 16</xref> that do not depend on <italic>&#x03C9;</italic> and recognise the resulting formula as an unnormalised Dirichlet distribution. We then obtain <disp-formula id="eqn17"><alternatives><graphic xlink:href="429464_eqn17.gif"/></alternatives></disp-formula> with n &#x003D; (<italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>)<sup><italic>T</italic></sup>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline4.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline5.gif"/></alternatives></inline-formula>. Next we consider the latent variables z<sub><italic>i</italic></sub>. We see that the conditional distribution of z<sub><italic>i</italic></sub> for any <italic>i</italic> &#x003D; 1,&#x2026;, <italic>N</italic> does not depend on other latent variables z<sub><italic>j</italic></sub>, <italic>j</italic> &#x2260; <italic>i</italic>. Specifically, we obtain <disp-formula id="eqn18"><alternatives><graphic xlink:href="429464_eqn18.gif"/></alternatives></disp-formula> <disp-formula id="eqn19"><alternatives><graphic xlink:href="429464_eqn19.gif"/></alternatives></disp-formula> We expect the effective sample size <italic>n</italic><sub>eff</sub> and the mutation parameter <italic>&#x03BC;</italic> to be correlated a posteriori so we include them to the same block and update them together. We also include &#x03BB; to this block as it also tends to be correlated with <italic>n</italic><sub>eff</sub> and <italic>&#x03BC;</italic>. It is convenient to replace the sampling step from <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03BB;</italic>| <italic>&#x03C9;, z,&#x03B7;, D, D</italic><sub>0</sub>) with the following two consecutive sampling steps: first sample from <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>,|<italic>&#x03C9;, z</italic>,<italic>&#x03B7;, D, D</italic><sub>0</sub>)&#x003D; &#x222B; <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>, &#x03BB; |<italic>&#x03C9;, z</italic>,<italic>&#x03B7;, D, D</italic><sub>0</sub>) d&#x03BB; and then sample from <italic>p</italic>(&#x03BB; | <italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03C9;, z</italic>,<italic>&#x03B7;, D, D</italic><sub>0</sub>). From <xref ref-type="disp-formula" rid="eqn16">Eq 16</xref> we observe that <disp-formula id="eqn20"><alternatives><graphic xlink:href="429464_eqn20.gif"/></alternatives></disp-formula></p>
<p>The above formula is recognised to be proportional to a Gamma density as a function of &#x03BB;. We can thus marginalise &#x03BB; easily to obtain the following density for the first step <disp-formula id="eqn21"><alternatives><graphic xlink:href="429464_eqn21.gif"/></alternatives></disp-formula></p>
<p>In the second step, we sample from the probability density <disp-formula id="eqn22"><alternatives><graphic xlink:href="429464_eqn22.gif"/></alternatives></disp-formula></p>
<p>This formula follows directly from <xref ref-type="disp-formula" rid="eqn20">Eq 20</xref>.</p>
<p>Sampling from <xref ref-type="disp-formula" rid="eqn21">Eq 21</xref> and sampling z using <xref ref-type="disp-formula" rid="eqn18">Eq 18</xref> are challenging because <italic>p<sub>S</sub></italic> is defined implicitly via the W-F simulation model. Consequently, we will consider an approximation that allows to compute <italic>p<sub>S</sub></italic>(<italic>d<sub>i</sub></italic>| <italic>t<sub>i</sub>, n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) for any proposed point (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) and all values of <italic>d<sub>i</sub></italic> and <italic>t<sub>i</sub></italic> in the data. Since <italic>d<sub>i</sub></italic> &#x003D; <italic>d<sub>i</sub></italic><sub>1</sub> &#x002B; <italic>d<sub>i</sub></italic><sub>2</sub>, we can use the convolution formula for a sum of discrete random variables to see that <disp-formula id="eqn23"><alternatives><graphic xlink:href="429464_eqn23.gif"/></alternatives></disp-formula> where <italic>p</italic><sub>sim</sub> specifies the distribution for a distance between two genomes as in <xref ref-type="disp-formula" rid="eqn3">Eq 3</xref> and <italic>d<sub>m</sub></italic> is the maximum distance that can be obtained from <italic>p</italic><sub>sim</sub>.</p>
<p>Since <italic>p</italic><sub>sim</sub>(<italic>d<sub>i</sub></italic><sub>1</sub> | <italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) is not available analytically, we estimate this probability mass function by simulation. A special case is if we know that there is no variation in the population at the time of taking the first sample <italic>s<sub>i</sub></italic><sub>1</sub>, which can happen if we know that the acquisition happened just before the first sample. In this case, <italic>d<sub>i</sub></italic><sub>1</sub> &#x003D; 0, and we do not need the simulation. Since this is usually not the case, we use a general solution as follows: for each (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) value, we sample independently <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline6.gif"/></alternatives></inline-formula> by simulating the W-F model, sample a pair of genomes at a fixed time <italic>t</italic> from the simulated population, and compute their distance <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline7.gif"/></alternatives></inline-formula>. This is repeated for <italic>j</italic> &#x003D; 1,&#x2026;, <italic>s</italic>. Since <italic>d<sub>i</sub></italic><sub>1</sub> is discrete, we approximate <disp-formula id="eqn24"><alternatives><graphic xlink:href="429464_eqn24.gif"/></alternatives></disp-formula> for all <italic>i</italic>. Since in data <italic>D</italic> we do not know the acquisition times, we set <italic>t</italic> &#x003D; 6000 generations and use this same value for all <italic>i</italic>. This large value represents a steady state of the simulation, where the variation in the population occasionally increases and decreases as new lineages emerge and old ones die out, which can be seen as corresponding to a reasonable default expectation about population variability when the true acquisition time is unknown. While this assumption was introduced for computational necessity, it can be justified by considering its impact on the inferences: the simplification may cause slightly overestimated distances <italic>d<sub>i</sub></italic><sub>1</sub> if many acquisitions in reality happened very recently. The consequence is that the criterion for reporting new acquisitions becomes more <italic>conservative</italic>, because now the &#x2019;same strain&#x2019; model will place some probability mass on occasional greater distances, and hence better accommodate also distant genomes which might otherwise have been considered as different strains.</p>
<p>Some of the resulting probability mass functions <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline8.gif"/></alternatives></inline-formula> were already shown in <xref ref-type="fig" rid="fig4">Fig 4</xref>. In practice, the computations above are done using logarithms and the fact log, to avoid numerical underflow, which can occur whenever <italic>a<sub>i</sub></italic> &#x226A; 0. The finite sample size <italic>s</italic> causes some numerical error, but, because the distances are usually small enough that the number of values we need to consider is limited, <italic>s</italic> can be made large enough without too extensive computation, making this error small in general. The above procedure allows computation of the conditional density in <xref ref-type="disp-formula" rid="eqn21">Eq 21</xref> for any (<italic>n</italic><sub>eff</sub><italic>, &#x03BC;</italic>), and we can use a Metropolis update for (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>). We marginalised &#x03BB; in <xref ref-type="disp-formula" rid="eqn21">Eq 21</xref> to improve the mixing of the chain and to be able to use the analytical formula in <xref ref-type="disp-formula" rid="eqn22">Eq 22</xref>, and in the supplementary material we justify that this algorithm is valid under the assumption that a new &#x03BB; parameter is sampled only if the corresponding proposed value (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) has been accepted.</p>
<p>Whenever a new (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>)-parameter is proposed, we need to compute <italic>p</italic><sub>sim</sub> at this point to check the acceptance condition. This value is also needed when sampling z. However, computing <italic>p</italic><sub>sim</sub> on each MCMC iteration as described earlier makes the algorithm slow. Consequently, we instead precompute the values of <italic>p</italic><sub>sim</sub> in a dense grid of (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>)-points which can be done in a parallel manner on a computer cluster. Given the grid values, we use bilinear interpolation to approximate <italic>p</italic><sub>sim</sub> at each proposed point <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline9.gif"/></alternatives></inline-formula>. We proceed similarly also with the prior density <italic>p</italic>(<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>|<italic>D</italic><sub>0</sub>). This approach also allows one to fit the mixture model using different modelling assumptions or different data sets without need to repeat the costly W-F simulations.</p>
<p>Finally, we see that the probability density of <italic><sub>i</sub></italic> conditioned on the other variables does not depend on <italic>&#x03B7;<sub>j</sub>, j</italic> &#x2260; &#x003D; <italic>i</italic>. Specifically, we obtain <disp-formula id="eqn25"><alternatives><graphic xlink:href="429464_eqn25.gif"/></alternatives></disp-formula> for <italic>i</italic> &#x003D; 1<italic>,&#x2026;, N</italic>. Derivation of this result, the formula for the mixture weights <italic>w<sub>j</sub></italic> and a special algorithm (Algorithm 2) to generate random values from this density are shown in the supplementary material.</p>
<p>The resulting Gibbs sampler is presented as <xref ref-type="statement" rid="alg1">Algorithm 1</xref>. It could be alternatively called a Metropolis-within-Gibbs sampler since some of the parameters (<italic>n</italic><sub>eff</sub> and <italic>&#x03BC;</italic>) are sampled using a Metropolis-Hastings step using a proposal density that is denoted as <italic>q</italic>. Because <italic>n</italic><sub>eff</sub> is a discrete random variable, (<italic>n</italic><sub>eff</sub><italic>, &#x03BC;</italic>) is a mixed random vector and we cannot use the standard Gaussian proposal. Instead, we consider the distribution <disp-formula id="eqn26"><alternatives><graphic xlink:href="429464_eqn26.gif"/></alternatives></disp-formula> where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline10.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline11.gif"/></alternatives></inline-formula> are chosen to produce acceptance probability of the Metropolis step close to 0.25 and <italic>&#x03B4;</italic>(<italic>&#x00B7;</italic>) is the Dirac delta function. The first element of a random sample from <italic>q</italic> in <xref ref-type="disp-formula" rid="eqn26">Eq 26</xref> is an integer, and this proposal is also symmetric. We truncate the tails of <italic>q</italic> with respect to <italic>n</italic><sub>eff</sub> to be able to sample the discrete element from <italic>q</italic> efficiently. In practice we then use a proposal <italic>q</italic> that is a mixture density where the components are as in <xref ref-type="disp-formula" rid="eqn26">Eq 26</xref> but with different variance parameters <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline12.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline13.gif"/></alternatives></inline-formula> to occasionally propose large steps to increase the exploration of the parameter space.</p>
<statement id="alg1">
<label>Algorithm 1</label>
<title>MH-within-Gibbs sampling algorithm for the mixture model</title>
<p>select an initial parameter <italic>&#x03B8;</italic><sup>&#x2032;</sup>(0) (e.g. by sampling from the prior <italic>p</italic>(<italic>&#x03B8;</italic><sup>&#x2032;</sup>)), proposal <italic>q</italic> and the number of samples <italic>s</italic></p>
<p><bold>for</bold> <italic>i</italic> &#x003D; 1,&#x2026;, <italic>s</italic> <bold>do</bold></p>
<p>sample <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline14.gif"/></alternatives></inline-formula> and <italic>u</italic> &#x223C; <italic>U</italic>([0, 1])</p>
<p>compute <italic>&#x03C1;</italic> &#x003D; min <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline15.gif"/></alternatives></inline-formula> using <xref ref-type="disp-formula" rid="eqn21">Eq 21</xref></p>
<p><bold>if</bold> <italic>&#x03C1;</italic> &#x003C; <italic>u</italic> <bold>then</bold></p>
<p>set <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline16.gif"/></alternatives></inline-formula></p>
<p>sample &#x03BB;<sup><italic>(i)</italic></sup> &#x223C; <italic>p</italic>(&#x03B7;|<italic>&#x03BC;<sup>(i)</sup>, &#x03B7;<sup>(i&#x2212;1))</sup></italic>, &#x03BB; &#x003D; &#x03BB;<sup>(<italic>i</italic>)</sup> using <xref ref-type="disp-formula" rid="eqn22">Eq 22</xref></p>
<p><bold>else</bold></p>
<p>set <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline17.gif"/></alternatives></inline-formula></p>
<p><bold>end if</bold></p>
<p><bold>for</bold> <italic>j</italic> &#x003D; 1,&#x2026;, <italic>N</italic> do</p>
<p>sample <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline18.gif"/></alternatives></inline-formula> using the Algorithm 2 with <italic>&#x03BC;</italic> &#x003D; <italic>&#x03BC;</italic><sup>(<italic>i</italic>)</sup>, z &#x003D; z<sup>(<italic>i</italic>&#x2212;1)</sup>, &#x003D; &#x03BB; &#x003D; &#x03BB;<sup>(<italic>i</italic>)</sup></p>
<p><bold>end for</bold></p>
<p><bold>for</bold> <italic>j</italic> &#x003D; 1,&#x2026;,<italic>N</italic> do</p>
<p>sample <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline19.gif"/></alternatives></inline-formula> using <xref ref-type="disp-formula" rid="eqn18">Eq 18</xref></p>
<p><bold>end for</bold></p>
<p>sample <italic>&#x03C9;</italic><sup>(<italic>i</italic>)</sup> &#x223C; <italic>p</italic>(&#x00B7;|z<sup>(<italic>i</italic>)</sup>, <italic>D</italic>) using <xref ref-type="disp-formula" rid="eqn17">Eq 17</xref></p>
<p><bold>end for</bold></p>
<p><bold>return</bold> samples <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline20.gif"/></alternatives></inline-formula></p>
</statement>
</sec>
<sec id="s5">
<title>Posterior predictive distribution</title>
<p>Given a new (future) data point (<italic>d<sup>&#x002A;</sup>, t<sup>&#x002A;</sup></italic>) from a new patient, we would like to compute the probability of whether this case is of the same strain. This can be computed from the posterior of the model fitted to data <italic>D, D</italic><sub>0</sub> as follows. We denote the original parameter vector with <italic>&#x03B8;</italic> as before and additional parameters related to the new data point <italic>D<sup>&#x002A;</sup></italic> &#x003D; {(<italic>d<sup>&#x002A;</sup>, t<sup>&#x002A;</sup></italic>)} as z<sup>&#x002A;</sup> &#x2208; {(1, 0), (0, 1)} and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline21.gif"/></alternatives></inline-formula>. The updated posterior after considering the new data point <italic>D<sup>&#x002A;</sup></italic> is then <disp-formula id="eqn27"><alternatives><graphic xlink:href="429464_eqn27.gif"/></alternatives></disp-formula> <disp-formula id="eqn28"><alternatives><graphic xlink:href="429464_eqn28.gif"/></alternatives></disp-formula> <disp-formula id="eqn29"><alternatives><graphic xlink:href="429464_eqn29.gif"/></alternatives></disp-formula> where <italic>p</italic>(<italic>&#x03B8;</italic>|<italic>D, D</italic><sub>0</sub>) is the posterior based on our original data <italic>D, D</italic><sub>0</sub>. We marginalise the set of parameters least contributory to the aim to obtain <disp-formula id="eqn30"><alternatives><graphic xlink:href="429464_eqn30.gif"/></alternatives></disp-formula> <disp-formula id="eqn31"><alternatives><graphic xlink:href="429464_eqn31.gif"/></alternatives></disp-formula> where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline22.gif"/></alternatives></inline-formula> for <italic>i</italic> &#x003D; 1,&#x2026;, <italic>s</italic>. The probability of the new measurement point (<italic>d<sup>&#x002A;</sup>, t<sup>&#x002A;</sup></italic>) being of the same strain, based on the previously observed data <italic>D, D</italic><sub>0</sub> is obtained from <xref ref-type="disp-formula" rid="eqn31">Eq. 31</xref>.</p>
</sec>
<sec id="s6">
<title>Results</title>
<p>In this section we fit the W-F model to the external data <italic>D</italic><sub>0</sub> as discussed in Section ABC inference to update the prior using external data. We then verify that the proposed Gibbs sampling algorithm for fitting the mixture model from Section Bayesian inference for the mixture model is consistent based on experiments with simulated data. Subsequently, we fit the mixture model to the MRSA data and discuss the results. Finally, we assess the quality of the model fit.</p>
<sec id="s6a">
<title>Updating the prior using ABC inference</title>
<p>The ABC posterior based on the external data <italic>D</italic><sub>0</sub> and the discrepancy in <xref ref-type="disp-formula" rid="eqn8">Eq 8</xref>, is shown in <xref ref-type="fig" rid="fig5">Fig 5A</xref>. We also repeated the computations so that we omitted a subset, patients A-M, from the analysis i.e. the second summation term in <xref ref-type="disp-formula" rid="eqn8">Eq 8</xref> was set to zero. This was done to assess the effect of patients A-M, which have measurements from one time point only, and an unknown time since acquisition. This extra analysis resulted in an ABC posterior approximation shown in <xref ref-type="fig" rid="fig5">Fig 5B</xref>. We see that in both cases large parts of the parameter space have been ruled out as having negligible posterior probability. As expected, the posterior distribution based on the subset (<xref ref-type="fig" rid="fig5">Fig 5B</xref>) is slightly more dispersed than with the full data <italic>D</italic><sub>0</sub> (<xref ref-type="fig" rid="fig5">Fig 5A</xref>). Using the full data causes the estimated mutation rate to be slightly greater than with the subset, likely because the model needs to accommodate the higher variability in the patients A-M. In addition, small effective sample sizes (<italic>n</italic><sub>eff</sub> &#x003C; 2000) are less probable based on the full data <italic>D</italic><sub>0</sub>.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig 5.</label>
<caption><title>ABC posterior distribution for (<italic>n</italic><sub>eff</sub><italic>, &#x03BC;</italic>).</title>
<p>The ABC posterior distribution i.e. the updated prior for parameters (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>), the effective population size and mutation rate, given data <italic>D</italic><sub>0</sub>. Panel A shows the result with the full data and panel B the corresponding result with only a subset of the data (see text for details).</p></caption>
<graphic xlink:href="429464_fig5.tif"/>
</fig>
<p>Overall, we see that the effective sample size <italic>n</italic><sub>eff</sub> cannot be well identified based on the external data <italic>D</italic><sub>0</sub> alone. We also see that if the upper bound of the prior density of <italic>n</italic><sub>eff</sub> was increased from 10, 000, higher values would likely have non-negligible posterior probability also; however, this constraint will have a negligible impact on the resulting posterior from the mixture model as is seen later. The mutation rate <italic>&#x03BC;</italic>, on the other hand, is smaller than 0.001 mutations per genome per generation with high probability and cannot be arbitrarily small.</p>
</sec>
<sec id="s6b">
<title>Validation of the mixture model using simulated data</title>
<p>To empirically investigate the identifiability of the mixture model parameters and the correctness and consistency of our MCMC algorithm under the assumption that the model is specified correctly, we first fit the mixture model to simulated data. We generate artificial data from the mixture model with parameter values similar to the estimates for the observed data <italic>D</italic> from the next section. Specifically, we choose <italic>n</italic><sub>eff</sub> &#x003D; 2, 137, <italic>&#x03BC;</italic> &#x003D; 0.0011, <italic>&#x03C9;<sub>S</sub></italic> &#x003D; 0.8, &#x003D; 0.0001 and we repeat the analysis with various data sizes <italic>N</italic>. We use otherwise similar priors as for the real data in the next section except that, for simplicity, instead of using the prior obtained from the ABC inference, we use a uniform prior in <xref ref-type="disp-formula" rid="eqn7">Eq 7</xref>. We then fit the mixture model to the simulated data sets to investigate if the true parameters can be recovered (identifiability) and whether the posterior becomes concentrated around their true values when the amount of data increases (consistency).</p>
<p>Results are illustrated in <xref ref-type="fig" rid="fig6">Fig 6</xref>. We see that the (marginal) posterior of (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) is concentrated around the true parameter value that was used to generate the data (green diamond in the figure). Also, despite the fact that the number of parameters increases as a function of data size <italic>N</italic> (because each data point (<italic>d<sub>i</sub>, t<sub>i</sub></italic>) has its own class indicator z<sub><italic>i</italic></sub> and time to the most recent common ancestor <italic>t</italic><sub>0<italic>i</italic></sub> parameter), the marginal posterior distribution of (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) can be identified and appears to converge to the true value as <italic>N</italic> increases. On the other hand, we cannot learn each <italic>t</italic><sub>0<italic>i</italic></sub> accurately since essentially only the data point to which the parameter corresponds provides information about its value. However, precise estimates of these nuisance parameters are not needed for using the model or obtaining useful estimates of the other unknown parameters as demonstrated in <xref ref-type="fig" rid="fig6">Fig 6</xref>.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Fig 6.</label>
<caption><title>Accuracy and consistency with synthetic data.</title>
<p>The first three panels show the estimated posterior distributions for parameters (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) of the mixture model using simulated data of different sizes <italic>N</italic>. The green diamond shows the true value used to generate the simulated data and the light grey dots denote the grid point locations needed for numerical computations. The bottom right panel shows the estimated vs. the true <italic>&#x03C9;<sub>S</sub></italic> parameter in a set of additional simulation experiments.</p></caption>
<graphic xlink:href="429464_fig6.tif"/>
</fig>
<p>The panel in the lower right corner of <xref ref-type="fig" rid="fig6">Fig 6</xref> shows results from an additional simulation experiment where the mixture model is fitted to data generated with different values for the <italic>&#x03C9;<sub>S</sub></italic> parameter, which represents the proportion of pairs that are from the same strain. Other than that and the fact that we fixed <italic>N</italic> &#x003D; 150, the experimental design is the same as above. The results show that the estimated <italic>&#x03C9;<sub>S</sub></italic> values generally agree well with the true values. Interestingly, <italic>&#x03C9;<sub>S</sub></italic> is slightly overestimated when its true value is close to 0, and slightly underestimated when the true value is close to 1, which may reflect the regularizing effect of the prior, drawing the estimates away from the extreme values. Furthermore, when the true value of <italic>&#x03C9;<sub>S</sub></italic> is around 0.5, the variance of the estimate tends to be higher than with <italic>&#x03C9;<sub>S</sub></italic> values close to 0 or 1. This observation may be explained by the fact that there are more data points that overlap both mixture model components when <italic>&#x03C9;<sub>S</sub></italic> is around 0.5 which makes the inference task more challenging and causes higher posterior variance.</p>
</sec>
<sec id="s6c">
<title>Analysis of the Project CLEAR MRSA data</title>
<p>The following settings are used to analyse longitudinally-sampled <italic>S. aureus</italic> nares isolates from the control arm of Project CLEAR [<xref ref-type="bibr" rid="c23">23</xref>]. We generate 4 MCMC chains, each of length 25, 000, initialized randomly from the prior density, whose first halves are discarded as &#x220A;burn-in&#x201D;. We use the Gelman and Rubin&#x2019;s convergence diagnostic in R-package coda and visual checks to assess the convergence of the MCMC algorithm. We use 100 &#x00D7; 100 equidistant grid for numerical computation with the (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) values and <italic>s</italic> &#x003D; 10, 000 in <xref ref-type="disp-formula" rid="eqn24">Eq 24</xref>. The ABC posterior obtained in Section Updating the prior using ABC inference and visualised in <xref ref-type="fig" rid="fig5">Fig 5A</xref> is used as the prior for (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>).</p>
<p>The parameter vector &#x03B8; consists of the &#x2019;global&#x2019; parameters <italic>n</italic><sub>eff</sub>, <italic>&#x03BC;, &#x03C9;, &#x03BB;</italic>, as well as a large number of nuisance parameters (z and t<sub>0</sub>) related to each data point. The estimated global parameters are presented in <xref ref-type="table" rid="tbl1">Table 1</xref>. We also repeated the analysis using a uniform prior on (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>). While the uniform prior is non-informative about the parameters (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>), the results are nevertheless surprisingly similar (<xref ref-type="table" rid="tbl1">Table 1</xref>). In other words, the additional data <italic>D</italic><sub>0</sub> used to update the prior has only a small effect on the estimated parameters of the mixture model. This was unexpected because the data set <italic>D</italic> used to train the mixture model has only one genome per sampled time point, and yet, impressively, the model is able to learn about the parameters (<italic>n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) which effectively define the variability in the whole population. This further demonstrates the robustness of the mixture model to the prior used. We observe, however, that incorporating the prior from the ABC slightly shifts the probability distribution for <italic>n</italic><sub>eff</sub> towards larger values, although there is no clear conflict between the two results. For example, as seen in <xref ref-type="table" rid="tbl1">Table 1</xref>, the 95&#x0025; credible interval (CI) for <italic>n</italic><sub>eff</sub>, [1200, 2200], gets updated to [1300, 2200] when the extra prior information is included.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Posterior mean and 95&#x0025; credible interval (CI) for the &#x2019;global&#x2019; parameters of the mixture model.</p></caption>
<graphic xlink:href="429464_tbl1.tif"/>
</table-wrap>
<p><xref ref-type="fig" rid="fig7">Fig 7</xref> shows the posterior predictive distribution for the probability of the same strain case for a (hypothetical future) observation with distance <italic>d</italic><sup>&#x002A;</sup> and time difference <italic>t<sup>&#x002A;</sup></italic>. Blue colour in the figure denotes high probability of the same strain. The corresponding 50&#x0025; classification curve is (almost) a straight line with a steep positive slope. This is as expected since the same strain model can explain a greater number of mutations when more time has passed. Approximately 20 mutations draws the line between the same strain and different strains cases within the time difference up to 6000 generations. The uncertainty in the classification occurs because there is overlap in the two explanations (around <italic>d</italic><sup>&#x002A;</sup> &#x2248; 20) and because of the posterior uncertainty in the model parameters &#x03B8;.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Fig 7.</label>
<caption><title>Results for the Project CLEAR MRSA data.</title>
<p>Contour plot for same strain probability of a distance <italic>d<sup>&#x002A;</sup></italic> and time interval <italic>t<sup>&#x002A;</sup></italic> based on the fitted model. The coloured points denote the observations that were used to fit the model. Blue colour indicates large same strain probability. Distances greater than 50 are not shown and are classified as different strains with probability one. 6, 000 generations on the y-axis correspond to approximately one year.</p>
</caption>
<graphic xlink:href="429464_fig7.tif"/>
</fig>
<p>We also analysed explicitly all observed patterns where: 1) two genomes of the same ST from the same patient are interleaved with a missing observation, i.e. the colonization appears to disappear and then re-emerge, and 2) two genomes of the same ST from the same patient are interleaved with an observation of a different ST. The numbers for the two genomes being from the same or different strain in these patterns are shown in <xref ref-type="table" rid="tbl2">Table 2</xref>. The credible intervals for the &#x2019;same strain&#x2019; proportion combine uncertainty from the limited number of samples with the posterior uncertainty of whether a sample is from the same strain or not (see the Supplementary material for further details). From <xref ref-type="table" rid="tbl2">Table 2</xref> we see that approximately 58&#x0025; of genome pairs in pattern 1) are from the same strain. This is only a little smaller than the same strain proportion when there are no missing observations in between (84&#x0025;). Therefore, a plausible explanation for most of the missing in-between observations is that in reality the same strain has been colonizing the patient throughout, and the missing observation reflects the limited sensitivity of the sampling, rather than a clearance followed by a novel acquisition. Similarly, even if interleaved with a different ST (pattern 2), the surrounding genomes often, in 63&#x0025; of cases, appear to be from the same strain. This suggests that in these cases the patient has been colonized by the surrounding strain throughout, and co-colonized by two different STs at the time of observing the divergent ST in the middle.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>The estimated numbers (mean, 95&#x0025; CI in parenthesis) of cases with genomes in the beginning and in the end of the pattern being from the same or different strain, for three different patterns in the Project CLEAR MRSA data, and the estimated proportion of the same strain cases. same strain/n diff. strain/n same strain prop.</title></caption>
<graphic xlink:href="429464_tbl2.tif"/>
</table-wrap>
<p>Finally, we compute acquisition and clearance rates using our model, and compare those to the ones obtained with the common strategy of using a fixed distance threshold. For the purposes of this exposition, we define the acquisition <italic>r</italic><sub>acq</sub> and clearance rates <italic>r</italic> clear informally as <disp-formula id="eqn32"><alternatives><graphic xlink:href="429464_eqn32.gif"/></alternatives></disp-formula> where the quantities <italic>A, B, C, D</italic> and <italic>E</italic> denote the numbers of possible events in consecutive samples (e.g. acquisition, replacement, clearance, or no change) defined in detail in <xref ref-type="table" rid="tbl3">Table 3</xref>. Also, <italic>G</italic> is the total number of possible events over the whole data. The quantities <italic>A, B, D</italic> and <italic>E</italic> are random variables that depend on the same/different strain posterior probabilities and, consequently, we also compute the uncertainty estimates for these quantities in <xref ref-type="disp-formula" rid="eqn32">Eq 32</xref>. Number C is a constant because an observed change of ST always indicates an actual change of ST as well. For cases with one or more negative samples (denoted by &#x2205;) between two positive samples, we do not know when the clearance and acquisition events took place and whether the negative samples are &#x220A;false negatives&#x201D;. To handle these cases, we parsimoniously assume that a missing observation between two positive samples that are inferred to come from the same strain is a false negative (i.e. that the same strain was present also in the middle, even if it was not detected), and record these events in the groups A-E accordingly. Details on how we unambiguously determine the group for all special cases is provided in the Supplementary material.</p>
<p>The estimated acquisition and clearance rates with 95&#x0025; credible intervals are shown on the last two lines of <xref ref-type="table" rid="tbl3">Table 3</xref>. For comparison, we also computed these rates otherwise similarly but using a fixed distance threshold of 40 mutations, a value used in [<xref ref-type="bibr" rid="c10">10</xref>], to determine if two genomes are from the same strain or not. We see that the threshold-based estimates are relatively similar to, and only slightly smaller than the estimates from our model. The explanation for the similarity of summaries such as the acquisition and deletion rates is that, when estimating these quantities across the whole data set, the uncertainty gets averaged out, even if individual data points exhibit a lot of uncertainty regarding whether they are the same strain or not (see <xref ref-type="fig" rid="fig7">Fig 7</xref>). Importantly, while being consistent with the previous results, our model bypasses the task of heuristically choosing a single threshold and adds uncertainty estimates around the point estimates, crucial for drawing rigorous conclusions.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>Estimated numbers (posterior means) of different patterns A-E of consecutive samples and the estimated acquisition and clearance rates (mean, 95&#x0025; CI in parenthesis).</title></caption>
<graphic xlink:href="429464_tbl3.tif"/>
</table-wrap>
<p>Above, ST denotes sequence type as before, str denotes the strain and symbol; denotes a negative sample i.e. no bacteria detected.</p>
</sec>
<sec id="s6d">
<title>Assessing the goodness-of-fit of the model for the Project CLEAR MRSA data</title>
<p>As the last part of our analysis, we use posterior predictive checks to assess the quality of the model, see e.g. [<xref ref-type="bibr" rid="c15">15</xref>] for further details. Briefly, this consists of simulating replicated data sets <italic>D</italic><sup>rep,(<italic>j</italic>)</sup> from the fitted mixture model and comparing these to the observed data <italic>D</italic> for any systematic deviations. Any discrepancies between the observed and simulated data can be used to criticise the model and understand how the model could be improved. In practice, simulating replicate data is done by simulating a parameter vector <italic>&#x03B8;<sup>(<italic>j</italic>)</sup></italic> from the posterior (by using the existing MCMC chain) and simulating a new set of distance-time difference pairs <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="429464_inline23.gif"/></alternatives></inline-formula> in <italic>D</italic><sup>rep,(<italic>j</italic>)</sup> from the model using <sup><italic>&#x03B8;(<italic>j</italic>)</italic></sup>. To obtain <italic>M</italic> replicates this procedure is repeated for <italic>j</italic> &#x003D; 1,&#x2026;, <italic>M</italic>.</p>
<p>Example replicate data sets are shown in <xref ref-type="fig" rid="fig8">Fig 8</xref>. Overall, the simulated distances are similar to the corresponding observations. There is a clear peak at <italic>d<sub>i</sub></italic> &#x003D; 0, and as the distance is increased the frequency starts to decrease. Occasional large distances (<italic>d<sub>i</sub></italic> &#x003E; 20) occur only rarely, in keeping with the observed data. A minor discrepancy is that the fitted model tends to underestimate the frequency of distance zero while small positive distances tend to occur more frequently than observed. This could happen because we estimated the empirical densities <italic>p</italic><sub>sim</sub>(<italic>d<sub>i</sub></italic><sub>1</sub> <italic>|n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) using a constant time of 6, 000 (i.e. 1 year) since the acquisition (as discussed in Section Bayesian inference for the mixture model), which may lead to a slight overestimation of the distances. To explore the impact of this assumption further, we repeated the analysis so that we computed the densities <italic>p</italic><sub>sim</sub>(<italic>d<sub>i</sub></italic><sub>1</sub> <italic>| n</italic><sub>eff</sub>, <italic>&#x03BC;</italic>) at a constant time of 1, 000 generations. However, the mismatch did not disappear completely and the estimated mutation rate increased as a result to compensate for the occurrence of greater distances, in disagreement with the prior density from the ABC analysis and data <italic>D</italic><sub>0</sub>. We thus believe that the current model is adequate.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Fig 8.</label>
<caption><title>Model validation using posterior predictive checking.</title>
<p>The histogram in the upper left corner shows the observed distance distribution in the Project CLEAR MRSA data, the other figures in the top two rows show the corresponding distances in replicate data sets simulated from the fitted model. The bottom two rows show the same histograms zoomed to range [0, 50]. The replicate data sets look overall similar to the observed data, demonstrating the adequacy of the model. However, the amount of zero distances is underestimated and the frequencies of small positive distances tend to be slightly overestimated.</p></caption>
<graphic xlink:href="429464_fig8.tif"/>
</fig>
</sec>
</sec>
<sec id="s7">
<title>Discussion</title>
<p>We presented a new model for the analysis of clearance and acquisition of bacterial colonization, which, unlike previous approaches, does not rely on a heuristic fixed distance threshold to determine whether genomes observed at different times points are from the same or different acquisition. Fully probabilistic, the model automatically provides uncertainty estimates for all relevant quantities. Furthermore, it takes into account the variation in the time intervals between pairs of consecutive samples. Another benefit is that the model can easily incorporate additional external data to inform about the values of the parameters. To fit the model, we developed an innovative combination of ABC and MCMC, based on an underlying mixture model where one of the component distributions was formulated empirically by simulation.</p>
<p>We demonstrated the model using data on <italic>S. aureus</italic> genomes sampled longitudinally from multiple patients. Our analysis provided evidence for occasional co-colonization and identified likely false negative samples. The output of the model consists of the same vs. different strain probability for any pair of genomes, and, by using this information to decide (probabilistically) when and where the colonizing strain had changed, the acquisition and clearance rates were easy to calculate. Estimates of these parameters were found to be in agreement with previous estimates derived using a fixed threshold, but now we were able to provide confidence intervals, essential for drawing rigorously supported conclusions. We believe such analyses are common enough that our method should be useful for many, and, consequently, we provide it as an easy-to-use R-code. The code includes tools for both the ABC-inference to incorporate external data of distance distributions between multiple samples at a given time point (or two time points), and the MCMC-algorithm. We note that our method does not assume recombination, which was not relevant with the present data. If this is an issue, we recommend removing recombinations by preprocessing the genomes with one of the standard methods [<xref ref-type="bibr" rid="c30">30</xref>&#x2013;<xref ref-type="bibr" rid="c32">32</xref>]. While our analysis demonstrated that the external data may reduce uncertainty in the resulting posterior, we also saw that the method may work without such data. In the latter case the input is simply a list of distance-time difference pairs for genomes sampled from the same patient at consecutive time points, and it is sufficient to run the MCMC, which is efficient and fast in typical cases.</p>
<p>A central component of our approach is a model for within-host variation, required to determine how much variation can be expected if the genomes at different time points have evolved from the same strain obtained in a single acquisition. We selected for this purpose the basic Wright-Fisher model assuming constant population size and mutation rate with the understanding that these assumptions are expected to be violated to some extent in any realistic data set, but the benefits of simplicity include robustness of the conclusions to prior distributions and identifiability of the parameters from the available data. More complex models have been fitted to the distance distributions (our external data <italic>D</italic><sub>0</sub>), assuming the population size first increases and then decreases [<xref ref-type="bibr" rid="c13">13</xref>]. However, our model can fit the same data with fewer parameters, which justifies the simpler alternative. Furthermore, the constant population size may also be seen as a sensible model for persistent colonization. An interesting future research question is what additional data should be collected in order to be able to fit one of the possible extensions of the basic model. Another direction that we are currently pursuing is to extend the model to cover genomes sampled from multiple body sites.</p>
</sec>
<sec id="s8">
<title>Supporting information</title>
<p><bold>S1 File. Derivations and further details of the model</bold>. We provide some further derivations and details related to our MCMC algorithm. To guide the selection of prior hyperparameters, we also derive the explicit prior distribution and some of its summaries for the parameter t<sub>0</sub> and the mean and variance for the prior predictive distribution for the distance. We also describe further details on computing the acquisition and clearance rates.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We acknowledge the computational resources provided by Aalto Science-IT project.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Young</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Golubchik</surname> <given-names>T</given-names></string-name>, <string-name><surname>Batty</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Fung</surname> <given-names>R</given-names></string-name>, Larner-Svensson H, <string-name><surname>Votintseva</surname> <given-names>AA</given-names></string-name>, <etal>et al.</etal> <article-title>Evolutionary dynamics of Staphylococcus aureus during progression from carriage to disease</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>12</issue>):<fpage>4550</fpage>&#x2013;<lpage>4555</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Young</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>NC</given-names></string-name>, <string-name><surname>Cole</surname> <given-names>K</given-names></string-name>, <string-name><surname>Price</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>E</given-names></string-name>, <etal>et al.</etal> <article-title>Severe infections emerge from commensal bacteria by adaptive evolution</article-title>. <source>elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e30637</fpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>N</given-names></string-name>, <string-name><surname>Pichon</surname> <given-names>B</given-names></string-name>, <string-name><surname>Golubchik</surname> <given-names>T</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>D</given-names></string-name>, <string-name><surname>Paul</surname> <given-names>J</given-names></string-name>, <string-name><surname>Blanc</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> <article-title>Whole-genome sequencing reveals the contribution of long-term carriers in Staphylococcus aureus outbreak investigation</article-title>. <source>Journal of Clinical Microbiology</source>. <year>2017</year>;<volume>55</volume>(<issue>7</issue>):<fpage>2188</fpage>&#x2013;<lpage>2197</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Alam</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Read</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Petit</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Boyle-Vavra</surname> <given-names>S</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>LG</given-names></string-name>, <string-name><surname>Eells</surname> <given-names>SJ</given-names></string-name>, <etal>et al.</etal> <article-title>Transmission and microevolution of USA300 MRSA in US households: evidence from whole-genome sequencing</article-title>. <source>MBio</source>. <year>2015</year>;<volume>6</volume>(<issue>2</issue>):<fpage>e00054</fpage>&#x2013;<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Coll</surname> <given-names>F</given-names></string-name>, <string-name><surname>Harrison</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Toleman</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Raven</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Blane</surname> <given-names>B</given-names></string-name>, <etal>et al.</etal> <article-title>Longitudinal genomic surveillance of MRSA in the UK reveals transmission patterns in hospitals and the community</article-title>. <source>Science Translational Medicine</source>. <year>2017</year>;<volume>9</volume>(<issue>413</issue>):<fpage>eaak9745</fpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Calderwood</surname> <given-names>MS</given-names></string-name>. <article-title>Editorial commentary: Duration of colonization with methicillin-resistant Staphylococcus aureus: A question with many answers</article-title>. <source>Clinical infectious diseases: an official publication of the Infectious Diseases Society of America</source>. <year>2015</year>;<volume>60</volume>(<issue>10</issue>):<fpage>1497</fpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Miller</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Godwin</surname> <given-names>H</given-names></string-name>, <string-name><surname>Fung</surname> <given-names>R</given-names></string-name>, <string-name><surname>Votintseva</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bowden</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title>Dynamics of acquisition and loss of carriage of Staphylococcus aureus strains in the community: the effect of clonal complex</article-title>. <source>Journal of Infection</source>. <year>2014</year>;<volume>68</volume>(<issue>5</issue>):<fpage>426</fpage>&#x2013;<lpage>439</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Peto</surname> <given-names>TE</given-names></string-name>, <string-name><surname>Crook</surname> <given-names>DW</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>DJ</given-names></string-name>. <article-title>Within-host evolution of bacterial pathogens</article-title>. <source>Nature Reviews Microbiology</source>. <year>2016</year>;<volume>14</volume>(<issue>3</issue>):<fpage>150</fpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Worby</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>. <article-title>Within-host bacterial diversity hinders accurate reconstruction of transmission networks from genomic distance data</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1003549</fpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Price</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Cole</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bexley</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kostiou</surname> <given-names>V</given-names></string-name>, <string-name><surname>Eyre</surname> <given-names>DW</given-names></string-name>, <string-name><surname>Golubchik</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal> <article-title>Transmission of Staphylococcus aureus between health-care workers, the environment, and patients in an intensive care unit: a longitudinal cohort study based on whole-genome sequencing</article-title>. <source>The Lancet Infectious Diseases</source>. <year>2017</year>;<volume>17</volume>(<issue>2</issue>):<fpage>207</fpage>&#x2013;<lpage>214</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Uhlemann</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Dordel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Knox</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Raven</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MT</given-names></string-name>, <etal>et al.</etal> <article-title>Molecular tracing of the emergence, diversification, and transmission of S. aureus sequence type 8 in a New York community</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>18</issue>):<fpage>6738</fpage>&#x2013;<lpage>6743</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Goldblatt</surname> <given-names>D</given-names></string-name>, <string-name><surname>Nosten</surname> <given-names>F</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <article-title>Genome-wide identification of lineage and locus specific variation associated with pneumococcal carriage duration</article-title>. <source>Elife</source>. <year>2017</year>;<fpage>6</fpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Golubchik</surname> <given-names>T</given-names></string-name>, <string-name><surname>Batty</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Farr</surname> <given-names>H</given-names></string-name>, <string-name><surname>Young</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Larner-Svensson</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <article-title>Within-host evolution of Staphylococcus aureus during asymptomatic carriage</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e61319</fpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="book"><string-name><surname>Robinson</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Feil</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D</given-names></string-name>. <chapter-title>Bacterial population genetics in infectious disease</chapter-title>. <publisher-name>John Wiley &#x0026; Sons</publisher-name>; <year>2010</year>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="book"><string-name><surname>Gelman</surname> <given-names>A</given-names></string-name>, <string-name><surname>Carlin</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Stern</surname> <given-names>HS</given-names></string-name>, <string-name><surname>Dunson</surname> <given-names>DB</given-names></string-name>, <string-name><surname>Vehtari</surname> <given-names>A</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>DB</given-names></string-name>. <chapter-title>Bayesian data analysis</chapter-title>. <edition>3rd</edition> ed. <publisher-name>Chapman &#x0026; Hall/CRC Texts in Statistical Science</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="book"><string-name><surname>O&#x2019;Hagan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Forster</surname> <given-names>J</given-names></string-name>. <chapter-title>Advanced Theory of Statistics Bayesian inference</chapter-title>. <edition>2nd</edition> ed. <publisher-loc>London, UK</publisher-loc>: <publisher-name>Arnold</publisher-name>; <year>2004</year></mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Beaumont</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Balding</surname> <given-names>DJ</given-names></string-name>. <article-title>Approximate Bayesian computation in population genetics</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>162</volume>(<issue>4</issue>):<fpage>2025</fpage>&#x2013;<lpage>2035</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Lintusaari</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gutmann</surname> <given-names>MU</given-names></string-name>, <string-name><surname>Dutta</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kaski</surname> <given-names>S</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <article-title>Fundamentals and Recent Developments in Approximate Bayesian Computation</article-title>. <source>Systematic biology</source>. <year>2017</year>;<volume>66</volume>(<issue>1</issue>):<fpage>e66</fpage>&#x2013;<lpage>e82</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Ansari</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>. <article-title>Inference of the properties of the recombination process from whole bacterial genomes</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>196</volume>(<issue>1</issue>):<fpage>253</fpage>&#x2013;<lpage>265</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Numminen</surname> <given-names>E</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gyllenberg</surname> <given-names>M</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <article-title>Estimating the transmission dynamics of Streptococcus pneumoniae from strain prevalence data</article-title>. <source>Biometrics</source>. <year>2013</year>;<volume>69</volume>(<issue>3</issue>):<fpage>748</fpage>&#x2013;<lpage>757</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>J&#x00E4;rvenp&#x00E4;&#x00E4;</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gutmann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Vehtari</surname> <given-names>A</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>. <article-title>Gaussian process modeling in approximate Bayesian computation to estimate horizontal gene transfer in bacteria</article-title>. <source>Annals of Applied Statistics</source>. <year>2018</year>;.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>De Maio</surname> <given-names>N</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>DJ</given-names></string-name>. <article-title>The bacterial sequential Markov coalescent</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>206</volume>(<issue>1</issue>):<fpage>333</fpage>&#x2013;<lpage>343</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="other"><collab>Agency for Healthcare Research and Quality (AHRQ). Project CLEAR (Changing Lives by Eradicating Antibiotic Resistance) Trial</collab>; <year>2018</year>. <ext-link ext-link-type="uri" xlink:href="https://clinicaltrials.gov/ct2/show/NCT01209234">https://clinicaltrials.gov/ct2/show/NCT01209234</ext-link>. Last <date-in-citation content-type="accessed-date">accessed 08&#x2013;23&#x2013;2018</date-in-citation>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Schierup</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Wiuf</surname> <given-names>C</given-names></string-name>. <article-title>The coalescent of bacterial populations</article-title>. <source>Bacterial Population Genetics in Infectious Disease</source>. <year>2010</year>; p. <fpage>1</fpage>&#x2013;<lpage>18</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Hartig</surname> <given-names>F</given-names></string-name>, <string-name><surname>Calabrese</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Reineking</surname> <given-names>B</given-names></string-name>, <string-name><surname>Wiegand</surname> <given-names>T</given-names></string-name>, <string-name><surname>Huth</surname> <given-names>A</given-names></string-name>. <article-title>Statistical inference for stochastic simulation models&#x2013;theory and application</article-title>. <source>Ecology Letters</source>. <year>2011</year>;<volume>14</volume>(<issue>8</issue>):<fpage>816</fpage>&#x2013;<lpage>27</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Marin</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Pudlo</surname> <given-names>P</given-names></string-name>, <string-name><surname>Robert</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Ryder</surname> <given-names>RJ</given-names></string-name>. <article-title>Approximate Bayesian computational methods</article-title>. <source>Statistics and Computing</source>. <year>2012</year>;<volume>22</volume>(<issue>6</issue>):<fpage>1167</fpage>&#x2013;<lpage>1180</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Wertheim</surname> <given-names>HF</given-names></string-name>, <string-name><surname>Walsh</surname> <given-names>E</given-names></string-name>, <string-name><surname>Choudhurry</surname> <given-names>R</given-names></string-name>, <string-name><surname>Melles</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Boelens</surname> <given-names>HA</given-names></string-name>, <string-name><surname>Miajlovic</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <article-title>Key role for clumping factor B in Staphylococcus aureus nasal colonization of humans</article-title>. <source>PLoS medicine</source>. <year>2008</year>;<volume>5</volume>(<issue>1</issue>):<fpage>e17</fpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="book"><string-name><surname>Bishop</surname> <given-names>CM</given-names></string-name>. <chapter-title>Pattern Recognition and Machine Learning (Information Science and Statistics)</chapter-title>. <publisher-name>Springer-Verlag</publisher-name> <publisher-loc>New York Inc</publisher-loc>.; <year>2006</year></mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="book"><string-name><surname>Robert</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Casella</surname> <given-names>G</given-names></string-name>. <chapter-title>Monte Carlo Statistical Methods</chapter-title>. <edition>2nd</edition> ed. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2004</year>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Delaney</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Keane</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <etal>et al.</etal> <article-title>Rapid phylogenetic analysis of large samples of recombinant bacterial whole genome sequences using Gubbins</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>43</volume>(<issue>3</issue>):<fpage>e15</fpage>&#x2013;<lpage>e15</lpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>DJ</given-names></string-name>. <article-title>ClonalFrameML: efficient inference of recombination in whole bacterial genomes</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>2</issue>):<fpage>e1004041</fpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Mostowy</surname> <given-names>R</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Andam</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>. <article-title>Efficient inference of recent and ancestral recombination within bacterial populations</article-title>. <source>Molecular biology and evolution</source>. <year>2017</year>;<volume>34</volume>(<issue>5</issue>):<fpage>1167</fpage>&#x2013;<lpage>1182</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>