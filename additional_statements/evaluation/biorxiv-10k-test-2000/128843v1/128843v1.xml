<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/128843</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Slingshot: Cell lineage and pseudotime inference for single-cell transcriptomics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Street</surname>
<given-names>Kelly</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Risso</surname>
<given-names>Davide</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Fletcher</surname>
<given-names>Russell B.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Das</surname>
<given-names>Diya</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ngai</surname>
<given-names>John</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Yosef</surname>
<given-names>Nir</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Purdom</surname>
<given-names>Elizabeth</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Dudoit</surname>
<given-names>Sandrine</given-names>
</name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Division of Biostatistics, School of Public Health</institution>, UC Berkeley.</aff>
<aff id="a2"><label>2</label><institution>Division of Biostatistics and Epidemiology, Department of Healthcare Policy and Research</institution>, Weill Cornell Medicine.</aff>
<aff id="a3"><label>3</label><institution>Department of Molecular and Cell Biology</institution>, UC Berkeley.</aff>
<aff id="a4"><label>4</label><institution>Department of Electrical Engineering and Computer Sciences</institution>, UC Berkeley.</aff>
<aff id="a5"><label>5</label><institution>Department of Statistics</institution>, UC Berkeley.</aff>
<aff id="a6"><label>6</label><institution>Helen Wills Neuroscience Institute</institution>, UC Berkeley.</aff>
<aff id="a7"><label>7</label><institution>QB3 Berkeley Functional Genomics Laboratory</institution>.</aff>
<aff id="a8"><label>8</label><institution>Center for Computational Biology</institution>, UC Berkeley.</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author, <email>sandrine@stat.berkeley.edu</email>.</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>128843</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>4</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="128843.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Single-cell transcriptomics allows researchers to investigate complex communities of heterogeneous cells. These methods can be applied to stem cells and their descendants in order to chart the progression from multipotent progenitors to fully differentiated cells. While a number of statistical and computational methods have been proposed for analyzing cell lineages, the problem of accurately characterizing multiple branching lineages remains difficult to solve. Here, we introduce a novel method, Slingshot, for inferring multiple developmental lineages from single-cell gene expression data. Slingshot is a uniquely robust and flexible tool for inferring developmental lineages and ordering cells to reflect continuous, branching processes.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>RNA-Seq</kwd>
<kwd>single cell</kwd>
<kwd>lineage inference</kwd>
<kwd>pseudotime inference</kwd>
</kwd-group>
<counts>
<page-count count="21"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Background</title>
<p>Traditional transcription assays, such as bulk microarrays and RNA sequencing (RNA-Seq), offer a bird&#x2019;s-eye view of transcription. However, as they rely on RNA from a large number of cells as starting material, they are not ideal for examining heterogeneous populations of cells. Newly-developed single-cell assays can give us a much more detailed picture (<xref ref-type="bibr" rid="c10">Kolodziejczyk et al., 2015</xref>). This higher resolution allows researchers to distinguish between closely-related populations of cells, potentially revealing functionally distinct groups with complex relationships (<xref ref-type="bibr" rid="c18">Wagner et al., 2016</xref>).</p>
<p>For many systems, there are not clear distinctions between cellular states, but instead there is a smooth transition where individual cells represent points along a continuum or &#x201C;lineage&#x201D;. Cells in these systems change states by undergoing gradual transcriptional changes, with progress being driven by an underlying temporal variable. For example, <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> examined the differentiation pattern of skeletal myoblasts, showing that their development into myocytes and mature myotubes follows a continuous lineage, rather than discrete steps. Inference of lineage structure has been referred to as &#x201C;pseudotemporal reconstruction&#x201D; and it can help us understand how cells change state and how cell fate decisions are made (<xref ref-type="bibr" rid="c3">Bendall et al., 2014</xref>; <xref ref-type="bibr" rid="c4">Campbell et al., 2015</xref>; <xref ref-type="bibr" rid="c17">Trapnell et al., 2014</xref>). Furthermore, many systems contain lineages that share a common initial state but branch and terminate at different states. These complicated lineage structures require additional analysis to distinguish between cells that fall along different lineages (<xref ref-type="bibr" rid="c8">Ji and Ji, 2016</xref>; <xref ref-type="bibr" rid="c15">Setty et al., 2016</xref>; <xref ref-type="bibr" rid="c16">Shin et al., 2015</xref>).</p>
<p>Several methods have been proposed for the task of pseudotemporal reconstruction, each with their own set of strengths and assumptions. We describe a few popular approaches here; for a more complete review see <xref ref-type="bibr" rid="c1">Bacher and Kendziorski (2016)</xref>. One of the most well-known methods is Monocle (<xref ref-type="bibr" rid="c17">Trapnell et al., 2014</xref>), which constructs a minimum spanning tree (MST) on cells in a reduced-dimensionality space created by independent component analysis (ICA) and orders cells via a PQ tree along the longest path through this tree. The direction of this path and the number of branching events are left to the user, who may examine a known set of marker genes or use time of sample collection as indications of initial and terminal cell states. The methods Waterfall (<xref ref-type="bibr" rid="c16">Shin et al., 2015</xref>) and TSCAN (<xref ref-type="bibr" rid="c8">Ji and Ji, 2016</xref>) instead determine the lineage structure by first clustering cells and then drawing an MST on the cluster centers. Lineages are represented in the low-dimensional space as piecewise linear paths through the tree, providing a simple, unsuper-vised method for identifying branching events. The output pseudotime values are calculated by orthogonal projection onto these paths, with the identification of the direction and of the cluster of origin again left to the user. The method of Wishbone (<xref ref-type="bibr" rid="c15">Setty et al., 2016</xref>), an extension of Wanderlust (<xref ref-type="bibr" rid="c3">Bendall et al., 2014</xref>), uses an ensemble of <italic>k</italic>-nearest neighbors (kNN) graphs on cells and a randomly selected group of waypoints to robustly determine cell-to-cell distances. Given a user-specified initial cell, these distances are used to determine the presence or absence of a bifurcation event, which limits the method to only two lineages. Finally, other approaches use smooth curves to represent lineages. For example, Embeddr (<xref ref-type="bibr" rid="c4">Campbell et al., 2015</xref>) uses the principal curves method of <xref ref-type="bibr" rid="c7">Hastie and Stuetzle (1989)</xref> to infer lineages in a low-dimensional space obtained by a Laplacian eigenmap. Again, the direction of the curve must be specified by the user and the method is limited to a single lineage. See <xref ref-type="table" rid="tbl1">Table 1</xref> for a summary of existing methods.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Summaries of existing lineage and pseudotime inference methods within a common framework.</p></caption>
<graphic xlink:href="128843_tbl1.tif"/>
</table-wrap>
<p>Here, we introduce Slingshot, a novel lineage inference tool designed for multiple, branching lineages. Slingshot combines highly stable techniques necessary for noisy single-cell data with the flexibility to identify multiple lineages with varying levels of supervision. Slingshot consists of two main stages: 1) the inference of the lineage structure and 2) the inference of pseudotime variables for cells along each lineage (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Like other methods (<xref ref-type="bibr" rid="c8">Ji and Ji, 2016</xref>; <xref ref-type="bibr" rid="c16">Shin et al., 2015</xref>), Slingshot&#x2019;s first stage uses a cluster-based MST to stably identify the key elements of the global lineage structure, i.e., the number of lineages and where they branch (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Step 1). This allows us to identify novel lineages while also accommodating the use of domain-specific knowledge to supervise parts of the tree. For the second stage, we propose a novel method, simultaneous principal curves, to fit smooth, branching curves to these lineages, thereby translating the knowledge of global lineage structure into stable estimates of the underlying cell-level pseudotime variable for each lineage (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Step 2). The Slingshot method is implemented in the open-source R package slingshot (available from the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/kstreet13/slingshot">https://github.com/kstreet13/slingshot</ext-link>) to be released through the Bioconductor Project (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link>).</p>
<fig id="fig1" position="float" fig-type="figure" orientation="portrait">
<label>Figure 1:</label>
<caption><title>Schematics of Slingshot&#x2019;s main steps</title>
<p>The main steps for Slingshot are shown for: <bold>Panel</bold> a simple simulated dataset in two dimensions and <bold>Panel (b)</bold> the dataset of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press), discussed in Section 2. Step 0: Slingshot starts from clustered data in a low-dimensional space (cluster labels indicated by color). For <bold>Panel (b)</bold>, the plot shows the top three principal components, but Slingshot was run on the top five. Step 1: A minimum spanning tree is constructed on the clusters to determine the number and rough shape of lineages. For <bold>Panel (b)</bold>, we impose some constraints on the MST based on known biology, see Section 2. Step 2: Simultaneous principal curves are used to obtain smooth representations of each lineage. Step 3: Pseudotime values are obtained by orthogonal projection onto the curves (only shown for <bold>Panel (a)</bold>).</p></caption>
<graphic xlink:href="128843_fig1.tif"/>
</fig>
<p>In addition to Slingshot&#x2019;s core methodological components described above for lineage and pseudotime inference, we note the importance of upstream analysis choices. Indeed, many pseu-dotemporal inference methods will either implicitly or explicitly require certain choices at previous steps in the workflow. Dimensionality reduction, for example, helps in reducing the amount of noise in the data and in visualizing the data, but a variety of approaches are available, with a potentially large impact on the final result (see Figure S1). Monocle uses independent component analysis, Waterfall and TSCAN use principal component analysis (PCA), Embedder uses Laplacian eigenmaps (<xref ref-type="bibr" rid="c2">Belkin and Niyogi, 2003</xref>), and Wishbone uses diffusion maps for analysis and t-distributed stochastic neighbor embedding (t-SNE) (Maaten and Hinton, 2008) for visualization (<xref ref-type="table" rid="tbl1">Table 1</xref>). Given the great diversity of data being generated by single-cell assays, it seems unlikely that there is a one-size-fits-all solution to the dimensionality reduction problem. Similar issues arise for normalization and clustering methods. These data analysis steps are very important and because different methods hard-code different choices, the methods can be difficult to compare. Slingshot does not specify these crucial upstream choices, but is instead designed with flexibility and modularity in mind, to easily integrate with the normalization, dimensionality reduction, and clustering methods deemed most appropriate for any particular dataset.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Results</title>
<p>Slingshot divides the problem of multiple lineage inference into two stages: <bold>1.</bold> Identification of <italic>lineages</italic>, i.e., ordered sets of cell clusters, where all lineages share a starting cluster and each leads to a unique terminal cluster. This is achieved by constructing an MST on clusters of cells. <bold>2.</bold> For each lineage, identification of <italic>pseudotime</italic>, i.e., a one-dimensional variable representing each cell&#x2019;s transcriptional progression toward the terminal state. This is achieved by a method which extends principal curves (<xref ref-type="bibr" rid="c7">Hastie and Stuetzle, 1989</xref>) to the case of multiple branching lineages. The primary benefits of Slingshot are robustness and the ability to detect complicated multiple-lineage structures.</p>
<sec id="s2a">
<label>2.1</label>
<title>Robustness</title>
<p>One of the main difficulties of single-cell RNA-Seq is the high level of noise. In addition to the host of biological and technical confounders that can affect any (bulk) RNA-Seq experiment, single-cell data may contain effects from transcriptional bursting (<xref ref-type="bibr" rid="c5">Chubb et al., 2006</xref>; <xref ref-type="bibr" rid="c14">Raj et al., 2006</xref>) and drop-out (<xref ref-type="bibr" rid="c9">Kharchenko et al., 2014</xref>). Furthermore, downstream analyses such as lineage inference may be affected by upstream computational choices such as normalization and clustering methods. For these reasons, we believe that robustness to noise, unwanted technical effects, and choice of pre-processing methods should be important characteristics of a lineage inference method.</p>
<sec id="s2a1">
<title>Robustness to Noise</title>
<p>We first examined the stability of a few well-known methods using a subset of the HSMM dataset of <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> chosen to represent a single lineage. In <xref ref-type="fig" rid="fig2">Figure 2</xref>, we illustrate each method&#x2019;s ordering of the full set of 212 cells and show how consistently it orders cells over 50 bootstrap subsamples. The Monocle procedure, which constructs an MST on individual cells and orders them according to PQ trees along the diameter path of the MST, was the least stable of the methods we compared. The diameter path drawn by Monocle was highly variable and sensitive to even small amounts of noise; this instability has been previously discussed in <xref ref-type="bibr" rid="c8">Ji and Ji (2016)</xref>. In contrast, other methods which emphasize stability in the construction of their primary trajectory and obtain pseudotime values based on orthogonal projection, produced much more stable orderings.</p>
<fig id="fig2" position="float" fig-type="figure" orientation="portrait">
<label>Figure 2:</label>
<caption><title>Pseudotime inference: Robustness to noise.</title>
<p>We examine the stability of three lineage inference methods, showing how each method orders the cells for the original dataset as well as for 50 subsamples of the data. <bold>Panel (a):</bold> Monocle identifies the longest path through the MST constructed on all cells (red). Waterfall and TSCAN cluster cells and connect cluster centers with an MST (purple, clustering performed by <italic>k</italic>-means with <italic>k</italic> = 5). A principal curve is a non-linear fit through the data, used by Embeddr and Slingshot (green). As in <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref>, dimensionality reduction is performed by ICA. <bold>Panel (b):</bold> We examine the stability of these three methods by plotting pseudotimes based on 50 subsamples of the data vs. the original pseudotimes. Subsamples were generated in a bootstrap-like manner, by randomly sampling <italic>n</italic> times with replacement from the original cell-level data and retaining only one instance of each cell. Thus, subsamples were of variable sizes, but contained on average about 63&#x0025; of the original data. The cluster-based MST method occasionally detected spurious branching events and, for the purposes of visualization, cells not placed along the main lineage were assigned a pseudotime value of 0.</p></caption>
<graphic xlink:href="128843_fig2.tif"/>
</fig>
<p>Although both the cluster-based MST method (<xref ref-type="bibr" rid="c8">Ji and Ji, 2016</xref>; <xref ref-type="bibr" rid="c16">Shin et al., 2015</xref>) and the principal curves method (<xref ref-type="bibr" rid="c4">Campbell et al., 2015</xref>; <xref ref-type="bibr" rid="c7">Hastie and Stuetzle, 1989</xref>) demonstrated robustness over the bootstrap subsamples shown in <xref ref-type="fig" rid="fig2">Figure 2b</xref>, the former has some important drawbacks. Due to the sharp corners of the piecewise linear paths, multiple cells will often be assigned identical pseudotime values, corresponding to the value at the vertex. Additionally, the tree does not always capture the correct global structure: due to variability in the exact distances between cluster centers, the MST may end up cutting corners in a lineage and curving back on itself or detecting spurious branching events (see Supplemental Figure S2). The principal curve approach was the most stable method, producing very similar orderings on all subsets of the data (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). On more complex datasets, however, Embeddr&#x2019;s (<xref ref-type="bibr" rid="c4">Campbell et al., 2015</xref>) principal curves method has the obvious limitation of only characterizing a single lineage. It is for this reason that we chose to extend principal curves to accommodate multiple, branching lineages.</p>
</sec>
<sec id="s2a2">
<title>Robustness to Cluster Assignments</title>
<p>Although Slingshot uses cluster assignments for the identification of lineages and branching events, its use of simultaneous principal curves to estimate the final pseudotimes makes its final results quite robust to the choice of clustering method. In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we demonstrate on a simulated dataset the stability of the pseudotime estimates for different sets of clusters, chosen by <italic>k</italic>-means clustering. Slingshot produces very similar curves over a wide range of values for the number of clusters <italic>k</italic>, even while the underlying MSTs change dramatically (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). In comparison, using an MST alone to identify lineages and estimate pseudotimes (as is done by Waterfall and TSCAN) gives estimates that are quite sensitive to the choice of clusters.</p>
<fig id="fig3" position="float" fig-type="figure" orientation="portrait">
<label>Figure 3:</label>
<caption><title>Pseudotime inference: Robustness to cluster assignments.</title>
<p><bold>Panel (a):</bold> Using a simulated two-dimensional dataset with two endpoints, <italic>k</italic>-means to assign cluster labels (<italic>k</italic> = 3<italic>, &#x2026;,</italic> 14), and Slingshot&#x2019;s covariance-scaled distance measure, we show that the cluster-based MST can be highly variable, even while identifying the correct global structure (purple, as in TSCAN and Waterfall). Despite using these same trees, Slingshot&#x2019;s simultaneous principal curves are robust to this variability and all of them produce nearly identical results (green). <bold>Panel (b):</bold> With the same dataset as above, we show two pathological scenarios in which the cluster-based MST fails to identify the correct global structure; the corresponding simultaneous principal curves are plotted in green. Setting <italic>k</italic> = 2, we are unable to detect a branching event and the resulting curve attempts to fit all of the data. With higher numbers of clusters, we eventually run into the problem of overfitting and the MST detects spurious branching events. Thus, for <italic>k</italic> = 15, the corresponding simultaneous principal curves similarly overfit certain regions of the data.</p></caption>
<graphic xlink:href="128843_fig3.tif"/>
</fig>
<p>Of course, Slingshot is not completely independent of the effect of poor clustering since the clusters define the lineages. This is seen in the extreme cases where <italic>k</italic> = 2 and <italic>k</italic> = 15 (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), for which the inferred lineages are dramatically wrong because of the choice of <italic>k</italic>. Nonetheless, Slingshot shows a reduced reliance on clustering results and increased stability, leading to more robust pseudotime estimates.</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Multiple Lineage Identification</title>
<p>Determining the number and location of branching events is one of the most difficult components of lineage inference. Already faced with potentially noisy, high-dimensional data, we now have to consider the problem of model selection in an extremely large model space. Some methods introduce restrictions on lineage discovery; for example, Monocle requires the user to pre-specify the number of lineages and Wishbone is limited to only one or two lineages. In contrast, Slingshot allows for multiple lineage detection without limiting or pre-specifying the number of lineages.</p>
<p>Moreover, Slingshot provides the user the ability to direct lineage detection in a biologically relevant manner, specifically by giving the option to identify known endpoints of lineages. Using the complex example of lineage detection in the olfactory epithelium data of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press), we demonstrate the importance of this type of supervision, as opposed to supervision which requires specific knowledge of the number of lineages.</p>
<p><xref ref-type="fig" rid="fig4">Figure 4</xref> displays the result of running Slingshot with and without supervision on the data of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press). For this dataset, clusters corresponding to the neuronal, sustentacular, and microvillous cell types were identified based on known marker genes (<xref ref-type="bibr" rid="c6">Fletcher et al., 2017</xref> in press). These cell types are known to be non-differentiating and should thus be the terminal states of their respective lineages. However, without supervision (<xref ref-type="fig" rid="fig4">Figure 4a</xref>), the sustentacular cluster was not identified as an endpoint, yielding results inconsistent with prior knowledge. Selecting the sustentacular cluster as an endpoint led to the recovery of the three lineages reported and validated in the original paper (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). We also note that this structure could not have been recovered using standard Euclidean distances between cluster centers (<xref ref-type="fig" rid="fig4">Figure 4c</xref>), as in Waterfall and TSCAN. By failing to utilize the shapes of the clusters, the standard Euclidean distance between cluster centers identified a spurious branching event very early on in HBC differentiation. By default, Slingshot uses a shape-sensitive distance measure inspired by the Mahalanobis distance (Mahalanobis, 1936), which scales the distance between cluster centers based on the shared covariance structure of the two clusters.</p>
<fig id="fig4" position="float" fig-type="figure" orientation="portrait">
<label>Figure 4:</label>
<caption><title>Semi-supervised lineage inference.</title>
<p>We show three methods of constructing an MST on the clusters of the mouse olfactory epithelium dataset from <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press). Although we only visualize the first 3 principal components, we note that these trees were constructed in the 5-dimensional space defined by the first 5 PCs. <bold>Panel (a):</bold> Without endpoint supervision, we draw the (known) false conclusion that sustentacular cells may develop into GBCs. <bold>Panel (c):</bold> Using Euclidean distances between cluster centers leads to the detection of a spurious branching event and the same erroneous conclusion about sustentacular cells. <bold>Panel (b):</bold> Both of these issues are resolved by using Slingshot&#x2019;s covariance-scaled distance measure and marking the mature sustentacular cell cluster as an endpoint. This final tree is consistent with known biology and branching events were validated in follow-up experiments.</p></caption>
<graphic xlink:href="128843_fig4.tif"/>
</fig>
<p>Other lineage detection methods were not able to correctly identify the three lineages in this dataset, diagrammed in <xref ref-type="fig" rid="fig5">Figure 5a</xref>. Monocle requires that the number of lineages be pre-specified, but in practice this number was unknown before running Slingshot and performing validation experiments. Even when we specified the proper number of lineages (three), Monocle&#x2019;s results contradicted prior knowledge (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). While one of Monocle&#x2019;s lineages captured most of the neurogenic trajectory, it also included the identified microvillous cells and a fair number of immature sustentacular cells. More importantly, the neuronal lineage skipped most of the GBC cluster, cells which are known to be intermediates between HBCs and mature olfactory sensory neurons. Instead, Monocle classified GBCs as an alternate terminal state branching from the neuronal lineage. Another popular method, Wishbone, has a maximum of two lineages, so we applied it to a subset of the data believed to represent the two main lineages, namely, the sustentacular and neuronal lineages (<xref ref-type="fig" rid="fig5">Figures 5d</xref> and S4a). Wishbone identified a bifurcation, but not one which separated neurons from sustentacular cells (<xref ref-type="fig" rid="fig5">Figures 5e</xref> and S4b). The large skip in the longer lineage is caused by a small group of neurons which were isolated in a corner of the three-dimensional space constructed by diffusion maps. When we used Wishbone again with PCA as the dimensionality reduction step, we observed that this gap was no longer present, but Wishbone still failed to identify the primary bifurcation in the data (<xref ref-type="fig" rid="fig5">Figures 5f</xref> and S4b).</p>
<fig id="fig5" position="float" fig-type="figure" orientation="portrait">
<label>Figure 5:</label>
<caption><title>Multiple lineage inference.</title>
<p>Results from multiple lineage inference methods on the olfactory epithelium dataset of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press), along with known biological relationships. <bold>Panels (a&#x2013;c):</bold> Comparison of Slingshot and Monocle on the full dataset. For Slingshot, we specified the HBC cluster as the origin and the mature sustentacular (mSus) cluster as an endpoint. For Monocle, the main path was oriented such that pseudotimes started in the HBC cluster and the correct number of lineages (three) was provided. <bold>Panels (d&#x2013;g):</bold> Comparison of Slingshot and Wishbone on a subset of the data, excluding cells specific to the microvillous (MV) lineage (we do this because Wishbone can only discern a maximum of two lineages).</p></caption>
<graphic xlink:href="128843_fig5.tif"/>
</fig>
<p>For both the full and subsetted data, Slingshot identified lineages which are consistent with prior biological knowledge (<xref ref-type="fig" rid="fig5">Figures 5c</xref> and 5g). In the two-lineage case, this required no additional supervision beyond identifying the initial HBC cluster. For the full data, we specified all three terminal state clusters as endpoints, but we note that only one of these (the sustentacular cluster) had any effect on the inferred structure. Originally, it was not established that the microvillous endpoint was a branch off of the neuronal lineage, but this relationship was discovered and validated by <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press). This novel biological discovery would not have been possible with lineage inference methods that restrict or require specification of the number of lineages.</p>
<p>In Supplemental Figures S3a and S3c, we show that in addition to capturing complicated, multilineage structures, Slingshot is also able to correctly detect a single lineage and two bifurcating lineages, respectively, in the datasets of <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> and <xref ref-type="bibr" rid="c16">Shin et al. (2015)</xref>. In both cases, Slingshot&#x2019;s final pseudotime variables are highly similar to those found in the original papers, but do not rely on user specification of the number of lineages or subsetting of the data.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Discussion</title>
<p>We have introduced a new method, Slingshot, for lineage and pseudotime inference in datasets where the number of lineages is unknown. Because Slingshot breaks the lineage inference problem into two steps, we are able to make use of appropriate methods for each task and avoid the common trade-off between robustness and the flexibility to detect complex structures. Using a cluster-based MST for lineage identification allows Slingshot to identify potentially complex global patterns in the data without being overly sensitive to individual data points. Our novel simultaneous principal curves method for pseudotime inference extends the stability and robustness properties of principal curves to the case of multiple branching lineages.</p>
<p>Unlike other methods for multiple lineage identification, Slingshot does not require <italic>a priori</italic> knowledge of the number of lineages, but instead uses a cluster-based MST method that has the flexibility to detect novel lineages. At the same time, Slingshot also allows the user to constrain the global tree structure to ensure that previously established terminal states are correctly identified. This is a more natural way to incorporate prior information than placing burdensome restrictions on the number of lineages and leads to more biologically meaningful results than other methods. Lineage characteristics such as initial and terminal states can be difficult to identify at the level of individual cells (as in Wishbone), due to drop-out effects and the high levels of noise in single-cell data. However, more unsupervised methods like Monocle and Embeddr, which only require a direction to be given to an inferred lineage, can end up missing the initial state altogether. We find that supervision at the cluster level provides a nice balance: due to averaging, clusters are less ambiguous than individual cells, making them easier to identify based on known marker genes, and specifying initial and terminal states provides an intuitive, but not overly restrictive way to ensure that inferred lineages do not contradict previously established results.</p>
<p>We demonstrated, using the data of <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> and <xref ref-type="bibr" rid="c16">Shin et al. (2015)</xref>, that Sling-shot can correctly detect a single lineage and two bifurcating lineages, respectively (Supplemental Figures S3a and S3c). In both cases it produces results similar to those found and validated in the original paper (Supplemental Figures S3b and S3d). Additionally, using the olfactory epithelium data of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press), we demonstrated that with minimal supervision, Slingshot can correctly identify a complicated three-lineage structure that other methods cannot.</p>
<p>Since there are many aspects to the problem of lineage inference, from sample collection to final analysis, it is important to define precisely the tasks for which Slingshot is designed. The philosophy of Slingshot is that some common steps in single-cell analysis, such as dimensionality reduction or clustering, do not have a single solution that works well for all data types. For example, Slingshot does not require a specific dimensionality reduction method because single-cell data can come from a variety of assays and in a wide range of dimensions, from the 271 cells &#x00D7; 47, 192 genes RNA-Seq dataset of <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> to the 25, 000 cells &#x00D7; 13 markers mass cytometry dataset of <xref ref-type="bibr" rid="c15">Setty et al. (2016)</xref>. This extreme heterogeneity precludes any one-size-fits-all solution and similar arguments can be made for other upstream analysis steps. Slingshot makes use of both a dimensionality reduction and clustering step, but unlike other methods it does not attempt to solve either problem, viewing these instead as separate analysis choices, analogous to the choice of normalization method or short read aligner.</p>
<p>Ultimately, single-cell data are noisy, high-dimensional, and may contain a multitude of competing, interwoven signals. In the presence of such data, Slingshot provides a robust and modular method for lineage inference that allows for novel lineage discovery, meaningful incorporation of biological constraints, and fits easily within existing analysis pipelines.</p>
</sec>
<sec id="s4">
<label>4</label>
<title>Online Methods</title>
<p>We start from an <italic>n &#x00D7; J</italic> matrix of normalized expression measures (e.g., read counts) for <italic>n</italic> single cells and <italic>J</italic> genes or features. Slingshot assumes that the <italic>n</italic> cells have been partitioned into <italic>K</italic> clusters, potentially corresponding to distinct cellular states. Although Slingshot can in principle be applied directly to the normalized expression values, we strongly recommend a dimensionality reduction step before pseudotemporal reconstruction, as Slingshot&#x2019;s curve-fitting step uses Euclidean distances which can misbehave in high-dimensional spaces (cf. curse of dimensionality). Dimensionality reduction can also strengthen signal in the data and help with visualization. We denote the dimension of the reduced space by <italic>J</italic> <sup><italic>&#x2032;</italic></sup>.</p>
<p>Before detailing Slingshot&#x2019;s two main steps, we introduce some notation. First, denote by <italic>X</italic> = (<italic>X</italic><sub><italic>ij</italic></sub>) the <italic>n &#x00D7; J &#x2032;</italic> reduced-dimensional matrix of gene expression measures, for cells <italic>i &#x03F5;</italic> {1, &#x2026;, <italic>n</italic>} and dimensions <italic>j &#x03F5;</italic> {1, &#x2026;, <italic>J&#x2032;</italic>}. Let {<italic>C</italic><sub>1</sub>, &#x2026;, <italic>C</italic><sub><italic>K</italic></sub>} denote the <italic>K</italic> cell clusters or states, i.e., disjoint subsets of cells, obtained by clustering the cells based on their gene expression measures. We then define a lineage as an ordered set of clusters and let <italic>L</italic> denote the total number of lineages. For a particular lineage, <italic>L</italic><sub><italic>l</italic></sub>, denote its length (i.e., the number of clusters in the lineage) by <italic>K</italic><sub><italic>l</italic></sub> and the <italic>k</italic><sup>th</sup> cluster by <inline-formula><alternatives><inline-graphic xlink:href="128843_inline1.gif"/></alternatives></inline-formula>, for <italic>l &#x03F5; {</italic>1, &#x2026;, <italic>L</italic>} and <italic>k &#x03F5; {</italic>1, &#x2026;, <italic>K</italic><sub><italic>l</italic></sub>}. In particular, <inline-formula><alternatives><inline-graphic xlink:href="128843_inline2.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="128843_inline3.gif"/></alternatives></inline-formula> correspond to the initial and terminal states for the <italic>l</italic><sup>th</sup> lineage, respectively. It is important to note that a cluster can belong to multiple lineages and that the ordering of the clusters within a lineage does not strictly determine the final relative orderings of cells in those clusters.</p>
<p>As a given cluster can belong to multiple lineages, so can a cell. For ease of notation, we therefore allow cells to have distinct pseudotime values for each lineage they are a part of. The pseudotime value for cell <italic>i</italic> in lineage <italic>l</italic> is denoted by <inline-formula><alternatives><inline-graphic xlink:href="128843_inline4.gif"/></alternatives></inline-formula>; if cell <italic>i</italic> does not belong to lineage <italic>l</italic>, i.e., <inline-formula><alternatives><inline-graphic xlink:href="128843_inline5.gif"/></alternatives></inline-formula>, then set <inline-formula><alternatives><inline-graphic xlink:href="128843_inline6.gif"/></alternatives></inline-formula>. The vector of pseudotime values for lineage <italic>l</italic> is denoted by <inline-formula><alternatives><inline-graphic xlink:href="128843_inline7.gif"/></alternatives></inline-formula>.</p>
<sec id="s4a">
<label>4.1</label>
<title>Identification of Cluster-Based Lineages</title>
<p>In its first step, Slingshot identifies lineages by treating clusters of cells as nodes in a graph and drawing an MST between the nodes, similar to the work of <xref ref-type="bibr" rid="c8">Ji and Ji (2016)</xref> and <xref ref-type="bibr" rid="c16">Shin et al. (2015)</xref>. Lineages are then defined as ordered sets of clusters created by tracing paths through the MST, starting from a given root node. Our method differs however in a number of important respects from those of <xref ref-type="bibr" rid="c8">Ji and Ji (2016)</xref> and <xref ref-type="bibr" rid="c16">Shin et al. (2015)</xref>, including the distance measure used for drawing the tree and the incorporation of biologically meaningful supervision.</p>
<sec id="s4a1">
<label>4.1.1</label>
<title>Shape-Sensitive Distance Measure between Cell Clusters</title>
<p>Constructing an MST involves specifying a distance measure between nodes (in this case, clusters). Although in principle any type of distance measure could be used (e.g., Euclidean, Manhattan), we found that a Mahalanobis distance, i.e., a covariance-scaled Euclidean distance, that accounts for cluster shape, works well in practice. Specifically, the pairwise distance between clusters <italic>i</italic> and <italic>j</italic>, <italic>d</italic>(<italic>C</italic><sub><italic>i</italic></sub><italic>, C</italic><sub><italic>j</italic></sub>), is defined as
<disp-formula id="ueqn1">
<alternatives>
<graphic xlink:href="128843_ueqn1.gif"/>
</alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="128843_inline8.gif"/></alternatives></inline-formula> represents the center (mean) of cluster <italic>i</italic> and <italic>S</italic><sub><italic>i</italic></sub> its empirical covariance matrix in the reduced-dimensional space. This is essentially a multivariate <italic>t</italic>-statistic. By default, Slingshot uses the full covariance matrix of both clusters, allowing us to draw trees that are better covered by and representative of the cells in a dataset. However, in the presence of small clusters, the matrix <italic>S</italic><sub><italic>i</italic></sub> &#x002B; <italic>S</italic><sub><italic>j</italic></sub> may not be invertible and we replace the full covariance matrix with the corresponding diagonal covariance matrix.</p>
</sec>
<sec id="s4a2">
<label>4.1.2</label>
<title>Biologically Meaningful Supervision</title>
<p>Slingshot allows two forms of supervision during lineage identification: initial state and terminal states specification. Like other methods relying on cluster-based MSTs (TSCAN, Waterfall), Sling-shot requires the user to identify the initial cluster or root node. Subsequently, every direct path from this node to a leaf node (i.e., a cluster with only one edge) will be called a lineage. Indeed, all existing lineage construction methods explicitly or implicitly make the assumption that a starting state can be identified by the user: Monocle and Embeddr construct orderings for which the user must select the correct direction and Wishbone requires the user to select an initial cell or group of cells. In the simple case where the MST constructed by Slingshot has only two leaf nodes and one is specified as the root, this results in a single lineage. If an interior (non-leaf) node is specified as the origin, this results in two lineages, one terminating in each leaf node. Clusters with more than two edges will create bifurcations and produce additional lineages.</p>
<p>Additionally, Slingshot allows the user to provide further supervision in the construction of the lineages by selecting clusters known to represent terminal cell states, imposing a constraint on the MST algorithm. The constrained MST is obtained by first constructing the MST on all <italic>non-selected</italic> clusters and then connecting each <italic>selected</italic> cluster to its nearest non-selected neighbor. Such supervision results in more biologically meaningful lineages for situations where the data can be explained by many possible lineage structures. Identified lineages are by construction consistent with known biology and provide improved stability over less supervised methods. Although terminal state supervision is not required, we find that in many settings researchers do have knowledge of the cell types present in their data and that systematically incorporating this knowledge can provide more stable inference. Ultimately, detecting multiple lineages based on gene expression is a difficult problem that benefits from such guidance, as we demonstrate in the results (Section 2).</p>
</sec>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Identification of Individual Cell Pseudotimes</title>
<p>The second stage of Slingshot is concerned with assigning pseudotimes to individual cells. For this purpose, we make use of principal curves (<xref ref-type="bibr" rid="c7">Hastie and Stuetzle, 1989</xref>) to draw a path through the gene expression space of each lineage. As we show in the results (Section 2), principal curves give very robust pseudotimes when there is a single lineage.</p>
<p>Multiple lineages demand more care and are handled using the simultaneous principal curves method proposed below. Just as clusters in the MST may belong to one or more lineages, the cells which constitute these clusters may be assigned to one or more lineages. In principle, we could construct traditional principal curves for each lineage separately to arrive at pseudotimes. However, there is no guarantee that these curves would agree with each other in the neighborhood of clusters shared between lineages, so cells belonging to multiple lineages could be assigned very different pseudotime orderings by each curve. Since we assume a smooth differentiation process, this is potentially a violation and may be problematic in downstream analysis.</p>
<p>We therefore introduce a method of simultaneously fitting the principal curves of each lineage, which shrinks the curves to a consensus path in areas where lineages share many common cells, but allows the curves to separate as they share fewer and fewer cells. This ensures smooth bifurcations of the paths. We call the resulting curves <italic>simultaneous principal curves</italic>, as they are fit by an iterative procedure based on the principal curves algorithm of <xref ref-type="bibr" rid="c7">Hastie and Stuetzle (1989)</xref>. When there is only a single lineage (<italic>L</italic> = 1), the pseudotimes of Slingshot are found by the standard principal curves algorithm, except that the initial curve for the algorithm is based on the lineage&#x2019;s path through the MST found in the earlier stage (see below for details), rather than the first principal component.</p>
<p>We review the standard principal curves algorithm (for a single curve) in order to be clear about how we adapt it for simultaneous principal curves. After specification of an initial curve, the algorithm iteratively follows these steps:</p>
<list list-type="order">
<list-item><p>Project all data points onto the curve and calculate the arclength from the beginning of the curve to each point&#x2019;s projection. Setting the lowest value to zero, this produces pseudotimes.</p></list-item>
<list-item><p>For each of the <italic>J&#x2032;</italic> dimensions, use the cells&#x2019; pseudotimes to predict their coordinates along dimension <italic>j</italic>, <italic>j &#x03F5;</italic> {1, &#x2026;, <italic>J&#x2032;</italic>}, typically with a smoothing spline. This produces a set of functions which collectively map pseudotime values in &#x211D;<sub>&#x2265;0</sub> into &#x211D;<italic>J&#x2032;</italic>, thereby defining a smooth curve in <italic>J&#x2032;</italic> dimensions.</p></list-item>
<list-item><p>Repeat this process until convergence. We use the sum of squared distances between cells and their projections on the curves to determine convergence.</p></list-item>
</list>
<p>In the case of branching lineages, this iterative process is modified with an additional shrinkage step to ensures smooth bifurcations. Specifically, for each lineage <italic>l</italic>, we infer a vector of pseudotime values, <inline-formula><alternatives><inline-graphic xlink:href="128843_inline9.gif"/></alternatives></inline-formula>, and a function <italic>c</italic><sub><italic>l</italic></sub>: &#x211D;<sub>&#x2265;0</sub> &#x27F6; &#x211D;<sup><italic>J&#x2032;</italic></sup> for the associated curve in the low-dimensional space. Then, the shrinkage step is done by first constructing an average curve which, as with the individual lineage curves, is a function of pseudotime. It simply consists of the average of the points along the <italic>L</italic> curves at each pseudotime value:
<disp-formula id="ueqn2">
<alternatives>
<graphic xlink:href="128843_ueqn2.gif"/>
</alternatives>
</disp-formula>
where <italic>t</italic> represents pseudotime. Because the <italic>L</italic> lineages share the same root cluster, we are assured that their starting points (where <italic>t</italic> = 0) will be identical and will also be the starting point of the average curve.</p>
<p>We next construct a set of lineage-specific weighting functions to determine how much we should shrink each curve toward the average. For lineage <italic>l</italic>, we define the weighting function <italic>w</italic><sub><italic>l</italic></sub>: &#x211D;<sub>&#x2265;0</sub> <italic>&#x27F6;</italic> [0, 1], with the constraint that <italic>w</italic><sub><italic>l</italic></sub> must be non-increasing. Additionally, by specifying that <italic>w</italic><sub><italic>l</italic></sub>(0) = 1<italic>, &#x2200;l</italic>, we ensure that diverging curves always share the same initial point. These weighting functions allow us to shrink the diverging lineage curves toward their shared average curve with the additional update step:
<disp-formula id="ueqn3">
<alternatives>
<graphic xlink:href="128843_ueqn3.gif"/>
</alternatives>
</disp-formula></p>
<p>If all the <italic>w</italic> functions are smooth, this shrinkage step ensures that the final curves will follow a tree structure with smooth branching events.</p>
<p>Slingshot&#x2019;s default weighting function satisfies these conditions and is based on the distribution of pseudotimes over cells shared between lineages. Given a set of lineages <italic>l</italic><sub>1</sub>, &#x2026;, <italic>l</italic><sub><italic>m</italic></sub> (typically with <italic>m</italic> = 2), which all contain certain shared cells <inline-formula><alternatives><inline-graphic xlink:href="128843_inline10.gif"/></alternatives></inline-formula>, we define the weighting function for lineage <italic>l</italic><sub>1</sub> as follows. Set <inline-formula><alternatives><inline-graphic xlink:href="128843_inline11.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="128843_inline12.gif"/></alternatives></inline-formula> respectively as the lowest and highest non-outliers in this distribution, where outliers are defined by the 1.5IQR rule of boxplots. The weighting function is then defined as:
<disp-formula id="ueqn4">
<alternatives>
<graphic xlink:href="128843_ueqn4.gif"/>
</alternatives>
</disp-formula>
where <italic>K</italic> is the cumulative distribution function of a standard cosine kernel with a bandwidth of <inline-formula><alternatives><inline-graphic xlink:href="128843_inline13.gif"/></alternatives></inline-formula> (which places weight only on values between <inline-formula><alternatives><inline-graphic xlink:href="128843_inline14.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="128843_inline15.gif"/></alternatives></inline-formula>). We note that <inline-formula><alternatives><inline-graphic xlink:href="128843_inline16.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="128843_inline17.gif"/></alternatives></inline-formula>. Weighting functions for the other lineages are then calculated similarly. The final curves are fairly robust to the choice of kernel function (we also tried standard kernels provided by the density function in R, results not shown).</p>
<p>In both the single and branching lineage cases, final pseudotime values are derived from each point&#x2019;s orthogonal projection onto the curves. Thus, cells belonging to multiple lineages will have multiple pseudotime values, but these values will agree quite well for cells positioned before the lineage bifurcation, where the curves are most similar.</p>
<sec id="s4b1">
<title>Initialization of Simultaneous Principal Curves Algorithm</title>
<p>As mentioned above, we initialize the algorithm using the MST from the first stage. Specifically, we start with the piecewise linear path through the centers of the clusters contained in the lineage (in contrast, standard principal curves are initialized by the first principal component of all points being fit). Starting with the path through the cluster centers allows us to leverage the prior knowledge that went into lineage identification as well as to improve the speed and stability of the algorithm, though in practice, the two procedures typically converge to very similar curves.</p>
</sec>
</sec>
<sec id="s4c">
<label>4.3</label>
<title>Datasets</title>
<p>We demonstrate the performance of Slingshot by applying it to three previously-published single-cell RNA-Seq datasets, each with a different number of terminal cell types. The first is a subset of the data used in <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref>, which assayed 271 human skeletal muscle myoblasts (HSMMs) in order to study their development into mature myotubes. This is an example of data with only a single lineage. In their analysis, <xref ref-type="bibr" rid="c17">Trapnell et al. (2014)</xref> identify a population of contaminating interstitial mesenchymal cells, which we omit from this dataset. This results in a sample of 212 cells believed to form a single, continuous developmental lineage. For our analysis, we used the cluster labels generated by Monocle as well as a set of labels obtained via <italic>k</italic>-means clustering and, as in the original paper, we represented the data in two dimensions obtained by ICA. The normalized data were downloaded from the NCBI GEO database (accession GSE52529).</p>
<p>The second dataset comes from <xref ref-type="bibr" rid="c16">Shin et al. (2015)</xref>, who assayed 132 hippocampal quiescent neural stem cells (qNSCs) and their immediate progeny from adult mice, cells known to be involved in neurogenesis. Their goal was to assess cellular heterogeneity among this population and analyze continuous-time developmental dynamics. After removing a few outliers, their analysis focuses on 101 cells believed to represent the development of qNSCs into intermediate progenitor cells (IPCs), a transitional state between qNSCs and mature neurons. However, they note an additional cluster of 23 cells branching off of this lineage, potentially representing an alternative terminal cell type. As in the original paper, we used the hierarchical clustering labels and the first two principal components as the reduced dimensional space. Rather than focus solely on the IPC lineage though, we characterized the developmental trajectory of both proposed cell fates. The normalized data and code for preliminary analysis were downloaded from GEO (accession GSE71485).</p>
<p>The third dataset is that of <xref ref-type="bibr" rid="c6">Fletcher et al. (2017</xref> in press), featuring 616 cells from the adult mouse olfactory epithelium (OE), tracing the development of quiescent stem cells into three unique terminal cell fates. The primary lineage maps the development of horizontal basal cells (HBCs) into mature olfactory sensory neurons (OSNs) via a series of intermediate states. The secondary lineage gives rise to the support (sustentacular) cells of this system and features fewer identifiable intermediates. A third lineage which appears to split from the neuronal path leads to a cluster of microvillous cells. Again, we relied on the cluster labels of the authors, who used RSEC (<xref ref-type="bibr" rid="c13">Purdom and Risso, 2016</xref>), and represent cells by their coordinates along the first five principal components. The normalized data and cluster labels are available from GEO (accession GSE95601).</p>
</sec>
</sec>
<sec id="s5">
<label>5</label>
<title>Declarations</title>
<sec id="s5a">
<label>5.1</label>
<title>Ethics Approval and Consent to Participate</title>
<p>Ethical approval and consent were not applicable to this study.</p>
</sec>
<sec id="s5b" sec-type="availability">
<label>5.2</label>
<title>Availability of Data and Material</title>
<p>Slingshot is implemented in the R programming language and publicly available through an open-source package on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/kstreet13/slingshot">https://github.com/kstreet13/slingshot</ext-link>).</p>
</sec>
<sec id="s5c">
<label>5.3</label>
<title>Competing Interests</title>
<p>The authors declare that they have no competing interests.</p>
</sec>
<sec id="s5d">
<label>5.4</label>
<title>Funding</title>
<p>K.S., D.R., J.N., N.Y., E.P., and S.D. were supported by a National Institute of Mental Health BRAIN Initiative grant (U01MH105979). Additionally, research in J.N.&#x2019;s lab was funded by the National Institute on Deafness and Other Communication Disorders (RO1DC007235), the National Center for Research Resources (S10RR029668), and the Siebel Foundation. R.B.F. was supported by the National Institute on Aging (K01AG045344), K.S. and D.D. by training grants from the National Human Genome Research Institute (T32HG000047, PI: Dan Rokhsar), and R.B.F. and D.D. by a training grant from the California Institute of Regenerative Medicine.</p>
</sec>
<sec id="s5e">
<label>5.5</label>
<title>Authors&#x2019; Contributions</title>
<p>K.S., D.R., E.P., and S.D. formulated the methodology. J.N. participated in experimental strategy and design. N.Y. conceived the endpoint supervision strategy. K.S. and D.R. wrote the R package. K.S., R.B.F., and D.D. performed the data analysis. K.S., D.R., E.P., and S.D. wrote the manuscript.</p>
</sec>
</sec>
</body>
<back>
<ack>
<label>5.6</label>
<title>Acknowledgements</title>
<p>We thank Mary Combs for suggesting the name Slingshot.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><given-names>R.</given-names> <surname>Bacher</surname></string-name> and <string-name><given-names>C.</given-names> <surname>Kendziorski</surname></string-name>. <article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biology</source>, <volume>17</volume>(<issue>63</issue>), <year>2016</year>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="website"><string-name><given-names>M.</given-names> <surname>Belkin</surname></string-name> and <string-name><given-names>P.</given-names> <surname>Niyogi</surname></string-name>. <article-title>Laplacian Eigenmaps for Dimensionality Reductionand Data Representation</article-title>. <source>Neural Computation</source>, <volume>15</volume>(<issue>6</issue>):<fpage>1373</fpage>&#x2013;<lpage>1396</lpage>, <year>2003</year>. <issn>ISSN 0899-7667</issn>. doi: <pub-id pub-id-type="doi">10.1162/089976603321780317</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.mitpressjournals.org/doi/abs/10.1162/089976603321780317">http://www.mitpressjournals.org/doi/abs/10.1162/089976603321780317</ext-link>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name><given-names>K. L.</given-names> <surname>Davis</surname></string-name>, <string-name><given-names>E. D.</given-names> <surname>Amir</surname></string-name>, <string-name><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name><given-names>T. J.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>D. K.</given-names> <surname>Shenfeld</surname></string-name>, <string-name><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Pe&#x2019;er</surname></string-name>. <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>, <volume>157</volume>(<issue>3</issue>):<fpage>714</fpage>&#x2013;<lpage>725</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="website"><string-name><given-names>K.</given-names> <surname>Campbell</surname></string-name>, <string-name><given-names>C. P.</given-names> <surname>Ponting</surname></string-name>, and <string-name><given-names>C.</given-names> <surname>Webber</surname></string-name>. <article-title>Laplacian eigenmaps and principal curves for high resolution pseudotemporal ordering of single-cell RNA-seq profiles</article-title>. <source>Technical report, MRC Functional Genomics Unit</source>, <publisher-name>University of Oxford</publisher-name>, <publisher-loc>UK</publisher-loc>, <year>2015</year>. URL <ext-link ext-link-type="uri" xlink:href="biorxiv.org/content/early/">biorxiv.org/content/early/</ext-link> 2015/09/18/027219.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="website"><string-name><given-names>J. R.</given-names> <surname>Chubb</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Trcek</surname></string-name>, <string-name><given-names>S. M.</given-names> <surname>Shenoy</surname></string-name>, and <string-name><given-names>R. H.</given-names> <surname>Singer</surname></string-name>. <article-title>Transcriptional Pulsing of a Developmental Gene</article-title>. <source>Current Biology</source>, <volume>16</volume>(<issue>10</issue>):<fpage>1018</fpage>&#x2013;<lpage>1025</lpage>, <month>May</month> <year>2006</year>. <issn>ISSN 0960-9822</issn>. doi: <pub-id pub-id-type="doi">10.1016/j.cub.2006. 03.092</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0960982206014266">http://www.sciencedirect.com/science/article/pii/S0960982206014266</ext-link>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="book"><string-name><given-names>R. B.</given-names> <surname>Fletcher</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Das</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Gadye</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Street</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Baudhuin</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Risso</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Wagner</surname></string-name>, <string-name><given-names>M. B.</given-names> <surname>Cole</surname></string-name>, <string-name><given-names>Q.</given-names> <surname>Flores</surname></string-name>, <string-name><given-names>Y. G.</given-names> <surname>Choi</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Yosef</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Purdom</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Dudoit</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Ngai</surname></string-name>. <chapter-title>Deconstructing multiple lineage trajectories at single cell resolution in the olfactory stem cell niche</chapter-title>. <source>Cell Stem Cell</source>, <year>2017</year> <publisher-name>in press</publisher-name>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><given-names>T.</given-names> <surname>Hastie</surname></string-name> and <string-name><given-names>W.</given-names> <surname>Stuetzle</surname></string-name>. <source>Principal curves</source>. <volume>84</volume>(<issue>406</issue>):<fpage>502</fpage>&#x2013;<lpage>516</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="other"><string-name><given-names>Z.</given-names> <surname>Ji</surname></string-name> and <string-name><given-names>H.</given-names> <surname>Ji</surname></string-name>. <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>. <source>Nucleic Acids Research</source>, <year>2016</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="website"><string-name><given-names>P. V.</given-names> <surname>Kharchenko</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Silberstein</surname></string-name>, and <string-name><given-names>D. T.</given-names> <surname>Scadden</surname></string-name>. <article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nature Methods</source>, <volume>11</volume>(<issue>7</issue>):<fpage>740</fpage>&#x2013;<lpage>742</lpage>, <month>July</month> <year>2014</year>. <issn>ISSN 1548-7091</issn>. doi: <pub-id pub-id-type="doi">10.1038/ nmeth.2967</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/nmeth/journal/v11/n7/full/nmeth.2967.html">http://www.nature.com/nmeth/journal/v11/n7/full/nmeth.2967.html</ext-link>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>A. A.</given-names> <surname>Kolodziejczyk</surname></string-name>, <string-name><given-names>J. K.</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Svensson</surname></string-name>, <string-name><given-names>J. C.</given-names> <surname>Marioni</surname></string-name>, and <string-name><given-names>S. A.</given-names> <surname>Teichmann</surname></string-name>. <article-title>The technology and biology of single-cell RNA sequencing</article-title>. <source>Molecular Cell</source>, <volume>58</volume>(<issue>4</issue>):<fpage>610</fpage>&#x2013;<lpage>620</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>L.</given-names> <surname>Van Der Maaten</surname></string-name> and <string-name><given-names>G.</given-names> <surname>Hinton</surname></string-name>. <article-title>Visualizing Data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>, <volume>9</volume>:<fpage>2579</fpage>&#x2013;<lpage>2605</lpage>, <year>2008</year>. <issn>ISSN 1532-4435</issn>. doi: <pub-id pub-id-type="doi">10.1007/s10479-011-0841-3</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><collab>Prasanta Chandra Mahalanobis</collab>. <article-title>On the generalized distance in statistics</article-title>. <source>Proceedings of the National Institute of Sciences (Calcutta)</source>, <volume>2</volume>:<fpage>49</fpage>&#x2013;<lpage>55</lpage>, <year>1936</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="other"><string-name><given-names>E.</given-names> <surname>Purdom</surname></string-name> and <string-name><given-names>D.</given-names> <surname>Risso</surname></string-name>. <source>clusterExperiment: Compare clusterings for single-cell sequencing</source>, <year>2016</year>. <article-title>R package version 1.0.0</article-title>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Raj</surname></string-name>, <string-name><given-names>C. S.</given-names> <surname>Peskin</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Tranchina</surname></string-name>, <string-name><given-names>D. Y.</given-names> <surname>Vargas</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Tyagi</surname></string-name>. <article-title>Stochastic mRNA Synthesis in Mammalian Cells</article-title>. <source>PLOS Biology</source>, <volume>4</volume>(<issue>10</issue>):<fpage>e309</fpage>, <month>September</month> <year>2006</year>. <issn>ISSN 1545-7885</issn>. doi: <pub-id pub-id-type="doi">10.1371/ journal.pbio.0040309</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.0040309">http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.0040309</ext-link>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="website"><string-name><given-names>M.</given-names> <surname>Setty</surname></string-name>, <string-name><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Reich-Zeliger</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Angel</surname></string-name>, <string-name><given-names>T. M.</given-names> <surname>Salame</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Kathail</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Choi</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Bendall</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Friedman</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Pe&#x2019;er</surname></string-name>. <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nature biotechnology</source>, <volume>34</volume>(<issue>6</issue>):<fpage>637</fpage>&#x2013;<lpage>645</lpage>, <month>June</month> <year>2016</year>. <issn>ISSN 1087-0156</issn>. doi: <pub-id pub-id-type="doi">10.1038/ nbt.3569</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4900897/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4900897/</ext-link>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Shin</surname></string-name>, <string-name><given-names>D. A.</given-names> <surname>Berg</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Zhu</surname></string-name>, <string-name><given-names>J. Y.</given-names> <surname>Shin</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Song</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Bonaguidi</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Enikolopov</surname></string-name>, <string-name><given-names>D. W.</given-names> <surname>Nauen</surname></string-name>, <string-name><given-names>K.M.</given-names> <surname>Christian</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Ming</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Song</surname></string-name>. <article-title>Single-cell RNA-Seq with Waterfall reveals molecular cascades underlying adult neurogenesis</article-title>. <source>Cell Stem Cell</source>, <volume>17</volume>(<issue>3</issue>):<fpage>360</fpage>&#x2013;<lpage>372</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Trapnell</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Cacchiarelli</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Grimsby</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Pokharel</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Li</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Morse</surname></string-name>, <string-name><given-names>N. J.</given-names> <surname>Lennon</surname></string-name>, <string-name><given-names>K. J.</given-names> <surname>Livak</surname></string-name>, <string-name><given-names>T. S.</given-names> <surname>Mikkelsen</surname></string-name>, and <string-name><given-names>J. L.</given-names> <surname>Rinn</surname></string-name>. <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nature Biotechnology</source>, <volume>4</volume>(<issue>32</issue>):<fpage>381</fpage>&#x2013;<lpage>391</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Wagner</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Regev</surname></string-name>, and <string-name><given-names>N.</given-names> <surname>Yosef</surname></string-name>. <article-title>Revealing the vectors of cellular identity withsingle-cell genomics</article-title>. <source>Nature Biotechnology</source>, <volume>34</volume>(<issue>11</issue>):<fpage>1145</fpage>&#x2013;<lpage>1160</lpage>, <year>2016</year>.</mixed-citation></ref>
</ref-list>
</back>
</article>
