<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/456129</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group><article-title>Moana: A robust and scalable cell type classification framework for single-cell RNA-Seq data</article-title></title-group>
<contrib-group>
<contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7639-3486</contrib-id>
<name><surname>Wagner</surname><given-names>Florian</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n1">&#x002B;</xref></contrib>
<contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8438-2741</contrib-id>
<name><surname>Yanai</surname><given-names>Itai</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n2">&#x002A;</xref></contrib>
<aff id="a1"><label>1</label><institution>Institute for Computational Medicine, NYU School of Medicine</institution>, New York, NY, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn fn-type="other" id="n1"><label>&#x002B;</label><p>Email: <email>florian.wagner@nyu.edu</email></p></fn>
<fn fn-type="other" id="n2"><label>&#x002A;</label><p>Email: <email>itai.yanai@nyulangone.org</email></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>456129</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>30</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>10</month>
<year>2018</year>
</date>
</history>
<permissions><copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="456129.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Single-cell RNA-Seq (scRNA-Seq) enables the systematic molecular characterization of heterogeneous tissues at an unprecedented resolution and scale. However, it is currently unclear how to establish formal cell type definitions, which impedes the systematic analysis of scRNA-Seq data across experiments and studies. To address this challenge, we have developed <italic>Moana</italic>, a hierarchical machine learning framework that enables the construction of robust cell type classifiers from heterogeneous scRNA-Seq datasets. To demonstrate <italic>Moana</italic>&#x2019;s capabilities, we construct cell type classifiers for human immune cells that accurately distinguish between closely related cell types in the presence of experimental perturbations and systematic differences between scRNA-Seq protocols. We show that <italic>Moana</italic> is generally applicable and scales to datasets with more than ten thousand cells, thus enabling the construction of tissue-specific cell type atlases that can be directly applied to analyze new scRNASeq datasets. A Python implementation of <italic>Moana</italic> can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/yanailab/moana">https://github.com/yanailab/moana</ext-link>.</p>
</abstract>
<counts>
<page-count count="16"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Introduction</title>
<p>Single-cell RNA-Seq is a breakthrough technology with applications in diverse areas of biological research<sup><xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c3">3</xref></sup>. Thanks to exponential increases in throughput over the last years, current protocols enable the efficient processing of more than ten thousand cells in a single experiment<xref ref-type="bibr" rid="c4"><sup>4</sup></xref>. Many studies have demonstrated the unprecedented power of scRNA-Seq to provide systematic views (sometimes referred to as &#x201C;atlases&#x201D;) of cell type heterogeneity across organisms, tissues, and developmental stages, which in many cases has led to reports of novel cell types or states<sup><xref ref-type="bibr" rid="c5">5</xref>&#x2013;<xref ref-type="bibr" rid="c8">8</xref></sup>.</p>
<p>Despite these advances, it remains unclear how to formally define cell types based on scRNA-Seq data, a problem that is complicated by high levels of technical noise<sup><xref ref-type="bibr" rid="c9">9</xref>&#x2013;<xref ref-type="bibr" rid="c12">12</xref></sup>. In the absence of formal cell type definitions, the analysis of each new scRNA-Seq dataset requires the manual assignment of cell type identities. This laborious task is affected by a large number of study-specific factors, including the choice of clustering method and associated parameters<xref ref-type="bibr" rid="c13"><sup>13</sup></xref>, the technical quality of the data, the set of potential marker genes considered for each cell type, etc. Consequently, different scRNA-Seq studies of the same tissue may rely on inconsistent cell type definitions, which makes it difficult to compare and synthesize study results. Similarly, it is difficult to conduct scRNA-Seq follow-up studies of specific cell types without an unbiased method to re-identify these cell types in a new dataset.</p>
<p>The definition of cell types can be properly framed in machine learning terms as a <italic>classification</italic> problem. In other words, if there existed an algorithm that could accurately and reliably predict (assign) cell type identities to cells in a new scRNA-Seq dataset, then this algorithm would embody a quantitative, expression-based definition of those cell types. However, a generally applicable machine learning framework for scRNA-Seq cell type classification must address a formidable array of challenges: First, it must overcome the high levels of technical noise inherent to scRNA-Seq data<sup><xref ref-type="bibr" rid="c10">10</xref>&#x2013;<xref ref-type="bibr" rid="c12">12</xref></sup>. Second, it must be robust to systematic differences between datasets generated with different scRNA-Seq protocols<xref ref-type="bibr" rid="c14"><sup>14</sup></xref>. Third, it must be able to accommodate a potentially large number of cell types and closely related subtypes that are commonly present in complex tissues. Fourth, it must be capable of processing large datasets consisting of tens of thousands of cells in reasonable amounts of time, and using limited computational resources (e.g., memory). Finally, it must provide a systematic approach to assess classification performance in the absence of a ground truth, as scRNA-Seq datasets for experimentally purified subpopulations are frequently unavailable.</p>
<p>To address some of the challenges arising from the lack of formal cell type definitions, methods that facilitate the &#x201C;alignment&#x201D; and joint clustering analysis of multiple scRNA-Seq datasets have been developed<sup><xref ref-type="bibr" rid="c14">14</xref>,<xref ref-type="bibr" rid="c15">15</xref></sup>. These approaches were shown to successfully overcome batch effects, and in principle allow the cell type annotations of one dataset to serve as a reference for analyzing other scRNA-Seq datasets from the same tissue. However, as these methods lack explicit representations of cell types, they do not obviate the need to conduct a manual clustering analysis, and thus do not eliminate the risk for study-specific biases to arise. An early scRNA-Seq study applied a multinomial mixture model to study the response of specific mouse immune cell populations following exposure to lipopolysaccharide, but did not quantify classification performance<xref ref-type="bibr" rid="c16"><sup>16</sup></xref>. A recent study proposed an algorithm termed <italic>scmapcluster</italic><xref ref-type="bibr" rid="c17"><sup>17</sup></xref> that &#x201C;projects&#x201D; cell types across scRNA-Seq datasets by selecting informative genes and assigning cell identities to individual cells based on their correlation with average cell type expression profiles. While this represented an innovative classification approach for classifying scRNA-Seq data, validations were largely restricted to pancreas tissue composed of highly specialized cell types, and the ability to classify cells belonging to more closely related cell types remained unclear.</p>
<p>Here, we describe a new machine learning framework, termed <italic>Moana</italic>, which enables the construction of robust cell type classifiers from heterogeneous scRNA-Seq datasets. We propose a hierarchical approach to clustering and classification that can accommodate very large datasets and tissues composed of complex mixtures of cell types and subtypes. For classification, our framework relies on support-vector machines (SVMs) with a linear kernel, trained on PCA-transformed data. To accurately distinguish between closely related cell types, we leverage our previously developed <italic>kNN-smoothing</italic> algorithm<xref ref-type="bibr" rid="c11"><sup>11</sup></xref> to effectively reduce technical noise levels. We demonstrate the capabilities of our framework by constructing and validating classifiers for human peripheral blood mononuclear cells (PBMCs), which allow the accurate prediction of immune cell types and subtypes in data generated using different scRNA-Seq protocols, as well as following experimental perturbation. We also apply our framework for construct a classifier for human pancreas cell types, demonstrating its general applicability.</p>
</sec>
<sec id="s2"><title>Results</title>
<sec id="s2a"><title>A scalable framework for robust scRNA-Seq cell type classification</title>
<p>To design a scalable framework for constructing robust cell type classifiers from large, heterogeneous scRNA-Seq datasets, we observed that cell types in a given tissue are often closely related biologically. For example, all subtypes of mature T cells found in peripheral blood originate from thymocytes, and can be expected to share similar transcriptomes. We therefore reasoned that a hierarchical approach would be most appropriate for cell type classification. In the example, a classifier could first generally distinguish T cells from the remaining cell types, and then further distinguish among the T cell subtypes. Importantly, this would allow the two classifiers to operate at different levels of resolution, and to utilize distinct sets of genes for classification, which would be more difficult to accomplish using a single classifier. With this hierarchical approach in mind, we designed effective and integrated methods for clustering, classification, and validation, which together comprise the <italic>Moana</italic> framework (<bold><xref ref-type="fig" rid="fig1">Figure 1a</xref></bold>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1:</label><caption><title>Overview of the Moana framework.</title><p><bold>a</bold> Schematic of framework components with input and output data (VST&#x0003D;variancestabilizing transformation). <bold>b</bold> Clustering example using 2,000 cells from the PBMC-8k dataset (see text for details). <bold>c</bold> Annotation of cell types proceeds by identifying known markers among the most overexpressed genes for each cluster (top left). As an example, expression patterns of the <italic>CD3D</italic>, <italic>LYZ</italic>, and <italic>CD79A</italic> genes are shown (bottom left), which are known to be highly expressed in T cells, monocytes, and B cells, respectively. <bold>d</bold> Identification of additional subpopulations is accomplished by repeating the clustering procedure on cells from each cluster. <bold>e</bold> Schematic of the internal structure of the Moana classification model. <bold>f</bold> Schematic of the internal structure of a Moana cell type classifier, consisting of a hierarchy of independent classification models. <bold>g</bold> Strategy for efficiently performing clustering and classification for large datasets. A classifier is trained on a random subset of approx. 2,000 cells, and used to predict the remaining cells in the dataset. The procedure is repeated recursively for each subpopulation, enabling the construction of a complete hierarchical classifier without ever having to perform clustering or SVM training on the entire dataset.</p></caption><graphic xlink:href="456129_fig1.tif"/></fig>
<p>Training of a machine learning classifier requires a dataset in which expression profiles are associated with cell type labels. As such labels are typically unavailable, it is necessary to first perform clustering with the goal of labeling each cell with a cell type or subpopulation. Given the high levels of technical noise, clustering of scRNA-Seq data can present a difficult challenge, for which numerous methods have been proposed<xref ref-type="bibr" rid="c13"><sup>13</sup></xref>. For the purposes of our framework, we designed a new clustering method (<bold><xref ref-type="fig" rid="fig1">Figure 1b</xref></bold>) that takes advantage of our hierarchical approach by partitioning the cells into a few clearly distinct subpopulations, instead of resolving all cell types simultaneously. First, we aggressively smooth the data using our previously developed <italic>kNN-smoothing</italic> algorithm<xref ref-type="bibr" rid="c11"><sup>11</sup></xref>, thereby removing as much technical noise as possible. We then perform clustering directly in two-dimensional PC space using <italic>DBSCAN</italic>, a standard clustering algorithm<xref ref-type="bibr" rid="c18"><sup>18</sup></xref>. This allows a direct visual inspection of clustering results, and an examination of the expression patterns of known cell type markers (<bold><xref ref-type="fig" rid="fig1">Figure 1c</xref></bold>). Subsequently, additional subtypes can be identified by repeating the procedure for each subpopulation (<bold><xref ref-type="fig" rid="fig1">Figure 1d</xref></bold>).</p>
<p>Our clustering results suggested that with sufficient smoothing, even closely related cell types would become linearly separable in principal component space. However, overly aggressive smoothing can also introduce artifacts. In our framework, we therefore predict cell types using linear support vector machines (SVM), trained on minimally smoothed and PCA-transformed data (<bold><xref ref-type="fig" rid="fig1">Figure 1e</xref></bold>). Each principal component captures an expression module consisting of many genes, thereby reducing the impact of any single gene on the classification outcome. Additionally, SVM rely on the principle of maximum margin classification to achieve optimal classification performance<xref ref-type="bibr" rid="c19"><sup>19</sup></xref>. Our classification model is therefore designed to exhibit maximal robustness with respect to protocol-related differences or unforeseen perturbations to the transcriptome. The &#x201C;chaining&#x201D; of individual classification models results in a hierarchical classifier that is able to accommodate a large number of cell types and subtypes in a given tissue (<bold><xref ref-type="fig" rid="fig1">Figure 1f</xref></bold>).</p>
<p>Datasets consisting of more than 10,000 cells present computational challenges related to the time and memory required to complete each of the analysis steps. We found that our hierarchical approach to constructing cell type classifiers allowed for a straightforward solution to this problem (<bold><xref ref-type="fig" rid="fig1">Figure 1g</xref></bold>). First, we generate a training dataset by randomly sampling a small subset of cells from the entire dataset. Clustering and training of a Moana classification model is performed on this training dataset, and the resulting classifier is then used to predict the cell types in the entire dataset. The procedure can then be repeated for each subpopulation, which allows the construction of a complete hierarchical classifier without ever having to analyze the full dataset. A detailed technical description of all components of the Moana framework is provided in the Methods.</p>
</sec>
<sec id="s2b"><title>Construction and initial validation of a cell type classifier for human PBMCs</title>
<p>We applied our framework to construct a cell type classifier for human peripheral blood mononuclear cells (PBMCs), which present a difficult classification challenge owing to the relatively low RNA content of these cells (<bold>Supplementary Figure 1</bold>), and the fact that several cell types such as CD14&#x002B; and CD16&#x002B; monocytes are closely related, and are therefore expected to share similar transcriptomes. Using a PBMC dataset provided by 10x Genomics (PBMC-8k, <italic>n</italic>&#x0003D;8,381 cells), we constructed a Moana classifier comprising eight binary classification models, thus distinguishing between nine immune cell types: CD14&#x002B; monocytes, CD16&#x002B; monocytes, dendritic cells (DCs), B cells, NK cells, and four subtypes of T cells (<bold><xref ref-type="fig" rid="fig2">Figure 2a</xref></bold> and Methods). Our clustering method successfully identified subpopulations in the clustering steps required for the construction of this classifier (<bold>Supplementary Figures 2 and 3</bold>), demonstrating its effectiveness at different levels of resolution. While broadly distinguishing between T/NK cells, B cells, and Monocytes/DCs did not require any smoothing (<italic>k</italic>&#x0003D;1), smoothing was essential to accurately distinguish between most cell types in the training data (<bold><xref ref-type="fig" rid="fig2">Figure 2a</xref></bold> and <bold>Supplementary Figure 4a</bold>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2:</label><caption><title>Construction and initial validation of a Moana cell type classifier for human PBMCs.</title><p><bold>a</bold> Classification tree of the classifier, trained on the PBMC-8k dataset. Yellow boxes represent classification models and indicate training parameters, <italic>k</italic> represents the number of neighbors used for smoothing, and <italic>d</italic> represents the number of principal components used. All models were trained using <italic>&#x03BD;</italic>=0.02. The classifier distinguishes between nine cell types (shaded boxes). <bold>b</bold> Left: t-SNE analysis of all cells from the PBMC-4k dataset. Center: Cell type predictions (top) and annotations (bottom), overlaid onto the same t-SNE analysis. Right: Prediction accuracies, calculated by treating the annotated cell types as the ground truth. <bold>c</bold> Comparison of B cell average expression profiles in the two datasets. <bold>d</bold> Schematic overview of the mirror validation procedure. For large datasets, the cell types annotations (green box)can be replaced by the cell type identities predicted by the primary classifier. <bold>e</bold> Mirror validation results. <bold>f</bold> Clustering results (top left) and identification of most informative genes (top right) for the Monocyte/Dendritic cell classification model. Bottom: Smoothed expression levels of the <italic>FTL</italic> and <italic>CD74</italic> genes. <bold>g</bold> Heatmap showing the expression of the most informative genes from each classification model across cell types.</p></caption><graphic xlink:href="456129_fig2.tif"/></fig>
<p>To validate our classifier, we obtained a second 10x Genomics dataset (PBMC-4k, <italic>n</italic>&#x0003D;4,340; cells obtained from the same donor as for the training dataset). We clustered the cells into the same nine cell types as before (<bold>Supplementary Figure 5</bold>), and manually excluded 37 cells that we identified as plasmacytoid dendritic cells (<bold>Supplementary Figure 4c</bold>). We then applied our PBMC classifier to this dataset, and used the clustering results as the &#x201C;ground truth&#x201D; for assessing the accuracy of the cell type predictions (<bold><xref ref-type="fig" rid="fig2">Figure 2b</xref></bold>). Prediction accuracies were generally high, with precision scores of above 98&#x0025; for CD14&#x002B; monocytes, dendritic cells, B cells, and NK cells. Approx. 20&#x0025; of cells predicted to be CD16&#x002B; monocytes were annotated as CD14&#x002B; monocytes during clustering. CD14&#x002B; and CD16&#x002B; monocytes did not form distinct clusters in t-SNE space, suggesting that the difficulty in accurately distinguished between them could be explained by their high transcriptomic similarity. While precision scores for T cell subtypes were slightly lower, ranging between 80-90&#x0025;, this was still a remarkable result given that the na&#x00EF;ve CD4&#x002B; and CD8&#x002B; T cell populations were completely overlapping in t-SNE space (<bold><xref ref-type="fig" rid="fig2">Figure 2b</xref></bold>). We used the predicted cell types to calculate average expression profiles for each cell type, which revealed near-perfect correlations between the training and the validation data (<bold><xref ref-type="fig" rid="fig2">Figure 2c</xref></bold> and <bold>Supplementary Figure 4d</bold>). These results demonstrated the ability of our classifier to accurately distinguish between closely related immune cell types in a validation dataset.</p>
<p>Our approach of combining PCA with linear SVM classification allowed us to quantify how informative each gene was for distinguishing between individual subpopulations (<bold><xref ref-type="fig" rid="fig2">Figure 2f</xref></bold> and Methods), which fundamentally depends on its cell type specificity as well as its absolute expression level. We collected the most informative genes from all subclassifiers and visualized them as a heatmap (<bold><xref ref-type="fig" rid="fig2">Figure 2g</xref></bold> and <bold>Supplementary Figure 6</bold>), which showed that these included both widely expressed genes such as <italic>B2M</italic> (Beta-2-microglobulin), as well as genes with highly cell type-specific expression such as <italic>S100A8</italic> and <italic>S100A9</italic> (expressed only in CD14&#x002B; monocytes and dendritic cells). This demonstrated that by choosing a hierarchical approach to cell type classification, we were able to utilize information from many more genes than if we had tried to construct a classifier based solely on genes with highly cell type-specific expression patterns.</p>
</sec>
<sec id="s2c"><title>Systematic assessment of classification performance in the absence of a ground truth</title>
<p>The generation of a &#x201C;ground truth&#x201D; through manual clustering can be time-consuming and carries the risk of introducing subjective biases or mistakes, which can result in the over- or underestimation of classification accuracies. Unfortunately, a more reliable ground truth, such as scRNA-Seq data from experimentally purified subpopulations, is frequently unavailable. To overcome this limitation, we devised an algorithm which we refer to as <italic>mirror validation</italic> (<bold><xref ref-type="fig" rid="fig2">Figure 2c</xref></bold> and Methods). In this approach, we use the trained classifier to predict cell types in a validation dataset from the same tissue, and then use the predicted cell type labels to train a new &#x201C;mirror classifier&#x201D; on this dataset. We then apply the mirror classifier to the original training dataset, and assess the degree with which the predictions from mirror classifier agree with those of the original classifier. We reasoned that whenever the original classifier fails to accurately identify its cell types in the validation dataset, it would not be possible for the mirror classifier to accurately recapitulate the original cell type assignments in the training dataset. This lack of &#x201C;coherence&#x201D; would therefore indicate a failure to accurately determine cell types in the validation dataset.</p>
<p>We applied mirror validation using PBMC-4k as the validation dataset, and found that coherence scores, which combine precision and recall values into a single measure (Methods), were at or above 90&#x0025; for all cell types (<bold><xref ref-type="fig" rid="fig2">Figure 2e</xref></bold>), suggesting high classification accuracies. By examining the validation results for individual classification models, we observed that the validation accuracies for highly imbalanced classes (e.g., T cells and NK cells) could be further improved to over 98&#x0025; by lowering the <italic>&#x03BD;</italic> parameter of the mirror classifier (<bold>Supplementary Figure 4b</bold>). However, independent of the choice of <italic>&#x03BD;</italic>, the accuracies for the classifiers distinguishing monocyte and T cell subtypes remained slightly lower than for the other cell types. Therefore, the mirror validation results closely agreed with the results obtained using the manually generated &#x201C;ground truth&#x201D;, demonstrating that mirror validation allowed the effective assessment of classification performance in the absence of a ground truth.</p>
</sec>
<sec id="s2d"><title>Accurate prediction of PBMC cell types in data generated using a different scRNA-Seq protocol</title>
<p>Given the diversity of scRNA-Seq protocols developed<xref ref-type="bibr" rid="c4"><sup>4</sup></xref>, scRNA-Seq classifiers should ideally be able to accurately determine cell types in data generated using a different protocol, which may result in substantial systematic expression differences. We therefore aimed to assess the ability of our classifier to accurately predict PBMC cell types for data generated using 10x Genomics&#x2019; &#x201C;v1&#x201D; chemistry, as opposed to the &#x201C;v2&#x201D; chemistry used to generate PBMC-8k. A t-SNE analysis of a combined dataset with both v1 and v2 PBMC expression profiles showed that even after normalization, cells clustered by dataset, not cell type, suggesting the presence of large systematic differences that we did not observe between datasets generated using the same protocol (<bold><xref ref-type="fig" rid="fig3">Figure 3a</xref></bold> and <bold>Supplementary Figure 7d</bold>). When we applied our classifier to the v1 PBMC dataset (v1-PBMC-16k, <italic>n</italic>&#x0003D;16,000), cells of all cell types were identified, although cell type proportions differed significantly from the v2 training data (<bold><xref ref-type="fig" rid="fig3">Figure 3b</xref></bold> and <bold>Supplementary Figure 7a</bold>). Using the predicted cell types, we calculated average expression profiles for each cell type, and found that the protocol-dependent differences indeed appeared larger than many cell type differences (<bold><xref ref-type="fig" rid="fig3">Figure 3b</xref></bold> and <bold>Supplementary Figure 7b, c</bold>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure"><label>Figure 3:</label><caption><title>Accuracy of the Moana PBMC classifier for data generated using a different scRNA-Seq protocol.</title><p><bold>a</bold> Left: t-SNE analysis of 4,000 cells, consisting of a 50:50 mixture of cells from PBMC datasets generated using two different protocols (10x Genomics v1 vs. v2 chemistry). Right: Same t-SNE analysis, overlaid with the cell type identities predicted using the PBMC classifier (<bold><xref ref-type="fig" rid="fig2">Figure 2a</xref></bold>). <bold>b</bold> Top: Comparison of average na&#x00EF;ve CD4 and na&#x00EF;ve CD8 T cell expression profiles in the v1 dataset. Bottom: Comparison of average na&#x00EF;ve CD4&#x002B; T cell expression profiles in the v1 and v2 datasets. <bold>c-e</bold> Prediction results of the PBMC classifier, for v1 datasets representing experimentally purified PBMC subpopulations (Methods). The &#x201C;Rest&#x201D; category encompasses any cell type not listed in the legend, as well as cell types with a predicted abundance of less than one percent. <bold>f</bold> Mirror validation results for the PBMC classifier, using v1-PBMC-16k as the validation dataset.</p></caption><graphic xlink:href="456129_fig3.tif"/></fig>
<p>The availability of v1 datasets of purified PBMC subpopulations<xref ref-type="bibr" rid="c20"><sup>20</sup></xref> allowed us to use an experimentally generated ground truth to assess the accuracy of our classifier. The classifier identified B cells, T cells and NK cells with &#x003E;97&#x0025; accuracy, but predicted the presence of 19&#x0025; dendritic cells in a dataset representing purified CD14&#x002B; monocytes (<bold><xref ref-type="fig" rid="fig3">Figure 3c</xref></bold>). We did not explore the extent to which this could reflect an experimental contamination associated with the negative selection protocol used by Zheng et al.<xref ref-type="bibr" rid="c20"><sup>20</sup></xref>, as opposed to a classification error. We next applied the classifier to data from experimentally purified T cell subpopulations, and found that more than 99&#x0025; of total CD8&#x002B; T cells were predicted to belong to the CD8&#x002B; lineage, while 85&#x0025; of total CD4&#x002B; T cells were predicted to belong to the CD4&#x002B; lineage (<bold><xref ref-type="fig" rid="fig3">Figure 3d</xref></bold>). In addition, we found that classification accuracies ranged from 94-99&#x0025; for na&#x00EF;ve CD4&#x002B;, na&#x00EF;ve CD8&#x002B;, and memory CD4&#x002B; T cells (<bold><xref ref-type="fig" rid="fig3">Figure 3e</xref></bold>). Overall, these results demonstrated the ability of our classifier to accurately distinguish between closely related cell types in data exhibiting substantial systematic differences associated with the use of a different scRNA-Seq protocol.</p>
</sec>
<sec id="s2e"><title>Moana outperforms a previously described method for scRNA-Seq cell type prediction</title>
<p>To directly compare our classification results to those obtained with a previously proposed classification method, we reimplemented the <italic>scmap-cluster</italic> method<xref ref-type="bibr" rid="c17"><sup>17</sup></xref>, a non-hierarchical approach that relies on gene selection and correlation measures to predict cell type identities. We first ensured that we were able to accurately reproduce the classification results from the original study (<bold>Supplementary Figure 8</bold>). We then trained an <italic>scmap-cluster</italic> classifier on the PBMC-8k dataset, while using the PBMC-4k dataset to determine the optimal number of genes (Methods). We then applied this classifier to the experimentally purified PBMC subpopulations. We found that B and NK cells were predicted accurately, while accuracies were much lower for all other cell types (<bold>Supplementary Figure 9</bold>). In particular, for all purified T cell subpopulations, the classifier left between 28&#x0025; and 70&#x0025; of cells &#x201C;unassigned&#x201D;, indicating an inability to conclusively determine cell type identities. These results showed that the <italic>scmap-cluster</italic> classifier failed to achieve a similar resolution as our Moana classifier when presented with data that exhibited substantial batch effects.</p>
</sec>
<sec id="s2f"><title>Construction and validation of a classifier for human pancreas cells</title>
<p>Moana is a general framework for constructing cell type classifiers for complex tissues based on scRNASeq data. To demonstrate its applicability beyond PBMC samples, we constructed a human pancreas cell type classifier based on scRNA-Seq data reported by our lab (Baron16- 3, <italic>n</italic>=4,591; Methods).<xref ref-type="bibr" rid="c21"><sup>21</sup></xref> We visually confirmed the presence of batch effects, as well as the ability of our classifier to predict cell types independent of those effects (<bold><xref ref-type="fig" rid="fig4">Figure 4a</xref></bold>). Cell type composition was highly variable across cell types (<bold><xref ref-type="fig" rid="fig4">Figure 4b</xref></bold>), but mirror validation showed that cell type predictions were highly coherent, thereby validating the accuracies of our predictions (<bold><xref ref-type="fig" rid="fig4">Figure 4c</xref></bold>). Previous work relied on well-established marker genes to identify individual cell types, and we found that our predictions allowed us to recover those marker genes in an unbiased fashion (<bold><xref ref-type="fig" rid="fig4">Figure 4d</xref></bold> and <bold>Supplementary Figure 10a</bold>), further confirming our classification results. Finally, since some of these marker genes exhibited very high expression levels, we asked if it would be possible to predict cell type identities based on only a single marker gene for each cell type. We found that this was the case for the highly specialized endocrine cell types, but not for stellate and ductal cells (<bold><xref ref-type="fig" rid="fig4">Figure 4e</xref></bold>). In contrast, among PBMCs, we were only able to predict B cells using a single marker gene (<bold>Supplementary Figure 10b,c</bold>). Our results confirmed the general applicability of our framework, and showed that while distinguishing between the endocrine cell types was indeed a trivial task, our classifier also enabled the accurate prediction of the remaining cell types in the pancreas.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure"><label>Figure 4:</label><caption><title>Prediction of human pancreas cell types.</title><p><bold>a</bold> Left: t-SNE analysis of 4,000 cells consisting of an equal mixture of cells from four independent biological samples<xref ref-type="bibr" rid="c21"><sup>21</sup></xref>. Right: Same t-SNE analysis, overlaid with the cell type identifies as predicted from a <italic>Moana</italic> classifier trained on Baron16- 3. <bold>b</bold> Predicted cell type proportions for each of the four samples. <bold>c</bold> Mirror validation results, using two different samples as mirror datasets. <bold>d</bold> Heatmap showing the expression of cell type marker genes identified based on the predicted cell type identities. Genes that were used as cell type markers by Baron et al.<xref ref-type="bibr" rid="c21"><sup>21</sup></xref> are underlined. <bold>e</bold> Precision-recall curves for identifying individual cell types based on the expression of a single marker gene for each cell type (as indicated in the legend).</p></caption><graphic xlink:href="456129_fig4.tif"/></fig>
</sec>
<sec id="s2g"><title>Accurate prediction of PBMC cell types after an experimental perturbation</title>
<p>In addition to exhibiting robustness to batch effects, an scRNA-Seq cell type classifier should also be able to identify cell types following in vivo or in vitro perturbations to the &#x201C;normal&#x201D; cell state. To test whether a Moana classifier would be able to accurately identify cell types following an experimental perturbation, we decided to predict cell type identities for PBMCs following exposure to the cytokine interferon beta (IFN-&#x03B2;)<xref ref-type="bibr" rid="c22"><sup>22</sup></xref>. This treatment was reported to result in widespread transcriptomic changes across cell types and the downregulation of key cell type markers<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c23">23</xref></sup>, thus providing an interesting test case for the robustness of Moana classifiers. We first used mirror validation to test the performance of our original PBMC classifier on the unexposed control dataset (Kang18-Ctl, <italic>n</italic>=12,757), which indicated that it did not accurately distinguish between CD14&#x002B; and CD16&#x002B; monocytes, nor between T cell subtypes (<bold>Supplementary Figure 11a</bold>). We observed that the unexposed cells exhibited dramatic transcriptomic differences relative to our original training data (<bold>Supplementary Figure 11c</bold>), potentially resulting from their culturing for the duration of the experiment<xref ref-type="bibr" rid="c22"><sup>22</sup></xref>. Evidently, these differences were too great to allow an accurate classification of subtypes using our original PBMC classifier. We therefore decided to use the control dataset to train a new PBMC classifier (<bold>Supplementary Figure 12</bold> and Methods). The structure of the classifier largely mirrored that of our first PBMC classifier, however we were unable to accurately distinguish T cell subtypes using our clustering method, perhaps owing to the significantly lower transcript counts in this dataset (<bold>Supplementary Figure 1a</bold>). We then applied this classifier to predict the cell types in the treatment dataset (Kang18-Tx, <italic>n</italic>=13,551).</p>
<p>We visually confirmed the presence of significant expression differences between treated and untreated cells (<bold><xref ref-type="fig" rid="fig5">Figure 5a</xref></bold>), and found that our classifier identified cells from all major cell types with similar proportions in both conditions, in agreement with previous analyses of the same data<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c22">22</xref></sup> (<bold><xref ref-type="fig" rid="fig5">Figure 5a</xref>,b</bold>). We next used the treatment dataset to perform mirror validation, which resulted in high coherence scores for all cell types except for dendritic cells (<bold><xref ref-type="fig" rid="fig5">Figure 5c</xref> and Supplementary Figure 11b</bold>). We also compared our cell type predictions to the cell type assignments from a previous analysis by Butler et al., who performed clustering after &#x201C;alignment&#x201D; of the two datasets<sup>15</sup>, and found that for both datasets, our predictions strongly agreed with these annotations, with the exception of dendritic cell predictions in the treatment dataset (<bold>Supplementary Figure 11d</bold>). As dendritic cells represented only 2&#x0025; of cells in the training data, it is possible that additional parameter tuning was necessary to achieve better classification robustness for these cells. Overall, these results demonstrated the ability of a Moana classifier to accurately predict cell types following an experimental perturbation that induced widespread transcriptomic differences.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure"><label>Figure 5:</label><caption><title>Prediction of PBMC cell type identities following exposure to IFN-&#x03B2;.</title><p><bold>a</bold> Left: t-SNE analysis of 4,000 cells consisting of an equal mixture of cells from the control and treatment datasets, respectively<xref ref-type="bibr" rid="c22"><sup>22</sup></xref>. Right: Same t-SNE analysis, with predicted cell types overlaid. <bold>b</bold> Predicted cell type proportions. <bold>c</bold> Mirror validation results. <bold>d</bold> Left: Heatmap showing cell type-specific gene expression levels after IFN-&#x03B2; exposure, relative to their maximum expression level across cell types in the control condition. Right: Zoomed-in view of 15 genes with very strong upregulation. Underlined are genes reported as either universal (red) or cell type-specific (blue) IFN-&#x03B2; response markers by Butler <italic>et al.</italic><xref ref-type="bibr" rid="c15"><sup>15</sup></xref>. <bold>e</bold> Detailed view of expression levels with and without IFN-&#x03B2; exposure for three &#x201C;universal&#x201D; (top) and three &#x201C;cell type-specific&#x201D; (bottom) marker genes.</p></caption><graphic xlink:href="456129_fig5.tif"/></fig>
</sec>
<sec id="s2h"><title>Expression analysis based on predicted PBMC cell types suggests a broadly shared response to IFN-&#x03B2;</title>
<p>Finally, we aimed to use the predicted cell type identities as the basis for a cell type-specific analysis of differential expression following exposure to IFN-&#x03B2;. A previous analysis that applied clustering to &#x201C;aligned&#x201D; datasets had reported a number of genes that were strongly induced across all cell types, as well as other genes with more cell type-specific induction<xref ref-type="bibr" rid="c15"><sup>15</sup></xref>. We defined a &#x201C;physiological&#x201D; expression level for each gene as the maximum expression level across all cell types in the control, and then compared the expression levels in the treatment condition to this level. Our results suggested the presence of at least two distinct responses to IFN-&#x03B2; (<bold><xref ref-type="fig" rid="fig5">Figure 5d</xref></bold>): First, a shared response that involved a strong upregulation of more than 50 genes in all cell types, and second, a similarly strong dendritic cell-specific response. Since dendritic cells (DCs) represented a rare population and we did not distinguish between plasmacytoid and myeloid DCs, we decided to focus our analysis on the shared response. Unexpectedly, we found that in addition to genes previously reported as universal IFN-&#x03B2; markers, this response encompassed several genes such <italic>CXCL11</italic>, <italic>CCL8</italic> and <italic>CMPK2</italic> that were previously reported as having a cell type-specific response<xref ref-type="bibr" rid="c15"><sup>15</sup></xref> (<bold><xref ref-type="fig" rid="fig5">Figure 5d</xref>, e</bold>). As the analysis was performed on the same dataset, using closely matching cell type assignments (<bold>Supplementary Figure 11d</bold>), this discrepancy likely resulted from different approaches to quantifying differential expression. Overall, these results demonstrated that Moana cell type predictions allowed the systematic quantification of cell type-specific differential expression following exposure to IFN-&#x03B2;, and suggested that independent of cell type, PBMCs elicit a common response that results in the strong upregulation of a substantial number of genes.</p>
</sec>
</sec>
<sec id="s3"><title>Discussion</title>
<p>In this work we have introduced <italic>Moana</italic>, a generally applicable machine learning framework that enables the construction and deployment of accurate and robust cell type classifiers for high-throughput scRNA-Seq data. We applied this framework to construct PBMC classifiers, which we were able to show allowed the accurate prediction of cell types in data generated using different protocols, as well as following perturbations of the transcriptome. To our knowledge, this is the first demonstration of an accurate and robust scRNA-Seq cell type classifier for PBMCs, and we propose that future benchmarks of scRNA-Seq classification performance should focus on difficult challenges presented by PBMCs and other tissues that contain small- to moderately-sized cells and closely related cell types. During the preparation of this manuscript, Alquicira-Hern&#x00E1;ndez et al.<xref ref-type="bibr" rid="c24"><sup>24</sup></xref> proposed a classification framework that shares some basic building blocks with Moana, in that it involves the training of SVM classifiers on PCAtransformed data. Despite substantial differences in methodology, we think that the independent proposal of combining PCA with SVM for scRNA-Seq cell type classification speaks to the intuitive appeal of this approach. However, the scope of the current work significantly exceeds that of previous reports17,24. We describe a hierarchical framework that encompasses methods for clustering, classification and validation, all of which directly integrate a specialized smoothing algorithm to reduce technical noise levels in scRNA-Seq data<xref ref-type="bibr" rid="c11"><sup>11</sup></xref>. Moreover, we show that our framework can be used to construct classifiers that exhibit high prediction accuracies for a tissue composed of multiple closely related cell types, even in the presence of strong batch effects.</p>
<p>Our hierarchical approach to clustering and classification represents a key innovation, as it simultaneously enables our framework to scale to large datasets, accommodate a large number of cell types, and perform clustering and classification at distinct levels of resolution. Another key advantage of this approach is the ability to construct individual subclassifiers using different datasets. For example, a subclassifier for T cell subtypes could be trained on a different scRNA-Seq dataset containing only T cells. By collecting scRNA-Seq data after enriching for specific subpopulations, it is thus possible to experimentally overcome the computational difficulty of training (sub-)classifiers for extremely rare populations of cells. In this work, we have proposed to remedy the often widely differing cell type abundances by creating synthetic training datasets in which rare cell types are overrepresented, which helps to increase classification robustness as long as a certain minimum number of cells of a particular type are available.</p>
<p>In addition to extremely rare subpopulations, we decided to ignore the presence of doublets (multiplets) in the data. The ability of PCA to capture specific sources of variation in individual PCs allowed us to construct accurate classifiers without removing doublets. However, their identification is important to avoid confusion during the clustering stage, and we would ultimately like to incorporate an automated method for removing these technical artifacts from the data in our framework. We briefly considered modeling doublets as artificial cell types, however this approach did not seem appropriate given the fact that the transcriptomic composition of the doublets depends entirely on the actual cell type composition of the sample. We would instead favor a simulation-based approach such as the one proposed by McGinnis et al.<xref ref-type="bibr" rid="c25"><sup>25</sup></xref> Additionally, to further increase the ability to accurately distinguish between closely related cell types or states, future research may be directed at the selection of informative principal components<xref ref-type="bibr" rid="c24"><sup>24</sup></xref>, and at the incorporation of a gene selection step<xref ref-type="bibr" rid="c26"><sup>26</sup></xref> during both clustering and classification, as PCA does not admit a sparse data representation.</p>
<p>In advancing quantitative cell type definitions, we are not advocating for a rigid or mindless application of those definitions. Rather, cell type classification can form the basis for an exploratory analysis of scRNA-Seq data, including a search for entirely new cell types. Moana classifiers are designed to provide maximum robustness to batch or treatment effects. As the nature and magnitude of those effects are unknown in advance, it would be very difficult to maintain the desired robustness while simultaneously trying to identify cells that represent a previously unseen cell type. However, cell type classification results can be followed up with clustering or outlier detection analyses aimed at identifying such new cell types. A distance threshold for suggesting the presence of a new cell type would perhaps be best defined empirically, based on an analysis of many datasets with the same classifier, and the observed distribution of similarities with the cells in the training data.</p>
<p>Our work was motivated by the large number of completed or ongoing &#x201C;atlas-building&#x201D; projects<sup><xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c28">28</xref>&#x2013;<xref ref-type="bibr" rid="c33">33</xref></sup>, in which large scRNA-Seq datasets are being produced for individual organisms or tissues, with the goal of generating comprehensive cell type compendia. Moana provides a way to distill these datasets into robust cell type classifiers that can be applied to automatically determine cell types in new scRNA-Seq datasets. New and powerful single-cell RNA-Seq protocols are producing datasets comprising billions of noisy gene expression measurements<xref ref-type="bibr" rid="c1"><sup>1</sup></xref>. It is increasingly clear that it will not be possible to effectively extract and organize biological knowledge from these measurements without equally powerful computational frameworks and tools. In designing Moana, we aimed to develop a framework that was tailored to the noise characteristics of scRNA-Seq data, relied as much as possible on established machine learning methods (e.g., PCA, SVM), allowed the direct visual examination of intermediate results, and maintained computational efficiency. Given the numerous biological and computational challenges involved, we believe that the collaboration of experimental and computational biologists is essential in realizing the full potential of scRNA-Seq technology.</p>
</sec>
<sec id="s4"><title>Methods</title>
<p>A description of all methods is contained in the Supplement.</p>
</sec>
</body>
<back>
<ack><title>Acknowledgements</title>
<p>We would like to thank Yun Yan for processing the pancreas raw data with the SingleCell pipeline. In addition, we would like to thank Dr. Gal Avital, Dr. Gustavo S. Fran&#x00E7;a, Dr. Eva Chmielnicki, Bo Xia, Felicia Kuperwaser, Reuben Moncada, and Dalia Barkley for their comments on an earlier version of this manuscript.</p></ack>
<ref-list><title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Papalexi</surname>, <given-names>E.</given-names></string-name> &#x0026; <string-name><surname>Satija</surname>, <given-names>R.</given-names></string-name> <article-title>Single-cell RNA sequencing to explore immune cell heterogeneity</article-title>. <source>Nat. Rev. Immunol</source>. (<year>2017</year>). doi:<pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id></mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Rantalainen</surname>, <given-names>M.</given-names></string-name> <article-title>Application of single-cell sequencing in human cancer</article-title>. <source>Brief. Funct. Genomics</source> (<year>2017</year>). doi:<pub-id pub-id-type="doi">10.1093/bfgp/elx036</pub-id></mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Potter</surname>, <given-names>S. S.</given-names></string-name> <article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat. Rev. Nephrol.</source> <volume>14</volume>, <fpage>479</fpage>&#x2013;<lpage>492</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Svensson</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Vento-Tormo</surname>, <given-names>R.</given-names></string-name> &#x0026; <string-name><surname>Teichmann</surname>, <given-names>S. A.</given-names></string-name> <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>. <source>Nat. Protoc.</source> <volume>13</volume>, <fpage>599</fpage>&#x2013;<lpage>604</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Villani</surname>, <given-names>A.-C.</given-names></string-name> <etal>et al.</etal> <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source> <volume>356</volume>, (<year>2017</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Gr&#x00FC;n</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source> <volume>525</volume>, <fpage>251</fpage>&#x2013;<lpage>255</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Tirosh</surname>, <given-names>I.</given-names></string-name> <etal>et al.</etal> <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>. <source>Science</source> <volume>352</volume>, <fpage>189</fpage>&#x2013;<lpage>196</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Keren-Shaul</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>A Unique Microglia Type Associated with Restricting Development of Alzheimer&#x2019;s Disease</article-title>. <source>Cell</source> <volume>169</volume>, <fpage>1276</fpage>-<lpage>1290</lpage>.e17 (<year>2017</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Wagner</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Regev</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Yosef</surname>, <given-names>N.</given-names></string-name> <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>. <source>Nat. Biotechnol.</source> <volume>34</volume>, <fpage>1145</fpage>&#x2013;<lpage>1160</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Ziegenhain</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>Comparative Analysis of Single-Cell RNA Sequencing Methods</article-title>. <source>Mol. Cell</source> <volume>65</volume>, <fpage>631</fpage>-<lpage>643</lpage>.e4 (<year>2017</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Wagner</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Yan</surname>, <given-names>Y.</given-names></string-name> &#x0026; <string-name><surname>Yanai</surname>, <given-names>I.</given-names></string-name> <article-title>K-nearest neighbor smoothing for high-throughput single-cell RNA-Seq data</article-title>. <source>bioRxiv 217737</source> (<year>2018</year>). doi:<pub-id pub-id-type="doi">10.1101/217737</pub-id></mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Gr&#x00FC;n</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kester</surname>, <given-names>L.</given-names></string-name> &#x0026; <string-name><surname>van Oudenaarden</surname>, <given-names>A.</given-names></string-name> <article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nat. Methods</source> <volume>11</volume>, <fpage>637</fpage>&#x2013;<lpage>640</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Du&#x00F2;</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Robinson</surname>, <given-names>M. D.</given-names></string-name> &#x0026; <string-name><surname>Soneson</surname>, <given-names>C.</given-names></string-name> <source>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</source>. (<year>2018</year>). doi:<pub-id pub-id-type="doi">10.12688/f1000research.15666.2</pub-id></mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Haghverdi</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lun</surname>, <given-names>A. T. L.</given-names></string-name>, <string-name><surname>Morgan</surname>, <given-names>M. D.</given-names></string-name> &#x0026; <string-name><surname>Marioni</surname>, <given-names>J. C.</given-names></string-name> <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat. Biotechnol.</source> <volume>36</volume>, <fpage>421</fpage>&#x2013;<lpage>427</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Butler</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Smibert</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Papalexi</surname>, <given-names>E.</given-names></string-name> &#x0026; <string-name><surname>Satija</surname>, <given-names>R.</given-names></string-name> <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source> <volume>36</volume>, <fpage>411</fpage>&#x2013;<lpage>420</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Jaitin</surname>, <given-names>D. A.</given-names></string-name> <etal>et al.</etal> <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>. <source>Science</source> <volume>343</volume>, <fpage>776</fpage>&#x2013;<lpage>779</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Kiselev</surname>, <given-names>V. Y.</given-names></string-name>, <string-name><surname>Yiu</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Hemberg</surname>, <given-names>M.</given-names></string-name> <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat. Methods</source> <volume>15</volume>, <fpage>359</fpage>&#x2013;<lpage>362</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="book"><string-name><surname>Ester</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kriegel</surname>, <given-names>H.-P.</given-names></string-name>, <string-name><surname>Sander</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Xu</surname>, <given-names>X.</given-names></string-name> <chapter-title>A Density-based Algorithm for Discovering Clusters a Density-based Algorithm for Discovering Clusters in Large Spatial Databases with Noise</chapter-title>. in <source>Proceedings of the Second International Conference on Knowledge Discovery and Data Mining</source> <fpage>226</fpage>&#x2013;<lpage>231</lpage> (<publisher-name>AAAI Press</publisher-name>, <year>1996</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Cortes</surname>, <given-names>C.</given-names></string-name> &#x0026; <string-name><surname>Vapnik</surname>, <given-names>V.</given-names></string-name> <article-title>Support-vector networks</article-title>. <source>Mach. Learn.</source> <volume>20</volume>, <fpage>273</fpage>&#x2013;<lpage>297</lpage> (<year>1995</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Zheng</surname>, <given-names>G. X. Y.</given-names></string-name> <etal>et al.</etal> <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source> <volume>8</volume>, <fpage>14049</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Baron</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>A Single-Cell Transcriptomic Map of the Human and Mouse Pancreas Reveals Inter- and Intra-cell Population Structure</article-title>. <source>Cell Syst.</source> <volume>3</volume>, <fpage>346</fpage>-<lpage>360</lpage>.e4 (<year>2016</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Kang</surname>, <given-names>H. M.</given-names></string-name> <etal>et al.</etal> <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol.</source> <volume>36</volume>, <fpage>89</fpage>&#x2013;<lpage>94</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Kang</surname>, <given-names>H. M.</given-names></string-name> <etal>et al.</etal> <article-title>Multiplexing droplet-based single cell RNA-sequencing using natural genetic barcodes</article-title>. <source>bioRxiv 118778</source> (<year>2017</year>). doi:<pub-id pub-id-type="doi">10.1101/118778</pub-id></mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Alquicira-Hernandez</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Nguyen</surname>, <given-names>Q.</given-names></string-name> &#x0026; <string-name><surname>Powell</surname>, <given-names>J. E.</given-names></string-name> <article-title>scPred: Single cell prediction using singular value decomposition and machine learning classification</article-title>. <source>bioRxiv 369538</source> (<year>2018</year>). doi:<pub-id pub-id-type="doi">10.1101/369538</pub-id></mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="website"><source>DoubletFinder: Doublet detection in single-cell RNA sequencing data using artificial nearest neighbors &#x007C; bioRxiv</source>. Available at: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2018/07/19/352484">https://www.biorxiv.org/content/early/2018/07/19/352484</ext-link>. (Accessed: 27th September 2018)</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Chung</surname>, <given-names>N. C.</given-names></string-name> &#x0026; <string-name><surname>Storey</surname>, <given-names>J. D.</given-names></string-name> <article-title>Statistical significance of variables driving systematic variation in high-dimensional data</article-title>. <source>Bioinforma. Oxf. Engl.</source> <volume>31</volume>, <fpage>545</fpage>&#x2013;<lpage>554</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J. T.</given-names></string-name> <etal>et al.</etal> <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat. Rev. Genet.</source> <volume>11</volume>, <fpage>733</fpage>&#x2013;<lpage>739</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Davie</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>A Single-Cell Transcriptome Atlas of the Aging Drosophila Brain</article-title>. <source>Cell</source> (<year>2018</year>). doi:<pub-id pub-id-type="doi">10.1016/j.cell.2018.05.057</pub-id></mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Regev</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Science Forum: The Human Cell Atlas</article-title>. <source>eLife</source> <volume>6</volume>, <fpage>e27041</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Han</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>. <source>Cell</source> <volume>173</volume>, <fpage>1307</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Muraro</surname>, <given-names>M. J.</given-names></string-name> <etal>et al.</etal> <article-title>A Single-Cell Transcriptome Atlas of the Human Pancreas</article-title>. <source>Cell Syst.</source> <volume>3</volume>, <fpage>385</fpage>-<lpage>394</lpage>.e3 (<year>2016</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Zeisel</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Molecular Architecture of the Mouse Nervous System</article-title>. <source>Cell</source> <volume>174</volume>, <fpage>999</fpage>-<lpage>1014</lpage>.e22 (<year>2018</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Plass</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Cell type atlas and lineage tree of a whole complex animal by single-cell transcriptomics</article-title>. <source>Science</source> <volume>360</volume>, (<year>2018</year>).</mixed-citation></ref>
</ref-list>
</back>
</article>