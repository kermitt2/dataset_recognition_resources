<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/322974</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Animal Behavior and Cognition</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Regulation of Harvester Ant Foraging as a Closed-Loop Excitable System</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5518-7317</contrib-id>
<name><surname>Pagliara</surname><given-names>Renato</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Gordon</surname><given-names>Deborah M.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5328-3871</contrib-id>
<name><surname>Leonard</surname><given-names>Naomi Ehrich</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Mechanical and Aerospace Engineering, Princeton University</institution>, Princeton, New Jersey, <country>United States of America</country></aff>
<aff id="a2"><label>2</label><institution>Department of Biology, Stanford University</institution>, Stanford, California, <country>United States of America</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Email: <email>naomi@princeton.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>322974</elocation-id>
<history>
<date date-type="received">
<day>15</day><month>5</month><year>2018</year>
</date>
<date date-type="rev-recd">
<day>15</day><month>5</month><year>2018</year>
</date>
<date date-type="accepted">
<day>15</day><month>5</month><year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="322974.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Ant colonies regulate activity in response to changing conditions without using centralized control. Harvester ant colonies forage in the desert for seeds, and their regulation of foraging manages a tradeoff between spending and obtaining water. Foragers lose water while outside in the dry air, but the colony obtains water by metabolizing the fats in the seeds they eat. Previous work shows that the rate at which an outgoing forager leaves the nest depends on its recent experience of brief antennal contact with returning foragers that carry a seed. We examine how this process can yield foraging rates that are robust to uncertainty and responsive to temperature and humidity across minutes to hour-long timescales. To explore possible mechanisms, we develop a low-dimensional analytical model with a small number of parameters that captures observed foraging behavior. The model uses excitability dynamics to represent response to interactions inside the nest and a random delay distribution to represent foraging time outside the nest. We show how feedback of outgoing foragers returning to the nest stabilizes the incoming and outgoing foraging rates to a common value determined by the &#x201C;volatility&#x201D; of available foragers. The model exhibits a critical volatility above which there is sustained foraging at a constant rate and below which there is cessation of foraging. To explain how the foraging rates of colonies adjust to temperature and humidity, we propose a mechanism that relies on foragers modifying their volatility after they leave the nest and get exposed to the environment. Our study highlights the importance of feedback in the regulation of foraging activity and points to modulation of volatility as a key to explaining differences in foraging activity in response to conditions and across colonies. Our results present opportunities for generalization to other contexts and systems with excitability and feedback across multiple timescales.</p>
<sec>
<title>Author Summary</title>
<p>We investigate the collective behavior that allows colonies of desert harvester ants to regulate foraging activity in response to environmental conditions. We develop an analytical model connecting three processes: 1) the interactions between foragers returning to the nest and available foragers waiting inside the nest, 2) the effect of these interactions on the likelihood of available foragers to leave the nest to forage, and 3) the return of foragers to the nest after finding seeds. We propose a mechanism in which available foragers modify their response to interactions after their first exposure to the environment. We show how this leads to colony foraging rates that adjust to environmental conditions over time scales from minutes to hours. Our model may prove useful for studying resilience in other classes of systems with excitatory dynamics.</p>
</sec>
</abstract>
<counts>
<page-count count="38"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Social insect colonies operate without central control. Colonies maintain coherence and plasticity in the face of perturbation and change, even though individuals have limited and uncertain information on the state of the group and the state of the environment. Collective behaviors are understood to emerge from response of individuals to social interactions and measurements of the local environment [<xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c4">4</xref>]. The study of social insects provides opportunities to investigate open, fundamental questions on how collective behavior adjusts to different conditions and how small differences in these adjustments can lead to large differences in behavior across groups.</p>
<p>The regulation of foraging activity in colonies of the harvester ant (<italic>Pogonomyrmex Barbatus</italic>) is a well-studied example of collective behavior [<xref ref-type="bibr" rid="c5">5</xref>]. Harvester ants live in the hot and dry Southwestern US desert where they forage for seeds scattered by wind and flooding. Foragers do not use pheromone trails; instead, they spread out across selected foraging areas in search of seeds [<xref ref-type="bibr" rid="c6">6</xref>]. The regulation of foraging activity manages a tradeoff between spending and obtaining water: foragers lose water while outside in the dry air, but colonies obtain water by metabolizing the fats in the seeds that they eat [<xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>].</p>
<p>Harvester ant colonies regulate the rate at which foragers leave the nest using the incoming rate of successful foragers returning with food [<xref ref-type="bibr" rid="c9">9</xref>&#x2013;<xref ref-type="bibr" rid="c13">13</xref>]. When an ant contacts another ant with its antennae, it perceives the other ant&#x2019;s cuticular hydrocarbon (CHC) profile [<xref ref-type="bibr" rid="c9">9</xref>]. Because conditions outside the nest change the chemistry of the cuticular hydrocarbons, CHC profiles are task-specific [<xref ref-type="bibr" rid="c14">14</xref>]. In the course of antennal contact, one ant can detect whether another is a forager. An available forager, waiting in the entrance chamber inside the nest, is stimulated to leave the nest by antennal contact with foragers carrying food [<xref ref-type="bibr" rid="c11">11</xref>&#x2013;<xref ref-type="bibr" rid="c13">13</xref>]. Because each forager searches until it finds a seed, the rate of interaction serves as a noisy measurement of the current foraging conditions [<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c15">15</xref>]. A higher rate of forager return, which reflects a greater food supply, increases the likelihood that available foragers will leave the nest to forage [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c16">16</xref>].</p>
<p>In the integrator model of [<xref ref-type="bibr" rid="c13">13</xref>], each available forager inside the nest collects evidence from incoming foragers by integrating its recent experience of antennal contacts. When the integrated stimulus passes a threshold, the available forager is likely to leave the nest; in the absence of interactions the forager is likely to descend from the entrance chamber to the deeper nest [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c16">16</xref>], protecting the colony from the inherently noisy signal that results from limited and uncertain interactions [<xref ref-type="bibr" rid="c17">17</xref>]. The integrator model has been used to study regulation of the outgoing foraging rate on short timescales [<xref ref-type="bibr" rid="c15">15</xref>].</p>
<p>Colonies regulate their foraging activity on longer timescales, such as from hour to hour, from day to day [<xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c19">19</xref>], and across years [<xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c21">21</xref>] as colonies grow older and larger. Over timescales from tens of minutes to hours, ants that start as available foragers inside the nest leave the nest to forage, find seeds, return to the nest, and become available foragers again. Thus, the activation of available foragers inside the nest through interactions with incoming foragers is connected in a &#x201C;closed loop&#x201D; to the foraging activity outside the nest through feedback of the ants themselves: the stream of foraging ants out of the nest is the input to the foraging activity, and the output of the foraging activity is the stream of foraging ants into the nest (see <xref ref-type="fig" rid="fig1">Fig. 1</xref>). However, little is known about the role of feedback in the regulation of foraging activity at the timescale of hours and as foraging activity is adjusted to changing environmental conditions. By mid-day in the summer, temperature is high and humidity is low (<xref ref-type="fig" rid="figS1">Fig.S1</xref>). Foraging activity increases from its start in early morning, often levels off and declines to no activity during the heat of the afternoon.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><p>Diagram of the closed-loop model with two components inside the nest and one component outside the nest. The &#x201C;Interactions&#x201D; component maps the sequence of incoming foragers &#x03BB;<sub><italic>in</italic></sub> to a stimulus <italic>s</italic> to represent the result of interactions of available foragers inside the nest entrance chamber with returning food-bearing foragers. The mapping uses a leaky integrator that increases by a fixed magnitude with every incoming forager and has a natural decay rate. The &#x201C;Response of available foragers&#x201D; component maps <italic>s</italic> to the sequence of outgoing foragers &#x03BB;<sub><italic>out</italic></sub> using the nonlinear FN oscillator dynamics. Each oscillation represents an ant leaving the nest to forage. The &#x201C;Foraging&#x201D; component maps &#x03BB;<sub><italic>out</italic></sub> to &#x03BB;<sub><italic>in</italic></sub> using a random time delay with an associated probability distribution to represent the time an ant spends outside the nest foraging.</p></caption>
<graphic xlink:href="322974_fig1.tif"/>
</fig>
<p>How a colony regulates foraging in response to environmental conditions, especially temperature and humidity, is ecologically important. Colonies live for 20-30 years. At about five years of age a colony begins to produce reproductives that mate and found offspring colonies [<xref ref-type="bibr" rid="c22">22</xref>]. Colonies differ in the regulation of foraging and these differences persist from year to year, including variation in how often colonies are active [<xref ref-type="bibr" rid="c18">18</xref>] and in how they respond to changing temperature and humidity conditions [<xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c21">21</xref>]. How a colony adjusts foraging activity to low humidity and high temperature is crucial for reproductive success: colonies that conserve water are more likely to have offspring colonies [<xref ref-type="bibr" rid="c5">5</xref>]. Here we model how colonies adjust to environmental conditions, to provide insight into the ecologically important variation among colonies that underlies the evolution of collective behavior.</p>
<p>Previous modeling work has elucidated how the outgoing foraging rate depends on the incoming foraging rate [<xref ref-type="bibr" rid="c15">15</xref>], and how individuals assess interaction rate [<xref ref-type="bibr" rid="c13">13</xref>]. But we do not know how these are combined to adjust foraging activity across minutes to hours-long timescales, how the adjustments may depend on environmental conditions, or how they may differ from colony to colony.</p>
<p>Here we propose a closed-loop model (<xref ref-type="fig" rid="fig1">Fig. 1</xref>) to address these questions by examining how a returning forager&#x2019;s assessment of external conditions provides additional feedback to the colony and in turn adjusts the colony foraging rate. Our model is motivated in part by the frequent use of excitability dynamics to model neurons, and the parallels between ant-to-ant interactions that drive foraging and neuron-to-neuron interactions that underlie the cognitive abilities of organisms [<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c23">23</xref>&#x2013;<xref ref-type="bibr" rid="c24">24</xref><xref ref-type="bibr" rid="c25">25</xref> <xref ref-type="bibr" rid="c26">26</xref>]. Using well-studied excitability dynamics of a weakly interacting collective, we introduce feedback at multiple time-scales and explore general questions concerning stability and responsiveness to a changing environment.</p>
<p>Drawing on theory and tools from dynamical and control systems, we study how the incoming and outgoing foraging rates adjust with time at timescales much longer than previously considered [<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c15">15</xref>]. We ask how the rates can stably approach a common value even in the presence of disturbance, how adjustments and stability of rates differ under various foraging conditions, and how sensitivities to parameters may explain differences in foraging behavior across colonies.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Field Observations of Foraging Activity</title>
<p>We performed field observations of red harvester ant colonies at the site of a long term study near Rodeo, New Mexico, USA. Observations were made in August and September of 2015, 2016, and 2017. Foragers leave the nest in streams or trails that can extend up to 20 m from the nest [<xref ref-type="bibr" rid="c27">27</xref>]. Each forager leaves the trail to search for seeds, and once it finds food, it returns to the nest [<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c27">27</xref>]. Data on foraging rates were recorded from the beginning of the foraging period in early morning until around noon. We recorded the times at which foragers crossed a line perpendicular to the trail at a distance of about 1 m from the nest entrance, as in previous work (e.g. [<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c28">28</xref>]). The timestamps for each forager crossing the line were recorded either manually in real-time with the assistance of an electronic tablet and custom software, or from video recordings, processed with computer vision software (AnTracks Computer Vision Systems, Mountain View, CA). In some cases we used both tablet and video to ensure that both data collection methods provided similar results.</p>
<p>We denote by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline1.gif"/></alternatives></inline-formula>, <italic>i</italic> &#x2208; &#x2115;, the sequence of times incoming foragers cross the line and by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline2.gif"/></alternatives></inline-formula>, <italic>j</italic> &#x2208; &#x2115;, the sequence of times outgoing foragers cross the line. Sequences of incoming and outgoing foragers are represented as sums of infinitesimally narrow, idealized spikes in the form of Dirac-delta functions:
<disp-formula id="eqn1"><alternatives><graphic xlink:href="322974_eqn1.gif"/></alternatives></disp-formula>
where <italic>n</italic> and <italic>m</italic> are the indices of the last incoming and outgoing forager, respectively, before time <italic>t</italic>. We estimated the instantaneous incoming and outgoing foraging rates, in units of ants/sec, using a sliding window filter with window &#x0394;<italic>t</italic> &#x003D; 300 sec:
<disp-formula id="eqn2"><alternatives><graphic xlink:href="322974_eqn2.gif"/></alternatives></disp-formula>
where
<disp-formula id="eqn3"><alternatives><graphic xlink:href="322974_eqn3.gif"/></alternatives></disp-formula>
</p>
</sec>
<sec id="s3">
<title>Model</title>
<p>We propose a low-dimensional model with a small number of parameters that has sufficiently rich dynamics to capture the range of observed foraging behavior across minute to hour-long timescales and yet retains tractability for analysis. We use the model to systematically investigate the effects of model parameters and environmental conditions, notably temperature and humidity, on foraging rates.</p>
<p>Our model has three components as shown in <xref ref-type="fig" rid="fig1">Fig. 1</xref>: 1) the <italic>Interactions</italic> component models the accumulation of evidence by available foragers inside the nest entrance chamber from their interactions with incoming foragers carrying food, 2) the <italic>Response of available foragers</italic> component models the activation of available foragers to leave the nest to forage in response to accumulated evidence, and 3) the <italic>Foraging</italic> component models the collecting of seeds outside the nest by active foragers. We assume the total number of foragers <italic>N</italic> (active foragers outside the nest plus available foragers inside the nest) remains constant throughout the foraging day, although this assumption can be relaxed in a generalization of the model.</p>
<sec id="s3a">
<title>Interactions</title>
<p>We use leaky-integrator dynamics to model the stimuli <italic>s</italic> that the group of available foragers inside the nest entrance chamber experience from their interactions with returning food-bearing foragers:
<disp-formula id="eqn4"><alternatives><graphic xlink:href="322974_eqn4.gif"/></alternatives></disp-formula>.</p>
<p>The continuous-time signal <italic>s</italic> increases by a fixed amount <italic>k</italic> with every incoming forager in &#x03BB;<sub><italic>in</italic></sub> and decays exponentially back to zero with a time constant of &#x03C4;.</p>
<p>The leaky-integrator dynamics work as an evidence accumulator that gradually forgets past evidence. These dynamics have been used to model chemical synapses [<xref ref-type="bibr" rid="c29">29</xref>] and have been used as the integrate-and-fire neuronal model when there is no reset boundary [<xref ref-type="bibr" rid="c30">30</xref>&#x2013;<xref ref-type="bibr" rid="c32">32</xref>].</p>
</sec>
<sec id="s3b">
<title>Response of Available Foragers</title>
<p>We first consider a homogeneous colony and model the scalar activation state <italic>&#x03C5;</italic> of available foragers in the nest entrance chamber as the fast timescale variable in the FitzHugh-Nagumo (FN) equations [<xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c34">34</xref>] often used to model neuronal excitability:
<disp-formula id="eqn5"><alternatives><graphic xlink:href="322974_eqn5.gif"/></alternatives></disp-formula>
<disp-formula id="eqn6"><alternatives><graphic xlink:href="322974_eqn6.gif"/></alternatives></disp-formula>.</p>
<p>The FN equations describe nonlinear oscillator dynamics with the stimulus <italic>s</italic> of <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> as the input. Oscillations result from a balance between positive feedback in <italic>&#x03C5;</italic> (first term on the right of <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>) and negative feedback in the slow timescale variable <italic>u</italic>. We refer to the parameter <italic>c</italic>, which scales the negative feedback and modulates the frequency of oscillations, as the <italic>volatility</italic> of the available foragers. The parameter <italic>&#x03F5;</italic><sub>2</sub> defines the time separation between the dynamics of the fast and slow states, and the parameter <italic>&#x03F5;</italic><sub>1</sub> defines the time separation between the FN dynamics and the stimulus dynamics (<xref ref-type="disp-formula" rid="eqn4">4</xref>). The constant 0.35 is chosen so that the threshold input required to elicit oscillations is lower than <italic>k</italic>, the magnitude by which <italic>s</italic> increases with every incoming forager.</p>
<p>The activation dynamics (<xref ref-type="disp-formula" rid="eqn5">Eqs. (5)</xref> and (6)) of the available foragers yield three qualitatively distinct dynamical regimes, determined by the magnitude of input <italic>s</italic>. In the first regime, the system remains in a <italic>resting</italic> state for low values of <italic>s</italic>. This reflects the situation in which there are In the second regime, which takes place when <italic>s</italic> &#x2265; <italic>b</italic><sub>1</sub> &#x003E; 0, the system is in an excited state with relaxation oscillations in <italic>&#x03C5;</italic>. This reflects the situation in which incoming foragers are sufficiently frequent to stimulate the available foragers. The transition from resting to oscillatory behavior as <italic>s</italic> increases corresponds to a Hopf bifurcation and <italic>b</italic><sub>1</sub> is the corresponding bifurcation point. The oscillations appear as short-lived spikes, and we define each spike for which <italic>&#x03C5;</italic> increases above 0.75 as a forager leaving the nest. The shortest possible time between foragers leaving the nest is determined by the volatility <italic>c</italic> (see SI Appendix 1).</p>
<p>In the third regime, corresponding to very large values of <italic>s</italic> &#x2265; <italic>b</italic><sub>2</sub> &#x003E; <italic>b</italic><sub>1</sub>, there are no oscillations and the system is fixed in a <italic>saturation</italic> state. The transition from oscillatory to saturated regime is a second Hopf bifurcation with bifurcation point <italic>b</italic><sub>2</sub>. We associate the saturated state of the FN model with conditions under which high instantaneous incoming rates lead to a decrease in the instantaneous outgoing rate. These conditions include 1) overcrowding effects, which reduce the percentage of interactions experienced by each available forager relative to the incoming foraging rate, 2) the limited size of the nest entrance tunnel, which constrains how many foragers can enter and leave the nest in a short amount of time, and 3) the difference in timescales between the high outgoing rates, in seconds, and the time required, in minutes, for foragers to move from the deeper chambers of the nest up to the entrance chamber [<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c16">16</xref>].</p>
</sec>
<sec id="s3c">
<title>Foraging</title>
<p>We treat the process of foraging for seeds outside the nest as a random time delay. We model the interval between the time that a forager leaves the nest and the time when it returns with food as a chi-square random variable <italic>X</italic>, with parameter <italic>D</italic> representing the mean foraging time in minutes. The distribution of foraging times <italic>F</italic>(<italic>X</italic>, <italic>D</italic>) is
<disp-formula id="eqn7"><alternatives><graphic xlink:href="322974_eqn7.gif"/></alternatives></disp-formula>
where &#x0393;(<italic>X</italic>) and &#x0393;(<italic>a</italic>, <italic>X</italic>) are the Gamma function and the upper incomplete Gamma function, respectively. This right-skewed distribution is based on field observations of the duration of foraging trips, measured as the total time elapsed from when a forager leaves the nest to when it returns with food [<xref ref-type="bibr" rid="c6">6</xref>]. For <italic>D</italic> &#x003D; 2, <italic>F</italic>(<italic>X</italic>, 2) &#x003D; 1 &#x2013; <italic>e</italic><sup>&#x2212;<italic>X</italic>/2</sup>.</p>
<p>Our model for the foraging process is equivalent to a queueing system [<xref ref-type="bibr" rid="c35">35</xref>] in which arriving customers, represented by outgoing foragers &#x03BB;<sub><italic>out</italic></sub>, that find a seed after a given random service time. The number of servers in the foraging process queue is assumed to be infinite because foragers do not need to wait before they start looking for a seed (i.e., before receiving the service).</p>
</sec>
<sec id="s3d">
<title>Proposed Mechanism for Response to Environmental Conditions</title>
<p>We propose a mechanism for colony response to environmental conditions, illustrated in <xref ref-type="fig" rid="fig2">Fig. 2</xref>, in which the volatility of a forager changes after it has been on a foraging trip and exposed to the conditions outside the nest. The proposed mechanism is based on measurements showing that the temperature and humidity inside the nest remain constant throughout the foraging activity period (see <xref ref-type="fig" rid="figS1">Fig. S1</xref>). This means that foragers have no information about conditions outside until they leave the nest.</p>
<p>As a first approximation, the model changes the volatility of each forager after it leaves the nest to forage for the first time. Available foragers that have not yet been outside the nest, and are therefore uninformed about the current temperature and humidity outside the nest, have volatility <italic>c</italic><sub><italic>u</italic></sub>. Available foragers that have been outside at least once to forage, and are therefore informed about the current temperature and humidity, have volatility <italic>c</italic><sub><italic>i</italic></sub>. The values of <italic>c</italic><sub><italic>u</italic></sub> and <italic>c</italic><sub><italic>i</italic></sub> can be any positive real numbers, and these values, which represent an average uninformed and an average informed available forager in the colony, respectively, can vary across colonies and across days. Further, <italic>c</italic><sub><italic>i</italic></sub> is introduced explicitly to depend on conditions such as humidity and temperature outside the nest. For example, the hotter and drier it is outside, the smaller the <italic>c</italic><sub><italic>i</italic></sub>, and the foragers become less volatile and thus less likely to make subsequent foraging trips. The cooler and more humid it is outside, the larger the <italic>c</italic><sub><italic>i</italic></sub>, and the foragers become more volatile and thus more likely to make subsequent foraging trips.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><p>Block diagram of proposed mechanism for response of colony to environmental conditions. The available foragers inside the nest comprise two sets: <italic>f</italic><sub><italic>u</italic></sub> corresponds to those that have not yet left the nest and so are uninformed about the conditions outside the nest, and <italic>f</italic><sub><italic>i</italic></sub> corresponds to those informed during a previous foraging trip. The response of each set to <italic>s</italic> is represented by a different FN model, distinguished by the volatility parameter <italic>c</italic><sub><italic>u</italic></sub> for the uninformed and <italic>c</italic><sub><italic>i</italic></sub> for the informed. The outputs of these two oscillator dynamics are weighted probabilistically using thinning to get an outgoing stream of foragers &#x03BB;<sub><italic>out</italic></sub>(<italic>t</italic>).</p></caption>
<graphic xlink:href="322974_fig2.tif"/>
</fig>
<p>Let <italic>f</italic><sub><italic>u</italic></sub> be the set of <italic>n</italic><sub><italic>u</italic></sub> <italic>uninformed</italic> available foragers that have not yet left the nest during the day and thus have no information about the environmental conditions and <italic>f</italic><sub><italic>i</italic></sub> the set of <italic>n</italic><sub><italic>i</italic></sub> <italic>informed</italic> available foragers that have been exposed to the environmental conditions during one or more previous foraging trips that day. We assume that once a forager becomes informed, it remains informed for the rest of the foraging day. The ants in <italic>f</italic><sub><italic>u</italic></sub> have volatility <italic>c</italic><sub><italic>u</italic></sub> and the ants in <italic>f</italic><sub><italic>i</italic></sub> have volatility <italic>c</italic><sub><italic>i</italic></sub>. Let <italic>x</italic><sub><italic>u</italic></sub> &#x003D; <italic>n</italic><sub><italic>u</italic></sub>/(<italic>n</italic><sub><italic>u</italic></sub> &#x002B; <italic>n</italic><sub><italic>i</italic></sub>) and <italic>x</italic><sub><italic>i</italic></sub> &#x003D; <italic>n</italic><sub><italic>i</italic></sub>/(<italic>n</italic><sub><italic>u</italic></sub> &#x002B; <italic>n</italic><sub><italic>i</italic></sub>) be the fraction of available foragers that are uninformed and informed, respectively, where we assume that <italic>n</italic><sub><italic>u</italic></sub> &#x002B; <italic>n</italic><sub><italic>i</italic></sub> &#x003E; 0. Then <italic>x</italic><sub><italic>u</italic></sub> &#x002B; <italic>x</italic><sub><italic>i</italic></sub> &#x003D; 1.</p>
<p>Initially, <italic>x</italic><sub><italic>i</italic></sub> &#x003D; 0 and the colony is completely uninformed (<italic>x</italic><sub><italic>u</italic></sub> &#x003D; 1). As foragers return to the nest after their first trip, <italic>x</italic><sub><italic>i</italic></sub> begins to increase and can continue to increase until <italic>x</italic><sub><italic>i</italic></sub> &#x003D; 1 (<italic>x</italic><sub><italic>u</italic></sub> &#x003D; 0), when all <italic>N</italic> foragers have been outside the nest at least once. How many minutes (or hours) it takes for <italic>x</italic><sub><italic>i</italic></sub> to transition from 0 to 1 depends on <italic>N</italic>, <italic>D</italic>, and the changing foraging rates. To model the changing foraging rates, we use two sets of FN oscillator dynamics: one to represent the response to <italic>s</italic> of the uninformed ants in <italic>f</italic><sub><italic>u</italic></sub> with volatility <italic>c</italic><sub><italic>u</italic></sub> and a second to represent the response to <italic>s</italic> of informed ants in <italic>f</italic><sub><italic>i</italic></sub> with volatility <italic>c</italic><sub><italic>i</italic></sub>. Let the corresponding sequences of output from the two oscillator dynamics be &#x03BB;<italic>f</italic><sub><italic>i</italic></sub> and &#x03BB;<italic>f</italic><sub><italic>u</italic></sub>, respectively. We define the sequence of outgoing foragers &#x03BB;<sub><italic>out</italic></sub> as a probabilistic sum of &#x03BB;<sub><italic>i</italic></sub> and &#x03BB;<sub><italic>u</italic></sub>, using a method called <italic>thinning</italic> [<xref ref-type="bibr" rid="c36">36</xref>]: Every event in &#x03BB;<sub><italic>i</italic></sub> is kept in &#x03BB;<sub><italic>out</italic></sub> with probability <italic>x</italic><sub><italic>i</italic></sub>, and every event in &#x03BB;<sub><italic>u</italic></sub> is kept in &#x03BB;<sub><italic>out</italic></sub> with probability 1 &#x2013; <italic>x</italic><sub><italic>i</italic></sub>. When <italic>x</italic><sub><italic>i</italic></sub> &#x003D; 0 the foraging rate is determined by <italic>c</italic><sub><italic>u</italic></sub>, and when <italic>x</italic><sub><italic>i</italic></sub> &#x003D; 1 the foraging rate is determined by <italic>c</italic><sub><italic>i</italic></sub>. When 0 &#x003C; <italic>x</italic><sub><italic>i</italic></sub> &#x003C; 1, the effective <italic>c</italic> will be a nonlinear combination of <italic>c</italic><sub><italic>u</italic></sub> and <italic>c</italic><sub><italic>i</italic></sub>. The higher the effective <italic>c</italic>, the higher the outgoing foraging rate.</p>
<p>Here foragers adjust their volatility only once after their first foraging trip outside. We find that even with this adjustment at first exposure, the model provides the range of foraging behavior observed. However, the model can be generalized and predictions refined by allowing for adjustments on subsequent foraging trips, and by allowing for other kinds of adjustments. For example, more than two sets of available foragers with different values of volatility can be used to model effects of repeated exposures to the environment, changing conditions on successive trips, or decay of information about the external environment over time. A decrease in <italic>N</italic> (total number of foragers outside and available inside the nest) can be used to model active foragers that return to the deeper nest after exposure to hot and dry outside conditions [<xref ref-type="bibr" rid="c12">12</xref>].</p>
</sec>
</sec>
<sec id="s4">
<title>Results</title>
<sec id="s4a">
<title>Observations of Regulation of Foraging in Red Harvester Ants</title>
<p>Observations of instantaneous foraging rates computed from the 2015, 2016, and 2017 data show that across colonies and days, the incoming and outgoing foraging rates <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) and <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>), where <italic>t</italic> is time of day, undergo a transient early in the foraging period followed by an equilibration to a near-equal value, i.e., <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) &#x2248; <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>), during the middle part of the foraging period.</p>
<p>The equilibration of the incoming and outgoing foraging rates to a near-equal value lasts for intervals from tens of minutes to several hours, and so we refer to it as a quasi steady-state (QSS). We show the data for two colonies in <xref ref-type="fig" rid="fig3">Fig. 3</xref>. We plot the incoming rate <italic>r</italic><sub><italic>in</italic></sub> (blue) and the outgoing rate <italic>r</italic><sub><italic>out</italic></sub> (red) computed from the data for Colony 1357 (<xref ref-type="fig" rid="fig3">Fig. 3A</xref>) and Colony 1317 (<xref ref-type="fig" rid="fig3">Fig. 3B</xref>) versus time of day on August 20, 2016. For Colony 1357, the rates equilibrate to a near-equal value early in the day, i.e., between 8:00 and 8:30 am. This is followed by a couple of dynamic adjustments, but then by 9:30 am until just before noon, when all the ants returned to the nest, the incoming and outgoing rates were very closely equilibrated at a QSS rate of around 0.25 ants/sec. Colony 1317 also was observed to reach a QSS. Its incoming and outgoing rates equilibrate to a near equal value shortly after 10:00 am, which lasts until just before noon, when all the ants return to the nest. Colonies vary greatly in foraging rate [<xref ref-type="bibr" rid="c21">21</xref>], and that was true of these two as well. For Colony 1317, the QSS rate is approximately 0. 65 ants/sec, more than twice the QSS rate for Colony 1357 on the same day.</p>
<p>We show data for two other colonies in <xref ref-type="fig" rid="fig4">Fig. 4</xref>. <xref ref-type="fig" rid="fig4">Fig. 4A</xref> and C show <italic>r</italic><sub><italic>in</italic></sub> (blue) and <italic>r</italic><sub><italic>out</italic></sub> (red) versus time of day for a single colony, Colony 664, on two different days: August 27, 2015 and August 31, 2015. In each plot, the rates can be seen to come to a near-equal value sometime after 10:30 am. We plot in green the difference between number of incoming and number of outgoing foragers versus the time of day. The rates are at a QSS when the green curve is approximately horizontal. These data show, as has been observed previously [<xref ref-type="bibr" rid="c37">37</xref>], that a given colony varies in foraging rate from day to day, demonstrating that foraging is regulated by processes other than the number of available foragers. From <xref ref-type="fig" rid="fig4">Fig. 4A</xref> and C it can be seen that Colony 664 reaches a QSS rate on August 27, 2015 that is more than twice the QSS rate it reaches on August 27, 2015. We note that August 27, 2015 was slightly cooler and more humid than August 31, 2015. On August 27 the average temperature and humidity were 25.3 C and 58&#x0025; while on August 31 they were 26.8 C and 53&#x0025;. Moreover, at 11am on August 27, they were 27.5 C and 52&#x0025; while at 11am on August 31, they were 28.8 C and 45&#x0025;. <xref ref-type="fig" rid="fig4">Fig. 4E</xref> shows the data for Colony 863 on September 1, 2015, which were recorded manually. No QSS is observed, i.e., the ants go out but then return to the nest by 11:00 am without maintaining a steady-state of foragers outside of the nest. Colony 863 did reach a QSS at a reasonably high foraging rate at 11:00 am on September 5, 2015 (see <xref ref-type="fig" rid="figS2">Fig. S2A</xref>). These observations are consistent with measurements showing that September 1, 2015 was much hotter and drier than September 5, 2015. On September 1 the average temperature and humidity were 25.2 C and 53&#x0025; while on September 5 they were 22.6 C and 77&#x0025;. See <xref ref-type="table" rid="tblS1">Table S1</xref> of the SI for more details.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><p>Plots of incoming foraging rate <italic>r</italic><sub><italic>in</italic></sub> (blue) and outgoing foraging rate <italic>r</italic><sub><italic>out</italic></sub> (red) versus time of day on August 20, 2016 for A) Colony 1357 and B) Colony 1317. The quasi steady-state (QSS) where incoming and outgoing rates equilibrate to a near-equal value can be observed for both colonies. The QSS rate for Colony 1317 is more than twice as great as it is for Colony 1357.</p></caption>
<graphic xlink:href="322974_fig3.tif"/>
</fig>
<p><xref ref-type="fig" rid="fig3">Fig. 3</xref> and <xref ref-type="fig" rid="fig4">Fig. 4</xref> are representative of observations that suggest the equilibration of incoming and outgoing foraging rates to a near-equal rate to be an important feature in the regulation of foraging in red harvester ant colonies. Further, the equilibrated rate, and the possibility of early cessation of foraging, depend on factors that differ among colonies (<xref ref-type="fig" rid="fig3">Fig. 3</xref>) and from day to day (<xref ref-type="fig" rid="fig4">Fig. 4</xref>). We examine the transient in foraging rates further in <xref ref-type="fig" rid="fig4">Fig. 4</xref>. Early in the foraging day, both <italic>r</italic><sub><italic>in</italic></sub> and <italic>r</italic><sub><italic>out</italic></sub> increase rapidly with <italic>r</italic><sub><italic>out</italic></sub> increasing more rapidly than <italic>r</italic><sub><italic>in</italic></sub>. This leads to a rapid increase in the number of active foragers outside the nest. The rapid increase in both rates is followed by a decrease in <italic>r</italic><sub><italic>out</italic></sub> to the equilibrated near-equal value of the QSS (<xref ref-type="fig" rid="fig4">Fig. 4A</xref> and C) or to an early return of the ants to the nest (<xref ref-type="fig" rid="fig4">Fig. 4E</xref>).</p>
<p>Input-output plots show the relation between incoming and outgoing foraging rates <xref ref-type="fig" rid="fig4">Fig. 4B, D</xref>, and F. These figures show the same data as <xref ref-type="fig" rid="fig4">Fig. 4A, C</xref>, and E, respectively, but plot <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) versus <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) with time of day <italic>t</italic> in hours indicated by the color scale. The transient in rates during the early part of the foraging day appear as curved trajectories above the diagonal, because <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) is typically higher than <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>). In <xref ref-type="fig" rid="fig4">Fig. 4B</xref> and D, the curve rises and then falls to the QSS value where the trajectory then equilibrates around a point on the diagonal corresponding to equal incoming and outgoing rates. This rise and fall of the curve in the input-output plot is typical, even when the trajectory returns to the origin as in the case of <xref ref-type="fig" rid="fig4">Fig. 4F</xref>.</p>
<p>The data shown in <xref ref-type="fig" rid="fig3">Figs 3</xref> and 4 as well as in <xref ref-type="fig" rid="figS2">Fig. S2</xref> are representative of the data collected in 2015, 2016, and 2017. Temperature and humidity for these data sets are given in <xref ref-type="table" rid="tblS1">Table S1</xref> of the SI. <xref ref-type="fig" rid="figS2">Fig. S2B</xref> shows another example of a very early cessation of foraging. <xref ref-type="fig" rid="figS2">Fig. S2C</xref> and D show two different examples of long transients. <xref ref-type="fig" rid="figS2">Fig. S2E</xref> and F show two examples of a burst in the outgoing foraging rate at the start of the foraging day. See SI Appendix 2 for details.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><p>Plots of foraging rate data. Time series plots show incoming foraging rate <italic>r</italic><sub><italic>in</italic></sub> (blue), outgoing foraging rate <italic>r</italic><sub><italic>out</italic></sub> (red), and difference between the number of incoming and outgoing foragers (green) versus time of day. Input-output plots show <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) versus <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) with the color scale representing time of day <italic>t</italic>. A) and B) Colony 664 on August 27, 2015. C) and D) Colony 664 on August 31, 2015. E) and F) Colony 863 on September 1, 2015.</p></caption>
<graphic xlink:href="322974_fig4.tif"/>
</fig>
</sec>
</sec>
<sec id="s5">
<title>Model Dynamics</title>
<sec id="s5a">
<title>Foraging Dynamics Inside the Nest</title>
<p>Given a sequence of incoming ants &#x03BB;<sub><italic>in</italic></sub>, our open-loop model of foraging dynamics inside the nest (<xref ref-type="fig" rid="fig1">Fig. 1</xref>) predicts a corresponding sequence of outgoing ants &#x03BB;<sub><italic>out</italic></sub>. We find an analytic approximation for the mapping from mean incoming foraging rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline3.gif"/></alternatives></inline-formula> to mean outgoing foraging rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline4.gif"/></alternatives></inline-formula>, parametrized by volatility <italic>c</italic>. To do so, we assume &#x03BB;<sub><italic>in</italic></sub> is a Poisson process with (constant) mean incoming rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline5.gif"/></alternatives></inline-formula>; this is justified for observations of incoming and outgoing sequences of foragers for short periods of time [<xref ref-type="bibr" rid="c15">15</xref>].</p>
<p>We assign model parameter values to be <italic>k</italic> &#x003D; 0.3, &#x03C4; &#x003D; 0.41, <italic>&#x03F5;</italic><sub>1</sub> &#x003D; 0.2, and <italic>&#x03F5;</italic><sub>2</sub> &#x003D; 0.05, which allow for rich dynamical behavior. While the qualitative behavior is unchanged for different values of <italic>&#x03F5;</italic><sub>2</sub> &#x226A; 1, very high or low values of <italic>k</italic> and/or &#x03C4; yield dynamics in which the stimulus <italic>s</italic> is either too low or too high to produce oscillations. So the values for <italic>k</italic> and &#x03C4; are selected to balance their opposing effects on <italic>s</italic>.</p>
<p>For very low <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline6.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline7.gif"/></alternatives></inline-formula> is low because <italic>s</italic> is low and the FN system remains in the resting state with occasional short-lasting periods of oscillatory behavior (<xref ref-type="fig" rid="figS3">Fig. S3</xref>). For very high <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline8.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline9.gif"/></alternatives></inline-formula> is also low because <italic>s</italic> is high and the FN system remains most of the time in the saturated state. In contrast, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline10.gif"/></alternatives></inline-formula> is high for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline11.gif"/></alternatives></inline-formula> that yields an <italic>s</italic> that keeps the FN system inside the oscillating region. In the oscillating region, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline12.gif"/></alternatives></inline-formula> is equal to the frequency of the oscillations, which is inversely proportional to the volatility <italic>c</italic> as we show in SI Appendix 1. The oscillating region is given by the range of <italic>s</italic> between the FN bifurcation points <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>2</sub>, computed as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline13.gif"/></alternatives></inline-formula>. As the volatility <italic>c</italic> increases, the size of the oscillating region decreases (<xref ref-type="fig" rid="figS4">Fig S4</xref>).</p>
<p>To get an expression for the natural frequency of the oscillations in the FN, we compute an asymptotic approximation for its period <italic>T</italic><sub><italic>LC</italic></sub>(<italic>s</italic>, <italic>c</italic>) as <italic>&#x03F5;</italic><sub>2</sub> goes to zero, see SI Appendix 1 and <xref ref-type="fig" rid="figS5">Fig. S5</xref>. Under the assumption of a Poisson incoming rate, the process <italic>s</italic> is ergodic (see SI Appendix 3). Thus, over sufficiently long periods of time, suitable time statistics converge to ensemble statistics, allowing us to approximate the fraction of time that <italic>s</italic> spends in the oscillating region using <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline14.gif"/></alternatives></inline-formula>, the probability density function of <italic>s</italic> at steady-state. We compute <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline15.gif"/></alternatives></inline-formula> in SI Appendix 4 as a piecewise function where the piecewise elements satisfy recurrence equations and depend on <italic>k</italic> and &#x03C4;. From this we can construct an analytical expression for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline16.gif"/></alternatives></inline-formula> as a function of both <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline17.gif"/></alternatives></inline-formula> and <italic>c</italic> (see SI Appendix 3):
<disp-formula id="eqn8"><alternatives><graphic xlink:href="322974_eqn8.gif"/></alternatives></disp-formula>.</p>
<p>In <xref ref-type="fig" rid="fig5">Fig. 5A</xref> we plot <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline18.gif"/></alternatives></inline-formula> versus <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline19.gif"/></alternatives></inline-formula> using <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> for different values of <italic>c</italic>. The resulting open-loop input-output curves, which we call <italic>nest I/O curves</italic> show that the analytic mapping from <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline20.gif"/></alternatives></inline-formula> to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline21.gif"/></alternatives></inline-formula> depends nonlinearly on <italic>c</italic>. The increasing steepness of the curve at low <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline22.gif"/></alternatives></inline-formula> becomes more pronounced for higher <italic>c</italic> because the frequency of oscillations is proportional to <italic>c</italic>. Similarly, the decreasing steepness of the curves for high <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline53.gif"/></alternatives></inline-formula> also becomes more pronounced for higher <italic>c</italic>. This is because as <italic>c</italic> increases <italic>b</italic><sub>2</sub> decreases, causing the FN to saturate at lower <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline23.gif"/></alternatives></inline-formula> values. The maximum value of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline24.gif"/></alternatives></inline-formula> takes place at the <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline25.gif"/></alternatives></inline-formula> that yields an <italic>s</italic> that keeps the FN system inside the oscillating region. Because of this, the maximum <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline26.gif"/></alternatives></inline-formula> must be less than or equal to the natural frequency of the oscillations at the given value of <italic>c</italic>.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><p>A) Analytical approximations for the nest I/O curves. B) Simulated nest I/O curves for different values of <italic>c</italic>. Each pair of error bars correspond to 10 simulation trials, each 5 minutes long, with a constant incoming rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline27.gif"/></alternatives></inline-formula> and constant volatility <italic>c</italic>. The dashed black line represents points at which <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline28.gif"/></alternatives></inline-formula>.</p></caption>
<graphic xlink:href="322974_fig5.tif"/>
</fig>
 <p>In <xref ref-type="fig" rid="fig5">Fig. 5B</xref> we show the nest I/O curves obtained by simulating the open-loop system for different constant Poisson incoming rates at a fixed volatility. We measured the resulting mean outgoing rate in each case. We set &#x03BB;<sub><italic>in</italic></sub> to a five-minutes-long Poisson process, and, in each of 10 simulation trials, we recorded the output &#x03BB;<sub><italic>out</italic></sub>. We computed the mean outgoing foraging rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline29.gif"/></alternatives></inline-formula> by dividing the total number of outgoing foragers in the trial by the 300 seconds that the trial lasted. We used the average of the 10 trials as a point estimate for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline30.gif"/></alternatives></inline-formula> as a function of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline31.gif"/></alternatives></inline-formula> given the volatility parameter <italic>c</italic>. We constructed nest I/O curves by repeating this point estimation process for twelve different values of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline32.gif"/></alternatives></inline-formula> while keeping <italic>c</italic> constant.</p>
<p>The simulated I/O curves in <xref ref-type="fig" rid="fig5">Fig. 5B</xref> are in good agreement with the analytical I/O curves in <xref ref-type="fig" rid="fig5">Fig. 5A</xref>. The fact that there is good agreement between the simulation curves computed from short 5-minute-long input sequences and the analytical curves derived under the assumption of an infinite time period suggest that our analytical approximation is also valid across short timescales. We make use of this in our analysis of the closed-loop model dynamics.</p>
<p>The points at which the nest I/O curves in <xref ref-type="fig" rid="fig5">Fig. 5</xref> intersect the black dashed diagonal line correspond to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline33.gif"/></alternatives></inline-formula>, which are predictive of the (quasi) steady-state solutions at an equal incoming and outgoing foraging rate observed in the data. <xref ref-type="fig" rid="fig5">Fig. 5</xref> suggests that for sufficiently high values of <italic>c</italic>, the equal foraging rate is positive and bounded away from zero, capturing a nontrivial steady-state foraging rate as in <xref ref-type="fig" rid="fig3">Fig. 3</xref> and <xref ref-type="fig" rid="fig4">Fig. 4B</xref> and D. However, <xref ref-type="fig" rid="fig5">Fig. 5</xref> suggests that for low values of <italic>c</italic>, the equal foraging rate is nearly zero, capturing a steady-state with negligible foraging as in <xref ref-type="fig" rid="fig4">Fig. 4F</xref>.</p>
<p>To understand first consider that, because <italic>k</italic> &#x003E; <italic>b</italic><sub>1</sub>, every incoming forager elicits at least one oscillation in the FN output and so at low <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline34.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline35.gif"/></alternatives></inline-formula> is equal to or larger than <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline36.gif"/></alternatives></inline-formula>. At high <italic>c</italic> values, the frequency of oscillations in the FN is high and a single incoming forager will elicit more than one oscillation, resulting in nest I/O curves with an initial slope higher than one and an intersection with the diagonal line at a single point away from the origin. In contrast, for low <italic>c</italic> values, a single incoming forager will elicit exactly one oscillation, resulting in nest I/O curves with an initial slope of one, i.e., the curve lies on the diagonal line close to the origin and intersects nowhere else.</p>
<p>We can approximate the value of <italic>c</italic> above which a single incoming forager results in more than one outgoing forager, guaranteeing an isolated nontrivial intersection of the nest I/O curve with the diagonal line. For <italic>b</italic><sub>1</sub> &#x003C; <italic>k</italic> &#x003C; <italic>b</italic><sub>2</sub>, it can be shown that the number of oscillations caused by a single incoming forager is at most (&#x2013;&#x03C4; log <italic>b</italic><sub>1</sub>/<italic>k</italic>)/<italic>T</italic><sub><italic>LC</italic></sub>. We numerically solved this expression for <italic>c</italic> using the asymptotic expansion of <italic>T</italic><sub><italic>LC</italic></sub>described in SI Appendix 1 and found that for <italic>c</italic> &#x003E; <italic>c</italic>&#x002A; &#x003D; 0.5287 the FN oscillates at least two times per every incoming forager. Therefore, <italic>c</italic> &#x003E; <italic>c</italic>&#x002A; is a sufficient condition for the nest I/O curve to lie above the diagonal line at low <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline37.gif"/></alternatives></inline-formula> and to intersect the diagonal line at an isolated point, corresponding to a nontrivial steady-state foraging rate.</p>
</sec>
<sec id="s5b">
<title>Foraging Dynamics Outside the Nest</title>
<p>Given a sequence of outgoing foragers &#x03BB;<sub><italic>out</italic></sub> with rate <italic>r</italic><sub><italic>out</italic></sub>, the foraging dynamics outside the nest predicts a corresponding delayed sequence of incoming foragers &#x03BB;<sub><italic>in</italic></sub> with rate <italic>r</italic><sub><italic>in</italic></sub>. We use results from queueing theory to find analytic expressions relating <italic>r</italic><sub><italic>out</italic></sub> to <italic>r</italic><sub><italic>in</italic></sub> and the expected number of active foragers outside the nest.</p>
<p>To facilitate the analysis we assume that &#x03BB;<sub><italic>out</italic></sub> is a non-homogeneous Poisson process (i.e., a Poisson process with time-varying rate) [<xref ref-type="bibr" rid="c15">15</xref>]. Applying known results for queues with a non-homogeneous Poisson distribution of arrival times [<xref ref-type="bibr" rid="c38">38</xref>] we obtain the following three results:</p>
<list list-type="order">
<list-item><p>Let <italic>Q</italic>(<italic>t</italic>) represent the number of active foragers outside the nest, then, for each time <italic>t</italic>&#x2032; &#x003D; <italic>t</italic>/60 where <italic>t</italic> is seconds, <italic>Q</italic>(<italic>t</italic>&#x2032;) has a Poisson distribution with mean
<disp-formula id="eqn9"><alternatives><graphic xlink:href="322974_eqn9.gif"/></alternatives></disp-formula></p></list-item>
<list-item><p>The output process describing how foragers leave the queueing system, that is, the process &#x03BB;<sub><italic>in</italic></sub> describing how foragers return to the nest, is a non-homogeneous Poisson process with mean
<disp-formula id="eqn10"><alternatives><graphic xlink:href="322974_eqn10.gif"/></alternatives></disp-formula></p></list-item>
<list-item><p><italic>r</italic><sub><italic>in</italic></sub> is related to <italic>r</italic><sub><italic>out</italic></sub> by
<disp-formula id="eqn11"><alternatives><graphic xlink:href="322974_eqn11.gif"/></alternatives></disp-formula></p></list-item>
</list>
<p><xref ref-type="disp-formula" rid="eqn7">Eqs. (7)</xref> and (9) show how the active number of foragers outside the nest depends on the history of outgoing foragers. <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> shows that if the outgoing foraging process is a non-homogeneous Poisson process, then the incoming foraging process is also a non-homogeneous Poisson process. And <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> shows how the incoming foraging rate <italic>r</italic><sub><italic>in</italic></sub> depends on the history of the outgoing foraging rate <italic>r</italic><sub><italic>out</italic></sub>.</p>
<p>At steady-state, the outgoing foraging rate is constant, i.e., <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) &#x003D; <italic>r</italic>&#x002A;, and <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> reduces to <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub> &#x003D; <italic>r</italic>&#x002A;, i.e., the incoming foraging rate is also constant and equal to the outgoing foraging rate. Moreover, <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> reduces to
<disp-formula id="eqn12"><alternatives><graphic xlink:href="322974_eqn12.gif"/></alternatives></disp-formula>
i.e., the mean number of active foragers outside the nest is given by the steady-state foraging rate <italic>r</italic>&#x2217; multiplied by the average foraging trip time <italic>D</italic>.</p>
<p>The relaxation time for the queue output process to reach steady-state can be analyzed by considering the step-function arrival rate <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>&#x2032;) &#x003D; 0 for <italic>t</italic>&#x2032; &#x003C; 0 and <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>&#x2032;) &#x003D; <italic>r</italic>&#x002A; for <italic>t</italic>&#x2032; &#x2265; 0. Then, from <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline38.gif"/></alternatives></inline-formula> for <italic>t</italic>&#x2032; &#x2265; 0. The difference between the queue input and output rates as a function of time is
<disp-formula id="eqn13"><alternatives><graphic xlink:href="322974_eqn13.gif"/></alternatives></disp-formula>
for <italic>t</italic>&#x2032; &#x2265; 0. For <italic>D</italic> &#x003D; 2, the right-hand side of <xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref> simplifies to <italic>r</italic>&#x002A;<italic>e</italic><sup>&#x2212;<italic>t</italic>&#x2032;/2</sup> and the foraging queue converges exponentially in time towards a steady-state where the input and output rates are equal.</p>
</sec>
<sec id="s5c">
<title>Closed-loop Model Dynamics</title>
<p>In our model, outgoing foragers from the nest go out to forage, return to the nest as incoming foragers after finding a seed, and then go back out to forage again if sufficiently excited (<xref ref-type="fig" rid="fig1">Fig. 1</xref>). Here we show that adding the feedback connection from outgoing to incoming foragers to the open-loop dynamics in the nest yields long-term dynamics with a stable and attracting fixed-point where the incoming and outgoing rates are equal and robust to small perturbations in rates. When the volatility <italic>c</italic> is above <italic>c</italic>&#x002A;, the critical value studied above, the steady-state foraging rate is nontrivial, whereas if <italic>c</italic> is well below <italic>c</italic>&#x002A;, the steady-state foraging rate is negligible.</p>
<p>For the dynamics inside the nest, we have shown that <italic>c</italic> parametrizes a family of nest I/O curves, described by <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>, which map <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline39.gif"/></alternatives></inline-formula> to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline40.gif"/></alternatives></inline-formula>. For <italic>c</italic> &#x226A; <italic>c</italic>&#x002A;, the nest I/O curve always has slope less than or equal to 1, such that it lies on or below the diagonal line where <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub>. For <italic>c</italic> &#x003E; <italic>c</italic>&#x002A;, the nest I/O curve has initial slope greater than 1 and then intersects the diagonal line <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub> at a nontrivial point. For the dynamics outside the nest, we have shown that the mapping from <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) to <italic>r</italic><sub><italic>in</italic></sub> (<italic>t</italic>) is described by a time delay given by <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref>.</p>
<p>We study the closed-loop model dynamics for timescales ranging from tens of minutes to hours by investigating the behavior of a discrete iterated mapping <italic>r</italic><sub><italic>n</italic></sub> &#x003D; <italic>G</italic><sub><italic>c</italic></sub>(<italic>r</italic><sub><italic>n</italic>&#x2013;1</sub>) where <italic>r</italic><sub><italic>n</italic></sub> represents the mean foraging rate at time step <italic>n</italic>, and where the time in between steps is given by the time delay from <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) to <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) introduced by the foraging outside the nest. The mapping <italic>G</italic><sub><italic>c</italic></sub>: &#x211D;<sub>&#x2265;0</sub> &#x2192; &#x211D;<sub>&#x2265;0</sub> is defined by the c-dependent nest I/O curves shown in <xref ref-type="fig" rid="fig5">Fig. 5</xref>. <italic>G</italic><sub><italic>c</italic></sub> describes the process by which the incoming foraging rate becomes the outgoing foraging rate through the dynamics of forager activation inside the nest, which then becomes the incoming foraging rate at a later time.</p>
<p>When <italic>G</italic><sub><italic>c</italic></sub> lies below (above) the diagonal line where <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub>, the average number of outgoing foragers per every incoming forager is less (greater) than one, and iterations of <italic>G</italic><sub><italic>c</italic></sub> decrease (increase) <italic>r</italic> (<xref ref-type="fig" rid="fig6">Fig. 6</xref>). For <italic>c</italic> &#x003E; <italic>c</italic>&#x002A;, <italic>G</italic><sub><italic>c</italic></sub> has one unstable fixed point at the origin and one attractive stable fixed point where <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub>. For <italic>c</italic> &#x226A; <italic>c</italic>&#x002A;, <italic>G</italic><sub><italic>c</italic></sub> has a small interval of fixed points close to the origin. Thus, the closed-loop model dynamics evolve in time towards either a finite steady-state foraging rate <italic>r</italic><sub><italic>in</italic></sub> &#x003D; <italic>r</italic><sub><italic>out</italic></sub> &#x003D; <italic>r</italic>&#x002A; (<xref ref-type="fig" rid="fig6">Fig. 6</xref>, <italic>c</italic> &#x003D;2 and <italic>c</italic> &#x003D; 5) or to negligible foraging (<xref ref-type="fig" rid="fig6">Fig. 6</xref>, <italic>c</italic> &#x003D; 0.1).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Fig. 6.</label>
<caption><p>Model dynamics illustrating response of foraging rates to environmental conditions. Red, purple, and blue curves show closed-loop trajectories of <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) versus <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) for fixed volatility c equal to 5.0, 2.0, and 0.1, respectively. Initially, all available foragers are uninformed about the environment and have volatility <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 5.0. The darker gray dashed curve shows the dynamics in the case when foragers exposed to the environment reduce their volatility to <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 2.0, as might happen on a moderately hot and dry day. The lighter gray dashed curve shows the dynamics in the case when foragers exposed to the environment reduce their volatility to <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.1, as might happen on a very hot and dry day.</p></caption>
<graphic xlink:href="322974_fig6.tif"/>
</fig>
<p>The robustness of the steady-state rates to small perturbations in &#x03BB;<sub><italic>in</italic></sub> results from the balance between positive feedback from incoming ants activating a larger number of outgoing ants, and negative feedback from saturation effects. The magnitude of the steady-state and the variance around it are positively correlated to the mean and variance of <italic>s</italic>, both of which increase with <italic>c</italic> for fixed <italic>r</italic><sub><italic>in</italic></sub> (see SI Appendix 3). The magnitude depends on <italic>c</italic>, <italic>k</italic>, and &#x03C4;, given by <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>, which can be numerically solved to find how the QSS foraging rate changes with <italic>c</italic> (<xref ref-type="fig" rid="fig7">Fig. 7A</xref>).</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Fig. 7.</label>
<caption><p>A. Analytical magnitude of the quasi steady-state (QSS) foraging rate obtained from numerically solving <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>. B. Closed-loop model simulations for 7 different values of volatility <italic>c</italic>. The initial sequence of incoming foragers for all simulations was set equal to the first 11 minutes of the initial sequence of incoming foragers from Colony 859 on August 20, 2017 which has a mean incoming rate of 0.01 ants/sec. The total time for all simulations was 3 hours. The mean foraging time was set to 10 minutes (<italic>D</italic> &#x003D; 10).</p></caption>
<graphic xlink:href="322974_fig7.tif"/>
</fig>
<p>As shown in <xref ref-type="fig" rid="fig7">Fig. 7B</xref>, simulations of the closed-loop model validate the predictions of the iterated mapping model. We initialize the foraging dynamics by setting &#x03BB;<sub><italic>in</italic></sub> from <italic>t</italic> &#x003D; 0 to <italic>t</italic> &#x003D; 60(<italic>D</italic> &#x002B; 1) to be equal to the first <italic>D</italic> &#x002B; 1 minutes of the initial sequence of incoming foragers for Colony 859 on August 20, 2017, which has the very low mean incoming rate of 0.01 ants/sec during the first 15 minutes (panel C, <xref ref-type="fig" rid="figS2">Fig. S2</xref>).</p>
</sec>
<sec id="s5d">
<title>Closed-loop Dynamics with Response to Environmental Conditions</title>
<p>For Poisson sequences of incoming foragers, the mean outgoing foraging rate of the colony is given as the weighted sum of the outputs of the uninformed and informed:
<disp-formula id="eqn14"><alternatives><graphic xlink:href="322974_eqn14.gif"/></alternatives></disp-formula>.</p>
<p>The closed-loop dynamics can still be studied as an iterated mapping, but we allow the mapping to evolve in time, <italic>G</italic><sub><italic>c</italic></sub> &#x003D; <italic>G</italic><sub><italic>c</italic></sub>(<italic>t</italic>), from an initial mapping <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline55.gif"/></alternatives></inline-formula> with volatility <italic>c</italic><sub><italic>u</italic></sub> to a final mapping <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline56.gif"/></alternatives></inline-formula> with volatility <italic>c</italic><sub><italic>i</italic></sub>. We illustrate in <xref ref-type="fig" rid="fig6">Fig. 6</xref>) for <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 5.0 and <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 2.0 and for <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 5.0 and <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.1. The dynamics first evolve along <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline57.gif"/></alternatives></inline-formula> (red), but as <italic>x</italic><sub><italic>i</italic></sub> increases, the dynamics shift increasingly to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline58.gif"/></alternatives></inline-formula>, and the trajectory on the plot of <italic>r</italic><sub><italic>out</italic></sub>(<italic>t</italic>) versus <italic>r</italic><sub><italic>in</italic></sub>(<italic>t</italic>) moves towards the <italic>c</italic><sub><italic>i</italic></sub> curve. In the case <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 2.0, the trajectory converges to the fixed point associated with <italic>c</italic> &#x003D; 2.0 (darker gray dashed curve). In the case <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.1, the trajectory converges to the only fixed point of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline59.gif"/></alternatives></inline-formula>, which is the origin, leading to a cessation of foraging (lighter gray dashed curve).</p>
<p><xref ref-type="fig" rid="fig8">Fig. 8</xref> shows the resulting time-series and input-output plots for three different simulations of the model with the mechanism for response to environmental conditions. The simulations are distinguished by the set of four parameters: <italic>c</italic><sub><italic>u</italic></sub>, <italic>c</italic><sub>i</sub>, <italic>N</italic>, and <italic>D</italic>. The simulated trajectories qualitatively resemble the trajectories from the field observations shown in <xref ref-type="fig" rid="fig4">Fig. 4</xref>. We set the initial sequence of incoming foragers as in <xref ref-type="fig" rid="fig7">Fig. 7B</xref>.</p>
<p><xref ref-type="fig" rid="fig8">Fig. 8A</xref> and B show the results for <italic>c</italic><sub><italic>u</italic></sub> &#x003D;3, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.9, <italic>N</italic> &#x003D; 500, and <italic>D</italic> &#x003D; 5. In this case, <italic>c</italic><sub><italic>u</italic></sub> is much higher than <italic>c</italic><sub><italic>i</italic></sub>, leading to a system with an overshoot behavior in which the outgoing foraging rate increases more rapidly than the incoming rate and then decreases before settling around a steady-state where the rates are approximately equalto 0.7 ants/sec. This is qualitatively similar to the observations of Colony 664 on August 27, 2015 of <xref ref-type="fig" rid="fig4">Fig. 4A</xref> and B. The net number of foragers outside the nest at steady-state fluctuates with low variability at around 230, close to the prediction given by <xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref>.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Fig. 8.</label>
<caption><p>Simulations of the closed-loop model with the adaptation mechanism. Plots are of the same form as in <xref ref-type="fig" rid="fig4">Fig. 4</xref>, and qualitative comparisons can be made between A and B here and <xref ref-type="fig" rid="fig4">Fig. 4A</xref> and B, between C and D here and <xref ref-type="fig" rid="fig4">Fig. 4C</xref> and D, and between E and F here and <xref ref-type="fig" rid="fig4">Fig. 4E</xref> and F. A) and B) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 3, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.9, <italic>N</italic> &#x003D; 500, <italic>D</italic> &#x003D; 5. C) and D) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 3, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.75, <italic>N</italic> &#x003D; 200, <italic>D</italic> &#x003D; 5. E) and F) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 5, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.02, <italic>N</italic> &#x003D; 600, <italic>D</italic> &#x003D; 15.</p></caption>
<graphic xlink:href="322974_fig8.tif"/>
</fig>
<p><xref ref-type="fig" rid="fig8">Fig. 8C</xref> and D show the results for <italic>c</italic><sub><italic>u</italic></sub> &#x003D;3, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.75, <italic>N</italic> &#x003D; 200, and <italic>D</italic> &#x003D; 5. This case simulates the same colony as in <xref ref-type="fig" rid="fig8">Fig. 8A</xref> and B but on a hotter and drier day, when the total number of ants <italic>N</italic> that engage in foraging may be reduced and the volatility of the informed ants <italic>c</italic><sub><italic>i</italic></sub> may be reduced. The overshoot behavior is followed by the foraging rates settling around a steady-state of about 0.25 ants/sec. This is qualitatively similar to the observations of Colony 664 on August 31, 2015 of <xref ref-type="fig" rid="fig4">Fig. 4C</xref> and D.</p>
<p><xref ref-type="fig" rid="fig8">Fig. 8E</xref> and F show the simulation results for <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 5, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.02, <italic>N</italic> &#x003D; 600, <italic>D</italic> &#x003D; 15. In this case, <italic>c</italic><sub><italic>i</italic></sub> is close to zero, leading to a colony that goes out to forage but then returns to the nest without sustained foraging. This is qualitatively similar to the observations of Colony 664 on August 27, 2015 of <xref ref-type="fig" rid="fig4">Fig. 4E</xref> and F.</p>
<p>The time it takes for the colony to transition from fully uninformed to fully informed is dictated by <italic>c</italic><sub><italic>u</italic></sub>, <italic>c</italic><sub><italic>i</italic></sub>, <italic>D</italic>, <italic>N</italic>, and the initial condition for <italic>r</italic><sub><italic>in</italic></sub> and <italic>r</italic><sub><italic>out</italic></sub>. For low values of <italic>c</italic><sub><italic>u</italic></sub>, the outgoing foraging rate at the start of the day is low and the corresponding rate at which foragers become informed is low too. If <italic>c</italic><sub><italic>i</italic></sub> is high, the colony will spend a long time at a low rate before the number of informed foragers is sufficiently high to increase the foraging rates. We show a simulation of high <italic>c</italic><sub><italic>i</italic></sub> in <xref ref-type="fig" rid="figS6">Fig. S6A</xref>, which can be compared with the data from Colony 859 on August 20, 2017, plotted in <xref ref-type="fig" rid="figS2">Fig. S2C</xref>.</p>
<p>Low values of <italic>c</italic><sub><italic>i</italic></sub> can cause long transients. Once a critical number of foragers has become informed, it will be difficult for the remaining foragers to become informed since the colony behaves as an informed colony with low volatility. High <italic>D</italic> and <italic>N</italic> can also result in long transients because the time it takes for the colony to transition into a fully informed state depends on how many available foragers there are and on how long it takes for informed foragers to return to the nest. High <italic>D</italic> increases the capacity of the foraging queue, requiring higher numbers of active foragers at steady-state (see <xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref>). We show a simulation of high <italic>D</italic> and <italic>N</italic> in <xref ref-type="fig" rid="figS6">Fig. S6B</xref>, which can be compared with the data from Colony 1107 on August 16, 2017, plotted in <xref ref-type="fig" rid="figS2">Fig. S2D</xref>.</p>
<p>The initial conditions also affect the length of the transient. For an initially high value of <italic>r</italic><sub><italic>out</italic></sub>, the number of active foragers increases very rapidly, reducing the time it takes for the colony to reach the informed state with foraging rates that reach a QSS. We show a simulation for an initially high value of <italic>r</italic><sub><italic>out</italic></sub> in <xref ref-type="fig" rid="figS6">Fig. S6C</xref>, which can be compared to data from Colony 1017 on August 23, 2016 and Colony 1015 on August 18, 2016, plotted in <xref ref-type="fig" rid="figS2">Fig. S2E</xref> and F.</p>
</sec>
</sec>
<sec id="s6">
<title>Discussion</title>
<p>We have derived and analyzed a low dimensional analytical model of foraging dynamics that requires only a small number of parameters to qualitatively capture a wide range of transient and steady-state features observed in the foraging rates of red harvester ant colonies. The model is distinguished from previous work in that it accounts for how incoming and outgoing rates, to and from the nest, change over long timescales, from tens of minutes to hours. Importantly, the long timescales allow for a model-based investigation into how a colony, with no centralized control and little individual information about the state of the colony or environment, can regulate its foraging rates to be robust to small disturbances and responsive to temperature and humidity outside the nest across minutes to hour-long timescales. Further, because the model is analytically tractable, it can be used to systematically derive predictions of foraging behavior as a function of critical model parameters and to explain variation in foraging activity among colonies in response to changing conditions.</p>
<p>Our model and analysis highlight the importance of feedback in the regulation of foraging activity. Previous work isolates the open-loop dynamics inside the nest, which maps incoming ants to outgoing ants on very short timescales. We address the minutes to hour-long timescales by examining analytically the closed-loop dynamics that connect the foraging activity outside the nest to the activation of foragers inside the nest through feedback generated by the ants themselves and their interactions with others. The stream of foraging ants out of the nest is the input to the foraging activity, and the output of the foraging activity is the stream of foraging ants into the nest.</p>
<p>Using analytical tools from dynamics and control theory, we show how the incoming and outgoing foraging rates first undergo a transient in which the outgoing rate exceeds the incoming rate, how the incoming and outgoing rates then stably approach a common value that is lower than the peak outgoing rate, and how the rates remain equilibrated at a quasi steady-state, despite disturbances, until mid-day when foraging rates go to zero. We show further how the transient and quasi steady-state rates differ under different foraging conditions, and how sensitivities to a small number of parameters can explain differences among colonies in the regulation of foraging.</p>
<p>To examine the underlying mechanisms that help explain changes over minute to hour-long timescales and differences over colonies in foraging rates, we isolate the parameter c in our model, which we call &#x201C;volatility&#x201D;, and we explore its role in foraging dynamics. Volatility approximates the average sensitivity of available foragers in the nest to interactions with returning foragers: the higher the c the fewer interactions needed to activate available foragers to go out and forage. The relationship between c and the activation of foragers is nonlinear, and the subtleties of our model reflect some of the complexities of the system. We use analytical predictions to show how c determines three important features of the foraging model dynamics (<xref ref-type="fig" rid="fig7">see Fig.7</xref>): 1) the initial transient in incoming and outgoing foraging rates, parametrized by <italic>c</italic>, 2) the equilibration of incoming and outgoing foraging rates to a stable, and thus robust, quasi steady-state rate, parametrized by <italic>c</italic>, and 3) the prediction of an early cessation of foraging or no foraging at all if <italic>c</italic> &#x226A; <italic>c</italic>&#x002A;, a critical volatility value <italic>c</italic>&#x002A;.</p>
<p>The behavior of different colonies on the same day or the same colony on different days thus correspond in the model to different values of volatility <italic>c</italic>. Lower values of <italic>c</italic> are consistent with hotter and drier days, because lower <italic>c</italic> means that available foragers are less volatile and thus less likely to go out and forage. Higher values of <italic>c</italic> are consistent with cooler and more humid days, because higher <italic>c</italic> means that available foragers are more volatile and thus more likely to go out and forage.</p>
<p>Because the temperature and humidity inside the nest remain relatively constant over the foraging day (<xref ref-type="fig" rid="figS1">Fig. S1</xref>), it is likely that foragers learn about the current outside conditions only after they have been on a foraging trip and thus exposed to the environment. To account for this in our model of a single colony on a single day, we implement two volatility terms <italic>c</italic><sub><italic>u</italic></sub> and <italic>c</italic><sub><italic>i</italic></sub> to distinguish between the volatility of &#x201C;uninformed&#x201D; available foragers in the nest who have yet to go on a foraging trip and the volatility of &#x201C;informed&#x201D; available foragers in the nest who have already been outside the nest on at least one foraging trip (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). The result is a transition from the foraging activity of ants with volatility <italic>c</italic><sub><italic>u</italic></sub> to the foraging activity of ants with volatility <italic>c</italic><sub><italic>i</italic></sub>, which can last from minutes to hours as each of the total <italic>N</italic> ants goes out at a different time on its first foraging trip and returns to the nest after foraging for an average of <italic>D</italic> minutes (<xref ref-type="fig" rid="fig6">Fig. 6</xref>).</p>
<p>We show that over a range of values for the four parameters <italic>c</italic><sub><italic>u</italic></sub>, <italic>c</italic><sub><italic>i</italic></sub>, <italic>N</italic>, and <italic>D</italic>, the model describes the range of transient and quasi steady-state foraging rate behaviors observed in the data collected for red harvester colonies in August and September of 2015, 2016, and 2017. In each of the data sets plotted in <xref ref-type="fig" rid="fig3">Fig. 3</xref> and <xref ref-type="fig" rid="fig4">Fig. 4</xref>, the outgoing foraging rate initially increases faster than the incoming foraging rate and then the two rates equilibrate at a quasi-steady state. In <xref ref-type="fig" rid="fig4">Fig 4 B, D</xref>, and F, this behavior is described by outgoing-vs-incoming rate curves that initially rise above the diagonal line before converging onto the diagonal line where the rates are equal and lower than the maximum outgoing rate during the transient. That our model explains the shapes of these curves, and distinguishes the three different cases of <xref ref-type="fig" rid="fig4">Fig. 4</xref> only through different values of the four parameters can be seen in the model simulations of <xref ref-type="fig" rid="fig8">Fig. 8</xref>. <xref ref-type="fig" rid="fig4">Fig. 4 B</xref> and D show the curves for foraging rate data corresponding to the same colony on two different days, the second day warmer and drier than the first. The simulations shown in <xref ref-type="fig" rid="fig8">Fig. 8 B</xref> and D recover the two differently shaped curves of <xref ref-type="fig" rid="fig4">Fig. 4 B</xref> and D, respectively, only by using different values of <italic>c</italic><sub><italic>i</italic></sub> and <italic>N</italic> that are consistent with the different environmental conditions. The data in <xref ref-type="fig" rid="fig4">Fig. 4 F</xref> show a colony discontinuing its foraging after the initial transient and the shape of this curve is recovered in the model simulation <xref ref-type="fig" rid="fig8">Fig. 8 F</xref>. Similar comparisons can be made for the data curves plotted in <xref ref-type="fig" rid="figS2">Fig. S2</xref> and the model simulation curves plotted in <xref ref-type="fig" rid="figS6">Fig. S6</xref>.</p>
<p>The model represents the case in which foragers make an adjustment to their volatility only after their first foraging trip. To include more variability within a colony the model can be generalized to <italic>M</italic> &#x003E; 2 groups of available foragers in the nest, distinguished by <italic>M</italic> values of volatility <italic>c</italic><sub>1</sub>, &#x2026;, <italic>c</italic><sub><italic>M</italic></sub>. For example, the generalization can be used to account for foragers that make adjustments to how they respond to interactions in the nest after subsequent foraging trips due to repeated exposure or changing temperature and humidity. The generalization can also be used to account for decay of information for those foragers who stay in the nest for a long period after a foraging trip, or to represent foragers that return to the deeper nest after exposure to hot and dry outside conditions.</p>
<p>Our biologically informed, low-dimensional, and simply parameterized model allows for systematic exploration of mechanisms and sensitivities that can explain collective behavior and guide further theoretical and experimental investigations. Our use of well-studied excitability dynamics opens the way for comparison with other complex systems, such as neuronal networks, that are driven by excitable dynamics. The model together with our analysis based on dynamics and control theory contribute to a better understanding of the role of feedback across multiple timescales in the emergence of adaptive collective behavior in complex systems.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We thank many dedicated undergraduate field assistants for their help: Sam Crow, Eleanor Glockner, Christopher Jackson, Sarah Jiang, Ga-Il Lee, Arthur Mestas, Becca Nelson, and especially Rebia Khan.</p>
</ack>
<ref-list>
<title>references</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>The organization of work in social insect colonies</article-title>. <source>Nature</source>. <year>1996</year>;<volume>380</volume>:<fpage>121</fpage>&#x2013;<lpage>124</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="book"><string-name><surname>Sumpter</surname> <given-names>DJ</given-names></string-name>. <source>Collective animal behavior</source>. <publisher-loc>Princeton</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>2010</year>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Leonard</surname> <given-names>NE</given-names></string-name>. <article-title>Multi-agent system dynamics: Bifurcation and behavior of animal groups</article-title>. <source>Annu Rev Control</source>. <year>2014</year>;<volume>38</volume>(<issue>2</issue>):<fpage>171</fpage>&#x2013;<lpage>183</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Hopfield</surname> <given-names>JJ</given-names></string-name>. <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1982</year>;<volume>79</volume>(<issue>8</issue>):<fpage>2554</fpage>&#x2013;<lpage>2558</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>The rewards of restraint in the collective regulation of foraging by harvester ant colonies</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7452</issue>):<fpage>91</fpage>&#x2013;<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Beverly</surname> <given-names>BD</given-names></string-name>, <string-name><surname>McLendon</surname> <given-names>H</given-names></string-name>, <string-name><surname>Nacu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>How site fidelity leads to individual differences in the foraging activity of harvester ants</article-title>. <source>Behav Ecol</source>. <year>2009</year>;<volume>20</volume>(<issue>3</issue>):<fpage>633</fpage>&#x2013;<lpage>638</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Lighton</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bartholomew</surname> <given-names>GA</given-names></string-name>. <article-title>Standard energy metabolism of a desert harvester ant, Pogonomyrmex Rugosus: effects of temperature, body mass, group size, and humidity</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1988</year>;<volume>85</volume>(<issue>13</issue>):<fpage>4765</fpage>&#x2013;<lpage>4769</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Lighton</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Feener</surname> <suffix>Jr</suffix> <given-names>DH</given-names></string-name>. <article-title>Water-loss rate and cuticular permeability in foragers of the desert ant Pogonomyrmex Rugosus</article-title>. <source>Physiol Zool</source>. <year>1989</year>;<volume>62</volume>(<issue>6</issue>):<fpage>1232</fpage>&#x2013;<lpage>1256</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Greene</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>Social insects: cuticular hydrocarbons inform task decisions</article-title>. <source>Nature</source>. <year>2003</year>;<volume>423</volume>(<issue>6935</issue>):<fpage>32</fpage>&#x2013;<lpage>32</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Greene</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>Interaction rate informs harvester ant task decisions</article-title>. <source>Behav Ecol</source>. <year>2007</year>;<volume>18</volume>(<issue>2</issue>):<fpage>451</fpage>&#x2013;<lpage>455</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Greene</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Pinter-Wollman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>Interactions with combined chemical cues inform harvester ant foragers&#x2019; decisions to leave the nest in search of food</article-title>. <source>PLoS One</source>. <year>2013</year> <day>01</day>;<volume>8</volume>(<issue>1</issue>):<fpage>e52219</fpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Pinter-Wollman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bala</surname> <given-names>A</given-names></string-name>, <string-name><surname>Merrell</surname> <given-names>A</given-names></string-name>, <string-name><surname>Queirolo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Stumpe</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>Harvester ants use interactions to regulate forager activation and availability</article-title>. <source>Anim Behav</source>. <year>2013</year>;<volume>86</volume>(<issue>1</issue>):<fpage>197</fpage>&#x2013;<lpage>207</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Davidson</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Arauco-Aliaga</surname> <given-names>RP</given-names></string-name>, <string-name><surname>Crow</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Goldman</surname> <given-names>MS</given-names></string-name>. <article-title>Effect of interactions between harvester ants on forager decisions</article-title>. <source>Front Ecol Evol</source>. <year>2016</year>;<volume>4</volume>:<fpage>115</fpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Wagner</surname> <given-names>D</given-names></string-name>, <string-name><surname>Tissot</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>D</given-names></string-name>. <article-title>Task-related environment alters the cuticular hydrocarbon composition of harvester ants</article-title>. <source>J Chem Ecol</source>. <year>2001</year>;<volume>27</volume>(<issue>9</issue>):<fpage>1805</fpage>&#x2013;<lpage>1819</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Prabhakar</surname> <given-names>B</given-names></string-name>, <string-name><surname>Dektar</surname> <given-names>KN</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>The regulation of ant colony foraging activity without spatial information</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e1002670</fpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Pless</surname> <given-names>E</given-names></string-name>, <string-name><surname>Queirolo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pinter-Wollman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Crow</surname> <given-names>S</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>K</given-names></string-name>, <string-name><surname>Mathur</surname> <given-names>MB</given-names></string-name>, <etal>et al.</etal> <article-title>Interactions increase forager availability and activity in harvester ants</article-title>. <source>PloS One</source>. <year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e0141971</fpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Feinerman</surname> <given-names>O</given-names></string-name>, <string-name><surname>Korman</surname> <given-names>A</given-names></string-name>. <article-title>Individual versus collective cognition in social insects</article-title>. <source>J Exp Biol</source>. <year>2017</year>;<volume>220</volume>(<issue>1</issue>):<fpage>73</fpage>&#x2013;<lpage>82</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>Behavioral flexibility and the foraging ecology of seed-eating ants</article-title>. <source>Am Nat</source>. <year>1991</year>;p. <fpage>379</fpage>&#x2013;<lpage>411</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Dektar</surname> <given-names>KN</given-names></string-name>, <string-name><surname>Pinter-Wollman</surname> <given-names>N</given-names></string-name>. <article-title>Harvester ant colony variation in foraging activity and response to humidity</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e63363</fpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>How colony growth affects forager intrusion between neighboring harvester ant colonies</article-title>. <source>Behav Ecol and Sociobiol</source>. <year>1992</year>;<volume>31</volume>(<issue>6</issue>):<fpage>417</fpage>&#x2013;<lpage>427</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Guetz</surname> <given-names>A</given-names></string-name>, <string-name><surname>Greene</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>S</given-names></string-name>. <article-title>Colony variation in the collective regulation of foraging by harvester ants</article-title>. <source>Behav Ecol</source>. <year>2011</year>;<volume>22</volume>(<issue>2</issue>):<fpage>429</fpage>&#x2013;<lpage>435</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>The of an ant colony&#x2019;s foraging range</article-title>. <source>Anim Behav</source>. <year>1995</year>;<volume>49</volume>(<issue>3</issue>):<fpage>649</fpage>&#x2013;<lpage>659</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Passino</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Seeley</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Visscher</surname> <given-names>PK</given-names></string-name>. <article-title>Swarm cognition in honey bees</article-title>. <source>Behav Ecol and Sociobiol</source>. <year>2008</year>;<volume>62</volume>(<issue>3</issue>):<fpage>401</fpage>&#x2013;<lpage>414</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Couzin</surname> <given-names>ID</given-names></string-name>. <article-title>Collective cognition in animal groups</article-title>. <source>Trends Cogn Sci</source>. <year>2009</year>;<volume>13</volume>(<issue>1</issue>):<fpage>36</fpage>&#x2013;<lpage>43</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Marshall</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bogacz</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dornhaus</surname> <given-names>A</given-names></string-name>, <string-name><surname>Planqu&#x00E9;</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kovacs</surname> <given-names>T</given-names></string-name>, <string-name><surname>Franks</surname> <given-names>NR</given-names></string-name>. <article-title>On optimal decision-making in brains and social insect colonies</article-title>. <source>J R Soc Interface</source>. <year>2009</year>;<volume>6</volume>(<issue>40</issue>):<fpage>1065</fpage>&#x2013;<lpage>1074</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Marshall</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Franks</surname> <given-names>NR</given-names></string-name>. <article-title>Colony-level cognition</article-title>. <source>Curr Biol</source>. <year>2009</year>;<volume>19</volume>(<issue>10</issue>):<fpage>R395</fpage>&#x2013;<lpage>R396</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>. <article-title>The development of an ant colony&#x2019;s foraging range</article-title>. <source>Anim Behav</source>. <year>1995</year>;<volume>49</volume>(<issue>3</issue>):<fpage>649</fpage>&#x2013;<lpage>659</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>S</given-names></string-name>, <string-name><surname>Nacu</surname> <given-names>S</given-names></string-name>. <article-title>The short-term regulation of foraging in harvester ants</article-title>. <source>Behav Ecol</source>. <year>2008</year>;<volume>19</volume>(<issue>1</issue>):<fpage>217</fpage>&#x2013;<lpage>222</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="book"><string-name><surname>Roth</surname> <given-names>A</given-names></string-name>, <string-name><surname>van Rossum</surname> <given-names>MC</given-names></string-name>. <chapter-title>Modeling synapses</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Schutter</surname> <given-names>ED</given-names></string-name></person-group>, editor. <source>Computational Modeling Methods for Neuroscientists</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>The MIT press</publisher-name>; <year>2009</year>. p. <fpage>139</fpage>&#x2013;<lpage>160</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Lapicque</surname> <given-names>L</given-names></string-name>. <article-title>Recherches quantitatives sur l&#x2019;excitation &#x00E9;lectrique des nerfs traitee comme une polarisation</article-title>. <source>J Physiol Pathol Gen</source>. <year>1907</year>;<volume>9</volume>(<issue>1</issue>):<fpage>620</fpage>&#x2013;<lpage>635</lpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="book"><string-name><surname>Tuckwell</surname> <given-names>H</given-names></string-name>. <chapter-title>Introduction to theoretical neurobiology</chapter-title>. Vol. <volume>1</volume>, <source>Linear cable theory and dendritic structure and stochastic theories. Cambridge studies in mathematical biology</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1988</year>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Stein</surname> <given-names>RB</given-names></string-name>. <article-title>A theoretical analysis of neuronal variability</article-title>. <source>Biophys J</source>. <year>1965</year>;<volume>5</volume>(<issue>2</issue>):<fpage>173</fpage>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>FitzHugh</surname> <given-names>R</given-names></string-name>. <article-title>Impulses and physiological states in theoretical models of nerve membrane</article-title>. <source>Biophys J</source>. <year>1961</year>;<volume>1</volume>(<issue>6</issue>):<fpage>445</fpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Nagumo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Arimoto</surname> <given-names>S</given-names></string-name>, <string-name><surname>Yoshizawa</surname> <given-names>S</given-names></string-name>. <article-title>An active pulse transmission line simulating nerve axon</article-title>. <source>Proc IEEE Inst Electr Electron Eng</source>. <year>1962</year>;<volume>50</volume>(<issue>10</issue>):<fpage>2061</fpage>&#x2013;<lpage>2070</lpage>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="book"><string-name><surname>Cooper</surname> <given-names>RB</given-names></string-name>. <source>Introduction to queueing theory</source>. <edition>2nd</edition> ed. <publisher-loc>Washington, DC</publisher-loc>: <publisher-name>North Holland</publisher-name>; <year>1981</year>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Lewis</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Shedler</surname> <given-names>GS</given-names></string-name>. <article-title>Simulation of nonhomogeneous Poisson processes by thinning</article-title>. <source>Nav Res Logist</source>. <year>1979</year>;<volume>26</volume>(<issue>3</issue>):<fpage>403</fpage>&#x2013;<lpage>413</lpage>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Gordon</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>S</given-names></string-name>, <string-name><surname>Nacu</surname> <given-names>S</given-names></string-name>. <article-title>The short-term regulation of foraging in harvester ants</article-title>. <source>Behav Ecol</source>. <year>2008</year>;<volume>19</volume>(<issue>1</issue>):<fpage>217</fpage>&#x2013;<lpage>222</lpage>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Eick</surname> <given-names>SG</given-names></string-name>, <string-name><surname>Massey</surname> <given-names>WA</given-names></string-name>, <string-name><surname>Whitt</surname> <given-names>W</given-names></string-name>. <article-title>The physics of the Mt/G/&#x221E;queue</article-title>. <source>Oper Res</source>. <year>1993</year>;<volume>41</volume>(<issue>4</issue>):<fpage>731</fpage>&#x2013;<lpage>742</lpage>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="website"><source>The Weather Company LLC, Weather Underground - Ramuda Drive KNMRODEO3</source>. <ext-link ext-link-type="uri" xlink:href="https://www.wunderground.com/personal-weather-station/dashboard&#x003F;ID=KNMRODEO3#history">https://www.wunderground.com/personal-weather-station/dashboard&#x003F;ID=KNMRODEO3#history</ext-link>.</mixed-citation></ref>
</ref-list>
<sec id="s7" sec-type="supplementary-material">
<title>Supporting Information</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Fig. S1.</label>
<caption><title>Humidity and temperature at surface of desert soil and inside the nest entrance chamber.</title>
<p>Humidity and temperature readings recorded on the surface of the desert soil (blue) and inside the nest entrance chamber (red). Temperature and humidity ibutton sensors were placed outside but close to the nest entrance on the desert soil, unshaded, and inside in the nest in an excavated hole, which had been uncovered by excavation and then covered with glass on top and shaded. The humidity and temperature outside the nest change significantly throughout the morning hours while the humidity and temperature inside the nest entrance chamber remain relatively constant. The measured moderate rise in temperature inside the nest is likely due to the light coming into the nest entrance chamber through the glass. A) Humidity on August 29, 2014 (Colony E). B) Temperature on August 29, 2014 (Colony E). C) Humidity on August 31, 2015 (Colony 10). D) Temperature on August 31, 2015 (Colony 10). E) Humidity on September 1, 2015 (Colony 10). F) Temperature on September 1, 2015 (Colony 10).</p></caption>
<graphic xlink:href="322974_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Fig. S2.</label>
<caption><title>Additional field observations of foraging rates.</title>
<p>Incoming foraging rate <italic>r</italic><sub><italic>in</italic></sub> (blue), outgoing foraging rate <italic>r</italic><sub><italic>out</italic></sub> (red), and difference between number of incoming and outgoing foragers (green) versus time of day. A) Colony 863 September 5, 2015 reaches a QSS at a high rate; compare to <xref ref-type="fig" rid="fig4">Fig. 4E</xref> when on the much hotter and drier day, September 1, 2015, Colony 863 returned to the nest early. B) Colony D19 August 08, 2016 returned to the nest early; the day was very hot and dry. C) Colony 859 August 20, 2017; the transient starts late in the morning. The day was cool and humid. D) Colony 1107 August 16, 2017; the transient is slow. The day was dry. E) Colony 1017 August 23, 2016; the initial transient is more like a burst of outgoing foragers. The day was dry. F) Colony 1015 August 18, 2016; another initial burst of outgoing foragers. The day was very dry.</p></caption>
<graphic xlink:href="322974_figS2.tif"/>
</fig>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1.</label>
<caption><title>Temperature and relative humidity in Rodeo, New Mexico.</title> <p>Average temperature, average relative humidity, temperature at 11 am, and relative humidity at 11 am in Rodeo, New Mexico, USA for days with data plotted in <xref ref-type="fig" rid="fig3">Fig 3</xref>, <xref ref-type="fig" rid="fig4">Fig. 4</xref>, and <xref ref-type="fig" rid="figS2">Fig. S2.</xref> Data collected by the Citizen Weather Observer Program station E8703 and accessed through Weather Underground [<xref ref-type="bibr" rid="c39">39</xref>]. The station is located 1.7 miles from the study site.</p></caption>
<graphic xlink:href="322974_tblS1.tif"/>
</table-wrap>
<fig id="figS3" position="float" fig-type="figure">
<label>Fig. S3.</label>
<caption><title>Open Loop Model.</title> <p>A) Poisson sequence of incoming foragers &#x03BB;<sub><italic>in</italic></sub>. B) Stimulus signal <italic>s</italic> associated with &#x03BB;<sub><italic>in</italic></sub>. C) FN output for input <italic>s</italic>. D) Sequence of outgoing foragers &#x03BB;<sub><italic>out</italic></sub> obtained by thresholding FN output from below at 0.75.</p></caption>
<graphic xlink:href="322974_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Fig. S4.</label>
<caption><title>Probability density function for the stimulus function.</title>
<p>Each curve represents the PDF <italic>p</italic> of the stimulus function <italic>s</italic> for different values of incoming rate <italic>r</italic><sub><italic>in</italic></sub>. The gray rectangles represent the size of the oscillatory region in the F-N system (<italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub>) for different values of volatility <italic>c</italic>. For all curves, <italic>k</italic> &#x003D; 0.3, &#x03C4; &#x003D; 0.41.</p></caption>
<graphic xlink:href="322974_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Fig. S5.</label>
<caption><title>Period of FN Limit Cycle when s&#x003D;0.35</title> <p>Blue dots represent numerical simulations for the period of the FN limit cycle. The red curve represents the analytical approximation in SI Appendix 1. In both cases we set <italic>s</italic> &#x003D; 0.35.</p></caption>
<graphic xlink:href="322974_figS5.tif"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Fig. S6.</label>
<caption><title>Additional simulations of the closed loop system with the adaptation mechanism.</title>
<p>Plots resemble observed foraging behaviors in <xref ref-type="fig" rid="figS2">Fig. S2.</xref> Qualitative comparisons can be made between A here and <xref ref-type="fig" rid="figS2">Fig. S2C</xref>, between B here and <xref ref-type="fig" rid="figS2">Fig. S2D</xref>, and between C here and in <xref ref-type="fig" rid="figS2">Fig. S2E</xref> and F. A) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 0.9, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 2.2, <italic>N</italic> &#x003D; 500, <italic>D</italic> &#x003D; 5. Setting <italic>c</italic><sub><italic>u</italic></sub> &#x003C; <italic>c</italic><sub><italic>i</italic></sub> where <italic>c</italic><sub><italic>u</italic></sub> is close to <italic>c</italic>&#x002A; results in a long period before the rates ramp up. B) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 1, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 1, <italic>N</italic> &#x003D; 1000, <italic>D</italic> &#x003D; 15. Setting the mean foraging trip time <italic>D</italic> to be large results in long lasting transients. C) <italic>c</italic><sub><italic>u</italic></sub> &#x003D; 0.7, <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0.9, <italic>N</italic> &#x003D; 1000, <italic>D</italic> &#x003D; 7. Setting the initial &#x03BB;<sub><italic>in</italic></sub> equal to sequence from the first 5 minutes of &#x03BB;<sub><italic>in</italic></sub> for Colony 1017 on Aug. 23, 2016 (see <xref ref-type="fig" rid="figS2">Fig. S2E</xref>) yields the behavior that follows an initial burst of foragers.</p></caption>
<graphic xlink:href="322974_figS6.tif"/>
</fig>
</sec>
<app-group>
<app id="app1">
<title>SI Appendix 1</title>
<sec>
<title>Effect of volatility on the frequency of oscillations in the FN</title>
<p>Here we use results from [<xref ref-type="bibr" rid="c2">2</xref>] Chapter III, Theorem 3 to obtain an asymptotic expansion for the period of the limit cycle <italic>T</italic><sub><italic>LC</italic></sub> as &#x03F5;<sub>2</sub> goes to zero. We show that the period of the FN limit cycle is inversely proportional to <italic>c</italic> by computing the leading term in the expansion.</p>
<p>The limit cycle of the FN is comprised of four components: two fast components that stretch along the &#x03C5; direction between the crest and valley of the cubic nullcline, and two slow components that stretch along the sides of the cubic nullcline. Because it takes much longer to traverse the slow components of the limit cycle than the fast components of the cycle, the period can be approximated by the time it takes trajectories to traverse the two slow components. These slow components are proportional to the length of the sides of the cubic nullcline, which we show are proportional to <italic>c</italic>.</p>
<statement>
<label>Theorem 1.</label>
<p><italic>The limit cycle of the FN system</italic>
<disp-formula id="ueqn1"><alternatives><graphic xlink:href="322974_ueqn1.gif"/></alternatives></disp-formula>
<italic>has the asymptotic representation:</italic>
<disp-formula id="ueqn2"><alternatives><graphic xlink:href="322974_ueqn2.gif"/></alternatives></disp-formula>
<italic>as</italic> &#x03F5;<sub>2</sub> &#x2192; 0, <italic>where C</italic><sub>1</sub> <italic>and C</italic><sub>2</sub> <italic>are constants and where</italic>
<disp-formula id="ueqn3"><alternatives><graphic xlink:href="322974_ueqn3.gif"/></alternatives></disp-formula></p></statement>
<statement>
<p><italic>Proof.</italic> By Chapter III, Theorem 3 of [<xref ref-type="bibr" rid="c2">2</xref>], the limit cycle of the FN model has the asymptotic representation
<disp-formula id="ueqn4"><alternatives><graphic xlink:href="322974_ueqn4.gif"/></alternatives></disp-formula>
Or, equivalently,
<disp-formula id="ueqn5"><alternatives><graphic xlink:href="322974_ueqn5.gif"/></alternatives></disp-formula></p></statement>
<p>Let time be scaled by 1/&#x03F5;<sub>1</sub> and let <italic>z</italic> &#x003D; <italic>s</italic> &#x2212; 0.35, leading to the new system
<disp-formula id="ueqn6"><alternatives><graphic xlink:href="322974_ueqn6.gif"/></alternatives></disp-formula></p>
<p>The critical manifold of this fast-slow system is <italic>M</italic><sub>0</sub>:&#x003D;{(<italic>&#x03C5;</italic>, <italic>u</italic>) &#x2208; &#x211D;<sup>2</sup>|<italic>u</italic> &#x003D; (<italic>&#x03C5;</italic> &#x2212; <italic>&#x03C5;</italic><sup>3</sup>/3&#x002B;<italic>z</italic>)/<italic>c</italic>}. In the limit &#x03F5;<sub>2</sub> &#x2192; 0, the slow manifold is equal to the critical manifold. Let &#x03A8;<sub>0</sub> denote the limit cycle in this limit.</p>
<p>Using the description of <italic>M</italic><sub>0</sub> as a graph <italic>u</italic> &#x003D; <italic>h</italic>(<italic>&#x03C5;</italic>), the dynamics of the system on the slow flow can be written as
<disp-formula id="ueqn7"><alternatives><graphic xlink:href="322974_ueqn7.gif"/></alternatives></disp-formula></p>
<p>We get a second expression for d<italic>u</italic>/d<italic>t</italic> by differentiating <italic>M</italic><sub>0</sub> with respect to <italic>t</italic>
<disp-formula id="ueqn8"><alternatives><graphic xlink:href="322974_ueqn8.gif"/></alternatives></disp-formula></p>
<p>Equating the two expressions we obtain
<disp-formula id="ueqn9"><alternatives><graphic xlink:href="322974_ueqn9.gif"/></alternatives></disp-formula></p>
<p>Multiplying both sides by d<italic>t</italic> and integrating over &#x03A8;<sub>0</sub>,
<disp-formula id="ueqn10"><alternatives><graphic xlink:href="322974_ueqn10.gif"/></alternatives></disp-formula></p>
<p>In &#x03A8;<sub>0</sub>, the fast components of the orbit take place instantaneously and the time taken to complete the orbit is equal to the time taken to traverse the slow components. The slow components of the trajectory take place on the slow manifold between <italic>&#x03C5;</italic> &#x03F5; [&#x2212;2, &#x2212;1] and <italic>&#x03C5;</italic> &#x03F5; [1,2], yielding the expression
<disp-formula id="ueqn11"><alternatives><graphic xlink:href="322974_ueqn11.gif"/></alternatives></disp-formula>
where time has been scaled back to its original form. This expression is inversely proportional to <italic>c</italic>. Furthermore, this integral has a short closed form solution when the slow components are symmetric (i.e. <italic>z</italic> &#x003D; 0, or <italic>s</italic> &#x003D; 0.35),
<disp-formula id="ueqn12"><alternatives><graphic xlink:href="322974_ueqn12.gif"/></alternatives></disp-formula></p>
<p>We compute the constants <italic>C</italic><sub>1</sub> and <italic>C</italic><sub>2</sub> by applying formulas 7.9 and 7.10 of [<xref ref-type="bibr" rid="c2">2</xref>] Chapter III, Theorem 3. When <italic>s</italic> &#x2260; 0.35, the flow along the system is not symmetric and the asymptotic representation is
<disp-formula id="ueqn13"><alternatives><graphic xlink:href="322974_ueqn13.gif"/></alternatives></disp-formula>
where
<disp-formula id="ueqn14"><alternatives><graphic xlink:href="322974_ueqn14.gif"/></alternatives></disp-formula>
and Sgn represents the sign function.</p>
<p>When <italic>s</italic> &#x003D; 0.35, <italic>z</italic> &#x003D; 0 and the asymptotic representation becomes
<disp-formula id="ueqn15"><alternatives><graphic xlink:href="322974_ueqn15.gif"/></alternatives></disp-formula>
where
<disp-formula id="ueqn16"><alternatives><graphic xlink:href="322974_ueqn16.gif"/></alternatives></disp-formula>
and
<disp-formula id="ueqn17"><alternatives><graphic xlink:href="322974_ueqn17.gif"/></alternatives></disp-formula></p>
</sec>
</app>
<app id="app2">
<title>SI Appendix 2</title>
<sec>
<title>Additional field observations of foraging rates</title>
<p>Here we present additional details for the field observations of foraging rates shown in <xref ref-type="fig" rid="figS2">Fig. S2.</xref></p>
<p>Panel A of <xref ref-type="fig" rid="figS2">Fig. S2</xref> shows the foraging rates for Colony 863 on September 5, 2015. The rates increase before reaching a QSS at around 10:30 am. The same colony on September 1, 2015 did not exhibit a QSS and had stopped foraging by 11 am (<xref ref-type="fig" rid="fig4">Fig. 4E</xref>). These observations are consistent with measurements showing that September 5, 2015 was a particularly cool and humid day while September 1, 2015 was much hotter and drier (see <xref ref-type="table" rid="tblS1">Table S1</xref>).</p>
<p>Panel B of <xref ref-type="fig" rid="figS2">Fig. S2</xref> shows the data for Colony D19 on August 8, 2016 (from video recording) and provides an example of a very early cessation of foraging where both outgoing and incoming rates reached zero well before 11:00 am, similar to Colony 863 on September 1, 2015 (<xref ref-type="fig" rid="fig4">Fig. 4E</xref>). Both August 8, 2016 and September 1, 2015 were very hot and dry days (see <xref ref-type="table" rid="tblS1">Table S1</xref>).</p>
<p>Panel C of <xref ref-type="fig" rid="figS2">Fig. S2</xref> show the data for Colony 859 on August 20, 2017 (from manual recording) and provides an example where the initial transient took a long time before ramping up. The initial transient for Colony 859 on August 20, 2017 remained at around 0.01 ants/sec from 10 am to 11:15 am before increasing to about 0.4 ants/sec by 12:30 pm. August 20, 2017 was a cool and humid day (see <xref ref-type="table" rid="tblS1">Table S1</xref>). Colonies might prefer different ranges of temperature and humidity; on cool and humid days, colonies that prefer warmer temperatures might forage at slightly later times of the day than colonies that prefer more cool temperatures.</p>
<p>Panel D of <xref ref-type="fig" rid="figS2">Fig. S2</xref> show the data for Colony 1107 on August 16, 2017 (from manual recording) and provides a different example of a slow transient; it takes from 8 am to 10:30 am for the foraging rates to increase from 0.3 ants/sec to around 0.9 ants/sec. During this period the number of foragers outside the nest reaches almost 2000. In this case August 16, 2017 was not a particularly cool or humid day (see <xref ref-type="table" rid="tblS1">Table S1</xref>). The long transient and large number of active foragers suggests that the average time it took a forager to find a seed was long. Long foraging trip times can result in slow transients and high number of active foragers because when foragers take a long time to find a seed, it takes longer for foragers to return to the nest and interact with available foragers who then become active foragers. As well, when the average foraging trip times is long, more foragers might be required to cover larger and less dense foraging areas.</p>
<p>Panel E and F of <xref ref-type="fig" rid="figS2">Fig. S2</xref> show the data for Colony 1017 on August 23, 2016 (from manual recording) and for Colony 1015 on August 18, 2016 and provide two examples of a burst in the outgoing foraging rate at the start of the foraging day that rapidly increases the number of active foragers outside the nest; it takes from 7:30 am to 7:45 am for Colony 1017 on August 23, 2016 to increase the number of active foragers from 0 to 800 and it takes from 7:15 am to 7:30 am for Colony 1015 on August 18, 2016 to increase the number of active foragers by 600. In both cases, the foraging rates reach a QSS that lasts tens of minutes. Both August 23 and August 18, 2016 were very dry days (see <xref ref-type="table" rid="tblS1">Table S1</xref>).</p>
<p>The burst kick starts the foraging process very rapidly and appears to be different from the mechanism that activates available foragers to leave the nest through interactions between incoming successful foragers and the available foragers. The rapid increase in the number of active foragers outside the nest might be advantageous on hot and dry days on which there will be only a short period of time in the early morning with acceptable foraging conditions.</p>
</sec>
</app>
<app id="app3">
<title>SI Appendix 3</title>
<sec>
<title>Analytical Approximation for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline41.gif"/></alternatives></inline-formula> in terms of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline42.gif"/></alternatives></inline-formula> and c</title>
<p>Under the assumption that &#x03BB;<sub><italic>in</italic></sub> is a Poisson process with constant rate <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline43.gif"/></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> is equivalent to a Poisson shot noise process with exponential decay:
<disp-formula id="ueqn18"><alternatives><graphic xlink:href="322974_ueqn18.gif"/></alternatives></disp-formula>
where <italic>t</italic><sub><italic>i</italic></sub> are the jump times of the Poisson process, and
<disp-formula id="ueqn19"><alternatives><graphic xlink:href="322974_ueqn19.gif"/></alternatives></disp-formula></p>
<p>The mean and variance of this random process for an initial condition <italic>s</italic>(0) &#x003D; 0 are given by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline44.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline45.gif"/></alternatives></inline-formula> respectively [<xref ref-type="bibr" rid="c3">3</xref>]. Shot noise processes are Markovian and it can be shown that for finite jump sizes, <italic>k</italic> &#x003C; &#x221E;, <italic>s</italic> is ergodic [<xref ref-type="bibr" rid="c4">4</xref>], meaning that as <italic>t</italic> &#x2192; &#x221E;, <italic>s</italic>(<italic>t</italic>) converges in total variation to a unique stationary probability distribution &#x03C0;(<italic>s</italic>) for any initial condition <italic>s</italic>(0). In other words, <italic>s</italic> has the property that time averages converge in time to statistical averages. The ergodicity of <italic>s</italic> allows us to find an asymptotic expression as <italic>t</italic> &#x2192; &#x221E; for the expected fraction of time that any single outcome of the random process spends in a region (<italic>b</italic><sub>1</sub>,<italic>b</italic><sub>2</sub>) by looking at its stationary probability density function.</p>
<p>Let <italic>S</italic><sub><italic>f</italic></sub> &#x003D; {<italic>t</italic><sub><italic>f</italic></sub> &#x03F5; [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub>0</sub> &#x002B; <italic>T</italic>] | <italic>b</italic><sub>1</sub> &#x003C; <italic>s</italic> &#x003C; <italic>b</italic><sub>2</sub>} be the set of all times over the time interval [<italic>t</italic><sub>0</sub>,<italic>t</italic><sub>0</sub> &#x002B; <italic>T</italic>] for which the stimulus is in the (<italic>b</italic><sub>1</sub>,<italic>b</italic><sub>2</sub>) region. Then <italic>S</italic><sub><italic>f</italic></sub> &#x2286; <italic>S</italic> where <italic>S</italic> &#x003D;{<italic>t</italic> &#x2208; [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub>0</sub> &#x002B; <italic>T</italic>]}. We define <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline46.gif"/></alternatives></inline-formula> to be the indicator function associated with the subset <italic>S</italic><sub><italic>f</italic></sub>
<disp-formula id="ueqn20"><alternatives><graphic xlink:href="322974_ueqn20.gif"/></alternatives></disp-formula></p>
<p>Let <italic>T</italic><sub><italic>f</italic></sub> be the amount of time that <italic>s</italic> is between <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>2</sub>:
<disp-formula id="ueqn21"><alternatives><graphic xlink:href="322974_ueqn21.gif"/></alternatives></disp-formula>
From the ergodic properties of <italic>s</italic>, and by the strong law of large numbers,
<disp-formula id="ueqn22"><alternatives><graphic xlink:href="322974_ueqn22.gif"/></alternatives></disp-formula>
where <italic>p</italic>(<italic>s</italic>) is the density associated with <italic>&#x03C0;</italic>(<italic>s</italic>), i.e. the stationary probability density function (PDF) of <italic>s</italic>:
<disp-formula id="ueqn23"><alternatives><graphic xlink:href="322974_ueqn23.gif"/></alternatives></disp-formula></p>
<p>The PDF (see SI Appendix 4) is given as a piecewise function <italic>p</italic><sub><italic>i</italic></sub>(<italic>s</italic>) for (<italic>i</italic> &#x2212; 1)<italic>k</italic> &#x2264; <italic>s</italic> &#x2264; <italic>ik</italic> where the piecewise elements satisfy recurrence equations that depend on <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline47.gif"/></alternatives></inline-formula>, &#x03C4; and <italic>k</italic>.</p>
<p>Let <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>2</sub> be the FN bifurcation values of the input to the FN that takes the system from quiescence into the oscillatory regime and from this regime into saturation respectively:
<disp-formula id="ueqn24"><alternatives><graphic xlink:href="322974_ueqn24.gif"/></alternatives></disp-formula>.</p>
<p>The size of the oscillatory region is given by the difference between <italic>b</italic><sub>2</sub> and <italic>b</italic><sub>1</sub> and it decreases with increasing volatility <italic>c</italic> (see SI <xref ref-type="fig" rid="figS4">Fig S4</xref>). For constant <italic>s</italic> where <italic>b</italic><sub>1</sub> &#x2264; <italic>s</italic> &#x2264; <italic>b</italic><sub>2</sub>, the output rate is a constant given by the oscillation frequency of the FN when driven by a constant input <italic>s</italic>.</p>
<p>For <italic>s</italic> not constant, the FN transitions between quiescence, oscillatory behavior, and saturation as <italic>s</italic> varies. For <italic>&#x03F5;</italic><sub>1</sub> &#x226A; 1, the FN dynamics are much faster than the dynamics of <italic>s</italic>, and the number of foragers leaving the nest in a given time period [<italic>t</italic><sub>0</sub>,<italic>t</italic><sub>0</sub> &#x002B; <italic>T</italic>] is proportional to <italic>T</italic><sub><italic>f</italic></sub>, the amount of time spent by <italic>s</italic> in the oscillatory region.</p>
<p>For <italic>T</italic> &#x2192; &#x221E;, nonlinear effects in the oscillations become negligible and the mean outgoing rate becomes
<disp-formula id="ueqn25"><alternatives><graphic xlink:href="322974_ueqn25.gif"/></alternatives></disp-formula>
where <italic>f</italic><sub><italic>&#x03F5;</italic>2</sub> is the mean oscillation frequency of the FN when the driving input is constant and equal to <italic>s</italic>. We approximate <italic>f</italic><sub><italic>&#x03F5;</italic>2</sub> &#x003D; 1/<italic>T</italic><sub><italic>LC</italic></sub> through the asymptotic representation [<xref ref-type="bibr" rid="c2">2</xref>]:
<disp-formula id="ueqn26"><alternatives><graphic xlink:href="322974_ueqn26.gif"/></alternatives></disp-formula>
where <italic>T</italic><sub>0</sub>, <italic>C</italic><sub>1</sub>, and <italic>C</italic><sub>2</sub> are given in SI Appendix 1 to obtain an approximate expression for how <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline48.gif"/></alternatives></inline-formula> changes as a function of both <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline54.gif"/></alternatives></inline-formula> and <italic>c</italic>:
<disp-formula id="ueqn27"><alternatives><graphic xlink:href="322974_ueqn27.gif"/></alternatives></disp-formula>.</p>
</sec>
</app>
<app id="app4">
<title>SI Appendix 4</title>
<sec>
<title>Probability Density Function of s(t)</title>
<p>Here we find an analytical description of the probability density function of the stimulus function <italic>s</italic>(<italic>t</italic>) under the assumption that the incoming rate is a Poisson process. Under this assumption <italic>s</italic>(<italic>t</italic>) takes the form of a Poisson shot-noise process. Before we state our results, we state a result by Gilbert and Pollak. 1959 [<xref ref-type="bibr" rid="c5">5</xref>]:</p>
<statement>
<label>Lemma 1.</label>
<p><italic>The amplitude distribution function F</italic><sub><italic>s</italic></sub>(<italic>&#x03BE;</italic>) &#x003D; <italic>Pr</italic>[<italic>s</italic>(<italic>t</italic>)&#x2264;<italic>&#x03BE;</italic>] <italic>for the shot noise process</italic>
<disp-formula id="ueqn28"><alternatives><graphic xlink:href="322974_ueqn28.gif"/></alternatives></disp-formula>
<italic>where h(t) is called the impulse shape function, satisfies the integral equation</italic>
<disp-formula id="ueqn29"><alternatives><graphic xlink:href="322974_ueqn29.gif"/></alternatives></disp-formula>.</p>
</statement>
<statement>
<p><italic>Proof.</italic> We refer the reader to [<xref ref-type="bibr" rid="c5">5</xref>] for the proof.</p>
</statement>
<statement>
<label>Theorem 2.</label>
<p><italic>The steady-state probability density function of the shot-noise process with exponential decay with impulses arriving with rate</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline49.gif"/></alternatives></inline-formula>
<disp-formula id="ueqn30"><alternatives><graphic xlink:href="322974_ueqn30.gif"/></alternatives></disp-formula>
<italic>where</italic>
<disp-formula id="ueqn31"><alternatives><graphic xlink:href="322974_ueqn31.gif"/></alternatives></disp-formula>
<italic>is given as a piecewise function p</italic><sub><italic>i</italic></sub>(<italic>s</italic>) <italic>for</italic> (<italic>i</italic> &#x2212; 1)<italic>k</italic> &#x2264; <italic>s</italic> &#x003C; <italic>ik where the piecewise elements satisfy the recurrence equations</italic>:
<disp-formula id="ueqn32"><alternatives><graphic xlink:href="322974_ueqn32.gif"/></alternatives></disp-formula>
<italic>with</italic>
<disp-formula id="ueqn33"><alternatives><graphic xlink:href="322974_ueqn33.gif"/></alternatives></disp-formula>
<italic>where</italic> &#x03B3; &#x003D; 0.5772&#x2026; <italic>is Euler&#x2019;s constant and</italic> &#x0393; <italic>is the gamma function.</italic></p>
</statement>
<statement>
<p><italic>Proof.</italic> For a Poisson shot noise process in with impulse shape function:
<disp-formula id="ueqn34"><alternatives><graphic xlink:href="322974_ueqn34.gif"/></alternatives></disp-formula>,
the integral equation in Lemma 1 can be rewritten as
<disp-formula id="ueqn35"><alternatives><graphic xlink:href="322974_ueqn35.gif"/></alternatives></disp-formula>.
where <italic>p</italic>(<italic>s</italic>) &#x003D; d<italic>F</italic><sub>s</sub>/d<italic>s</italic> be the density function of <italic>s</italic>.</p>
</statement>
<p>Differentiating with respect to <italic>s</italic>, we obtain
<disp-formula id="eqnA1"><alternatives><graphic xlink:href="322974_eqnA1.gif"/></alternatives></disp-formula>.</p>
<p>When 0 &#x2264; <italic>s</italic> &#x2264; <italic>k</italic>, <italic>P</italic><sub><italic>s</italic></sub>(<italic>s</italic> &#x2212; <italic>k</italic>) &#x003D; 0, and
<disp-formula id="ueqn36"><alternatives><graphic xlink:href="322974_ueqn36.gif"/></alternatives></disp-formula>.</p>
<p>Picking <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline50.gif"/></alternatives></inline-formula> satisfies the equation above, so we have obtained a solution for <italic>p</italic><sub><italic>s</italic></sub>(<italic>s</italic>) when 0 &#x2264; <italic>s</italic> &#x2264; <italic>k</italic>. For larger values of <italic>s</italic>, the differential equation <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> may be converted to an integral form
<disp-formula id="ueqn37"><alternatives><graphic xlink:href="322974_ueqn37.gif"/></alternatives></disp-formula>.</p>
<p>Since the integrand is known for <italic>x</italic> &#x003C; 2<italic>k</italic>, we can determine <italic>p</italic><sub><italic>s</italic></sub>(<italic>s</italic>) for <italic>s</italic> &#x003C; 2<italic>k</italic>. This in turn enables us to integrate further to get <italic>p</italic><sub><italic>s</italic></sub>(<italic>s</italic>) for <italic>s</italic> &#x003C; 3<italic>k</italic>, etc. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline51.gif"/></alternatives></inline-formula>, then the results for the first three jump regions <italic>p</italic><sub><italic>i</italic></sub>, <italic>i</italic> &#x003D; 1, 2, 3 are given by
<disp-formula id="ueqn38"><alternatives><graphic xlink:href="322974_ueqn38.gif"/></alternatives></disp-formula></p>
<p>We now show by induction that <italic>P</italic>(<italic>s</italic>) satisfies the recurrence equations
<disp-formula id="ueqn39"><alternatives><graphic xlink:href="322974_ueqn39.gif"/></alternatives></disp-formula>
with <italic>p</italic><sub>0</sub> &#x003D; 0, <italic>g</italic><sub>1</sub>(<italic>s</italic>) &#x003D; 1. For <italic>n</italic> &#x003D; 1,
<disp-formula id="ueqn40"><alternatives><graphic xlink:href="322974_ueqn40.gif"/></alternatives></disp-formula>
as expected. Now, assume that for <italic>n</italic> &#x003D; <italic>j</italic>
<disp-formula id="ueqn41"><alternatives><graphic xlink:href="322974_ueqn41.gif"/></alternatives></disp-formula></p>
<p>Then, for <italic>n</italic> &#x003D; <italic>j</italic> &#x002B; 1
<disp-formula id="ueqn42"><alternatives><graphic xlink:href="322974_ueqn42.gif"/></alternatives></disp-formula>.</p>
<p>Finally, the constant &#x03B1; must be determined by the condition
<disp-formula id="ueqn43"><alternatives><graphic xlink:href="322974_ueqn43.gif"/></alternatives></disp-formula>.</p>
<p>To compute the constant, we first note that the characteristic equation of <italic>s</italic> is given by
<disp-formula id="ueqn44"><alternatives><graphic xlink:href="322974_ueqn44.gif"/></alternatives></disp-formula>
(see [<xref ref-type="bibr" rid="c3">3</xref>] for derivation). The characteristic function is the Laplace transform <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="322974_inline52.gif"/></alternatives></inline-formula> of <italic>p</italic><sub><italic>s</italic></sub>,
<disp-formula id="ueqn45"><alternatives><graphic xlink:href="322974_ueqn45.gif"/></alternatives></disp-formula>.</p>
<p>Using partial integration, this can be rewritten as
<disp-formula id="ueqn46"><alternatives><graphic xlink:href="322974_ueqn46.gif"/></alternatives></disp-formula>.</p>
<p>Thus, for 0 &#x2264; <italic>s</italic> &#x2264; <italic>k</italic>,
<disp-formula id="ueqn47"><alternatives><graphic xlink:href="322974_ueqn47.gif"/></alternatives></disp-formula>
where &#x03B3; &#x003D; 0.5772&#x2026; is Euler&#x2019;s constant and &#x0393; is the gamma function.</p>
</sec>
</app>
</app-group>
<ref-list>
<title>References</title>
<ref id="c40"><label>1.</label><mixed-citation publication-type="website"><article-title>The Weather Company LLC, Weather Underground - Ramuda Drive KNM-RODEO3</article-title>. <ext-link ext-link-type="uri" xlink:href="https://www.wunderground.com/personal-weather-station/dashboard&#x003F;ID=KNMRODEO3#history">https://www.wunderground.com/personal-weather-station/dashboard?ID=KNMRODEO3#history</ext-link>.</mixed-citation></ref>
<ref id="c41"><label>2.</label><mixed-citation publication-type="book"><string-name><surname>Mishchenko</surname> <given-names>E</given-names></string-name>, <string-name><surname>Rozov</surname> <given-names>N Kh</given-names></string-name>. <source>Differential equations with small parameters and relaxation oscillations</source>. <publisher-loc>Boston</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1980</year>.</mixed-citation></ref>
<ref id="c42"><label>3.</label><mixed-citation publication-type="book"><string-name><surname>Ross</surname> <given-names>SM</given-names></string-name>. <collab>Stochastic Processes</collab>. <edition>2nd ed.</edition> <chapter-title>Wiley series in mathematical statistics</chapter-title>. <source>Probability and mathematical statistics</source>. <publisher-name>Wiley</publisher-name>; <year>1996</year>.</mixed-citation></ref>
<ref id="c43"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Borovkov</surname> <given-names>K</given-names></string-name>, <string-name><surname>Novikov</surname> <given-names>A</given-names></string-name>. <article-title>On a piece-wise deterministic Markov process model</article-title>. <source>Stat Probab Lett</source>. <year>2001</year>;<volume>53</volume>(<issue>4</issue>):<fpage>421</fpage>&#x2013;<lpage>428</lpage>.</mixed-citation></ref>
<ref id="c44"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Gilbert</surname> <given-names>E</given-names></string-name>, <string-name><surname>Pollak</surname> <given-names>H</given-names></string-name>. <article-title>Amplitude distribution of shot noise</article-title>. <source>Bell Syst Tech J.</source> <year>1960</year>;<volume>39</volume>(<issue>2</issue>):<fpage>333</fpage>&#x2013;<lpage>350</lpage>.</mixed-citation></ref>
</ref-list>
</back></article>