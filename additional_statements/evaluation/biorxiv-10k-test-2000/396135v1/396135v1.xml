<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en"><front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/396135</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Determination of essential phenotypic elements of clusters in high-dimensional entities - DEPECHE</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8752-3151</contrib-id>
<name>
<surname>Theorell</surname>
<given-names>Axel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bryceson</surname>
<given-names>Yenan Troi</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Theorell</surname>
<given-names>Jakob</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>IBG-1: Biotechnology, Institute of Bio-and Geosciences, Forschungszentrum J&#x00FC;lich GmbH</institution>, J&#x00FC;lich, North Rhine-Westphalia, <country>Germany</country></aff>
<aff id="a2"><label>2</label><institution>Center for Hemotology and Regenerative Medicine, Department of Medicine Huddinge, Karolinska Institutet</institution>, Stockholm, <country>Sweden</country></aff>
<aff id="a3"><label>3</label><institution>Broegelmann Research Laboratory, Department of Clinical Medicine, University of Bergen</institution>, Bergen, <country>Norway</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author Email: <email>Jakob.Theorell@ki.se</email> (JT)</corresp>
<fn id="n1" fn-type="equal"><p>Author contributions: A.T. drafted mathematical models, coded the software implementation and co-wrote the manuscript, Y.T.B. co-wrote the manuscript, J.T. drafted mathematical models, coded software implementation and wrote the manuscript.</p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>396135</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>20</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>8</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="396135.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Technological advances have facilitated an exponential increase in the amount of information that can be derived from single cells, necessitating new computational tools that can make this highly complex data interpretable. Here, we introduce DEPECHE, a rapid, parameter free, sparse k-means-based algorithm for clustering of multi-and megavariate single-cell data. In a number of computational benchmarks aimed at evaluating the capacity to form biologically relevant clusters, including flow/mass-cytometry and single cell RNA sequencing data sets with manually curated gold standard solutions, DEPECHE clusters as well or better as the best performing state-of-the-art clustering algorithms. However, the main advantage of DEPECHE, compared to the state-of-the-art, is its unique ability to enhance interpretability of the formed clusters, in that it only retains variables relevant for cluster separation, thereby facilitating computational efficient analyses as well as understanding of complex datasets. An open source R implementation of DEPECHE is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/theorell/DepecheR">https://github.com/theorell/DepecheR</ext-link>.</p><sec>
<title>Author summary</title>
<p>DEPECHE-a data-mining algorithm for mega-variate data</p>
<p>Modern experimental technologies facilitate an array of single cells measurements, <italic>e.g.</italic> at the RNA-level, generating enormous datasets with thousands of annotated biological markers for each of thousands of cells. To analyze such datasets, researchers routinely apply automated or semi-automated techniques to order the cells into biologically relevant groups. However, even after such groups have been generated, it is often difficult to interpret the biological meaning of these groups since the definition of each group often dependends on thousands of biological markers. Therefore, in this article, we introduce DEPECHE, an algorithm designed to simultaneously group cells and enhance interpretability of the formed groups. DEPECHE defines groups only with respect to biological markers that contribute significantly to differentiate the cells in the group from the rest of the cells, yielding more succinct group definitions. Using the open source R software DepecheR on RNA sequencing data and mass cytometry data, the number of defining markers were reduced up to 1000-fold, thereby increasing interpretability vastly, while maintaining or improving the biological relevance of the groups formed compared to state-of-the-art algorithms.</p></sec>
</abstract>
<counts>
<page-count count="27"/>
</counts>
</article-meta>
<bio>
<title>Author contributions</title>
<p>A.T. drafted mathematical models, <underline>coded</underline> the software implementation and co-wrote the manuscript, Y.T.B. co-wrote the manuscript, J.T. drafted mathematical models, coded software implementation and wrote the manuscript.</p>
</bio>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Since the introduction of the first single colour flow cytometers in the 1960s, there has been a remarkable increase in the complexity of data that can be generated with single-cell resolution. Currently, flow and mass cytometers able to simultaneously assess up to 40 cellular traits are becoming widely available [<xref ref-type="bibr" rid="c1">1</xref>]. In parallel, the development of high-throughput sequencing technology has facilitated deep single-cell transcriptomic analyses [<xref ref-type="bibr" rid="c2">2</xref>]. Furthermore, development of high-resolution single-cell proteomic analyses are underway [<xref ref-type="bibr" rid="c3">3</xref>].</p>
<p>These technological advances necessitate new computational approaches to analyses of multi-and megavariate single cell data [<xref ref-type="bibr" rid="c4">4</xref>&#x2013;<xref ref-type="bibr" rid="c7">7</xref>]. Previous algorithms have contributed to automating analyses, thereby enhancing reproducibility and avoiding a need for <italic>a priori</italic> biological knowledge for design of manual gating analysis strategies. Automated analysis algorithms, not restricted to uni-or bivariate displays of the data, have also made it possible to display much more of the information embedded in multivariate data. To date, however, manual gating strategies are still dominantly used, which in part is likely due to that it is easy to interpret what population a certain gate refers to, as it is defined by few markers. In an attempt to combine the objectiveness and reproducibility of automated analysis pipelines with the high interpretability of manual gating strategies, we have developed an algorithm termed Determination of Essential Phenotypic Elements of Clusters in High-dimensional Entities (DEPECHE). DEPECHE simultaneously clusters and simplifies the data by identifying the variables that contribute to separate individual clusters from the rest of the data. We have implemented DEPECHE in R (in the open source package DepecheR), providing a complete software suite for statistical analysis and visualization of single cell omics data.</p>
</sec>
<sec id="s2">
<title>Results and Discussion</title>
<p>DEPECHE uses a penalized k-means clustering algorithm, related to the standard k-means algorithm [<xref ref-type="bibr" rid="c8">8</xref>]. In penalized k-means, a penalty term is introduced to the clustering algorithm. The value of the penalty, <italic>&#x03BB;</italic>, determines the clustering resolution. Low clustering resolution implies that few clusters defined by few variables (high sparsity) are produced, and vice versa [<xref ref-type="bibr" rid="c9">9</xref>] (see online methods). Note that if <italic>k</italic> is high enough not to be limiting, the resolution of the emerging clusters depends entirely on the magnitude of <italic>&#x03BB;</italic> and not on k, since DEPECHE annihilates all clusters that are pulled to the origin by the penalty. In DEPECHE, the penalty <italic>&#x03BB;</italic> is tuned to identify the most <italic>reproducible</italic> clustering resolution, here termed the &#x201C;optimal resolution&#x201D;[<xref ref-type="bibr" rid="c10">10</xref>]. To illustrate what we mean by reproducible, we constructed a show case, featuring a bi-variate dataset <italic>D</italic> (<xref rid="fig1" ref-type="fig">Fig 1a</xref>). Visually, the dataset <italic>D</italic> contains three clusters, where the centers of the two larger clusters are located close to either axis. For these two clusters, one variable is sufficient to define their position. Now, if multiple datasets were generated from the same data source as <italic>D</italic>, for example by repeated experiments, we assume that they would contain the same clusters. Hence, imposing the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> (that corresponds to the optimal resolution of <italic>D</italic>) on all these datasets should ideally always result in the same clusters (high reproducibility). Contrarily, when clustering the same datasets with a penalty <italic>&#x03BB;</italic> that differ significantly from the optimal penalty, the stochastic differences between the datasets are likely to induce solutions that deviate in cluster number, number of defining variables, and cluster center positions. In practice, DEPECHE tests a range of penalty values (<italic>&#x03BB;</italic><sub>1</sub> &#x003C; &#x22EF; &#x003C; <italic>&#x03BB;</italic><sub><italic>n</italic></sub>), each on a collection of dataset pairs which are generated by sampling <italic>N</italic><sub><italic>R</italic></sub> data points from <italic>D</italic> (<xref rid="fig1" ref-type="fig">Fig 1b</xref>) with resampling. The optimal resolution is defined as the penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub>, which yields the lowest average variability within each dataset pair, as measured by the Adjusted Rand Index (ARI) [<xref ref-type="bibr" rid="c11">11</xref>]. In our example, this corresponds to the penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> that yields 3 clusters, since 3 similar clusters are identified in each resampled dataset of <italic>D</italic> (<xref rid="fig1" ref-type="fig">Fig 1c</xref>). The penalties <italic>&#x03BB;</italic><sub>1</sub> and <italic>&#x03BB;</italic><sub><italic>n</italic></sub> are considered suboptimal, since with these penalties, the stochastic differences in the resampled datasets lead to less coherent clustering results compared to results obtained with the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub>. From here (<xref rid="fig1" ref-type="fig">Fig 1c</xref>) DEPECHE uses two alternative routes. If the number of data points in the dataset <italic>D</italic> is high (as default &#x003E; 10<sup>4</sup>), the most generalizable cluster centers that were produced using the optimal penalty are chosen (see online methods) and the data points of <italic>D</italic> are allocated directly to their closest cluster center (<xref rid="fig1" ref-type="fig">Fig 1d</xref>). If the dataset <italic>D</italic> has few data points, the full dataset <italic>D</italic> is clustered using the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> (<xref rid="fig1" ref-type="fig">Fig 1e</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig 1:</label>
<caption><title>Illustration of the DEPECHE workflow:</title>
<p>a) The original dataset <italic>D</italic>. b) <italic>n</italic> resampled datasets with <italic>N</italic><sub><italic>R</italic></sub> data points per dataset, are generated by sampling data points from <italic>D</italic> with resampling. Each resampled dataset has a corresponding penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> (<italic>i =</italic> 1,,, <italic>n</italic>). c) Each dataset in b is clustered with sparse k-means, using its corresponding penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub>. The red frame highlights the clustering with the strongest attractors, <italic>i.e.</italic> the most generalizable solution (see online methods). d, e) Finally, the full dataset is clustered by allocating each data point to its closest cluster center, using the most generalizable cluster center solution produced in b.</p></caption>
<graphic xlink:href="396135_fig1.tif"/>
</fig>
<p>To evaluate how biologically accurate DEPECHE clustering is on mass cytometry data, a 32-variate mass cytometry bone marrow dataset [<xref ref-type="bibr" rid="c12">12</xref>] was clustered, and the overlap to 14 manually pre-defined cell populations was quantified using the ARI. With this dataset, DEPECHE identified 7 clusters at the optimal resolution, corresponding to all large pre-defined cell populations and to agglomerates of smaller cell populations, rendering an average ARI of 0.96, where an ARI of 1 corresponds to exact reproduction and an ARI of 0 means that the produced clusters are no more accurate than random allocation. (<xref rid="fig2" ref-type="fig">Fig 2a-b</xref>, S <xref rid="fig1" ref-type="fig">Fig 1a</xref>). Furthermore, using DEPECHE, the number of variables defining each cluster was reduced from 32 to a range from 8 to 28, thereby enhancing interpretability (<xref rid="fig2" ref-type="fig">Fig 2d</xref>). When comparing to other state-of-the-art clustering algorithms [<xref ref-type="bibr" rid="c12">12</xref>&#x2013;<xref ref-type="bibr" rid="c17">17</xref>], DEPECHE obtained similar ARI as the best algorithms for both the 32-variate dataset and another 14-variate, 24 population, mass cytometry dataset [<xref ref-type="bibr" rid="c18">18</xref>] (S <xref rid="fig2" ref-type="fig">Fig 2a</xref>, <xref rid="tbl1" ref-type="table">Table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>background information on all datasets</p></caption>
<graphic xlink:href="396135_tbl1.tif"/>
</table-wrap>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig 2:</label>
<caption><title>DEPECHE performance with real datasets with 32 or 35177 variables.</title>
<p>a-b) bi-variate t-distributed stochastic neighbor embedding (tSNE) representation of the 32-variate mass cytometry data. A: distribution of manually defined cell populations over the tSNE field. B: distribution of DEPECHE clusters over the tSNE field. c) Heatmap showing which variables that define each cluster. Red color indicates a higher expression in the cluster than the most common expression for all observations. Blue color conversely indicates lower expression than the geometric mean for all observations. Grey color indicates that the variable in question does not contribute to defining the cluster. For Fig a-c all, 104184 cells have been clustered. d-tSNE representation of the 137-variate data subset that could efficiently distinguish the clusters in the 35177-variate single-cell transcriptome dataset. d) distribution of the cell types defined by index-sorting and manual gating on protein expression profiles shown over the tSNE field. e) distribution of DEPECHE clusters over the tSNE field. f) Violin plots illustrating the overlap between the original analysis by Bj&#x00F6;rklund <italic>et al</italic> and the DEPECHE analysis. For each subplot, the left and right side illustrate the distribution of the transcripts defining the clusters, and all other transcripts, respectively. The y-axis shows the log10 of the p-values in the original analysis adjusted for multiple comparisons. For Fig d-f, all 648 cells have been clustered.</p></caption>
<graphic xlink:href="396135_fig2.tif"/>
</fig>
<p>Single-cell transcriptomic datasets feature tens of thousands of variables. Thus, the need to exclude irrelevant variables is even more pressing, as compared to cytometry datasets. We therefore evaluated DEPECHE&#x2019;s ability to cluster and extract the key transcripts defining clusters of a previously published single-cell transcriptomic dataset (<xref rid="fig2" ref-type="fig">Fig 2d</xref>-f) [<xref ref-type="bibr" rid="c19">19</xref>]. In this dataset, a total of 648 ILC1, ILC2, ILC3 and NK cells from three donors&#x2019; tonsils were index-sorted prior to RNA sequencing. Hence, these cell types, manually defined by protein expression, can be compared to clusters unbiasedly determined by RNA expression profiles [<xref ref-type="bibr" rid="c19">19</xref>]. In the DEPECHE analysis, no pre-selection of transcripts was performed, and hence, 35177 unique transcripts were included for each of the 648 cells. With the optimal penalty <italic>&#x03BB;</italic>, four clusters were identified (<xref rid="fig2" ref-type="fig">Fig 2e</xref>). These corresponded well to the cell types as defined by protein expression; 84, 97, 91 and 97 percent of ILC1, ILC2, ILC3 and NK cells sorted into separate clusters, respectively (<xref rid="fig2" ref-type="fig">Fig 2d</xref>, e, S <xref rid="fig1" ref-type="fig">Fig 1b</xref>), leading to an average ARI of 0.78. Notably, cluster 1-4, corresponding to ILC1, ILC3, NK cells and ILC2, were defined by 27, 27, 108 and 10 transcripts, respectively (<xref rid="fig2" ref-type="fig">Fig 2f</xref> and <xref rid="tbl2" ref-type="table">Table 2</xref>), leading to a 99.9&#x0025; average decrease in the number of variables. The transcripts identified to define the clusters in our analysis were among those most differentially expressed according to the original study [<xref ref-type="bibr" rid="c19">19</xref>] (<xref rid="fig2" ref-type="fig">Fig 2f</xref>). Thus, by identifying a finite number of variables, DEPECHE analysis increases interpretability and aides down-stream analyses. When DEPECHE clustering was compared to that of state-of-the-art algorithms [<xref ref-type="bibr" rid="c5">5</xref>&#x2013;<xref ref-type="bibr" rid="c7">7</xref>] on the aforementioned dataset and six others (see <xref rid="tbl1" ref-type="table">Table 1</xref>), it performed consistently well as indicated by ARI (S <xref rid="fig2" ref-type="fig">Fig 2b</xref>). Thus, when applied to megavariate data, DEPECHE produces biologically relevant clusters and reduces the complexity of the result thousand-fold.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>transcripts defining clusters in Bj&#x00F6;rklund <italic>et al</italic> dataset</p></caption>
<graphic xlink:href="396135_tbl2.tif"/>
</table-wrap>
<p>In conclusion, DEPECHE turns the penalized k-means methodology into a parameter free analysis technique guided by efficient calculation of the optimal clustering resolution. By doing so, it addresses the simultaneous problem of clustering and identification of biologically important variables that separate clusters. This is crucial in order to comprehend the noisy and often over-complicated data generated with current single cell technologies.</p>
</sec>
<sec id="s3">
<title>Methods</title>
<sec id="s3a">
<title>Clustering with DEPECHE</title>
<p>Clustering in DEPECHE is performed using a penalized version of the k-means algorithm, which is related to the k-means algorithm[<xref ref-type="bibr" rid="c8">8</xref>]. In this section, the k-means algorithm is outlined first, followed by an explanation of how it is extended to penalized k-means.</p>
<p>The k-means algorithm clusters data by fitting a mixture of normal distributions to the data with k equal mixture components and unit variance. Formally, <italic>k d</italic> -dimensional cluster centers, denoted <italic>&#x03BC;</italic><sub><italic>i</italic>,<italic>j</italic></sub> where <italic>i =</italic> 1 &#x2026; <italic>k</italic> and <italic>j =</italic> 1 &#x2026; <italic>d</italic>, are fitted to the <italic>n d</italic> -dimensional datapoints <italic>x</italic><sub><italic>l</italic>,<italic>j</italic></sub>, where <italic>l =</italic> 1 &#x2026; <italic>n</italic>, by maximizing the score function
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="396135_eqn1.gif"/></alternatives>
</disp-formula>
where <italic>z</italic><sub><italic>i</italic>,<italic>l</italic></sub> is 1 if the <italic>l</italic>th data point belongs to the <italic>i</italic>th cluster and zero otherwise. The score <italic>Q</italic> is optimized using an Expectation Maximization (EM) algorithm [<xref ref-type="bibr" rid="c20">20</xref>], <italic>i.e.</italic> so called E-and M-steps are iterated alternatingly until the score <italic>Q</italic> stops improving. In the E-step, the allocation variables <italic>z</italic><sub><italic>i</italic>,<italic>l</italic></sub> are updated so that each data point is allocated to its closest cluster. In the M-step, each cluster center <italic>&#x03BC;</italic><sub><italic>i</italic>,<italic>j</italic></sub> is moved to the center of the data points allocated to it. When no more reallocation occurs in the E-step, the algorithm has converged.</p>
<p>In order to reduce the influence of uninformative dimensions that only contribute with noise, penalized k-means introduces an L1-penalty for each element of each cluster center <italic>&#x03BC;</italic><sub><italic>i</italic>,<italic>j</italic></sub> to the optimization objective. Formally, the score function <italic>Q</italic> in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, is updated:
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="396135_eqn2.gif"/></alternatives>
</disp-formula>
where <italic>&#x03BB;</italic> is a positive penalty term. The additional term in the score function, introduced in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> results in a change in the M-step of the original EM-algorithm of the k-means algorithm. Keeping <italic>z</italic><sub><italic>i</italic>,<italic>l</italic></sub> for all <italic>l</italic> fixed and optimizing <italic>Q</italic> with respect to <italic>&#x03BC;</italic><sub><italic>i</italic>,<italic>j</italic></sub>, the M-step is:
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="396135_eqn3.gif"/></alternatives>
</disp-formula></p>
<p>Bepending on the choice of the penalty parameter <italic>&#x03BB;</italic>, some components of some clusters centers will be set to 0 in the M-step. Note that penalized k-means with penalty <italic>&#x03BB; =</italic> 0 reduces to the original k-means algorithm.</p>
<p>In DEPECHE, cluster centers that are moved to the origin in the M-step are eliminated and not assigned any data points in the E-step. Due to the elimination of clusters, the number of produced clusters is independent of <italic>k</italic> and dependent on the penalty <italic>&#x03BB;</italic> as long as at least one cluster is eliminated. In DEPECHE, <italic>k</italic> is always chosen to be so large that at least one cluster is eliminated.</p>
<p><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> is a special case of the penalized model based clustering algorithm by Pan and Shen with unit variance and equal mixture components [<xref ref-type="bibr" rid="c9">9</xref>]. By imposing the penalty for each dimension and each cluster, penalized k-means identifies the dimensions that do not distinguish a particular cluster from the rest of the data, thus leaving these dimensions out of the definition of that cluster. This differs from the sparse k-means algorithm by Witten and Tibshirani [<xref ref-type="bibr" rid="c21">21</xref>] and the regularized k-means algorithm by Sun et al [<xref ref-type="bibr" rid="c10">10</xref>], that only identify dimensions that do not contribute to distinguish any cluster from the rest of the data.</p>
<p>Penalized k-means, as well as k-means, relies on a procedure for initializing the positions of the cluster centers. Cluster initialization is particularly delicate in DEPECHE, due to the elimination of clusters at the origin in the E-step. Poor initialization of the clusters might lead to elimination of too many clusters in the early E-steps, yielding fewer clusters in the end result than necessary to optimize <italic>Q</italic>. To avoid early elimination of clusters, DEPECHE initializes the cluster positions using the seed generation algorithm of k-means&#x002B;&#x002B; by Arthur and Vassilvitskii[<xref ref-type="bibr" rid="c22">22</xref>] and always starts clustering with penalty <italic>&#x03BB; =</italic> 0. The penalty is then increased linearly over a number of E-steps until it reaches the predetermined value.</p>
<p>The EM-algorithm guarantees convergence to an optimum of the score <italic>Q</italic>, but not necessarily to the global optimum. In order to diminish the influence of the starting state, the EM-algorithm is run several times with random initialization, and the solution with optimal <italic>Q</italic> is chosen. In addition, <italic>k</italic> is set considerably higher than the expected number of final clusters, which also diminishes the sensitivity to the starting state. In the extreme case where <italic>k</italic> is set equal to the number of data points <italic>n</italic>, the outcome of penalized k-means is deterministic.</p>
</sec>
<sec id="s3b">
<title>Tuning the penalty</title>
<p>In this section, we describe the optimization scheme which is used for tuning the linear penalty <italic>&#x03BB;</italic>. The outline of the algorithm:</p>
<list list-type="order">
<list-item><p>Choose a range of penalty terms <italic>&#x03BB;</italic><sub><italic>i</italic></sub>, <italic>i =</italic> 1.. <italic>N</italic><sub><italic>&#x03BB;</italic></sub> that are considered for clustering the dataset <italic>D</italic></p></list-item>
<list-item><p>Create 2 datasets per penalty term <italic>&#x03BB;</italic><sub><italic>i</italic></sub>, called <italic>D</italic><sub>1,<italic>i</italic></sub> and <italic>D</italic><sub>2,<italic>i</italic></sub>, by sampling <italic>N</italic><sub><italic>r</italic></sub> data points from <italic>D</italic> with replacement.</p></list-item>
<list-item><p>Run the penalized k-means algorithm on the datasets <italic>D</italic><sub>1,<italic>i</italic></sub> and <italic>D</italic><sub>2,<italic>i</italic></sub>, yielding sets of cluster centers, denoted ?<sub>1,<italic>i</italic></sub> and ?<sub>2,<italic>i</italic></sub>.</p></list-item>
<list-item><p>Create the partitions <italic>P</italic><sub>1,<italic>i</italic></sub> and <italic>P</italic><sub>2,<italic>i</italic></sub>, by allocating all data points of the dataset <italic>D</italic> to their nearest cluster center of the sets ?<sub>1,<italic>i</italic></sub> and ?<sub>2,<italic>i</italic></sub>.</p></list-item>
<list-item><p>Determine the Adjusted Rand Index (ARI), denoted <italic>r</italic> (<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) from <italic>P</italic><sub>1,<italic>i</italic></sub> to <italic>P</italic><sub>2,<italic>i</italic></sub> [<xref ref-type="bibr" rid="c11">11</xref>].</p></list-item>
<list-item><p>Repeat step 2-5 times and average the obtained ARIs <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) penalty wise until a stopping criteria regarding the statistical certainty of the obtained ARIs <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) is met.</p></list-item>
<list-item><p>Choose the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub>, which is the penalty with the largest ARI <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>).</p></list-item>
</list>
<p>Some remarks to the parameter tuning procedure: The repetition Step 6 is necessary, since the obtained ARI <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) is a random variable, due to the random procedure for creating the datasets <italic>D</italic><sub>1,<italic>i</italic></sub> and <italic>D</italic><sub>2,<italic>i</italic></sub> and the random procedure for initializing the penalized k-means algorithm. DEPECHE uses two stopping criteria: The first criterion creates an interval of width 2 standard errors around the obtained mean of <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) and checks if the interval around the optimal ARI <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) has a zero overlap with the other intervals. The second criterion checks whether the standard error of the mean of <italic>r</italic>(<italic>&#x03BB;</italic><sub><italic>i</italic></sub>) for the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> is below a threshold.</p>
<p>Step 2 requires a samples size <italic>N</italic><sub><italic>r</italic></sub>. A natural choice is to set <italic>N</italic><sub><italic>r</italic></sub> equal to the number of data points, <italic>n.</italic> However, in cases where <italic>n</italic> is very large, so that the computational load of the optimization scheme becomes limiting, it is preferable to choose a smaller <italic>N</italic><sub><italic>r</italic></sub>. In DepecheR, <italic>N</italic><sub><italic>r</italic></sub> <italic>=</italic> 10<sup>4</sup> by default, in case <italic>n</italic> &#x2265; 10<sup>4</sup>. Notice that when an optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub> is discovered using sample size <italic>N</italic><sub><italic>r</italic></sub> &#x2260; <italic>n</italic>, the corresponding optimal penalty when sampling the full dataset <italic>D</italic> with magnitude <italic>n</italic> is (approximately) <inline-formula><alternatives><inline-graphic xlink:href="396135_inline1.gif"/></alternatives></inline-formula>, since the attraction force of a cluster is proportional to the number of data points in it. Exact calculation of the ARI in step 5 is computationally intractable for large datasets. Therefore, DEPECHE relies on an approximate ARI computation, based on 10<sup>4</sup> random pairs of data points.</p>
</sec>
<sec id="s3c">
<title>Simultaneous Clustering and Parameter Tuning</title>
<p>For very large datasets (<italic>n</italic> &#x003E; 10<sup>8</sup>), not only the penalty optimization, but also the final clustering once the optimal penalty has been found may be computationally intractable. However, increasing the size of the dataset, does not necessarily lead to an increase in number of clusters at the optimal resolution. In this case, it is feasible to cluster a subset of the full dataset <italic>D</italic> to obtain cluster centers <italic>M</italic> and then allocate the remaining data points of <italic>D</italic> to their closest clusters in <italic>M</italic>. This boosts computational efficiency since allocation imposes a much smaller computational load than clustering. Since several subsets of <italic>D</italic> are produced and clustered during the tuning of the penalty parameter <italic>&#x03BB;</italic>, it seems natural to retrieve cluster centers <italic>M</italic> that were produced during the parameter tuning and use them to cluster <italic>D</italic>.</p>
<p>When picking a set of cluster centers <italic>M</italic> from the penalty tuning, the question arises which set of centers <italic>M</italic> to take, since several sets of centers, denoted <italic>M</italic><sub><italic>i</italic>,<italic>l</italic></sub> (<italic>l =</italic> 1,,, <italic>p</italic>), are produced for the optimal penalty <italic>&#x03BB;</italic><sub><italic>i</italic></sub>. In DEPECHE, the centers <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> that have the strongest similarity (on average) to the remaining <italic>p</italic> - 1 centers is chosen and is referred to as the most generalizable cluster set. The level of similarity between the centers <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>M</italic><sub><italic>i</italic>,<italic>l</italic></sub> is quantified using the ARI between the partitions <italic>P</italic><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>P</italic><sub><italic>i</italic>,<italic>l</italic></sub>, induced by allocating each data point of <italic>D</italic> to its closest cluster center in <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>M</italic><sub><italic>i</italic>,<italic>l</italic></sub> respectively.</p>
<sec id="s3c1">
<title>Empiric Performance of the Penalty Tuning Scheme</title>
<p>Roughly speaking, DEPECHE combines a flavored penalized k-means algorithm with a parameter tuning scheme, which identifies an optimal resolution. A naturally arising question is then whether the parameter tuning scheme is able to determine a biologically relevant resolution or if other penalized k-means clustering resolutions outperform the resolution chosen by DEPECHE. Using a range of datasets (<xref rid="tbl3" ref-type="table">Table 3</xref>), the biological relevance (measured in ARI to the manually curated solution) of the optimized DEPECHE partitions were compared to the biologically optimal partition among all partitions generated with 20 repetitions on each of a range of 11 penalties per dataset. Overall, the DEPECHE resolution-selection showed close to optimal performance, as the selected solutions only had a median of 0.02 lower ARI to the gold standard (range 0-0.065) than the best possible solution with all penalties (<xref rid="tbl3" ref-type="table">Table 3</xref>).</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><p>ARI between DEPECHE partitions and golden standard partitions</p></caption>
<graphic xlink:href="396135_tbl3.tif"/>
</table-wrap>
</sec>
</sec>
<sec id="s3d">
<title>Scaling and Centering the Data</title>
<p>The clusters produced by DEPECHE, as well as their interpretation, depends on the scaling and centering of the data. The scaling determines the relative importance of the measured variables, where variables with a larger spread have stronger influence on the clustering. The centering defines where zero occurs in each variable, thereby influencing the clustering results due to the linear penalty.</p>
<p>DEPECHE is applicable to a large range of datasets where the numbers of dimensions, <italic>d</italic>, and the number of data points, <italic>n</italic>, can vary with many orders of magnitude. The differing characteristics of these datasets require different treatments with respect to scaling and centering.</p>
<sec id="s3d1">
<title>Scaling</title>
<p>Empirically, a majority of single-cell transcriptome datasets tend to have a few variables where the variance is many orders of magnitude greater than in the other variables. In this case, the high-variance variables will <italic>de-facto</italic> determine the clustering, implying that the clustering will fail to take the majority of the measured information into account. To even out the influence of these high-variance variables on the clustering outcome, the data is log transformed when such variables are present. In DepecheR, this data behavior is detected automatically by concatenating all variables into a one dimensional vector, for which the kurtosis is calculated. A high kurtosis, indicates that the variables differ greatly in their internal variance. For datasets with low kurtosis, refraining from the log transform is preferable, since transformation distorts the information.</p>
</sec>
<sec id="s3d2">
<title>Centering</title>
<p>Centering the origin to be close to the bulk of the data is preferable, in order to have all biological clusters at approximately the same distance from the origin. Having some biological clusters close to the origin and some far off is often unwanted, since the linear penalty then imposes a preference for creating clusters close to the origin. Apart from influencing the clustering, the centering also determines the interpretation of the obtained sparsity. Just as for scaling, which centering scheme to apply depends on the dataset.</p>
<p>For low dimensional datasets (<italic>n</italic>&#x003E;100), DEPECHE applies maximal density centering, which sets the zero in each dimension to coincide with the highest data density. The density it computed by collecting the data in equally spaced bins (default number of bins in DepecheR is the number of data points <italic>n</italic> divided by 50), where the bin with the highest number of data points has the highest density. Using this scheme, sparsity (<italic>i.e.</italic> that a variable is non-contributing to the definition of a cluster) is interpreted as that the data points in the cluster do not deviate from the most common outcome. It also ensures that the origin is relatively close to the bulk of the data, since it is located at the most common outcome for each variable respectively. The benefit of this scheme is that it boosts sparsity, by declaring the most common outcome non-defining. However, for high dimensional datasets (<italic>n</italic> &#x2265; 100), maximal density centering can push the origin so far away from the center of mass of the dataset, that the penalty starts to impose an unwanted, artificial influence on the clustering, hampering the biological relevance of the clusters. To avoid this, DEPECHE imposes a mean centering scheme for such datasets, which locates the origin at the center of mass of the dataset.</p>
<p>A potential complication, related to centering, occurs when a biologically relevant cluster is located very close to the origin, since DEPECHE creates no clusters in the origin and will then force the cluster to merge with other clusters. However, this scenario was never detected in real data.</p>
</sec>
</sec>
<sec id="s3e">
<title>Experimental procedures</title>
<sec id="s3e1">
<title>Preprocessing of mass cytometry data</title>
<p>The benchmark datasets from Levine <italic>et al</italic> [<xref ref-type="bibr" rid="c12">12</xref>] and Bendall <italic>et al</italic>[<xref ref-type="bibr" rid="c18">18</xref>] were transformed using the flowTrans package [<xref ref-type="bibr" rid="c23">23</xref>] before used in any clustering algorithm.</p>
</sec>
<sec id="s3e2">
<title>Preprocessing of single-cell transcriptomic data</title>
<p>The dataset from Bj&#x00F6;rklund <italic>et al</italic> [<xref ref-type="bibr" rid="c19">19</xref>] was normalized using the sva package [<xref ref-type="bibr" rid="c24">24</xref>] as in the original manuscript. For this dataset, doublet variables were removed, lowering the number of variables from 64443 to 35177.</p>
<p>The gold-standard datasets used for benchmarking in the publication by Kiselev <italic>et al</italic> [<xref ref-type="bibr" rid="c5">5</xref>] were obtained in a pre-processed state. Before clustering with any algorithm, the gene filter function used in the sc3 package was used [<xref ref-type="bibr" rid="c5">5</xref>], with settings removing the genes that were expressed in more than 90&#x0025; of the cells. This resulted in the number of transcripts presented in <xref rid="tbl1" ref-type="table">Table 1</xref> (range 13608-19571 transcripts).</p>
</sec>
</sec>
<sec id="s3f" sec-type="availability">
<title>Code availability</title>
<p>All code necessary to generate the figures and tables in the manuscript are included in supporting code 1. The software package DepecheR is available for download at (<ext-link ext-link-type="uri" xlink:href="https://github.com/theorell/depecher">https://github.com/theorell/depecher</ext-link>).</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>The authors are grateful for all important input that has come from the initial users of the DepecheR software, especially Dr Niklas Bj&#x00F6;rkstr&#x00F6;m, Dr Jakob Micha&#x00EB;lsson and Sigrun Stultz. Other colleagues that have contributed seminally to the framework of ideas that have led to the creation of DEPECHE are Dr Bruce Bagwell and Dr Geoffrey Hart.</p>
</ack>
<sec>
<title>Author contributions</title>
<p>A.T. drafted mathematical models, co-wrote the software implementation and the manuscript, Y.T.B. co-wrote the manuscript, J.T. co-wrote mathematical models and drafted software implementation and the manuscript.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Spitzer</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Nolan</surname> <given-names>GP</given-names></string-name>. <article-title>Mass Cytometry: Single Cells, Many Features</article-title>. <source>Cell</source>. <year>2016</year>;<volume>165</volume>: <fpage>780</fpage>&#x2013;<lpage>791</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id></mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Tanay</surname> <given-names>A</given-names></string-name>, <string-name><surname>Regev</surname> <given-names>A.</given-names></string-name> <article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>. <source>Nature</source>. <year>2017</year>;<volume>541</volume>: <fpage>331</fpage>&#x2013;<lpage>338</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature21350</pub-id></mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Budnik</surname> <given-names>B</given-names></string-name>, <string-name><surname>Levy</surname> <given-names>E</given-names></string-name>, <string-name><surname>Slavov</surname> <given-names>N.</given-names></string-name> <article-title>Mass-spectrometry of single mammalian cells quantifies proteome heterogeneity during cell differentiation</article-title>. <source>bioRxiv</source>. <year>2017</year>; <fpage>102681</fpage>. doi:<pub-id pub-id-type="doi">10.1101/102681</pub-id></mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Saeys</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Gassen</surname> <given-names>SV</given-names></string-name>, <string-name><surname>Lambrecht</surname> <given-names>BN</given-names></string-name>. <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>. <source>Nat Rev Immunol</source>. <year>2016</year>;<volume>16</volume>: <fpage>449</fpage>&#x2013;<lpage>462</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id></mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Kiselev</surname> <given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname> <given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Andrews</surname> <given-names>T</given-names></string-name>, <string-name><surname>Yiu</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chandra</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal> <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>: <fpage>483</fpage>&#x2013;<lpage>486</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id></mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Guo</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Potter</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Whitsett</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>Y.</given-names></string-name> <article-title>SINCERA: A Pipeline for Single-Cell RNA-Seq Profiling Analysis</article-title>. <source>PLOS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004575</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id></mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>&#x017D;urauskien&#x0117;</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yau</surname> <given-names>C.</given-names></string-name> <article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinformatics</source>. <year>2016</year>;<volume>17</volume>: <fpage>140</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id></mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="book"><string-name><surname>MacQueen</surname> <given-names>J.</given-names></string-name> <chapter-title>Some methods for classification and analysis of multivariate observations</chapter-title>. <source>Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</source>. <publisher-name>Berkeley, California: University of California Press</publisher-name>; <year>1967</year>. pp. <fpage>281</fpage>&#x2013;<lpage>297</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="https://projecteuclid.org/euclid.bsmsp/1200512992">https://projecteuclid.org/euclid.bsmsp/1200512992</ext-link></mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Pan</surname> <given-names>W.</given-names></string-name> <article-title>Penalized model-based clustering with application to variable selection</article-title>. <source>J Mach Learn Res</source>. <year>2007</year>;<volume>8</volume>: <fpage>1145</fpage>&#x2013;<lpage>1164</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Sun</surname> <given-names>W</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fang</surname> <given-names>Y.</given-names></string-name> <article-title>Regularized k-means clustering of high-dimensional data and its asymptotic consistency</article-title>. <source>Electron J Stat</source>. <year>2012</year>;<volume>6</volume>: <fpage>148</fpage>&#x2013;<lpage>167</lpage>. doi:<pub-id pub-id-type="doi">10.1214/12-EJS668</pub-id></mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Hubert</surname> <given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname> <given-names>P.</given-names></string-name> <article-title>Comparing partitions</article-title>. <source>J Classif</source>. <year>1985</year>;<volume>2</volume>: <fpage>193</fpage>&#x2013;<lpage>218</lpage>. doi:<pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Levine</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Simonds</surname> <given-names>EF</given-names></string-name>, <string-name><surname>Bendall</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Amir</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Tadmor</surname> <given-names>MD</given-names></string-name>, <etal>et al.</etal> <article-title>Data-Driven Phenotypic Dissection of AML Reveals Progenitor-like Cells that Correlate with Prognosis</article-title>. <source>Cell</source>. <year>2015</year>;<volume>162</volume>: <fpage>184</fpage>&#x2013;<lpage>197</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id></mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Lo</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hahne</surname> <given-names>F</given-names></string-name>, <string-name><surname>Brinkman</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Gottardo</surname> <given-names>R.</given-names></string-name> <article-title>flowClust: a Bioconductor package for automated gating of flow cytometry data</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>: <fpage>145</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-10-145</pub-id></mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Aghaeepour</surname> <given-names>N.</given-names></string-name> <article-title>flowMeans</article-title>: <source>Non-parametric Flow Cytometry Data Gating</source>. <year>2010</year>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>S&#x00F6;rensen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Baumgart</surname> <given-names>S</given-names></string-name>, <string-name><surname>Durek</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gr&#x00FC;tzkau</surname> <given-names>A</given-names></string-name>, <string-name><surname>H&#x00E4;upl</surname> <given-names>T.</given-names></string-name> <article-title>immunoClust-An automated analysis pipeline for the identification of immunophenotypic signatures in high-dimensional cytometric datasets</article-title>. <source>Cytom Part J Int Soc Anal Cytol</source>. <year>2015</year>;<volume>87</volume>: <fpage>603</fpage>&#x2013;<lpage>615</lpage>. doi:<pub-id pub-id-type="doi">10.1002/cyto.a.22626</pub-id></mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Ge</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Sealfon</surname> <given-names>SC</given-names></string-name>. <article-title>flowPeaks: a fast unsupervised clustering for flow cytometry data via K-means and density peak finding</article-title>. <source>Bioinforma Oxf Engl</source>. <year>2012</year>;<volume>28</volume>: <fpage>2052</fpage>&#x2013;<lpage>2058</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts300</pub-id></mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Zare</surname> <given-names>H</given-names></string-name>, <string-name><surname>Shooshtari</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gupta</surname> <given-names>A</given-names></string-name>, <string-name><surname>Brinkman</surname> <given-names>RR</given-names></string-name>. <article-title>Data reduction for spectral clustering to analyze high throughput flow cytometry data</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>: <fpage>403</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-11-403</pub-id></mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Bendall</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Simonds</surname> <given-names>EF</given-names></string-name>, <string-name><surname>Qiu</surname> <given-names>P</given-names></string-name>, <string-name><surname>Amir</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Krutzik</surname> <given-names>PO</given-names></string-name>, <string-name><surname>Finck</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title>Single-Cell Mass Cytometry of Differential Immune and Drug Responses Across a Human Hematopoietic Continuum</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>: <fpage>687</fpage>&#x2013;<lpage>696</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.1198704</pub-id></mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Bj&#x00F6;rklund</surname> <given-names>&#x00C5;K</given-names></string-name>, <string-name><surname>Forkel</surname> <given-names>M</given-names></string-name>, <string-name><surname>Picelli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Konya</surname> <given-names>V</given-names></string-name>, <string-name><surname>Theorell</surname> <given-names>J</given-names></string-name>, <string-name><surname>Friberg</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> <article-title>The heterogeneity of human CD127(&#x002B;) innate lymphoid cells revealed by single-cell RNA sequencing</article-title>. <source>Nat Immunol</source>. <year>2016</year>;<volume>17</volume>: <fpage>451</fpage>&#x2013;<lpage>460</lpage>. doi:<pub-id pub-id-type="doi">10.1038/ni.3368</pub-id></mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Dempster</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Laird</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>DB</given-names></string-name>. <article-title>Maximum Likelihood from Incomplete Data via the EM Algorithm</article-title>. <source>J R Stat Soc Ser B Methodol</source>. <year>1977</year>;<volume>39</volume>: <fpage>1</fpage>&#x2013;<lpage>38</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Witten</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Tibshirani</surname> <given-names>R.</given-names></string-name> <article-title>A framework for feature selection in clustering</article-title>. <source>J Am Stat Assoc</source>. <year>2010</year>;<volume>105</volume>: <fpage>713</fpage>&#x2013;<lpage>726</lpage>. doi:<pub-id pub-id-type="doi">10.1198/jasa.2010.tm09415</pub-id></mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="book"><string-name><surname>Arthur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Vassilvitskii</surname> <given-names>S.</given-names></string-name> <chapter-title>K-means&#x002B;&#x002B;: The Advantages of Careful Seeding</chapter-title>. <source>Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms</source>. <publisher-loc>Philadelphia, PA, USA</publisher-loc>: <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>; <year>2007</year>. pp. <fpage>1027</fpage>&#x2013;<lpage>1035</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id&#x003D;1283383.1283494">http://dl.acm.org/citation.cfm?id&#x003D;1283383.1283494</ext-link></mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Finak</surname> <given-names>G</given-names></string-name>, <string-name><surname>Manuel-Perez</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gottardo</surname> <given-names>R.</given-names></string-name> <article-title>flowTrans: Parameter Optimization for Flow</article-title> <source>Cytometry Data Transformation</source>. <year>2010</year>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname> <given-names>JT</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>WE</given-names></string-name>, <string-name><surname>Parker</surname> <given-names>HS</given-names></string-name>, <string-name><surname>Jaffe</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Storey</surname> <given-names>JD</given-names></string-name>. <article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>. <source>Bioinforma Oxf Engl</source>. <year>2012</year>;<volume>28</volume>: <fpage>882</fpage>&#x2013;<lpage>883</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id></mixed-citation></ref>
</ref-list>
<sec>
<title>Supporting information</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Fig S1:</label>
<caption><title>Heatmaps comparing the golden standard partitions to the DEPECHE partitions for a) the 32-variate Levine dataset and b) the 35166-variate Bj&#x00F6;rklund dataset.</title>
<p>Red color indicates large overlap, blue color indicates low overlap between a gold standard-vs-depeche cluster pair.</p></caption>
<graphic xlink:href="396135_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Fig S1:</label>
<caption><title>Algorithm comparisons.</title>
<p>For all graphs, the x-axis shows the algorithms and the y-axis shows the Adjusted Rand Index comparing the clustering result with the golden standard clustering. a) Subsamples with 20000 unique cells from two mass cytometry datasets published by Levine <italic>et al</italic> and Bendall <italic>et al</italic> were clustered with DEPECHE and six previously published algorithms. For each dataset and algorithm, clustering was performed on 20 unique subsamples. For flowClust, flowPeaks and SamSPECTRAL, that do not perform internal parameter tuning, a range of parameter values were evaluated and the parameter value sets generating the highest ARI values were selected for display. b) The full Bj&#x00F6;rklund dataset, as well as six other datasets previously used for benchmarking by Kiselev <italic>et al</italic> were clustered 20 times with DEPECHE and three other algorithms. The Bj&#x00F6;rklund dataset was normalized to reduce batch effects, with the procedure described in the original publication. These six datasets were also automatically log2-transformed within DEPECHE, and thus, log2-transformation was applied also for Sincera and pcaReduce, whereas sc3 was fed both log2-and untransformed data. The lower and upper hinges of all boxplots extend to the 25:th and 75:th percentile, whereas the line in the middle describes the median. The whiskers extend to the lowest and highest value no further than 1.5 times the distance between the 25:th and 75:th percentile. Outside of this range, the observations are considered outliers and are shown as dots.</p></caption>
<graphic xlink:href="396135_figS2.tif"/>
</fig>
<p><bold>S1 File. The DepecheR software, for the review phase.</bold></p>
<p><bold>S2 File. The code needed to generate all figures, for the review phase.</bold></p>
</sec>
</back>
</article>
