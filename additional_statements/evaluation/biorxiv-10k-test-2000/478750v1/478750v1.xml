<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/478750</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Synthetic Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Generating an artificial nest building pufferfish in a cellular automaton through behavior decomposition</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Portegys</surname><given-names>Thomas E.</given-names></name>
</contrib>
<aff><institution>Dialectek</institution>, DeKalb, IL, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn fn-type="other"><p><email>portegys@gmail.com</email></p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>478750</elocation-id>
<history>
<date date-type="received">
<day>25</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>25</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>11</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="478750.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>A species of pufferfish builds fascinating circular nests on the sea floor to attract mates. This project simulates the nest building behavior in a cellular automaton using the Morphognosis model. The model features hierarchical spatial and temporal contexts that output motor responses from sensory inputs. By considering the biological neural network of the pufferfish as a black box, decomposing only its external behavior, an artificial counterpart can be generated. In this way a complex biological system producing a behavior can be filtered into a system containing only functions that are essential to reproduce the behavior. The derived system not only has intrinsic value as an artificial entity but also might help to ascertain how the biological system produces the behavior.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Pufferfish nest building</kwd>
<kwd>Morphognosis</kwd>
<kwd>cellular automaton</kwd>
<kwd>artificial neural network</kwd>
<kwd>computational biology</kwd>
</kwd-group>
<counts>
<page-count count="9"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>A species of pufferfish creates an astounding circular nest structure on the sea floor near Japan, as shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>. The nest is built by the male for the purpose of attracting a female for mating. The nest contains a central smooth area surrounded by radial furrows and is about 2 meters in diameter. The 12 centimeter long pufferfish sculpts the furrows by sweeping sediments with its fins as its travels back and forth lengthwise along each furrow. The female lays her eggs in the fine sediments in the central area which are then fertilized by the male (<xref ref-type="bibr" rid="c3">Kawase et al., 2013</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Pufferfish (left), and nest (right).</p></caption>
<graphic xlink:href="478750_fig1.tif"/>
</fig>
<p>How does a pufferfish, whose brain contains approximately 10 million neurons, instinctively construct such a complex structure? Nature is rife with such interesting animal exploits. Termites build and maintain complex nests by coordinating the efforts of a massive number of individuals. Spiders build complex webs. Birds construct elaborate nests. Honey bees coordinate foraging through a body language signaling system. These organisms are all related to humans to some degree. Considering nature&#x2019;s propensity for extending and repurposing capabilities, unlocking the secrets of animal intelligence is a worthy step toward understanding the underpinnings of human intelligence.</p>
<p>Evolution is a trial-and-error tinkerer that makes extremely complex life forms. Even the well-known tiny nematode worm, C. elegans, with only approximately 1000 cells, 302 of which are neurons, remains a daunting subject for researchers. On an even smaller scale, geneticists are beginning to entertain the notion that most traits are the result of contributions from a great deal of the genome (<xref ref-type="bibr" rid="c1">Boyle et al., 2017</xref>).</p>
<p>One proposal to extract essential information from nature&#x2019;s witch&#x2019;s brew of complexity is the &#x201C;radical reimplementation&#x201D; approach (<xref ref-type="bibr" rid="c4">Lehman and Stanley, 2014</xref>). The idea is to discover general principles by intentionally diverging from nature in features that might be incidental or artefactual. If the core behavior is preserved after diverging, then the reimplemented features can be excluded from general principles. As an example, consider the case for discovering principles of flight from examination of bird wings. In the biological implementation, flapping wings are universal; yet in the artificial realm, fixed wings are the norm. It is the aerodynamics of wings that is common to both.</p>
<p>In simpler creatures reverse engineering is sometimes feasible. For example, the navigation skills of honey bees are of value to drone technology. Fortunately, it appears that the modular nature of the honey bee brain can be leveraged to replicate this skill (<xref ref-type="bibr" rid="c7">Nott, 2018</xref>).</p>
<p>Another approach is to consider a biological system as a black box and decompose its behavior into components that model the behavior in an artificial implementation. The expectation is that the artificial system will be less complex than the biological one, capturing only what is essential to recreate the behavior, and possibly more amenable to analysis. For artificial intelligence, which is more concerned with function over form, this can be an end in itself. Yet even for biologists, the artificial system may offer hints as to how the biological system performs.</p>
<p>An example of this approach addresses a need to distinguish mutant strains of C. elegans nematode worms based on movement variations (<xref ref-type="bibr" rid="c5">Li et al., 2017</xref>). An artificial neural network (ANN) was trained to closely emulate recorded worm trajectories. Although the network was not directly trained to perform classification, neuron responses within the network were found to perform well as mutant strain classifiers.</p>
<p>This project simulates pufferfish nest building behavior in a cellular automaton using the Morphognosis model. The model features hierarchical spatial and temporal contexts that output motor responses from sensory inputs. Through a black box decomposition of nest building behavior into space-time rules, an artificial pufferfish is embodied an ANN. This process is depicted in <xref rid="fig2" ref-type="fig">Figure 2</xref>.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Behavior decomposition and artificial neural network reconstitution.</p></caption>
<graphic xlink:href="478750_fig2.tif"/>
</fig>
</sec>
<sec id="s2">
<title>Description</title>
<sec id="s2a">
<title>Morphognosis</title>
<p>The brain, a complex structure resulting from millions of years of evolution, can be viewed as a solution to problems posed by an environment existing in space and time. Internal spatial and temporal representations allow an organism to navigate and manipulate the environment. Neurological research has confirmed that animals have specific structures that process spatial and temporal information (<xref ref-type="bibr" rid="c2">Hainm&#x00FC;ller and Bartos, 2018</xref>; <xref ref-type="bibr" rid="c6">Lieff, 2015</xref>; <xref ref-type="bibr" rid="c11">Vorhees and Williams, 2014</xref>).</p>
<p>These concepts are embodied in a model called <italic>Morphognosis</italic> (<italic>morpho</italic> = shape and <italic>gnosis</italic> = knowledge). In addition to a number of early prototype tasks (<xref ref-type="bibr" rid="c8">Portegys, 2017</xref>), Morphognosis has also modeled the locomotion and foraging of the C. elegans nematode worm (<xref ref-type="bibr" rid="c9">Portegys, 2018</xref>).</p>
<p>The basic structure of Morphognosis is a pyramid of event recordings called a <italic>morphognostic</italic>. At the apex of the pyramid are the most recent and nearby events. Receding from the apex are less recent and possibly more distant events. A morphognostic can thus be viewed as a structure of progressively larger nested chunks of space-time knowledge that form a hierarchy of contexts. Scaling is accomplished by aggregating event information. This means that more recent and nearby events are recorded in greater precision than events more distant in space and time. A set of morphognostics forms long-term memories that are learned by exposure to the environment. A morphognostic associated with an action constitutes a rule called a <italic>metamorph</italic>.</p>
<p>Building an internal spatial and temporal model of the environment allows an organism to navigate and manipulate the environment. Its basic structure is a pyramid of event recordings called a <italic>morphognostic</italic>, as shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. At the apex of the pyramid are the most recent and nearby events. Receding from the apex are less recent and possibly more distant events. <xref rid="fig4" ref-type="fig">Figure 4</xref> is an example of a morphognostic implemented in a cellular automaton as a nested set of 3&#x00D7;3 neighborhoods and aggregated histograms of cell state densities.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Morphognostic event pyramid</p></caption>
<graphic xlink:href="478750_fig3.tif"/>
</fig>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Cellular automaton implementation of Morphognosis.</p></caption>
<graphic xlink:href="478750_fig4.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Pufferfish nest building</title>
<p>The pufferfish constructs its nest by first smoothing out a central area through the action of its fins. It then typically creates 28 radial furrows or spokes emanating from the central area by moving back and forth along them. A furrow has a set of dips and rises, produced by the pufferfish lingering in specific portions of the furrow while its fins disperse sediments outward. The result is shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>.</p>
<p>A cellular automaton (CA) (<xref ref-type="bibr" rid="c10">Toffoli and Margolus, 1987</xref>) is used as a platform for the nest building. A CA is a grid of cells that contain state values. CAs are ideal for investigating systems that have parallel local production rules that output actions as a function of local cell states. For the pufferfish project, cells contain a surface elevation value. The surface is given a random initial set of elevations to simulate sea floor irregularities.</p>
<p>The pufferfish occupies a single cell and has an orientation of north, south, east and west. It can sense the elevations of three cells in front of it: left, center, and right. It can also sense its previous response. A set of sensor values constitutes an event. These are its responses: wait, forward, turn left, turn right, smooth sensed surface cells, raise and lower surface at current location.</p>
<p>The metamorph production rules are generated by recording the activity of an &#x201C;autopilot&#x201D; pufferfish. The autopilot performs a simple reenactment of the natural pufferfish&#x2019;s nest building activity: smooth the central area, then sequentially create the radial furrows by raising and lowering the surface appropriately. The software allows a number of parameterized variations, including the size of the central area and the number and length of the furrows. As the autopilot proceeds, morphognostic/response pairs are encoded into metamorphs. Once the nest is built, the environment is reset and the pufferfish runs entirely on its metamorph productions.</p>
<p>For successful nest building, the Morphognosis parameters are set to:</p>
<preformat preformat-type="dialog">
NUM&#x005F;NEIGHBORHOODS=4
NEIGHBORHOOD&#x005F;INITIAL&#x005F;DIMENSION=3
NEIGHBORHOOD&#x005F;DIMENSION&#x005F;STRIDE=0
NEIGHBORHOOD&#x005F;DIMENSION&#x005F;MULTIPLIER=3
EPOCH&#x005F;INTERVAL&#x005F;STRIDE=1
EPOCH&#x005F;INTERVAL&#x005F;MULTIPLIER=3
</preformat>
<p>This means that spatially there are 4 nested neighborhoods that span cell extents of 3&#x00D7;3, 9&#x00D7;9, 27&#x00D7;27, and 81&#x00D7;81. Temporally, the neighborhoods contain event information of 0/1, 1/3, 4/9, and 13/27, where each pair is an epoch/duration. So for example, the second neighborhood contain event information within a 9&#x00D7;9 set of cells that occurred between times 1 and 3.</p>
<p>A neural network can be trained from the metamorphs by flattening them into a dataset of sensory features association with a response. The neural network compresses the production rules for faster execution. It also can be used to generalize: a number of cell surface elevation variations can be trained together that allows the nest to be built regardless of initial surface elevation configurations.</p>
<p>A manual control of the pufferfish is also provided. This allow a user to acquire a set of metamorphs that capture an arbitrary sequence of events.</p>
<p>As shown in <xref rid="fig5" ref-type="fig">Figure 5</xref>, a dashboard allows a user to observe the sensors and response of the simulated pufferfish, select the driver: autopilot, metamorph ruleset, or manual, and display the current morphognostic.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Pufferfish dashboard.</p></caption>
<graphic xlink:href="478750_fig5.tif"/>
</fig>
<p>The Java code is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/morphognosis/Pufferfish">https://github.com/morphognosis/Pufferfish</ext-link>. The software is prebuilt and requires only unpacking and a single click to run.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<p>Using the procedure described above, the pufferfish is capable of building nests of various sizes and shapes. <xref rid="fig6" ref-type="fig">Figure 6</xref> shows such a nest on a 21&#x00D7;21 grid. There are 28 radial furrows which overlap due to the cellular grid, and each furrow replicates the down-up-down-up elevation sculpting of the sediments that exists in the actual nest. To build the nest, 903 metamorph rules were acquired.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Constructed nest with pufferfish in center.</p></caption>
<graphic xlink:href="478750_fig6.tif"/>
</fig>
<p>A nest building video is available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=xOAtLROZma4">https://www.youtube.com/watch?v=xOAtLROZma4</ext-link></p>
<p>The H2Oai machine learning toolkit (<ext-link ext-link-type="uri" xlink:href="https://www.h2o.ai">https://www.h2o.ai</ext-link>) was used to train a deep learning neural network that successfully learns nest building activity. A typical network has two hidden layers of 200 neurons with a rectified linear activation function. 500 epochs was typically sufficient. In the sample statistics shown in <xref rid="fig7" ref-type="fig">Figure 7</xref>, a training dataset of 5 runs under random initial elevation configurations and a test dataset with a different elevation configuration were used. Shown are a graph of training and test errors approaching 0 over time and the test validation confusion matrix.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Deep learning neural network statistics</title></caption>
<graphic xlink:href="478750_fig7.tif"/>
<graphic xlink:href="478750_fig7a.tif"/>
</fig>
</sec>
<sec id="s4">
<title>Conclusion</title>
<p>Building on the replication of C. elegans locomotion and foraging, the pufferfish nest building task represented a further challenge for the Morphognosis model. The result is set of metamorph rules and trained ANN that accomplish the task.</p>
<p>In summary, Morphognosis features:</p>
<list list-type="order">
<list-item><p>A method for integrating knowledge of events occurring in space and time dimensions in scalable complexity.</p></list-item>
<list-item><p>Nested hierarchies of contexts that provide global-to-local mediating influences.</p></list-item>
<list-item><p>A means of expressing the behavioral interplay of responses and sensory events.</p></list-item>
</list>
<p>Positive results on the nest building task prompts future investigation. Possible next tasks include:</p>
<list list-type="bullet">
<list-item><p>Web building. Can a space-time memories of building one or more training webs allow one to be built in a quasi-novel environment?</p></list-item>
<list-item><p>Food foraging social signaling. Bees retain memories of foraging food sources that they communicate to other bees through instinctive dancing. Can this task be cast into the model?</p></list-item>
</list>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Boyle</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Pritchard</surname>, <given-names>J.</given-names></string-name> (<year>2017</year>). <article-title>An Expanded View of Complex Traits: From Polygenic to Omnigenic</article-title>. <source>Cell, Perspective</source>. Volume <volume>169</volume>, Issue <issue>7</issue>, <fpage>p1177</fpage>-<lpage>1186</lpage>, Open Archive DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2017.05.038">https://doi.org/10.1016/j.cell.2017.05.038</ext-link></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Hainm&#x00FC;ller</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Bartos</surname>, <given-names>M.</given-names></string-name> (<year>2018</year>): <article-title>Parallel emergence of stable and dynamic memory engrams in the hippocampus</article-title>. <source>Nature</source>. DOI:<pub-id pub-id-type="doi">10.1038/s41586-018-0191-2</pub-id></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Kawase</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Okata</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Ito</surname>, <given-names>K.</given-names></string-name> (<year>2013</year>). <article-title>Role of Huge Geometric Circular Structures in the Reproduction of a Marine Pufferfish</article-title>. <source>Scientific Reports</source>. Volume <volume>3</volume>, Article number: 2106. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep02106">https://doi.org/10.1038/srep02106</ext-link></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="book"><string-name><surname>Lehman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Stanley</surname>, <given-names>K.</given-names></string-name> (<year>2014</year>). <chapter-title>Attempting to determine essential features of a system: Investigating Biological Assumptions through Radical Reimplementation</chapter-title>. <source>Artificial Life</source>. <publisher-name>Cambridge, MA: MIT Press</publisher-name>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Javer</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Keaveny</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>A.</given-names></string-name> (<year>2017</year>). <article-title>Recurrent Neural Networks with Interpretable Cells Predict and Classify Worm Behaviour</article-title>. <source>NIPS</source> 2017. <ext-link ext-link-type="uri" xlink:href="https://spiral.imperial.ac.uk:8443/bitstream/10044/1/56078/2/WNIP_2017_paper_kezhi.pdf">https://spiral.imperial.ac.uk:8443/bitstream/10044/1/56078/2/WNIP_2017_paper_kezhi.pdf</ext-link></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Lieff</surname>, <given-names>J.</given-names></string-name> (<year>2015</year>). <source>Time Cells Organize Memory</source>. <ext-link ext-link-type="uri" xlink:href="http://jonlieffmd.com/blog/time-cells-organize-memory">http://jonlieffmd.com/blog/time-cells-organize-memory</ext-link></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Nott</surname>, <given-names>G.</given-names></string-name> (<year>2018</year>). <article-title>How a brain the size of a sesame seed could change AI forever</article-title>. <source>Computer World</source>. <ext-link ext-link-type="uri" xlink:href="https://www.computerworld.com.au/article/647401/how-brain-size-sesame-seed-could-change-ai-">https://www.computerworld.com.au/article/647401/how-brain-size-sesame-seed-could-change-ai-</ext-link> forever/</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="confproc"><string-name><surname>Portegys</surname>, <given-names>T.</given-names></string-name> (<year>2017</year>). <article-title>Morphognosis: the shape of knowledge in space and time</article-title>. <conf-name>The 28th Modern Artificial Intelligence and Cognitive Science Conference (MAICS)</conf-name>, <conf-loc>Fort Wayne Indiana, USA</conf-loc>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Portegys</surname>, <given-names>T.</given-names></string-name> (<year>2018</year>). <article-title>Learning C. elegans locomotion and foraging with a hierarchical space-time cellular automaton</article-title>. <source>Neuroinformatics 2018 Montreal. F1000Research</source> 2018, <volume>7</volume>:<fpage>1192</fpage> (DOI:<pub-id pub-id-type="doi">10.7490/f1000research.1115884.1</pub-id>)</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="book"><string-name><surname>Toffoli</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Margolus</surname>, <given-names>N.</given-names></string-name> (<year>1987</year>). <source>Cellular Automata Machines: A New Environment for Modeling</source>. <publisher-name>MIT Press</publisher-name>. p. <fpage>27</fpage>. ISBN <isbn>9780262200608.</isbn></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Vorhees</surname>, <given-names>C. V.</given-names></string-name>, and <string-name><surname>Williams</surname>, <given-names>M. T.</given-names></string-name> (<year>2014</year>). <article-title>Assessing Spatial Learning and Memory in Rodents</article-title>. <source>ILAR Journal</source>. <volume>55</volume>(<issue>2</issue>), <fpage>310</fpage>&#x2013;<lpage>332</lpage>. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1093/ilar/ilu013">http://doi.org/10.1093/ilar/ilu013</ext-link>.</mixed-citation></ref>
</ref-list>
</back>
</article>