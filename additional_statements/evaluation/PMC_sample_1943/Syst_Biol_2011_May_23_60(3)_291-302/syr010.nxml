<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article">
  <?properties open_access?>
  <?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
  <?DTDIdentifier.IdentifierType public?>
  <?SourceDTD.DTDName journalpublishing.dtd?>
  <?SourceDTD.Version 2.3?>
  <?ConverterInfo.XSLTName jp2nlmx2.xsl?>
  <?ConverterInfo.Version 2?>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Syst Biol</journal-id>
      <journal-id journal-id-type="hwp">sysbio</journal-id>
      <journal-id journal-id-type="publisher-id">sysbio</journal-id>
      <journal-title-group>
        <journal-title>Systematic Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1063-5157</issn>
      <issn pub-type="epub">1076-836X</issn>
      <publisher>
        <publisher-name>Oxford University Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">3078422</article-id>
      <article-id pub-id-type="pmid">21436105</article-id>
      <article-id pub-id-type="doi">10.1093/sysbio/syr010</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Regular Articles</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Performance, Accuracy, and Web Server for Evolutionary Placement of Short Sequence Reads under Maximum Likelihood</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>Simon A.</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Krompass</surname>
            <given-names>Denis</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>Alexandros</given-names>
          </name>
          <xref ref-type="corresp" rid="cor1">*</xref>
        </contrib>
      </contrib-group>
      <aff>The Exelixis Lab, Scientific Computing Group, Heidelberg Institute for Theoretical Studies, Schloss-Wolfsbrunnenweg 35, D-69118 Heidelberg, Germany</aff>
      <author-notes>
        <corresp id="cor1"><label>*</label>Correspondence to be sent to: The Exelixis Lab, Scientific Computing Group, Heidelberg Institute for Theoretical Studies, Schloss-Wolfsbrunnenweg 35, D-69118 Heidelberg, Germany; E-mail: <email>alexandros.stamatakis@epfl.ch</email>.</corresp>
        <fn>
          <p>Associate Editor: Lars Jermiin</p>
        </fn>
      </author-notes>
      <pub-date pub-type="ppub">
        <month>5</month>
        <year>2011</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>23</day>
        <month>3</month>
        <year>2011</year>
      </pub-date>
      <pub-date pub-type="pmc-release">
        <day>23</day>
        <month>3</month>
        <year>2011</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
      <volume>60</volume>
      <issue>3</issue>
      <fpage>291</fpage>
      <lpage>302</lpage>
      <history>
        <date date-type="received">
          <day>07</day>
          <month>3</month>
          <year>2010</year>
        </date>
        <date date-type="rev-recd">
          <day>08</day>
          <month>6</month>
          <year>2010</year>
        </date>
        <date date-type="accepted">
          <day>24</day>
          <month>1</month>
          <year>2011</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>&#xA9; The Author(s) 2011. Published by Oxford University Press, on behalf of the Society of Systematic Biologists.</copyright-statement>
        <copyright-year>2011</copyright-year>
        <license license-type="open-access">
          <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>We present an evolutionary placement algorithm (EPA) and a Web server for the rapid assignment of sequence fragments (short reads) to edges of a given phylogenetic tree under the maximum-likelihood model. The accuracy of the algorithm is evaluated on several real-world data sets and compared with placement by pair-wise sequence comparison, using edit distances and BLAST. We introduce a slow and accurate as well as a fast and less accurate placement algorithm. For the slow algorithm, we develop additional heuristic techniques that yield almost the same run times as the fast version with only a small loss of accuracy. When those additional heuristics are employed, the run time of the more accurate algorithm is comparable with that of a simple BLAST search for data sets with a high number of short query sequences. Moreover, the accuracy of the EPA is significantly higher, in particular when the sample of taxa in the reference topology is sparse or inadequate. Our algorithm, which has been integrated into RAxML, therefore provides an equally fast but more accurate alternative to BLAST for tree-based inference of the evolutionary origin and composition of short sequence reads. We are also actively developing a Web server that offers a freely available service for computing read placements on trees using the EPA.</p>
      </abstract>
      <kwd-group>
        <kwd>Maximum likelihood</kwd>
        <kwd>metagenomics</kwd>
        <kwd>phylogenetic placement</kwd>
        <kwd>RAxML</kwd>
        <kwd>short sequence reads</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <p>Identification of organisms from, for example, microbial communities increasingly relies on analysis of DNA extracted from soil or water samples containing many, often unknown, organisms rather than from the individual organisms. Recently, the advent of new DNA sequencing techniques (e.g., pyrosequencing; <xref ref-type="bibr" rid="bib36">Ronaghi 2001</xref>) has increased the amount of sequence data available for identification and analysis of microbial communities by several orders of magnitude. This rapid increase in the amount of sequence data available poses new challenges for short-read sequence identification tools. We can no longer expect that the steady increase in computing power, according to Moore's law, is fast enough to handle this <italic>flood of sequence data</italic>.</p>
    <p>Depending on the DNA sequencing method used, a single sequencing run can already generate more than 100,000 short-read sequences, which comprise sequence fragments with a length of &#x223C;30&#x2013;450 nucleotides (base pairs). Such sequencing runs can be carried out within about an hour. Besides rapid full-genome assembly, another important application is the sampling of microbial communities from, for example, permafrost-affected soils (Ganzert et al. 2007), vertebrate guts (Ley et al. 2005, Ley et al. 2008, Turnbaugh et al. 2008), hypersaline mats (Ley et al. 2006), or on hands of humans (Fierer et al. 2008).</p>
    <p>Given the large amount of short-read sequences that metagenomic studies of microbial communities often yield and the fact that the provenance of these often is unknown, the first step in studies of metagenomic data is to identify the biological origin of these reads. This assignment of short reads to known organisms then allows us to examine and compare microbial samples and communities (see Turnbaugh et al. 2008). For instance, 20% of the reads in one sample might be most closely related to a specific taxonomic group of bacteria, whereas in a different sample, only 5% may be associated with this group.</p>
    <p>Here, we present a novel algorithm, the evolutionary placement algorithm (EPA), for rapid phylogenetic identification of anonymous query sequences (QSs), using a set of full-length reference sequences (RSs). The most straightforward approach to identify the origin of a QS is to use tools that are based on sequence similarity (e.g., BLAST; Altschul et al. 1997). However, the BLAST-based approach has an important limitation: It can yield misleading assignments of QS to RS if the sample of RS does not contain sequences that are sufficiently closely related to the QS (i.e., if the taxon sampling is sparse or inappropriate). Any approach based on pair-wise sequence similarity, like BLAST, will not unravel, but silently ignore, potential problems in the taxon sampling of the RS. For instance, given two RS <italic>a</italic> and <italic>b</italic>, a QS <italic>q</italic> may be identified by BLAST as being most closely related to <italic>a</italic>. In reality, <italic>q</italic> might be most closely related to a RS <italic>c</italic>, which is not included in the set of RS. Because this is a known problem (<xref ref-type="bibr" rid="bib24">Koski and Golding 2001</xref>), recent studies of microbial communities have begun to employ phylogenetic methods for QS identification (von Mering et al. 2007), despite the significantly higher computational cost. This treatment of short sequence reads is related to phylogenetic tree reconstruction methods that employ stepwise addition of sequences (<xref ref-type="bibr" rid="bib23">Kluge and Farris 1969</xref>), with the difference that each QS is individually placed in the phylogenetic reference tree (RT). If a QS connects to an internal edge of a RT comprising the RS (i.e., it is not located near a leaf of the tree), then this indicates that the sampling of the RS is insufficient to identify and characterize the diversity of the QS. This can be used as a means to identify parts of the tree in which taxon sampling is sparse and to guide sequencing efforts to improve the sampling.</p>
    <p>To date, phylogeny-based identification of the provenance of anonymous reads is conducted as follows: The QSs are aligned with respect to a reference alignment (RA) for the RS and then inserted into the RT either via a complete de novo tree reconstruction, a constrained tree search, using the RT as a constraint or backbone, or a fast and/or approximate QS addition algorithm, such as ARB (Ludwig et al. 2004), which uses maximum parsimony (MP). For DNA barcoding, phylogeny-based Bayesian analysis methods have recently been proposed by Munch et al. (2008) as well as <xref ref-type="bibr" rid="bib34">Nielsen and Matz (2006)</xref>; these, however, are applied to trees with significantly less taxa. Recently, <xref ref-type="bibr" rid="bib5">Brady and Salzberg (2009)</xref> proposed the Phymm and PhymmBL algorithms for metagenomic phylogenetic classification and report an improved classification accuracy for simulated QS compared with BLAST for PhymmBL. Classification by Phymm is based on oligonucleotide composition, whereas PhymmBL uses a weighted combination of scores from Phymm and BLAST. These algorithms classify QS relative to a given database of unaligned bacterial genomes (the National Center for Biotechnology Information [NCBI] RefSeq database; Pruitt et al. 2007) and their phylogenetic labels as provided in the RefSeq database (i.e., from Phylum level down to Genus level). This is different to the EPA, which can be used with any set of aligned RS and places QS into a fully resolved bifurcating RT. Because of the different focus of Phymm and the EPA, it is currently impossible to directly compare their accuracy on the same data sets (e.g., multiple sequence alignments and fully resolved phylogenies are not provided by the NCBI RefSeq database). This also hinders direct comparison with other previous phylogenetic classification methods like PhyloPythia (McHardy et al. 2007), which is the only phylogenetic classifier that has been compared with Phymm (<xref ref-type="bibr" rid="bib5">Brady and Salzberg 2009</xref> show that Phymm and BLAST substantially outperform PhyloPythia) and MEGAN (Hudson et al. 2007). However, it is possible to compare the relative performance of the different methods (Phymm, PhymmBL, and EPA) with placements/classifications obtained by using BLAST on data sets that are suitable for the respective methods. Therefore, we mainly compare the accuracy of the EPA with basic BLAST searches and discuss the analogous accuracy evaluation performed for Phymm/PhymmBL.</p>
    <p>A very similar algorithm to the EPA, called pplacer, has been developed independently by Matsen et al. (2010). The execution times of pplacer are comparable with those of the EPA according to a joint performance study conducted by F. Matsen, A. Stamatakis, and S.A. Berger. A comparative study is included in Matsen et al. (2010).</p>
    <p>The current standard approach for analysis of environmental reads yields a fully resolved bifurcating tree that often comprises more than 10,000 sequences (Fierer et al. 2008, Turnbaugh et al. 2008). The alignments used to reconstruct these trees mostly comprise only a single gene, typically 16S or 18S rRNA. The reconstruction of such large trees with thousands of taxa, based on data from a single gene, is time consuming and hard because of the weak historical signal in the alignment, which results in a decreased reconstruction accuracy for trees with many but relatively short sequences (see Bininda-Emonds et al. 2000, Moret et al. 2002). Moreover, in metagenomic data sets, a large number of QS will only have a length of &#x223C;200&#x2013;450 bp if a 454 sequencer is used. Thus, for identification of the provenance of short read QS, the lack of historical signal becomes even more prevalent and critical if a comprehensive tree is reconstructed. In order to solve the problems associated with the lack of signal and to significantly accelerate the analysis, we advocate a different approach that only computes the optimal insertion position for every QS in the RT with respect to its maximum-likelihood (ML) score.</p>
    <p>We introduce a new algorithm for the phylogenetic placement of QS and thoroughly test the placement accuracy on 8 published data sets. We assess the impact of QS length on placement accuracy and conduct tests on short reads derived from original full-length sequences of the test data sets. Because phylogenetic placement is inherently more computationally intensive than BLAST-based placement, performance optimization is an important factor in the development of such an algorithm if it is to become a useful and fast alternative to BLAST. Therefore, we have devised several EPAs and heuristics with varying degrees of computational complexity.</p>
    <p>The algorithm, which has been developed and tested in cooperation with microbial biologists, is already available in the latest open source code release of RAxML (<xref ref-type="bibr" rid="bib37">Stamatakis 2006</xref>b; version 7.2.7, released in August 2010, <ext-link ext-link-type="uri" xlink:href="http://wwwkramer.in.tum.de/exelixis/">http://wwwkramer.in.tum.de/exelixis/</ext-link> software.html). The alpha version of the respective Web service is available at <ext-link ext-link-type="uri" xlink:href="http://i12k-exelixis3.informatik.tu-muenchen.de/raxml">http://i12k-exelixis3.informatik.tu-muenchen.de/raxml</ext-link>. Our new approach represents a useful scalable and fast tool for evolutionarily sound identification of the provenance of environmental QS. The EPA and pplacer are currently the only algorithms that can perform the task described here. The parallelization of the EPA (Stamatakis et al. 2010) and the ability to conduct placements under all time-reversible substitution models and data types offered by RAxML is a unique feature of the EPA that helps it to scale well on large and diverse data sets. Pplacer can infer placements using either ML (like the EPA) or Bayesian posterior probabilities.</p>
    <sec>
      <title>E<sc>VOLUTIONARY</sc> P<sc>LACEMENT</sc> A<sc>LGORITHM</sc></title>
      <p>The input for our EPA consists of a RT comprising the <italic>r</italic> RS and a large comprehensive alignment that contains the <italic>r</italic> RS and the <italic>q</italic> QS. The task of aligning several QS with respect to a given RS alignment can be accomplished with ARB (Ludwig et al. 2004), NAST (DeSantis et al. 2006), MUSCLE (<xref ref-type="bibr" rid="bib9">Edgar 2004</xref>), and MAFFT (Katoh et al. 2005), or, as tested here, with HMMER (<xref ref-type="bibr" rid="bib8">Eddy 1998</xref>). One key assumption is that the RT is biologically well established or that it has been obtained via a preceding thorough phylogenetic analysis. In a typical usage scenario, the EPA could be used for mapping distinct microbial samples, for instance, from time-series experiments or different locations/individuals, to the same, for example, microbial RT in order to compare communities. Because the same RT can be used in multiple placement runs, the inference of the RT is not part of the EPA.</p>
      <p>Initially, the algorithm will read the RT and RA and mark all sequences not contained in the RT as QS. Thereafter, the ML model parameters and edge lengths on the RT will be optimized using the standard procedures implemented in RAxML (a description of the ML model can be found in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link> [available from <ext-link ext-link-type="uri" xlink:href="http://www.sysbio.oxfordjournals.org/">http://www.sysbio.oxfordjournals.org/</ext-link>]).</p>
      <p>Once the model parameters and edge lengths have been optimized on the RT, the actual identification algorithm is invoked. It will visit the 2<italic>r</italic> &#x2212; 3 edges of the RT by a preorder tree traversal, starting at an arbitrary edge of the tree leading to a tip (i.e., visit the current edge first and then recursively visit the two unvisited neighboring edges). At each edge, initially, the probability vectors of the RT to the left and the right will be recomputed (if they are not already oriented toward the current edge). Thereafter, the program will successively insert, and subsequently remove, one QS at a time into the current edge and compute the likelihood (henceforth denoted as the insertion score) of the respective tree containing <italic>r</italic> + 1 taxa. The insertion score will then be stored in a <italic>q</italic>&#xD7;(2<italic>r</italic> &#x2212; 3) table that keeps track of the insertion scores for all <italic>q</italic> QS into all 2<italic>r</italic> &#x2212; 3 edges of the RT. In order to more rapidly compute the per-edge insertions of the QS, we use an approximation that is comparable with the lazy subtree rearrangement (LSR) moves that are deployed in the standard RAxML search algorithm (see Stamatakis et al. 2005). After inserting a QS into an edge of the RT, we would normally need to reoptimize all edge lengths of the <italic>r</italic> + 1 tipped tree in order to obtain the corresponding insertion score. Instead, we only optimize the three edges adjacent to the insertion node of the QS (see <xref ref-type="fig" rid="fig1">Fig. 1</xref>) before computing the likelihood of the insertion. This approach rests on the same rationale that was used to justify the LSR moves. Our experimental results justify this approximation because it yields a high placement accuracy. We use two methods, like those used for the LSR moves, to reestimate the three edges adjacent to the insertion edge: A <italic>fast</italic> method and a <italic>slow</italic> method that uses the Newton&#x2013;Raphson method. The fast method simply splits the insertion edge, <italic>b</italic><sub><italic>r</italic></sub>, in the RT into two parts, <italic>b</italic><sub><italic>r</italic>1</sub> and <italic>b</italic><sub><italic>r</italic>2</sub>, by setting <italic>b</italic><sub><italic>r</italic>1</sub> = <italic>b</italic><sub><italic>r</italic>2</sub> = <italic>b</italic><sub><italic>r</italic></sub>/2, and <italic>b</italic><sub><italic>q</italic></sub> = 0.9 (i.e., the edge leading to QS), where 0.9 is the default RAxML value to initialize edge lengths. These values were chosen empirically for good placement accuracy over varying input data. Note that, we used the slow method, that is, the most accurate placement method available in RAxML without the above approximations for the main accuracy evaluation presented here. Thereafter, we also conducted a separate comparison of the slow and fast methods. The slow method repeatedly applies the Newton&#x2013;Raphson method to all three edges (<italic>b</italic><sub><italic>r</italic>1</sub>, <italic>b</italic><sub><italic>r</italic>2</sub>, and <italic>b</italic><sub><italic>q</italic></sub>) until no further application of the Newton&#x2013;Raphson method is needed (i.e., when <italic>&#x3F5;</italic> &#x2264; 0.00001, where <italic>&#x3F5;</italic> is the edge length change between two invocations of the Newton&#x2013;Raphson method). Alternatively, our algorithm can also use MP to prescore and order promising candidate insertion edges in order to further accelerate the placement process.</p>
      <fig id="fig1" position="float">
        <label>F<sc>IGURE</sc> 1</label>
        <caption>
          <p>Local optimization of edge lengths for the insertion of a QS into the RT.</p>
        </caption>
        <graphic xlink:href="sysbiosyr010f01_lw"/>
      </fig>
      <p>The output of this procedure consists of the RT, enhanced by assignments of the QS to edges of the RT. Each QS is attached to the edge that yielded the best insertion score for the specific QS. Hence, the algorithm will return a multifurcating tree if two or more QS are assigned to the same edge. An example is depicted in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p>
      <fig id="fig2" position="float">
        <label>F<sc>IGURE</sc> 2</label>
        <caption>
          <p>Evolutionary identification of three QSs (QS<sub>0</sub>, QS<sub>1</sub>, QS<sub>2</sub>) using a 4-taxon RT.</p>
        </caption>
        <graphic xlink:href="sysbiosyr010f02_lw"/>
      </fig>
      <p>The EPA algorithm can optionally use the nonparametric bootstrap (<xref ref-type="bibr" rid="bib11">Felsenstein 1985</xref>) to account for uncertainty in the placement of the QS. An example for this is shown in <xref ref-type="fig" rid="fig3">Fig. 3</xref>. Thus, a QS might be placed repeatedly onto different edges of the RT with various levels of support. For the bootstrap procedure, we introduce additional heuristics to accelerate the insertion process. During the insertions onto the RT using the original alignment, we keep track of the insertion scores for all QS into all edges of the RT. For every QS, we can then sort the insertion edges by their scores and for each bootstrap replicate only conduct insertions for a specific QS into 10% of the best-scoring insertion edges on the RT. This reduces the number of insertion scores to be computed per QS on each bootstrap replicate by 90% and therefore approximately yields a 10-fold speedup for the bootstrapping procedure. In a typical application scenario, one may determine the diversity of the environmental sample for every replicate using, for instance, UniFrac (<xref ref-type="bibr" rid="bib28">Lozupone and Knight 2005</xref>), and then compute an average diversity over all replicates.</p>
      <fig id="fig3" position="float">
        <label>F<sc>IGURE</sc> 3</label>
        <caption>
          <p>Phylogenetic placement of three QSs (QS<sub>0</sub>, QS<sub>1</sub>, QS<sub>2</sub>) onto a 4-taxon RT with insertion support score.</p>
        </caption>
        <graphic xlink:href="sysbiosyr010f03_lw"/>
      </fig>
      <p>As a faster alternative to the nonparametric bootstrap, the insertion scores can also be directly used to compute placement uncertainty. von Mering et al. (2007) used expected likelihood weights (ELW; <xref ref-type="bibr" rid="bib42">Strimmer and Rambaut 2002</xref>) to assign QS to an area of a tree with a certain confidence. Methods for calculating a placement uncertainty using ELW are already implemented in the EPA and pplacer.</p>
      <p>In order to improve the runtime of the slow insertion method, we developed two heuristics that rely on the fast scoring approach (described above) or MP scores, respectively. Given those prescoring techniques, the number of insertion positions considered for the thorough, but slow insertion process, can be reduced to a fraction of promising candidate edges. The proportion of insertion edges suggested by the rapid prescoring heuristics for analysis under the slow insertion method is determined by a user-defined parameter <italic>f</italic><italic>h</italic>. As part of our performance evaluation, we tested the ML- and MP-based heuristics with regard to this parameter setting.</p>
      <p>It is a known problem (Jermiin et al. 2004) that compositional heterogeneity can bias phylogenetic inference because it implies that the sequences cannot have evolved under the same stationary, reversible, and homogeneous conditions (assumed by all the available time-reversible substitution models). In the case of the EPA, this can be problematic for the placement of QS onto potentially very short edges of the RT. Different approaches exist to resolve those problems by using more sophisticated models (e.g., <xref ref-type="bibr" rid="bib13">Galtier and Gouy 1998</xref>, Jayaswal et al. 2007). Nonetheless, time reversibility is required to accommodate the high computational demands of large-scale tree and EPA inferences, in particular with respect to computing the likelihood on trees (the &#x201C;pulley principle&#x201D;; <xref ref-type="bibr" rid="bib10">Felsenstein 1981</xref>). Therefore, we recommend that users of EPA test their alignment of RS for evidence that the sequences have not evolved under time-reversible conditions (e.g., using methods published by Ababneh et al. 2006 and Ho et al. 2006) before using the EPA. If the data have not evolved under time-reversible conditions, then the conclusions drawn from using the EPA should be given with this caveat in mind. These considerations do not affect our accuracy assessment because trees of full-length sequences and placements have been inferred under the same model and the potential errors that may occur because of inappropriate model selection affect both tree construction and placement.</p>
    </sec>
    <sec>
      <title>E<sc>XPERIMENTAL</sc> S<sc>ETUP</sc></title>
      <sec>
        <title>Data Sets</title>
        <p>To test the accuracy of the EPA and competing approaches, we used eight RAs of nucleotides or amino acids from 140 up to 1604 sequences. The experimental data span a broad range of organisms and include rbcL genes (D500), small subunit rRNA (D150, D218, D714, D855, and D1604), fungal DNA (D628), and amino acid sequences from <italic>Papillomaviridae</italic> (D140). For each set, we computed the most likely tree and obtained bootstrap support (BS; Stamatakis et al. 2008) values for the internal edges; this ML tree was denoted the RT. The data sets are available at <ext-link ext-link-type="uri" xlink:href="http://wwwkramer.in.tum.de/exelixis/epaData.tar.bz2">http://wwwkramer.in.tum.de/exelixis/epaData.tar.bz2</ext-link>. The selection of the data sets and data types per se is not important, as long as QS with well-supported positions can be extracted from them. It should be noted that the number of data sets that could be assessed was limited by the excessive computational requirements of the leave-one-out experiments described in the following sections. The question we intend to answer by these experiments is this: can the EPA place a QS of reduced length onto approximately the same position from which the full-length QS was pruned? We specifically did not include real metagenomic data sets in our study because the phylogenetic positions of the QS are unknown. Moreover, real metagenomic data sets do not allow for comparing the placement accuracy, or inferred placement position, between full-length and short read sequences, whereas using a full-length sequence alignment and emulating short reads allows for such a comparison. Therefore, we emulated metagenomic data sets using real-world alignments with ML trees and BS support, which is as close as one can get to reality for assessing placement accuracy using real sequence data. To analyze real metagenomic data, we used the parallel version of the EPA, which can be applied to very large real metagenomic data sets (4874 RS and 100,627 QS; Stamatakis et al. 2010).</p>
      </sec>
      <sec>
        <title>Generation of QS</title>
        <p>To evaluate the accuracy of our algorithm, we pruned one candidate QS at a time from the existing ML trees before reinserting the QS into the tree. We only pruned and reinserted those QS that were associated with high BS scores in the RT in order to assess placement accuracy for taxa whose position in the original tree is reliable. A candidate QS is considered to have high BS, when the BS of either one of the two edges to which the taxon is attached is &#x2265; 75% and the other one leads to a neighboring tip (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>), or if both of these edges have a BS &#x2265; 75% (Fig. 4b). The 75% threshold reflects the typical empirical cutoff that is widely used in phylogenetics (<xref ref-type="bibr" rid="bib17">Hillis and Bull 1993</xref>). For each QS, a reduced RT is derived by pruning the respective tip from the original tree. The QS associated with that taxon is then placed onto the reduced tree (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>) with our EPA algorithm.</p>
        <fig id="fig4" position="float">
          <label>F<sc>IGURE</sc> 4</label>
          <caption>
            <p>Illustration of the criterion for the QS selection and experimental setup. (a) Candidate QS belongs to subtree of size 2 that is connected to the tree by a well-supported edge. It has one other tip as direct neighbor. QS with this property will be referred to as outer QS. (b) Candidate QS is connected to the tree by two well-supported edges. QS with this property will be referred to as inner QS. (c) Experimental setting: reinsert shortened candidate QS in to pruned RT. We use three different ways of generating QS with desirable features: contiguous subsequences, paired-end reads, and random gaps.</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f04_lw"/>
        </fig>
        <p>In our test data sets, the QSs were always derived from the full-length sequences in the RA. In a typical application scenario, however, the placement algorithm will have to cope with QSs that are significantly shorter than the full-length sequences in the RA. Hence, we carry out a systematic assessment of the placement accuracy depending on the length of the QS by artificially shortening the full-length sequence in question via insertion of gaps. We deployed three distinct methods to produce a QS that are ordered according to increasing biological realism.</p>
        <p>A first method to produce QS involved randomly replacing existing characters by gaps. Although this method arguably does not reflect a real usage scenario, it provides a means to systematically assess the placement of QS over a wide variation of &#x201C;virtual read lengths&#x201D; while minimizing the influence of the position-specific placement accuracy variation. Position-specific effects on placement accuracy have previously been identified as a problem by Chakravorty et al. (2007). Multiple placement runs were conducted for QS with the relative proportion of nongap characters set to 10%, 20%, &#x2026;, 90%, up to the full sequence length. Because the sequences have been extracted from the original multiple alignment, the remaining nongap characters are still aligned to the RA. Because the proportion of gaps is calculated relative to the length of the RA, the maximum proportion of available nongap characters is alignment dependent. We emphasize that, mathematically, the introduction of random gaps does not influence the calculation of the likelihood function because the used models assume independence between sites. The results from these experiments show the qualitative relationship between QS length and placement accuracy, in a way that is not feasible with the more realistic QS generation method described below, because of the high computational requirements of these evaluations.</p>
        <p>The second method to artificially shorten candidate QS involved randomly sampling contiguous subsequences from the full-length sequence in question. This method to produce QS closely reflects the main EPA application scenario. Typically, a large number of short sequence reads generated by next generation sequencing methods from unknown positions will need to be placed onto a RT. For every full-length sequence in question, we sampled 20 QS with uniformly distributed positions and normally distributed lengths (mean length: 200&#xB1;60 bp for nucleotides; 70&#xB1;20 for amino acids). This roughly corresponds to the read lengths generated by current high throughput sequencing technologies. We sampled 20 QS per full-length sequence to minimize the aforementioned influence of position-specific bias on the placement of QS. Because of the high computational requirements of placing 20 QS per full-length sequence, we did not repeat this evaluation for different mean read lengths. To assess the relationship between read length and placement accuracy, we conducted the random gap evaluation. Because a method is needed to align the short reads to the RA in a typical analysis using EPA, we also assessed placement accuracy using realigned QS and compared it with the QS placement accuracy induced by using the original alignment. We used HMMER to realign the QS to a profile hidden Markov model (HMM) of the RA (sequence-to-profile alignments with MUSCLE and MAFFT resulted in a slightly inferior placement accuracy; data not shown). Because the realignment procedure is not an integral part of the EPA, and future developments could potentially improve the realignment quality, we present results for the EPA with and without HMMER realignment.</p>
        <p>A third method to produce QS involved generating these such that they correspond to paired-end reads (see <xref ref-type="fig" rid="fig4">Fig. 4c</xref>; in this experiment, we excluded data set D140 because it is a multigene alignment of amino acid sequences). Thus, in contrast to the previous method, the position of the extracted subsequences within the gene remains fixed. This modification reflects another real-world scenario of the EPA because paired-end sequencing is a widely used technique. Once again, we conducted our placement accuracy assessment on paired-end reads that were artificially generated from the full-length sequence in question by replacing all characters in the middle of the sequence by gaps. The artificial paired-end reads were 2&#xD7;50 bp and 2&#xD7;100 bp in length.</p>
      </sec>
      <sec>
        <title>Comparison with Placements Based on Pair-Wise Sequence Similarity</title>
        <p>We conducted our evaluation of the accuracy of the EPA by comparison with a typical application scenario in which appropriate sequence-based search tools such as BLAST are used to assign a QS to the most similar RS. In this setting, a QS will always be assigned to one of the terminal edges of the RT. As mentioned above, for the EPA tests, we can choose to reuse the alignment information from the original multiple sequence alignment from which the QS were generated. With BLAST we do not have this option, so all QS will effectively be realigned against the RS. For this reason, we compare BLAST against the EPA with and without previous QS realignment using HMMER. For all tests involving BLAST, we removed all gaps from the multiple alignment and built a BLAST database for each data set. We also removed all gaps from the candidate QS and concatenated the two ends of the artificial paired-end reads into one sequence. Searches with those sequences were conducted against the corresponding BLAST database. The default parameters of the BLAST program from the NCBI C Toolkit were used for character match/mismatch (scores 1 and &#x2212; 3) and gaps (nonaffine gap penalty of &#x2212; 1). The default values from the NCBI BLAST Web site with affine gap penalties were also tested but produced slightly worse placement results and higher run times than the default settings. Using BLAST has the disadvantage that the information stemming from the RA that is present in the QS cannot be used, so for fairness, the BLAST placements should be mainly compared with EPA placements with previous QS realignment. For the tests on random gap QS, we did not use BLAST for comparison because it is not well suited for aligning such QS. The gap model as well as the local alignment algorithm rely on contiguous sequence stretches of certain lengths, which were not present in the random gap QS. For the random gap evaluation, we used a custom distance measure to calculate the pair-wise sequence similarities as an alternative to BLAST. It is defined as follows: For the two aligned sequences in question, we count the number of positions, where two different nongap characters are aligned with each other. This measure corresponds to the <xref ref-type="bibr" rid="bib15">Hamming (1950)</xref> distance, where a gap is a placeholder for any character. Placements derived from this distance measure will be referred to as sequence-based nearest-neighbor (SEQ-NN) placements.</p>
      </sec>
      <sec>
        <title>Accuracy Measures</title>
        <p>To quantify placement accuracy, we used two distance measures based on the topology and edge lengths of the original ML tree. In all cases, we considered an original edge and an insertion edge. The original edge is the one corresponding to the sequence used to generate the QS and into which it should ideally be reinserted. The insertion edge is computed by the EPA. To quantify the distance between the original edge and the insertion edge, we use the following two distance measures: The node distance (ND) is the unweighted path length in the original RT between the two edges. This corresponds to the number of nodes located on the path that connects the two edges (<xref ref-type="fig" rid="fig5">Fig. 5a</xref>) and represents an absolute distance measure. The second measure is the sum of edge lengths on the path connecting the two edges. This measure also includes 50% of the length of the insertion edge and 50% of the length of the original edge (<xref ref-type="fig" rid="fig5">Fig. 5a</xref>). For comparability between different trees and in order to obtain a relative measure, we normalize the edge path length by dividing it by the maximum tree diameter (<xref ref-type="fig" rid="fig5">Fig. 5b</xref>). The maximum diameter is the edge path of maximum length between two taxa in the RT. This distance measure is henceforth denoted as normalized edge distance (NED%).</p>
        <fig id="fig5" position="float">
          <label>F<sc>IGURE</sc> 5</label>
          <caption>
            <p>Illustration of the tree-based distance measures. a) Example tree with two edges (original and insertion edge) highlighted. There are two nodes on the path, so the ND is 2. The edge distance corresponds to the length of the connecting path, where of the two end edges only half of the edge length is used. b) Tree diameter that is used to normalize the edge distance.</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f05_lw"/>
        </fig>
      </sec>
    </sec>
    <sec sec-type="results|discussion">
      <title>R<sc>ESULTS AND</sc> D<sc>ISCUSSION</sc></title>
      <sec>
        <title>Placement Accuracy for Random Gap QS</title>
        <p>To assess the influence of QS length and at the same time reduce the impact of positional variability on placement accuracy, we tested the accuracy of the EPA on random-gap sequences of various lengths. Placements were carried out on the 8 data sets for varying artificial read lengths. <xref ref-type="fig" rid="fig6">Figure 6</xref> provides a detailed plot of the accuracy as a function of the proportion of gaps, averaged over all candidate QS from all data sets (respective plots for the individual data sets can be found in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>). As a measure of accuracy, we use the distance between the placement position and the true position from which the respective QS was originally pruned. Therefore, a lower distance indicates higher accuracy. For each placement method, we show the distances for three subsets of candidate QS: the disjunct sets of outer QS and inner QS (see Fig. 4), as well as the complete set of QS (all QS).</p>
        <fig id="fig6" position="float">
          <label>F<sc>IGURE</sc> 6</label>
          <caption>
            <p>Placement accuracy for QS with artificially introduced random gaps. a) Average ND and b) NED (between insertion positions and real positions).</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f06_lw"/>
        </fig>
        <p>As expected, the general trend is that placement accuracy increases with the QS lengths. For all three QS subsets, the EPA achieves higher placement accuracies than SEQ-NN. Generally, the distances of the EPA placements are at least two times lower than for SEQ-NN. For SEQ-NN, the placement accuracy is considerably lower for the inner QS subset compared with the other QS subsets. Placement based on pair-wise sequence similarity is harder for inner QS than for the outer QS because the candidate QS do not have direct neighbors in the RT. This decrease of placement accuracy is independent of the QS lengths. For the EPA, the accuracy is more uniform across the three QS subsets. Only for short QS, there is a slight accuracy decrease for inner QS (this effect is more pronounced for the NED% measure). With increasing QS length, the EPA placements become almost equally accurate for the three QS subsets. It is worth noting that, on average, the EPA correctly places almost all QS from all three subsets, when they contain &lt; 50% gaps. The results suggest that there is a steady increase in accuracy for increased QS lengths up to the &#x201C;perfect&#x201D; placement on our test sets. This is particularly promising because read lengths will further increase.</p>
        <p>The EPA placements on the inner QS compared with the outer QS are especially encouraging because this subset represents a worst-case scenario with respect to taxon sampling in the RT. In contrast to SEQ-NN, the original QS position has negligible impact on the placement accuracy. The results on this subset are indicative for the performance on data sets with a sparse or inadequate taxon sampling. Because it is hard to determine an adequate taxon sampling a priori for an unknown microbial community, our approach therefore can be used to appropriately adapt the taxon sampling.</p>
      </sec>
      <sec>
        <title>Placement Accuracy for Randomly Selected Subsequences</title>
        <p><xref ref-type="table" rid="tbl2">Table 2</xref> provides the placement accuracy (according to the ND measure) for the uniformly sampled contiguous subsequences of normally distributed lengths (mean: 200&#xB1;60 bp and 70&#xB1;20 amino acid residues). The table values represent distances between the placement positions and the true positions from which the QS have been pruned. An ND of 0 represents a perfect placement, larger values indicate larger placement errors. As in the previous section, we show separate results for outer QS, inner QS, and all QS. In the second column, we show the placement accuracy of the EPA in terms of ND. For data set D140, this means that, averaged over all QS, the placements calculated by the EPA are within 0.51 nodes of the original placements. In the next column, we provide the average ND of the EPA for the case when the QS have been realigned to the RA using HMMER prior to the placement run. For D140, the average ND is 0.59, so the additional realignment step results in EPA placements that are on average 1.16 times further away from their original position than EPA placements without QS realignment. The third column gives the average ND for a BLAST-based approach. For D140, the value of 0.91 corresponds to placements that are on average 1.78 and 1.53 times further away from the true position than the EPA and EPA&#x2013;RA placements. A corresponding table using the NED% measure is provided in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>. In general, the results are comparable with the ND results.</p>
        <p>The values for D140 reflect the general trends that apply to most of the data sets. The EPA placements are on average more accurate than the BLAST placements, by factors between 1.12 and 2.06. Except for the two smallest (in terms of number of taxa) nucleotide data sets, the advantage of the EPA over alternative methods improves for the inner QS. For the smallest data sets, the number of inner QS (see <xref ref-type="table" rid="tbl1">Table 1</xref>, remember that we only select well-supported leaves as candidate QS) is very small; thus, this variation may be attributed to random effects. For the outer QS, the advantage over BLAST is less pronounced. For two of the larger data sets (D1604 and D755), the absolute accuracy of the EPA is approximately equal for outer QS and inner QS, although there is a larger accuracy decrease for BLAST. The realignment using HMMER (see <xref ref-type="table" rid="tbl2">Table 2</xref> columns EPA and EPA&#x2013;RA) before placement by the EPA has only a small negative impact on placement accuracy. The realignment step decreases the accuracy of the EPA with respect to the two distance measures by factor 1.03&#x2013;1.2. For one data set only (D628), the combination of EPA and HMMER was found to be slightly less accurate than placement with BLAST. We conclude that profile-HMMs as implemented in HMMER offer a useful method for the addition of short reads to a RA in this scenario, although there is still room to improve the QS alignment on certain data sets.</p>
        <table-wrap id="tbl1" position="float">
          <label>T<sc>ABLE</sc> 1</label>
          <caption>
            <p>Data sets used for evaluation of the EPA</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td rowspan="1" colspan="1">Data</td>
                <td align="center" rowspan="1" colspan="1">Type</td>
                <td align="center" rowspan="1" colspan="1">Length</td>
                <td align="center" rowspan="1" colspan="1">Number of taxa</td>
                <td align="center" rowspan="1" colspan="1">Number of QS</td>
                <td align="center" rowspan="1" colspan="1">Number of inner QS</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">D140</td>
                <td rowspan="1" colspan="1">AA</td>
                <td align="char" char="." rowspan="1" colspan="1">1104</td>
                <td align="char" char="." rowspan="1" colspan="1">140</td>
                <td align="char" char="." rowspan="1" colspan="1">95</td>
                <td align="char" char="." rowspan="1" colspan="1">9</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D150</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1269</td>
                <td align="char" char="." rowspan="1" colspan="1">150</td>
                <td align="char" char="." rowspan="1" colspan="1">66</td>
                <td align="char" char="." rowspan="1" colspan="1">10</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D218</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">2294</td>
                <td align="char" char="." rowspan="1" colspan="1">218</td>
                <td align="char" char="." rowspan="1" colspan="1">80</td>
                <td align="char" char="." rowspan="1" colspan="1">14</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D500</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1398</td>
                <td align="char" char="." rowspan="1" colspan="1">500</td>
                <td align="char" char="." rowspan="1" colspan="1">205</td>
                <td align="char" char="." rowspan="1" colspan="1">29</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D628</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1228</td>
                <td align="char" char="." rowspan="1" colspan="1">628</td>
                <td align="char" char="." rowspan="1" colspan="1">210</td>
                <td align="char" char="." rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D714</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1241</td>
                <td align="char" char="." rowspan="1" colspan="1">714</td>
                <td align="char" char="." rowspan="1" colspan="1">293</td>
                <td align="char" char="." rowspan="1" colspan="1">61</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D855</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1436</td>
                <td align="char" char="." rowspan="1" colspan="1">855</td>
                <td align="char" char="." rowspan="1" colspan="1">344</td>
                <td align="char" char="." rowspan="1" colspan="1">48</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">D1604</td>
                <td rowspan="1" colspan="1">N</td>
                <td align="char" char="." rowspan="1" colspan="1">1276</td>
                <td align="char" char="." rowspan="1" colspan="1">1604</td>
                <td align="char" char="." rowspan="1" colspan="1">541</td>
                <td align="char" char="." rowspan="1" colspan="1">83</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>Note: The columns contain (from left to right): the name of the data; the type of the data (N: nucleotides and AA: amino acids); and the length of the data (i.e., number of sites in the alignment); for definitions of QS and inner QS, see the main text).</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap id="tbl2" position="float">
          <label>T<sc>ABLE</sc> 2</label>
          <caption>
            <p>Accuracy on randomly sampled short subsequences in terms of ND from the original position</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td rowspan="1" colspan="1">Data</td>
                <td align="center" rowspan="1" colspan="1">EPA</td>
                <td align="center" rowspan="1" colspan="1">EPA-RA</td>
                <td align="center" rowspan="1" colspan="1">BLAST</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4" rowspan="1">Outer QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D140</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
                <td align="char" char="." rowspan="1" colspan="1">0.58</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D150</td>
                <td align="char" char="." rowspan="1" colspan="1">1.14</td>
                <td align="char" char="." rowspan="1" colspan="1">1.2</td>
                <td align="char" char="." rowspan="1" colspan="1">1.96</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D218</td>
                <td align="char" char="." rowspan="1" colspan="1">1.7</td>
                <td align="char" char="." rowspan="1" colspan="1">2.01</td>
                <td align="char" char="." rowspan="1" colspan="1">3.66</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D500</td>
                <td align="char" char="." rowspan="1" colspan="1">1.31</td>
                <td align="char" char="." rowspan="1" colspan="1">1.37</td>
                <td align="char" char="." rowspan="1" colspan="1">2.36</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D628</td>
                <td align="char" char="." rowspan="1" colspan="1">2.44</td>
                <td align="char" char="." rowspan="1" colspan="1">2.95</td>
                <td align="char" char="." rowspan="1" colspan="1">2.69</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D714</td>
                <td align="char" char="." rowspan="1" colspan="1">1.71</td>
                <td align="char" char="." rowspan="1" colspan="1">1.82</td>
                <td align="char" char="." rowspan="1" colspan="1">2.36</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D855</td>
                <td align="char" char="." rowspan="1" colspan="1">2.87</td>
                <td align="char" char="." rowspan="1" colspan="1">2.97</td>
                <td align="char" char="." rowspan="1" colspan="1">3.53</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D1604</td>
                <td align="char" char="." rowspan="1" colspan="1">2.26</td>
                <td align="char" char="." rowspan="1" colspan="1">2.45</td>
                <td align="char" char="." rowspan="1" colspan="1">2.87</td>
              </tr>
              <tr>
                <td colspan="4" rowspan="1">Inner QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D140</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.71</td>
                <td align="char" char="." rowspan="1" colspan="1">1.81</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D150</td>
                <td align="char" char="." rowspan="1" colspan="1">3.09</td>
                <td align="char" char="." rowspan="1" colspan="1">3.1</td>
                <td align="char" char="." rowspan="1" colspan="1">4.62</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D218</td>
                <td align="char" char="." rowspan="1" colspan="1">2.24</td>
                <td align="char" char="." rowspan="1" colspan="1">2.66</td>
                <td align="char" char="." rowspan="1" colspan="1">3.81</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D500</td>
                <td align="char" char="." rowspan="1" colspan="1">2.05</td>
                <td align="char" char="." rowspan="1" colspan="1">2.37</td>
                <td align="char" char="." rowspan="1" colspan="1">4.16</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D628</td>
                <td align="char" char="." rowspan="1" colspan="1">3.28</td>
                <td align="char" char="." rowspan="1" colspan="1">3.65</td>
                <td align="char" char="." rowspan="1" colspan="1">4.04</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D714</td>
                <td align="char" char="." rowspan="1" colspan="1">1.78</td>
                <td align="char" char="." rowspan="1" colspan="1">1.93</td>
                <td align="char" char="." rowspan="1" colspan="1">3.51</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D855</td>
                <td align="char" char="." rowspan="1" colspan="1">3.68</td>
                <td align="char" char="." rowspan="1" colspan="1">3.74</td>
                <td align="char" char="." rowspan="1" colspan="1">4.91</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D1604</td>
                <td align="char" char="." rowspan="1" colspan="1">2.23</td>
                <td align="char" char="." rowspan="1" colspan="1">2.38</td>
                <td align="char" char="." rowspan="1" colspan="1">3.86</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>Notes: The second column (EPA) shows the average ND of the EPA placements (using slow insertions under the GTR + &#x393; model) for the data sets in question. The third column (EPA-RA) shows the average ND for the EPA with previous realignment using HMMER. The last column (BLAST) shows the average ND for a BLAST-based approach.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>In <xref ref-type="table" rid="tbl3">Table 3</xref>, we show the placement precision of the EPA and BLAST in terms of percentage of QS placed within a certain ND of their true position. Up to an ND threshold of 10, the EPA with HMMER realignment (column EPA-RA) outperforms BLAST by 2.2&#x2013;8%. As before, the EPA without realignment has slightly higher accuracy compared with EPA&#x2013;RA. For the inner QS subset, the difference between BLAST and EPA&#x2013;RA is larger, reaching 19.7% for an ND threshold of 1 (by definition, BLAST cannot correctly place inner QS, thus ND will be at least 1). <xref ref-type="bibr" rid="bib5">Brady and Salzberg (2009)</xref> evaluated Phymm/PhymmBL in a similar experimental setup, by measuring the classification accuracy of Phymm, PhymmBL, and BLAST at different taxonomic levels. PhymmBL achieved an accuracy improvement of &#x223C;6% for PhymmBL over BLAST on simulated QS.</p>
        <table-wrap id="tbl3" position="float">
          <label>T<sc>ABLE</sc> 3</label>
          <caption>
            <p>Percentage of QS placed correctly within a certain ND (max(ND)) of the original position over all data sets</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td rowspan="1" colspan="1">Max(ND)</td>
                <td align="center" rowspan="1" colspan="1">EPA (%)</td>
                <td align="center" rowspan="1" colspan="1">EPA-RA (%)</td>
                <td align="center" rowspan="1" colspan="1">BLAST (%)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4" rowspan="1">Outer QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;0</td>
                <td align="char" char="." rowspan="1" colspan="1">58.4</td>
                <td align="char" char="." rowspan="1" colspan="1">56.4</td>
                <td align="char" char="." rowspan="1" colspan="1">56.3</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;1</td>
                <td align="char" char="." rowspan="1" colspan="1">71.1</td>
                <td align="char" char="." rowspan="1" colspan="1">69.5</td>
                <td align="char" char="." rowspan="1" colspan="1">64.1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;2</td>
                <td align="char" char="." rowspan="1" colspan="1">77.6</td>
                <td align="char" char="." rowspan="1" colspan="1">76.0</td>
                <td align="char" char="." rowspan="1" colspan="1">69.5</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;5</td>
                <td align="char" char="." rowspan="1" colspan="1">87.9</td>
                <td align="char" char="." rowspan="1" colspan="1">86.8</td>
                <td align="char" char="." rowspan="1" colspan="1">82.6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;10</td>
                <td align="char" char="." rowspan="1" colspan="1">94.6</td>
                <td align="char" char="." rowspan="1" colspan="1">93.9</td>
                <td align="char" char="." rowspan="1" colspan="1">91.9</td>
              </tr>
              <tr>
                <td colspan="4" rowspan="1">Inner QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;0</td>
                <td align="char" char="." rowspan="1" colspan="1">37.0</td>
                <td align="char" char="." rowspan="1" colspan="1">35.1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;1</td>
                <td align="char" char="." rowspan="1" colspan="1">64.3</td>
                <td align="char" char="." rowspan="1" colspan="1">63.4</td>
                <td align="char" char="." rowspan="1" colspan="1">43.7</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;2</td>
                <td align="char" char="." rowspan="1" colspan="1">74.7</td>
                <td align="char" char="." rowspan="1" colspan="1">73.1</td>
                <td align="char" char="." rowspan="1" colspan="1">56.9</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;5</td>
                <td align="char" char="." rowspan="1" colspan="1">86.5</td>
                <td align="char" char="." rowspan="1" colspan="1">85.8</td>
                <td align="char" char="." rowspan="1" colspan="1">77.9</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;10</td>
                <td align="char" char="." rowspan="1" colspan="1">94.1</td>
                <td align="char" char="." rowspan="1" colspan="1">93.6</td>
                <td align="char" char="." rowspan="1" colspan="1">90.5</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>As previously noted here, there can be position-specific effects that can influence the placement accuracy depending on which part of the gene is used to generate QS. To minimize the influence of this position-specific bias, we sampled multiple QS (at different gene regions) from every input sequence and report averages in this study. This broad sample of QS along the gene can also be used to plot the site-specific mean placement accuracy over the length of the RA. Accuracy plots for the data sets in this study are available in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>. This approach can also be used, a priori, on a full-length sequence alignment to determine appropriate gene regions for short-read generation.</p>
      </sec>
      <sec>
        <title>Placement Accuracy for Paired-End Reads</title>
        <p><xref ref-type="table" rid="tbl4">Table 4</xref> provides the overall results of the experiments with virtual paired-end reads of length 2&#xD7;100 bp (the results for 2&#xD7;50 bp reads are provided in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>). Similar to the previous section, the placement accuracies are given in terms of ND and NED%, averaged over all QS. For D150, the EPA places the QS within 1.26 nodes of their true position, whereas for BLAST, the average ND of 3.67 corresponds to placements that are 2.91 times further away from the original position relative to the EPA. The table also contains corresponding values for the NED% measure, which indicate similar results as the ND measure. As in the previous section, the general trend is similar for all data sets. The accuracy of the EPA placements are on average 1.58&#x2013;5.87 times better than for BLAST.</p>
        <table-wrap id="tbl4" position="float">
          <label>T<sc>ABLE</sc> 4</label>
          <caption>
            <p>Accuracy of the placement of 2 &#xD7; 100 bp paired-end reads</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td colspan="2" align="center" rowspan="1">ND<hr/></td>
                <td align="center" colspan="2" rowspan="1">NED%<hr/></td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Data</td>
                <td align="center" rowspan="1" colspan="1">EPA</td>
                <td align="center" rowspan="1" colspan="1">BLAST</td>
                <td align="center" rowspan="1" colspan="1">EPA</td>
                <td align="center" rowspan="1" colspan="1">BLAST</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" rowspan="1">Outer QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D150</td>
                <td align="char" char="." rowspan="1" colspan="1">1.14</td>
                <td align="char" char="." rowspan="1" colspan="1">3.38</td>
                <td align="char" char="." rowspan="1" colspan="1">0.63</td>
                <td align="char" char="." rowspan="1" colspan="1">1.76</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D218</td>
                <td align="char" char="." rowspan="1" colspan="1">1.44</td>
                <td align="char" char="." rowspan="1" colspan="1">4.77</td>
                <td align="char" char="." rowspan="1" colspan="1">3.6</td>
                <td align="char" char="." rowspan="1" colspan="1">8.45</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D500</td>
                <td align="char" char="." rowspan="1" colspan="1">0.84</td>
                <td align="char" char="." rowspan="1" colspan="1">4.88</td>
                <td align="char" char="." rowspan="1" colspan="1">1.75</td>
                <td align="char" char="." rowspan="1" colspan="1">7.35</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D628</td>
                <td align="char" char="." rowspan="1" colspan="1">0.56</td>
                <td align="char" char="." rowspan="1" colspan="1">1.83</td>
                <td align="char" char="." rowspan="1" colspan="1">0.83</td>
                <td align="char" char="." rowspan="1" colspan="1">1.83</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D714</td>
                <td align="char" char="." rowspan="1" colspan="1">1.31</td>
                <td align="char" char="." rowspan="1" colspan="1">3.59</td>
                <td align="char" char="." rowspan="1" colspan="1">1.77</td>
                <td align="char" char="." rowspan="1" colspan="1">4.78</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D855</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0</td>
                <td align="char" char="." rowspan="1" colspan="1">5.98</td>
                <td align="char" char="." rowspan="1" colspan="1">1.11</td>
                <td align="char" char="." rowspan="1" colspan="1">3.35</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D1604</td>
                <td align="char" char="." rowspan="1" colspan="1">1.58</td>
                <td align="char" char="." rowspan="1" colspan="1">3.67</td>
                <td align="char" char="." rowspan="1" colspan="1">0.79</td>
                <td align="char" char="." rowspan="1" colspan="1">1.65</td>
              </tr>
              <tr>
                <td colspan="5" rowspan="1">Inner QS</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D150</td>
                <td align="char" char="." rowspan="1" colspan="1">1.9</td>
                <td align="char" char="." rowspan="1" colspan="1">5.3</td>
                <td align="char" char="." rowspan="1" colspan="1">2.23</td>
                <td align="char" char="." rowspan="1" colspan="1">5.64</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D218</td>
                <td align="char" char="." rowspan="1" colspan="1">4.43</td>
                <td align="char" char="." rowspan="1" colspan="1">5.21</td>
                <td align="char" char="." rowspan="1" colspan="1">8.16</td>
                <td align="char" char="." rowspan="1" colspan="1">9.38</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D500</td>
                <td align="char" char="." rowspan="1" colspan="1">1.59</td>
                <td align="char" char="." rowspan="1" colspan="1">9.41</td>
                <td align="char" char="." rowspan="1" colspan="1">3.15</td>
                <td align="char" char="." rowspan="1" colspan="1">12.24</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D628</td>
                <td align="char" char="." rowspan="1" colspan="1">0.85</td>
                <td align="char" char="." rowspan="1" colspan="1">2.95</td>
                <td align="char" char="." rowspan="1" colspan="1">0.55</td>
                <td align="char" char="." rowspan="1" colspan="1">1.13</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D714</td>
                <td align="char" char="." rowspan="1" colspan="1">1.66</td>
                <td align="char" char="." rowspan="1" colspan="1">4.9</td>
                <td align="char" char="." rowspan="1" colspan="1">2.9</td>
                <td align="char" char="." rowspan="1" colspan="1">7.76</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D855</td>
                <td align="char" char="." rowspan="1" colspan="1">2.9</td>
                <td align="char" char="." rowspan="1" colspan="1">7.54</td>
                <td align="char" char="." rowspan="1" colspan="1">2.04</td>
                <td align="char" char="." rowspan="1" colspan="1">4.61</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">&#x2003;&#x2003;&#x2003;&#x2003;D1604</td>
                <td align="char" char="." rowspan="1" colspan="1">1.57</td>
                <td align="char" char="." rowspan="1" colspan="1">5.3</td>
                <td align="char" char="." rowspan="1" colspan="1">1.69</td>
                <td align="char" char="." rowspan="1" colspan="1">4.84</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>Notes: The values given are the ND and the normalized edge distance (NED %). The methods used are the EPA (slow insertions under the GTR + &#x393; model) and BLAST-based nearest neighbor.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p><xref ref-type="fig" rid="fig7">Figure 7</xref> provides histograms for the accuracy distribution of individual placements computed by the EPA and BLAST for 2&#xD7;100 bp paired-end reads on data set D855. Respective histograms for all data sets on 2&#xD7;100 bp and 2&#xD7;50 bp reads are available in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>. The plots suggest that the placement error for both methods follows an approximate power law distribution. The placements obtained via the EPA are, on average, closer to the true position and yield smaller maximum placement errors than BLAST.</p>
        <fig id="fig7" position="float">
          <label>F<sc>IGURE</sc> 7</label>
          <caption>
            <p>Histogram showing the placement accuracy, based on NDs, for the placement of 2 &#xD7; 100 bp paired-end reads from D855, using outer a) and inner b) QS.</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f07_ht"/>
        </fig>
        <p><xref ref-type="table" rid="tbl4">Table 4</xref> highlights that the EPA consistently outperforms BLAST-based placements for paired-end reads and that placements are approximately twice as accurate on average. Generally, the placement accuracy for paired-end reads of lengths 2&#xD7;100 bp is better than was expected from the test with randomly selected contiguous subsequences of mean length 200 bp in the previous section. One contributing factor is that many of the subsequences in the previous experiment were significantly shorter than 200 bp because we use normally distributed lengths. There also appears to exist a positive effect, generated by selecting subsequences from two distinct regions of the gene (the start and the end) from the original QS; in combination, phylogenetic information from both ends, may contain a stronger historical signal than a single, randomly selected subsequence.</p>
      </sec>
      <sec>
        <title>Impact of Placement Algorithms and Substitution Models on Accuracy</title>
        <p>All preceding computational experiments were carried out using the most thorough (slow) version of the EPA under the generalized time reversible + &#x393; and Whelan and Goldman + &#x393; models. In this mode, the EPA optimizes edge lengths via the Newton&#x2013;Raphson method for every possible insertion edge on the RT. As previously mentioned, we also devised a fast version of the EPA where this optimization is deactivated for QS insertions. These heuristics can speed up the EPA by one order of magnitude when a large amount of QS is being placed onto a RT. An additional speedup by a factor of 3&#x2013;4 can be achieved by using the GTR + CAT or PROT + CAT approximations (<xref ref-type="bibr" rid="bib37">Stamatakis 2006</xref>a) of rate heterogeneity.</p>
        <p><xref ref-type="fig" rid="fig8">Figure 8</xref> shows the impact of EPA heuristics and rate heterogeneity models on placement accuracy for all QS over all data sets (analogous plots for the individual data sets are available in the <ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary Material</ext-link>). For the slow insertion method, there is practically no difference in placement accuracy between the &#x393; model and the CAT approximation. For the fast insertion method, there is a notable decrease in placement accuracy for the CAT as well as the &#x393; models. The decrease is more pronounced for the outer QS, whereas for the inner QS, the effect of using the fast insertion method is less pronounced. As already mentioned, correct placement of the inner QS is harder than placement of the outer QS, which have direct neighbors in the RT. The results of this experiment show that the slow version of the EPA that includes edge length optimization can produce better placement results than the fast version, especially when QS are placed on inner edges of the RT.</p>
        <fig id="fig8" position="float">
          <label>F<sc>IGURE</sc> 8</label>
          <caption>
            <p>Average ND for different versions of the EPA (fast/slow insertions) algorithm and model types (GTR + &#x393;, GTR + CAT) on inner QS and outer QS from all data sets.</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f08_lw"/>
        </fig>
      </sec>
      <sec>
        <title>Heuristics for Slow Insertions</title>
        <p>As shown in the previous section, the loss of accuracy induced by the fast insertion method is minimal. Nonetheless, a slight accuracy improvement can be attained by the slow insertion method, especially regarding the more precise edge length estimate at the insertion position that can be used for postanalysis purposes. Using the rapid insertion edge prescoring heuristics already described, it is possible to accelerate the slow insertion algorithm with little to no impact on placement accuracy. Here, we evaluate the accuracy trade-offs associated with these heuristics. We also provide run-time measurements for the EPA and BLAST.</p>
        <p>In contrast to the previous accuracy assessments, we do not test the placement of one QS at a time onto an existing RT from which the QS has been previously pruned. Instead, we randomly split the alignments into two subsets that each comprise 50% of the taxa. The first subset is used to infer a best-known ML tree with RAxML onto which the remaining taxa (of the second subset) are placed via the EPA. Here, we assume the slow EPA placements to be the true placements. In this experiment, we reduce the length of the QS to 50% nongap characters. The nongap characters are a contiguous sequence fragment that starts at the beginning of the respective sequence; that is, the QS represent roughly the first half of the gene.</p>
        <p><xref ref-type="fig" rid="fig9">Figure 9</xref> shows the accuracy on the largest data set D1604 (placement of 802 QS onto a RT with 802 RS). The fraction of insertion edges considered for the slow insertion phase is controlled by the parameter <italic>fh</italic>. In the plot the accuracy of the heuristics for values of <inline-formula><mml:math id="n1"><mml:mrow><mml:mi>f</mml:mi><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>16</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>32</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>64</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>128</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>256</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> is shown (i.e., on this data set &#x223C;400, 200, 100, 50, 25, 12, 6 out of 1601 possible insertion edges are considered). For the lowest <italic>fh</italic> values, there is a visible decrease in placement accuracy (sharp rise of the curves on the left side of the plot). For 50 or more insertion edges, the accuracy remains virtually constant. The results suggest that, on this data set, it is sufficient to more thoroughly analyze only 50 out of 1601 <inline-formula><mml:math id="n2"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mi>h</mml:mi><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>32</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> candidate insertion edges proposed by the heuristics to obtain the best possible accuracy (even for <inline-formula><mml:math id="n3"><mml:mrow><mml:mi>f</mml:mi><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>64</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, there is only a very small deviation from the reference placements). Another important result is that the MP heuristics produce equally accurate placements as the ML heuristics, for all, except the smallest values of <italic>fh</italic>.</p>
        <fig id="fig9" position="float">
          <label>F<sc>IGURE</sc> 9</label>
          <caption>
            <p>Accuracy of the EPA as a function of the number of edges considered for slow insertion after heuristic filtering.</p>
          </caption>
          <graphic xlink:href="sysbiosyr010f09_lw"/>
        </fig>
        <p>We conclude that the MP heuristics with a parameter setting of <italic>f</italic><italic>h</italic> = 1/32 (using the &#x393; model for <italic>thorough</italic> insertions) are sufficient for achieving placement accuracy comparable with the reference placement but with computational requirements (290 s) that are in the same order of magnitude as a simple BLAST search (216 s) of the QS against the sequences in the RS. Realignment of the QS to the RA takes 224 s using HMMER on this data set. Thus, the combined run time of HMMER and the EPA is &#x223C;2.5 times higher than a simple BLAST search but still within the same order of magnitude.</p>
        <p>The lowest run time (113 s) was achieved by using the CAT model for slow insertions at the expense of a slight loss in accuracy (i.e., on average, the ND increased by &#x223C;0.1). Based on the results in the previous section, we expect the accuracy difference between the CAT approximation and the &#x393; model of rate heterogeneity to be negligible in a real-world scenario.</p>
        <p>The differences in accuracy between the fast and slow insertion methods as well as between the &#x393; and CAT models are generally larger than in the previous sections. This is not surprising, given that the setup of this experiment was not designed to measure the insertion accuracy relative to an assumed correct position, but the deviation between our best, yet slowest, method and less accurate accelerated methods. Here, we do not constrain the experiment to QS with high support values in the RT, but chose QS at random, which may introduce a certain loss of precision to this evaluation. In addition, the RT (comprising 50% of the taxa in the original RA) is smaller than in the previous evaluations and thus more sparsely sampled. Nonetheless, the deviation between the fast and slow EPA versions amounts to less than half a node on average and the general finding that slow insertions under CAT are more accurate than fast insertions under &#x393; is consistent with previous experiments.</p>
      </sec>
    </sec>
    <sec>
      <title>EPA WEB SERVICE</title>
      <p>An alpha version of a Web server that offers the EPA algorithm is freely available at <ext-link ext-link-type="uri" xlink:href="http://i12k-exelixis3.informatik.tu-muenchen.de/raxml">http://i12k-exelixis3.informatik.tu-muenchen.de/raxml</ext-link> and will be continuously developed and improved. The server runs on a dedicated machine with 24 AMD cores and 128GB of main memory.</p>
      <p>Users can upload RTs and RAs and chose to align QS to the RA with HMMER or upload an alignment that already contains the QS. When the QS are to be aligned by the server, they can also be clustered using UCLUST (<ext-link ext-link-type="uri" xlink:href="http://www.drive5.com/usearch/">http://www.drive5.com/usearch/</ext-link>) prior to alignment with HMMER. The UCLUST option can be used to reduce the number of reads that will subsequently be placed and aligned. Finally, the Web server also offers a JAVA-based result visualization tool that uses the Archeopteryx framework (<xref ref-type="bibr" rid="bib16">Han and Zmasek 2009</xref>) and provides a simple visualization of the read distribution over the RT.</p>
    </sec>
    <sec sec-type="conclusion">
      <title>C<sc>ONCLUSION</sc></title>
      <p>We have presented an accurate and scalable approach for tree-dependent sequence comparison and compared its accuracy with sequence comparison-based methods. A tree-dependent approach has methodological advantages over standard, pair-wise, similarity-based comparative approaches and the EPA is freely available for download as open source code and as a Web service. We demonstrate that our approach may be substantially more accurate than standard techniques used to analyze, for example, microbial communities. More importantly, we demonstrate that achieving improved accuracy does not require longer inference times and that our approach is as fast as a simple BLAST-based search when using additional heuristics.</p>
      <p>The EPA also is relatively straightforward to parallelize by applying a multigrain parallelization technique (Stamatakis et al. 2010). On a multicore system with 32 cores and 64 GB of main memory, we were able to place 100,627 QS in parallel into a RT with 4874 taxa within 1.5 h. The application of the EPA is not limited to molecular data only. <xref ref-type="bibr" rid="bib3">Berger and Stamatakis (2010)</xref> have used the EPA for the placement of fossil taxa onto a (molecular) RT of extant species.</p>
      <p>A major challenge that remains to be solved consists in aligning the QS to a given RA. Throughout this paper, we have assumed that such an alignment was given or that such an alignment can conveniently be generated by aligning the individual QS to a profile-HMM of the RA. Ideally, one would like to simultaneously place and align the QS to the respective insertion edge. We are currently working on a tree-dependent alignment procedure for short read QS, which can be closely integrated with the placement process. Initial tests show that with tree-dependent realignment, it is possible to achieve higher EPA placement accuracy than with realignment using profile-HMMs. Another challenge consists of dealing with the matter of assigning short-read sequences to a RA when there is compositional heterogeneity across the sequences. This is a particularly important issue if sequences have acquired the same nucleotide or amino acid composition independently. A final challenge consists in developing appropriate visualization tools and metrics for analyzing distributions of reads on trees that have been computed by the EPA or pplacer programs.</p>
    </sec>
    <sec sec-type="supplementary-material">
      <title>S<sc>UPPLEMENTARY</sc> M<sc>ATERIAL</sc></title>
      <p content-type="availability"><ext-link ext-link-type="uri" xlink:href="http://sysbio.oxfordjournals.org/cgi/content/full/syr010/DC1">Supplementary material</ext-link>, including data files and/or online-only appendices, can be found at <ext-link ext-link-type="uri" xlink:href="http://www.sysbio.oxfordjournals.org/">http://www.sysbio.oxfordjournals.org/</ext-link>.</p>
      <supplementary-material id="PMC_1" content-type="local-data">
        <caption>
          <title>Supplementary Data</title>
        </caption>
        <media mimetype="text" mime-subtype="html" xlink:href="supp_60_3_291__index.html"/>
        <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_syr010_supplementary.pdf"/>
      </supplementary-material>
    </sec>
    <sec>
      <title>F<sc>UNDING</sc></title>
      <p content-type="funding">This work was partially funded under the auspices of the <funding-source>Emmy&#x2013;Noether program by the German Science Foundation (DFG)</funding-source>. Grant numbers: <award-id>DFG STA 860/2</award-id> (S. A. Berger) and <award-id>DFG STA 860/3</award-id> (D. Krompass).</p>
    </sec>
  </body>
  <back>
    <ack>
      <p content-type="acknowledgment">The authors would like to thank Rob Knight, Steven Kembel, Micah Hamady, Christian von Mering, and Manuel Stark for useful discussions on algorithm design and for providing test data sets. We also thank F. Matsen for fruitful discussions on pplacer and EPA. We wish to acknowledge the constructive suggestions made by an anonymous reviewer.</p>
    </ack>
    <ref-list>
      <ref id="bib1">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ababneh</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Jermiin</surname>
              <given-names>LS</given-names>
            </name>
            <name>
              <surname>Ma</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Matched-pairs tests of homogeneity with applications to homologous nucleotide sequences</article-title>
          <source>Bioinformatics</source>
          <year>2006</year>
          <volume>22</volume>
          <fpage>1225</fpage>
          <lpage>1231</lpage>
          <pub-id pub-id-type="pmid">16492684</pub-id>
        </element-citation>
      </ref>
      <ref id="bib2">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Altschul</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Madden</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Schaffer</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Miller</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Lipman</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
          <source>Nucleic Acids Res.</source>
          <year>1997</year>
          <volume>25</volume>
          <fpage>3389</fpage>
          <pub-id pub-id-type="pmid">9254694</pub-id>
        </element-citation>
      </ref>
      <ref id="bib3">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Berger</surname>
              <given-names>SA</given-names>
            </name>
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <source>Accuracy of morphology-based phylogenetic fossil placement under maximum likelihood. Proceedings of IEEE/ACS International Conference on Computer Systems and Applications (AICCSA-10); 2010 May 16&#x2013;18; Hammamet, Tunisia: IEEE Computer Society. p. 1&#x2013;8</source>
          <year>2010</year>
        </element-citation>
      </ref>
      <ref id="bib4">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Bininda-Emonds</surname>
              <given-names>ORP</given-names>
            </name>
            <name>
              <surname>Brady</surname>
              <given-names>SG</given-names>
            </name>
            <name>
              <surname>Sanderson</surname>
              <given-names>MJ</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <person-group person-group-type="editor">
            <name>
              <surname>Altman</surname>
              <given-names>RB</given-names>
            </name>
            <name>
              <surname>Dunker</surname>
              <given-names>AK</given-names>
            </name>
            <name>
              <surname>Hunter</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Lauderdale</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Klein</surname>
              <given-names>TE</given-names>
            </name>
          </person-group>
          <article-title>Scaling of accuracy in extremely large phylogenetic trees</article-title>
          <source>Pacific Symposium on Biocomputing 2001</source>
          <year>2000</year>
          <publisher-loc>River Edge (NJ)</publisher-loc>
          <publisher-name>World Scientific</publisher-name>
          <fpage>547</fpage>
          <lpage>558</lpage>
        </element-citation>
      </ref>
      <ref id="bib5">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Brady</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Salzberg</surname>
              <given-names>SL</given-names>
            </name>
          </person-group>
          <article-title>Phymm and PhymmBL: metagenomic phylogenetic classification with interpolated Markov models</article-title>
          <source>Nat. Methods</source>
          <year>2009</year>
          <volume>6</volume>
          <fpage>673</fpage>
          <lpage>676</lpage>
          <pub-id pub-id-type="pmid">19648916</pub-id>
        </element-citation>
      </ref>
      <ref id="bib6">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chakravorty</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Helb</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Burday</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Connell</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Alland</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>A detailed analysis of 16S ribosomal RNA gene segments for the diagnosis of pathogenic bacteria</article-title>
          <source>J. Microbiol. Methods</source>
          <year>2007</year>
          <volume>69</volume>
          <fpage>330</fpage>
          <lpage>339</lpage>
          <pub-id pub-id-type="pmid">17391789</pub-id>
        </element-citation>
      </ref>
      <ref id="bib7">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>DeSantis</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Hugenholtz</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Keller</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Brodie</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Larsen</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Piceno</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Phan</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Andersen</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>
          <source>Nucleic Acids Res.</source>
          <year>2006</year>
          <volume>34</volume>
          <fpage>W394</fpage>
          <lpage>W399</lpage>
          <pub-id pub-id-type="pmid">16845035</pub-id>
        </element-citation>
      </ref>
      <ref id="bib8">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Eddy</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Profile hidden Markov models</article-title>
          <source>Bioinformatics</source>
          <year>1998</year>
          <volume>14</volume>
          <fpage>755</fpage>
          <lpage>763</lpage>
          <pub-id pub-id-type="pmid">9918945</pub-id>
        </element-citation>
      </ref>
      <ref id="bib9">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Edgar</surname>
              <given-names>RC</given-names>
            </name>
          </person-group>
          <article-title>Muscle: multiple sequence alignment with high accuracy and high throughput</article-title>
          <source>Nucleic Acids Res.</source>
          <year>2004</year>
          <volume>32</volume>
          <fpage>1792</fpage>
          <lpage>1797</lpage>
          <pub-id pub-id-type="pmid">15034147</pub-id>
        </element-citation>
      </ref>
      <ref id="bib10">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Felsenstein</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>
          <source>J. Mol. Evol.</source>
          <year>1981</year>
          <volume>17</volume>
          <fpage>368</fpage>
          <lpage>376</lpage>
          <pub-id pub-id-type="pmid">7288891</pub-id>
        </element-citation>
      </ref>
      <ref id="bib11">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Felsenstein</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Confidence limits on phylogenies: an approach using the bootstrap</article-title>
          <source>Evolution</source>
          <year>1985</year>
          <volume>39</volume>
          <fpage>783</fpage>
          <lpage>791</lpage>
        </element-citation>
      </ref>
      <ref id="bib12">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fierer</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Hamady</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Lauber</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <source>The influence of sex, handedness, and washing on the diversity of hand surface bacteria. Proc. Natl. Acad. Sci. U.S.A</source>
          <year>2008</year>
          <volume>105</volume>
          <fpage>17994</fpage>
          <lpage>17999</lpage>
        </element-citation>
      </ref>
      <ref id="bib13">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Galtier</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Gouy</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Inferring pattern and process: maximum-likelihood implementation of a nonhomogeneous model of DNA sequence evolution for phylogenetic analysis</article-title>
          <source>Mol. Biol. Evol.</source>
          <year>1998</year>
          <volume>15</volume>
          <fpage>871</fpage>
          <lpage>879</lpage>
          <pub-id pub-id-type="pmid">9656487</pub-id>
        </element-citation>
      </ref>
      <ref id="bib14">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ganzert</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Jurgens</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Munster</surname>
              <given-names>U</given-names>
            </name>
            <name>
              <surname>Wagner</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>Methanogenic communities in permafrost-affected soils of the laptev sea coast, siberian arctic, characterized by 16s rRNA gene fingerprints</article-title>
          <source>FEMS Microbiol. Ecol</source>
          <year>2007</year>
          <volume>59</volume>
          <fpage>476</fpage>
          <lpage>488</lpage>
          <pub-id pub-id-type="pmid">16978241</pub-id>
        </element-citation>
      </ref>
      <ref id="bib15">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hamming</surname>
              <given-names>RW</given-names>
            </name>
          </person-group>
          <article-title>Error detecting and error correcting codes. Bell Syst</article-title>
          <source>Tech. J.</source>
          <year>1950</year>
          <volume>26</volume>
          <fpage>147</fpage>
          <lpage>160</lpage>
        </element-citation>
      </ref>
      <ref id="bib16">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Han</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Zmasek</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>phyloXML: XML for evolutionary biology and comparative genomics</article-title>
          <source>BMC Bioinformatics</source>
          <year>2009</year>
          <volume>10</volume>
          <fpage>356</fpage>
          <pub-id pub-id-type="pmid">19860910</pub-id>
        </element-citation>
      </ref>
      <ref id="bib17">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hillis</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Bull</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>An empirical test of bootstrapping as a method for assessing confidence in phylogenetic analysis</article-title>
          <source>Syst. Biol.</source>
          <year>1993</year>
          <volume>42</volume>
          <fpage>182</fpage>
        </element-citation>
      </ref>
      <ref id="bib18">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ho</surname>
              <given-names>JWK</given-names>
            </name>
            <name>
              <surname>Adams</surname>
              <given-names>CE</given-names>
            </name>
            <name>
              <surname>Lew</surname>
              <given-names>JB</given-names>
            </name>
            <name>
              <surname>Matthews</surname>
              <given-names>TJ</given-names>
            </name>
            <name>
              <surname>Ng</surname>
              <given-names>CC</given-names>
            </name>
            <name>
              <surname>Shahabi-Sirjani</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tan</surname>
              <given-names>LH</given-names>
            </name>
            <name>
              <surname>Zhao</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Easteal</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Wilson</surname>
              <given-names>SR</given-names>
            </name>
            <name>
              <surname>Jermiin</surname>
              <given-names>LS</given-names>
            </name>
          </person-group>
          <article-title>SeqVis: visualization of compositional heterogeneity in large alignments of nucleotides</article-title>
          <source>Bioinformatics</source>
          <year>2006</year>
          <volume>22</volume>
          <fpage>2162</fpage>
          <lpage>2163</lpage>
          <pub-id pub-id-type="pmid">16766557</pub-id>
        </element-citation>
      </ref>
      <ref id="bib19">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hudson</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Auch</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Qi</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Schuster</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>MEGAN analysis of metagenomic data</article-title>
          <source>Genome Res.</source>
          <year>2007</year>
          <volume>17</volume>
          <fpage>377</fpage>
          <lpage>386</lpage>
          <pub-id pub-id-type="pmid">17255551</pub-id>
        </element-citation>
      </ref>
      <ref id="bib20">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Jayaswal</surname>
              <given-names>V</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Jermiin</surname>
              <given-names>LS</given-names>
            </name>
          </person-group>
          <article-title>Estimation of phylogeny and invariant sites under the general Markov model of nucleotide sequence evolution</article-title>
          <source>Syst. Biol.</source>
          <year>2007</year>
          <volume>56</volume>
          <fpage>155</fpage>
          <lpage>162</lpage>
          <pub-id pub-id-type="pmid">17454972</pub-id>
        </element-citation>
      </ref>
      <ref id="bib21">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Jermiin</surname>
              <given-names>LS</given-names>
            </name>
            <name>
              <surname>Ho</surname>
              <given-names>SYW</given-names>
            </name>
            <name>
              <surname>Ababneh</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Larkum</surname>
              <given-names>AWD</given-names>
            </name>
          </person-group>
          <article-title>The biasing effect of compositional heterogeneity on phylogenetic estimates may be underestimated</article-title>
          <source>Syst. Biol.</source>
          <year>2004</year>
          <volume>53</volume>
          <fpage>638</fpage>
          <lpage>643</lpage>
          <pub-id pub-id-type="pmid">15371251</pub-id>
        </element-citation>
      </ref>
      <ref id="bib22">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Katoh</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Kuma</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Toh</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Miyata</surname>
              <given-names>T</given-names>
            </name>
          </person-group>
          <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
          <source>Nucleic Acids Res.</source>
          <year>2005</year>
          <volume>33</volume>
          <fpage>511</fpage>
          <lpage>518</lpage>
          <pub-id pub-id-type="pmid">15661851</pub-id>
        </element-citation>
      </ref>
      <ref id="bib23">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kluge</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Farris</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Quantitative phyletics and the evolution of anurans</article-title>
          <source>Syst. Zool</source>
          <year>1969</year>
          <volume>18</volume>
          <fpage>1</fpage>
          <lpage>32</lpage>
        </element-citation>
      </ref>
      <ref id="bib24">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Koski</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Golding</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>The closest BLAST hit is often not the nearest neighbor</article-title>
          <source>J. Mol. Evol.</source>
          <year>2001</year>
          <volume>52</volume>
          <fpage>540</fpage>
          <lpage>542</lpage>
          <pub-id pub-id-type="pmid">11443357</pub-id>
        </element-citation>
      </ref>
      <ref id="bib25">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ley</surname>
              <given-names>RE</given-names>
            </name>
            <name>
              <surname>B&#xE4;ckhed</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Turnbaugh</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Lozupone</surname>
              <given-names>CA</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>RD</given-names>
            </name>
            <name>
              <surname>Gordon</surname>
              <given-names>JI</given-names>
            </name>
          </person-group>
          <article-title>Obesity alters gut microbial ecology</article-title>
          <source>Proc. Natl. Acad. Sci. U.S.A</source>
          <year>2005</year>
          <volume>102</volume>
          <fpage>11070</fpage>
          <lpage>11075</lpage>
          <pub-id pub-id-type="pmid">16033867</pub-id>
        </element-citation>
      </ref>
      <ref id="bib26">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ley</surname>
              <given-names>RE</given-names>
            </name>
            <name>
              <surname>Harris</surname>
              <given-names>JK</given-names>
            </name>
            <name>
              <surname>Wilcox</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Spear</surname>
              <given-names>JR</given-names>
            </name>
            <name>
              <surname>Miller</surname>
              <given-names>SR</given-names>
            </name>
            <name>
              <surname>Bebout</surname>
              <given-names>BM</given-names>
            </name>
            <name>
              <surname>Maresca</surname>
              <given-names>JA</given-names>
            </name>
            <name>
              <surname>Bryant</surname>
              <given-names>DA</given-names>
            </name>
            <name>
              <surname>Sogin</surname>
              <given-names>ML</given-names>
            </name>
            <name>
              <surname>Pace</surname>
              <given-names>NR</given-names>
            </name>
          </person-group>
          <article-title>Unexpected diversity and complexity of the guerrero negro hypersaline microbial mat</article-title>
          <source>Appl. Environ. Microbiol.</source>
          <year>2006</year>
          <volume>72</volume>
          <fpage>3685</fpage>
          <lpage>3695</lpage>
          <pub-id pub-id-type="pmid">16672518</pub-id>
        </element-citation>
      </ref>
      <ref id="bib27">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ley</surname>
              <given-names>RE</given-names>
            </name>
            <name>
              <surname>Lozupone</surname>
              <given-names>CA</given-names>
            </name>
            <name>
              <surname>Hamady</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>RD</given-names>
            </name>
            <name>
              <surname>Gordon</surname>
              <given-names>JI</given-names>
            </name>
          </person-group>
          <article-title>Worlds within worlds: evolution of the vertebrate gut microbiota</article-title>
          <source>Nat. Rev. Microbiol.</source>
          <year>2008</year>
          <volume>6</volume>
          <fpage>776</fpage>
          <lpage>788</lpage>
          <pub-id pub-id-type="pmid">18794915</pub-id>
        </element-citation>
      </ref>
      <ref id="bib28">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lozupone</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>
          <source>Appl. Environ. Microbiol.</source>
          <year>2005</year>
          <volume>71</volume>
          <fpage>8228</fpage>
          <lpage>8235</lpage>
          <pub-id pub-id-type="pmid">16332807</pub-id>
        </element-citation>
      </ref>
      <ref id="bib29">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ludwig</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Strunk</surname>
              <given-names>O</given-names>
            </name>
            <name>
              <surname>Westram</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Richter</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Meier</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Yadhukumar</surname>
              <given-names>BA</given-names>
            </name>
            <name>
              <surname>Lai</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Steppi</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Jobb</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Forster</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Brettske</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Gerber</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ginhart</surname>
              <given-names>AW</given-names>
            </name>
            <name>
              <surname>Gross</surname>
              <given-names>O</given-names>
            </name>
            <name>
              <surname>Grumann</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Hermann</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Jost</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Konig</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Liss</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Lussmann</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>May</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Nonhoff</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Reichel</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Strehlow</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Stuckmann</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Vilbig</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Lenke</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Ludwig</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Bode</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Schleifer</surname>
              <given-names>KH</given-names>
            </name>
          </person-group>
          <article-title>Arb: a software environment for sequence data</article-title>
          <source>Nucleic Acids Res.</source>
          <year>2004</year>
          <volume>32</volume>
          <fpage>1363</fpage>
          <lpage>1371</lpage>
          <pub-id pub-id-type="pmid">14985472</pub-id>
        </element-citation>
      </ref>
      <ref id="bib30">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Matsen</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Kodner</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Armbrust</surname>
              <given-names>EV</given-names>
            </name>
          </person-group>
          <article-title>Pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
          <source>BMC Bioinformatics</source>
          <year>2010</year>
          <volume>11</volume>
          <fpage>538</fpage>
          <pub-id pub-id-type="pmid">21034504</pub-id>
        </element-citation>
      </ref>
      <ref id="bib31">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>McHardy</surname>
              <given-names>AC</given-names>
            </name>
            <name>
              <surname>Martin</surname>
              <given-names>HG</given-names>
            </name>
            <name>
              <surname>Aristotelis</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Hugenholtz</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Rigoutsos</surname>
              <given-names>I</given-names>
            </name>
          </person-group>
          <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>
          <source>Nat. Methods</source>
          <year>2007</year>
          <volume>4</volume>
          <fpage>63</fpage>
          <lpage>72</lpage>
          <pub-id pub-id-type="pmid">17179938</pub-id>
        </element-citation>
      </ref>
      <ref id="bib32">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Moret</surname>
              <given-names>BME</given-names>
            </name>
            <name>
              <surname>Roshan</surname>
              <given-names>U</given-names>
            </name>
            <name>
              <surname>Warnow</surname>
              <given-names>T</given-names>
            </name>
          </person-group>
          <person-group person-group-type="editor">
            <name>
              <surname>Guigo</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gusfield</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>Sequence-length requirements for phylogenetic methods</article-title>
          <source>Proceedings of Second International Workshop on Algorithms in Bioinformatics (WABI 02) 2002</source>
          <year>2002</year>
          <publisher-loc>Berlin</publisher-loc>
          <publisher-name>Springer</publisher-name>
          <fpage>343</fpage>
          <lpage>356</lpage>
          <comment>(Lecture Notes in Computer Science; 2452)</comment>
        </element-citation>
      </ref>
      <ref id="bib33">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Munch</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Boomsma</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Huelsenbeck</surname>
              <given-names>JP</given-names>
            </name>
            <name>
              <surname>Willerslev</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Nielsen</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>Statistical assignment of DNA sequences using Bayesian phylogenetics</article-title>
          <source>Syst. Biol.</source>
          <year>2008</year>
          <volume>57</volume>
          <fpage>750</fpage>
          <lpage>757</lpage>
          <pub-id pub-id-type="pmid">18853361</pub-id>
        </element-citation>
      </ref>
      <ref id="bib34">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Nielsen</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Matz</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Statistical approaches for DNA barcoding</article-title>
          <source>Syst. Biol.</source>
          <year>2006</year>
          <volume>55</volume>
          <fpage>162</fpage>
          <lpage>169</lpage>
          <pub-id pub-id-type="pmid">16507534</pub-id>
        </element-citation>
      </ref>
      <ref id="bib35">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Pruitt</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Tatusova</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Maglott</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>
          <source>Nucleic Acids Res.</source>
          <year>2007</year>
          <volume>35</volume>
          <issue>Database issue</issue>
          <fpage>D61</fpage>
          <lpage>D65</lpage>
          <pub-id pub-id-type="pmid">17130148</pub-id>
        </element-citation>
      </ref>
      <ref id="bib36">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ronaghi</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Pyrosequencing sheds light on DNA sequencing</article-title>
          <source>Genome Res.</source>
          <year>2001</year>
          <volume>11</volume>
          <fpage>3</fpage>
          <lpage>11</lpage>
          <pub-id pub-id-type="pmid">11156611</pub-id>
        </element-citation>
      </ref>
      <ref id="bib37">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <source>Phylogenetic models of rate heterogeneity: a high performance computing perspective. Proceedings of 20th IEEE/ACM International Parallel and Distributed Processing Symposium (IPDPS2006); 2006 Apr 25&#x2013;29; Rhodes Island, Greece. IEEE Computer Society. p. 278</source>
          <year>2006</year>
        </element-citation>
      </ref>
      <ref id="bib38">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>
          <source>Bioinformatics</source>
          <year>2006b</year>
          <volume>22</volume>
          <fpage>2688</fpage>
          <lpage>2690</lpage>
          <pub-id pub-id-type="pmid">16928733</pub-id>
        </element-citation>
      </ref>
      <ref id="bib39">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Hoover</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Rougemont</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>A rapid bootstrap algorithm for the RAxML Web servers</article-title>
          <source>Syst. Biol.</source>
          <year>2008</year>
          <volume>57</volume>
          <fpage>758</fpage>
          <lpage>771</lpage>
          <pub-id pub-id-type="pmid">18853362</pub-id>
        </element-citation>
      </ref>
      <ref id="bib40">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Komornik</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Berger</surname>
              <given-names>SA</given-names>
            </name>
          </person-group>
          <source>Evolutionary placement of short sequence reads on multi-core architectures. Proceedings of IEEE/ACS International Conference on Computer Systems and Applications (AICCSA-10); 2010 May 16&#x2013;18; Hammamet, Tunisia. IEEE Computer Society. p. 1&#x2013;8</source>
          <year>2010</year>
        </element-citation>
      </ref>
      <ref id="bib41">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stamatakis</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Ludwig</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Meier</surname>
              <given-names>H</given-names>
            </name>
          </person-group>
          <article-title>RAxML-III: a fast program for maximum likelihood-based inference of large phylogenetic trees</article-title>
          <source>Bioinformatics</source>
          <year>2005</year>
          <volume>21</volume>
          <issue>4</issue>
          <fpage>456</fpage>
          <lpage>463</lpage>
          <pub-id pub-id-type="pmid">15608047</pub-id>
        </element-citation>
      </ref>
      <ref id="bib42">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Strimmer</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Rambaut</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>Inferring confidence sets of possibly misspecified gene trees</article-title>
          <source>Proc. R. Soc. B Biol. Sci.</source>
          <year>2002</year>
          <volume>269</volume>
          <fpage>137</fpage>
          <lpage>142</lpage>
        </element-citation>
      </ref>
      <ref id="bib43">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Turnbaugh</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Hamady</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Yatsunenko</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Cantarel</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Duncan</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Ley</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Sogin</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Jones</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Roe</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Affourtit</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Egholm</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Henrissat</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Heath</surname>
              <given-names>AC</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gordon</surname>
              <given-names>JI</given-names>
            </name>
          </person-group>
          <article-title>A core gut microbiome in obese and lean twins</article-title>
          <source>Nature</source>
          <year>2008</year>
          <volume>457</volume>
          <fpage>480</fpage>
          <lpage>484</lpage>
          <pub-id pub-id-type="pmid">19043404</pub-id>
        </element-citation>
      </ref>
      <ref id="bib44">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Von Mering</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Hugenholtz</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Raes</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Tringe</surname>
              <given-names>SG</given-names>
            </name>
            <name>
              <surname>Doerks</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Jensen</surname>
              <given-names>LJ</given-names>
            </name>
            <name>
              <surname>Ward</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Bork</surname>
              <given-names>P</given-names>
            </name>
          </person-group>
          <article-title>Quantitative phylogenetic assessment of microbial communities in diverse environments</article-title>
          <source>Science</source>
          <year>2007</year>
          <volume>315</volume>
          <fpage>1126</fpage>
          <lpage>1130</lpage>
          <pub-id pub-id-type="pmid">17272687</pub-id>
        </element-citation>
      </ref>
    </ref-list>
  </back>
</article>
