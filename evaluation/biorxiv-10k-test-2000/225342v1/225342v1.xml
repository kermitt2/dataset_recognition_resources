<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/225342</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>High-throughput ANI Analysis of 90K Prokaryotic Genomes Reveals Clear Species Boundaries</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7837-2128</contrib-id>
<name>
<surname>Jain</surname>
<given-names>Chirag</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rodriguez-R</surname>
<given-names>Luis M.</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a3">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Phillippy</surname>
<given-names>Adam M.</given-names>
</name>
<xref ref-type="aff" rid="a4">d</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Konstantinidis</surname>
<given-names>Konstantinos T.</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a3">c</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Aluru</surname>
<given-names>Srinivas</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a5">e</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>a</label><institution>School of Computational Science and Engineering, Georgia Institute of Technology</institution>, Atlanta GA 30332</aff>
<aff id="a2"><label>b</label><institution>School of Civil and Environmental Engineering, Georgia Institute of Technology</institution>, Atlanta GA 30332</aff>
<aff id="a3"><label>c</label><institution>School of Biological Sciences, Georgia Institute of Technology</institution>, Atlanta GA 30332</aff>
<aff id="a4"><label>d</label><institution>National Human Genome Research Institute, National Institutes of Health</institution>, Bethesda MD 20894</aff>
<aff id="a5"><label>e</label><institution>Institute for Data Engineering and Science, Georgia Institute of Technology</institution>, Atlanta GA 30332</aff>
</contrib-group>
<author-notes>
<fn id="n1"><p>This manuscript was compiled on November 27, 2017</p></fn>
<fn id="n2"><p>K.T.K. conceived the study; C.J., A.M.P, and S.A. designed method; C.J., and L.M.R. analyzed data; and C.J., L.M.R., K.T.K., and S.A. wrote the paper.</p></fn>
<fn id="n3" fn-type="conflict"><p>The authors declare no conflict of interest.</p></fn>
<corresp id="cor1"><label>&#x002A;</label>To whom correspondence should be addressed. E-mail: <email>kostas.konstantinidis@gatech.edu</email>, <email>aluru@cc.gatech.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>225342</elocation-id>
<history>
<date date-type="received">
<day>26</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>26</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="225342.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<p>A fundamental question in microbiology is whether there is a continuum of genetic diversity among genomes or clear species boundaries prevail instead. Answering this question requires robust measurement of whole-genome relatedness among thousands of genomes and from diverge phylogenetic lineages. Whole-genome similarity metrics such as Average Nucleotide Identity (ANI) can provide the resolution needed for this task, overcoming several limitations of traditional techniques used for the same purposes. Although the number of genomes currently available may be adequate, the associated bioinformatics tools for analysis are lagging behind these developments and cannot scale to large datasets. Here, we present a new method, FastANI, to compute ANI using alignment-free approximate sequence mapping. Our analyses demonstrate that FastANI produces an accurate ANI estimate and is up to three orders of magnitude faster when compared to an alignment (e.g., BLAST)-based approach. We leverage FastANI to compute pairwise ANI values among all prokaryotic genomes available in the NCBI database. Our results reveal a clear genetic discontinuity among the database genomes, with 99.8&#x0025; of the total 8 billion genome pairs analyzed showing either &#x003E;95&#x0025; intra-species ANI or &#x003C;83&#x0025; inter-species ANI values. We further show that this discontinuity is recovered with or without the most frequently represented species in the database and is robust to historic additions in the public genome databases. Therefore, 95&#x0025; ANI represents an accurate threshold for demarcating almost all currently named prokaryotic species, and wide species boundaries may exist for prokaryotes.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>species concept</kwd>
<kwd>nucleotide identity</kwd>
<kwd>minhash</kwd>
<kwd>prokaryotic diversity</kwd>
</kwd-group>
<counts>
<page-count count="14"/>
</counts>
</article-meta>
</front>
<body>
<p>Large collections of prokaryotic genomes with varied ecologic and evolutionary histories are now publicly available. This deluge of genomic data provides the opportunity to more robustly evaluate important questions in microbial ecology and evolution, as well as underscores the need to advance existing bioinformatics approaches for the analysis of such big genomic data. One such question is whether bacteria (and other microbes) form discrete clusters (species), or, due to high frequency of horizontal gene transfer (HGT) and slow decay kinetics, a continuum of genetic diversity is observed instead. Studies based on a small number of closely related genomes have shown that genetic continuum may prevail [e.g., (<xref ref-type="bibr" rid="c1">1</xref>)]. On the other hand, other studies have argued that HGT may not be frequent enough to distort species boundaries, or that organisms within species exchange DNA more frequently compared to organisms across species, thus maintaining distinct clusters [e.g., (<xref ref-type="bibr" rid="c2">2</xref>)]. An important criticism of all these studies is that they have typically been performed with isolated genomes in the laboratory that may not adequately represent natural diversity due to cultivation biases, or were based on a small number of available genomes from a few phylogenetic lineages, which does not allow for robust conclusions to emerge. Therefore, it is still unclear if well-defined clusters of genomes are evident among prokaryotes and how to recognize them. Defining species is not only an important academic exercise but also has major practical consequences. For instance, the diagnosis of disease agents, the regulation of which organisms can be transported across countries and which organisms should be under quarantine, or the communication about which organisms or mixtures of organisms are beneficial to human, animals or plants, are all deeply-rooted on how species are defined.</p>
<p>One fundamental task in assessing species boundaries is the estimation of the genetic relatedness between two genomes. In recent years, the whole-genome average nucleotide identity (ANI) has emerged as a robust method for this task, with organisms belonging to the same species typically showing &#x2265;95&#x0025; ANI among themselves (<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>). ANI represents the average nucleotide identity of all orthologous genes shared between any two genomes and offers robust resolution between strains of the same or closely related species (i.e., showing 80-100&#x0025; ANI). The ANI measure does not strictly represent core genome evolutionary relatedness, as orthologous genes can vary widely between pairs of genomes compared. Nevertheless, it closely reflects the traditional microbiological concept of DNA-DNA hybridization relatedness for defining species (<xref ref-type="bibr" rid="c3">3</xref>), as it takes into account the fluid nature of the bacterial gene pool and hence implicitly considers shared function. Compared to sequencing of 16S rRNA genes, another highly popular, alternative traditional method for defining species and assessing their evolutionary uniqueness, ANI offers several important advantages such as higher resolution among closely related genomes. Finally, ANI can be estimated among draft (incomplete) genome sequences recovered from the environment using metagenomic or singe-cell techniques that do not encode a universally conserved gene such as the 16S rRNA gene (e.g., due to mis-assembly) but encode at least a few hundred shared genes, greatly expanding the number of sequences that can be studied and classified compared to a universal gene-based approach. Accordingly, ANI has been recognized internationally for its potential for replacing DNA-DNA hybridization as the standard measure of relatedness, as it is easier to estimate and represents portable and reproducible data (<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>). Despite its strengths, traditional ANI calculation is based on alignment-based searches [e.g., BLAST (<xref ref-type="bibr" rid="c7">7</xref>)] and thus, remains computationally expensive due to the quadratic time complexity of alignment algorithms, and does not scale well with an increasing number of genomes.</p>
<boxed-text id="ubox1" position="float">
<sec>
<title>Significance Statement</title>
<p>With the advent of big data in genomics, fundamental biological questions can now be answered through data-driven approaches and scalable bioinformatics algorithms. Doing so, requires new algorithms that employ intelligent tradeoffs between computational speed and accuracy. This work presents such a scalable algorithm for computing the whole-genome genetic relatedness among genomes. By applying this algorithm to a large collection of prokaryotic genomes, our study addressed the following biological question: do well-defined clusters of genomes (species) exist?</p>
</sec>
</boxed-text>
<p>Several variations of the original ANI calculation algorithm have been proposed (<xref ref-type="bibr" rid="c8">8</xref>&#x2013;<xref ref-type="bibr" rid="c10">10</xref>), but these mainly modify the specific approach to identify shared genes and do not speed up the calculation substantially since they are all alignment-based. Accordingly, it is nearly impossible to calculate ANI values among the available microbial genomes to date, in the order of a hundred thousand, based on these approaches and commonly available computational resources. Importantly, the available genomic data is estimated to be a small fraction of the extant prokaryotic diversity (<xref ref-type="bibr" rid="c11">11</xref>), and the number of new genomes determined continues to grow exponentially. Therefore, new computational solutions are needed to scale-up with the available and forthcoming data.</p>
<p>A couple of such solutions have been proposed recently, borrowing concepts from &#x2018;big data&#x2019; analysis in other scientific domains. MinHash is a technique for quick estimation of similarity of two sets, initially developed for the detection of near-duplicate web documents in search engines at the scale of the World Wide Web (<xref ref-type="bibr" rid="c12">12</xref>). Recently, this technique was successfully adapted for designing new fast algorithms in bioinformatics such as for genome assembly (<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>) and long read mapping problems (<xref ref-type="bibr" rid="c15">15</xref>). Ondov <italic>et. al</italic>. (<xref ref-type="bibr" rid="c16">16</xref>) provided the first proof-of-concept implementation called Mash for fast estimation of ANI using this technique. Even though Mash has been reported to be multiple orders of magnitude faster than alignment-based ANI computation, a straight-forward adoption of the MinHash technique to the problem of computing ANI has been found to be inaccurate for incomplete draft genomes (<xref ref-type="bibr" rid="c17">17</xref>). Further, there is a limit on how well Mash can approximate ANI especially for moderately divergent genomes (e.g., showing 80-90&#x0025; ANI), as Mash similarity measurement is not restricted to the shared genomic regions, whereas ANI considers only the shared genome.</p>
<p>In this study, we alleviate the computational bottleneck in ANI computation by developing FastANI, a novel algorithm utilizing Mashmap (<xref ref-type="bibr" rid="c15">15</xref>) as its MinHash based alignment-free sequence mapping engine. FastANI provides ANI values that are essentially identical to the alignment-based ANI values for both complete and draft quality genomes that are related in the 80&#x0025; to 100&#x0025; nucleotide identity range. Therefore, FastANI should enable the accurate estimation of pairwise ANI values for large cohorts of genomes or evaluation of the novelty of a query draft genome by comparing it against the full collection of available prokaryotic genomes.</p>
<sec id="s1">
<title>Results</title>
<p>We developed FastANI, an algorithm for efficiently computing pairwise average nucleotide identities among a large set of genomes, and applied it to determine whether genomic data supports the existence of genetic discontinuity and clear special boundaries among prokaryotic species. We first demonstrate FastANI yields accuracy on par with the widely accepted BLASTn based approaches, and then leverage its computational efficiency to analyze genomic relatedness within and across species.</p>
<sec id="s1a">
<title>Datasets</title>
<p>To test accuracy and speed, we evaluated FastANI on both high-quality closed genomes from NCBI RefSeq database as well as draft genome assemblies downloaded from the prokaryote section of the NCBI Genome database. We first removed poor quality genome assemblies with low N50 length (&#x003C; 10 Kbp). In total, four datasets were used (D1 through D4). Dataset D1 is the set of closed prokaryotic genomes downloaded from RefSeq database. Datasets D2, D3, and D4 are collections of draft genome assemblies of <italic>Bacillus cereus, Escherichia coli</italic> and <italic>Bacillus anthracis</italic>, respectively. These sizable datasets represent genomes showing different levels of identity among themselves and varying values of completeness and assembly quality. For each dataset, one genome was selected as the query genome and its ANI was computed with every genome in the complete dataset (see <xref ref-type="table" rid="tbl1">Table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Datasets used for testing accuracy and speed of FastANI.</p></caption>
<graphic xlink:href="225342_tbl1.tif"/>
</table-wrap>
</sec>
<sec id="s1b">
<title>Accuracy</title>
<p>We evaluated FastANI against the BLASTn based method of computing ANI (<xref ref-type="bibr" rid="c9">9</xref>), henceforth referred as ANI<sub>b</sub>, and the ANI values predicted by the Mash tool (<xref ref-type="bibr" rid="c16">16</xref>). User documentation for Mash recommends using larger sketch size (i.e., k-mer sample) than the default to obtain higher accuracy (<xref ref-type="bibr" rid="c16">16</xref>). Accordingly, we ran Mash with both the default sketch size of 1<italic>K</italic> as well as increase it up to 100<italic>K</italic>.</p>
<p>FastANI achieves near perfect linear correlation with ANI<sub>b</sub> on all datasets D1-D4 (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Mash results improve with increasing sketch size, particularly for D1. However, even when executed with the largest sketch size of 100K, Mash results diverge from ANI<sub>b</sub> values on datasets D1, D3 and D4. For D1, this primarily appears to be caused by divergent genomes (e.g., showing &#x003C; 90&#x0025; ANI). For D3, Mash diverges on closely related genomes due to fragmented and incomplete genome assemblies of the draft genomes. Dataset D4 is challenging because its constituent genomes are closely related strains of <italic>Bacillus anthracis</italic>, with ANI<sub>b</sub> &#x003E; 99.9 for all the pairs. FastANI provides much better precision than Mash in D4 dataset, and therefore, can be used to discriminate between very closely related microbial strains such as those of different epidemic outbreaks. However, for two genomes out of the 464, FastANI estimates are diverging from ANI<sub>b</sub>. To investigate further, we visualized gene synteny pattern using Mauve (<xref ref-type="bibr" rid="c18">18</xref>) and found that these two genome sequences have many re-arrangements with respect to the query genome (<xref ref-type="fig" rid="figS1">Supplementary Fig. S1</xref>). Given that <italic>B. anthracis</italic> strains typically show high genome synteny (<xref ref-type="bibr" rid="c19">19</xref>), these results indicate that the two genomes were incorrectly assembled. Incorrect data will yield unpredictable results not only with FastANI but using any method that assesses genetic relatedness, including phylogeny-based methods. If the two incorrect <italic>B. anthracis</italic> assemblies are removed, FastANI&#x2019;s correlation with ANI<sub>b</sub> improves to 0.944 in D4.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1.</label>
<caption><p>Plots showing how FastANI and Mash-based ANI (sketch size &#x003D; 10<sup>5</sup>) output correlate with ANI<sub>b</sub> values for datasets D1-D4. Because FastANI assumes a probabilistic identity cutoff that is set to 80&#x0025; by default, it reports 76, 570, 4,271 and 464 genome matches for the individual queries in datasets D1-D4 respectively. To enable a direct quality comparison against FastANI, Mash is executed for only those pairs that are reported by FastANI. Notice that each dataset encompass a different nucleotide identity range (x-axes). Gray line represents a straight line <italic>y &#x003D; x</italic> plot for reference. Pearson correlation coefficients corresponding to these plots are listed separately in <xref ref-type="table" rid="tbl2">Table 2</xref>.</p></caption>
<graphic xlink:href="225342_fig1.tif"/>
</fig>
<p>These correlation results demonstrate FastANI provides significant quality improvement over Mash (see <xref ref-type="table" rid="tbl2">Table 2</xref>), and can be a reasonable substitute for ANI<sub>b</sub>. Aggregate results over all the datasets D1-D4 (<xref ref-type="fig" rid="fig2">Figure 2</xref>) led us to conclude that FastANI can tolerate variable assembly quality and completeness. Most importantly, it correlates well with ANI<sub>b</sub> in the desired identity range 80&#x0025; &#x2013; 100&#x0025;.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>Comparison of FastANI and Mash-based ANI accuracy by measuring their Pearson correlation coefficients with ANI<sub>b</sub> values. Mash is executed with sketch sizes (-s): 1,000 (default), 10,000 and 100,000. FastANI achieves &#x003E; 0.99 correlation with ANI<sub>b</sub> on D1-D3. Its correlation value on D4 improves from 0.681 to 0.944 if the two incorrect assemblies present in D4 are not taken into account.</p></caption>
<graphic xlink:href="225342_tbl2.tif"/>
</table-wrap>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 2.</label>
<caption><p>FastANI&#x2019;s aggregate accuracy and error characteristics based on datasets D1-D4. Upper left plot shows the FastANI and ANI<sub>b</sub> correlation. The remaining three plots show differences between FastANI and ANI<sub>b</sub> value versus reference genome assembly quality (N50 and length) and the number of reciprocal fragments that matched between query and reference genome for each comparison. These results show no biases associated with these factors.</p></caption>
<graphic xlink:href="225342_fig2.tif"/>
</fig>
</sec>
<sec id="s1c">
<title>Computational Speedup</title>
<p>FastANI is designed to efficiently process large assembly datasets with ordinary compute resources. For FastANI&#x2019;s sequential and parallel runtime evaluation, we used a single compute node with two Intel Xeon E5-2698 v4 20-core processors. First we show runtime comparison of FastANI and ANI<sub>b</sub> using serial execution (single thread, single process) using all datasets in <xref ref-type="table" rid="tbl3">Table 3</xref>. FastANI operation consists of indexing phase followed by compute phase, for which we measured the runtime separately. For any database, indexing all the reference genomes needs to be done only once, and thereafter, FastANI can compute ANI estimates for any number of input query genomes against the reference genomes. Therefore, speedup in <xref ref-type="table" rid="tbl3">Table 3</xref> is measured with respect to FastANI compute time. We observe that the runtime improvement due to FastANI varied from 50x for D3 to 782x for D1. FastANI speed-up was the highest on D1 because NCBI Refseq database contains a diverse set of prokaryotic genomes. This is attributable to the fact that the algorithm underlying FastANI is able to prune distant genomes (ANI &#x226A; 80&#x0025;) efficiently. On the contrary, ANI values for all genomes in datasets D2-D4 were high &#x003E; 80&#x0025;.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><p>Comparison of execution time of FastANI versus ANI<sub>b</sub>. Speedup in the last column is measured as the ratio of ANI<sub>b</sub>&#x2019;s runtime and FastANI&#x2019;s compute time.</p></caption>
<graphic xlink:href="225342_tbl3.tif"/>
</table-wrap>
<p>To accelerate ANI computation even further, FastANI can be trivially parallelized using multi-core parallel execution. One way to achieve this is to split the reference genomes in several equal-size parts. This way, each instance of FastANI process can search query genome(s) against each part of the reference database independently. We utilized this scheme and evaluated scalability using up to 80 FastANI parallel processes. Compared to the sequential execution time listed in <xref ref-type="table" rid="tbl3">Table 3</xref>, runtime of the compute phase reduced to 2, 8, 46 and 6 seconds for datasets D1-D4 respectively (<xref ref-type="fig" rid="fig3">Figure 3</xref>). These results confirm FastANI can be used to query against databases containing thousands of genomes in a few seconds.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 3.</label>
<caption><p>Scaling results of FastANI&#x2019;s execution time using datasets D1-D4 on a compute node with 40 physical cores. We executed parallel FastANI processes where each process was assigned an equal sized random part of the reference database for computing ANI. Left and right plots evaluate FastANI&#x2019;s compute and indexing phase, respectively. FastANI achieves reasonable speedups on all datasets except the compute phase in D1, as its runtime of 17s on a single core is too small to begin with (<xref ref-type="table" rid="tbl3">Table 3</xref>). FdastANI reduces this to 2 seconds using 80 parallel processes.</p></caption>
<graphic xlink:href="225342_fig3.tif"/>
</fig>
<p>For the above experiments, FastANI required a maximum 48 GB memory for D3, our largest dataset for this experiment. For databases much larger than D3, peak memory usage can be reduced by either distributing the compute across multiple nodes in a cluster or processing chunks of the reference database one by one, as necessary.</p>
</sec>
<sec id="s1d">
<title>Large-scale Pairwise Comparison Indicates Genetic Discontinuity</title>
<p>We examined the distribution of pairwise ANI values between all 91,761 prokaryotic assemblies that existed in the NCBI Genome database as of March 15, 2017. Prior to analysis, we removed 2,262 genomes due to short N50 length (&#x003C; 10 Kbp). In our analysis, the ANI between each pair of genomes A and B is computed twice, once with <italic>A</italic> as query genome and again with <italic>B</italic> as query genome. This choice did not meaningfully alter the ANI value reported by FastANI unless the draft genomes are incorrectly assembled or contaminated (<xref ref-type="fig" rid="figS2">Supplementary Fig. S2</xref>). Computing pairwise ANI values for the entire database took 77K CPU hours for all 8.01 billion comparisons. To our knowledge, this is the largest cohort of genomes for which ANI has been computed. The largest previously published ANI analysis included 86 million comparisons and took 190K CPU hours (<xref ref-type="bibr" rid="c20">20</xref>).</p>
<p>Among the total of 8.01 billion pairwise comparisons, 679,765,100 yielded ANI values in the 76-100&#x0025; range. The distribution of these ANI values reveals a clear and wide discontinuity in the identity range of 83-95&#x0025; (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). FastANI reported only 17,132,536 ANI values (i.e., 2.5&#x0025; of the 679,765,100 pairs) within the range of 83&#x0025; to 95&#x0025;. The genetic discontinuity was apparent even when all named species were randomly drawn with species-dependent probabilities that ensured the same expected representation of highly sampled and sparsely sampled species in the final set (data not shown).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 4.</label>
<caption><p><bold>a.</bold> Histogram plot showing the distribution of ANI values among the 90K genomes. Only ANI values in the 76-100&#x0025; range are shown. Out of total 8.01 billion pairwise genome comparisons, FastANI reported only 17M ANI values (0.21&#x0025;) with ANI between 83&#x0025; and 95&#x0025; indicating a wide genetic discontinuum. Multiple colors are used to show how genomes from different genera are contributing to this distribution. Few peaks in the histogram arise from genera that have been extensively sequenced and dominate the database. <bold>b.</bold> Density curves of ANI values in the ANI range 76-100&#x0025;. Each curve shows the density curve corresponding to the database at a particular time period. Wide discontinuity in all four curves is observed consistently, <bold>c.</bold> Distribution of ANI values with each comparison labeled by the nomenclature of genomes being compared. All the comparisons between <italic>Escherichia coli</italic> and <italic>Shigella</italic> spp. have been labeled separately. The 95&#x0025; ANI threshold on x-axis serves as a valid classifier for comparisons belonging to same and different species.</p></caption>
<graphic xlink:href="225342_fig4.tif"/>
</fig>
<p>The frequency of intra-vs. inter-species genomes sequenced in the NCBI database has changed over time, with earlier sequencing efforts targeting distantly related organisms in order to cover phylogenetic diversity while efforts in more recent years targeted more closely related organisms for microdiversity or epidemiological studies (<xref ref-type="fig" rid="figS3">Supplementary Fig. S3</xref>). We confirmed that discontinuity pattern has been maintained at different time points in the past (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). In previous taxonomic studies, 95&#x0025; ANI cutoff is the most frequently used standard for species demarcation. Density curves in the figure show that the two peaks consistently lie on either side of the 95&#x0025; ANI value.</p>
<p>Finally, we tested the correlation between standing nomenclature and the 95&#x0025; ANI demarcation. As per this standard, we should expect a pair of genomes to have ANI value &#x2265; 95&#x0025; if and only if both genomes are members of same species. From the complete set of 89,499 genomes, we identified the subset for which we could determine the named species for each genome. Whenever available (9&#x0025; of the total genomes), we recovered the links to NCBI taxonomy to determine the species. For the remainder of the genomes, we inferred the species from the organism name given in the GenBank file, excluding all entries with ambiguous terms (sp, cf, aff, bacterium, archeon, endosymbiont), resulting in the species-wise classification of an additional 78&#x0025; of the genomes. The remainder 13&#x0025; of the genomes were discarded.</p>
<p>We evaluated the distribution of ANI values in this subset in comparison to the named species that the corresponding genomes were assigned to (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). The &#x2265; 95&#x0025; ANI criterion reflects same named species with a recall frequency of 98.5&#x0025; and a precision of 93.1&#x0025;. We further explored the values affecting precision, i.e., 6.9&#x0025; of ANI values above 95&#x0025; that were obtained for genomes assigned to different named species. Among those, 5.6&#x0025; are due to comparisons between <italic>Escherichia coli</italic> and <italic>Shigella</italic> spp., a case in which the inconsistency between taxonomy and genomic relatedness is well documented (<xref ref-type="bibr" rid="c1">1</xref>) (highlighted in green in <xref ref-type="fig" rid="fig4">Figure 4c</xref>). The remaining 1.3&#x0025; of the cases mostly exist within the <italic>Mycobacterium</italic> genus (0.5&#x0025;), which includes a group of closely related named species as part of the <italic>M. tuberculosis</italic> complex such as <italic>M. tuberculosis</italic> (reference), <italic>M. canettii</italic> (ANI 97-99&#x0025; against reference), <italic>M. bovis</italic> (ANI 99.6&#x0025;), <italic>M. microti</italic> (ANI 99.8-99.9&#x0025;), and <italic>M. africanum</italic> (ANI 99.9&#x0025;), among others. An additional 0.2&#x0025; of the cases correspond to comparisons between <italic>Neisseria gonorrhoeae</italic> and <italic>N. meningitidis</italic>, two species with large representation in the database and ANI values close to 95&#x0025; (Inter-quartile range: 94.9-95.2&#x0025;). Excluding the cases of <italic>E. coli</italic> vs. <italic>Shigella</italic> alone, precision increases to 98.7&#x0025;. With both recall and precision values &#x2265; 98.5&#x0025;, these results corroborate the utility of ANI for species demarcation, which is consistent with previous studies based on a much smaller dataset of genomes (<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c20">20</xref>).</p>
</sec>
</sec>
<sec id="s2">
<title>Discussion</title>
<p>Our results indicate that FastANI robustly estimates ANI values between both complete and draft genomes while reducing the computing time by two to three orders of magnitude. We leveraged the computational efficiency offered by FastANI to evaluate the distribution of ANI values in a set of over 90,000 genomes, and demonstrate that genetic relatedness discontinuity can be consistently identified among these genomes around 95&#x0025; ANI. This discontinuity is recovered with or without the most frequently represented species in the database, is robust to historic additions in the public databases, and it represents an accurate threshold for demarcating almost all currently named prokaryotic species.</p>
<p>Given also the large number of genomes used in our analysis that represented all major prokaryotic lineages, it is likely that the discontinuity represents a real biological signature and is not driven by cultivation or other biases. It is also important to note that these results are consistent with metagenomics analysis of natural microbial communities, which have showed that the communities are composed of predominantly sequence-discrete populations [reviewed in (<xref ref-type="bibr" rid="c21">21</xref>)]. The biological mechanisms underlying this genetic discontinuity are not clear but should be subject of future research for a more complete understanding of prokaryotic species. The mechanisms could involve a dramatic drop in recombination frequency around 90-95&#x0025; ANI, which could account for the discontinuity if bacteria evolve sexually [reviewed in (<xref ref-type="bibr" rid="c22">22</xref>)], or ecological sweeps that remove diversity due to competition [reviewed in (<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c24">24</xref>)]. A genomic nucleotide diversity of 5-10&#x0025; translates to tens of thousands of years of evolution time, which provides ample opportunities for ecological or genetic sweeps to occur. Nonetheless, the existence of genetic discontinuity represents a major finding that can help define species more accurately and has important practical consequences for recognizing and communicating about prokaryotic species.</p>
<p>As a general-purpose research tool, we expect FastANI to be useful for analysis of both clinical and environmental microbial genomes. It can be used for studying the inter- and intra-species diversity within large collections of genomes. It should also accelerate the study of the novelty of new species or phenotypic similarity of a query genome sequence in comparison to all available genomes.</p>
</sec>
<sec id="s3">
<title>Materials and Methods</title>
<p>Before describing FastANI (<xref ref-type="fig" rid="fig5">Figure 5</xref>), we briefly review Mashmap that underlies the FastANI algorithm.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 5.</label>
<caption><p><bold>a.</bold> Graphical illustration of FastANI&#x2019;s work-flow for computing ANI between a query genome and a reference genome. Five mappings are obtained from three query fragments using Mashmap (<xref ref-type="bibr" rid="c15">15</xref>). <italic><bold>M</bold><sub>forward</sub></italic> saves the maximum identity mapping for each query fragment. In this example, <italic><bold>M</bold><sub>forward</sub></italic> &#x003D; &#x007B;<italic>m</italic><sub>2</sub>, <italic>m</italic><sub>4</sub>, <italic>m</italic><sub>5</sub>&#x007D;. this set, <italic>M<sub>reciproca</sub>&#x0131;</italic> picks <italic>m</italic><sub>4</sub> and <italic>m</italic><sub>5</sub> as the maximum identity mapping for each reference bin. Mapping identities of orthologous mappings, thus found in <italic><bold>M</bold><sub>reciprocal</sub></italic>, are finally averaged to compute ANI. <bold>b.</bold> FastANI supports visualization of the orthologous mappings <italic><bold>M</bold><sub>reciprocal</sub></italic> that are used to estimate the ANI value using genoPlotR (<xref ref-type="bibr" rid="c25">25</xref>). In this figure, ANI is computed between <italic>Bartonella quintana</italic> strain (NC&#x005F;018533.1) as query and <italic>Bartonella henselae</italic> strain (NC&#x005F;005956.1) as reference. Red line segments denote the orthologous mappings computed by FastANI for ANI estimation.</p></caption>
<graphic xlink:href="225342_fig5.tif"/>
</fig>
<sec id="s3a">
<title>The Mashmap Sequence Mapping Algorithm</title>
<p>Given a query sequence, Mashmap (<xref ref-type="bibr" rid="c15">15</xref>) finds all its mapping positions in the reference sequence(s) above a user specified minimum alignment identity cut-off <italic><bold>I</bold></italic><sub>0</sub> with high probability. Mashmap avoids direct alignments, but instead relates alignment identity (<italic><bold>I</bold></italic>) between sequences <italic><bold>A</bold></italic> and <italic><bold>B</bold></italic> to Jaccard similarity of constituent k-mers (<italic><bold>J</bold></italic>) under the Poisson distribution model:
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="225342_eqn1.gif"/></alternatives>
</disp-formula>
where <italic>k</italic> is the <italic><bold>k</bold></italic>-mer size (<xref ref-type="bibr" rid="c16">16</xref>).</p>
<p>To estimate the Jaccard similarity itself, Mashmap uses a winnowed-MinHash estimator (<xref ref-type="bibr" rid="c15">15</xref>). This estimator requires only a small sample of k-mers from the query and reference sequences to be examined [see (<xref ref-type="bibr" rid="c15">15</xref>) for further details of Mashmap].</p>
</sec>
<sec id="s3b">
<title>FastANI Extends Mashmap to Compute ANI</title>
<p>Previously established and widely used implementations of ANI begin by either identifying the protein coding genomic fragments (<xref ref-type="bibr" rid="c8">8</xref>) or extracting approximately 1 Kbp long overlapping fragments from the query genome (<xref ref-type="bibr" rid="c3">3</xref>). These fragments are then mapped to the reference genome using BLASTn (<xref ref-type="bibr" rid="c7">7</xref>) or MUMmer (<xref ref-type="bibr" rid="c26">26</xref>), and the best match for each fragment is saved. This is followed by a reverse search, i.e., swapping the reference and query genomes. Mean identity of the reciprocal best matches computed through forward and reverse searches yields the ANI value. Rationale for this bi-directional approach is to bound the ANI computation to orthologous genes and discard the paralogs. In designing FastANI, we followed a similar approach while avoiding the alignment step.</p>
<p>FastANI first fragments the given query genome (<italic><bold>A</bold></italic>) into non-overlapping fragments of size <italic><bold>l</bold></italic>. These <italic><bold>l</bold></italic>-sized fragments are then mapped to the reference genome (<italic><bold>B</bold></italic>) using Mashmap. Mashmap first indexes the reference genome and subsequently computes mappings as well as alignment identity estimates for each query fragment, one at a time. At the end of the Mashmap run, all the query fragments <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="225342_inline1.gif"/></alternatives></inline-formula> are mapped to <italic><bold>B</bold></italic>. The results are saved in a set <italic><bold>M</bold></italic> containing triplets of the form &#x2329;<italic><bold>f</bold></italic>, <italic><bold>i</bold></italic>, <italic><bold>p</bold></italic>&#x236A;, where <italic><bold>f</bold></italic> is the fragment id, <italic><bold>i</bold></italic> is the identity estimate, and <italic>p</italic> is the starting position where <italic><bold>f</bold></italic> is mapped to <bold>B</bold>. The subset of <italic><bold>M</bold></italic> (say <italic><bold>M<sub>forward</sub></bold></italic>) corresponding to the maximum identity mapping for each query fragment is then extracted. To further identify the reciprocal matches, each triplet &#x2329;<italic><bold>f</bold></italic>, <italic><bold>i</bold></italic>, <italic><bold>p</bold></italic>&#x232A; in <italic><bold>M<sub>forward</sub></bold></italic> is &#x2018;binned&#x2019; based on its mapping position in the reference, with its value updated to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="225342_inline2.gif"/></alternatives></inline-formula>. Through this step, fragments which are mapped to the same or nearby positions on the reference genome are likely to get equal bin value. Next, <italic><bold>M<sub>reciprocal</sub></bold></italic> filters the maximum identity mapping for each bin. Finally, FastANI reports the mean identity of all the triplets in <italic><bold>M<sub>reciprocal</sub></bold></italic> (See <xref ref-type="fig" rid="fig5">Figure 5</xref> for an example and visualization).</p>
<p>We define <italic><bold>&#x03C4;</bold></italic> as an input parameter to FastANI to indicate a minimum count of reciprocal mappings for the resulting ANI value to be trusted. It is important to appropriately choose the parameters (<italic><bold>l</bold></italic>, <italic><bold>&#x03C4;</bold></italic> and <italic><bold>I</bold></italic><sub>0</sub>).</p>
</sec>
<sec id="s3c">
<title>FastANI Algorithm Parameter Settings</title>
<p>FastANI is targeted to estimate ANI in the 80&#x0025;-100&#x0025; identity range. Therefore, it calls Mashmap mapping routine with an identity cutoff <italic><bold>I</bold></italic><sub>0</sub> &#x003D; 80&#x0025;, which enables it to compute mappings with alignment identity close to 80&#x0025; or higher.</p>
<p>Choosing an appropriate value of query fragment <italic><bold>l</bold></italic> requires an evaluation of the trade-off between FastANI&#x2019;s computation efficiency and ANI&#x2019;s estimation accuracy. Higher value of <italic><bold>l</bold></italic> implies less number of non-overlapping query fragments, thus reducing the overall runtime. However, if <italic><bold>l</bold></italic> is much longer than the average gene length, a fragment could span more than one conserved segment, especially if the genome is highly recombinant. We empirically evaluated different values of <italic><bold>l</bold></italic> and set it to 3 Kbp (<xref ref-type="table" rid="tblS1">Supplementary Table S1</xref>). Last, we set <italic><bold>&#x03C4;</bold></italic> to 50 to avoid incorrect ANI estimation from just a few matching fragments between genomes that are too divergent (e.g., showing &#x003C;80&#x0025; ANI). With <italic><bold>l</bold></italic> &#x003D; 3 Kbp, <italic><bold>&#x03C4;</bold></italic> &#x003D;50 implies that we require at least 150 Kbp homologous genome sequence between two genomes to make a reliable ANI estimate, which is a reasonable assumption for both complete and incomplete genome assemblies based on our previous study (<xref ref-type="bibr" rid="c27">27</xref>).</p>
</sec>
<sec id="s3d" sec-type="data_availability">
<title>Software and Data Availability</title>
<p>FastANI can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://github.com/ParBUSS/FastANI">https://github.com/ParBUSS/FastANI</ext-link>. All the datasets used in this study are available at <ext-link ext-link-type="uri" xlink:href="http://enve-omics.ce.gatech.edu/data/fastani">http://enve-omics.ce.gatech.edu/data/fastani</ext-link>.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>ACKNOWLEDGMENTS</title>
<p>We thank Jim Cole for discussions regarding the k-mer component of the FastANI algorithm. This work was supported, in part, by US National Science Foundation awards 1356288 (to KTK) and IIS-1416259 (to SA).</p>
</ack>
<ref-list>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Luo</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> (<year>2011</year>) <article-title>Genome sequencing of environmental escherichia coli expands understanding of the ecology and speciation of the model bacterial species</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>(<issue>17</issue>):<fpage>7200</fpage>-<lpage>7205</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Shapiro</surname> <given-names>BJ</given-names></string-name>, <etal>et al.</etal> (<year>2012</year>) <article-title>Population genomics of early events in the ecological differentiation of bacteria</article-title>. <source>science</source> <volume>336</volume>(<issue>6077</issue>):<fpage>48</fpage>-<lpage>51</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Goris</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> (<year>2007</year>) <article-title>DNA-DNA hybridization values and their relationship to whole-genome sequence similarities</article-title>. <source>International journal of systematic and evolutionary microbiology</source> <volume>57</volume>(<issue>1</issue>):<fpage>81</fpage>-<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Tiedje</surname> <given-names>JM</given-names></string-name> (<year>2005</year>) <article-title>Genomic insights that advance the species definition for prokaryotes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>102</volume>(<issue>7</issue>):<fpage>2567</fpage>-<lpage>2572</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Rossell&#x00F3;-Mora</surname> <given-names>R</given-names></string-name> (<year>2005</year>) <article-title>Updating prokaryotic taxonomy</article-title>. <source>Journal of bacteriology</source> <volume>187</volume>(<issue>18</issue>):<fpage>6255</fpage>-<lpage>6257</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Staley</surname> <given-names>J</given-names></string-name> (<year>2009</year>) <article-title>The phylogenomic species concept</article-title>. <source>Microbiology Today</source> <volume>36</volume>:<fpage>80</fpage>-<lpage>83</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Altschul</surname> <given-names>SF</given-names></string-name>, <etal>et al.</etal> (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic acids research</source> <volume>25</volume>(<issue>17</issue>):<fpage>3389</fpage>-<lpage>3402</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Richter</surname> <given-names>M</given-names></string-name>, <string-name><surname>Rossell&#x00F3;-M&#x00F3;ra</surname> <given-names>R</given-names></string-name> (<year>2009</year>) <article-title>Shifting the genomic gold standard for the prokaryotic species definition</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>106</volume>(<issue>45</issue>):<fpage>19126</fpage>-<lpage>19131</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Rodriguez-R</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name> (<year>2016</year>) <article-title>The enveomics collection: a toolbox for specialized analyses of microbial genomes and metagenomes</article-title>. <source>PeerJ Preprints</source> <volume>4</volume>:<fpage>e1900v1</fpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>I</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>YO</given-names></string-name>, <string-name><surname>Park</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Chun</surname> <given-names>J</given-names></string-name> (<year>2016</year>) <article-title>OrthoANI: an improved algorithm and software for calculating average nucleotide identity</article-title>. <source>International Journal of Systematic and Evolutionary Microbiology</source> <volume>66</volume>(<issue>2</issue>):<fpage>1100</fpage>-<lpage>1103</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> (<year>2009</year>) <article-title>A phylogeny-driven genomic encyclopaedia of bacteria and archaea</article-title>. <source>Nature</source> <volume>462</volume>(<issue>7276</issue>):<fpage>1056</fpage>-<lpage>1060</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Broder</surname> <given-names>AZ</given-names></string-name> (<year>1997</year>) <article-title>On the resemblance and containment of documents in Compression and Complexity ofSequences 1997</article-title>. <source>Proceedings. (IEEE)</source>, pp. <fpage>21</fpage>-<lpage>29</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Koren</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> (<year>2017</year>) <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>. <source>Genome research</source> <volume>27</volume>(<issue>5</issue>):<fpage>722</fpage>-<lpage>736</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Berlin</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> (<year>2015</year>) <article-title>Assembling large genomes with single-molecule sequencing and locality-sensitive hashing</article-title>. <source>Naturebiotechnology</source><volume>33</volume>(<issue>6</issue>):<fpage>623</fpage>-<lpage>630</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="book"><string-name><surname>Jain</surname> <given-names>C</given-names></string-name>, <string-name><surname>Dilthey</surname> <given-names>A</given-names></string-name>, <string-name><surname>Koren</surname> <given-names>S</given-names></string-name>, <string-name><surname>Aluru</surname> <given-names>S</given-names></string-name>, <string-name><surname>Phillippy</surname> <given-names>AM</given-names></string-name> (<year>2017</year>) <chapter-title>A fast approximate algorithm for mapping long reads to large reference databases in International Conference on Research</chapter-title> in <source>Computational Molecular Biology</source>. (<publisher-name>Springer</publisher-name>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Ondov</surname> <given-names>BD</given-names></string-name>, <etal>et al.</etal> (<year>2016</year>) <article-title>Mash: fast genome and metagenome distance estimation using minhash</article-title>. <source>Genome Biology</source> <volume>17</volume>(<issue>1</issue>):<fpage>132</fpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="other"><string-name><surname>Olm</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>CT</given-names></string-name>, <string-name><surname>Brooks</surname> <given-names>B</given-names></string-name>, <string-name><surname>Banfield</surname> <given-names>JF</given-names></string-name> (<year>2017</year>) <article-title>dRep: a tool for fast and accurate genomic comparisons that enables improved genome recovery from metagenomes through de-replication</article-title>. <source>The ISME journal</source>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Darling</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Mau</surname> <given-names>B</given-names></string-name>, <string-name><surname>Blattner</surname> <given-names>FR</given-names></string-name>, <string-name><surname>Perna</surname> <given-names>NT</given-names></string-name> (<year>2004</year>) <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>. <source>Genome research</source> <volume>14</volume>(<issue>7</issue>):<fpage>1394</fpage>-<lpage>1403</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Ivanova</surname> <given-names>N</given-names></string-name>, <string-name><surname>Sorokin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Anderson</surname> <given-names>I</given-names></string-name>, <string-name><surname>Galleron</surname> <given-names>N</given-names></string-name>,, <etal>et al.</etal> (<year>2003</year>) <article-title>Genome sequence of bacillus cereus and comparative analysis with bacillus anthracis</article-title>. <source>Nature</source> <volume>423</volume>(<issue>6935</issue>):<fpage>87</fpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Varghese</surname> <given-names>NJ</given-names></string-name>, <etal>et al.</etal> (<year>2015</year>) <article-title>Microbial species delineation using whole genome sequences</article-title>. <source>Nucleic acids research</source> <volume>43</volume>(<issue>14</issue>):<fpage>6761</fpage>-<lpage>6771</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Caro-Quintero</surname> <given-names>A</given-names></string-name>, <string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name> (<year>2012</year>) <article-title>Bacterial species may exist, metagenomics reveal</article-title>. <source>Environmental microbiology</source> <volume>14</volume>(<issue>2</issue>):<fpage>347</fpage>-<lpage>355</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Polz</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Spratt</surname> <given-names>BG</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name> (<year>2009</year>) <article-title>The bacterial species challenge: making sense of genetic and ecological diversity</article-title>. <source>science</source> <volume>323</volume>(<issue>5915</issue>):<fpage>741</fpage>-<lpage>746</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name> (<year>2001</year>) <article-title>Bacterial species and speciation</article-title>. <source>Systematicbiology</source><volume>50</volume>(<issue>4</issue>):<fpage>513</fpage>-<lpage>524</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Ramette</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tiedje</surname> <given-names>JM</given-names></string-name> (<year>2006</year>) <article-title>The bacterial species definition in the genomic era</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>361</volume>(<issue>1475</issue>):<fpage>1929</fpage>-<lpage>1940</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Guy</surname> <given-names>L</given-names></string-name>, <string-name><surname>Roat Kultima</surname> <given-names>J</given-names></string-name>, <string-name><surname>Andersson</surname> <given-names>SG</given-names></string-name> (<year>2010</year>) <article-title>genoPlotR: comparative gene and genome visualization in r</article-title>. <source>Bioinformatics</source> <volume>26</volume>(<issue>18</issue>):<fpage>2334</fpage>-<lpage>2335</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Kurtz</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> (<year>2004</year>) <article-title>Versatile and open software for comparing large genomes</article-title>. <source>Genome biology</source> <volume>5</volume>(<issue>2</issue>):<fpage>R12</fpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Ramette</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tiedje</surname> <given-names>JM</given-names></string-name> (<year>2006</year>) <article-title>Toward a more robust assessment of intraspecies diversity, using fewer genetic markers</article-title>. <source>Applied and environmental microbiology</source> <volume>72</volume>(<issue>11</issue>):<fpage>7286</fpage>-<lpage>7293</lpage>.</mixed-citation></ref>
</ref-list>
<sec id="s4" sec-type="supplementary-material">
<title>Supplementary material</title>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1:</label>
<caption><p>Evaluation of FastANI accuracy and performance while varying the fragment length <italic>I</italic> used in the algorithm. We measure Pearson correlation coefficients of FastANI estimate with BLAST-based ANI computation (ANI<sub>b</sub>) as well as runtime and memory usage for each value of fragment size (1 Kbp &#x2013; 10 Kbp). This experiment was conducted using datasets D3 and D4. From the table, it is evident that increasing fragment size improves runtime and memory usage, but negatively affects accuracy. Based on these tradeoffs, we set the fragment size to 3 Kbp in the FastANI implementation.</p></caption>
<graphic xlink:href="225342_tblS1.tif"/>
</table-wrap>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure">
<label>Figure S1.</label>
<caption><p>Top two plots show the mauve alignments of the two outlier <italic>B. anthracis</italic> strains (2002734165 and Ba&#x005F;A2012&#x005F;AAAC01000001) against the query strain (2000031001) used in D4 dataset. Bottom two plots show the mauve alignments of two randomly picked <italic>B. anthracis</italic> strains against the query strain. The top two outlier strains show unusually high degree of recombination and gaps than we expect between any two correctly sequenced and assembled <italic>B. anthracis</italic> strains. Same behavior was also observed using visualization support in FastANI software (figures not shown here).</p></caption>
<graphic xlink:href="225342_figS1.tif"/>
</fig>
<fig id="figS2" position="float" orientation="portrait" fig-type="figure">
<label>Figure S2.</label>
<caption><p>FastANI accepts genome pairs &#x003C;reference genome, query genome&#x003E; as input. For most genome pairs, input order causes an insignificant change in the FastANI tool&#x2019;s ANI estimate. We first demonstrate this by showing a smooth-scatter plot of 451M genome pairs. Among them, we observe 4,966 outlier genome pairs (0.001&#x0025; of 451M) that show difference &#x2265; 2. On further investigating these outliers, we conclude that they are caused by contaminated genome assemblies. We analyze top three genomes that contribute to the 4,966 outliers: a) Shigella&#x005F;flexneri draft assembly (part of 1,941 outliers), b) Escherichia coli draft assembly (part of 632 outliers), and c) Salmonella enterica draft assembly (part of 505 outliers). Multiple colored peaks in all the three MyTaxaScan [1] plots highlight significant contamination in these assemblies from other species.</p></caption>
<graphic xlink:href="225342_figS2.tif"/>
<graphic xlink:href="225342_figS2a.tif"/>
<graphic xlink:href="225342_figS2b.tif"/>
</fig>
<fig id="figS3" position="float" orientation="portrait" fig-type="figure">
<label>Figure S3.</label>
<caption><p>Composition of draft prokaryotic assemblies in the NCBI database with time at the genus level is visualized using Krona [2] charts. As expected, genus of high known biological significance started to dominate the database progressively. For each of these cohorts, ANI distribution density curves are shown in <xref ref-type="fig" rid="fig5">Fig. 5b</xref>.</p></caption>
<graphic xlink:href="225342_figS3.tif"/>
<graphic xlink:href="225342_figS3a.tif"/>
</fig>
</sec>
<ref-list>
<title>References</title>
<ref id="c28"><label>1.</label><mixed-citation publication-type="other"><string-name><surname>Rodriguez</surname>-<given-names>R</given-names></string-name> <etal>et al</etal>, in preparation. <source>Microbial Genomes Atlas: Standardizing genomic and metagenomic analyses for Archaea and Bacteria</source>.</mixed-citation></ref>
<ref id="c29"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Ondov</surname> <given-names>BD</given-names></string-name>, <string-name><surname>Bergman</surname> <given-names>NH</given-names></string-name>, and <string-name><surname>Phillippy</surname> <given-names>AM</given-names></string-name>. <string-name><surname>Interactive metagenomic visualization in a Web browser</surname></string-name>. <source>BMC Bioinformatics</source>. <year>2011</year> <month>Sep</month> <day>30</day>; <volume>12</volume>(<issue>1</issue>):<fpage>385</fpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
