<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/183970</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>ASaiM: a Galaxy-based framework to analyze raw shotgun data from microbiota</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9852-1987</contrib-id>
<name>
<surname>Batut</surname>
<given-names>B&#x00E9;r&#x00E9;nice</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0838-8025</contrib-id>
<name>
<surname>Gravouil</surname>
<given-names>K&#x00E9;vin</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Defois</surname>
<given-names>Cl&#x00E9;mence</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3803-468X</contrib-id>
<name>
<surname>Hiltemann</surname>
<given-names>Saskia</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brug&#x00E8;re</surname>
<given-names>Jean-Fran&#x00E7;ois</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Peyretaillade</surname>
<given-names>Eric</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Peyret</surname>
<given-names>Pierre</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, <country>Germany</country></aff>
<aff id="a2"><label>2</label><institution>Universit&#x00E9; Clermont Auvergne, INRA, MEDIS</institution>, F-63000 Clermont-Ferrand, <country>France</country></aff>
<aff id="a3"><label>3</label><institution>Universit&#x00E9; Clermont Auvergne, CNRS, LMGE</institution>, F-63000 Clermont-Ferrand, <country>France</country></aff>
<aff id="a4"><label>4</label><institution>Universit&#x00E9; Clermont Auvergne, CNRS, LIMOS</institution>, F-63000 Clermont-Ferrand, <country>France</country></aff>
<aff id="a5"><label>5</label><institution>Department of Bioinformatics, Erasmus University Medical Center</institution>, Rotterdam, 3015 CE, <country>Netherlands</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Correspondence should be addressed to B.B. (<email>berenice.batut@gmail.com</email>) and P.P. (<email>pierre.peyret@uca.fr</email>)</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>183970</elocation-id>
<history>
<date date-type="received">
<day>02</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>02</day>
<month>9</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>04</day>
<month>9</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="183970.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<sec>
<title>Background</title>
<p>New generation of sequencing platforms coupled to numerous bioinformatics tools has led to rapid technological progress in metagenomics and metatranscriptomics to investigate complex microorganism communities. Nevertheless, a combination of different bioinformatic tools remains necessary to draw conclusions out of microbiota studies. Modular and user-friendly tools would greatly improve such studies.</p></sec>
<sec>
<title>Findings</title>
<p>We therefore developed ASaiM, an Open-Source Galaxy-based framework dedicated to microbiota data analyses. ASaiM provides a curated collection of tools to explore and visualize taxonomic and functional information from raw amplicon, metagenomic or metatranscriptomic sequences. To guide different analyses, several customizable workflows are included. All workflows are supported by tutorials and Galaxy interactive tours to guide the users through the analyses step by step. ASaiM is implemented as Galaxy Docker flavour. It is scalable to many thousand datasets, but also can be used a normal PC. The associated source code is available under Apache 2 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/ASaiM/framework">https://github.com/ASaiM/framework</ext-link> and documentation can be found online (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.io/">http://asaim.readthedocs.io/</ext-link>)</p></sec>
<sec>
<title>Conclusions</title>
<p>Based on the Galaxy framework, ASaiM offers sophisticated analyses to scientists without command-line knowledge. ASaiM provides a powerful framework to easily and quickly explore microbiota data in a reproducible and transparent environment.</p></sec>
</abstract>
<kwd-group kwd-group-type="author">
<title>keywords</title>
<kwd>Metagenomics</kwd>
<kwd>Metabarcoding</kwd>
<kwd>User-friendly</kwd>
<kwd>Galaxy</kwd>
<kwd>Docker</kwd>
<kwd>Microbiota</kwd>
</kwd-group>
<counts>
<page-count count="17"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Findings</title>
<sec id="s1a">
<title>Background</title>
<p>The study of microbiota and microbial communities has been facilitated by the evolution of sequencing techniques and the development of metagenomics and metatranscriptomics. These techniques are giving insight into phylogenetic properties and metabolic components of microbial communities. However, meta&#x2019;omic data exploitation is not trivial due to the large amount of data, high variability, incompleteness of reference databases, difficulty to find, configure, use and combine the dedicated bioinformatics tools, etc. Hence, to extract useful information, a sequenced microbiota sample has to be processed by sophisticated workflows with numerous successive bioinformatics steps [<xref rid="c1" ref-type="bibr">1</xref>]. Each step may require execution of several tools or software programs. For example, to extract taxonomic information with the widely used QIIME [<xref rid="c2" ref-type="bibr">2</xref>] or Mothur [<xref ref-type="bibr" rid="c3">[3]</xref>, at least 10 different tools with at least 4 parameters each are needed. Designed for amplicon data, both QIIME and Mothur can not be directly applied to shotgun metagenomics data. In addition, the tools can be complex to use; they are command-line tools and may require computational resources specially for the metagenomics datasets. In this context, selecting the best tools, configuring them to use the correct parameters and appropriate computational resources and combining them together in an analysis chain is a complex and error-prone process. These issues and the involved complexity are blocking scientist from participating in the analysis of their own data. Furthermore, bioinformatics tools are often manually executed and/or patched together with custom scripts. These practices raise doubts about a science gold standard: reproducibility [<xref rid="c3" ref-type="bibr">3</xref>,<xref rid="c4" ref-type="bibr">4</xref>]. Web services and automated pipelines such as MG-RAST [<xref rid="c5" ref-type="bibr">5</xref>] and EBI metagenomics [<xref rid="c6" ref-type="bibr">6</xref>] offer solutions to the accessibility issue. However, these web services work as a black box and are lacking in transparency, flexibility and even reproducibility as the version and parameters of the tools are not always available. Alternative approaches to improve accessibility, modularity and reproducibility can be found in open-source workflow systems such as Galaxy [<xref rid="c6" ref-type="bibr">6</xref>&#x2013;<xref rid="c8" ref-type="bibr">8</xref>]. Galaxy is a lightweight environment providing a web-based, intuitive and accessible user interface to command-line tools, while automatically managing computation and transparently managing data provenance and workflow scheduling [<xref rid="c6" ref-type="bibr">6</xref>&#x2013;<xref rid="c8" ref-type="bibr">8</xref>]. More than 4,500 tools can be used inside Galaxy environments. The tools can be selected and combined to build Galaxy flavors focusing on specific type of analysis, <italic>e.g.</italic> the Galaxy RNA workbench [<xref rid="c9" ref-type="bibr">9</xref>].</p>
<p>In this context, we developed ASaiM (Auvergne Sequence analysis of intestinal Microbiota), an Open-Source opinionated Galaxy-based framework. It integrates tools and workflows dedicated to microbiota analyses with an extensive documentation (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.org">http://asaim.readthedocs.org</ext-link>) and training support.</p></sec>
<sec id="s1b">
<title>Goals of ASaiM</title>
<p>ASaiM is developed as a modular, accessible, redistributable, sharable and user-friendly framework for scientists working with microbiota data. This framework is unique in combining curated tools and workflows and providing easy access for scientists.</p>
<p>ASaiM is based on four pillars: 1) easy and stable dissemination via Galaxy, Docker and conda, 2) a comprehensive set of metagenomics related tools, 3) a set of predefined and tested workflows, and 4) extensive documentation and training to help scientists in their analyses.</p></sec>
<sec id="s1c">
<title>A framework built on the shoulders of giants</title>
<p>The ASaiM framework is built on existing tools and infrastructures and combine all their forces to build an easily accessible and reproducible analysis platform.</p>
<p>ASaiM is implemented as portable virtualized container based on Galaxy framework [<xref rid="c8" ref-type="bibr">8</xref>]. Galaxy provides researchers with means to reproduce their own workflows analyses, rerun entire pipelines, or publish and share them with others. Based on Galaxy, ASaiM is scalable from single CPU installations to large multi-node high performance computing environments. Deployments can be archived by using a pre-built ASaiM Docker image, which is based on the Galaxy Docker project (<ext-link ext-link-type="uri" xlink:href="http://bgruening.github.io/docker-galaxy-stable">http://bgruening.github.io/docker-galaxy-stable</ext-link>) or by installing all needed components into an already existing Galaxy instance. This ASaiM Docker instance is customized with a variety of selected tools, workflows, Interactive tours and data that have been added as additional layers on top of the generic Galaxy Docker instance. The containerization keeps the deployment task to a minimum. The selected Galaxy tools are automatically installed from the Galaxy ToolShed [<xref rid="c10" ref-type="bibr">10</xref>] (<ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/">https://toolshed.g2.bx.psu.edu/</ext-link>) using the Galaxy API BioBlend [<xref rid="c11" ref-type="bibr">11</xref>] and the installation of the tools and their dependencies are automatically resolved using packages available through Bioconda (<ext-link ext-link-type="uri" xlink:href="https://bioconda.github.io">https://bioconda.github.io</ext-link>). We migrated then 10 tools/suites of tools and their dependencies to Bioconda (<italic>e.g.</italic> HUMAnN2) and integrated 14 suites into Galaxy (<italic>e.g.</italic>QIIME with around forty tools).</p>
<p>The containerization as well as the packaging with conda enables automatic continuous integration tests at different levels: dependencies (BioConda), tool integration in Galaxy, Galaxy itself and at ASaiM level. Together with strict version management on all levels, this contributes to a high degree of error-control and reproducibility.</p></sec>
<sec id="s1d">
<title>Tools for microbiota data analyses</title>
<p>The tools integrated in ASaiM can be seen in <xref ref-type="table" rid="tbl1">Table 1</xref>. They are expertly selected for their relevance with regard to microbiota studies, such as Mothur [<xref rid="c3" ref-type="bibr">3</xref>], QIIME [<xref rid="c2" ref-type="bibr">2</xref>], MetaPhlAn2 [<xref rid="c12" ref-type="bibr">12</xref>], HUMAnN2 [<xref rid="c13" ref-type="bibr">13</xref>] or tools used in existing pipelines such as EBI Metagenomics&#x2019; one. We also added general tools used in sequence analysis such as quality control, mapping or similarity search tools.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Available tools in ASaiM</p></caption>
<graphic xlink:href="183970_tbl1.tif"/>
</table-wrap>
<p>This table presents the tools, organized in section and subsections to help users. A more detailed table of the available tools and some documentation can be found in the online documentation (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.org/">http://asaim.readthedocs.org/</ext-link>)</p>
<p>An effort in development was made to integrate these tools into Conda and the Galaxy environment, with the help and support of the Galaxy community. We also developed two new tools to search and get data from EBI Metagenomics and ENA databases using the API of the databases (EBISearch and ENASearch) and a tool to group HUMAnN2 outputs into Gene Ontology Slim Terms. Tools inside ASaiM are organized to make them findable and documented (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.org/">http://asaim.readthedocs.org/</ext-link>).</p>
<sec id="s1d1">
<title>Diverse source of data</title>
<p>Any easy way to upload user-data into ASaiM is provided by an web-interface or more sophisticated via FTP or SFTP. Moreover, we added specialised tools that can interact with external databases like NCBI, ENA or EBI Metagenomics to query them and download data into the framework.</p></sec>
<sec id="s1d2">
<title>Visualization of the data</title>
<p>An analysis often ends with summarizing figures that conclude and represent the findings. ASaiM includes standard interactive plotting tools to draw bar charts and scatter plots from all kinds of tabular data. Phinch visualization is also included to interactively visualize and explore any BIOM file, and generate different types of ready-to-publish figures. We also integrated two other tools to explore and represent the community structure from outputs of MetaPhlAn: KRONA (Ondov et al. 2011)and GraPhlAn. Moreover, as in any Galaxy instance, other visualization are included such Phyloviz for phylogenetic trees or the Genome browser Trackster for visualizing SAM/BAM, BED, GFF/GTF, WIG, bigWig, bigBed, bedGraph, and VCF datasets.</p></sec></sec>
<sec id="s1e">
<title>Workflows</title>
<p>Each tool can be used separately in an explorative manner or multiple tools can be orchestrated inside workflows passing raw data to the data reduction step, to information extraction and visualization. To assist in microbiota analyses, several default but customizable workflows are proposed in ASaiM. All the available workflows with tool and parameter choices are documented (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.org/">http://asaim.readthedocs.org/</ext-link>).</p>
<sec id="s1e1">
<title>Analysis of raw metagenomic or metatranscriptomic shotgun data</title>
<p>A workflow quickly produces, from raw metagenomic or metatranscriptomic shotgun data, accurate and precise taxonomic assignations, wide extended functional results and taxonomically related metabolism information (<xref ref-type="fig" rid="fig1">Figure 1</xref>). This workflow consists of i) processing with quality control/trimming (FastQC and Trim Galore!) and dereplication (VSearch [<xref rid="c14" ref-type="bibr">14</xref>]; ii) taxonomic analyses with assignation (MetaPhlAn2 [<xref rid="c12" ref-type="bibr">12</xref>]) and visualization (KRONA, GraPhlAn); iii) functional analyses with metabolic assignation and pathway reconstruction (HUMAnN2 [<xref rid="c13" ref-type="bibr">13</xref>]); iv) functional and taxonomic combination with developed tools combining HUMAnN2 and MetaPhlAn2 outputs.</p>
<p>This workflow has been tested on two mock metagenomic datasets with controlled communities (Supplementary material). We have compared the extracted taxonomic and functional information to such information extracted with the EBI metagenomics&#x2019; pipeline and to the expectations from the mock datasets. With ASaiM, we generate more accurate and precise data for taxonomic analyses (<xref ref-type="fig" rid="fig2">Figure 2</xref>): we can access information at the level of the species. More informative data for metabolic description (gene families, gene ontologies, pathways, etc) are also extracted with ASaiM compared to the ones available on EBI metagenomics. With this workflow, we can investigate which taxons are involved in a specific pathway or a gene family (<italic>e.g.</italic> involved species and their relative involvement in different step of fatty acid biosynthesis pathways, <xref ref-type="fig" rid="fig3">Figure 3</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Main ASaiM workflow to analyze raw sequences. This workflow takes as input a dataset of raw shotgun sequences (in FastQ format) from microbiota, preprocess it (yellow boxes), extracts taxonomic (red boxes) and functional (purple boxes) assignations and combines them (green boxes). Image available under CC-BY license (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5371396.v3">https://doi.org/10.6084/m9.figshare.5371396.v3</ext-link>)</p></caption>
<graphic xlink:href="183970_fig1.tif"/>
</fig>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Comparisons of the community structure for SRR072233. This figure compares the community structure between the expectations (mapping of the sequences on the expected genomes), data found on EBI Metagenomics database (extracted with the EBI Metagenomics pipeline) and the results of the main ASaiM workflow (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p></caption>
<graphic xlink:href="183970_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Example of an investigation of the relation between community structure and functions. The involved species and their relative involvement in fatty acid biosynthesis pathways have been extracted with ASaiM workflow (<xref ref-type="fig" rid="fig1">Figure 1</xref>) for SRR072233</p></caption>
<graphic xlink:href="183970_fig3.tif"/>
</fig>
<p>For the tests, ASaiM was deployed on a computer with Debian GNU/Linux System, 8 cores Intel(R) Xeon(R) at 2.40 GHz and 32 Go of RAM. The workflow processed the 1,225,169 and 1,386,198 454 GS FLX Titanium reads of each datasets in 4h44 and 5h22 respectively, with a stable memory usage (Supplementary material). With this workflow, it is then easy and quick to process raw microbiota data and extract diverse useful information.</p></sec>
<sec id="s1e2">
<title>Analysis of amplicon data</title>
<p>To analyze amplicon data, the Mothur and QIIME tool suites are available to ASaiM. We integrated the workflows described in tutorials of Mothur and QIIME websites, as example of amplicon data analyses as well as support for the training material. These workflows, as any workflows available in ASaiM, can be adapted for a specific analysis or used as subworkflows by the users.</p></sec>
<sec id="s1e3">
<title>Running as in EBI metagenomics</title>
<p>The tools used in the EBI Metagenomics pipeline are also available in ASaiM. We integrate then also a workflow with the same steps as the EBI Metagenomics pipeline. Analyses made in EBI Metagenomics website can be then reproduced locally, without having to wait for availability of EBI Metagenomics or to upload any data on EBI Metagenomics. However the parameters must be defined by the user as we can not find them on EBI Metagenomics documentation.</p></sec></sec>
<sec id="s1f">
<title>Documentation and training</title>
<p>A tool or software is easier to use if it is well documented. Hence extensive documentation helps the users to be familiar with the tool and also prevents mis-usage. For ASaiM, we developed an extensive online documentation (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.io/">http://asaim.readthedocs.io/</ext-link>), mainly to explain how to use it, how to deploy it, which tools are integrated with small documentation about these tools, which workflows are integrated and how to use them.</p>
<p>In addition to this online documentation, Galaxy Interactive Tours are included inside the Galaxy instance. Such tours guide users through an entire analysis in an interactive (step-by-step) way. Some tours, included in every Galaxy instance, explains how to use Galaxy. We also developed such tours dedicated specifically to the ASaiM workflows.</p>
<p>These interactive tours are used to complement tutorials and trainings. Some tutorials about the integrated workflows have been developed to explain step-by-step the workflows with small example datasets. Hosted in the Galaxy Training Network (GTN) GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/galaxyproject/training-material">https://github.com/galaxyproject/training-material</ext-link>), the tutorials are available online at <ext-link ext-link-type="uri" xlink:href="http://training.galaxyproiect.org">http://training.galaxyproiect.org</ext-link>. They have been used during several workshops on metagenomics data analysis with ASaiM as training support. These tutorials are also accessible directly from ASaiM and its documentation for self-training.</p></sec>
<sec id="s1g">
<title>Installation and running ASaiM</title>
<p>Running the containerized ASaiM simply requires to install Docker and to start the ASaiM image with:</p>
<disp-quote>
<p>&#x0024; docker run &#x2012;d &#x2012;p 8080:80 quay.io/bebatut/asaim</p>
</disp-quote>
<p>Thanks to Docker, ASaiM can be installed under every operating systems, even with a graphical tool (Kitematic:<ext-link ext-link-type="uri" xlink:href="https://kitematic.com">https://kitematic.com</ext-link>) on OSX and Windows.</p>
<p>ASaiM is production-ready. It can also be configured to use external accessible computer clusters or cloud environments.</p>
<p>It is also possible and easy to install all or only a subset of tools of the ASaiM framework on existing Galaxy instances. The set of available tools can be easily extended either only a given instance using the Galaxy admin interface or for ASaiM more generally thanks to the simple definition of the installed tools in YAML files available in ASaiM GitHub repository. In the latter case, the Docker image will be automatically rebuilded and the already integrated tools will be updated to keep ASaiM up-to-date. For reproducibility reason, every version of the Docker image is associated to a tag and is conserved.</p></sec>
<sec id="s1h">
<title>Conclusion</title>
<p>ASaiM provides a powerful framework to easily and quickly analyze microbiota data in a reproducible, accessible and transparent way. Built on a Galaxy instance wrapped in a Docker image, ASaiM can be easily deployed with a comprehensive set of tools and their dependencies. These tools are complemented with a set of predefined and tested workflows to address the main microbiota questions (community structure and functions). All these tools and workflows are extensively documented online (<ext-link ext-link-type="uri" xlink:href="http://asaim.readthedocs.io">http://asaim.readthedocs.io</ext-link>) and supported by Galaxy Interactive Tours and tutorials.</p>
<p>With this complete infrastructure, ASaiM offers a good environment for sophisticated microbiota analyses to scientists without computational knowledge, while promoting transparency, sharing and reproducibility.</p></sec></sec>
<sec id="s2">
<title>Methods</title>
<p>For the tests, ASaiM was deployed on a computer with Debian GNU/Linux System, 8 cores Intel(R) Xeon(R) at 2.40 GHz and 32 Go of RAM. The workflow has been run on two mock community samples of Human Microbiome Project (HMP), containing a genomic mixture of 22 known microbial strains. The details of comparison analyses are described in the Supplementary Material.</p></sec>
<sec id="s3">
<title>Availability of supporting source code and requirements</title>
<list list-type="bullet">
<list-item><p>Project name: ASaiM</p></list-item>
<list-item><p>Project home page:<ext-link ext-link-type="uri" xlink:href="https://github.com/ASaiM/framework">https://github.com/ASaiM/framework</ext-link></p></list-item>
<list-item><p>Operating system(s): Platform independent</p></list-item>
<list-item><p>Other requirements: Docker</p></list-item>
<list-item><p>License: Apache 2</p></list-item></list>
<p>All tools described herein are available in the Galaxy Toolshed (<ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu">https://toolshed.g2.bx.psu.edu</ext-link>). The Dockerfile to automatically install deploy ASaiM is provided in the GitHub repository and a pre-built Docker image is available at <ext-link ext-link-type="uri" xlink:href="https://quay.io/repository/bebatut/asaim-framework">https://quay.io/repository/bebatut/asaim-framework</ext-link>.</p></sec>
</body>
<back>
<sec id="s4">
<title>Declarations</title>
<sec sec-type="COI-statement">
<title>Competing interests</title>
<p>The author(s) declare that they have no competing interests.</p>
</sec>
<sec id="s4a">
<title>Funding</title>
<p>The Auvergne Regional Council and the European Regional Development Fund have supported this work.</p>
</sec>
<sec id="s4b">
<title>Authors&#x2019; contributions</title>
<p>BB, KG, CD, SH, JFB, EP, PP contributed equally to the conceptualization, to the methodology and to the writing process. JFP, PP contributed equally to the funding acquisition. BB, KG, SH contributed equally to the software development and BB, KG, CD and JFP to the validation.</p></sec></sec>
<ack>
<title>Acknowledgements</title>
<p>The authors would like to thank EA 4678 CIDAM, UR 454 INRA, M2iSH, LIMOS, CRRI for their involvement in this project, as well as R&#x00E9;jane Beugnot, Thomas Eymard, David Parsons and Bj&#x00F6;rn Gr&#x00FC;ning for their help.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Ladoukakis</surname> <given-names>E</given-names></string-name>, <string-name><surname>Kolisis</surname> <given-names>FN</given-names></string-name>, <string-name><surname>Chatziioannou</surname> <given-names>AA.</given-names></string-name> <article-title>Integrative workflows for metagenomic analysis</article-title>. <source>Front Cell Dev Biol.</source> <year>2014</year>;<volume>2</volume>:<fpage>70</fpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Kuczynski</surname> <given-names>J</given-names></string-name>, <string-name><surname>Stombaugh</surname> <given-names>J</given-names></string-name>, <string-name><surname>Walters</surname> <given-names>WA</given-names></string-name>, <string-name><surname>Gonz&#x00E1;lez</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gregory Caporaso</surname> <given-names>J</given-names></string-name>, <string-name><surname>Knight</surname> <given-names>R.</given-names></string-name> <article-title>Using QIIME to Analyze 16S rRNA Gene Sequences from Microbial Communities</article-title>. <source>Current Protocols in Microbiology</source>. <year>2012</year>. p. <fpage>1E.5.1</fpage>&#x2013;<lpage>1E.5.20</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Schloss</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Westcott</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Ryabin</surname> <given-names>T</given-names></string-name>, <string-name><surname>Hall</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Hartmann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hollister</surname> <given-names>EB</given-names></string-name>, <etal>et al.</etal> <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>. <source>Appl. Environ. Microbiol</source>. <year>2009</year>;<volume>75</volume>:<fpage>7537</fpage>&#x2013;<lpage>41</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Nekrutenko</surname> <given-names>A</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>J.</given-names></string-name> <article-title>Next-generation sequencing data interpretation: enhancing reproducibility and accessibility</article-title>. <source>Nat. Rev. Genet.</source> <year>2012</year>;<volume>13</volume>:<fpage>667</fpage>&#x2013;<lpage>72</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Meyer</surname> <given-names>F</given-names></string-name>, <string-name><surname>Paarmann</surname> <given-names>D</given-names></string-name>, <string-name><surname>D&#x2019;Souza</surname> <given-names>M</given-names></string-name>, <string-name><surname>Olson</surname> <given-names>R</given-names></string-name>, <string-name><surname>Glass</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Kubal</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <article-title>The metagenomics RAST server - a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>:<fpage>386</fpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Hunter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Corbett</surname> <given-names>M</given-names></string-name>, <string-name><surname>Denise</surname> <given-names>H</given-names></string-name>, <string-name><surname>Fraser</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gonzalez-Beltran</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hunter</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <article-title>EBI metagenomics&#x2013;&#x2013;a new resource for the analysis and archiving of metagenomic data</article-title>. <source>Nucleic Acids Res.</source> <year>2014</year>;<volume>42</volume>:<fpage>D600</fpage>-<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Goecks</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nekrutenko</surname> <given-names>A</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Galaxy</surname> <given-names>Team.</given-names></string-name> <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biol.</source> <year>2010</year>;<volume>11</volume>:<fpage>R86</fpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Afgan</surname> <given-names>E</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>D</given-names></string-name>, <string-name><surname>van den</surname> <given-names>Beek M</given-names></string-name>, <string-name><surname>Blankenberg</surname> <given-names>D</given-names></string-name>, <string-name><surname>Bouvier</surname> <given-names>D</given-names></string-name>, <string-name><surname>Cech</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses:2016 update</article-title>. <source>Nucleic Acids Res.</source> <year>2016</year>;<volume>44</volume>:<issue>W3</issue><fpage>10</fpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Gr&#x00FC;ning</surname> <given-names>BA</given-names></string-name>, <string-name><surname>Fallmann</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yusuf</surname> <given-names>D</given-names></string-name>, <string-name><surname>Will</surname> <given-names>S</given-names></string-name>, <string-name><surname>Erxleben</surname> <given-names>A</given-names></string-name>, <string-name><surname>Eggenhofer</surname> <given-names>F</given-names></string-name>, <etal>et al.</etal> <article-title>The RNA workbench: best practices for RNA and high-throughput sequencing bioinformatics in Galaxy</article-title>. <source>Nucleic Acids Res.</source> [Internet]. <year>2017</year>; Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkx409">http://dx.doi.org/10.1093/nar/gkx409</ext-link></mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Blankenberg</surname> <given-names>D</given-names></string-name>, <string-name><surname>Von</surname> <given-names>Kuster G</given-names></string-name>, <string-name><surname>Bouvier</surname> <given-names>E</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>D</given-names></string-name>, <string-name><surname>Afgan</surname> <given-names>E</given-names></string-name>, <string-name><surname>Stoler</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>Dissemination of scientific software with Galaxy ToolShed</article-title>. <source>Genome Biol.</source> <year>2014</year>;<volume>15</volume>:<fpage>403</fpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Sloggett</surname> <given-names>C</given-names></string-name>, <string-name><surname>Goonasekera</surname> <given-names>N</given-names></string-name>, <string-name><surname>Afgan</surname> <given-names>E.</given-names></string-name> <article-title>BioBlend: automating pipeline analyses within Galaxy and CloudMan</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>:<fpage>1685</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Truong</surname> <given-names>DT</given-names></string-name>, <string-name><surname>Franzosa</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Tickle</surname> <given-names>TL</given-names></string-name>, <string-name><surname>Scholz</surname> <given-names>M</given-names></string-name>, <string-name><surname>Weingart</surname> <given-names>G</given-names></string-name>, <string-name><surname>Pasolli</surname> <given-names>E</given-names></string-name>, <etal>et al.</etal> <article-title>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</article-title>. <source>Nat. Methods</source>. <year>2015</year>;<volume>12</volume>:<fpage>902</fpage>&#x2013;<lpage>3</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Abubucker</surname> <given-names>S</given-names></string-name>, <string-name><surname>Segata</surname> <given-names>N</given-names></string-name>, <string-name><surname>Goll</surname> <given-names>J</given-names></string-name>, <string-name><surname>Schubert</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Izard</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cantarel</surname> <given-names>BL</given-names></string-name>, <etal>et al.</etal> <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>. <source>PLoS Comput. Biol.</source> <year>2012</year>;<volume>8</volume>:<fpage>e1002358</fpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Rognes</surname> <given-names>T</given-names></string-name>, <string-name><surname>Flouri</surname> <given-names>T</given-names></string-name>, <string-name><surname>Nichols</surname> <given-names>B</given-names></string-name>, <string-name><surname>Quince</surname> <given-names>C</given-names></string-name>, <string-name><surname>Mah&#x00E9;</surname> <given-names>F.</given-names></string-name> <article-title>VSEARCH: a versatile open source tool for metagenomics</article-title>. <source>PeerJ.</source> <year>2016</year>;<volume>4</volume>:<fpage>e2584</fpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>H.</given-names></string-name> <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>&#x2013;<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>H.</given-names></string-name> <article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname> <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname> <given-names>A</given-names></string-name>, <string-name><surname>Fennell</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ruan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Homer</surname> <given-names>N</given-names></string-name>, <etal>etal.</etal> <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>McDonald</surname> <given-names>D</given-names></string-name>, <string-name><surname>Clemente</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Kuczynski</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rideout</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Stombaugh</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wendel</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> <article-title>The Biological Observation Matrix (BIOM) format or: how I learned to stop worrying and love the ome-ome</article-title>. <source>Gigascience</source>. <year>2012</year>;<volume>1</volume>:<fpage>7</fpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Blankenberg</surname> <given-names>D</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>A</given-names></string-name>, <string-name><surname>Von</surname> <given-names>Kuster G</given-names></string-name>, <string-name><surname>Coraor</surname> <given-names>N</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nekrutenko</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Manipulation of FASTQ data with Galaxy</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>1783</fpage>&#x2013;<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Schmieder</surname> <given-names>R</given-names></string-name>, <string-name><surname>Edwards</surname> <given-names>R.</given-names></string-name> <article-title>Quality control and preprocessing of metagenomic datasets</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>863</fpage>&#x2013;<lpage>4</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Bolger</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Lohse</surname> <given-names>M</given-names></string-name>, <string-name><surname>Usadel</surname> <given-names>B.</given-names></string-name> <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>2114</fpage>&#x2013;<lpage>20</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Fu</surname> <given-names>L</given-names></string-name>, <string-name><surname>Niu</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Li</surname> <given-names>W.</given-names></string-name> <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>:<fpage>3150</fpage>&#x2013;<lpage>2</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Kopylova</surname> <given-names>E</given-names></string-name>, <string-name><surname>No&#x00E9;</surname> <given-names>L</given-names></string-name>, <string-name><surname>Touzet</surname> <given-names>H.</given-names></string-name> <article-title>SortMeRNA: fast and accurate filtering of ribosomal RNAs in metatranscriptomic data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>:<fpage>3211</fpage>&#x2013;<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname> <given-names>R.</given-names></string-name> <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>&#x2013;<lpage>60</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname> <given-names>R.</given-names></string-name> <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>589</fpage>&#x2013;<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Press</surname> <given-names>AR.</given-names></string-name> <article-title>Ultrafast and Memory-Efficient Alignment of Short DNA Sequences to the Human Genome</article-title>. <source>CreateSpace</source>; <year>2015</year>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Camacho</surname> <given-names>C</given-names></string-name>, <string-name><surname>Coulouris</surname> <given-names>G</given-names></string-name>, <string-name><surname>Avagyan</surname> <given-names>V</given-names></string-name>, <string-name><surname>Ma</surname> <given-names>N</given-names></string-name>, <string-name><surname>Papadopoulos</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bealer</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <article-title>BLAST&#x002B;: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>421</fpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Cock</surname> <given-names>PJA</given-names></string-name>, <string-name><surname>Chilton</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Gr&#x00FC;ning</surname> <given-names>B</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Soranzo</surname> <given-names>N.</given-names></string-name> <article-title>NCBI BLAST&#x002B; integrated into Galaxy</article-title>. <source>Gigascience</source>. <year>2015</year>;<volume>4</volume>:<fpage>39</fpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Buchfink</surname> <given-names>B</given-names></string-name>, <string-name><surname>Xie</surname> <given-names>C</given-names></string-name>, <string-name><surname>Huson</surname> <given-names>DH.</given-names></string-name> <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>. <year>2015</year>;<volume>12</volume>:<fpage>59</fpage>&#x2013;<lpage>60</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Wood</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Salzberg</surname> <given-names>SL.</given-names></string-name> <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>:<fpage>R46</fpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Langille</surname> <given-names>MGI</given-names></string-name>, <string-name><surname>Zaneveld</surname> <given-names>J</given-names></string-name>, <string-name><surname>Caporaso</surname> <given-names>JG</given-names></string-name>, <string-name><surname>McDonald</surname> <given-names>D</given-names></string-name>, <string-name><surname>Knights</surname> <given-names>D</given-names></string-name>, <string-name><surname>Reyes</surname> <given-names>JA</given-names></string-name>, <etal>et al.</etal> <article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title>. <source>Nat. Biotechnol</source>. <year>2013</year>;<volume>31</volume>:<fpage>814</fpage>&#x2013;<lpage>21</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>