<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/360917</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Genomics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5360-1254</contrib-id>
<name>
<surname>Lees</surname>
<given-names>John A.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1512-6194</contrib-id>
<name>
<surname>Harris</surname>
<given-names>Simon R.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4397-2224</contrib-id>
<name>
<surname>Tonkin-Hill</surname>
<given-names>Gerry</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7993-3051</contrib-id>
<name>
<surname>Gladstone</surname>
<given-names>Rebecca A.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lo</surname>
<given-names>Stephanie</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7168-8090</contrib-id>
<name>
<surname>Weiser</surname>
<given-names>Jeffrey N.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7752-1942</contrib-id>
<name>
<surname>Corander</surname>
<given-names>Jukka</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bentley</surname>
<given-names>Stephen D.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6303-8768</contrib-id>
<name>
<surname>Croucher</surname>
<given-names>Nicholas J.</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Microbiology, New York University School of Medicine</institution>, 10016, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Parasites and Microbes, Wellcome Sanger Institute</institution>, Hinxton, CB10 1SA, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biostatistics, University of Oslo</institution>, 0372 Oslo, <country>Norway</country></aff>
<aff id="a4"><label>4</label><institution>Helsinki Institute of Information Technology, Department of Mathematics and Statistics, University of Helsinki</institution>, 00014 Helsinki, <country>Finland</country></aff>
<aff id="a5"><label>5</label><institution>MRC Centre for Global Infectious Disease Analysis, Department of Infectious Disease Epidemiology, Imperial College London</institution>, London, W2 1PG, <country>UK</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding authors: John A. Lees (<email>john.lees@nyumc.org</email>) and Nicholas J. Croucher (<email>n.croucher@imperial.ac.uk</email>)</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>360917</elocation-id>
<history>
<date date-type="received">
<day>05</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>05</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>06</day>
<month>7</month>
<year>2018</year>
</date>
</history>
<permissions><copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="360917.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>The routine use of genomics for disease surveillance provides the opportunity for high-resolution bacterial epidemiology.</p>
<p>However, current whole-genome clustering and multi-locus typing approaches do not fully exploit core and accessory genomic variation, and cannot both automatically identify, and subsequently expand, clusters of significantly-similar isolates in large datasets and across species.</p>
<p>Here we describe PopPUNK (Population Partitioning Using Nucleotide K-mers; <ext-link ext-link-type="uri" xlink:href="https://poppunk.readthedocs.io/en/latest/">https://poppunk.readthedocs.io/en/latest/</ext-link>), software implementing scalable and expandable annotation- and alignment-free methods for population analysis and clustering.</p>
<p>Variable-length <italic>k</italic>-mer comparisons are used to distinguish isolates&#x2019; divergence in shared sequence and gene content, which we demonstrate to be accurate over multiple orders of magnitude using both simulated data and real datasets from ten taxonomically-widespread species. Connections between closely-related isolates of the same strain are robustly identified, despite variation in the discontinuous pairwise distance distributions that reflects species&#x2019; diverse evolutionary patterns. PopPUNK can process 10<sup>3</sup>-10<sup>4</sup> genomes as single batch, with minimal memory use and runtimes up to 200-fold faster than existing methods. Clusters of strains remain consistent as new batches of genomes are added, which is achieved without needing to re-analyse all genomes de novo.</p>
<p>This facilitates real-time surveillance with stable cluster naming and allows for outbreak detection using hundreds of genomes in minutes. Interactive visualisation and online publication is streamlined through automatic output of results to multiple platforms.</p>
<p>PopPUNK has been designed as a flexible platform that addresses important issues with currently used whole-genome clustering and typing methods, and has potential uses across bacterial genetics and public health research.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>bacterial epidemiology</kwd>
<kwd>population genetics</kwd>
<kwd>clustering</kwd>
<kwd>accessory genome</kwd>
</kwd-group>
<counts>
<page-count count="37"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Determining whether a set of pathogen isolates are significantly more genetically similar than randomly-selected representatives from the circulating population is critical in identifying transmission pairs, localised outbreaks or global patterns of dissemination (<xref ref-type="bibr" rid="c19">Croucher and Didelot 2015</xref>). For phenotypically diverse bacterial pathogens, categorising sets of similar isolates is particularly valuable, as such clusters are often strongly associated with variation in clinically-relevant traits, including host range (<xref ref-type="bibr" rid="c74">Weinert et al. 2015</xref>; <xref ref-type="bibr" rid="c64">Reuter et al. 2014</xref>; <xref ref-type="bibr" rid="c76">Willems et al. 2012</xref>), virulence (<xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>; <xref ref-type="bibr" rid="c64">Reuter et al. 2014</xref>; <xref ref-type="bibr" rid="c74">Weinert et al. 2015</xref>), propensity to cause nosocomial outbreaks (<xref ref-type="bibr" rid="c76">Willems et al. 2012</xref>; <xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>) and antimicrobial resistance profile (<xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>; <xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>). Following the trends in these clusters over time provides critical information on population-level changes following the emergence of new strains (<xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>), or resulting from interventions such as vaccine introduction (<xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>). Therefore the clustering of isolates into strains, and ascertaining the higher-resolution structure within these groupings, is a critical challenge in pathogen population genetics.</p>
<p>The earliest bacterial typing approaches used phenotypic assays, such as antibody binding (serotyping), phage infection (phage typing) or metabolic properties (biotyping) (<xref ref-type="bibr" rid="c7">Barker and Old 1989</xref>). However, these categorisation methods were typically genus- or species-specific, and limited in resolution by the number of detectable outcomes. Later epidemiological studies instead favoured methods that could be generalised across multiple bacteria and which were designed to assay selectively neutral variation across multiple loci, thereby avoiding the risk of being confounded by a single recombination or selective sweeps. These typically employed gel electrophoresis to distinguish between alleles within conspecific genotypes, either based on protein charge (multilocus enzyme electrophoresis, MLEE), tandem repeat length (multilocus variable number tandem repeat analysis, MLVA), or variation in restriction site distributions (pulsed-field gel electrophoresis, PFGE). However, despite the the standardisation of such approaches by PulseNet International (<xref ref-type="bibr" rid="c70">Swaminathan et al. 2001</xref>, <xref ref-type="bibr" rid="c71">2006</xref>), comparison of gels between laboratories remains difficult.</p>
<p>Sequence data has the advantage of being more portable owing to its ease of standardisation and digitisation. Consequently, multilocus sequence typing (MLST) emerged as the gold standard epidemiological typing for bacteria in the late 1990s (<xref ref-type="bibr" rid="c46">Maiden et al.1998</xref>). MLST labels are defined by any set of unique sequences at several short fragments of unlinked housekeeping genes; treating any change regardless of number of polymorphisms as the same provides robust clustering in the presence of recombination (<xref ref-type="bibr" rid="c27">Feil et al. 2004</xref>; <xref ref-type="bibr" rid="c73">Turner et al. 2007</xref>). Continually-updated online MLST databases have facilitated rapid comparisons between global isolate sets collected over decades (<xref ref-type="bibr" rid="c35">Jolley et al. 2017</xref>; <xref ref-type="bibr" rid="c2">Aanensen and Spratt 2005</xref>). Furthermore, as each MLST label is made up from several separate allele labels from each gene in the scheme, minimum-spanning trees can be generated using eBURST (<xref ref-type="bibr" rid="c27">Feil et al. 2004</xref>). This allowed sequence types to be grouped together into clonal complexes. However, the fixed resolution of MLST has two problems: firstly, pathogens such as <italic>Mycobacterium tuberculosis</italic> and <italic>Salmonella enterica</italic> serovar Typhi exhibit so little variation that MLST often struggles to distinguish conspecific isolates (<xref ref-type="bibr" rid="c4">Achtman 2012</xref>). Secondly, at the other extreme, some pathogens recombine sufficiently frequently that the limited resolution of MLST causes infrequent spurious links between unrelated groups of isolates, resulting in &#x2018;straggly&#x2019; clonal complexes encompassing highly divergent bacteria (<xref ref-type="bibr" rid="c73">Turner et al. 2007</xref>; <xref ref-type="bibr" rid="c76">Willems et al. 2012</xref>).</p>
<p>Whole genome sequence data provides an opportunity to greatly improve the precision and resolution of bacterial typing. Core genome MLST (cgMLST) schemes have been designed as an extension to MLST by applying the same approach across the core genome, and have demonstrated their value at scales ranging from genus-wide taxonomy to investigation of nosocomial outbreaks in <italic>Neisseria</italic> spp. (<xref ref-type="bibr" rid="c9">Bratcher et al. 2014</xref>), <italic>Listeria monocytogenes</italic> (<xref ref-type="bibr" rid="c65">Ruppitsch et al. 2015</xref>), <italic>Enterococcus faecium</italic> (<italic><xref ref-type="bibr" rid="c23">De Been et al. 2015</xref></italic>), <italic>Escherichia coli, Pseudomonas aeruginosa, Klebsiella pneumoniae</italic> and <italic>Staphylococcus aureus</italic> (<xref ref-type="bibr" rid="c50">Mellmann et al. 2016</xref>). The advantage of these schemes is the speed and ease of assigning indices to alleles combined with the increased resolution of using larger proportions of the core genome. However, all such analysis are contingent upon, and limited to, the coding sequences identified in the original scheme: in the species-specific schemes listed above, this varied between 41&#x0025; and 84&#x0025; of the genes in a typical genome. This can only be achieved if there has been complete assembly of all these loci in the query genome. Further resolution is lost if these data are treated as a set of allele identifiers, rather than nucleotide sequences, as this obscures the level of similarity between non-identical alleles. Nevertheless, cgMLST is highly sensitive and can uncover deeper relationships between strains. This is a trade-off with specificity, meaning a minimum-spanning tree constructed using sequence types is fully connected, losing the simple and intuitive splitting of the population into clonal complexes (<xref ref-type="bibr" rid="c27">Feil et al. 2004</xref>). Some cgMLST studies have therefore resorted to using complexes from MLST (<xref ref-type="bibr" rid="c47">Maiden and Harrison 2016</xref>; <xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>), with which they are highly consistent.</p>
<p>Subdivision of genetically diverse populations is critical for phylogeny-based analyses, such as phylodynamic studies (<xref ref-type="bibr" rid="c74">Weinert et al. 2015</xref>; <xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>; <xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>; <xref ref-type="bibr" rid="c38">Kremer et al. 2017</xref>) or recombination identification (<xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>; <xref ref-type="bibr" rid="c74">Weinert et al. 2015</xref>). The identification of clusters from genomic data can be performed by partitioning a phylogeny (<xref ref-type="bibr" rid="c62">Prosperi et al. 2011</xref>), but has more typically used complex population structure analysis models: initially STRUCTURE (<xref ref-type="bibr" rid="c61">Pritchard et al. 2000</xref>) or BAPS (<xref ref-type="bibr" rid="c16">Corander et al. 2008</xref>), and more recently hierBAPS (<xref ref-type="bibr" rid="c13">Cheng et al. 2013</xref>). Comparisons between the clusters generated by these algorithms and MLST clonal complexes again found high levels of overlap (<xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>; <xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>; <xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>; <xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>), indicating these groupings correspond to natural bacterial populations. These methods fully exploit the available polymorphic sites extracted from core genome alignments, though these can be computationally challenging to generate for large or diverse population samples. There are two additional difficulties encountered when applying these sophisticated analytical approaches to pathogen surveillance. The first is that the identifiability of clusters depends on their frequency in the population, with rarer strains often either grouped together or treated as admixtures of more common genotypes (<xref ref-type="bibr" rid="c29">Grad et al. 2016</xref>; <xref ref-type="bibr" rid="c75">Willemse et al. 2016</xref>; <xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>), making changes in prevalence difficult to track prospectively. Secondly, these methods have to be rerun from scratch every time the alignment changes, which is further complicated due to their large computational burden, meaning they lack the simple extendability of MLST-type schemes.</p>
<p>Given the issues with core genome-dependent approaches, recent work has sought to improve the resolution of expandable typing schemes by exploiting the variation in accessory loci. Differences in gene content underlie much phenotypic variation between bacteria, and these are correlated with core genome divergence in multiple species (<xref ref-type="bibr" rid="c18">Croucher et al. 2014b</xref>; <xref ref-type="bibr" rid="c80">Zhou et al. 2014</xref>; <xref ref-type="bibr" rid="c33">Holt et al. 2015</xref>; <xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>), motivating the use of this information in epidemiological typing. Hence whole genome MLST (wgMLST) schemes have been developed to incorporate accessory genes, by adding an allele identifier which corresponds to its absence, effectively weighting the acquisition of a single gene the same as individual SNPs (<xref ref-type="bibr" rid="c45">Liu et al. 2016</xref>). However, as variation in mobile elements can import many genes over short timescales (<xref ref-type="bibr" rid="c3">Abudahab et al. 2017</xref>; <xref ref-type="bibr" rid="c22">Croucher et al. 2016</xref>) and potentially be confounding for resolving outbreaks (<xref ref-type="bibr" rid="c79">Zhou et al. 2013</xref>), it can be preferable to keep such variation distinct from that in the core genome. Additionally, unlike the well-defined and conserved loci comprising cgMLST schemes, many wgMLST loci are more difficult to align and define, and can be complicated by the difficulty of resolving orthologous and paralogous genes (<xref ref-type="bibr" rid="c77">Zhang et al. 2015</xref>). Additionally, the extensive gene content variation of many species means a fixed scheme designed only using an initial sample will miss many accessory genes, including any newly-emerged loci that enter the population through horizontal gene transfer (<xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>), the detection of which represents a critical aspect of pathogen surveillance. Alternatively, wgMLST schemes can be continually updated through searching each new isolate for previously-unseen loci, but this necessitates every genome being compared to a continually-expanding set of typically rare loci, accompanied by annotation and extraction of any new genes to add to the scheme, which is both computationally-intensive and algorithmically complicated.</p>
<p>Overall, typing based approaches such as MLST and its extensions suffer either from sub-optimal resolution or problems identifying biologically-meaningful clusters, whereas model-based population structure analysis is not suited to surveillance due to its computational burden and difficulty to extend to new isolates. To solve these methodological difficulties in a single approach, we have developed PopPUNK (Population Partitioning Using Nucleotide <italic>K</italic>-mers). By using efficient MinHash based comparisons between pairs of genome assemblies with <italic>k</italic>-mers (strings of bases of length <italic>k</italic>) of different lengths, we can distinguish divergence in orthologous sequence and variation in gene content. These distances are automatically and rapidly clustered to define strains, which we define here as sets of isolates significantly similar in both their core and accessory genomes relative to the rest of the species, in a frequency-independent manner. We have tested PopPUNK on simulated data and real datasets from ten bacterial species, demonstrating that the software rapidly and accurately estimates genetic distances between isolates. These are used to define clusters within samples more quickly than existing methods. Using network-based approaches, PopPUNKs output can be easily queried and expanded, meaning it is able to fully exploit genomic data in a scalable manner appropriate for real-time surveillance of large, diverse bacterial populations.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>PopPUNK uses variable length <italic>k</italic>-mers to accurately resolve genetic divergence</title>
<p>We proposed the probability that a <italic>k</italic>-mer will match between a pair of sequences, <italic>p</italic><sub>match</sub>, is the product of accessory and core mismatches. Specifically, <italic>p</italic><sub>accessory</sub> the probability it does not represent an accessory locus unique to one member of the pair, and <italic>p</italic><sub>core</sub>, the probability it represents a shared core genome sequence that does not contain any mismatches. To calculate <italic>p</italic><sub>core</sub> and <italic>p</italic><sub>accessoiy</sub>, comparisons were run using the MinHash algorithm (<xref ref-type="bibr" rid="c10">Broder 1997</xref>) as implemented in Mash (<xref ref-type="bibr" rid="c56">Ondov et al. 2016</xref>), which estimates the Jaccard similarity between reduced size <italic>k</italic>-mer &#x2018;sketches&#x2019; of the two sequences. This is run for a selection of <italic>k</italic>-mer lengths between <italic>k</italic><sub>min</sub> and <italic>k</italic><sub>max</sub>, the former being determined by the minimum sequence length needed to avoid frequent false positive matches given the size of the genomes being compared (see Methods), and the latter by limited by memory-efficient MinHash processing (PopPUNK uses 29 by default). By determining the probability of k-mer matching <italic>p</italic><sub>core</sub> over this <italic>k</italic>-mer size range, it is possible to estimate the density of single nucleotide polymorphisms (SNPs) distinguishing the pair across their shared core, defined as &#x03C0; (<xref ref-type="bibr" rid="c54">Nei and Li 1979</xref>). This is because longer <italic>k</italic>-mers are more likely to contain a SNP, as quantified by the probability of a <italic>k</italic>-mer perfectly matching between the pair:
<disp-formula id="ueqn1">
<alternatives>
<graphic xlink:href="360917_ueqn1.gif"/>
</alternatives>
</disp-formula></p>
<p>This approach assumes a random and uniform distribution of SNPs across the core, which is defined as those genomic regions in which nucleotide strings at least <italic>k</italic><sub>min</sub>-long can be matched, representing statistically significant similarity between the pair. Loci in which there are no <italic>k</italic><sub>min</sub>-long matches, resulting from either absence of the sequence in one member of the pair, or high sequence divergence of at least one SNP per <italic>k</italic><sub>min</sub> bases, are classified as belonging to the accessory genome; <italic>k</italic><sub>min</sub> thereby provides an intrinsic statistical distinction between the core and accessory regions in the pairwise comparison. Hence <italic>p</italic><sub>accessory</sub> can be regarded as the Jaccard similarity between a pair in terms of their shared core sequence, allowing the definition of the accessory divergence between sequences, <italic>a</italic>, as the corresponding Jaccard distance:
<disp-formula id="ueqn2">
<alternatives>
<graphic xlink:href="360917_ueqn2.gif"/>
</alternatives>
</disp-formula></p>
<p>Unlike <italic>p</italic><sub>core</sub>, <italic>p</italic><sub>accessory</sub> is independent of <italic>k</italic>, allowing both &#x03C0; and <italic>a</italic> to be jointly estimated from the assumption that <italic>p</italic><sub>match</sub> is the product of <italic>p</italic><sub>match</sub> and <italic>p</italic><sub>accessory</sub> (<xref ref-type="fig" rid="fig1">Fig 1</xref>):
<disp-formula id="ueqn3">
<alternatives>
<graphic xlink:href="360917_ueqn3.gif"/>
</alternatives>
</disp-formula></p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Summary of the PopPUNK algorithm. Step 1: For each pairwise comparison of sequences, the proportion of shared <italic>k</italic>-mers of different lengths is used to calculate a core and accessory distance. We use the fact that differences in gene content cause <italic>k</italic>-mers (examples highlighted in green) to mismatch irrespective of length, and whereas substitutions distinguishing orthologous sequences cause longer <italic>k</italic>-mers to mismatch more frequently than shorter <italic>k</italic>-mers. Step 2: The scatter plot of these core and accessory distances is clustered to identify the set of distances representing &#x2018;within-stain&#x2019; comparisons between closely-related isolates. A network is then constructed from nodes, corresponding to isolates, linked by short genetic distances, corresponding to &#x2018;within-strain&#x2019; comparisons. Connected components of this network define clusters. Step 3: The threshold defining within-strain links is then refined using a network score, <italic>n</italic><sub>s</sub>, in order to generate a sparse but highly clustered network. Step 4: Finally, the network is pruned by taking one sample from each clique. The distances between new query sequences and references are calculated, and &#x2018;within-strain&#x2019; distances used to add new edges. The clusters are then re-evaluated as in step 3, with the nomenclature being kept consistent with the original reference cluster names.</p></caption>
<graphic xlink:href="360917_fig1.tif"/>
</fig>
<p>To test whether this approach was effective in differentiating core and accessory divergences, we performed forward-time simulations of bacterial populations diversifying through base substitutions, large insertions and deletions (indels) and recombination using BacMeta (<xref ref-type="bibr" rid="c68">Sipola et al. 2018</xref>). Those simulations in which sequences diverged only through base substitutions all correctly identified a &#x003C; 5x10<sup>-3</sup>, whereas &#x03C0; increased according to the set substitution rate over multiple orders of magnitude, even in the presence of recombination (<xref ref-type="fig" rid="fig2">Fig 2A</xref> and S1). To test the accuracy with which a can be estimated, the substitution rate was fixed at 5x10<sup>-6</sup> bp<sup>-1</sup> generation<sup>-1</sup>, and indels of a fixed size of 250 bp occured at varying rates relative to base substitutions to emulate changes of gene content. The calculated a co-varied with the indel rate, without substantially affecting the inferred distribution of &#x03C0; (<xref ref-type="fig" rid="fig2">Fig 2B</xref> and S1). With the indel rate was fixed at 0.05, the distributions of both <italic>a</italic> and &#x03C0; converged towards a single mode as the rate of exchange through recombination was increased (<xref ref-type="fig" rid="fig2">Fig 2C</xref>), consistent with changes in the analogous core and accessory genetic distances observed in a study using a different framework to study the effects of sequence exchange (<xref ref-type="bibr" rid="c48">Marttinen et al. 2015</xref>). Hence PopPUNK&#x2019;s use of variable length <italic>k</italic>-mers can resolve variation in the genome content and sequence to generate a pairwise distance distribution that accurately reflects the population-wide distribution of genetic diversity.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Detection of genetic diversity by PopPUNK in simulated populations. Each plot shows the deviation in gene sequence (&#x03C0;) and gene content (<italic>a</italic>) estimated by PopPUNK from a sample of 25 isolates from each of 50 simulations run with the same parameters. (A) Deviation through base substitution only. As the rate of base substitution (base<sup>-1</sup> generation<sup>-1</sup>) was increased over two orders of magnitude, estimates of population-wide &#x03C0; increased accordingly, as shown by the distribution of pairwise core distances in the top row of histograms. The scatterplots beneath show a measurements remained below 5x10<sup>-3</sup>, demonstrating the specificity with which divergence was measured. (B) Deviation through insertions and deletions. To test the estimation of a in a clonally-evolving population, simulations included insertions and deletions of 250 bp segments occurring at a rate defined relative to the fixed substitution rate of 5x10<sup>-6</sup> base<sup>-1</sup> generation<sup>-1</sup>. Estimates of a increased proportionately with this rate, without affecting the observed range of &#x03C0;. (C) Effects of recombination on the distribution of genetic diversity. With the insertion and deletion rate fixed at 0.05 relative to the substitution rate of 5x10<sup>-6</sup> base<sup>-1</sup> generation<sup>-1</sup>, the rate of recombination relative to base substitutions was then varied. This resulted in a concentration of the estimated distances into a single mode, representing the changing population structure as frequent exchange between isolates homogenises the divergence between them in both gene sequence and content.</p></caption>
<graphic xlink:href="360917_fig2.tif"/>
</fig>
<p>To determine the limits of resolution possible using PopPUNK, and therefore whether it could be used for surveillance of monomorphic pathogens or clonally-related outbreaks, distances were calculated between eight artificially-generated variants of a 2.2 Mb <italic>Streptococcus pneumoniae</italic> genome distinguished by three biallelic SNPs (Fig S2). This necessitates the use of a sufficiently large sketch size (10<sup>5</sup>), which determines the coverage of the genome in the <italic>k</italic>-mer representation. But with this increase even sequences distinguished by only a single SNP could be successfully resolved using a MinHash approach. This necessitates slightly longer runtimes, so we allow the user to select a larger sketch size than the default if there is a low level of divergence expected between isolates. Therefore given sufficiently high-quality data, PopPUNK can accurately resolve bacterial sequences at multiple scales of genetic divergence.</p>
</sec>
<sec id="s2b">
<title>PopPUNK identifies divergence between bacterial genomes across multiple species</title>
<p>To test whether PopPUNK could also produce accurate estimates of <italic>a</italic> and &#x03C0; when applied to real high-throughput sequencing data, the software was next applied to recent population genomics studies from ten diverse bacterial species. These were chosen to have varied ecologies, including enteric bacteria (<italic>Escherichia coli</italic> and <italic>Salmonella enterica</italic>), Gram negative respiratory pathogens (<italic>Haemophilus influenzae</italic> and <italic>Neisseria meningitidis</italic>), streptococci (<italic>S. pneumoniae</italic> and <italic>Streptococcus pyogenes</italic>), other Firmicutes pathogens (<italic>Staphylococcus aureus</italic> and <italic>Listeria monocytogenes</italic>), and two species in which limited genetic diversity has previously been detected (<italic>Neisseria gonorrhoeae</italic> and <italic>Mycobacterium tuberculosis</italic>). The pangenome of these datasets were defined using Roary, from which the population-wide core genome was aligned and pairwise distances calculated using the Tamura-Nei (tn93) distance. These pairwise distances use only loci conserved across at least 99&#x0025; of the isolates in each sample, rather than the pairwise definition of the core intrinsic to PopPUNK. The genome content divergence was measured as the Jaccard distance between the presence and absence of accessory coding sequences. In all cases, there was a strong linear correlation across the full range of both <italic>a</italic> and &#x03C0; (<xref ref-type="fig" rid="fig3">Fig 3</xref> and Table S1). For &#x03C0;, the linear relationship was close to the identity line, indicating PopPUNK was accurately estimating the per-base probability of sequence divergence using the default sketch size of 10<sup>4</sup>. The exception was <italic>M. tuberculosis</italic>, for which the range of &#x03C0; was an order of magnitude lower than in other species. Therefore PopPUNK needed to be run with a sketch size of 10<sup>5</sup>; despite this increase, the analysis remained fast and memory efficient (<xref ref-type="table" rid="tbl2">Table 2</xref>), and the estimated &#x03C0; values strongly correlated with the tn93 distances.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Comparison of core and accessory distances from PopPUNK (x-axis) and pan-genome construction with Roary (y-axis). For each species, the core distance was calculated as the Tamura Nei (tn93) distance from the core genome alignment; the accessory distance was calculated as the Hamming distance between accessory gene presence/absence. In each panel, the line of identity (red line) and a linear regression (blue line) are also plotted.</p></caption>
<graphic xlink:href="360917_fig3.tif"/>
</fig>
<p>For <italic>a</italic>, the best fit line was typically parallel to, but below, the line of identity. The difference in intercept is likely to represent an artefact of the default BLAST identity threshold used by Roary for clustering genes (95&#x0025;), which causes divergent alleles of orthologous loci to be split into different genes, and the difficulties of automated annotation of draft genome assemblies, which can contain many contig breaks. In the case of S. <italic>pneumoniae</italic>, in which there is a high divergence between the Roary and PopPUNK analyses, the smaller distances calculated by PopPUNK are very similar to those estimated by an independent annotation and analysis of gene content (Fig S4) using COGtriangles (<xref ref-type="bibr" rid="c18">Croucher et al. 2014b</xref>; <xref ref-type="bibr" rid="c39">Kristensen et al. 2010</xref>). Furthermore, the annotation-independence of PopPUNK means it is not sensitive to variation in the identification of coding sequences that might result from differing assembly quality or inconsistent gene calling.</p>
<p>Manual inspection of genome alignments revealed the discrepancy between the distribution of <italic>a</italic> in <italic>M. tuberculosis</italic>, inferred to reach up to &#x007E;10&#x0025; by Roary but only &#x007E;1.5&#x0025; by PopPUNK (<xref ref-type="fig" rid="fig3">Fig 3</xref>), primarily represents impact of frameshift mutations and the difficulty in consistently assembling and annotating coding sequences within the PE/PPE repeats (<xref ref-type="bibr" rid="c11">Bryant et al. 2013</xref>). PopPUNKs ability to align at least parts of these relatively high diversity loci likely account for the higher density of SNPs it infers in the core genome shared by compared strains (<xref ref-type="bibr" rid="c14">Cohen et al. 2015</xref>; <xref ref-type="bibr" rid="c11">Bryant et al. 2013</xref>). This annotation-independence also means PopPUNK can detect divergence in intergenic regions, increasing its sensitivity to widespread changes in regulatory regions (<xref ref-type="bibr" rid="c57">Oren et al. 2014</xref>). Additionally, PopPUNK was between six- and 200-fold faster than Roary, while using between five- and 45-fold less memory. Therefore PopPUNK is an efficient means of accurately measuring SNP and gene content divergence in species-wide genomic datasets. This can also be performed independently of the downstream clustering steps.</p>
</sec>
<sec id="s2c">
<title>PopPUNK successfully resolves complex bacterial populations into strains</title>
<p>The discontinuous distribution of <italic>a</italic> and &#x03C0; between all pairs of sequences in a population has previously been shown to reflect the division of the population into strains in <italic>S. pneumoniae</italic> (<xref ref-type="bibr" rid="c18">Croucher et al. 2014b</xref>). The distances estimated by PopPUNK successfully replicated this (Fig S3). Such structure within the bacterial population is typically reflected by a separation between the shorter genetic distances, which can be regarded as within-strain comparisons, and the larger between-strain distances, which may form one or more clusters in the plot, depending on the bacterium&#x2019;s evolutionary history (<xref ref-type="fig" rid="fig2">Fig 2</xref>). To test whether this also applied to other bacterial pathogens, the pairwise <italic>a</italic> and &#x03C0; distributions were plotted for the other nine species-wide collections listed in <xref ref-type="table" rid="tbl1">Table 1</xref> (<xref ref-type="fig" rid="fig4">Fig 4</xref> and S5).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Adjusted <italic>R<sup>2</sup></italic> between PopPUNK inferred core and accessory distances, and core and accessory distances inferred from a core genome alignment produced using Roary. We did not run Roary across the entire <italic>Salmonella</italic> genus. We were unable to run R-hierBAPS on the S. <italic>pyogenes</italic> data within a limit of 18 days, as the large number of singleton clusters made computation inefficient. We calculated the Silhouette Index for each sample, using the PopPUNK core and accessory distances and the clustering method indicated in the table header. We show the average Silhouette Index over all samples. The adjusted Rand index representing overlap between PopPUNK clusters and R-hierBAPS clusters is shown, where identical clustering is one and completely different clustering is zero. &#x002A;For <italic>Listeria monocytogenes</italic> the second level R-hierBAPS clusters are analysed, as the first level represents the deep split between lineages.</p></caption>
<graphic xlink:href="360917_tbl1.tif"/>
</table-wrap>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>PopPUNK model fitting output for four archetypal examples (other species shown in Fig S5). Each row is a species, with each plot showing the distribution of core and accessory distances, with points coloured by their predicted cluster. The cluster closest to the origin is the within-strain cluster. The two-dimensional Gaussian mixture model (2D GMM) is in the left column, which also shows ellipses with the mean and covariance of the fitted mixture components. The HDBSCAN plot in the centre column additionally shows unclassified noise points as black. The final column shows the fits when maximising the network score to refine the 2D GMM fit. <italic>Listeria monocytogenes</italic> has clearly separated clusters which are well predicted by all methods. Although there is more complex structure on the plots, <italic>Escherichia coii</italic> and <italic>Neisseria meningitidis</italic> have a within-strain cluster also well captured by all approaches. In <italic>Streptococcus pneumoniae</italic> recombination makes the boundary between clusters less distinct, and the mixture model includes too many links (<xref ref-type="fig" rid="fig5">Fig 5</xref>). HDBSCAN is more accurate, but the refinement of the initial fit provides the most accurate and intuitive demarcation of the within-strain links. <italic>Streptococcus pyogenes</italic> exhibits low within-strain recombination, hence has a dense cluster of points near the origin of the graph, but high between-strain recombination, resulting in the single, broad between-strain set of points. Network score fit refinement is required for an accurate model fit in this case.</p></caption>
<graphic xlink:href="360917_fig4.tif"/>
</fig>
<p>Species known to exchange sequence through homologous recombination at similar frequencies to <italic>S. pneumoniae</italic>, such as <italic>Neisseria meningitidis</italic> (<xref ref-type="fig" rid="fig4">Fig 4</xref>), exhibited a similar distribution of pairwise genetic distances. The group of within-strain pairwise distances, found near the origin of the graph, was elongated, likely as a consequence of extensive diversification of strains through transfer of genomic islands and shuffling of core sequence through homologous recombination. The between-strain distances were primarily concentrated within a single dense modal cluster, consistent with the simulations involving high level of recombination in <xref ref-type="fig" rid="fig2">Fig 2</xref>. In contrast, <italic>Streptococcus pyogenes</italic> strains exhibit little evidence of recent diversification through homologous recombination (<xref ref-type="bibr" rid="c53">Nasser et al. 2014</xref>), hence the within-strain distances were tightly clustered near the origin of the graph (Fig S5). Nevertheless, between-strain distances remained concentrated in a single node, consistent with the much higher level of recombination inferred across broader samples (<xref ref-type="bibr" rid="c24">Didelot and Maiden 2010</xref>), resulting in the star-like internal structure of species-wide <italic>S. pyogenes</italic> phylogenies (<xref ref-type="bibr" rid="c12">Chalker et al. 2017</xref>). A different pattern was evident in other species in which homologous recombination is infrequently observed, such as <italic>Escherichia coli, Salmonella enterica</italic> and <italic>Staphylococcus aureus</italic> (<xref ref-type="fig" rid="fig4">Fig 4</xref> &#x0026; S5). This exhibited much stronger evidence of deep population structure, characterised by multimodal between-strain distance distributions that likely reflect ancestral divergences that have not been overwritten by sequence exchange. The distribution of within-strain distances had high variance in the accessory direction, which is likely to reflect rapid diversification in gene content through movement of mobile genetic elements in the absence of core genome diversification through homologous recombination (<xref ref-type="bibr" rid="c80">Zhou et al. 2014</xref>; <xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>; <xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>). A more extreme version of this pattern was clear in <italic>Listeria monocytogenes</italic> and <italic>Haemophilus influenzae</italic>, which are composed of deep-branching lineages that result in small, tight clusters being formed in the &#x03C0;-<italic>a</italic> distance space. This structure was apparent even using a small total number of samples. Across a range of ecologically and taxonomically distinct species, there are clear groups separated by both larger and smaller divergences appear on the plot, with the smaller divergences representing within-strain comparisons.</p>
<p>In order to identify these clusters, two alternative approaches are implemented within PopPUNK: two-dimensional Gaussian mixture models (2D GMMs), which split the points into a user-specified maximum of <italic>K</italic> two-dimensional Gaussian distributions, or HDBSCAN, which is run iteratively to identify fewer than a user-specified maximum number of clusters <italic>D</italic> (see Methods). The results of the application of both methods to the genomic datasets listed in <xref ref-type="table" rid="tbl1">Table 1</xref> are shown in <xref ref-type="fig" rid="fig4">Fig 4</xref>: in each case, both methods were successfully able to resolve the pairwise distances into discrete clusters. The bacterial population can then be represented as a network in which each node corresponds to an isolate, and each within-strain relationship to an edge between these nodes (<xref ref-type="fig" rid="fig1">Fig 1</xref>). This network has the property that strains can be defined as the separate connected components (<xref ref-type="fig" rid="fig5">Fig 5</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Network and query assignment for <italic>S. pneumoniae</italic>. (A) Cytoscape view of the network for the SPARC dataset using the 2D GMM fit. Nodes (dots) are samples and edges are those pairwise distances classified as &#x2018;within-strain&#x2019;. The nodes are coloured by clusters for the refined fit in panel (B) showing which clusters are incorrectly merged in the mixture model fit. (B) As in (A), but showing the network after fit refinement. High stress edges causing clusters to be merged have been removed after maximising the network score. (C) Boxplots showing the similarities between cluster assignment when running PopPUNK in different modes. The different model types (2D GMM or HDBSCAN) implemented in PopPUNK were each fitted to either the Massachusetts or Maela <italic>S. pneumoniae</italic> population defined in (<xref ref-type="bibr" rid="c15">Corander et al. 2017</xref>), then refined through maximisation of <italic>n</italic><sub>s</sub>. The three non-reference populations were then added in successive batches, either through comparisons to the full dataset or a representative set of reference sequences selected based on network structure, in all possible permutations. Comparisons of clustering similarity were then calculated between all these permutations in which the final population added was the same using the Rand index (<xref ref-type="bibr" rid="c63">Rand 1971</xref>); only those isolates in the most recent extension of the network were used. These values are shown separated according to the starting reference population (Massachusetts or Maela), initial model (2D GMM or HDBSCAN), and comparison method (bar colour; full database or references only).</p></caption>
<graphic xlink:href="360917_fig5.tif"/>
</fig>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>PopPUNK analysis of <italic>Neisseria gonorrhoeae</italic>. (A) Result of optimising the position of the decision boundary on the combined distances (red dashed line), as well as core and accessory only (dashed gray lines). These methods resulted in 132, 114 and 92 clusters respectively. (B) Example of a single core cluster, which is split into separate clusters using either the combined or accessory boundary. Shown is the phylogeny, with tips coloured by combined cluster. (C) Accessory t-SNE, with the clusters in b highlighted, confirming they diverge. (D) Manhattan plot of <italic>k</italic>-mers associated with the subcluster split in panel (B), which show the GGI is responsible for this difference.</p></caption>
<graphic xlink:href="360917_fig6.tif"/>
</fig>
</sec>
<sec id="s2d">
<title>PopPUNK can exploit network properties to refine strain definitions</title>
<p>Neither the 2D GMM or HDBSCAN methods alone could satisfactorily resolve the recombinogenic populations into strains, primarily due to the diffuse nature of the within-strain distribution, which likely reflects the heterogenous rates of diversification observed in different strains (<xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>; <xref ref-type="bibr" rid="c25">Didelot et al. 2013</xref>). For the 2D GMMs, this was manifested as insufficiently specific, elongated within-strain distributions, which incorrectly included between-strain links as edges. For HDBSCAN, the expectation of a background noise in the distribution meant some pairwise distances between closely-related isolates on the fringes of the main density of within-strain points were omitted from the appropriate cluster. Only a few spurious connections can have a dramatic effect on strain definitions, as a single edge can cause large clusters to be merged, as previously observed for MLST clonal complexes (<xref ref-type="bibr" rid="c73">Turner et al. 2007</xref>). Increasing the threshold corresponding to within-strain connections reaches a transition point at which there is a dramatic increase in the density of edges in the network, and a decrease in network transitivity (Fig S6). This represents a small proportion of the many between-strain distances being included as edges, greatly increasing the connectivity of the network, by linking between tightly-knit components with spurious, high-stress edges. However, decreasing the threshold typically reduces the network density while increasing the transitivity of edges (<xref ref-type="fig" rid="fig5">Fig 5A</xref>), owing to the strong non-overlapping community structure of the network, meaning components corresponding to strains are highly internally connected. Therefore a network score statistic <italic>n</italic><sub>s</sub> ranging between zero and one was defined:
<disp-formula id="ueqn4">
<alternatives>
<graphic xlink:href="360917_ueqn4.gif"/>
</alternatives>
</disp-formula></p>
<p>For each dataset, this statistic was first calculated by separating within and between-strain distances. With the 2D GMM this was using a threshold lying on the decision boundary between the within- and between-strain clusters, and with HDBSCAN the point equidistant between the means of the within- and between-strain clusters. The position of this boundary was then optimised to maximise <italic>n</italic><sub>s</sub> (see Methods). This provided an intuitive boundary separating the within-strain distances (<xref ref-type="fig" rid="fig4">Fig 4</xref>), and tended to be consistent whether initialised from either a 2D GMM or HDBSCAN (Fig S3). Inspection of the network before and after this refinement showed that small numbers of spurious edges between high frequency clusters were removed, and low frequency clusters were kept distinct (<xref ref-type="fig" rid="fig5">Fig 5B</xref>). This resulted in a greater number of more robust clusters, and therefore higher clustering specificity.</p>
<p>For the populations listed in <xref ref-type="table" rid="tbl1">Table 1</xref> these strain definitions were evaluated relative to the top level clusters identified from the core genome alignment using R-hierBAPS (<xref ref-type="bibr" rid="c72">Tonkin-Hill et al. 2018</xref>). PopPUNK used 15 to 74-fold less memory and ran between ten and 100-fold faster than R-hierBAPS (<xref ref-type="table" rid="tbl2">Table 2</xref>). The biggest differences in performance were observed in relatively small collections containing extensive core genome divergence (<xref ref-type="fig" rid="fig3">Fig 3</xref>), presumably representing the complexity of fitting a the BAPS model to such data. The number of clusters estimated by each method was similar (<xref ref-type="table" rid="tbl1">Table 1</xref>), with an average adjusted Rand index of 0.852 indicating a high level of overlap. Based on the Silhouette distance calculated from the &#x03C0; and <italic>a</italic> distances, the clustering identified by PopPUNK was of similar, or better, quality than that of BAPS, with the notable exceptions of <italic>N. gonorrhoeae</italic> and <italic>M. tuberculosis</italic>, which lack the assumed strain structure (Fig S4). For instance, in the case of S. <italic>enterica</italic>, the clusters identified agreed perfectly with a recent reappraisal of species and subspecies definitions (<xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>), whereas using BAPS leads to two cases of subspecies being merged, and a cluster with a single member being added to another larger cluster. This analysis shows PopPUNK is able to efficiently and accurately identify strains within a range of species-wide bacterial population genomic datasets.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>Resource and result comparison for each dataset. For all methods we quote the total CPU time used, and maximum memory. Both PopPUNK and R-hierBAPS use multithreading with close to 100&#x0025; efficiency, so total wall-time was lower than these estimates roughly by a factor of the number of cores used.</p></caption>
<graphic xlink:href="360917_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s2e">
<title>PopPUNK rapidly integrates new genomic data into clusters</title>
<p>By first generating a reference database and defining a model by which <italic>a</italic> and &#x03C0; distances can be assigned as being within- or between-strain, PopPUNK allows the network by which strains are defined to be extended. New batches of genomes can then be included without needing to refit the model or recalculate all pairwise distances. This can result in existing strains expanding in number, merging with others, or new strains not previously represented in the database being founded. By automatically rebuilding an updated database, PopPUNK allows iterative expansion through addition of successive batches of genomes. The accuracy of this approach was tested using a dataset of 4,107 draft <italic>S. pneumoniae</italic> genomes resulting from the combination of four different populations, sampled from Massachusetts (USA), Southampton (UK), Nijmegen (Netherlands) and Maela (Thailand) (<xref ref-type="bibr" rid="c15">Corander et al. 2017</xref>). Both the 2D GMM and DBSCAN models were fitted and subsequently refined using network properties using either the Massachusetts or Maela collections as the initial reference set. The three non-reference populations were then added as individual batches in every possible permutation to test the consistency of clusters from different starting points. The final clusterings of the isolates in the last population to be added were compared using the Rand index. This metric varies between zero, indicating completely dissimilar clusterings, and one, indicating identical clusterings (<xref ref-type="bibr" rid="c63">Rand 1971</xref>). When comparing the different orders in which the non-reference populations were added, using the same reference database and refined models, the Rand indices were all above 0.992 (<xref ref-type="fig" rid="fig5">Fig 5</xref>). Hence by expanding the network in this way, PopPUNK can accurately and consistently assign batches of genomes to strains.</p>
<p>Comparisons were also made between queries that were assigned using different initial model fits, to test the sensitivity across the starting parameters of PopPUNK. Whether a different population (Massachusetts or Maela), or a different method (2D GMM or HDBSCAN) was used to initialise the model, there was a slight decrease in the reproducibility of the clustering, although the mean Rand index was still greater than 0.99 (<xref ref-type="fig" rid="fig5">Fig 5</xref>). These were all highly similar to the results obtained when all 4,107 isolates were clustered in a single step, regardless of which spatial clustering approach was used (Fig S8). The clustering observed after successive additions of query sequences to the network of genomes therefore exhibits reassuringly little sensitivity to the original choice of population and model fit.</p>
<p>The addition of batches by calculating the distance to every sample in the original clustering is inefficient, as the tight clusters of isolates within the same strain will each be separated from a given query by similar &#x03C0; and <italic>a</italic> distances, making a high proportion of comparisons redundant. By default, PopPUNK reduces a full database to a set of reference genomes, which includes just one representative from each clique (i.e. a fully-connected component) within the network (<xref ref-type="fig" rid="fig1">Fig 1</xref>). This allows for faster and more efficient analysis of new batches of data, from which new references can be extracted through applying the same search for cliques. To test whether this approach caused any decrease in clustering reproducibility, the four test populations of <italic>S. pneumoniae</italic> were successively integrated to the reference Massachusetts or Maela datasets as before, but this time using cliques to pare the database down to a set of references after each expansion of the network. When the cluster assignments of the genomes in the last population to be added were compared between the reference-based approach and with the previous analyses using the full databases, again a high degree of correspondence was measured by the Rand index (<xref ref-type="fig" rid="fig5">Fig 5</xref>). Although there was a detectable decline in the consistency of strain assignments using these reference-based searches, this decrease was even smaller than the use of different initial model fits. Correspondingly, only a small decrease in similarity to the single-step clustering was measured (Fig S8). The final networks of all four combined populations contained a median of 256.5 references (range: 212-398): this almost 20-fold reduction in the database size resulted in a median 2.6-fold decrease in CPU time required for the addition of the final batch. Using this network-based design, PopPUNK can thereby efficiently and accurately combine multiple batches of genomes through continually updating a database of representative sequences that span the full diversity of the sampled population.</p>
</sec>
<sec id="s2f">
<title>PopPUNK outputs can be used directly for interactive browser-based analysis</title>
<p>To facilitate simultaneous analysis of population structure in conjunction with associated epidemiological data, the outputs of PopPUNK can be directly uploaded to the freely-available online epidemiology platform Microreact (<xref ref-type="bibr" rid="c6">Argim&#x00F3;n et al. 2016</xref>). This is achieved through using the pairwise &#x03C0; matrix to construct a neighbour-joining tree, either natively within PopPUNK using dendropy (<xref ref-type="bibr" rid="c69">Sukumaran and Holder 2010</xref>), or by running RapidNJ (<xref ref-type="bibr" rid="c67">Simonsen et al. 2011</xref>). The pairwise a matrix is used to generate a t-SNE projection using the sklearn package (<xref ref-type="bibr" rid="c60">Pedregosa et al. 2011</xref>), which is displayed using Microreact&#x2019;s network interface developed for PANINI (<xref ref-type="bibr" rid="c3">Abudahab et al. 2017</xref>). Links to examples of such analyses are provided in <xref ref-type="table" rid="tbl2">Table 2</xref>. We have also included options for outputting the results of PopPUNK in formats appropriate for the online visualisation software Phandango (<xref ref-type="bibr" rid="c30">Hadfield et al. 2017</xref>) and GrapeTree, the browser-based viewer used in Enterobase (<xref ref-type="bibr" rid="c78">Zhou et al. 2017</xref>). The underlying network can also be investigated using Cytoscape (<xref ref-type="bibr" rid="c66">Shannon et al. 2003</xref>).</p>
<p>The combined results arising from querying one dataset against another using PopPUNK can also be displayed with these platforms, with the additional isolates highlighted in the output. This can be used for iteratively merging similarly-sized datasets, as illustrated in <xref ref-type="fig" rid="fig5">Fig 5C</xref> (an example of such a merging in <italic>S. pneumoniae</italic>: <ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/SkZ23iPbXV">https://microreact.org/proiect/SkZ23iPbXV</ext-link> This means PopPUNK can be applied as a rapid tool for ruling out potential outbreaks. As an example, we queried 175 S. <italic>pneumoniae</italic> isolates from the multidrug-resistant PMEN14 lineage (<xref ref-type="bibr" rid="c17">Croucher et al. 2014a</xref>) against the diverse Massachusetts species-wide carriage population sample of 616 isolates (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/BkNaKdPb7y">https://microreact.org/proiect/BkNaKdPb7y</ext-link> This identified all the query isolates as belonging to a single strain, and generated a phylogeny in which they were confined to one clade and an accessory projection representing gene content differences, in less than six minutes using sixteen CPUs and less than 200 MB RAM. Repeating this analysis using an optimised reference database of 63 representative sequences, the same process completed in under four minutes (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/Hk-FOoWX">https://microreact.org/proiect/Hk-FOoWX</ext-link>). Hence PopPUNK provides a simple and efficient means to intuitively and interactively analyse complex data using a platform that facilitates online collaboration and publication.</p>
</sec>
<sec id="s2g">
<title>PopPUNK can be used for analysis of low diversity pathogens</title>
<p>In the cases of <italic>N. gonorrhoeae</italic> and <italic>M. tuberculosis</italic>, R-hierBAPS generated substantially better clustering than PopPUNK, as judged by the Silhouette index. This likely represents the absence of true strains in these species, which are homogeneous compared with the other species studied, and therefore do not exhibit the discontinuous but correlated divergence in &#x03C0; and <italic>a</italic> assumed in the clustering stage. In <italic>N. gonorrhoeae</italic>, the accessory genome content consists of a small number of prophage, three plasmids and the 80 kb gonococcal genomic island (GGI), all of which can vary independently of core genome divergence (<xref ref-type="bibr" rid="c51">Morse et al. 1986</xref>; <xref ref-type="bibr" rid="c32">Hamilton et al. 2005</xref>; <xref ref-type="bibr" rid="c8">Bennett et al. 2010</xref>). Using the fit based on the network score, we were able to successfully split the population into 132 clusters. Inspection in Microreact revealed a clade composed of a polyphyletic mixture of clusters 5 and 10. Their close relationship within the core genome tree suggested the difference in clustering reflected divergence in their accessory genome. To identify the specific loci responsible for this split, microbial genome-wide association software (pyseer) was used with these isolates, finding 3,679 <italic>k</italic>-mers distinguishing the clusters 5 and 10 (<xref ref-type="bibr" rid="c44">Lees et al. 2016</xref>, <xref ref-type="bibr" rid="c41">2018a</xref>). The top hits recovered following mapping of these <italic>k</italic>-mers to reference sequences were the GGI and phage sequence, confirmed as being the distinctive loci through manual inspection.</p>
<p>For cases where there is independent core and accessory evolution, such as within a lineage, we therefore also implemented a more suitable model which just uses one of the core or accessory distances, rather than a combined score. All three clusterings can be jointly inspected using the Microreact output (for example <ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/S1KaTKteQ">https://microreact.org/proiect/S1KaTKteQ</ext-link>). In this particular cluster, the core distances no longer separated the isolates with the GGI and prophage, whereas the accessory distances gave a similar clustering to the combined boundary.</p>
<p>Applying the same analysis to <italic>M. tuberculosis</italic> (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/rJ4lfHtZX">https://microreact.org/proiect/rJ4lfHtZX</ext-link>) demonstrated the PopPUNK phylogeny accurately reconstructed the previously-identified lineages in this population (<xref ref-type="bibr" rid="c14">Cohen et al. 2015</xref>). While the top-level R-hierBAPS effectively identified these lineages, the PopPUNK core genome sequence clusters were much more finely grained, resembling the categorisation into spoligotypes, which are informative for more detailed epidemiology. As PopPUNK&#x2019;s clusters can be easily assigned to lineages or R-hierBAPS clusters using the core phylogeny, this ensures the high-resolution links identified using this software can also be used to for analysis at broader levels.</p>
<p>Such detailed epidemiology can also be valuable within more diverse species, such as when analysing of individual strains. As an example of such an hierarchical study of within-strain diversity, a PopPUNK analysis of the S. <italic>pneumoniae</italic> PMEN14 lineage (<xref ref-type="bibr" rid="c17">Croucher et al. 2014a</xref>) was compared to previous accessory genome study using PANINI, which applies t-SNE to the accessory gene presence/absence matrix generated by Roary (<xref ref-type="bibr" rid="c3">Abudahab et al. 2017</xref>) (Fig S9). Due to the lower sequence divergence within a single lineage, PopPUNK was run with sketch sizes of 10<sup>4</sup> (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/H1UsF5CxX">https://microreact.org/proiect/H1UsF5CxX</ext-link>) and 10<sup>5</sup> (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/proiect/H1Av59CIQ">https://microreact.org/proiect/H1Av59CIQ</ext-link>) In both cases, the phylogeny and accessory clusterings were similar, with the t-SNE projection recapitulating the main results from the PANINI analysis: group 5, lacking the Tn<italic>916</italic> antibiotic resistance element, were resolved as being separate from the rest of the population, while groups two and three, both carrying two prophage, were separated from the non-lysogenic group one, despite them being polyphyletic in the core genome tree.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Current typing and model-based clustering methods do not fulfil all the needs of a population analysis tool for bacterial genomic epidemiology. Here we have introduced PopPUNK, a novel suite of algorithms for analysing large species-wide bacterial population genomic datasets overcoming the technical and computational limitations of previous approaches. Our methods are based upon the rapid estimation of pairwise distances between isolates both in terms of divergence between their shared sequences and differences in their gene content. The use of MinHash optimised <italic>k</italic>-mer comparisons, which are independent of annotation and alignment, means these methods are highly efficient in both memory and CPU usage. Compared to construction of a core-genome alignment, our method is up to 200 times faster and produces comparable results. The use of <italic>k</italic>-mer comparisons also fully exploits the information available in the entire genome assembly, without being limited to comparisons with a predefined set of common loci. These distances provide a clear overview of the population structure and the evolutionary mechanisms through which it is shaped, reflecting the degree to which the population is split into deep lineages, the scale of accessory genome variation between isolates, and the inferred effects of recombination on population structure. By altering the MinHash sketch sizes, PopPUNK users can optimise for speed, with default parameters rapidly identifying strains in diverse species, or precision, up to the level of single nucleotide resolution in the pan-genome. The software is also flexible in its application of machine learning techniques to these distributions of distances, making it applicable across a wide variety of population structures and collection sizes. As these spatial-clustering approaches are refined, and new methods become available, PopPUNK&#x2019;s modularity means the repertoire of these techniques used by the software can be further expanded.</p>
<p>For species with discontinuous &#x03C0;-<italic>a</italic> distributions, categorisation of the population into clusters of related isolates is epidemiologically critical both for following longitudinal trends and understanding the distribution of clinically-important traits in cross-sectional samples. Depending on the nature of the pathogen, PopPUNK can divide collections into sequence clusters, using the divergence between shared sequences (<xref ref-type="bibr" rid="c59">Palys et al. 1997</xref>); genomotypes, defined as being similar in the accessory loci they harbour (<xref ref-type="bibr" rid="c26">Doolittle 2002</xref>); or strains, here defined as those isolates similar in both their core genome and gene content. The consistency of PopPUNK&#x2019;s clusters with those identified by BAPS, which in turn match well with those identified by MLST and wgMLST (<xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>), emphasises the likelihood that such clusters represent coherent natural populations. In each mode, PopPUNK applies a stringent threshold that minimises the probability of spurious links, corresponding to edges with high betweenness, which eventually lead to &#x2018;straggly&#x2019; clusters containing distantly-related isolates linked indirectly through intermediates. This is achieved both through careful identification of the within-strain distances, and pruning the resulting networks such that the proportion of transitive relationships is maximised. This approach also avoids the problem of clusters arising from diverse sets of rare genotypes, rather than lineages descended from a recent common ancestor (<xref ref-type="bibr" rid="c29">Grad et al. 2016</xref>; <xref ref-type="bibr" rid="c75">Willemse et al. 2016</xref>; <xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>). PopPUNK instead separates these into multiple small, distinct groupings, emulating one of the most desirable properties of a high quality MLST scheme. Importantly, the stringency of the within-strain threshold also ensures strain definitions are persistent, and therefore robust to the addition of further batches of data, as demonstrated by the analysis of different combinations of four globally distributed <italic>S. pneumoniae</italic> datasets. PopPUNK is therefore ideally suited to addressing the current limitations of <italic>k</italic>-mer-based epidemiological methods which suffer from the absence of an appropriate curated database or a stable strain nomenclature (<xref ref-type="bibr" rid="c52">Nadon et al. 2017</xref>). The outputs can be readily shared using the browser-based Microreact platform, and PopPUNK databases can be downloaded, queried and extended by different users in a non-centralised manner, allowing new batches of data to be continuously integrated in ongoing analyses. The speed of our software makes it capable of handling the thousands of bacterial genomes that will routinely be generated through surveillance of common bacterial infections. This is a consequence of the fast annotation- and alignment-free sequence analysis methods used, and the integration of data into a network structure, which allows the overall population to be represented by a small number of reference sequences. Our software has the potential to underpin global online surveillance databases for bacterial pathogens, which is particularly relevant as public health agencies around the world seek to fully exploit the benefits of genomic epidemiology.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Rapid calculation of core and accessory divergences</title>
<p>PopPUNK uses pairwise comparisons through <italic>k</italic>-mer matching between two sequences (<italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>) at multiple <italic>k</italic> lengths to distinguish divergence in shared sequences, &#x03C0; (<xref ref-type="bibr" rid="c54">Nei and Li 1979</xref>), from divergence in accessory locus content, here defined as a, the Jaccard distance between the sequence content:
<disp-formula id="ueqn5">
<alternatives>
<graphic xlink:href="360917_ueqn5.gif"/>
</alternatives>
</disp-formula></p>
<p>For any given <italic>k</italic>, a MinHash algorithm can efficiently estimate <italic>a</italic>,. However albeit with confounding by divergence due to &#x03C0; that prevents matching between <italic>k</italic>-mers in the core genome common to (<italic>s<sub>1,</sub>s<sub>2</sub></italic>) is confounding. Assuming that such sequence mismatches are distributed evenly throughout the genome, a can be estimated independently of <italic>k</italic> and &#x03C0; by calculating a function for each (<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) pair that relates the proportion of shared <italic>k</italic>-mers <italic>p</italic><sub>match</sub>, &#x03C0;, and <italic>a</italic> over a series of <italic>k</italic>-mer lengths <italic>k</italic>:
<disp-formula id="ueqn6">
<alternatives>
<graphic xlink:href="360917_ueqn6.gif"/>
</alternatives>
</disp-formula></p>
<p>Which we fit as a linear relationship in log space by minimizing the least squares divergence, and constraining a &#x003E; 0; &#x03C0; &#x003E; 0:
<disp-formula id="ueqn7">
<alternatives>
<graphic xlink:href="360917_ueqn7.gif"/>
</alternatives>
</disp-formula></p>
<p>As both distance estimates are symmetrical, only a single comparison is calculated between each (<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) pair, corresponding to the upper triangle of a square distance matrix, or (<italic>n</italic>-1)&#x002A;<italic>n</italic>/2 comparisons. We use Mash (<xref ref-type="bibr" rid="c56">Ondov et al. 2016</xref>) with a default sketch size of 10<sup>4</sup> to efficiently calculate <italic>p</italic><sub>match</sub> for every second <italic>k</italic>-mer size from <italic>k</italic> &#x003D; <italic>k</italic><sub>min</sub> to <italic>k</italic> &#x003D; <italic>k</italic><sub>max</sub> (29, by default). We choose the minimum <italic>k</italic>-mer size <italic>k</italic><sub>min</sub> for longer sequences such that the probability of a random <italic>k</italic>-mer match <italic>p</italic><sub>random</sub> is less than 5&#x0025;:
<disp-formula id="ueqn8">
<alternatives>
<graphic xlink:href="360917_ueqn8.gif"/>
</alternatives>
</disp-formula></p>
<p>Where <italic>L</italic> is the genome length and log(4) enters due to the alphabet size (assuming minimal gaps or unspecified bases). For typical bacterial genomes with <italic>L</italic> between 1-8 Mb, this corresponds to a <italic>k</italic><sub>min</sub> of either 12 or 13.</p>
</sec>
<sec id="s4b">
<title>Automated classification of within-cluster distances</title>
<p>We implemented two models to classify which distance pairs (&#x03C0;, <italic>a</italic>) are within the same cluster, the choice of which depends on the dataset being used. The first fits a two-dimensional Gaussian mixture model (2D GMM) to a random subsample of up to 10<sup>5</sup> distance pairs using variational Bayes inference. We use the default implementation in scikit-learn 0.19 with a Dirichlet Process prior on weights, choosing the best final likelihood from five <italic>k</italic>-means initial starts. The maximum allowed number of mixture components (<italic>K</italic>) can be specified by the user, depending on the plotted distribution of pairwise &#x03C0; and <italic>a</italic> distances; by default, <italic>K</italic> is set to two. We use membership of mixture component closest to the origin (checking that it contains at least one point in the reference database, as the Dirichlet process prior allows mixture component weights to be set &#x2243; 0) to define within-cluster distances. All distance pairs are then classified with the fitted model.</p>
<p>The alternative approach uses HDBSCAN to classify a subsample of 10<sup>5</sup> points using the Boruvka ball tree algorithm (<xref ref-type="bibr" rid="c49">Mclnnes et al. 2017</xref>). This set of points is iteratively analysed with progressive reductions in both the minimum number of samples, which defines the how conservative the clustering is, and the minimum cluster size, which determines the threshold number of points a cluster must contain, until there are fewer than <italic>D</italic> clusters (100, by default), and extent of the points in the cluster closest to the origin (assumed to represent within-strain distances) do not overlap with those in the most numerous cluster (assumed to represent between-strain distances) on either axis.</p>
</sec>
<sec id="s4c">
<title>Use of within-cluster distances to define a reference network and clusters</title>
<p>We use networkx v2.1 (<xref ref-type="bibr" rid="c31">Hagberg et al. 2008</xref>) to construct an undirected graph with unweighted edges to define population clusters. Each sample in the reference database is a node in this graph, and distances classified as within-cluster by the above model are added as edges between the corresponding nodes. Clusters are then simply defined by extracting the connected components of this network, and ordered by the number of isolates they contain, from largest to smallest. Evaluation of the network structure uses a score, <italic>n</italic><sub>s</sub>:
<disp-formula id="ueqn9">
<alternatives>
<graphic xlink:href="360917_ueqn9.gif"/>
</alternatives>
</disp-formula></p>
<p>This score ranges between zero and one, with values close to the upper bound corresponding to a good fit, as every isolate in a cluster should share a within-cluster link to every other member of the cluster. This is achieved in spite of the sparseness enforced by the (1 - density) term, which is necessary to subdivide the overall population (Fig S6). After definition of clusters, we randomly select just one member of each clique in the network (sets of nodes where each member node is mutually connected to every other member node) to use in an updated reference database. This removes redundancy in the distances that need to be calculated for database querying, and speeds the assignment of further batches of data.</p>
</sec>
<sec id="s4d">
<title>Refinement of distance classification using network properties</title>
<p>Both the 2D GMM and HDBSCAN rapidly and robustly identified the main clusters of within-and between-strain distances in &#x03C0;-<italic>a</italic> space, which were typically well-resolved. However, being conservative in assigning points to the within-strain cluster is not intrinsic to these methods, which treat clusters symmetrically. The relatively small numbers of false positive within-strain assignments from the low density of points between clusters strongly impacted upon network structure by linking components, and consequently the strain definitions. Therefore a model refinement mode was developed to precisely delimit the range of &#x03C0;-<italic>a</italic> distances that were treated as within-strain links, in order to maximise <italic>n</italic><sub>s</sub>. If a 2D GMM or HDBSCAN model has already been fitted, then we construct a line between the means of the within- and between-strain clusters, then draw a decision boundary normal to this line (<xref ref-type="fig" rid="fig1">Fig 1</xref>). If neither model fitted satisfactorily, then the mean positions of the within- and between-strain cluster means can be provided manually.</p>
<p>We then allow this triangular boundary, distinguishing within- and between-strain distances, to be moved over a user-set range forward and backward from the starting point. We globally maximise <italic>n</italic><sub>s</sub> first by testing the network score when placing the boundary at 40 equally spaced points over the allowed range. Local maximisation near this global optimum is then performed using Brent&#x2019;s method. We have also made it possible to run this optimisation with a vertical boundary (using core distances, &#x03C0;, only) or a horizontal boundary (using accessory distances, <italic>a</italic>, only) if desired.</p>
</sec>
<sec id="s4e">
<title>Defining the cluster of query sequences using a previous reference database</title>
<p>New sequences can be rapidly assigned to either a pre-existing cluster, or start to form a new cluster, by addition to the reference network. First, distances are calculated between each query and each member of the reference database using the variable <italic>k</italic>-mer method as above. New queries are added as nodes in the network, and those distance pairs classified as within-cluster are added as edges. As before we define clusters as the connected components of this network, while ensuring labelling consistency with the reference fit. By only calculating reference-query distances rather than all distances, we can perform assignment of <italic>M</italic> queries using a reference database with <italic>N</italic> members using <italic>NM</italic> distance calculations rather than (<italic>N&#x002B;M</italic>)<sup>2</sup>. If the database is being updated for further querying, all <italic>M<sup>2</sup></italic> query-query distances are also calculated (for a total of <italic>NM &#x002B; M<sup>2</sup></italic> distances) so that cliques in the network can still be used to extract representatives for each cluster. However, in practise the construction of <italic>M</italic> sketches is the most computationally expensive step, which gives roughly linear query time in both cases.</p>
</sec>
<sec id="s4f">
<title>Output and visualisation</title>
<p>We automatically produce plots to diagnose dataset characteristics, quality of model fit and assignment of distances to clusters using matplotlib v2.1.2 (<xref ref-type="bibr" rid="c34">Hunter 2007</xref>). For the distances selected for model fitting, we plot contours of a kernel density estimate using an Epanechnikov kernel. This can also be used to identify outliers with contamination; we provide a program to remove these isolates from reference databases. Plots are generated for each model type showing details of its fitted parameters, together with cluster assignment of the distances. For 2D GMMs, we also plot equal likelihood contours and the decision boundary for within- and between-cluster assignments (Fig S3).</p>
<p>While a neighbour joining tree constructed using pairwise Jaccard distances directly has been shown to be reasonably accurate, using core genome divergence gives a more accurate tree topology (<xref ref-type="bibr" rid="c42">Lees et al. 2018b</xref>). We therefore use dendropy or RapidNJ to produce a midpoint rooted neighbour joining tree from the core distances (<xref ref-type="bibr" rid="c67">Simonsen et al. 2011</xref>; <xref ref-type="bibr" rid="c69">Sukumaran and Holder 2010</xref>), and t-SNE to perform clustering of accessory distances (<xref ref-type="bibr" rid="c3">Abudahab et al. 2017</xref>). To enable interactive visualisation of these outputs, PopPUNK can write files formatted for Microreact (<xref ref-type="bibr" rid="c6">Argim&#x00F3;n et al. 2016</xref>), Phandango (<xref ref-type="bibr" rid="c30">Hadfield et al. 2017</xref>) and GrapeTree (<xref ref-type="bibr" rid="c78">Zhou et al. 2017</xref>). Each of these can be automatically joined with other user-provided metadata for visualisation. We also produce output for Cytoscape (<xref ref-type="bibr" rid="c66">Shannon et al. 2003</xref>) for inspection and analysis of the network.</p>
</sec>
<sec id="s4g">
<title>Code optimisation for large datasets</title>
<p>We optimised our code such that datasets with up to &#x007E;10<sup>4</sup> samples could be analysed in a single step. Where possible, we used numba v0.36.2 to compile functions (<xref ref-type="bibr" rid="c40">Lam et al. 2015</xref>) and exploited multithreading of Mash sketching and distance calculations. We also multithreaded the regressions to calculate core and accessory distances, using the sharedmem package (v0.3.5) to avoid copying and storing large distance matrices in main memory (<xref ref-type="bibr" rid="c28">Feng et al. 2017</xref>). We infer sequence labels of rows in distance matrices by their order, rather than storing them in memory. For larger datasets, fitting a reference model to a subset of samples, then adding in query sequences iteratively makes analysis tractable.</p>
</sec>
<sec id="s4h">
<title>Comparison with other methods using both simulated and real data</title>
<p>To determine the specificity of PopPUNK in distinguishing sequence divergence from differences in gene content, forward-time simulations were run using BacMeta (<xref ref-type="bibr" rid="c68">Sipola et al. 2018</xref>). A population of 1000 bacteria, each represented by 100 loci each one kilobase long, was simulated for 1000 generations. Insertions and deletions were fixed at a length of 250 bp. Recombinations always exchanged a complete locus, and were independent of sequence divergence between donor and recipient. A sample of 25 genomes were output from the final generation of each simulation, which were analysed using PopPUNK using default settings. Pairwise distance estimates from 50 independent simulations were then combined for plotting.</p>
<p>To compare with other clustering methods, we selected a range of previously published datasets on ten different bacterial species (<xref ref-type="bibr" rid="c1">Aanensen et al. 2016</xref>; <xref ref-type="bibr" rid="c36">Kallonen et al. 2017</xref>; <xref ref-type="bibr" rid="c38">Kremer et al. 2017</xref>; <xref ref-type="bibr" rid="c37">Koelman et al. 2017</xref>; <xref ref-type="bibr" rid="c44">Lees et al. 2016</xref>; <xref ref-type="bibr" rid="c29">Grad et al. 2016</xref>; <xref ref-type="bibr" rid="c43">Lees et al. 2017</xref>; <xref ref-type="bibr" rid="c20">Croucher et al. 2013</xref>, <xref ref-type="bibr" rid="c21">2015</xref>; <xref ref-type="bibr" rid="c5">Alikhan et al. 2018</xref>; <xref ref-type="bibr" rid="c14">Cohen et al. 2015</xref>). For each dataset, as well as PopPUNK, we ran Roary (<xref ref-type="bibr" rid="c58">Page et al. 2015</xref>) to construct a pan-genome, using a BLAST sequence identity cutoff of 95&#x0025;. We calculated core distances using the Tamura Nei (tn93) distances in the core genome alignment. For accessory distance, we used the Jaccard distance between the accessory gene presence/absence vectors. For comparison with another high-performance clustering algorithm, we ran the R version of hierBAPS (<ext-link ext-link-type="uri" xlink:href="https://aithub.com/atonkinhill/rhierbaps">https://aithub.com/atonkinhill/rhierbaps</ext-link>) using between 8-16 cores depending on dataset size. We estimated the maximum cluster size by dataset, using the output from Roary and information from published analyses of these datasets. For qualitative comparison in Microreact, for each species we also generated a maximum-likelihood tree from the core genome alignment SNPs using IQ-TREE v1.6 with a GTR&#x002B;I&#x002B;G&#x002B;ASC model (<xref ref-type="bibr" rid="c55">Nguyen et al. 2015</xref>).</p>
<p>For species with a monomorphic population structure there is not necessarily a clear correlation between <italic>a</italic> and &#x03C0;. In this case it is logical to define independent sets of clusters using the two distances separately. An example of this is <italic>Neisseria gonorrhoeae</italic>, which we describe fully in the Results. We used a subset of isolates, all of which were in the same cluster based on &#x03C0; but contained two different clusters based on a. We performed a genome-wide association study to determine the specific genes responsible for the two different <italic>a</italic>-based clusters using pyseer v1.1.0 to associate <italic>k</italic>-mers counted from the entire &#x03C0;-based cluster, and using the <italic>a</italic>-based cluster as the phenotype. Default settings were used, with the kinship matrix generated using the maximum-likelihood tree under a mixed effect association model (<xref ref-type="bibr" rid="c41">Lees et al. 2018a</xref>). We mapped the significant <italic>k</italic>-mers to two reference genomes, which between them contain all known accessory elements for <italic>N. gonorrhoeae</italic>.</p>
</sec>
<sec id="s4i">
<title>Data access</title>
<p>Code is available on github <ext-link ext-link-type="uri" xlink:href="https://aithub.com/iohnlees/PopPUNK">https://aithub.com/iohnlees/PopPUNK</ext-link> (Apache 2.0 license) and through the python package index (PyPI). Documentation can be found on readthedocs <ext-link ext-link-type="uri" xlink:href="http://poppunk.readthedocs.io/">http://poppunk.readthedocs.io/</ext-link>. Online and interactive Microreact instances produced for each data set are listed in table S1. PopPUNK databases with the best model fits for each species can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://doi.ora/10.6084/m9.fiashare.6683624">https://doi.ora/10.6084/m9.fiashare.6683624</ext-link>.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank Nabil-Fareed Alikhan for helpful discussions about the <italic>Salmonella enterica</italic> dataset, and Leon Bentley for early experiments with changing mash <italic>k</italic>-mer and sketch sizes.</p>
</ack>
<sec id="s5">
<title>Funding</title>
<p>JL and JNW are supported by grants from the United States Public Health Service (AI038446 and AI105168). SRH, GTH and SDB are supported by Wellcome grant 098051. SL and RAG are supported by the Bill and Melinda Gates Foundation. JC was supported by the ERC grant no. 742158. NJC was supported by a Sir Henry Dale Fellowship, jointly funded by Wellcome and the Royal Society (grant number 104169/Z/14/Z).</p>
</sec>
<sec>
<p>Author contributions</p>
<p>Conceptualization: JAL, NJC. Data curation: JAL, SRH, RAG, SL, NJC. Formal analysis: JAL, NJC. Funding acquisition: JNW, SDB, NJC. Investigation: JAL, NJC. Methodology: JAL, NJC. Software: JAL, GTH, JC, NJC. Supervision: JNW, JC, SDB, NJC. Validation: SRH. Visualization: JAL, NJC. Writing &#x00B7; original draft: JAL, NJC. Writing &#x00B7; review &#x0026; editing: All authors.</p>
</sec>
<sec id="s6">
<title>Disclosure declaration</title>
<p>The authors declare no conflicts of interest.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Feil</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MTG</given-names></string-name>, <string-name><surname>Dordel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yeats</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Fedosejev</surname> <given-names>A</given-names></string-name>, <string-name><surname>Goater</surname> <given-names>R</given-names></string-name>, <string-name><surname>Castillo-Ram&#x00ED;rez</surname> <given-names>S</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Colijn</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <year>2016</year>. <article-title>Whole-Genome Sequencing for Routine Pathogen Surveillance in Public Health: a Population Snapshot of Invasive Staphylococcus aureus in Europe</article-title>. <source>MBio</source> <volume>7</volume>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/mBio.00444-16">http://dx.doi.org/10.1128/mBio.00444-16</ext-link>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Spratt</surname> <given-names>BG</given-names></string-name>. <year>2005</year>. <article-title>The multilocus sequence typing network: mlst.net</article-title>. <source>Nucleic Acids Res</source> <volume>33</volume>: <fpage>W728</fpage>&#x2013;<lpage>33</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Abudahab</surname> <given-names>K</given-names></string-name>, <string-name><surname>Prada</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>. <year>2017</year>. <article-title>PANINI: Pangenome Neighbor Identification for Bacterial Populations</article-title>. <source>bioRxiv</source> <fpage>174409</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.biorxiv.org/content/early/2017/08/21/174409">http://www.biorxiv.org/content/early/2017/08/21/174409</ext-link> (<date-in-citation>Accessed August 21, 2017</date-in-citation>).</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Achtman</surname> <given-names>M</given-names></string-name>. <year>2012</year>. <article-title>Insights from genomic comparisons of genetically monomorphic bacterial pathogens</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source> <volume>367</volume>: <fpage>860</fpage>&#x2013;<lpage>867</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Alikhan</surname> <given-names>N-F</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Sergeant</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Achtman</surname> <given-names>M</given-names></string-name>. <year>2018</year>. <article-title>A genomic overview of the population structure of Salmonella</article-title>. <source>PLoS Genet</source> <volume>14</volume>: <fpage>e1007261</fpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Argim&#x00F3;n</surname> <given-names>S</given-names></string-name>, <string-name><surname>Abudahab</surname> <given-names>K</given-names></string-name>, <string-name><surname>Goater</surname> <given-names>RJE</given-names></string-name>, <string-name><surname>Fedosejev</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bhai</surname> <given-names>J</given-names></string-name>, <string-name><surname>Glasner</surname> <given-names>C</given-names></string-name>, <string-name><surname>Feil</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MTG</given-names></string-name>, <string-name><surname>Yeats</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Grundmann</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <year>2016</year>. <article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title>. <source>Microb Genom</source> <volume>2</volume>: <fpage>e000093</fpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Barker</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Old</surname> <given-names>DC</given-names></string-name>. <year>1989</year>. <article-title>The usefulness of biotyping in studying the epidemiology and phylogeny of salmonellae</article-title>. <source>J Med Microbiol</source> <volume>29</volume>: <fpage>81</fpage>&#x2013;<lpage>88</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Bennett</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Vernikos</surname> <given-names>GS</given-names></string-name>, <string-name><surname>Quail</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Cherevach</surname> <given-names>I</given-names></string-name>, <string-name><surname>White</surname> <given-names>B</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>. <year>2010</year>. <article-title>Independent evolution of the core and accessory gene sets in the genus Neisseria: insights gained from the genome of Neisseria lactamica isolate 020-06</article-title>. <source>BMC Genomics</source> <volume>11</volume>: <fpage>652</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Bratcher</surname> <given-names>HB</given-names></string-name>, <string-name><surname>Corton</surname> <given-names>C</given-names></string-name>, <string-name><surname>Jolley</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>. <year>2014</year>. <article-title>A gene-by-gene population genomics platform: de novo assembly, annotation and genealogical analysis of 108 representative Neisseria meningitidis genomes</article-title>. <source>BMC Genomics</source> <volume>15</volume>: <fpage>1138</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="book"><string-name><surname>Broder</surname> <given-names>AZ</given-names></string-name>. <year>1997</year>. <chapter-title>On the resemblance and containment of documents</chapter-title>. In <source>Compression and Complexity of Sequences 1997. Proceedings</source>, pp. <fpage>21</fpage>&#x2013;<lpage>29</lpage>, <publisher-name>IEEE</publisher-name>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Bryant</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Sch&#x00FC;rch</surname> <given-names>AC</given-names></string-name>, <string-name><surname>van Deutekom</surname> <given-names>H</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>de Beer</surname> <given-names>JL</given-names></string-name>, <string-name><surname>de Jager</surname> <given-names>V</given-names></string-name>, <string-name><surname>Kremer</surname> <given-names>K</given-names></string-name>, <string-name><surname>van Hijum</surname> <given-names>SAFT</given-names></string-name>, <string-name><surname>Siezen</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Borgdorff</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <year>2013</year>. <article-title>Inferring patient to patient transmission of Mycobacterium tuberculosis from whole genome sequencing data</article-title>. <source>BMC Infect Dis</source> <volume>13</volume>: <fpage>110</fpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Chalker</surname> <given-names>V</given-names></string-name>, <string-name><surname>Jironkin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Coelho</surname> <given-names>J</given-names></string-name>, <string-name><surname>Al-Shahib</surname> <given-names>A</given-names></string-name>, <string-name><surname>Platt</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kapatai</surname> <given-names>G</given-names></string-name>, <string-name><surname>Daniel</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dhami</surname> <given-names>C</given-names></string-name>, <string-name><surname>Laranjeira</surname> <given-names>M</given-names></string-name>, <string-name><surname>Chambers</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal> <year>2017</year>. <article-title>Genome analysis following a national increase in Scarlet Fever in England 2014</article-title>. <source>BMC Genomics</source> <volume>18</volume>: <fpage>224</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Cheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Sir&#x00E9;n</surname> <given-names>J</given-names></string-name>, <string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <year>2013</year>. <article-title>Hierarchical and spatially explicit clustering of DNA sequences with BAPS software</article-title>. <source>Mol Biol Evol</source> <volume>30</volume>: <fpage>1224</fpage>&#x2013;<lpage>1228</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Cohen</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Abeel</surname> <given-names>T</given-names></string-name>, <string-name><surname>Manson McGuire</surname> <given-names>A</given-names></string-name>, <string-name><surname>Desjardins</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Munsamy</surname> <given-names>V</given-names></string-name>, <string-name><surname>Shea</surname> <given-names>TP</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Bantubani</surname> <given-names>N</given-names></string-name>, <string-name><surname>Almeida</surname> <given-names>DV</given-names></string-name>, <string-name><surname>Alvarado</surname> <given-names>L</given-names></string-name>, <etal>et al.</etal> <year>2015</year>. <article-title>Evolution of Extensively Drug-Resistant Tuberculosis over Four Decades: Whole Genome Sequencing and Dating Analysis of Mycobacterium tuberculosis Isolates from KwaZulu-Natal</article-title>. <source>PLoS Med</source> <volume>12</volume>: <fpage>e1001880</fpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gutmann</surname> <given-names>MU</given-names></string-name>, <string-name><surname>Arnold</surname> <given-names>B</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>. <year>2017</year>. <article-title>Frequency-dependent selection in vaccine-associated pneumococcal population dynamics</article-title>. <source>Nat Ecol Evol</source> <volume>1</volume>: <fpage>1950</fpage>&#x2013;<lpage>1960</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Sir&#x00E9;n</surname> <given-names>J</given-names></string-name>, <string-name><surname>Tang</surname> <given-names>J</given-names></string-name>. <year>2008</year>. <article-title>Enhanced Bayesian modelling in BAPS software for learning genetic structures of populations</article-title>. <source>BMC Bioinformatics</source> <volume>9</volume>: <fpage>539</fpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Chewapreecha</surname> <given-names>C</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>McGee</surname> <given-names>L</given-names></string-name>, <string-name><surname>van der Linden</surname> <given-names>M</given-names></string-name>, <string-name><surname>Song</surname> <given-names>J-H</given-names></string-name>, <string-name><surname>Ko</surname> <given-names>KS</given-names></string-name>, <string-name><surname>de Lencastre</surname> <given-names>H</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <year>2014a</year>. <article-title>Evidence for soft selective sweeps in the evolution of pneumococcal multidrug resistance and vaccine escape</article-title>. <source>Genome Biol Evol</source> <volume>6</volume>: <fpage>1589</fpage>&#x2013;<lpage>1602</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Coupland</surname> <given-names>PG</given-names></string-name>, <string-name><surname>Stevenson</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Callendrello</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>. <year>2014b</year>. <article-title>Diversification of bacterial genome content through distinct mechanisms over different timescales</article-title>. <source>Nat Commun</source> <volume>5</volume>: <fpage>5471</fpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>. <year>2015</year>. <article-title>The application of genomics to tracing bacterial pathogen transmission</article-title>. <source>Curr Opin Microbiol</source> <volume>23</volume>: <fpage>62</fpage>&#x2013;<lpage>67</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Finkelstein</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Pelton</surname> <given-names>SI</given-names></string-name>, <string-name><surname>Mitchell</surname> <given-names>PK</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>. <year>2013</year>. <article-title>Population genomics of post-vaccine changes in pneumococcal epidemiology</article-title>. <source>Nat Genet</source> <volume>45</volume>: <fpage>656</fpage>&#x2013;<lpage>663</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Finkelstein</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Pelton</surname> <given-names>SI</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>. <year>2015</year>. <article-title>Population genomic datasets describing the post-vaccine evolutionary epidemiology of Streptococcus pneumoniae</article-title>. <source>Scientific Data</source> <volume>2</volume>: <fpage>150058</fpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Mostowy</surname> <given-names>R</given-names></string-name>, <string-name><surname>Wymant</surname> <given-names>C</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>P</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>. <year>2016</year>. <article-title>Horizontal DNA Transfer Mechanisms of Bacteria as Weapons of Intragenomic Conflict</article-title>. <source>PLoS Biol</source> <volume>14</volume>: <fpage>e1002394</fpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>De Been</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pinholt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Top</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bletz</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mellmann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Van Schaik</surname> <given-names>W</given-names></string-name>, <string-name><surname>Brouwer</surname> <given-names>E</given-names></string-name>, <string-name><surname>Rogers</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kraat</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Bonten</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <year>2015</year>. <article-title>Core genome multilocus sequence typing scheme for high-resolution typing of Enterococcus faecium</article-title>. <source>J Clin Microbiol</source> <volume>53</volume>: <fpage>3788</fpage>&#x2013;<lpage>3797</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>. <year>2010</year>. <article-title>Impact of recombination on bacterial evolution</article-title>. <source>Trends Microbiol</source> <volume>18</volume>: <fpage>315</fpage>&#x2013;<lpage>322</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Nell</surname> <given-names>S</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>I</given-names></string-name>, <string-name><surname>Woltemate</surname> <given-names>S</given-names></string-name>, <string-name><surname>van der Merwe</surname> <given-names>S</given-names></string-name>, <string-name><surname>Suerbaum</surname> <given-names>S</given-names></string-name>. <year>2013</year>. <article-title>Genomic evolution and transmission of Helicobacter pylori in two South African families</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>110</volume>: <fpage>13880</fpage>&#x2013;<lpage>13885</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Doolittle</surname> <given-names>F</given-names></string-name>. <year>2002</year>. <article-title>Diversity squared</article-title>. <source>Environ Microbiol</source> <volume>4</volume>: <fpage>10</fpage>&#x2013;<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Feil</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Li</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Spratt</surname> <given-names>BG</given-names></string-name>. <year>2004</year>. <article-title>eBURST: inferring patterns of evolutionary descent among clusters of related bacterial genotypes from multilocus sequence typing data</article-title>. <source>J Bacteriol</source> <volume>186</volume>: <fpage>1518</fpage>&#x2013;<lpage>1530</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="website"><string-name><surname>Feng</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Major</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sievert</surname> <given-names>S</given-names></string-name>. <year>2017</year>. <source>ra inwoodman/s ha redmem 0.3.5</source>. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1051258">https://zenodo.org/record/1051258</ext-link>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Grad</surname> <given-names>YH</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Kirkcaldy</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Green</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Trees</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lipsitch</surname> <given-names>M</given-names></string-name>. <year>2016</year>. <article-title>Genomic Epidemiology of Gonococcal Resistance to Extended-Spectrum Cephalosporins, Macrolides, and Fluoroquinolones in the United States, 2000-2013</article-title>. <source>J Infect Dis</source> <volume>214</volume>: <fpage>1579</fpage>&#x2013;<lpage>1587</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Hadfield</surname> <given-names>J</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Goater</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Abudahab</surname> <given-names>K</given-names></string-name>, <string-name><surname>Aanensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>. <year>2017</year>. <article-title>Phandango: an interactive viewer for bacterial population genomics</article-title>. <source>Bioinformatics</source>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btx610">http://dx.doi.org/10.1093/bioinformatics/btx610</ext-link>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="book"><string-name><surname>Hagberg</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Schult</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Swart</surname> <given-names>PJ</given-names></string-name>. <year>2008</year>. <chapter-title>Exploring Network Structure, Dynamics, and Function using NetworkX</chapter-title>. In <source>Proceedings of the 7th Python in Science Conference</source> (eds. <string-name><given-names>G.</given-names> <surname>Varoquaux</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Vaught</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Millman</surname></string-name>), pp. <fpage>11</fpage>&#x2013;<lpage>15</lpage>, <publisher-loc>Pasadena, CA USA</publisher-loc>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Hamilton</surname> <given-names>HL</given-names></string-name>, <string-name><surname>Dom&#x00ED;nguez</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Schwartz</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Hackett</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Dillard</surname> <given-names>JP</given-names></string-name>. <year>2005</year>. <article-title>Neisseria gonorrhoeae secretes chromosomal DNA via a novel type IV secretion system</article-title>. <source>Mol Microbiol</source> <volume>55</volume>: <fpage>1704</fpage>&#x2013;<lpage>1721</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Holt</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Wertheim</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zadoks</surname> <given-names>RN</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>S</given-names></string-name>, <string-name><surname>Whitehouse</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Dance</surname> <given-names>D</given-names></string-name>, <string-name><surname>Jenney</surname> <given-names>A</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Hsu</surname> <given-names>LY</given-names></string-name>, <string-name><surname>Severin</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <year>2015</year>. <article-title>Genomic analysis of diversity, population structure, virulence, and antimicrobial resistance in Klebsiella pneumoniae, an urgent threat to public health</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>112</volume>: <fpage>E3574</fpage>&#x2013;<lpage>81</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Hunter</surname> <given-names>JD</given-names></string-name>. <year>2007</year>. <article-title>Matplotlib: A 2D graphics environment</article-title>. <source>Comput Sci Eng</source> <volume>9</volume>: <fpage>90</fpage>&#x2013;<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Jolley</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Bray</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>. <year>2017</year>. <article-title>A RESTful application programming interface for the PubMLST molecular typing and genome databases</article-title>. <source>Database</source> <volume>2017</volume>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/database/bax060">http://dx.doi.org/10.1093/database/bax060</ext-link>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Kallonen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Brodrick</surname> <given-names>HJ</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>V</given-names></string-name>, <string-name><surname>Peacock</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>. <year>2017</year>. <article-title>Systematic longitudinal survey of invasive Escherichia coli in England demonstrates a stable population structure only transiently disturbed by the emergence of ST131</article-title>. <source>Genome Res.</source> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.216606.116">http://dx.doi.org/10.1101/gr.216606.116</ext-link>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Koelman</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kremer</surname> <given-names>P</given-names></string-name>, <string-name><surname>Lees</surname> <given-names>J</given-names></string-name>, <string-name><surname>Brouwer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>S</given-names></string-name>, <string-name><surname>van de Beek</surname> <given-names>D</given-names></string-name>. <year>2017</year>. <article-title>Bacterial hypervirulence in haemophilus influenzae meningitis identified by whole genome sequencing</article-title>. <source>J Neurol Sci</source> <volume>381</volume>: <fpage>181</fpage>&#x2013;<lpage>182</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Kremer</surname> <given-names>PHC</given-names></string-name>, <string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Koopmans</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Ferwerda</surname> <given-names>B</given-names></string-name>, <string-name><surname>Arends</surname> <given-names>AWM</given-names></string-name>, <string-name><surname>Feller</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Schipper</surname> <given-names>K</given-names></string-name>, <string-name><surname>Vails Seron</surname> <given-names>M</given-names></string-name>, <string-name><surname>van der Ende</surname> <given-names>A</given-names></string-name>, <string-name><surname>Brouwer</surname> <given-names>MC</given-names></string-name>, <etal>et al.</etal> <year>2017</year>. <article-title>Benzalkonium tolerance genes and outcome in Listeria monocytogenes meningitis</article-title>. <source>Clin Microbiol Infect</source> <volume>23</volume>: <fpage>265.e1</fpage>&#x2013;<lpage>265.e7</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Kristensen</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Kannan</surname> <given-names>L</given-names></string-name>, <string-name><surname>Coleman</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Wolf</surname> <given-names>Yl</given-names></string-name>, <string-name><surname>Sorokin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Koonin</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Mushegian</surname> <given-names>A</given-names></string-name>. <year>2010</year>. <article-title>A low-polynomial algorithm for assembling clusters of orthologous groups from intergenomic symmetric best matches</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1481</fpage>&#x2013;<lpage>1487</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="book"><string-name><surname>Lam</surname> <given-names>SK</given-names></string-name>, <string-name><surname>Pitrou</surname> <given-names>A</given-names></string-name>, <string-name><surname>Seibert</surname> <given-names>S</given-names></string-name>. <year>2015</year>. <chapter-title>Numba: A LLVM-based Python JIT Compiler</chapter-title>. In <source>Proceedings of the Second Workshop on the LLVM Compiler Infrastructure in HPC, LLVM &#x2019;15</source>, pp. <fpage>7:1</fpage>&#x2013;<lpage>7:6</lpage>, <publisher-name>ACM</publisher-name>, <publisher-loc>New York, NY, USA</publisher-loc>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Galardini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Weiser</surname> <given-names>JN</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <year>2018a</year>. <article-title>pyseer: a comprehensive tool for microbial pangenome-wide association studies</article-title>. <source>Bioinformatics</source>. <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/bty539/5047751">https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/bty539/5047751</ext-link> (<date-in-citation>Accessed July 3, 2018</date-in-citation>).</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Kendall</surname> <given-names>M</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Colijn</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>. <year>2018b</year>. <article-title>Evaluation of phylogenetic reconstruction methods using bacterial whole genomes: a simulation based study</article-title>. <source>Wellcome Open Res</source> <volume>3</volume>: <fpage>33</fpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Kremer</surname> <given-names>PHC</given-names></string-name>, <string-name><surname>Manso</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Ferwerda</surname> <given-names>B</given-names></string-name>, <string-name><surname>Ser&#x00F3;n</surname> <given-names>MV</given-names></string-name>, <string-name><surname>Oggioni</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Brouwer</surname> <given-names>MC</given-names></string-name>, <string-name><surname>van der Ende</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <year>2017</year>. <article-title>Large scale genomic analysis shows no evidence for pathogen adaptation between the blood and cerebrospinal fluid niches during bacterial meningitis</article-title>. <source>Microb Genom</source> <volume>3</volume>: <fpage>e000103</fpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Vehkala</surname> <given-names>M</given-names></string-name>, <string-name><surname>V&#x00E4;lim&#x00E4;ki</surname> <given-names>N</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Chewapreecha</surname> <given-names>C</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Davies</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Steer</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Tong</surname> <given-names>SYC</given-names></string-name>, <etal>et al.</etal> <year>2016</year>. <article-title>Sequence element enrichment analysis to determine the genetic basis of bacterial phenotypes</article-title>. <source>Nat Commun</source> <volume>7</volume>: <fpage>12797</fpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Liu</surname> <given-names>Y-Y</given-names></string-name>, <string-name><surname>Chiou</surname> <given-names>C-S</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>C-C</given-names></string-name>. <year>2016</year>. <article-title>PGAdb-builder: A web service tool for creating pan-genome allele database for molecular fine typing</article-title>. <source>Sci Rep</source> <volume>6</volume>: <fpage>36213</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Maiden</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Bygraves</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Feil</surname> <given-names>E</given-names></string-name>, <string-name><surname>Morelli</surname> <given-names>G</given-names></string-name>, <string-name><surname>Russell</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Urwin</surname> <given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zurth</surname> <given-names>K</given-names></string-name>, <string-name><surname>Caugant</surname> <given-names>DA</given-names></string-name>, <etal>et al.</etal> <year>1998</year>. <article-title>Multilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>95</volume>: <fpage>3140</fpage>&#x2013;<lpage>3145</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>, <string-name><surname>Harrison</surname> <given-names>OB</given-names></string-name>. <year>2016</year>. <article-title>Population and Functional Genomics of Neisseria Revealed with Gene-by-Gene Approaches</article-title>. <source>J Clin Microbiol</source> <volume>54</volume>: <fpage>1949</fpage>&#x2013;<lpage>1955</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Gutmann</surname> <given-names>MU</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>. <year>2015</year>. <article-title>Recombination produces coherent bacterial species clusters in both core and accessory genomes</article-title>. <source>Microb Genom</source> <volume>1</volume>: <fpage>e000038</fpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Mclnnes</surname> <given-names>L</given-names></string-name>, <string-name><surname>Healy</surname> <given-names>J</given-names></string-name>, <string-name><surname>Astels</surname> <given-names>S</given-names></string-name>. <year>2017</year>. <article-title>hdbscan: Hierarchical density based clustering</article-title>. <source>The Journal of Open Source Software</source> <volume>2</volume>: <fpage>205</fpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Mellmann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bletz</surname> <given-names>S</given-names></string-name>, <string-name><surname>B&#x00F6;king</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kipp</surname> <given-names>F</given-names></string-name>, <string-name><surname>Becker</surname> <given-names>K</given-names></string-name>, <string-name><surname>Schultes</surname> <given-names>A</given-names></string-name>, <string-name><surname>Prior</surname> <given-names>K</given-names></string-name>, <string-name><surname>Harmsen</surname> <given-names>D</given-names></string-name>. <year>2016</year>. <article-title>Real-Time Genome Sequencing of Resistant Bacteria Provides Precision Infection Control in an Institutional Setting</article-title>. <source>J Clin Microbiol</source> <volume>54</volume>: <fpage>2874</fpage>&#x2013;<lpage>2881</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Morse</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Biddle</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Roberts</surname> <given-names>MC</given-names></string-name>. <year>1986</year>. <article-title>High-level tetracycline resistance in Neisseria gonorrhoeae is result of acquisition of streptococcal tetM determinant</article-title>. <source>Antimicrob Agents Chemother</source> <volume>30</volume>: <fpage>664</fpage>&#x2013;<lpage>670</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Nadon</surname> <given-names>C</given-names></string-name>, <string-name><surname>Van Walle</surname> <given-names>I</given-names></string-name>, <string-name><surname>Gerner-Smidt</surname> <given-names>P</given-names></string-name>, <string-name><surname>Campos</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chinen</surname> <given-names>I</given-names></string-name>, <string-name><surname>Concepcion-Acevedo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gilpin</surname> <given-names>B</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Man Kam</surname> <given-names>K</given-names></string-name>, <string-name><surname>Perez</surname> <given-names>E</given-names></string-name>, <etal>et al.</etal> <year>2017</year>. <article-title>PulseNet International: Vision for the implementation of whole genome sequencing (WGS) for global food-borne disease surveillance</article-title>. <source>Euro Surveill</source> <volume>22</volume>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2807/1560-7917.ES.2017.22.23.30544">http://dx.doi.org/10.2807/1560-7917.ES.2017.22.23.30544</ext-link>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Nasser</surname> <given-names>W</given-names></string-name>, <string-name><surname>Beres</surname> <given-names>SB</given-names></string-name>, <string-name><surname>Olsen</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Dean</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Rice</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Long</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Kristinsson</surname> <given-names>KG</given-names></string-name>, <string-name><surname>Gottfredsson</surname> <given-names>M</given-names></string-name>, <string-name><surname>Vuopio</surname> <given-names>J</given-names></string-name>, <string-name><surname>Raisanen</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <year>2014</year>. <article-title>Evolutionary pathway to increased virulence and epidemic group A Streptococcus disease derived from 3,615 genome sequences</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>E1768</fpage>&#x2013;<lpage>76</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Nei</surname> <given-names>M</given-names></string-name>, <string-name><surname>Li</surname> <given-names>WH</given-names></string-name>. <year>1979</year>. <article-title>Mathematical model for studying genetic variation in terms of restriction endonucleases</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>76</volume>: <fpage>5269</fpage>&#x2013;<lpage>5273</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname> <given-names>L-T</given-names></string-name>, <string-name><surname>Schmidt</surname> <given-names>HA</given-names></string-name>, <string-name><surname>von Haeseler</surname> <given-names>A</given-names></string-name>, <string-name><surname>Minh</surname> <given-names>BQ</given-names></string-name>. <year>2015</year>. <article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>. <source>Mol Biol Evol</source> <volume>32</volume>: <fpage>268</fpage>&#x2013;<lpage>274</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Ondov</surname> <given-names>BD</given-names></string-name>, <string-name><surname>Treangen</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Melsted</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mallonee</surname> <given-names>AB</given-names></string-name>, <string-name><surname>Bergman</surname> <given-names>NH</given-names></string-name>, <string-name><surname>Koren</surname> <given-names>S</given-names></string-name>, <string-name><surname>Phillippy</surname> <given-names>AM</given-names></string-name>. <year>2016</year>. <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source> <volume>17</volume>: <fpage>1</fpage>&#x2013;<lpage>14</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Oren</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Johns</surname> <given-names>Nl</given-names></string-name>, <string-name><surname>Kaplan Zeevi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Biran</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ron</surname> <given-names>EZ</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>HH</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Pupko</surname> <given-names>T</given-names></string-name>. <year>2014</year>. <article-title>Transfer of noncoding DNA drives regulatory rewiring in bacteria</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>16112</fpage>&#x2013;<lpage>16117</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Cummins</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wong</surname> <given-names>VK</given-names></string-name>, <string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MTG</given-names></string-name>, <string-name><surname>Fookes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D</given-names></string-name>, <string-name><surname>Keane</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>. <year>2015</year>. <article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source> <volume>31</volume>: <fpage>btv421</fpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Palys</surname> <given-names>T</given-names></string-name>, <string-name><surname>Nakamura</surname> <given-names>LK</given-names></string-name>, <string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name>. <year>1997</year>. <article-title>Discovery and classification of ecological diversity in the bacterial world: the role of DNA sequence data</article-title>. <source>Int J Syst Bacteriol</source> <volume>47</volume>: <fpage>1145</fpage>&#x2013;<lpage>1156</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Pedregosa</surname> <given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname> <given-names>A</given-names></string-name>, <string-name><surname>Michel</surname> <given-names>V</given-names></string-name>, <string-name><surname>Thirion</surname> <given-names>B</given-names></string-name>, <string-name><surname>Grisel</surname> <given-names>O</given-names></string-name>, <string-name><surname>Blondel</surname> <given-names>M</given-names></string-name>, <string-name><surname>Prettenhofer</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weiss</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dubourg</surname> <given-names>V</given-names></string-name>, <etal>et al.</etal> <year>2011</year>. <article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>J Mach Learn Res</source> <volume>12</volume>: <fpage>2825</fpage>&#x2013;<lpage>2830</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Pritchard</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Stephens</surname> <given-names>M</given-names></string-name>, <string-name><surname>Donnelly</surname> <given-names>P</given-names></string-name>. <year>2000</year>. <article-title>Inference of population structure using multilocus genotype data</article-title>. <source>Genetics</source> <volume>155</volume>: <fpage>945</fpage>&#x2013;<lpage>959</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Prosperi</surname> <given-names>MCF</given-names></string-name>, <string-name><surname>Ciccozzi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Fanti</surname> <given-names>I</given-names></string-name>, <string-name><surname>Saladini</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pecorari</surname> <given-names>M</given-names></string-name>, <string-name><surname>Borghi</surname> <given-names>V</given-names></string-name>, <string-name><surname>Di Giambenedetto</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bruzzone</surname> <given-names>B</given-names></string-name>, <string-name><surname>Capetti</surname> <given-names>A</given-names></string-name>, <string-name><surname>Vivarelli</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <year>2011</year>. <article-title>A novel methodology for large-scale phylogeny partition</article-title>. <source>Nat Commun</source> <volume>2</volume>: <fpage>321</fpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Rand</surname> <given-names>WM</given-names></string-name>. <year>1971</year>. <article-title>Objective Criteria for the Evaluation of Clustering Methods</article-title>. <source>J Am Stat Assoc</source> <volume>66</volume>: <fpage>846</fpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Barquist</surname> <given-names>L</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>D</given-names></string-name>, <string-name><surname>Feltwell</surname> <given-names>T</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Fookes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hall</surname> <given-names>ME</given-names></string-name>, <string-name><surname>Petty</surname> <given-names>NK</given-names></string-name>, <string-name><surname>Fuchs</surname> <given-names>TM</given-names></string-name>, <etal>et al.</etal> <year>2014</year>. <article-title>Parallel independent evolution of pathogenicity within the genus Yersinia</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>6768</fpage>&#x2013;<lpage>6773</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Ruppitsch</surname> <given-names>W</given-names></string-name>, <string-name><surname>Pietzka</surname> <given-names>A</given-names></string-name>, <string-name><surname>Prior</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bletz</surname> <given-names>S</given-names></string-name>, <string-name><surname>Fernandez</surname> <given-names>HL</given-names></string-name>, <string-name><surname>Allerberger</surname> <given-names>F</given-names></string-name>, <string-name><surname>Harmsen</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mellmann</surname> <given-names>A</given-names></string-name>. <year>2015</year>. <article-title>Defining and Evaluating a Core Genome Multilocus Sequence Typing Scheme for Whole-Genome Sequence-Based Typing of Listeria monocytogenes</article-title>. <source>J Clin Microbiol</source> <volume>53</volume>: <fpage>2869</fpage>&#x2013;<lpage>2876</lpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Shannon</surname> <given-names>P</given-names></string-name>, <string-name><surname>Markiel</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ozier</surname> <given-names>O</given-names></string-name>, <string-name><surname>Baliga</surname> <given-names>NS</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>JT</given-names></string-name>, <string-name><surname>Ramage</surname> <given-names>D</given-names></string-name>, <string-name><surname>Amin</surname> <given-names>N</given-names></string-name>, <string-name><surname>Schwikowski</surname> <given-names>B</given-names></string-name>, <string-name><surname>Ideker</surname> <given-names>T</given-names></string-name>. <year>2003</year>. <article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>. <source>Genome Res</source> <volume>13</volume>: <fpage>2498</fpage>&#x2013;<lpage>2504</lpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Simonsen</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mailund</surname> <given-names>T</given-names></string-name>, <string-name><surname>Pedersen</surname> <given-names>CNS</given-names></string-name>. <year>2011</year>. <article-title>Inference of Large Phylogenies Using Neighbour-Joining</article-title>. In <source>Communications in Computer and Information Science</source>, pp. <fpage>334</fpage>&#x2013;<lpage>344</lpage>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><surname>Sipola</surname> <given-names>A</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <year>2018</year>. <article-title>Bacmeta: simulator for genomic evolution in bacterial metapopulations</article-title>. <source>Bioinformatics</source>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bty093">http://dx.doi.org/10.1093/bioinformatics/bty093</ext-link>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><surname>Sukumaran</surname> <given-names>J</given-names></string-name>, <string-name><surname>Holder</surname> <given-names>MT</given-names></string-name>. <year>2010</year>. <article-title>DendroPy: a Python library for phylogenetic computing</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1569</fpage>&#x2013;<lpage>1571</lpage>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><string-name><surname>Swaminathan</surname> <given-names>B</given-names></string-name>, <string-name><surname>Barrett</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Hunter</surname> <given-names>SB</given-names></string-name>, <string-name><surname>Tauxe</surname> <given-names>RV</given-names></string-name>, <collab>CDC PulseNet Task Force</collab>. <year>2001</year>. <article-title>PulseNet: the molecular subtyping network for foodborne bacterial disease surveillance, United States</article-title>. <source>Emerg Infect Dis</source> <volume>7</volume>: <fpage>382</fpage>&#x2013;<lpage>389</lpage>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><string-name><surname>Swaminathan</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gerner-Smidt</surname> <given-names>P</given-names></string-name>, <string-name><surname>Ng</surname> <given-names>L-K</given-names></string-name>, <string-name><surname>Lukinmaa</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kam</surname> <given-names>K-M</given-names></string-name>, <string-name><surname>Rolando</surname> <given-names>S</given-names></string-name>, <string-name><surname>Guti&#x00E9;rrez</surname> <given-names>EP</given-names></string-name>, <string-name><surname>Binsztein</surname> <given-names>N</given-names></string-name>. <year>2006</year>. <article-title>Building PulseNet International: an interconnected system of laboratory networks to facilitate timely public health recognition and response to foodborne disease outbreaks and emerging foodborne diseases</article-title>. <source>Foodborne Pathog Dis</source> <volume>3</volume>: <fpage>36</fpage>&#x2013;<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><string-name><surname>Tonkin-Hill</surname> <given-names>G</given-names></string-name>, <string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Frost</surname> <given-names>SDW</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <year>2018</year>. <article-title>RhierBAPS - an R implementation of the population clustering algorithm hierBAPS</article-title>. <source>Wellcome Open Res.</source></mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><string-name><surname>Turner</surname> <given-names>KME</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Spratt</surname> <given-names>BG</given-names></string-name>. <year>2007</year>. <article-title>Assessing the reliability of eBURST using simulated populations with known ancestry</article-title>. <source>BMC Microbiol</source> <volume>7</volume>: <fpage>30</fpage>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="journal"><string-name><surname>Weinert</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Chaudhuri</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Peters</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jombart</surname> <given-names>T</given-names></string-name>, <string-name><surname>Baig</surname> <given-names>A</given-names></string-name>, <string-name><surname>Howell</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Vehkala</surname> <given-names>M</given-names></string-name>, <string-name><surname>V&#x00E4;lim&#x00E4;ki</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <year>2015</year>. <article-title>Genomic signatures of human and animal disease in the zoonotic pathogen Streptococcus suis</article-title>. <source>Nat Commun</source> <volume>6</volume>: <fpage>6740</fpage>.</mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><string-name><surname>Willemse</surname> <given-names>N</given-names></string-name>, <string-name><surname>Howell</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Weinert</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Heuvelink</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pannekoek</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wagenaar</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>HE</given-names></string-name>, <string-name><surname>van der Ende</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schultsz</surname> <given-names>C</given-names></string-name>. <year>2016</year>. <article-title>An emerging zoonotic clone in the Netherlands provides clues to virulence and zoonotic potential of Streptococcus suis</article-title>. <source>Sci Rep</source> <volume>6</volume>: <fpage>28984</fpage>.</mixed-citation></ref>
<ref id="c76"><mixed-citation publication-type="journal"><string-name><surname>Willems</surname> <given-names>RJL</given-names></string-name>, <string-name><surname>Top</surname> <given-names>J</given-names></string-name>, <string-name><surname>van Schaik</surname> <given-names>W</given-names></string-name>, <string-name><surname>Leavis</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bonten</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sir&#x00E9;n</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>. <year>2012</year>. <article-title>Restricted gene flow among hospital subpopulations of Enterococcus faecium</article-title>. <source>MBio</source> <volume>3</volume>: <fpage>e00151</fpage>&#x2013;<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c77"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Halkilahti</surname> <given-names>J</given-names></string-name>, <string-name><surname>H&#x00E4;nninen</surname> <given-names>M-L</given-names></string-name>, <string-name><surname>Rossi</surname> <given-names>M</given-names></string-name>. <year>2015</year>. <article-title>Refinement of whole-genome multilocus sequence typing analysis by addressing gene paralogy</article-title>. <source>J Clin Microbiol</source> <volume>53</volume>: <fpage>1765</fpage>&#x2013;<lpage>1767</lpage>.</mixed-citation></ref>
<ref id="c78"><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Alikhan</surname> <given-names>N-F</given-names></string-name>, <string-name><surname>Sergeant</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Luhmann</surname> <given-names>N</given-names></string-name>, <string-name><surname>Vaz</surname> <given-names>C</given-names></string-name>, <string-name><surname>Francisco</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Carrico</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Achtman</surname> <given-names>M</given-names></string-name>. <year>2017</year>. <article-title>GrapeTree: Visualization of core genomic relationships among 100,000 bacterial pathogens</article-title>. <source>bioRxiv</source> <fpage>216788</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2017/11/09/216788">https://www.biorxiv.org/content/early/2017/11/09/216788</ext-link> (<date-in-citation>Accessed June 19, 2018</date-in-citation>).</mixed-citation></ref>
<ref id="c79"><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname> <given-names>Z</given-names></string-name>, <string-name><surname>McCann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Litrup</surname> <given-names>E</given-names></string-name>, <string-name><surname>Murphy</surname> <given-names>R</given-names></string-name>, <string-name><surname>Cormican</surname> <given-names>M</given-names></string-name>, <string-name><surname>Fanning</surname> <given-names>S</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>D</given-names></string-name>, <string-name><surname>Guttman</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Brisse</surname> <given-names>S</given-names></string-name>, <string-name><surname>Achtman</surname> <given-names>M</given-names></string-name>. <year>2013</year>. <article-title>Neutral genomic microevolution of a recently emerged pathogen, Salmonella enterica serovar Agona</article-title>. <source>PLoS Genet</source> <volume>9</volume>: <fpage>e1003471</fpage>.</mixed-citation></ref>
<ref id="c80"><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname> <given-names>Z</given-names></string-name>, <string-name><surname>McCann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Weill</surname> <given-names>F-X</given-names></string-name>, <string-name><surname>Blin</surname> <given-names>C</given-names></string-name>, <string-name><surname>Nair</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wain</surname> <given-names>J</given-names></string-name>, <string-name><surname>Dougan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Achtman</surname> <given-names>M</given-names></string-name>. <year>2014</year>. <article-title>Transient Darwinian selection in Salmonella enterica serovar Paratyphi A during 450 years of global spread of enteric fever</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>12199</fpage>&#x2013;<lpage>12204</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>