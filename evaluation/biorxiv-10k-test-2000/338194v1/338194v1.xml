<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/338194</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Precise prediction of antibiotic resistance in <italic>Escherichia coli</italic> from full genome sequences</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Moradigaravand</surname>
<given-names>Danesh</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Palm</surname>
<given-names>Martin</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0841-4908</contrib-id>
<name>
<surname>Farewell</surname>
<given-names>Anne</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7270-1792</contrib-id>
<name>
<surname>Mustonen</surname>
<given-names>Ville</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6144-2740</contrib-id>
<name>
<surname>Warringer</surname>
<given-names>Jonas</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Parts</surname>
<given-names>Leopold</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Wellcome Sanger Institute</institution>, Wellcome Genome Campus, Hinxton, Cambridgeshire CB10 1SA, <country>United Kingdom</country></aff>
<aff id="a2"><label>2</label><institution>Department for Chemistry and Molecular Biology</institution>, University of Gothenburg 405 30, <country>Sweden</country></aff>
<aff id="a3"><label>3</label><institution>Centre for Antibiotic Resistance Research</institution> at the University of Gothenburg 405 30, <country>Sweden</country></aff>
<aff id="a4"><label>4</label><institution>Organismal and Evolutionary Biology Research Programme</institution>, Department of Computer Science, Institute of Biotechnology, University of Helsinki, <country>Finland</country></aff>
<aff id="a5"><label>5</label><institution>Department of Computer Science</institution>, University of Tartu, J. Liivi 2, 50409, Estonia</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><bold>Corresponding authors:</bold> Danesh Moradigaravand: <email>dm16@sanger.ac.uk</email>, Leopold Parts: <email>leopold.parts@sanger.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>338194</elocation-id>
<history>
<date date-type="received">
<day>04</day>
<month>6</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>04</day>
<month>6</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>04</day>
<month>6</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="338194.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>The emergence of microbial antibiotic resistance is a global health threat. In clinical settings, the key to controlling spread of resistant strains is accurate and rapid detection. As traditional culture-based methods are time consuming, genetic approaches have recently been developed for this task. The diagnosis is typically made by measuring a few known determinants previously identified from whole genome sequencing, and thus is restricted to existing information on biological mechanisms. To overcome this limitation, we employed machine learning models to predict resistance to 11 compounds across four classes of antibiotics from existing and novel whole genome sequences of 1936 <italic>E. coli</italic> strains. We considered a range of methods, and examined population structure, isolation year, gene content, and polymorphism information as predictors. Gradient boosted decision trees consistently outperformed alternative models with an average F1 score of 0.88 on held-out data (range 0.66-0.96). While the best models most frequently employed all inputs, an average F1 score of 0.73 could be obtained using population structure information alone. Single nucleotide variation data were less useful, and failed to improve prediction for ten out of 11 antibiotics. These results demonstrate that antibiotic resistance in <italic>E. coli</italic> can be accurately predicted from whole genome sequences without <italic>a priori</italic> knowledge of mechanisms, and that both genomic and epidemiological data are informative. This paves way to integrating machine learning approaches into diagnostic tools in the clinic.</p><sec>
<title>Summary</title>
<p>One of the major health threats of 21st century is emergence of antibiotic resistance. To manage its economic impact, efforts are made to develop novel diagnostic tools that rapidly detect resistant strains in clinical settings. In our study, we employed a range machine learning tools to predict antibiotic resistance from whole genome sequencing data for <italic>E. coli.</italic> We used the presence or absence of genes, population structure and isolation year of isolates as predictors, and could attain average precision of 0.93 and recall of 0.83, without prior knowledge about the causal mechanisms. These results demonstrate the potential application of machine learning methods as a diagnostic tool in healthcare settings.</p>
</sec>
</abstract>
<counts>
<page-count count="24"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Antibiotic resistance has turned into an acute global threat. The rise of bacterial strains resistant to multiple antibiotics is expected to dramatically limit treatment effectiveness [<xref rid="c1" ref-type="bibr">1</xref>], leading to potentially incurable outbreaks. In addition to new drug development efforts, there is an urgent need for preclinical tools that are capable of effective and rapid detection of resistance [<xref rid="c2" ref-type="bibr">2</xref>, <xref rid="c3" ref-type="bibr">3</xref>], as culture-based laboratory diagnostics test are usually time consuming and costly [<xref rid="c3" ref-type="bibr">3</xref>].</p>
<p>To accelerate the diagnosis, genetic tests have been devised to identify known resistance genes. The increasingly affordable and available whole genome sequencing data from clinical strains has helped to robustly identify antibiotic resistance determinants, and to curate them in dedicated databases [<xref rid="c4" ref-type="bibr">4</xref>, <xref rid="c5" ref-type="bibr">5</xref>]. Given sequence from a new strain, computational methods can then look up known causal genes in these resources [<xref rid="c5" ref-type="bibr">5</xref>, <xref rid="c6" ref-type="bibr">6</xref>]. Whilst such rule-based models are highly accurate for some common pathogens with well-characterized resistance mechanisms (e.g. <italic>Mycobacterium tuberculosis</italic> and <italic>Staphylococcus aureus</italic>), they cannot be employed to detect resistance caused by unknown mechanisms in other major pathogenic strains, and require constant curation to remain effective.</p>
<p>Prediction approaches based on machine learning have the potential to overcome these restrictions of rule-based tests. As general-purpose methods, they are agnostic to the causal mechanisms, and learn useful features directly from data [<xref rid="c7" ref-type="bibr">7</xref>-<xref rid="c9" ref-type="bibr">9</xref>]. Already, decision tree based models have proven valuable for predicting resistance and pathogen invasiveness from genomic sequences [<xref rid="c10" ref-type="bibr">10</xref>-<xref rid="c14" ref-type="bibr">14</xref>]. However, these studies were limited in both the genetic features used and the methods applied. In particular, both population structure and accessory genome content could contain predictive information, as resistance determinants may be transferred horizontally from other strains, or inherited vertically from an ancestor [<xref rid="c2" ref-type="bibr">2</xref>]. Further, the powerful deep learning methods that can utilize complex features interactions were not examined.</p>
<p>Here, we systematically evaluate the performance of machine learning algorithms for predicting antibiotic resistance from <italic>E. coli</italic> whole genome sequence data. We present genome sequences and resistance measurements of 255 new isolates and consider them together with published data from recent large-scale studies, as well as simulated datasets. We test whether prediction accuracy improves with including temporal data, population structure, and accessory genome content, and assess how a range of population parameters, such as mutation and recombination rates, influence predictions.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Isolates</title>
<p>We used 1681 strains from four large-scale clinical and environmental <italic>E. coli</italic> collections, with available data on the year of isolation, drug susceptibility phenotypes, and whole genome sequence [<xref rid="c15" ref-type="bibr">15</xref>, <xref rid="c16" ref-type="bibr">16</xref>]. Furthermore, we collected 255 strains from a range of ecological niches: hospital sewage and water treatment plant from Sweden (Carl-Fredrik Flach); human clinical isolates isolated in Pakistan, Syria, Sweden and USA (Culture Collection University of Gothenburg); a collection of strains producing extended-spectrum &#x03B2;-lactamases isolated in Sweden (Christina &#x212B;hr&#x00E9;n) and environmental samples from Belgium (Jan Michiels).</p>
</sec>
<sec id="s2b">
<title>Antimicrobial susceptibility testing</title>
<p>Antimicrobials tested included beta-lactams (penicillin: ampicillin (AMP, 6&#x00B5;g/ml); cephalosporins: cefuroxime (CXM, 8&#x00B5;g/ml), cefotaxime (CTX, 4&#x00B5;g/ml), cephalothin (CET, 20&#x00B5;g/ml) and ceftazidime (CTZ, 0.25&#x00B5;g/ml)), aminoglycosides (gentamicin (GEN, 4&#x00B5;g/ml) and tobramycin (TBM, 8&#x00B5;g/ml)), and fluoroquinolones (ciprofloxacin (CIP, 1&#x00B5;g/ml)). Concentrations used were determined by performing a 2-fold serial dilution, starting from twice the concentrations listed by the European Committee on Antimicrobial Susceptibility Testing (EUCAST) on 25/01/2017, until no growth was observed after 16 hours for the common lab strain BW25113 [<xref rid="c17" ref-type="bibr">17</xref>] used as a control in the experiments.</p>
</sec>
<sec id="s2c">
<title>Sequencing data generation</title>
<p>We extracted DNA with the Bacterial Genomic DNA Isolation 96-Well Kit (Norgen Biotek) as detailed in the manufacturer&#x2019;s instructions. Libraries were prepared with standard Illumina DNA sequencing library preparation protocols, and sequenced on Illumina HiSeq X with 150 bp paired end reads, multiplexing 384 samples per lane, and achieving average depth of coverage of 40-fold. We used Kraken, which accurately assigns taxonomic labels to the short DNA reads [<xref rid="c18" ref-type="bibr">18</xref>], to confirm the presence of <italic>E. coli</italic> reads in the pool. The raw sequences for the sequenced data in this study have been deposited in the European Nucleotide Archive (ENA) under the accession numbers described in Supplemental Table S1. The assembled data is available in the repository (<ext-link ext-link-type="uri" xlink:href="http://www.github.com/DaneshMoradigaravand/PanPred">www.github.com/DaneshMoradigaravand/PanPred</ext-link>).</p>
</sec>
<sec id="s2d">
<title>Pan-genome determination</title>
<p>Paired-end reads for the isolates sequenced both here and previously were assembled with Velvet [<xref rid="c19" ref-type="bibr">19</xref>] and put through an improvement pipeline [<xref rid="c20" ref-type="bibr">20</xref>]. In order to reconstruct the pan-genome, we used the output assemblies and annotated these with Prokka [<xref rid="c21" ref-type="bibr">21</xref>]. The annotated assemblies produced by Prokka were then used as input for Roary [<xref rid="c22" ref-type="bibr">22</xref>] to build the pan-genomes with the identity cut-off of 95&#x0025;. Roary produced a matrix for the presence and absence of accessory genes. The variant sites (SNPs) in the core genome alignment were extracted with an in-house snp_sites tool (<ext-link ext-link-type="uri" xlink:href="http://www.github.com/sanger-pathogens/snp-sites">www.github.com/sanger-pathogens/snp-sites</ext-link>). To visualize the phylogenetic tree with the associated metadata, we used iTOL [<xref rid="c23" ref-type="bibr">23</xref>].</p>
</sec>
<sec id="s2e">
<title>Population structure calculation</title>
<p>We mapped the short reads to the reference EC958 genome sequence [<xref rid="c24" ref-type="bibr">24</xref>] as detailed in [<xref rid="c25" ref-type="bibr">25</xref>], and calculated the pairwise SNP distance (number of differing sites) for the core genome alignment of strains with functions in the ape package [<xref rid="c26" ref-type="bibr">26</xref>]. We identified clusters within the population using a distance-based method in the adegenet package [<xref rid="c27" ref-type="bibr">27</xref>]. We clustered sequences using the sequence distance metric with the adegenet package for all possible number of clusters from 1 to number of strains. Based on these clusterings, we constructed the population structure matrix S, where s<sub>ij</sub> = <italic>k</italic> if strain <italic>i</italic> belongs to cluster <italic>k</italic> in the clustering with at most <italic>j</italic> clusters.</p>
</sec>
<sec id="s2f">
<title>Simulated datasets</title>
<p>To evaluate the performance of prediction tools, we simulated pan-genomes with Scoary [<xref rid="c28" ref-type="bibr">28</xref>]. The simulation process begins with a single genome with 3000 core and 6000 accessory genes that undergoes duplication and gene loss/gain in every generation, and continues until a desired number of genomes is reached; we tested population sizes of 130, 260, 650 and 1300. We examined penetrances, defined as the probability of acquisition/loss of the resistance phenotype simultaneously to the acquisition/loss of the causal resistance gene, of 0.5, 0.6, 0.7, 0.8, 0.9 and 1.</p>
</sec>
<sec id="s2g">
<title>Feature calculation</title>
<p>We examined different predictors as inputs: 1) matrix of the presence-absence of accessory genomes within the pan-genome (G), where g<sub>ij</sub> is 1 if gene <italic>i</italic> is present in strain <italic>j</italic>, and 0 otherwise; 2) matrix of population structure inferred from core-genome (S) defined above, and one-hot encoded 3) matrix of SNP sites (SNP), where SNP<sub>ij</sub> = 0 if strain <italic>j</italic> carries the ancestral allele at site <italic>i</italic>, and 1, 2, 3, 4, 5 if it contained A, T, C, G nucleotide or missing information, respectively; and 4) matrix of years of isolation (Y). We standardized each feature to have 0 mean and unit variance. Genes, strain clusters, and SNPs with identical indicator pattern were collapsed, so there are no duplicate rows in the G, S, or SNP matrices.</p>
</sec>
<sec id="s2h">
<title>Resistance prediction</title>
<p>We performed prediction using various combinations of input predictor matrices using resistance indicator as the output. We used 70&#x0025; of the data for training the various models, and used the F1 score (harmonic mean of precision and recall) for resistance classification to evaluate them model on the remaining 30&#x0025;. Four different models were used along with a baseline:</p>
<p>- Logistic regression with L<sub>2</sub> regularization. We employed the &#x201C;LogisticRegression&#x201D; function in the Scikit-learn python package (<ext-link ext-link-type="uri" xlink:href="http://www.scikit-learn.org">www.scikit-learn.org</ext-link>) [<xref rid="c36" ref-type="bibr">36</xref>], with the &#x201C;lbfgs&#x201D; solver, and varied the regularization parameter strength from 0 to 1 with step size 0.01.</p>
<p>- Random forest classifier. We employed the &#x201C;RandomForestClassifier&#x201D; function in Scikit-learn and varied the number of trees in the forest (100, 300 and 600). When searching for the best split, we used both square root and binary logarithm selection of the number of features. We used bootstrap samples for building trees, out-of-bag samples to estimate accuracy, Gini impurity as the criterion for the information gain, and trained until all leaves were pure.</p>
<p>- Gradient boosted decision trees. We used the &#x201C;GradientBoostingClassifier&#x201D; implementation in Scikit-learn, with learning rate 0.1, and 100, 300 and 600 boosting stages. We used the same methods as for the random forests for choosing the number of features when selecting for the best split, and employed the deviance loss function. We limited the maximum depth of trees to 3, and the minimum number of samples required to split an internal or leaf node to 2 and 1, respectively. In order to assess the robustness of feature importance analysis, we repeated the optimization with 50 random seeds. As a measure for feature importance, we counted the number of times a feature used in optimization, as well as the average feature rank and importance across multiple replica.</p>
<p>- Deep neural networks. We employed the keras library in python (<ext-link ext-link-type="uri" xlink:href="http://www.keras.io">www.keras.io</ext-link>) to build fully connected deep neural networks. We tested two and four layer networks, with two output nodes corresponding to resistant and susceptible states, and 200, 300 and 400 nodes in each internal layer. We used Adam to train for 20 epochs, with batch size of 128, learning rate of 0.1, drop-out of 0, 0.1 or 0.3, and stopping when the validation set performance decreased. Due to the small training dataset size compared to the number of features, for &#x223C;50&#x0025; of runs the loss in the validation did not decrease by the end of training the network. We randomly partitioned the data into training (56&#x0025;), validation (14&#x0025;) and test (30&#x0025;) sets, and trained models with different parameters on the training set, evaluated quality on the validation set, and final performance on the test set.</p>
<p>- Rule-based baseline. We compared our results with a rule-based method based on the detection of known resistance genes. To this end, we employed srst2 [<xref rid="c29" ref-type="bibr">29</xref>] and mapped short reads to the ResFinder database of known resistance genes in the srst2 package, using the cut-off of 60&#x0025; for the length coverage.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<p>Our data comprise 1936 samples that have been full genome sequenced, and phenotyped for resistance of 11 antibiotics. Resistance was distributed both within specific clades as well as emerging sporadically on divergent lineages (Figure S1), with an average frequency of 0.35 per drug (range: 0.15-0.63). This pattern is suggestive of both vertical and horizontal spread of resistance determinants. Genome sequences were processed to give gene and polymorphism presence information (1,390 core genes present in &#x003E;99&#x0025; of lineages, 90,261 genes present in one than one lineage, 1,432,145 variable sites in core genes), and 1,071 population structure features.</p>
<p>We used these predictors to test the ability of four machine learning models - logistic regression, random forests, gradient boosted decision trees, and deep neural networks - to predict antibiotic resistance. We varied model hyperparameters, as well as input data types, to establish the best-in-class predictors according to the F1 score for resistance (Methods). Gradient boosted decision trees performed best for predicting resistance of 11/11, and susceptibility of 10/11 drugs (<xref rid="fig1" ref-type="fig">Figure 1</xref>), with average precision of 0.93 and recall of 0.83 (Figure S2). Perhaps surprisingly, deep learning models that account for complex non-linear relations amongst features did not provide substantial improvement over the simpler logistic regression models, or random forests (<xref rid="fig1" ref-type="fig">Figure 1</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Prediction performance of the best tuned models.</title>
<p>F1 score (harmonic mean of precision and recall; y-axis) for resistant (top panel) and susceptible (middle panel) phenotypes for four predictive models (red: gradient boosted decision trees; green: logistic regression; teal: random forests; purple: deep learning) across eleven antibiotics (x-axis). The best model of each class for every drug (x-axis) was identified based on the F1 score for resistance and employed a number of possible combinations of gene presence, population structure, and year of isolation (lower panel; black: feature used; white: feature not used).</p></caption>
<graphic xlink:href="338194_fig1.tif"/>
</fig>
<p>Knowledge of what features that aid prediction will help prioritize data collection and diagnostic efforts. The gene presence and absence predictor (G) was used in all the best predictive models for each of the considered methods (<xref rid="fig1" ref-type="fig">Figure 1</xref>; lower panel). This is not surprising, given multiple known resistance mechanisms driven by accessory gene content, e.g. for beta-lactams and aminoglycosides. Population structure information (S) and year of isolation data (Y) were also frequently beneficial (used in 26 and 34 out of 44 best models, respectively). Adding gene presence to population structure features improved F1 score by 0.12 on average (Figure S3). In contrast, once gene presence had been accounted for, there was limited performance gain when including population structure features (Figure S3). This suggests that accessory gene content already contains information about population structure, which reflects the pattern of polymorphisms in the core genome. Indeed, core genome distance and accessory gene difference matrices are not independent (p &#x003C; 0.01, Mantel test), which is likely explained by accessory genes acquired by clade ancestors, followed by limited turnover.</p>
<p>Next, we asked which individual features are most frequently utilized. We measured feature importance as the number of times it was used for gradient boosted decision trees, the best performing method, across 50 random fitting replicates on fixed training date (Figure S4). Overall, only an average 3&#x0025; of input features (653 of 17198) were used at all in prediction across different drugs. In general, known resistance genes were identified as the most important, and were most frequently used features for predicting resistance to beta-lactams and aminoglycosides, e.g. <italic>blaOXA-2, blaTEM-1, blaCTX-M-15</italic>, and extra copies of <italic>ampC</italic> and <italic>phnP</italic> efflux pump genes (Supplemental Table S2). For example, the known beta-lactamase <italic>bla-CTX-M</italic> gene ranked first in all models for predicting resistance to beta-lactam ceftazidime, which followed by some genes with unknown function and <italic>ampC</italic> (Figure S4A). Perhaps surprisingly, we found that while the year of isolation was a dispensable feature for nearly all drugs, it was deemed important for ampicillin resistance prediction (Figure S4B). This was explained by the temporal distribution of the data, where all the strains collected in 2015 were resistant. These findings demonstrate that although known resistance genes were most predictive, other features, i.e. population structure and year of isolation, may be reproducibly used for prediction as well (Figure S4B). Nevertheless, it is clear that the inclusion of some features, such as collection year, reflects bias in the training data rather than biological importance.</p>
<p>Population structure information was often selected for use in the best performing models, and therefore useful for prediction (<xref rid="fig1" ref-type="fig">Figure 1</xref>). Indeed, training only on population structure produced an average F1 score of 0.73 (range: 0.23-0.92), and this performance could not be achieved with randomized phenotypes (Figure S5). Population structure features capture both recently diverged and deep clades (<xref rid="fig2" ref-type="fig">Figure 2A</xref>), and features included in the models were not limited to a single lineage or common depth (for example <xref rid="fig2" ref-type="fig">Figure 2B</xref>). As an example, the CL136 feature, which is the most important identified feature, distinguishes clusters by positing a maximum pairwise sequence distance between isolates of 136 nucleotides. Cluster membership at this level of similarity informs of resistance, as 85&#x0025; of clusters with at least two strains contained either only resistant or only susceptible strains (<xref rid="fig2" ref-type="fig">Figure 2C</xref>). In these cases, resistance status of an ancestral strain of the clades was likely retained in descendants and did not change due to horizontal gene transfer, mutation, or sporadic gene loss. Altogether, the results show that predictive models can utilize genetic relatedness and population structure for predicting resistance, as has been observed in traditional eukaryotic genetics [<xref rid="c8" ref-type="bibr">8</xref>].</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Population structure and phenotypic distribution of the input data.</title>
<p>A) Phylogenetic distribution of clusters identified in the population for SNP distance cut-off values of 2, 143, 5054 and 14489 (outer circles) relative to the phylogenetic tree. B) Phylogenetic distribution of correct calls (true positives, true negatives) and errors (false positives, false negatives) when predicting cephalothin (CET) resistance with the best performing gradient boosted model. The F1 score for resistance was 0.81. C) Phylogenetic distribution of the most important identified population structure feature, clustering with SNP cut-off of 136 (outer ring), compared with the phylogenetic distribution of resistance phenotype (inner ring; blue: susceptible; red: resistant).</p></caption>
<graphic xlink:href="338194_fig2.tif"/>
</fig>
<p>While the major mechanism for evolving antibiotic resistance is gene acquisition, mutations on chromosomes may also play a role, and therefore aid prediction. We thus next included single nucleotide polymorphism (SNP) data for gradient boosted decision trees, re-fitted hyperparameters, and evaluated on held out data. Predictive performance improved for four of the 11 antibiotics (Figure S3B). As anticipated, the largest improvement of 7.6&#x0025; occurred for ciprofloxacin, resistance against which is known to involve chromosomal mutations [<xref rid="c30" ref-type="bibr">30</xref>, <xref rid="c31" ref-type="bibr">31</xref>]. Accordingly, the three most important identified features were variants in chromosomal quinolone-resistance-determining regions of the genes encoding DNA gyrase (<italic>gyrA</italic>), and topoisomerase IV <italic>parC</italic>. For other antibiotics, the addition of SNP data either did not greatly improve or worsened prediction performance (Figure S3B, Discussion).</p>
<p>A possible limitation for applying machine learning methods to detect antibiotic resistance is the unavoidably small number of samples (1,936 in this study) compared to the number of features (&#x223C;18,270 in this study after collapsing the fully correlated features). To better understand how this imbalance impacts performance, we simulated data from different sample sizes using a range of penetrances for a single resistance determinant. As anticipated, the performance of gradient boosted decision trees dropped when the penetrance of the resistance determinant decreased (Figure S6). However, there was no reduction in F1 score upon decreasing the population size, even when using only 130 strains. Overall, these findings suggest that the large number of features relative to sample size does not impact model performance for high frequency causal genes.</p>
<p>The current clinical standards employ rule-based models to predict resistance from a small number of known determinants. We used <italic>srst2</italic> [<xref rid="c29" ref-type="bibr">29</xref>] to identify known resistance genes for cephalosporins, penicillins, aminoglycosides and trimethoprim (<xref rid="tbl2" ref-type="table">Table 2</xref>), and used this information to better understand prediction errors. The best model&#x2019;s false positive resistance calls for different antibiotics contained 2 or 33 isolates that carried known resistance genes (beta-lactams, aminoglycoside modifying enzymes and <italic>dfr</italic> genes), but were annotated as susceptible. Manual inspection confirmed that all of these genes were fully covered by sequence data, and almost identical to the known resistance genes. Moreover, for different antibiotics, one to nine false negative resistance calls (36 total) did not contain a known causal determinant. Similarly, two to nine resistant strains (51 total) were correctly marked as resistant by our model, but contained no known resistance gene (<xref rid="tbl2" ref-type="table">Table 2</xref>). These discrepancies may be explained by either resistance testing error, genomic sequence quality, or unknown mechanisms for resistance. As neither approach was perfect, predictive models in combination with rule-based methods may help identify cases that necessitate further analysis or repeating the susceptibility tests, ultimately leading to improved diagnostics and novel mechanisms.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><p>Prediction metrics on held out data for the best performing gradient boosted decision trees model. TN: true negatives, FN: false negatives, FP: false positives, TP: true positives, PRC: precision, RCL: recall, S: susceptibility, R: resistance.</p></caption>
<graphic xlink:href="338194_tbl1.tif"/>
</table-wrap>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>Comparison of prediction results with a rule-based model, srst2. True positives (TP), false positives (FP) and false negatives (FN) from <xref rid="tbl1" ref-type="table">Table 1</xref>. Resistant genes were identified by srst2 using the Resfinder database. Since ciprofloxacin resistance is caused by chromosomal mutations, we have not included this antibiotic in the table.</p></caption>
<graphic xlink:href="338194_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>We examined the ability of four different machine learning methods to predict antibiotic resistance from genomic information in <italic>E.coli</italic>, without making assumptions about the underlying genetic mechanisms. Our tests revealed that accessory genome data is needed for high accuracy in general, but that population structure information can also aid prediction.</p>
<p>Our input dataset was diverse. The collection comprised seven sequence types and strains from 15 consecutive years across a range of geographical locations. The majority of isolates (1509 of 1936 samples) were from a nationwide study across hospitals in the United Kingdom and Ireland [<xref rid="c15" ref-type="bibr">15</xref>], and associated with bacteremia. This geographical bias is not expected to affect the performance of the model on a new clinical dataset, since <italic>E. coli</italic> sequence types (e.g. ST131 clone [<xref rid="c32" ref-type="bibr">32</xref>]) are circulated across hospitals worldwide. However, as isolates from potential reservoirs, including hospital sewage and wastewater treatment plants, were underrepresented in training data (99 of 1936 samples), we cannot conclusively assess how well the trained models detect resistance in samples from these sources. More data are needed to develop robust models across the entire species range, especially if resistance mechanisms differ in the various niches.</p>
<p>The phenotype data was binary - each isolate was deemed either resistant or not to a compound. It is clear that this is an oversimplification of reality, as substantial variation hides within both categories. As the resistance phenotype is directly exposed to selection, it will influence how quickly it spreads within and between patients, as well as in bacterial populations at large. To predict treatment outcomes, correctly design interventions and allocate societal resources, it will therefore be important to be able to accurately predict resistance quantitatively as well. This requires non-binary resistance data, acquired at high accuracy and throughput.</p>
<p>Our findings confirm the utility of ensemble methods, and in particular boosting models, for predicting antibiotic resistance. While deep learning models are able to capture higher order interactions between features, and therefore often outperform simpler alternatives [<xref rid="c37" ref-type="bibr">37</xref>], they did not provide additional advantage here. Tree-based methods are often used as an intermediate between simple models that treat features independently, like logistic regression, and more complex, but poorly interpretable models. Indeed, random forest readouts can be analysed for feature importance as we have done here, and even detecting genetic interactions (e.g. [<xref rid="c33" ref-type="bibr">33</xref>, <xref rid="c34" ref-type="bibr">34</xref>]). However, as for association methods [<xref rid="c28" ref-type="bibr">28</xref>, <xref rid="c35" ref-type="bibr">35</xref>], the true impact of genetic features is confounded by their phylogenetic distribution and population structure. Therefore, approaches to distinguish causal resistance genes from all correlated markers require additional experimental study.</p>
<p>Recent reports have confirmed the strength of tree-based methods for predicting clinical attributes. For example, Wheeler <italic>et al</italic>. used random forests to predict invasiveness of <italic>Salmonella enterica</italic> lineages [<xref rid="c14" ref-type="bibr">14</xref>]. In another study, a tree ensemble was trained with boosting to predict the minimum inhibitory concentration from DNA k-mers for a large-scale <italic>Klebsiella pneumoniae</italic> panel [<xref rid="c10" ref-type="bibr">10</xref>], but the value of using core genome compared to accessory genes was not investigated. In general, including variant data or k-mers in the model greatly increases the number of features. However, adding the &#x223C;1 million additional single nucleotide features to &#x223C;20,000 others did not improve the results for most drugs in our dataset. This suggests that only pan-genome data could be used in early screenings for resistance, and including nucleotide-level information will be more beneficial in a limited form, once causality is established for a broader range of SNPs.</p>
<p>Many factors can affect the performance of a predictive model. For instance, we noted that amongst the antibiotics, the results were worst for amoxicillin-clavulanate. This might be due to a beta-lactamase inhibitor, which dominates the impact of a resistance gene, causing susceptibility, and resulting in a wrong prediction. The genome-based prediction also cannot account for non-genomic resistance mechanisms, such as high expression level of resistance genes. Consequently, future models should assess the value of even broader data for accurate prediction, ranging from transcriptome and proteome to other clinical and epidemiological data, such as cross-resistance and history of antibiotic therapy. Integrating these information sources from large isolate panels into a single predictive framework will lead to a rational basis for decision-making in public health to reduce cost of diagnoses and treatments.</p>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Holmes</surname> <given-names>AH</given-names></string-name>, <string-name><surname>Moore</surname> <given-names>LS</given-names></string-name>, <string-name><surname>Sundsfjord</surname> <given-names>A</given-names></string-name>, <string-name><surname>Steinbakk</surname> <given-names>M</given-names></string-name>, <string-name><surname>Regmi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Karkey</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Understanding the mechanisms and drivers of antimicrobial resistance</article-title>. <source>Lancet</source>. <year>2016</year>;<volume>387</volume>(<issue>10014</issue>):<fpage>176</fpage>&#x2013;<lpage>87</lpage>. Epub 2015/11/26. doi: <pub-id pub-id-type="doi">10.1016/S0140-6736(15)00473-0</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">26603922</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Sommer</surname> <given-names>MOA</given-names></string-name>, <string-name><surname>Munck</surname> <given-names>C</given-names></string-name>, <string-name><surname>Toft-Kehler</surname> <given-names>RV</given-names></string-name>, <string-name><surname>Andersson</surname> <given-names>DI</given-names></string-name>. <article-title>Prediction of antibiotic resistance: time for a new preclinical paradigm?</article-title> <source>Nat Rev Microbiol</source>. <year>2017</year>;<volume>15</volume>(<issue>11</issue>):<fpage>689</fpage>&#x2013;<lpage>96</lpage>. Epub 2017/08/02. doi: <pub-id pub-id-type="doi">10.1038/nrmicro.2017.75</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">28757648</pub-id>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Burnham</surname> <given-names>CD</given-names></string-name>, <string-name><surname>Leeds</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nordmann</surname> <given-names>P</given-names></string-name>, <string-name><surname>O&#x2019;Grady</surname> <given-names>J</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>J.</given-names></string-name> <article-title>Diagnosing antimicrobial resistance</article-title>. <source>Nat Rev Microbiol</source>. <year>2017</year>;<volume>15</volume>(<issue>11</issue>):<fpage>697</fpage>&#x2013;<lpage>703</lpage>. Epub 2017/10/13. doi: <pub-id pub-id-type="doi">10.1038/nrmicro.2017.103</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">29021600</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>McArthur</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Waglechner</surname> <given-names>N</given-names></string-name>, <string-name><surname>Nizam</surname> <given-names>F</given-names></string-name>, <string-name><surname>Yan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Azad</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Baylay</surname> <given-names>AJ</given-names></string-name>, <etal>et al.</etal> <article-title>The comprehensive antibiotic resistance database</article-title>. <source>Antimicrob Agents Chemother</source>. <year>2013</year>;<volume>57</volume>(<issue>7</issue>):<fpage>3348</fpage>&#x2013; <lpage>57</lpage>. Epub 2013/05/08. doi: <pub-id pub-id-type="doi">10.1128/AAC.00419-13</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">23650175</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC3697360</pub-id>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Zankari</surname> <given-names>E</given-names></string-name>, <string-name><surname>Hasman</surname> <given-names>H</given-names></string-name>, <string-name><surname>Cosentino</surname> <given-names>S</given-names></string-name>, <string-name><surname>Vestergaard</surname> <given-names>M</given-names></string-name>, <string-name><surname>Rasmussen</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lund</surname> <given-names>O</given-names></string-name>, <etal>et al.</etal> <article-title>Identification of acquired antimicrobial resistance genes</article-title>. <source>J Antimicrob Chemother</source>. <year>2012</year>;<volume>67</volume>(<issue>11</issue>):<fpage>2640</fpage>&#x2013;<lpage>4</lpage>. doi: <pub-id pub-id-type="doi">10.1093/jac/dks261</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">22782487</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC3468078</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Stoesser</surname> <given-names>N</given-names></string-name>, <string-name><surname>Batty</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Eyre</surname> <given-names>DW</given-names></string-name>, <string-name><surname>Morgan</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wyllie</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Del Ojo Elias</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <article-title>Predicting antimicrobial susceptibilities for Escherichia coli and Klebsiella pneumoniae isolates using whole genomic sequence data</article-title>. <source>J Antimicrob Chemother</source>. <year>2013</year>;<volume>68</volume>(<issue>10</issue>):<fpage>2234</fpage>&#x2013;<lpage>44</lpage>. Epub 2013/06/01. doi: <pub-id pub-id-type="doi">10.1093/jac/dkt180</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">23722448</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC3772739</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Martens</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hallin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Warringer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liti</surname> <given-names>G</given-names></string-name>, <string-name><surname>Parts</surname> <given-names>L.</given-names></string-name> <article-title>Predicting quantitative traits from genome and phenome with near perfect accuracy</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>11512</fpage>. Epub 2016/05/11. doi: <pub-id pub-id-type="doi">10.1038/ncomms11512</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27160605</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4866306</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Hallin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Martens</surname> <given-names>K</given-names></string-name>, <string-name><surname>Young</surname> <given-names>AI</given-names></string-name>, <string-name><surname>Zackrisson</surname> <given-names>M</given-names></string-name>, <string-name><surname>Salinas</surname> <given-names>F</given-names></string-name>, <string-name><surname>Parts</surname> <given-names>L</given-names></string-name>, <etal>et al.</etal> <article-title>Powerful decomposition of complex traits in a diploid model</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>13311</fpage>. Epub 2016/11/03. doi: <pub-id pub-id-type="doi">10.1038/ncomms13311</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27804950</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5097135</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Galardini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Koumoutsi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Herrera-Dominguez</surname> <given-names>L</given-names></string-name>, <string-name><surname>Cordero Varela</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Telzerow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wagih</surname> <given-names>O</given-names></string-name>, <etal>et al.</etal> <article-title>Phenotype inference in an Escherichia coli strain panel</article-title>. <source>eLife</source>. <year>2017</year>;<volume>6</volume>. Epub 2017/12/28. doi: <pub-id pub-id-type="doi">10.7554/eLife.31035</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">29280730</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5745082</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname> <given-names>M</given-names></string-name>, <string-name><surname>Brettin</surname> <given-names>T</given-names></string-name>, <string-name><surname>Long</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Musser</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Olsen</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Olson</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title>Developing an in silico minimum inhibitory concentration panel test for Klebsiella pneumoniae</article-title>. <source>Sci Rep</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>421</fpage>. Epub 2018/01/13. doi: <pub-id pub-id-type="doi">10.1038/s41598-017-18972-w</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">29323230</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5765115</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Pesesky</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Hussain</surname> <given-names>T</given-names></string-name>, <string-name><surname>Wallace</surname> <given-names>M</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>S</given-names></string-name>, <string-name><surname>Andleeb</surname> <given-names>S</given-names></string-name>, <string-name><surname>Burnham</surname> <given-names>CD</given-names></string-name>, <etal>et al.</etal> <article-title>Evaluation of Machine Learning and Rules-Based Approaches for Predicting Antimicrobial Resistance Profiles in Gram-negative Bacilli from Whole Genome Sequence Data</article-title>. <source>Front Microbiol</source>. <year>2016</year>;<volume>7</volume>:<fpage>1887</fpage>. Epub 2016/12/15. doi: <pub-id pub-id-type="doi">10.3389/fmicb.2016.01887</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27965630</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5124574</pub-id>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Antonopoulos</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Assaf</surname> <given-names>R</given-names></string-name>, <string-name><surname>Aziz</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Brettin</surname> <given-names>T</given-names></string-name>, <string-name><surname>Bun</surname> <given-names>C</given-names></string-name>, <string-name><surname>Conrad</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>PATRIC as a unique resource for studying antimicrobial resistance</article-title>. <source>Brief Bioinform</source>. <year>2017</year>. Epub 2017/10/03. doi: <pub-id pub-id-type="doi">10.1093/bib/bbx083</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">28968762</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Rahman</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Olm</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Morowitz</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Banfield</surname> <given-names>JF</given-names></string-name>. <article-title>Machine Learning Leveraging Genomes from Metagenomes Identifies Influential Antibiotic Resistance Genes in the Infant Gut Microbiome</article-title>. <source>mSystems</source>. <year>2018</year>;<volume>3</volume>(<issue>1</issue>). Epub 2018/01/24. doi: <pub-id pub-id-type="doi">10.1128/mSystems.00123-17</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">29359195</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5758725</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Wheeler</surname> <given-names>NE</given-names></string-name>, <string-name><surname>Gardner</surname> <given-names>PP</given-names></string-name>, <string-name><surname>Barquist</surname> <given-names>L.</given-names></string-name> <article-title>Machine learning identifies signatures of host adaptation in the bacterial pathogen Salmonella enterica</article-title>. <source>PLoS Genet</source>. <year>2018</year>;<volume>14</volume>(<issue>5</issue>):<fpage>e1007333</fpage>. Epub 2018/05/09. doi: <pub-id pub-id-type="doi">10.1371/journal.pgen.1007333</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">29738521</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Kallonen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Brodrick</surname> <given-names>HJ</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Corander</surname> <given-names>J</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>V</given-names></string-name>, <etal>et al.</etal> <article-title>Systematic longitudinal survey of invasive Escherichia coli in England demonstrates a stable population structure only transiently disturbed by the emergence of ST131</article-title>. <source>Genome Res</source>. <year>2017</year>. doi: <pub-id pub-id-type="doi">10.1101/gr.216606.116</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">28720578</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5538559</pub-id>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Runcharoen</surname> <given-names>C</given-names></string-name>, <string-name><surname>Raven</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kallonen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Paksanont</surname> <given-names>S</given-names></string-name>, <string-name><surname>Thammachote</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Whole genome sequencing of ESBL-producing Escherichia coli isolated from patients, farm waste and canals in Thailand</article-title>. <source>Genome Med</source>. <year>2017</year>;<volume>9</volume>(<issue>1</issue>):<fpage>81</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13073-017-0471-8</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">28877757</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5588602</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Datsenko</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Wanner</surname> <given-names>BL</given-names></string-name>. <article-title>One-step inactivation of chromosomal genes in Escherichia coli K-12 using PCR products</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2000</year>;<volume>97</volume>(<issue>12</issue>):<fpage>6640</fpage>&#x2013;<lpage>5</lpage>. Epub 2000/06/01. doi: <pub-id pub-id-type="doi">10.1073/pnas.120163297</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">10829079</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC18686</pub-id>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Wood</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Salzberg</surname> <given-names>SL</given-names></string-name>. <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>R46</fpage>. Epub 2014/03/04. doi: <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">24580807</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4053813</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Zerbino</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Birney</surname> <given-names>E.</given-names></string-name> <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>(<issue>5</issue>):<fpage>821</fpage>&#x2013;<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">18349386</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC2336801</pub-id>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>De Silva</surname> <given-names>N</given-names></string-name>, <string-name><surname>Hunt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Quail</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <etal>et al.</etal> <article-title>Robust high-throughput prokaryote de novo assembly and improvement pipeline for Illumina data</article-title>. <source>Microb Genom</source>. <year>2016</year>;<volume>2</volume>(<issue>8</issue>):<fpage>e000083</fpage>. doi: <pub-id pub-id-type="doi">10.1099/mgen.0.000083</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">28348874</pub-id>; PubMed Central <pub-id pub-id-type="pmid">PMCID: PMCPMC5320598</pub-id>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Seemann</surname> <given-names>T.</given-names></string-name> <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>14</issue>):<fpage>2068</fpage>&#x2013;<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">24642063</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Cummins</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wong</surname> <given-names>VK</given-names></string-name>, <string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MT</given-names></string-name>, <etal>et al.</etal> <article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>22</issue>):<fpage>3691</fpage>&#x2013;<lpage>3</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btv421</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">26198102</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4817141</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Letunic</surname> <given-names>I</given-names></string-name>, <string-name><surname>Bork</surname> <given-names>P.</given-names></string-name> <article-title>Interactive tree of life (iTOL) v3: an online tool for the display and annotation of phylogenetic and other trees</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W242</fpage>&#x2013;<lpage>5</lpage>. Epub 2016/04/21. doi: <pub-id pub-id-type="doi">10.1093/nar/gkw290</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27095192</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4987883</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Forde</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Ben Zakour</surname> <given-names>NL</given-names></string-name>, <string-name><surname>Stanton-Cook</surname> <given-names>M</given-names></string-name>, <string-name><surname>Phan</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Totsika</surname> <given-names>M</given-names></string-name>, <string-name><surname>Peters</surname> <given-names>KM</given-names></string-name>, <etal>et al.</etal> <article-title>The complete genome sequence of Escherichia coli EC958: a high quality reference sequence for the globally disseminated multidrug resistant E. coli O25b:H4-ST131 clone</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e104400</fpage>. Epub 2014/08/16. doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0104400</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">25126841</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4134206</pub-id>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Moradigaravand</surname> <given-names>D</given-names></string-name>, <string-name><surname>Boinett</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>V</given-names></string-name>, <string-name><surname>Peacock</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J.</given-names></string-name> <article-title>Recent independent emergence of multiple multidrug-resistant Serratia marcescens clones within the United Kingdom and Ireland</article-title>. <source>Genome Res</source>. <year>2016</year>;<volume>26</volume>(<issue>8</issue>):<fpage>1101</fpage>&#x2013;<lpage>9</lpage>. Epub 2016/07/20. doi: <pub-id pub-id-type="doi">10.1101/gr.205245.116</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27432456</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4971767</pub-id>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Paradis</surname> <given-names>E</given-names></string-name>, <string-name><surname>Claude</surname> <given-names>J</given-names></string-name>, <string-name><surname>Strimmer</surname> <given-names>K.</given-names></string-name> <article-title>APE: Analyses of Phylogenetics and Evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>&#x2013;<lpage>90</lpage>. Epub 2004/01/22. PubMed PMID: <pub-id pub-id-type="pmid">14734327</pub-id>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Jombart</surname> <given-names>T.</given-names></string-name> <article-title>adegenet: a R package for the multivariate analysis of genetic markers</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>11</issue>):<fpage>1403</fpage>&#x2013;<lpage>5</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btn129</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">18397895</pub-id>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Brynildsrud</surname> <given-names>O</given-names></string-name>, <string-name><surname>Bohlin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Scheffer</surname> <given-names>L</given-names></string-name>, <string-name><surname>Eldholm</surname> <given-names>V.</given-names></string-name> <article-title>Rapid scoring of genes in microbial pan-genome-wide association studies with Scoary</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>238</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-016-1108-8</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27887642</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5124306</pub-id>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Inouye</surname> <given-names>M</given-names></string-name>, <string-name><surname>Conway</surname> <given-names>TC</given-names></string-name>, <string-name><surname>Zobel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Holt</surname> <given-names>KE</given-names></string-name>. <article-title>Short read sequence typing (SRST): multi-locus sequence types from short reads</article-title>. <source>Bmc Genomics</source>. <year>2012</year>;<volume>13</volume>:<fpage>338</fpage>. doi: <pub-id pub-id-type="doi">10.1186/1471-2164-13-388</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">22827703</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC3460743</pub-id>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Moon</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Seol</surname> <given-names>SY</given-names></string-name>, <string-name><surname>Gurung</surname> <given-names>M</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Choi</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Emergence of a new mutation and its accumulation in the topoisomerase IV gene confers high levels of resistance to fluoroquinolones in Escherichia coli isolates</article-title>. <source>Int J Antimicrob Agents</source>. <year>2010</year>;<volume>35</volume>(<issue>1</issue>):<fpage>76</fpage>&#x2013;<lpage>9</lpage>. Epub 2009/09/29. doi: <pub-id pub-id-type="doi">10.1016/j.ijantimicag.2009.08.003</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">19781915</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Jacoby</surname> <given-names>GA</given-names></string-name>. <article-title>Mechanisms of resistance to quinolones</article-title>. <source>Clin Infect Dis</source>. <year>2005</year>;<volume>41</volume> Suppl <issue>2</issue>:<fpage>S120</fpage>&#x2013;<lpage>6</lpage>. Epub 2005/06/09. doi: <pub-id pub-id-type="doi">10.1086/428052</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">15942878</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Nicolas-Chanoine</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Bertrand</surname> <given-names>X</given-names></string-name>, <string-name><surname>Madec</surname> <given-names>JY</given-names></string-name>. <article-title>Escherichia coli ST131, an intriguing clonal group</article-title>. <source>Clin Microbiol Rev</source>. <year>2014</year>;<volume>27</volume>(<issue>3</issue>):<fpage>543</fpage>&#x2013;<lpage>74</lpage>. Epub 2014/07/02. doi: <pub-id pub-id-type="doi">10.1128/CMR.00125-13</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">24982321</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4135899</pub-id>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Stephan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Stegle</surname> <given-names>O</given-names></string-name>, <string-name><surname>Beyer</surname> <given-names>A.</given-names></string-name> <article-title>A random forest approach to capture genetic effects in the presence of population structure</article-title>. <source>Nat Commun</source>. <year>2015</year>;<volume>6</volume>:<fpage>7432</fpage>. Epub 2015/06/26. doi: <pub-id pub-id-type="doi">10.1038/ncomms8432</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">26109276</pub-id>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>J</given-names></string-name>, <string-name><surname>Malley</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Andrew</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Karagas</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Moore</surname> <given-names>JH</given-names></string-name>. <article-title>Detecting gene-gene interactions using a permutation-based random forest method</article-title>. <source>BioData Min</source>. <year>2016</year>;<volume>9</volume>:<fpage>14</fpage>. Epub 2016/04/08. doi: <pub-id pub-id-type="doi">10.1186/s13040-016-0093-5</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27053949</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC4822295</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Lees</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Vehkala</surname> <given-names>M</given-names></string-name>, <string-name><surname>Valimaki</surname> <given-names>N</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Chewapreecha</surname> <given-names>C</given-names></string-name>, <string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <etal>et al.</etal> <article-title>Sequence element enrichment analysis to determine the genetic basis of bacterial phenotypes</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>12797</fpage>. Epub 2016/09/17. doi: <pub-id pub-id-type="doi">10.1038/ncomms12797</pub-id>. PubMed PMID: <pub-id pub-id-type="pmid">27633831</pub-id>; PubMed Central PMCID: <pub-id pub-id-type="pmcid">PMCPMC5028413</pub-id>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><collab>Pedregosa</collab> <etal>et al.</etal>, <article-title>Scikit-learn: Machine Learning in Python</article-title>, <source>JMLR</source> <volume>12</volume>, pp. <fpage>2825</fpage>&#x2013;<lpage>2830</lpage>, <year>2011</year></mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="other"><string-name><given-names>William</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>Kaur</given-names> <surname>Alasoo</surname></string-name>, <string-name><given-names>Dmytro</given-names> <surname>Fishman</surname></string-name>, <string-name><given-names>Leopold</given-names> <surname>Parts</surname></string-name>, <article-title>Computational biology: deep learning</article-title>, doi: <pub-id pub-id-type="doi">10.1042/ETLS20160025</pub-id>, <source>Emerging Topics in Life Sciences</source>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<title>Author Contributions</title>
<p>DM and LP designed the study framework. DM developed and implemented the model. LP, VM and JW supervised the project. MP and AF generated data. All authors read and approved the final manuscript. The authors have declared that no competing interests exist.</p>
</sec>
<sec id="s6">
<title>Funding information</title>
<p>This work was partially funded by a grant from the Centre for Antibiotic Resistance Research (CARe) at the University of Gothenburg to AF and grant number 2016-06503 from the Joint Programming Initiative on Antimicrobial Resistance (JPIAMR) to JW and AF. This work was in part supported by the Academy of Finland (grant 313270 to VM). LP was supported by Wellcome, and Estonian Research Council (IUT34-4). DM was supported by the Joint Programming Initiative on Antimicrobial Resistance (JPIAMR) via MRC grant MR/R004501/1. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
<ack>
<title>Acknowledgements</title>
<p>Christina &#x212B;hr&#x00E9;n, Nahid Karami, Carl-Fredrik Flach, Ed Moore (Culture Collection University of Gothenburg, CCUG), Jan Michiels and Marco Galardini are gratefully acknowledged for providing strains. Daniel Ja&#x00E9;n Luchoro, Fabrice E. Graf, Owens Uwangue and Viktor Garellick are gratefully acknowledged for technical assistance and helpful discussions.</p>
</ack>
</sec>
<sec id="s7" sec-type="supplementary-material">
<title>Supplemental Tables</title>
<p><bold>Supplemental Table S1: list of isolates with associated metadata and accession numbers in the European Nucleotide Archive (ENA).</bold></p>
<p><bold>Supplemental Table S2: List of important accessory genes and their functions for feature importance analysis with the best performing gradient boosted decision trees models shown in Figure S4. The importance metrics include the number of runs (total 50 runs), in which the feature was used during model optimization and the average ranking and importance for the feature in these runs.</bold></p>
</sec>
</back>
</article>
