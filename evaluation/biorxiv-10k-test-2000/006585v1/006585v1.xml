<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/006585</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>svaseq: removing batch effects and other unwanted noise from sequencing data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Leek</surname><given-names>Jeffrey T.</given-names></name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Correspondence to: <email>jtleek@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2014</year></pub-date>
<elocation-id>006585</elocation-id>
<history>
<date date-type="received">
<day>24</day>
<month>6</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>25</day>
<month>6</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2014, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2014</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="006585.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>It is now well known that unwanted noise and unmodeled artifacts such as batch effects can dramatically reduce the accuracy of statistical inference in genomic experiments. We introduced surrogate variable analysis for estimating these artifacts by (1) identifying the part of the genomic data only affected by artifacts and (2) estimating the artifacts with principal components or singular vectors of the subset of the data matrix. The resulting estimates of artifacts can be used in subsequent analyses as adjustment factors. Here I describe an update to the sva approach that can be applied to analyze count data or FPKMs from sequencing experiments. I also describe the addition of supervised sva (ssva) for using control probes to identify the part of the genomic data only affected by artifacts. These updates are available through the surrogate variable analysis (sva) Bioconductor package.</p>
</abstract>
<counts>
<page-count count="11"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label><title>Background</title>
<p>Batch effects and other technological artifacts introduce spurious correlation, create bias, and add variability to the results of genomic experiments [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>]. Unfortunately all the possible sources of bias are unknown in most high-throughput experiments [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>]. In some cases, it is possible to rely on the date the samples were processed as a surrogate for unmeasured artifacts [<xref ref-type="bibr" rid="c6">6</xref>]. However, each new technology may suffer from different artifacts and it may take time for the community to discover which variables must be measured and included in an analysis [<xref ref-type="bibr" rid="c7">7</xref>].</p>
<p>In 2007 we introduced surrogate variable analysis as a conceptual approach to statistical modeling of genomic data when artifacts are unknown or unmeasured [<xref ref-type="bibr" rid="c4">4</xref>] and subsequently improved the estimation algorithm [<xref ref-type="bibr" rid="c8">8</xref>] (<xref rid="fig1" ref-type="fig">Figure 1</xref>). The conceptual idea we proposed modeled the data as a combination of known variables of interest, known adjustment variables, and unknown and unmeasured artifacts. A simple version of this model might relate gene expression for gene <italic>i</italic> on sample <italic>j</italic> (<italic>g</italic><sub><italic>ij</italic></sub>) to the phenotype for that sample (<italic>y</italic><sub><italic>j</italic></sub>), the known batch variable for that sample (<italic>a</italic><sub><italic>j</italic></sub>) and an unknown artifact on that sample (<italic>u</italic><sub><italic>j</italic></sub>):
<disp-formula id="eqn1">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn1.gif"/></alternatives>
</disp-formula>
</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Surrogate variable analysis</title>
<p>The general surrogate variable analysis framework for identifying unknown artifacts in genomic data has three steps [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c8">8</xref>].</p></caption>
<graphic xlink:href="006585_fig1.tif"/>
</fig>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>General surrogate variable analysis estimation framework</title>
<p>In this general framework, Step 1 allows for transformations specific to different data types, Step 2 allows for either estimating or defining the probabilities of being affected by unknown artifacts but not known variables, and Step 4 allows for a variety of matrix decompositions and factor analysis approaches.</p></caption>
<graphic xlink:href="006585_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Approach for simulating RNA-seq data with Polyester package</title>
<p>[<xref ref-type="bibr" rid="c29">29</xref>].</p></caption>
<graphic xlink:href="006585_fig3.tif"/>
</fig>
<p>If only a single gene is measured, it is difficult to estimate the unknown artifact <italic>u</italic><sub><italic>j</italic></sub> from the data directly, since all the coefficients (<italic>b, c, d</italic>) are unknown. But we noticed [<xref ref-type="bibr" rid="c4">4</xref>] that if many genes are measured, it is possible that for some genes the coefficients for <italic>b</italic><sub>1<italic>i</italic></sub> and <italic>c<sub><italic>i</italic></sub></italic> may be equal to zero. For these specific genes the model reduces to:
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_ueqn1.gif"/></alternatives>
</disp-formula>
Our next insight was that even though <italic>d</italic><sub><italic>i</italic></sub> and <italic>u</italic><sub><italic>j</italic></sub> are unknown, you do not need to know either of them exactly to get correct statistical inference for the parameters for the phenotype variable <italic>b</italic><sub><italic>i</italic>1</sub>, you just have to know their linear combination <italic>d</italic><sub><italic>i</italic></sub> &#x00D7; <italic>u</italic><sub><italic>j</italic></sub> [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c8">8</xref>]. We showed that if you collect the data for all genes where there is no effect of phenotype or known batch (<italic>b</italic><sub>1<italic>i</italic></sub> &#x003D; 0 and <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0) and subtracted the mean of each gene to remove the baseline effect, the matrix form of the model for the data is:
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_ueqn2.gif"/></alternatives>
</disp-formula>
where <italic>m</italic><sub><italic>u</italic></sub> is the number of genes where <italic>b</italic><sub>1<italic>i</italic></sub> &#x003D; 0 and <italic>c</italic><sub><italic>i</italic></sub> &#x003D; 0 and <italic>n</italic> is the sample size. We then pointed out that you could apply a matrix decomposition like the singular value decomposition or principal components analysis to this subset of the data to estimate surrogates for <italic>G</italic> and <italic>u</italic>. Later we also showed that if the number of genes that were not affected by phenotype or known batch (<italic>b</italic><sub>1<italic>i</italic></sub> &#x003D; 0 and <italic>c</italic> &#x003D; 0) but were affected by unknown artifacts (<italic>d</italic><sub><italic>i</italic></sub> &#x2260; 0) was large enough, you can obtain consistent estimates of a linear transformation of <italic>g</italic><sub><italic>i</italic></sub> [<xref ref-type="bibr" rid="c9">9</xref>]. The surrogate variable analysis approach then proceeds in three steps:</p>
<p>In this paper I discuss two new extensions of the surrogate variable analysis approach for sequencing data inspired by the work of other groups. The first extension, which I call supervised surrogate variable analysis (ssva) was introduced by Gagnon-Bartsch and colleagues [<xref ref-type="bibr" rid="c5">5</xref>]. The idea is to perform Step of the surrogate variable analysis algorithm (<xref rid="fig1" ref-type="fig">Figure 1</xref>). The second idea, svaseq, uses a moderated log link in place of the identity link when estimating the surrogate variables in Steps 1-2. This is a simplified version of a similar extension of surrogate variable analysis first proposed by Risso and colleagues [<xref ref-type="bibr" rid="c10">10</xref>].</p>
</sec>
<sec id="s2">
<label>2</label><title>Methods</title>
<sec id="s2a">
<label>2.1</label><title>General form of the surrogate variable analysis mathematical model</title>
<p>The general form of the simple model in equation (<xref rid="eqn1" ref-type="disp-formula">1</xref>) is:
<disp-formula id="eqn2">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn2.gif"/></alternatives>
</disp-formula>
or in matrix form:
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_ueqn3.gif"/></alternatives>
</disp-formula>
where the function <italic>f</italic> () has been applied component wise to each element of <italic>G</italic> and there may be multiple phenotypes, artifacts, or unknown artifacts. The general surrogate variable analysis algorithm then proceeds in the following four concrete steps.</p>
</sec>
<sec id="s2b">
<label>2.2</label><title>Relationship of surrogate variable analysis to other approaches</title>
<p>The general form of the surrogate variable analysis algorithm relies on the idea that there is a subset of genes, probes, or transcripts that are affected by unknown heterogeneity but are not affected by the biological relationship of interest. This is the main way that a surrogate variable analysis approach is distinguished from a standard principal component regression. Standard principal component based regression methods, such as EIGENSTRAT [<xref ref-type="bibr" rid="c11">11</xref>], are sufficient when the number of probes, genes, or features expected to show a signal is small. Then the principal components will entirely capture artifacts and not the signal of interest.</p>
<p>A number of extensions and variations on the surrogate variable analysis algorithm have been introduced. For step one in the sva algorithm, identifying probes only associated with batch, it has been proposed to use control probes [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c10">10</xref>]. For step two of the sva algorithm, estimating latent factors only associated with dependence, it has been proposed to use factor analysis [<xref ref-type="bibr" rid="c12">12</xref>], independent components analysis [<xref ref-type="bibr" rid="c13">13</xref>], and principal components analysis [<xref ref-type="bibr" rid="c14">14</xref>]. Another extension of the surrogate variable approach in step two has been to model known sources of technical or biological covariation between the measurements for probes, for example in eQTL studies [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>].</p>
</sec>
<sec id="s2c">
<label>2.3</label><title>Supervised sva (ssva)</title>
<p>ySupervised sva (ssva) sets <italic>p</italic><sub><italic>i</italic></sub> &#x003D; 1 for all negative controls and <italic>p<sub>i</sub></italic> &#x003D; 0 for all other genes in Step 2 of the sva algorithm. The assumption is that control probes will capture all of the variation due to unknown artifacts and none of the variation due to the phenotype. Control probes may miss biological artifacts. For example, we showed that trans-eQTL that are associated with multiple gene expression levels may act like an artifact when measuring the association between gene expression and phenotype [<xref ref-type="bibr" rid="c4">4</xref>]. These artifacts may be missed by the ssva approach. However ssva is particularly useful for unfortunate experimental designs where the phenotype variable and unknown artifacts are highly correlated [<xref ref-type="bibr" rid="c6">6</xref>], making empirical estimates unstable [<xref ref-type="bibr" rid="c5">5</xref>].</p>
</sec>
<sec id="s2d">
<label>2.4</label><title>Moderated log link sva (svaseq)</title>
<p>The second extension involves the choice of function <italic>f</italic>() in (1). In our original work we used the identify function for data measured on an approximately symmetric and continuous scale. For sequencing data, which are often represented as counts, a more suitable model may involve the use of a moderated log function [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>]. For example in Step 1 of the algorithm we may first transform the gene expression measurements by applying the function <italic>log</italic>(<italic>g</italic><sub><italic>ij</italic></sub> &#x002B; <italic>c</italic>) for a small positive constant. In the analyses that follow I will set <italic>c</italic> &#x003D; 1. After performing Steps 1-5 of the surrogate variable analysis estimation algorithm, the estimated covariates are included in downstream models as adjustment variables. For the analyses that follow, I will use the limma package [<xref ref-type="bibr" rid="c19">19</xref>] with the voom method [<xref ref-type="bibr" rid="c20">20</xref>] for differential expression analysis.</p>
</sec>
<sec id="s2e">
<label>2.5</label><title>Combining svaseq and ssva</title>
<p>Supervised svaseq proceeds by applying the transformation <italic>log</italic>(<italic>g</italic><sub><italic>ij</italic></sub> &#x002B; <italic>c</italic>) to the gene expression count data in Step 1 and setting <italic>p</italic><sub><italic>i</italic></sub> &#x003D; 1 for all negative controls and <italic>p<sub>i</sub></italic> &#x003D; 0 for all other genes in Step 2 of the sva algorithm.</p>
</sec>
<sec id="s2f">
<label>2.6</label><title>Zebrafish data</title>
<p>I use data from Zebrafish sensory neurons with three control samples and three gallein treated samples as the comparison groups [<xref ref-type="bibr" rid="c21">21</xref>]. These data are available as part of the <italic>zebrafishRNAseq</italic> Bioconductor package. I loaded the data and filtered as described in the RUVSeq package. Then I estimated batch effects using supervised and unsupervised surrogate variable analysis for sequencing, principal components analysis, RUV with control probes, RUV with empirical controls, and residual RUV. I compared the model estimates and I also compared differential expression analysis results when each of the different batch effect estimates was included in the model in place of the study variable.</p>
</sec>
<sec id="s2g">
<label>2.7</label><title>ReCount data</title>
<p>ReCount is a database of pre-processed RNA-sequencing data, processed to be comparable across samples [<xref ref-type="bibr" rid="c22">22</xref>]. In this analysis, I downloaded pre-counted RNA-sequencing data sets measuring gene expression in two separate Hapmap populations [<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c24">24</xref>]. For our analysis, I downloaded the count data from Re-Count and downloaded the pedigree information from the Hapmap website. I then performed differential expression analyses looking for differences in expression between males and females and estimated unknown latent structure. I calculated estimates of batch effects using unsupervised surrogate variable analysis for sequencing, principal components analysis, RUV with empirical control probes, and RUV on residuals. I compared the estimates to the variable indicating whether the data came from the Pickrell or Montgomery study. I compared two scenarios, one where the sex and study variables were balanced and one where they were imbalanced. I also compared the differential expression analysis results when each of the different batch effect estimates was included in the model in place of the study variable.</p>
</sec>
<sec id="s2h">
<label>2.8</label><title>GEUVADIS data</title>
<p>I downloaded the processed GEUVADIS [<xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>] Ballgown object [<xref ref-type="bibr" rid="c27">27</xref>] from <ext-link ext-link-type="uri" xlink:href="https://github.com/alyssafrazee/ballgown_code">https://github.com/alyssafrazee/ballgown_code</ext-link> I also compared the differential expression analysis results when each of the different batch effect estimates was included in the model in place of the laboratory variable.</p>
</sec>
<sec id="s2i">
<label>2.9</label><title>Simulating Data</title>
<p>I simulated data from a negative binomial model for count based RNA-sequencing data. I used the following algorithm to simulate data, for complete details see the simulated data R markdown document and accompanying HTML file.</p>
<p>I estimated the model parameters from the Zebrafish data described above. I simulated two scenarios, one where the group and batch variable where balanced and one where they were imbalanced. Data were simulated with the <italic>Polyester</italic> R package [<xref ref-type="bibr" rid="c29">29</xref>]. Then I estimated batch effects using supervised and unsupervised surrogate variable analysis for sequencing, principal components analysis, RUV with control probes, RUV with empirical controls, and residual RUV. I compared the model estimates to the true simulated batch variable and I also compared differential expression analysis results when each of the different batch effect estimates was included in the model in place of the study variable.</p>
</sec>
<sec id="s2j" sec-type="data_availability">
<label>2.10</label><title>Code and availability</title>
<p>ssva and svaseq are currently implemented in the sva Bioconductor package version 3.11.2 or greater (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/sva.html">http://www.bioconductor.org/packages/devel/bioc/html/sva.html</ext-link>). All data and code used to perform this analysis are available as R markdown files [<xref ref-type="bibr" rid="c30">30</xref>] available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/jtleek/svaseq">https://github.com/jtleek/svaseq</ext-link>. You can view the individual analyses as webpages at:
<list list-type="order">
<list-item><p>Zebrafish analysis: <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/zebrafish.html">http://jtleek.com/svaseq/zebrafish.html</ext-link></p></list-item>
<list-item><p>ReCount analysis: <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/recount.html">http://jtleek.com/svaseq/recount.html</ext-link></p></list-item>
<list-item><p>GEUVADIS analysis: <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/geuvadis.html">http://jtleek.com/svaseq/geuvadis.html</ext-link></p></list-item>
<list-item><p>Simulated data analysis: <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/simulateData.html">http://jtleek.com/svaseq/simulateData.html</ext-link></p></list-item>
</list></p>
</sec>
</sec>
<sec id="s3">
<label>3</label><title>Results</title>
<sec id="s3a">
<label>3.1</label><title>Simulated data</title>
<p>I estimated simulation parameters from the zebrafish data as described in the methods. I then performed several checks to confirm that the data generated by the simulated model recapitulated the qualitative behavior of the data used to estimate the model parameters (Figure (<xref rid="fig4" ref-type="fig">4</xref>)), that data generated without signal did not show statistically significant results, data could be simulated with differential expression signal, and that data with batch effects displayed the expected conservative bias of p-values [<xref ref-type="bibr" rid="c31">31</xref>] (See supplementary analysis files <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/zebrafish.html">http://jtleek.com/svaseq/zebrafish.html</ext-link>).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Distribution of means and variances for simulated and real zebrafish data</title>
<p>To confirm that my simulation procedure produced reasonable simulated counts, I plotted the gene-specific means and variances for (a) the simulated data set and (b) the observed zebrafish data set. The two distributions are qualitatively similar. Additional checks on the simulation procedure are provided in the simulated data analysis at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/simulateData.html">http://jtleek.com/svaseq/simulateData.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig4.tif"/>
</fig>
<p>In this case there was a single simulated batch effect. I simulated two scenarios, in the first scenario the batch effect and the group effect had low correlation (). As expected, all methods that aim to estimate batch effects while taking into account multiple sources of signal (svaseq and RUV methods) are highly correlated with the simulated batch effect. The estimate of batch based on principal components is biased, because the principal component is estimating a linear combination of the group and batch variable (<xref rid="fig5" ref-type="fig">Figure 5</xref>).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Correlation between simulated batch and group variables and various batch estimates</title>
<p>Light circles indicate low correlation and dark, tight ellipses indicate high correlation. In this case, all estimates that respect multiple sources of signal (sva and RUV based) methods are highly correlated with the simulated batch effect. Principal components estimates a linear combination of the group and batch variable and has lower concordance with the true simulated batch and the other estimates. Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/simulateData.html">http://jtleek.com/svaseq/simulateData.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Differential expression results for simulated data</title>
<p>A concordance at the top plot (CAT plot) shows the fraction of DE results that are concordant between the analysis with the true batch and the analyses using different batch estimates. Supervised (pink solid) and unsupervised (pink dotted) surrogate variable analysis for sequencing, RUV with control probes (green dashed), RUV with empirical controls (green dotted), and residual RUV (green solid) all outperform not adjusting for batch effects (yellow) while principal components analysis (blue) performs worse than no adjustment. Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/simulateData.html">http://jtleek.com/svaseq/simulateData.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig6.tif"/>
</fig>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Comparison of batch effect results when group and batch are correlated</title>
<p>(a) A plot of the correlation between the different batch estimates and the batch variable analogous to <xref rid="fig5" ref-type="fig">Figure 5</xref>. (b) A concordance at the top plot measuring concordance between the analysis using the true batch variable and the various estimates analogous to <xref rid="fig6" ref-type="fig">Figure 6</xref>. Here the unsupervised RUV approaches using empirical control probes and residuals perform worse than no adjustment, because the methods can not distinguish signal from the known group variable and the unknown batch variable. Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/simulateData.html">http://jtleek.com/svaseq/simulateData.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig7.tif"/>
</fig>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8:</label>
<caption><title>Comparison of batch effect results on zebrafish data</title>
<p>(a) A plot of the correlation between the different batch estimates analogous to <xref rid="fig5" ref-type="fig">Figure 5</xref>, but with no gold standard. (b) A concordance at the top plot measuring concordance between the analysis using the supervised SVA estimates and the various other batch estimates analogous to <xref rid="fig6" ref-type="fig">Figure 6</xref>. The control probes RUV approach (blue solid in (b)) and supervised sva approach produce identical results. The unsupervised sva (orange solid) and principal components (pink solid) approaches are most similar to the supervised estimates in this scenario. Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/zebrafish.html">http://jtleek.com/svaseq/zebrafish.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig8.tif"/>
</fig>
<p>I next fit models relating the gene expression counts to the simulated group phenotype (<italic>p</italic>) and batch effect estimates (<italic>u&#x0302;</italic>) using the following model:
<disp-formula id="eqn3">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn3.gif"/></alternatives>
</disp-formula>
I accounted for the potential relationship between mean and variance using the voom method [<xref ref-type="bibr" rid="c20">20</xref>]. I then estimated how concordant the differential expression results were with the results we obtained when we fit model 6 using the true simulated batch variable using concordance at the top plots (CAT plots) [<xref ref-type="bibr" rid="c32">32</xref>]. For each ranking, these plots show the fraction of results that are the same between the analysis using the true batch variable and the batch variable estimated with different methods. Supervised and unsupervised surrogate variable analysis for sequencing, RUV with control probes, RUV with empirical controls, and residual RUV all outperform not adjusting for batch effects while principal components analysis performs worse than no adjustment. The reason is that the principal component estimate is correlated with group and absorbs some of the signal due to that variable.</p>
<p>We performed an identical analysis where the batch was now correlated with the group variable. Qualitatively similar results hold in this second simulated scenario with one exception. The empirical RUV methods attempt to define control probes by identifying genes that do not show differential expression with respect to batch. But when batch and group are correlated, this may also through away genes that show signal with respect to the group variable. Similar the residual RUV approach estimates the batch variable after taking the residuals from the model fit of the counts on the group variable. However, when batch and group are correlated, this again removes batch signal and leads to slightly lower performance of the RUV approaches [<xref ref-type="bibr" rid="c4">4</xref>]. Unsupervised svaseq does not use the control probes but avoids some of these difficulties by iteratively identifying probes associated with group but not associated with batch [<xref ref-type="bibr" rid="c8">8</xref>] (<xref rid="fig9" ref-type="fig">Figure 9</xref>).</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9:</label>
<caption><title>Comparison of differential expression results for ReCount experiment</title>
<p>(a) A concordance at the top plot measuring concordance between the analysis using the true study and the various other batch estimates analogous to <xref rid="fig6" ref-type="fig">Figure 6</xref>. (b) A concordance at the top plot measuring concordance between the analysis using the true study and the various other batch estimates analogous to <xref rid="fig6" ref-type="fig">Figure 6</xref> when data were resampled to make the sex and study variables moderately correlated (<italic>r</italic><sup>2</sup> &#x003D; 0.33.) When sex and study are uncorrelated, RUV performs slightly better and when sex and study are correlated, svaseq performs slightly better. Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/recount.html">http://jtleek.com/svaseq/recount.html</ext-link></p></caption>
<graphic xlink:href="006585_fig9.tif"/>
</fig>
</sec>
<sec id="s3b">
<label>3.2</label><title>Zebrafish data</title>
<p>Next I performed an analysis on the zebrafish data as described in the methods section. Here, the batch variable is not known, but we do have negative control probes which can be used to estimate the batch effects. When comparing the batch estimates, I noted that the supervised sva estimates and the RUV control probes estimates were perfectly correlated (correlation 1) and that they produced identical differential expression results. The unsupervised sva and principal components approaches are most similar to the supervised estimates from SVA or RUV for the zebrafish data.</p>
</sec>
<sec id="s3c">
<label>3.3</label><title>ReCount data</title>
<p>For the ReCount data I generated an artificial batch effect by combining the data from two different studies of gene expression in two different populations [<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c24">24</xref>]. I used sex as the outcome variable in the analysis and then estimated batch effects using the same set of proposed approaches. I next fit models relating the gene expression counts (<italic>g</italic>) to sex variable (<italic>p</italic>, phenotype variable representing sex) and batch effect estimates (<italic>u&#x0302;</italic>, representing the study the samples came from) using the following model:
<disp-formula id="eqn4">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn4.gif"/></alternatives>
</disp-formula>
I accounted for the potential relationship between mean and variance using the voom method [<xref ref-type="bibr" rid="c20">20</xref>]. I then estimated how concordant the differential expression results were with the results we obtained when we fit model 6 using the true simulated batch variable using concordance at the top plots (CAT plots) [<xref ref-type="bibr" rid="c32">32</xref>].</p>
<p>In the original data, the batch effect and the group variable are nearly perfectly orthogonal. In this situation the empirical and residual RUV approaches produce estimates of the batch variable more highly correlated than the unsupervised svaseq approach (see <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/recount.html">http://jtleek.com/svaseq/recount.html</ext-link>) and produce correspondingly more similar differential expression results to using the true study variable as an adjustment in the differential expression analysis (Figure <bold>??</bold>a). However, I next re-sampled the data to mimic a scenario where the group and batch variable showed modest correlation (<italic>r</italic><sup>2</sup> &#x003D; 0.33). In this scenario the unsupervised sva and principal components analysis approaches outperform the empirical control RUV approach. The residual RUV approach performs worse than no adjustment for study, because signal due to the batch variable was removed when the residuals from the model relating sex to phenotype was calculated (Figure <bold>??</bold>b).</p>
</sec>
<sec id="s3d">
<label>3.4</label><title>GEUVADIS data</title>
<p>The <italic>Ballgown</italic> R package <ext-link ext-link-type="uri" xlink:href="https://github.com/alyssafrazee/ballgown">https://github.com/alyssafrazee/ballgown</ext-link> [<xref ref-type="bibr" rid="c27">27</xref>] can be used to analyze abundance data from assembled transcriptome data from <italic>Cufflinks</italic> [<xref ref-type="bibr" rid="c33">33</xref>]. I loaded data from the GEUVADIS project [<xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>] that we recently processed using <italic>Cufflinks</italic> and <italic>Ballgown</italic> [<xref ref-type="bibr" rid="c27">27</xref>]. I selected only the non-duplicated samples and performed a differential expression analysis comparing different populations. I then compared the estimated batch effects using the various approaches to the known lab where the samples were processed, one of the variables that showed the highest association with assembled transcript levels [<xref ref-type="bibr" rid="c26">26</xref>].</p>
<p>I assessed concordance between the batch effect estimates and the lab variable by fitting the model:
<disp-formula id="eqn5">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn5.gif"/></alternatives>
</disp-formula>
and then performed an ANOVA to compare the model including lab to the null model of no association with lab. The unsupervised sva and principal components estimates showed significantly higher F-statistics for concordance (482 and 456, respectively) compared to the RUV approach (106 and 109 for RUV residual and empirical, respectively). I next fit models relating the gene expression counts (<italic>g</italic>) to the population phenotype (<italic>p</italic>, phenotype variable representing population) and batch effect estimates (<italic>u&#x0302;</italic>, representing the study the samples came from) using the following model:
<disp-formula id="eqn6">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006585_eqn6.gif"/></alternatives>
</disp-formula>
I compared the results to the differential expression model where I included the known lab variable as an adjustment in place of <italic>u&#x0302;</italic>. The svaseq and principal components adjusted analyses showed greater concordance with the lab adjusted analysis, as expected since the batch estimates were more highly correlated with this known variable (<xref rid="fig10" ref-type="fig">Figure 10</xref>).</p>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure">
<label>Figure 10:</label>
<caption><title>Differential expression results for GEUVADIS data</title>
<p>A concordance at the top plot (CAT plot) shows the fraction of DE results that are concordant between the analysis with the true laboratory and the analyses using different batch estimates. Unsupervised surrogate variable analysis for sequencing (blue) and principal components analysis (orange) outperform the RUV based methods (pink) and no batch adjustment (green). Additional details at <ext-link ext-link-type="uri" xlink:href="http://jtleek.com/svaseq/geuvadis.html">http://jtleek.com/svaseq/geuvadis.html</ext-link>.</p></caption>
<graphic xlink:href="006585_fig10.tif"/>
</fig>
</sec>
</sec>
<sec id="s4">
<label>4</label><title>Discussion</title>
<p>Here I have described the general surrogate variable analysis framework and I have introduced two extensions of the surrogate variable analysis approach. The first takes advantage of known control probes to simplify the surrogate variable analysis algorithm and the second addresses the distribution of count and FPKM data typically observed in sequencing experiments. I have shown that these approaches perform comparably to other batch effect estimation procedures for sequencing when the group and unknown batch variables are uncorrelated and outperform other approaches when the batch and group variable are correlated. These extensions are currently available from the devel branch of the surrogate variable analysis software <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/devel/bioc/html/sva.html">http://bioconductor.org/packages/devel/bioc/html/sva.html</ext-link> and all analyses are fully reproducible and available as R markdown documents from <ext-link ext-link-type="uri" xlink:href="https://github.com/jtleek/svaseq">https://github.com/jtleek/svaseq</ext-link>.</p>
</sec>
</body>
<back>
<ack><label>5</label><title>Acknowledgements</title>
<p>JL is supported by NIH R01 GM10570502 and GM083084.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Akey</surname>, <given-names>J. M</given-names></string-name>, <string-name><surname>Biswas</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Leek</surname>, <given-names>J. T</given-names></string-name>, &#x0026; <string-name><surname>Storey</surname>, <given-names>J. D</given-names></string-name>. (<year>2007</year>) <article-title>On the design and analysis of gene expression studies in human populations</article-title>. <source>Nat. Genet</source>. <volume>39</volume>, <fpage>807</fpage>&#x2013;<lpage>808</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Sebastiani</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Solovieff</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Puca</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Hartley</surname>, <given-names>S. W</given-names></string-name>, <string-name><surname>Melista</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Andersen</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Dworkis</surname>, <given-names>D. A</given-names></string-name>, <string-name><surname>Wilk</surname>, <given-names>J. B</given-names></string-name>, <string-name><surname>Myers</surname>, <given-names>R. H</given-names></string-name>, <string-name><surname>Steinberg</surname>, <given-names>M. H</given-names></string-name>, <string-name><surname>Montano</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Baldwin</surname>, <given-names>C. T</given-names></string-name>, &#x0026; <string-name><surname>Perls</surname>, <given-names>T. T</given-names></string-name>. (<year>2010</year>) <article-title>Genetic signatures of exceptional longevity in humans</article-title>. <source>Science</source> <fpage>2010</fpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Lambert</surname>, <given-names>C. G</given-names></string-name> &#x0026; <string-name><surname>Black</surname>, <given-names>L. J</given-names></string-name>. (<year>2012</year>) <article-title>Learning from our GWAS mistakes: from experimental design to scientific method</article-title>. <source>Biostatistics</source> <volume>13</volume>, <fpage>195</fpage>&#x2013;<lpage>203</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J</given-names></string-name> &#x0026; <string-name><surname>Storey</surname>, <given-names>J</given-names></string-name>. (<year>2007</year>) <article-title>Capturing heterogeneity in gene expression studies by &#x2018;surrogate variable analysis&#x2019;</article-title>. <source>PLoS Genetics</source> <volume>3</volume>, <fpage>e161</fpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Gagnon-Bartsch</surname>, <given-names>J. A</given-names></string-name> &#x0026; <string-name><surname>Speed</surname>, <given-names>T. P</given-names></string-name>. (<year>2012</year>) <article-title>Using control genes to correct for unwanted variation in microarray data</article-title>. <source>Biostatistics</source> <volume>13</volume>, <fpage>539</fpage>&#x2013;<lpage>552</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J. T</given-names></string-name>, <string-name><surname>Scharpf</surname>, <given-names>R. B</given-names></string-name>, <string-name><surname>Bravo</surname>, <given-names>H. C</given-names></string-name>, <string-name><surname>Simcha</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>W. E</given-names></string-name>, <string-name><surname>Geman</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Baggerly</surname>, <given-names>K</given-names></string-name>, &#x0026; <string-name><surname>Irizarry</surname>, <given-names>R. A</given-names></string-name>. (<year>2010</year>) <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat. Rev. Genet</source>. <volume>11</volume>, <fpage>733</fpage>&#x2013;<lpage>739</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Kircher</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Heyn</surname>, <given-names>P</given-names></string-name>, &#x0026; <string-name><surname>Kelso</surname>, <given-names>J</given-names></string-name>. (<year>2011</year>) <article-title>Addressing challenges in the production and analysis of illumina sequencing data</article-title>. <source>BMC genomics</source> <volume>12</volume>, <fpage>382</fpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J</given-names></string-name> &#x0026; <string-name><surname>Storey</surname>, <given-names>J</given-names></string-name>. (<year>2008</year>) <article-title>A general framework for multiple testing dependence</article-title>. <source>PNAS</source> <volume>105</volume>, <fpage>18718</fpage>&#x2013;<lpage>18723</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J</given-names></string-name>. (<year>2011</year>) <article-title>Asymptotic conditional singular value decomposition for high-dimensional genomic data</article-title>. <source>Biometrics</source> <volume>67</volume>, <fpage>344</fpage>&#x2013;<lpage>352</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Risso</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Ngai</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Speed</surname>, <given-names>T</given-names></string-name>, &#x0026; <string-name><surname>Dudoit</surname>, <given-names>S</given-names></string-name>. (<year>2014</year>) <article-title>Using controls for the normalization of rna-seq data</article-title>. <source>Nature Biotechnology</source> p. to appear.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Price</surname>, <given-names>A. L</given-names></string-name>, <string-name><surname>Patterson</surname>, <given-names>N. J</given-names></string-name>, <string-name><surname>Plenge</surname>, <given-names>R. M</given-names></string-name>, <string-name><surname>Weinblatt</surname>, <given-names>M. E</given-names></string-name>, <string-name><surname>Shadick</surname>, <given-names>N. A</given-names></string-name>, &#x0026; <string-name><surname>Reich</surname>, <given-names>D</given-names></string-name>. (<year>2006</year>) <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nature genetics</source> <volume>38</volume>, <fpage>904</fpage>&#x2013;<lpage>909</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Friguet</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Kloareg</surname>, <given-names>M</given-names></string-name>, &#x0026; <string-name><surname>Causeur</surname>, <given-names>D</given-names></string-name>. (<year>2009</year>) <article-title>A factor model approach to multiple testing under dependence</article-title>. <source>Journal of the American Statistical Association</source> <volume>104</volume>, <fpage>1406</fpage>&#x2013;<lpage>1415</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Teschendorff</surname>, <given-names>A. E</given-names></string-name>, <string-name><surname>Zhuang</surname>, <given-names>J</given-names></string-name>, &#x0026; <string-name><surname>Widschwendter</surname>, <given-names>M</given-names></string-name>. (<year>2011</year>) <article-title>Independent surrogate variable analysis to deconvolve confounding factors in large-scale microarray profiling studies</article-title>. <source>Bioinformatics</source> <volume>27</volume>, <fpage>1496</fpage>&#x2013;<lpage>1505</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Fan</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Han</surname>, <given-names>X</given-names></string-name>, &#x0026; <string-name><surname>Gu</surname>, <given-names>W</given-names></string-name>. (<year>2012</year>) <article-title>Estimating false discovery proportion under arbitrary covariance dependence</article-title>. <source>Journal of the American Statistical Association</source> <volume>107</volume>, <fpage>1019</fpage>&#x2013;<lpage>1035</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Listgarten</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Kadie</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Schadt</surname>, <given-names>E. E</given-names></string-name>, &#x0026; <string-name><surname>Heckerman</surname>, <given-names>D</given-names></string-name>. (<year>2010</year>) <article-title>Correction for hidden confounders in the genetic analysis of gene expression</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>, <fpage>16465</fpage>&#x2013;<lpage>16470</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Stegle</surname>, <given-names>O</given-names></string-name>, <string-name><surname>Parts</surname>, <given-names>L</given-names></string-name>, <string-name><surname>Durbin</surname>, <given-names>R</given-names></string-name>, &#x0026; <string-name><surname>Winn</surname>, <given-names>J</given-names></string-name>. (<year>2010</year>) <article-title>A bayesian framework to account for complex non-genetic factors in gene expression levels greatly increases power in eqtl studies</article-title>. <source>PLoS computational biology</source> <volume>6</volume>, <fpage>e1000770</fpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Frazee</surname>, <given-names>A. C</given-names></string-name>, <string-name><surname>Sabunciyan</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Hansen</surname>, <given-names>K. D</given-names></string-name>, <string-name><surname>Irizarry</surname>, <given-names>R. A</given-names></string-name>, &#x0026; <string-name><surname>Leek</surname>, <given-names>J. T</given-names></string-name>. (<year>2014</year>) <article-title>Differential expression analysis of rna-seq data at single-base resolution</article-title>. <source>Biostatistics</source> p. <fpage>kxt053</fpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Bullard</surname>, <given-names>J. H</given-names></string-name>, <string-name><surname>Purdom</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Hansen</surname>, <given-names>K. D</given-names></string-name>, &#x0026; <string-name><surname>Dudoit</surname>, <given-names>S</given-names></string-name>. (<year>2010</year>) <article-title>Evaluation of statistical methods for normalization and differential expression in mrna-seq experiments</article-title>. <source>BMC bioinformatics</source> <volume>11</volume>, <issue>94</issue>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Smyth</surname>, <given-names>G. K</given-names></string-name>. (<year>2005</year>) <article-title>in Bioinformatics and computational biology solutions using R and Bioconductor</article-title>. (<source>Springer</source>), pp. <fpage>397</fpage>&#x2013;<lpage>420</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Law</surname>, <given-names>C. W</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>Y</given-names></string-name>, <string-name><surname>Shi</surname>, <given-names>W</given-names></string-name>, &#x0026; <string-name><surname>Smyth</surname>, <given-names>G. K</given-names></string-name>. (<year>2013</year>) <article-title>Voom: precision weights unlock linear model analysis tools for rna-seq read counts</article-title>. <source>Preprint</source> <fpage>2013</fpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Ferreira</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Wilson</surname>, <given-names>S. R</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>Y. G</given-names></string-name>, <string-name><surname>Risso</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Dudoit</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Speed</surname>, <given-names>T. P</given-names></string-name>, &#x0026; <string-name><surname>Ngai</surname>, <given-names>J</given-names></string-name>. (<year>2014</year>) <article-title>Silencing of odorant receptor genes by g protein &#x03B2;&#x03B3; signaling ensures the expression of one odorant receptor per olfactory sensory neuron</article-title>. <source>Neuron</source> <volume>81</volume>, <fpage>847</fpage>&#x2013;<lpage>859</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Frazee</surname>, <given-names>A. C</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B</given-names></string-name>, &#x0026; <string-name><surname>Leek</surname>, <given-names>J. T</given-names></string-name>. (<year>2011</year>) <article-title>Recount: a multi-experiment resource of analysis-ready rna-seq gene count datasets</article-title>. <source>BMC bioinformatics</source> <volume>12</volume>, <fpage>449</fpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Pickrell</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Marioni</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Pai</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Degner</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Engelhardt</surname>, <given-names>B</given-names></string-name>, <string-name><surname>Nkadori</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Veyrieras</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Stephens</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Gilad</surname>, <given-names>Y</given-names></string-name>, &#x0026; <string-name><surname>Pritchard</surname>, <given-names>J</given-names></string-name>. (<year>2010</year>) <article-title>Understanding mechanisms underlying human gene expression variation with rna sequencing</article-title>. <source>Nature</source> <volume>464</volume>, <fpage>768</fpage>&#x2013;<lpage>772</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Montgomery</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Sammeth</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Gutierrez-Arcelus</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Lach</surname>, <given-names>R</given-names></string-name>, <string-name><surname>Ingle</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Nisbett</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Guigo</surname>, <given-names>R</given-names></string-name>, &#x0026; <string-name><surname>Dermitzakis</surname>, <given-names>E</given-names></string-name>. (<year>2010</year>) <article-title>Transcriptome genetics using second generation sequencing in a caucasian population</article-title>. <source>Nature</source> <volume>464</volume>, <fpage>773</fpage>&#x2013;<lpage>777</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Lappalainen</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Sammeth</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Friedl&#x00E4;nder</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>AC?t Hoen</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Monlong</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Rivas</surname>, <given-names>M. A</given-names></string-name>, <string-name><surname>Gonz&#x00E0;lez-Porta</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Kurbatova</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Griebel</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Ferreira</surname>, <given-names>P. G</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>) <article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>AC&#x2019;t Hoen</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Friedl&#x00F6;nder</surname>, <given-names>M. R</given-names></string-name>, <string-name><surname>Alml&#x00F6;f</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Sammeth</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Pulyakhina</surname>, <given-names>I</given-names></string-name>, <string-name><surname>Anvar</surname>, <given-names>S. Y</given-names></string-name>, <string-name><surname>Laros</surname>, <given-names>J. F</given-names></string-name>, <string-name><surname>Buermans</surname>, <given-names>H. P</given-names></string-name>, <string-name><surname>Karlberg</surname>, <given-names>O</given-names></string-name>, <string-name><surname>Br&#x00E4;nnvall</surname>, <given-names>M</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>) <article-title>Reproducibility of high-throughput mrna and small rna sequencing across laboratories</article-title>. <source>Nature biotechnology</source>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Frazee</surname>, <given-names>A. C</given-names></string-name>, <string-name><surname>Pertea</surname>, <given-names>G</given-names></string-name>, <string-name><surname>Jaffe</surname>, <given-names>A. E</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S. L</given-names></string-name>, &#x0026; <string-name><surname>Leek</surname>, <given-names>J. T</given-names></string-name>. (<year>2014</year>) <article-title>Flexible isoform-level differential expression analysis with ballgown</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Savani</surname>, <given-names>V</given-names></string-name> &#x0026; <string-name><surname>Zhigljavsky</surname>, <given-names>A</given-names></string-name>. (<year>2006</year>) <article-title>Efficient estimation of parameters of the negative binomial distribution</article-title>. <source>Communications in Statistics? Theory and Methods</source> <volume>35</volume>, <fpage>767</fpage>&#x2013;<lpage>783</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Frazee</surname>, <given-names>A. C</given-names></string-name>, <string-name><surname>Jaffe</surname>, <given-names>A. E</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B</given-names></string-name>, &#x0026; <string-name><surname>Leek</surname>, <given-names>J</given-names></string-name>. (<year>2014</year>) <article-title>Polyester: simulating rna-seq datasets with differential transcript expression</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Xie</surname>, <given-names>Y</given-names></string-name>. (<year>2014</year>) <article-title>knitr: a comprehensive tool for reproducible research in r</article-title>. <source>Implementing Reproducible Research</source> p. 1.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Leek</surname>, <given-names>J</given-names></string-name> &#x0026; <string-name><surname>Storey</surname>, <given-names>J. D</given-names></string-name>. (<year>2011</year>) <article-title>The Joint Null Criterion for Multiple Hypothesis Tests</article-title>. <source>S.A.G.M.B</source>. <volume>10</volume>, <issue>28</issue>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Irizarry</surname>, <given-names>R. A</given-names></string-name>, <string-name><surname>Warren</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Spencer</surname>, <given-names>F</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>I. F</given-names></string-name>, <string-name><surname>Biswal</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Frank</surname>, <given-names>B. C</given-names></string-name>, <string-name><surname>Gabrielson</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>J. G</given-names></string-name>, <string-name><surname>Geoghegan</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Germino</surname>, <given-names>G</given-names></string-name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Multiple-laboratory comparison of microarray platforms</article-title>. <source>Nature methods</source> <volume>2</volume>, <fpage>345</fpage>&#x2013;<lpage>350</lpage>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Roberts</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Goff</surname>, <given-names>L</given-names></string-name>, <string-name><surname>Pertea</surname>, <given-names>G</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Kelley</surname>, <given-names>D. R</given-names></string-name>, <string-name><surname>Pimentel</surname>, <given-names>H</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S. L</given-names></string-name>, <string-name><surname>Rinn</surname>, <given-names>J. L</given-names></string-name>, &#x0026; <string-name><surname>Pachter</surname>, <given-names>L</given-names></string-name>. (<year>2012</year>) <article-title>Differential gene and transcript expression analysis of rna-seq experiments with tophat and cufflinks</article-title>. <source>Nature protocols</source> <volume>7</volume>, <fpage>562</fpage>&#x2013;<lpage>578</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>