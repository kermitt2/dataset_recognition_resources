<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/271015</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Emergence of evolutionary stable communities through eco-evolutionary tunneling</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Kotil</surname>
<given-names>Seyfullah Enes</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8864-502X</contrib-id>
<name>
<surname>Vetsigian</surname>
<given-names>Kalin</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>a</label><institution>Department of Bacteriology and Wisconsin Institute for Discovery, University of Wisconsin-Madison</institution>, <country>USA</country>.</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label><bold>Address correspondence to</bold> Kalin Vetsigian, <email>kalin.vetsigian@wid.wisc.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>271015</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>23</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="271015.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Ecological and evolutionary dynamics of communities are inexorably intertwined. The ecological state determines the fate of newly arising mutants, and mutations that increase in frequency can reshape the ecological dynamics. Evolutionary game theory and its extensions within adaptive dynamics (AD) have been the mathematical frameworks for understanding this interplay, leading to notions such as Evolutionary Stable States (ESS) in which no mutations are favored, and evolutionary branching points near which the population diversifies. A central assumption behind these theoretical treatments has been that mutations are rare so that the ecological dynamics has time to equilibrate after every mutation. A fundamental question is whether qualitatively new phenomena can arise when mutations are frequent. Here we describe an adaptive diversification process that robustly leads to complex ESS, despite the fact that such communities are unreachable through a step-by-step evolutionary process. Rather, the system as a whole tunnels between collective states over a short time scale. The tunneling rate is a sharply increasing function of the rate with which mutations arise in the population. This makes the emergence of ESS communities virtually impossible in small populations, but generic in large ones. Moreover, communities emerging through this process can spatially spread as single replication units that outcompete other communities. Overall, this work provides a qualitatively new mechanism for adaptive diversification and shows that complex structures can generically evolve even when no step-by-step evolutionary path exists.</p></abstract>
<counts>
<page-count count="23"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Main Text</title>
<p>Understanding the consequences of the feedback between ecological and evolutionary dynamics is a fundamental challenge<sup><xref ref-type="bibr" rid="c1">1</xref>&#x2013;<xref ref-type="bibr" rid="c2"/><xref ref-type="bibr" rid="c3"/><xref ref-type="bibr" rid="c4"/><xref ref-type="bibr" rid="c5"/><xref ref-type="bibr" rid="c6">6</xref></sup>, particularly in asexual microbial communities, where new strains with altered ecological interactions can readily arise through mutational events such as replication errors and horizontal gene transfer<sup><xref ref-type="bibr" rid="c7">7</xref>&#x2013;<xref ref-type="bibr" rid="c8"/><xref ref-type="bibr" rid="c9"/><xref ref-type="bibr" rid="c10"/><xref ref-type="bibr" rid="c11"/><xref ref-type="bibr" rid="c12"/><xref ref-type="bibr" rid="c13"/><xref ref-type="bibr" rid="c14">14</xref></sup>. In the absence of mutations, the strain abundance dynamics can be represented as a non-linear dynamical system with fixed dimensionality determined by the number of strains<sup><xref ref-type="bibr" rid="c15">15</xref>&#x2013;<xref ref-type="bibr" rid="c16"/><xref ref-type="bibr" rid="c17"/><xref ref-type="bibr" rid="c18">18</xref></sup>, which allows us to understand and classify long-term community composition in terms of dynamical attractors. It is far less clear, however, how to analyze the dynamics when mutations stochastically introduce new dimensions and ecological interactions<sup><xref ref-type="bibr" rid="c19">19</xref>&#x2013;<xref ref-type="bibr" rid="c20"/><xref ref-type="bibr" rid="c21"/><xref ref-type="bibr" rid="c22">22</xref></sup>.</p>
<p>Important progress was made with the advent of Evolutionary Game Theory<sup><xref ref-type="bibr" rid="c23">23</xref>&#x2013;<xref ref-type="bibr" rid="c24"/><xref ref-type="bibr" rid="c25"/><xref ref-type="bibr" rid="c26">26</xref></sup>, which established the notion of evolutionary stable states as long-term endpoints of the eco-evolutionary dynamics. An evolutionary stable state is a community that has reached an ecological attractor that cannot be invaded by any possible mutant. Therefore, an evolutionary stable community (ESC) would persist indefinitely despite mutations. These ideas were further elaborated on through the framework of AD<sup><xref ref-type="bibr" rid="c27">27</xref>&#x2013;<xref ref-type="bibr" rid="c28"/><xref ref-type="bibr" rid="c29">29</xref></sup>, which went beyond analysis of equilibria. Here community evolution is represented as a sequence of mutational events (<xref ref-type="fig" rid="fig1">Fig 1a</xref>). After every mutational event the ecological dynamics has time to equilibrate and reach a new ecological attractor. Thus, the evolutionary dynamics consists of a series of stochastic jumps from one ecological attractor to another, and an ecological attractor can in general transition to many different attractors through different mutations (<xref ref-type="fig" rid="fig1">Fig 1b</xref>). The space of possible strains and attractors is typically continuous, reflecting the continuous nature of phenotypes. It was recognized that some ESS can be unreachable by evolution (&#x201C;Gardens of Eden&#x201D;)<sup><xref ref-type="bibr" rid="c30">30</xref></sup>, and therefore the notion of evolutionary convergence was introduced to indicate ecological attractors towards which all nearby attractors evolve. Strikingly, evolutionary stability and evolutionary convergence are independent notions that can occur in all possible combinations<sup><xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c31">31</xref></sup>. States that are both convergent and stable are end-points of the eco-evolutionary dynamics. In contrast, ecological attractors that are evolutionary convergent but unstable (branching points) lead to adaptive diversification events, where a lineage splits into multiple coexisting lineages. Thus, AD has provided tools for analyzing equilibrium end-points of the eco-evolutionary dynamics and adaptive diversifications<sup><xref ref-type="bibr" rid="c32">32</xref></sup>.</p>
<p>A fundamental limitation of the AD framework is the assumption that ecologically relevant mutations are rare, so that the ecological dynamics has time to equilibrate between mutations<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. In a sense, it is assumed that there is a separation of time scales between the ecological and evolutionary dynamics. However, even if the rate of discovery of ecologically relevant mutations is low per individual, many communities contain very large numbers of individuals. Therefore, it is quite possible that a new mutant will start invading before the transient dynamics triggered by the previous successful mutant has expired. This would be especially true if the selection coefficients of invading mutants are low, so that the transient ecological dynamics is long.</p>
<p>An important question, then, is whether the realistic regime of a finite mutation rate per population, rather than an infinitesimal one, can exhibit qualitatively new behaviors that fall outside the scope of adaptive dynamics. Recently, we computationally examined the eco-evolutionary dynamics in microbial communities in which bacteria consume a single resource in a two-dimensional environment and compete through interactions mediated by antibiotic production and degradation<sup><xref ref-type="bibr" rid="c33">33</xref></sup>. Each strain is characterized by its costly investment in antibiotic production or degradation with respect to each antibiotic, and mutants with different levels of antibiotic production and degradation can arise (<xref ref-type="fig" rid="fig1">Fig. 1cde</xref>, Methods). We found that, for a broad range of parameters, ESCs with 3-strains and 5-strains robustly arise in simulations with one and two antibiotics, respectively, when starting with a single strain. Thus, stable communities maintained solely by antibiotic-mediated interactions can spontaneously evolve. Here, we investigate the mechanism behind these adaptive diversifications. We show that, while locally convergent, the ESCs are globally inaccessible through step-by-step adaptive dynamics, starting from simple single-strain populations (<xref ref-type="fig" rid="fig1">Fig. 1b</xref>). The robust emergence of these &#x201C;forbidden&#x201D; ESCs is only possible when the timescales of the ecological and evolutionary dynamics interfere with each other through a process we term &#x201C;eco-evolutionary tunneling&#x201D;.</p>
<fig id="fig1" position="float" fig-type="figure" orientation="portrait">
<label>Fig 1.</label>
<caption><title>Evolution of antibiotic interactions leads to robust emergence of ESCs that are unreachable through adaptive dynamics.</title>
<p><bold>(a)</bold> Schematic of AD. Mutant invasions (arrows) lead to transitions between ecologically stable communities (circles) containing one or more strains. ESS corresponds to a state from which no further transitions are possible (yellow circle). The abundances of different strains over time (colored lines) corresponding to the transitions are also shown. <bold>(b)</bold> A more general AD graph in which multiple paths are possible, and in which certain ecologically stable communities (green) are unreachable starting from an initial community (grey). These communities can, however, be reached through eco-evolutionary tunneling that falls outside the scope of AD (yellow lightning). <bold>(c)</bold> In simulations, strains genetically encode different levels of antibiotic production (P) or degradation (D). They can also be sensitive to antibiotics (S) or be resistant via an antibiotic efflux (R). New strains can emerge through mutations (arrows). <bold>(d)</bold> The space of possible strain phenotypes in simulations with two antibiotics. The 5-strain ESC that emerges in (f) is indicated by colored squares. <bold>(e)</bold> Simulations of microbial communities proceed though ecological cycles. During each cycle, spores of different strains (different colors) are scattered on a 2D plane and grow as colonies until all space is filled. Colonies then produce and degrade diffusing antibiotics according to their phenotypes. Some regions die (white), while sporulation is enhanced if neighbors are inhibited (darker colors). <bold>(f)</bold> In a simulation with two antibiotics a 5-strain ESC robustly arises. (Top) Shown are existing phenotypes (projected into ID) as a function of time. (Bottom) Shown is the abundance of different strains over time. Different colors correspond to different phenotypic classes (Methods).</p></caption>
<graphic xlink:href="271015_fig1.tif"/>
</fig>
<p>ESCs appear to come together all at once (<xref ref-type="fig" rid="fig1">Fig. 1f</xref>). To disentangle the sequence of events leading to their formation, we lowered the mutation rate per population in the hope of stretching out the assembly process over time. We found that while this tends to dramatically delay the emergence, the stable community still snaps together on a very short timescale (<xref ref-type="fig" rid="fig2">Fig. 2a</xref>). Before the transition, the system spends a lot of time in a regime of rapid turnover (RT), in which the dominant strains are continuously outcompeted by new mutants. This regime ends abruptly with the emergence of a persistent multi-strain community that can then evolve towards the convergent ESC. This transition is stochastic, and the wait time (<italic>T</italic>) is exponentially distributed (<xref ref-type="fig" rid="fig2">Fig. 2b</xref>, <xref ref-type="fig" rid="figS1">Supplementary Fig. 1</xref>, <xref ref-type="fig" rid="figS2">Supplementary Fig. 2</xref>). This suggests a simple two-state representation in which the RT state is metastable and decays into the ESC state by stochastically tunneling through a barrier with a constant probability per unit time (<xref ref-type="fig" rid="fig2">Fig. 2c</xref>).</p>
<p>We next investigated how the tunneling rate (<italic>r</italic>) depends on the mutation rate (<italic>&#x03BC;</italic>) and population size (<italic>N</italic>). If the community emerges step-by-step (<xref ref-type="fig" rid="fig1">Fig 1a</xref>), we expect that, at low <italic>&#x03BC;N</italic>, the inverse of the mean community formation time would be simply proportional to the mutation rate per population (<italic>&#x03BC;N</italic>), independent of ecological details (Methods). In sharp contrast, we found that <italic>r</italic> is proportional to (<italic>&#x03BC;N</italic>)<sup>2</sup> for the 3-strain community that emerges in a universe with one antibiotic, and <italic>r</italic> exhibits a complex dependence with an approximate (<italic>&#x03BC;N</italic>)<sup>3.7</sup> scaling for the 5-strain community that emerges in a universe with two antibiotics (<xref ref-type="fig" rid="fig2">Fig. 2d</xref>, <xref ref-type="fig" rid="figS3">Supplementary Fig. 3</xref>). The superlinear dependence of <italic>r</italic> clearly demonstrates that ESC emergence cannot be understood within the context of adaptive dynamics and, strikingly, that emergence becomes ever more efficient at high mutation rates or population sizes &#x2013; requiring fewer mutational events. Furthermore, the different scaling exponents at low <italic>&#x03BC;N</italic> in the two examined cases indicate that there are different classes and orders of eco-evolutionary emergence.</p>
<fig id="fig2" position="float" fig-type="figure" orientation="portrait">
<label>Fig 2.</label>
<caption><title>ESCs emerge abruptly through eco-evolutionary tunneling whose rate scales superlinearly with mutation rate and population size.</title>
<p><bold>(a)</bold> At lower mutation rates, the dynamics can spend a considerable time in a rapid strain turnover phase (RT) before suddenly arriving at a stable solution (ESC). <bold>(b)</bold> The community formation time is exponentially distributed, indicating a constant probability of formation per unit time. <bold>(c)</bold> A two-state representation of the system in which a metastable RT state decays into an ESC state by tunneling through a barrier with a constant probability per unit time, <italic>r</italic>. <bold>(d)</bold> The community assembly rate <italic>r</italic>, as computed from thousands of replicate simulations (<xref ref-type="fig" rid="figS1">Supplementary Fig. 1</xref>, <xref ref-type="fig" rid="figS2">Supplementary Fig. 2</xref>), is shown as a function of <italic>&#x03BC;</italic> at fixed <italic>N</italic> for simulations with one antibiotic (blue triangles) and two antibiotics (purple diamonds). Note the logarithmic scale on both axes. Straight lines (dashed, blue and purple) are fitted to the data to demonstrate power law dependence at low <italic>&#x03BC;N</italic>. The expected slope from AD for <italic>r</italic>&#x003D;1/&#x003C;<italic>T</italic>&#x003E; is shown as a reference (dashed black line). The estimation errors of <italic>r</italic> are smaller than the symbols. By independently varying <italic>&#x03BC;</italic> and <italic>N</italic>, we verified that the controlling parameter is the product <italic>&#x03BC;N</italic>, which is the mutation rate per population (<xref ref-type="fig" rid="figS3">Supplementary Fig. 3</xref>).</p></caption>
<graphic xlink:href="271015_fig2.tif"/>
</fig>
<p>Community emergence can be understood as a probabilistic escape from the RT regime. This can happen when the turnover dynamics passes through an exit window and requires a well-timed sequence of mutant invasions, which we term a high-order eco-evolutionary event (<xref ref-type="fig" rid="fig3">Fig. 3</xref>). The emergence of a 3-strain community maintained by one antibiotic provides the simplest possible example and requires a single well-timed mutation that happens during an ongoing transition of the RT dynamics from one state to another (<xref ref-type="fig" rid="fig3">Fig. 3a</xref>). Given an ongoing transition, the probability (<italic>p</italic>) of such a mutation arising is proportional to (<italic>&#x03BC;N</italic>)<italic>W</italic> for small <italic>p</italic>, where <italic>W</italic> is the length of the window of opportunity. On the other hand, the frequency (<italic>f</italic>) with which a system passes through an exit window is proportional to <italic>&#x03BC;N</italic>. Therefore, <italic>r</italic> &#x003D; <italic>fp</italic> &#x007E;(<italic>&#x03BC;N</italic>)<sup>2</sup>, explaining our empirical finding for simulations with one antibiotic.</p>
<p>Simulations with two antibiotics provide a more general example in which multiple well-timed mutant invasions are required, and in which a community can emerge through multiple possible pathways (<xref ref-type="fig" rid="fig3">Fig. 3bc</xref>, <xref ref-type="fig" rid="figS4">Supplementary Fig. 4</xref>, <xref ref-type="fig" rid="figS5">Supplementary Fig. 5</xref>). The pathway on <xref ref-type="fig" rid="fig3">Fig. 3b</xref> shows that two higher-order eco-evolutionary events, separated by a stable stepping-stone community, can act in combination to enable complex community formation. A simple analysis suggests that each higher-order event increases the scaling exponent of <italic>r</italic> based on the number of well-timed mutations, while the number of AD steps does not affect the scaling (Methods). This analysis predicts <italic>r</italic> &#x007E;(<italic>&#x03BC;N</italic>)<sup>4</sup>, which is close but not identical to the observed exponent of about 3.7. The discrepancy might be due to the fact that we have not reached the true asymptotic behavior at low <italic>&#x03BC;N</italic>. Alternatively, the non-trivial scaling exponent might be an emergent property of the collective dynamics.</p>
<p>Strikingly, the most frequently utilized pathway goes directly from one strain to five strains, without any ecologically stable intermediates (<xref ref-type="fig" rid="fig3">Fig. 3c</xref>). This would appear to imply <italic>r</italic> &#x007E;(<italic>&#x03BC;N</italic>)<sup>5</sup>, making the dominance of this pathway puzzling (Methods). The resolution of this paradox lies within the continuous nature of the phenotypes and the resulting possibility that ecologically distinct strains can happen to be close in fitness in the absence of other strains. Such combinations of strains can persist for a long time and effectively act as if they were ecologically stable stepping stones, thus reducing the expected emergence order (Methods). Thus, near neutral coexistence of strains can provide a path for efficient ESC formation.</p>
<fig id="fig3" position="float" fig-type="figure" orientation="portrait">
<label>Fig 3.</label>
<caption><title>Pathways of ESC emergence.</title>
<p>Shown are sample simulation trajectories leading to multi-strain community formation (bottom) together with the corresponding state transition diagrams (top). Higher-order eco-evolutionary events are indicated as orange arrows. Communities of the same type as ESC (ESC-like, Methods) are shown in green, <bold>(a)</bold> In simulations with one antibiotic, the strain turnover dynamics occasionally leads to a situation in which a resident degrader strain (D) is being outcompeted by a sensitive strain (S). As S increases in frequency, antibiotic producer strains (P) become evolutionary favored as well. However, if a producer strain arises too late, it will simply outcompete the sensitive strain. A producer must arise within a particular time-window (W) for an ecologically stable 3-strain community to form, if such a community is possible at all given the particular numerical values of the P and D phenotypes, <bold>(b)</bold> Shown is one of the possible pathways of formation of a 5-strain community maintained by two antibiotics. The turnover dynamics leads to a state dominated by a strain that degrades both antibiotics (DD). While this strain is being outcompeted by a strain that degrades only the first antibiotic (DS), a PD-strain arises and invades as well, leading to a formation of a 3-strain (DP, DD, and DS) ecologically stable community (see Methods for two-letter strain nomenclature). During the invasion of this community by a strain sensitive to both antibiotics (SS), two additional mutants (SD and PS) also invade, which leads to an ecologically stable 5-strain community (after the loss of the DD-strain). <bold>(c)</bold> Shown is the most frequently utilized pathway for 5-strain community formation. A DD-strain is outcompeted by DS and SD strains. Through clonal interference, this two-strain community (dotted line circle) persists long enough for the SS-strain to arise. As SS increases in frequency, antibiotic producer strains become selected for (SP and PS). If these strains arise before the extinction of DS or SD, an ecologically stable 5-strain community can form.</p></caption>
<graphic xlink:href="271015_fig3.tif"/>
</fig>
<p>We next investigated the emergence of ESC in spatially extended systems. Instead of having one community that is well-mixed at the end of every ecological cycle, we simulated communities connected by migration. We examined the rate of community formation as a function of the migration rate (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>). The limit of low migration corresponds to many independent small communities, whereas very high migration corresponds to a single, large community that exhibits a higher rate of community emergence due to the non-trivial <italic>&#x03BC;N</italic> scaling. Strikingly though, community formation is fastest at intermediate migration rates &#x2013; indicating that spatial structure facilitates eco-evolutionary emergence. A way to understand this is that, at low enough migration rates, the communities at different locations fail to synchronize their rapid turnover dynamics, and therefore immigration can introduce new strains into a community, effectively augmenting mutation.</p>
<p>Another spatial phenomenon we might expect from systems with a stable and a meta-stable phase is that the stable phase will grow when in contact with the metastable one (<xref ref-type="fig" rid="fig4">Fig. 4b</xref>). This is known as nucleated growth<sup><xref ref-type="bibr" rid="c34">34</xref></sup>. Therefore, we asked whether a small spatial region containing an ESC would expand and outcompete neighboring communities. This is indeed what happens (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>). This is significant because it constitutes an example of a multi-strain community that grows and spreads as a self-replicating unit. Thus, we have shown that eco-evolutionary tunneling can lead to the spontaneous formation of higher-level, self-replicating composites of strains. The ability to spread implies that even if the emergence of a diverse community is unlikely at any given location, it only needs to arise once in order to become ecologically dominant.</p>
<p>The formation of stable communities through a stochastic escape from a regime of rapid strain turnover via several well-timed mutant invasions is a mechanism for adaptive diversification that is fundamentally different than that relying on branching points. Its hallmarks - abrupt emergence without a complete set of stable intermediates, exponential distribution of the community formation time, superlinear scaling of formation rate with population size, colonization ability - are all experimentally observable, either directly from time-series data of individual trajectories (as illustrated by <xref ref-type="fig" rid="fig3">Fig. 3</xref>) or through replicate microcosm experiments.</p>
<p>This mechanism demonstrates that evolution of complex communities that is impossible through independent evolutionary steps can nevertheless be efficient and generic in sufficiently large communities. It constitutes an example of an emergent phenomenon that is fundamentally eco-evolutionary - it is only possible when the timescales of the ecological and evolutionary dynamics overlap. The mutation rate per population is a parameter that controls this overlap and can be viewed as a measure of evolutionary &#x201C;temperature,&#x201D; with AD being akin to a zero-temperature limit. In analogy with communities of atoms and molecules where numerous phenomena and phases of matter (e.g. liquids) only exist at non-zero temperature, we expect that there is a rich spectrum of eco-evolutionary phenomena and states that are only possible in the regime in which population mutation rates are not close to zero and multiple ecologically relevant invasions can be underway at the same time. We anticipate that further work will elucidate many additional such phenomena in both sexual and asexual populations.</p>
<fig id="fig4" position="float" fig-type="figure" orientation="portrait">
<label>Fig 4.</label>
<caption><title>Accelerated emergence and spread of ESC in spatially extended systems.</title>
<p><bold>(a)</bold> The community formation rate <italic>r</italic> is shown as a function of the migration rate for 10 patches linked by migration. The rate is highest at intermediate migration rates, where the spatial structure is non-trivial. <bold>(b)</bold> For systems with a stable (maroon) and a meta-stable (blue) phase, nucleated growth is expected in which a (sufficiently large) seed of the stable phase grows and displaces the meta-stable phase. <bold>(c)</bold> A one-dimensional chain of patches linked by migration is simulated in a universe with two antibiotics. The central patch is seeded with the 5-strain ESC and the other patches contain a single strain sensitive to both antibiotics. Shown for each patch are the existing phenotypes as a function of time. The 5-strain pattern corresponding to ESC spreads to neighboring communities at an approximately constant speed, after an initial delay due to the special initial state of the non-central patches.</p></caption>
<graphic xlink:href="271015_fig4.tif"/>
</fig>
<p>The emergence of complex Nash equilibria in which multiple strategies stably coexist is of interest not only in ecology but also in economics. While economic theory often assumes that systems are already at Nash equilibria<sup><xref ref-type="bibr" rid="c35">35</xref></sup>, recent work has highlighted the difficulties of reaching them<sup><xref ref-type="bibr" rid="c36">36</xref></sup>. The ideas developed here suggest that the near-simultaneous spread of multiple new beneficial strategies among players might facilitate the establishment of Nash equilibria.</p>
</sec>
</body>
<back>
<ack>
<title>ACKNOWLEDGEMENTS</title>
<p>This work was supported by the Simons Foundation, Targeted Grant in the Mathematical Modeling of Living Systems Award 342039, the National Science Foundation Grant DEB 1457518. This research was performed using the compute resources and assistance of the UW-Madison Center for High Throughput Computing (CHTC) in the Department of Computer Sciences. We thank Simon A. Levin for insightful discussions.</p>
</ack>
<sec>
<title>AUTHOR CONTRIBUTIONS</title>
<p>SEK and KV designed the study, analyzed the data, performed the simulations, and wrote the manuscript.</p>
</sec>
<sec sec-type="COI-statement">
<title>COMPETING INTERESTS</title>
<p>The authors declare that they have no competing financial or non-financial interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Schoener</surname>, <given-names>T. W.</given-names></string-name> <article-title>The Newest Synthesis: Understanding the Interplay of Evolutionary and Ecological Dynamics</article-title>. <source>Science</source> <volume>331</volume>, <fpage>426</fpage>&#x2013;<lpage>429</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Pelletier</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Garant</surname>, <given-names>D.</given-names></string-name> &#x0026; <string-name><surname>Hendry</surname>, <given-names>A. P.</given-names></string-name> <article-title>Eco-evolutionary dynamics</article-title>. <source>Philos. Trans. R. Soc. Lond., B, Biol. Sci.</source> <volume>364</volume>, <fpage>1483</fpage>&#x2013;<lpage>1489</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Haloin</surname>, <given-names>J. R.</given-names></string-name> &#x0026; <string-name><surname>Strauss</surname>, <given-names>S. Y.</given-names></string-name> <article-title>Interplay between Ecological Communities and Evolution</article-title>. <source>Annals of the New York Academy of Sciences</source> <volume>1133</volume>, <fpage>87</fpage>&#x2013;<lpage>125</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Wagner</surname>, <given-names>C. E.</given-names></string-name>, <string-name><surname>Best</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Harmon</surname>, <given-names>L. J.</given-names></string-name> &#x0026; <string-name><surname>Matthews</surname>, <given-names>B.</given-names></string-name> <article-title>Evolution in a Community Context: On Integrating Ecological Interactions and Macroevolution</article-title>. <source>Trends Ecol. Evol. (Amst.)</source> <volume>32</volume>, <fpage>291</fpage>&#x2013;<lpage>304</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Post</surname>, <given-names>D. M.</given-names></string-name> &#x0026; <string-name><surname>Palkovacs</surname>, <given-names>E. P.</given-names></string-name> <article-title>Eco-evolutionary feedbacks in community and ecosystem ecology: interactions between the ecological theatre and the evolutionary play</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>364</volume>, <fpage>1629</fpage>&#x2013;<lpage>1640</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Sanchez</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name> <article-title>Feedback between Population and Evolutionary Dynamics Determines the Fate of Social Microbial Populations</article-title>. <source>PLoS Biol</source> <volume>11</volume>, <fpage>e1001547</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Rainey</surname>, <given-names>P. B.</given-names></string-name> &#x0026; <string-name><surname>Travisano</surname>, <given-names>M.</given-names></string-name> <article-title>Adaptive radiation in a heterogeneous environment</article-title>. <source>Nature</source> <volume>394</volume>, <fpage>69</fpage>&#x2013;<lpage>72</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>G&#x00F3;mez</surname>, <given-names>P.</given-names></string-name> &#x0026; <string-name><surname>Buckling</surname>, <given-names>A.</given-names></string-name> <article-title>Real-time microbial adaptive diversification in soil</article-title>. <source>Ecology Letters</source> <volume>15</volume>, <fpage>650</fpage>&#x2013;<lpage>655</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Callahan</surname>, <given-names>B. J.</given-names></string-name>, <string-name><surname>Fukami</surname>, <given-names>T.</given-names></string-name> &#x0026; <string-name><surname>Fisher</surname>, <given-names>D. S.</given-names></string-name> <article-title>Rapid evolution of adaptive niche construction in experimental microbial populations</article-title>. <source>Evolution</source> <volume>68</volume>, <fpage>3307</fpage>&#x2013;<lpage>3316</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Koeppel</surname>, <given-names>A. F.</given-names></string-name> <etal>et al.</etal> <article-title>Speedy speciation in a bacterial microcosm: new species can arise as frequently as adaptations within a species</article-title>. <source>The ISME Journal</source> <volume>7</volume>, <fpage>1080</fpage>&#x2013;<lpage>1091</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Hiltunen</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Virta</surname>, <given-names>M.</given-names></string-name> &#x0026; <string-name><surname>Laine</surname>, <given-names>A.-L.</given-names></string-name> <article-title>Antibiotic resistance in the wild: an eco-evolutionary perspective</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>372</volume>, <fpage>20160039</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Fischbach</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Walsh</surname>, <given-names>C. T.</given-names></string-name> &#x0026; <string-name><surname>Clardy</surname>, <given-names>J.</given-names></string-name> <article-title>The evolution of gene collectives: How natural selection drives chemical innovation</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>105</volume>, <fpage>4501</fpage>&#x2013;<lpage>4508</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Celiker</surname>, <given-names>H.</given-names></string-name> <article-title>Clustering in community structure across replicate ecosystems following a long-term bacterial evolution experiment</article-title>. <source>Nature Communications</source> <volume>5</volume>, <fpage>1</fpage>&#x2013;<lpage>8</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Cordero</surname>, <given-names>O. X.</given-names></string-name> &#x0026; <string-name><surname>Polz</surname>, <given-names>M. F.</given-names></string-name> <article-title>Explaining microbial genomic diversity in light of evolutionary ecology</article-title>. <source>Nat Rev Micro</source> <volume>12</volume>, <fpage>263</fpage>&#x2013;<lpage>273</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Stein</surname>, <given-names>R. R.</given-names></string-name> <etal>et al.</etal> <article-title>Ecological Modeling from Time-Series Inference: Insight into Dynamics and Stability of Intestinal Microbiota</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>, <fpage>e1003388</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Coyte</surname>, <given-names>K. Z.</given-names></string-name>, <string-name><surname>Schluter</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Foster</surname>, <given-names>K. R.</given-names></string-name> <article-title>The ecology of the microbiome: Networks, competition, and stability</article-title>. <source>Science</source> <volume>350</volume>, <fpage>663</fpage>&#x2013;<lpage>666</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Friedman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Higgins</surname>, <given-names>L. M.</given-names></string-name> &#x0026; <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name> <article-title>Community structure follows simple assembly rules in microbial microcosms</article-title>. <source>Nature Ecology &#x0026; Evolution</source> <volume>1</volume>, <fpage>1</fpage>&#x2013;<lpage>7</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Yoshida</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Jones</surname>, <given-names>L. E.</given-names></string-name>, <string-name><surname>Ellner</surname>, <given-names>S. P.</given-names></string-name>, <string-name><surname>Fussmann</surname>, <given-names>G. F.</given-names></string-name> &#x0026; <string-name><surname>Hairston</surname>, <given-names>N. G.</given-names></string-name> <article-title>Rapid evolution drives ecological dynamics in a predator-prey system</article-title>. <source>Nature</source> <volume>424</volume>, <fpage>303</fpage>&#x2013;<lpage>306</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Lawrence</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Species Interactions Alter Evolutionary Responses to a Novel Environment</article-title>. <source>PLoS Biol</source> <volume>10</volume>, <fpage>e1001330</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Herron</surname>, <given-names>M. D.</given-names></string-name> &#x0026; <string-name><surname>Doebeli</surname>, <given-names>M.</given-names></string-name> <article-title>Parallel evolutionary dynamics of adaptive diversification in Escherichia coli</article-title>. <source>PLoS Biol</source> <volume>11</volume>, <fpage>e1001490</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Harrington</surname>, <given-names>K. I.</given-names></string-name> &#x0026; <string-name><surname>Sanchez</surname>, <given-names>A.</given-names></string-name> <article-title>Eco-evolutionary dynamics of complex social strategies in microbial communities</article-title>. <source>Commun Integr Biol</source> <volume>7</volume>, <fpage>e28230</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Good</surname>, <given-names>B. H.</given-names></string-name>, <string-name><surname>McDonald</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Barrick</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Lenski</surname>, <given-names>R. E.</given-names></string-name> &#x0026; <string-name><surname>Desai</surname>, <given-names>M. M.</given-names></string-name> <article-title>The dynamics of molecular evolutionover 60,000 generations</article-title>. <source>Nature</source> <volume>551</volume>, <fpage>45</fpage>&#x2013;<lpage>50</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Maynard Smith</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>price</surname>, <given-names>G. R.</given-names></string-name> <article-title>The Logic of Animal Conflict</article-title>. <source>Nature</source> <volume>246</volume>, <fpage>15</fpage> (<year>1973</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="book"><string-name><surname>Smith</surname>, <given-names>J. M.</given-names></string-name> <source>Evolution and the Theory of Games</source>. (<publisher-name>Cambridge University Press</publisher-name>, <year>1982</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Levin</surname>, <given-names>S. A.</given-names></string-name> &#x0026; <string-name><surname>Muller-Landau</surname>, <given-names>H. C.</given-names></string-name> <article-title>The emergence of diversity in plant communities</article-title>. <source>C. R. Acad. Sci. III, Sci. Vie</source> <volume>323</volume>, <fpage>129</fpage>&#x2013;<lpage>139</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Conlin</surname>, <given-names>P. L.</given-names></string-name>, <string-name><surname>Chandler</surname>, <given-names>J. R.</given-names></string-name> &#x0026; <string-name><surname>Kerr</surname>, <given-names>B.</given-names></string-name> <article-title>Games of life and death: antibiotic resistance and production through the lens of evolutionary game theory</article-title>. <source>Current Opinion in Microbiology</source> <volume>21</volume>, <fpage>35</fpage>&#x2013;<lpage>44</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Geritz</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kisdi</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Meszena</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Metz</surname>, <given-names>J.</given-names></string-name> <article-title>Evolutionarily singular strategies and the adaptive growth and branching of the evolutionary tree</article-title>. <source>Evolutionary Ecology</source> <volume>12</volume>, <fpage>35</fpage>&#x2013;<lpage>57</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Diekmann</surname>, <given-names>O.</given-names></string-name> <article-title>A beginner&#x2019;s guide to adaptive dynamics</article-title>. <source>In Mathematical modeling of population dynamics</source> (ed. <person-group person-group-type="editor"><string-name><surname>Rudnicki</surname> <given-names>R.</given-names></string-name></person-group>) <fpage>47</fpage>&#x2013;<lpage>86</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Br&#x00E4;nnstr&#x00F6;m</surname>, <given-names>&#x00C5;.</given-names></string-name>, <string-name><surname>Johansson</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Festenberg, von</surname>, <given-names>N.</given-names></string-name> <article-title>The Hitchhiker&#x2019;s Guide to Adaptive Dynamics</article-title>. <source>Games</source> <volume>4</volume>, <fpage>304</fpage>&#x2013;<lpage>328</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Nowak</surname>, <given-names>M.</given-names></string-name> <article-title>An evolutionary stable strategy may be inaccessible</article-title>. <source>Journal of theoretical biology</source> <volume>142</volume>, <fpage>237</fpage>&#x2013;<lpage>241</lpage> (<year>1990</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Boldin</surname>, <given-names>B.</given-names></string-name> &#x0026; <string-name><surname>Diekmann</surname>, <given-names>O.</given-names></string-name> <article-title>An extension of the classification of evolutionarily singular strategies in Adaptive Dynamics</article-title>. <source>J. Math. Biol.</source> <volume>69</volume>, <fpage>905</fpage>&#x2013;<lpage>940</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="book"><string-name><surname>Doebeli</surname>, <given-names>M.</given-names></string-name> <source>Adaptive Diversification (MPB-48)</source>. (<publisher-name>Princeton University Press</publisher-name>, <year>2011</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Vetsigian</surname>, <given-names>K.</given-names></string-name> <article-title>Diverse modes of eco-evolutionary dynamics in communities of antibiotic-producing microorganisms</article-title>. <source>Nature Ecology &#x0026; Evolution</source> <volume>1</volume>, <fpage>0189</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Karthika</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Radhakrishnan</surname>, <given-names>T. K.</given-names></string-name> &#x0026; <string-name><surname>Kalaichelvi</surname>, <given-names>P.</given-names></string-name> <article-title>A Review of Classical and Nonclassical Nucleation Theories</article-title>. <source>Crystal Growth &#x0026; Design</source> <volume>16</volume>, <fpage>6663</fpage>&#x2013;<lpage>6681</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Myerson</surname>, <given-names>R.</given-names></string-name> <article-title>Nash Equilibrium and the History of Economic Theory</article-title>. <source>Journal of Economic Literature</source> <volume>37</volume>, <fpage>1067</fpage>&#x2013;<lpage>1082</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="book"><string-name><surname>Babichenko</surname>, <given-names>Y.</given-names></string-name> &#x0026; <string-name><surname>Rubinstein</surname>, <given-names>A.</given-names></string-name> <source>Communication Complexity of Approximate Nash Equilibria</source>. in <fpage>878</fpage>&#x2013;<lpage>889</lpage> (<publisher-name>ACM</publisher-name>, <year>2017</year>). doi:<pub-id pub-id-type="doi">10.1145/3055399.3055407</pub-id></mixed-citation></ref>
</ref-list>
<sec id="s2">
<title>Methods</title>
<p>The computer simulations used in this study are based on the model described in<sup><xref ref-type="bibr" rid="c33">33</xref></sup> and are briefly summarized on <xref ref-type="fig" rid="fig1">Fig.1cde</xref>. For the results presented on <xref ref-type="fig" rid="fig4">Fig. 4</xref>, the model was extended to include multiple patches linked by migration as described below. All the simulations and numerical analyses were performed in MATLAB using custom scripts that are available upon request.</p>
<p><italic>&#x03BC;</italic> is the probability of mutation per individual per ecological cycle. <italic>N</italic> is the number of spores/individuals at the beginning of each ecological cycle and is kept constant by randomly sampling <italic>N</italic> spores at the end of the ecological cycle to start a new one. Mutations happen between ecological cycles, and the number of mutations that happen in the population between cycles is Poisson distributed with mean <italic>&#x03BC;N</italic>. The relative probabilities of different types of mutations are kept fixed when varying <italic>&#x03BC;</italic> or <italic>N</italic> and are as described before.</p>
<sec id="s2a">
<title>Definition of ecological and evolutionary stability</title>
<p><italic>Ecological stability</italic> is defined as the long-term persistence of diversity when mutations are turned off (despite demographic noise coming from finite population sizes). <italic>Evolutionary stable communities</italic> (ESC) are ecologically stable communities for which no mutants exist that can increase in frequency and alter the community composition.</p>
</sec>
<sec id="s2b">
<title>Classification of strains into discrete phenotypic classes</title>
<p>While phenotypes are continuous in simulations, we found it useful for analysis, visualization, and interpretation of results to assign them to several discrete categories. With respect to a single antibiotic we distinguish D, S, R, and P strains. A D-strain is one that has the ability to degrade the antibiotic at some level. A P-strain is a strain that produces the antibiotic at a level that can inhibit a neighboring S-strain colony. A R-strain has an efflux pump making it resistant to the antibiotic (just as a P-strain) but does not produce enough antibiotics to inhibit neighbors. The S-strain does not degrade, produce or efflux antibiotics and is therefore sensitive to the antibiotic. In simulations with two antibiotics we have 16 classes that correspond to all possible pairs of &#x007B;D, S, R, P&#x007D;. For example, a DP-strain is a strain that can degrade the first antibiotic at some level and produce the second antibiotic at some level. On figures presenting evolutionary trajectories, strains from different phenotypic classes are shown in different colors, and strains from the same phenotypic class have the same color.</p>
</sec>
<sec id="s2c">
<title>ESC-like communities</title>
<p>In simulations, the true ESC is never reached as the selection coefficients of mutations that bring the community closer to ESC become vanishingly small, and the approach slows down. Furthermore, the gradual final approach to ESC proceeds through adaptive dynamics (selective sweeps within emergent ecotypes) and is not of primary interest. What we focus on is the transition from a population dominated by a single strain to an ecologically stable multi-strain community from which the evolution towards ESC can proceed entirely through adaptive dynamics. Correspondingly, we define the notion of an <italic>ESC-like</italic> community as is an ecologically stable community that consists of strains that belong to the same phenotypic classes (see above) as the ESC.</p>
<p>In simulations with 1 antibiotic, ESC consisted of 3-strains for the parameters we used: the S strain, a particular P strain, and a particular D strain. An ESC-like community, therefore, is an ecologically stable community consisting of a P-strain, a D-strain and the S-strain. In simulations with two antibiotics, ESC consists of 5-strains: particular PS, SP, DS, SD strains and the SS strain. An ESC-like community is an ecologically stable community containing 5-strains that belong to these 5 phenotypic classes.</p>
</sec>
<sec id="s2d">
<title>Determining the community formation time <italic>T</italic></title>
<p>For each simulation, we determined the ecological cycle number (time) of the first occurrence (if any) of an ESC-like community. This is done algorithmically through the following heuristic procedure:</p>
<p>First, we determine the abundance over time for the ESC-like phenotypic classes over time. In simulations with 1 antibiotic, we keep track of the abundance of P, D and S phenotypic classes over time. For simulations with 2 antibiotics, we record the abundance of PS, SP, DS, SD and SS classes over time. For example, the abundance of the SP class is determined by summing the abundances of all SP-strains that exist at a particular time. Typically, the abundance was recorded every 10 ecological cycles.</p>
<p>To determine if an ESC-like community emerges at time-point <italic>t</italic>, we analyze the phenotypic class abundance trajectories over the 5 subsequent time-points (including the current time-point), spanning 50 ecological cycles. If the abundance of any ESC-like phenotypic class reaches zero during this interval, time-point <italic>t</italic> does not mark the onset of an ESC-like community. If all abundances stay positive, we compute the linear least-squares fits for each phenotypic class. We then calculate the relative slope of each linear fit by dividing the change in abundance by the maximum value over the time interval. If all the relative slopes (for the ESC-like phenotypes) are below 0.05, we mark <italic>t</italic> as the time of ESC-like community formation. For each simulation trajectory, the time of first emergence of an ESC-like community is taken to be the community formation time <italic>T</italic>.</p>
<p>The accuracy of this algorithm has been validated by manually examining thousands of evolutionary trajectories. The scaling of <italic>r</italic> with <italic>&#x03BC;N</italic> is insensitive to the time-interval and threshold used, though they might lead to a shift of the distribution of <italic>T</italic> by a constant amount or a multiplicative shift of <italic>r</italic> (e.g. due to rejection of very short-lived ESC-like communities).</p>
</sec>
<sec id="s2e">
<title>Verifying that the community formation time is exponentially distributed and determining the community formation rate <italic>r</italic></title>
<p>For particular values of <italic>&#x03BC;</italic> and <italic>N</italic>, thousands of replicate trajectories lasting for tens of thousands of ecological cycles (see Parameters for exact values) were generated (starting with different random number generator seeds). For each trajectory, we determined the community formation time <italic>T</italic>. If no community formed, we set T to infinity.</p>
<p>We then constructed the empirical cumulative distribution function CDF(<italic>t</italic>) &#x003D; Prob(<italic>T</italic>&#x003C;<italic>t</italic>), which specifies the fraction of trajectories with <italic>T</italic> smaller than <italic>t</italic>. If <italic>T</italic> is exponentially distributed we expect Prob(<italic>T</italic> &#x2265; <italic>t</italic>) &#x003D; 1&#x2212;CDF(<italic>t</italic>) &#x003D; exp(&#x2212;<italic>rt</italic>), and correspondingly a linear relationship between <italic>y</italic>&#x003D;log(1&#x2212;CDF(<italic>t</italic>)) and <italic>t</italic>. Strong linearity was indeed observed as shown on <xref ref-type="fig" rid="fig1">Supplementary Figures 1</xref> and 2.</p>
<p>The slope provides an estimate of <italic>r</italic>. Note that the exponential distribution will be in general shifted due to the non-random initial condition and the finite duration of a higher-order eco-evolutionary event (See <italic>&#x03C4;</italic><sub>0</sub> below). Correspondingly, we allowed the fitted line not to pass through the origin (<italic>y</italic> &#x003D; &#x2212;<italic>rt</italic> &#x002B; <italic>a</italic>).</p>
</sec>
<sec id="s2f">
<title>Migration</title>
<p>A meta-community model of <italic>H</italic> patches is characterized by an <italic>H</italic>&#x00D7;<italic>H</italic> migration matrix <italic>M</italic>. <italic>M</italic><sub>i,j</sub> specifies the fraction of the population from community <italic>j</italic> that migrates to community <italic>i</italic> in one ecological cycle.</p>
<p>We considered two spatial settings in this paper:
<list list-type="order">
<list-item>
<p>All-to-all connected patches (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>), for which we set <italic>M</italic><sub>i,j</sub> &#x003D; <italic>m</italic>(1&#x2212;&#x03B4;<sub>i,j</sub>) &#x002B; (1&#x2212;(<italic>H</italic>&#x2212;1)<italic>m</italic>)&#x03B4;<sub>i,j</sub>, where &#x03B4;<sub>i,j</sub> is the Kronecker delta symbol. <italic>H</italic>&#x003D;10 was used.</p>
</list-item>
<list-item>
<p>A ring of patches (<xref ref-type="fig" rid="fig4">Fig. 4c</xref>), implemented as <italic>M</italic><sub>i,j</sub> &#x003D; (1&#x2212;2<italic>m</italic>)&#x03B4;<sub>i,j</sub> &#x002B; <italic>m</italic>(&#x03B4;<sub>i,j-1</sub>&#x002B;&#x03B4;<sub>i,j&#x002B;1</sub>&#x002B;&#x03B4;<sub>i,H</sub> &#x03B4;<sub>j,1</sub>&#x002B;&#x03B4;<sub>i,1</sub> &#x03B4;<sub>j,H</sub>). The last two terms connect patches 1 and <italic>H</italic> to create a ring. <italic>H</italic>&#x003D;20 was used.</p>
</list-item>
</list>
</p>
<p>If <italic>Y</italic><sub><italic>jS</italic></sub> is the abundance of strain <italic>s</italic> in patch <italic>j</italic> at the end of an ecological cycle, we set <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="271015_inline1.gif"/></alternatives></inline-formula>, and start the next ecological cycle of patch <italic>i</italic> by randomly assigning strain phenotypes to <italic>N</italic> individuals according to a multinomial distribution with <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="271015_inline2.gif"/></alternatives></inline-formula>. The ecological cycles of all patches are synchronous.</p>
<p>For the all-to-all connected meta-community, the overall community formation time was defined as the time when any of the communities reaches an ESC-like state according to the algorithm described above.</p>
</sec>
<sec id="s2g">
<title>The rate (1/&#x003C;T&#x003E;) of reaching a state through adaptive dynamics is <italic>&#x03BC;N</italic></title>
<p>Adaptive dynamics assumes that the system is mutation limited. The system spends almost all of its time waiting for the next successful mutant to invade and drive its transition from one ecological attractor to another. The waiting times at each state (circle on <xref ref-type="fig" rid="fig1">Fig. 1ab</xref>) are exponentially distributed, and each possible transition (arrow on <xref ref-type="fig" rid="fig1">Fig. 1ab</xref>) is characterized by a transition rate - the probability per unit time that the adaptive mutant underlying the specific transition will appear and escape stochastic loss. Each transition rate is, therefore, proportional to <italic>&#x03BC;N</italic>. If the RT dynamics is driven by mutant invasions with non-negligible selection coefficients, then at low <italic>&#x03BC;N</italic> the transitions themselves will have negligible duration compared with the mean wait times. Correspondingly, the mean time it takes to hop along any particular sequence of state transitions is equal to the sum of mean waiting times along the trajectory. Therefore, the mean time to reach any state (ecological attractor) from any other is proportional to (<italic>&#x03BC;N</italic>)<sup>&#x2212;1</sup> (as long as no nearly neutral transitions are required). Based on the observation that the turnover of strains is indeed rapid, it is clear that the turnover dynamics is pushed forward by mutants with non-negligible selection coefficients.</p>
</sec>
<sec id="s2h">
<title>Rate of community emergence in simulations with one antibiotic</title>
<p>The basic idea is that the rapid turnover dynamics passes through exit windows. During such passes, there is some probability that a community will form though a higher-order eco-evolutionary event.</p>
<p>Let <italic>&#x03C4;</italic> be the average time it takes the rapid turnover adaptive dynamics to return to an exit window, if currently at one. Based on the argument above, <italic>&#x03C4;</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>&#x2212;1</sup> at low <italic>&#x03BC;N</italic>.</p>
<p>Let <italic>p</italic> be the probability that a community will form through a higher-order eco-evolutionary event during an ongoing passage through an exit window. In general, the dynamics will pass through an exit-window many times before eventually a community successfully forms. Let <italic>n</italic> &#x003D; 1, 2, 3,&#x2026; be the number of times the dynamics passed through an exit window before success. <italic>n</italic> is a geometrically distributed random variable, and &#x003C;n&#x003E; &#x003D; 1/<italic>p</italic>. Correspondingly, the mean community formation time is:
<list list-type="simple">
<list-item>
<p>&#x003C;T&#x003E; &#x003D; (&#x003C;n&#x003E; &#x2212; 1) <italic>&#x03C4;</italic> &#x002B; &#x03C4;<sub>0</sub> &#x003D; <italic>&#x03C4;</italic> (1&#x2212;<italic>p</italic>)/<italic>p</italic> &#x002B; <italic>&#x03C4;</italic><sub>0</sub>, where &#x03C4;<sub>0</sub> is the sum of the mean time to reach the exit window from the initial condition and the mean time it takes for the community to come together after reaching the exit window for the last time.</p>
</list-item>
</list>
</p>
<p>As <italic>p</italic> &#x2192; 0, &#x003C;<italic>T</italic>&#x003E; &#x2192; &#x03C4; / <italic>p</italic>, and <italic>r</italic> &#x2192; <italic>p</italic> / <italic>&#x03C4;</italic>.</p>
<p>In the one antibiotic case, escape from the RT regime requires a single well-timed mutant invasion - a P-strain must invade during an adaptive dynamic transition from an S-strain dominated community to a D-strain dominated community. The P-strain must arise during some time window W; if the P-strain arises too late, it will take over the community dominated by the S-strain. Let <italic>q</italic> &#x007E; <italic>&#x03BC;N</italic> be the probability per ecological cycle that such a mutant will arise and escape stochastic loss. Then <italic>p</italic> &#x003D; 1 &#x2212; (1 &#x2212; <italic>q</italic>)<sup><italic>W</italic></sup> &#x2248; 1 &#x2212; exp(&#x2212;<italic>qW</italic>). Therefore, <italic>p</italic> &#x007E; <italic>&#x03BC;N</italic> for small <italic>&#x03BC;N</italic>, and correspondingly, <italic>r</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>2</sup>.</p>
<p>Notice that if <italic>qW</italic> is not small, the approximation <italic>p</italic> &#x007E; <italic>&#x03BC;N</italic> no longer holds. In particular, as we increase <italic>&#x03BC;N</italic>, we would expect deviations from <italic>r</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>2</sup>. If <italic>qW</italic> is of order unity, then <italic>p</italic> can be close to 1 as well, and we might get <italic>r</italic> &#x007E; <italic>&#x03BC;N</italic>. Thus, the scaling exponent of <italic>r</italic> can decrease at high enough uN. Deviations from power law scaling are indeed noticeable at high <italic>&#x03BC;N</italic> on <xref ref-type="fig" rid="fig2">Fig. 2d</xref>.</p>
</sec>
<sec id="s2i">
<title>Rate of community emergence in simulations with two antibiotics</title>
<p>Generalizing the logic from above, if <italic>k</italic> mutations need to arise during an ongoing adaptive dynamic transition for a community to emerge, this will lead to <italic>p</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup><italic>k</italic></sup> for small <italic>&#x03BC;N</italic>.</p>
<p>The pathway presented on <xref ref-type="fig" rid="fig3">Fig. 3b</xref> can be split into two tunneling transitions. First, a higher-order eco-evolutionary event is required to arrive at the 3-strain (SD&#x002B;DP&#x002B;DD) ecologically stable community. Repeating the argument for one antibiotic, the rate of arriving at this 3-strain community is <italic>r</italic><sub>3</sub> &#x007E; (<italic>&#x03BC;N</italic>)<sup>2</sup>. The 3-strain community can be considered a part of an extended strain turnover loop. The formation of a 5-strain community requires a second higher-order eco-evolutionary event to exit the extended loop. During an invasion of the 3-strain community by a DS strain, two additional mutants (SS, SP) need to arise. Correspondingly the probability of success is <italic>p</italic><sub>3&#x2192;5</sub> &#x007E; (<italic>&#x03BC;N</italic>)<sup>2</sup>. Repeating the logic from the one antibiotic case, now with the extended turnover loop that incorporates the 3-strain community, we get: <italic>r</italic> &#x003D; <italic>r</italic><sub>3</sub><italic>p</italic><sub>3&#x2192;5</sub>, and therefor <italic>r</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>4</sup> at low <italic>&#x03BC;N</italic>.</p>
<p>For the pathway presented on <xref ref-type="fig" rid="fig3">Fig. 3c</xref>, 4 mutations need to arise during an ongoing transition from DD to, say, DS, which implies <italic>p</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>4</sup> and, using <italic>r</italic> &#x003D; <italic>p</italic>/&#x03C4;, <italic>r</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>5</sup>. Thus, it would appear that this channel would be less likely than the other one. This indeed might be the case at very low <italic>&#x03BC;N</italic>. However, starting from the lowest <italic>&#x03BC;N</italic> levels we could computationally explore, this was one of the main channels for formation of 5-strain communities (<xref ref-type="fig" rid="figS5">Supplementary Fig. 5</xref>). A qualitatively new feature of this pathway is the DS&#x002B;SD two-strain intermediate. The relative selection coefficients of the DS and SD strains depend on the properties of the DD strain they derive and take over from. Each time the turnover dynamics reaches a DD, it will have a somewhat different phenotype. Crucially, some DD strains will give rise to DS and SD strains that have nearly identical selection coefficients. If that happens DS and SD will coexist in a near neutral fashion for extended periods of time (clonal interference), virtually guaranteeing that this two-strain combination will persist until a mutant invasion. Thus, DS&#x002B;SD can effectively act as a regular ecologically stable community awaiting a mutant invasion. The 5-strain community formation can, then, be viewed as a set of two higher-order eco-evolutionary events: the first creating the DS&#x002B;SD state by means of an SD invasion during a DD to DS transition, and the second - creating the 5-strain community through PS and SP invasions during a DS&#x002B;SD to SS transition. The rate of reaching SD&#x002B;DS would be (&#x03BC;N)<sup>2</sup>, as for the one antibiotic case, and the probability of the second eco-evolutionary tunneling is (<italic>&#x03BC;N</italic>)<sup>2</sup> because of the two required well-timed mutations. Therefore, we expect <italic>r</italic> &#x007E; (<italic>&#x03BC;N</italic>)<sup>4</sup> for pathways with long-lived SD&#x002B;DS states, which is of the same order as the pathway on <xref ref-type="fig" rid="fig3">Fig. 3b</xref>.</p>
</sec>
<sec id="s2j">
<title>Parameters</title>
<p>The parameters are defined in<sup><xref ref-type="bibr" rid="c33">33</xref></sup>. The 2D Gaussian filter used in all steps was size 5&#x00D7;5 and &#x03C3; &#x003D; 1. &#x03B1; &#x003D; 0.5, &#x03BB; &#x003D; 0.5, &#x0393; &#x003D; 0.3, &#x03B4; &#x003D; 2, <italic>T</italic><sub>p</sub> &#x003D; 40, <italic>T</italic><sub>r</sub> &#x003D; 10, <italic>N</italic> &#x003D; 40, <italic>L</italic> &#x003D; 100, <italic>S</italic> &#x003D; 3600, <italic>D</italic><sub>max</sub> &#x003D; 1000, <italic>P</italic><sub>max</sub> &#x003D; 1000, &#x03BC; &#x003D; 10, &#x007B;&#x03C0;<sub>LF</sub>, &#x03C0;<sub>l</sub>, &#x03C0;<sub>g</sub>&#x007D; &#x003D; &#x007B;1/3, 1/3, 1/3&#x007D;, &#x03B5; &#x003D; 0.</p>
<p><bold>Figure 1d:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.03, C<sub>D</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;4</sup>, C<sub>R</sub> &#x003D; 0.3, &#x03BC;N &#x003D; 4, N &#x003D; 1.44&#x00D7;10<sup>5</sup>.</p>
<p><bold>Figure 2a:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.03, C<sub>D</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;4</sup>, C<sub>R</sub> &#x003D; 0.3, &#x03BC;N &#x003D; 0.25, N &#x003D; 1.44&#x00D7;10<sup>5</sup>.</p>
<p><bold>Figure 2b:</bold> 1000 replicate simulations with the following parameters: C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35, &#x03BC;N &#x003D; 0.025, N &#x003D; 1.44&#x00D7;10<sup>5</sup>.</p>
<p><bold>Figure 2d: simulations with 1 antibiotic:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35, N &#x003D; 1.44&#x00D7;10<sup>5</sup>. &#x03BC;N &#x003D; &#x007B;0.1, 0.0875, 0.075, 0.0625, 0.05, 0.0375, 0.025, 0.0125, 0.00875&#x007D;. 1000 replicate simulations per &#x03BC;N value. Each simulation was run until it reached an ESC-like state.</p>
<p><bold>simulations with 2 antibiotics:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3, N &#x003D; 1.44&#x00D7;10<sup>5</sup>. 1000 replicates per &#x03BC;N were run for 70000 ecological cycles for &#x03BC;N &#x003D; &#x007B;0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2&#x007D;, 5000 replicates were run for 40000 ecological cycles for &#x03BC;N &#x003D; 0.15. 5000 replicates were run for 160000 ecological cycles for &#x03BC;N &#x003D; 0.1.</p>
<p><bold>Figure 3a:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N &#x003D; 0.05.</p>
<p><bold>Figure 3b:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, Cp0 &#x003D; 0.3, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N &#x003D; 0.4.</p>
<p><bold>Figure 3c:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N &#x003D; 0.7.</p>
<p><bold>Figure 4a:</bold> Number of antibiotics &#x003D; 1. C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N &#x003D; 0.05, m &#x003D; &#x007B;0.05, 0.01, 5&#x00D7;10<sup>&#x2212;4</sup>, 5e-5, 1&#x00D7;10<sup>&#x2212;5</sup>, 5&#x00D7;10<sup>&#x2212;6</sup>, 1&#x00D7;10<sup>&#x2212;6</sup>, 5&#x00D7;10<sup>&#x2212;7</sup>, 1&#x00D7;10<sup>&#x2212;7</sup>&#x007D;, H &#x003D; 10. 500 replicate simulations per &#x03BC;N. Each simulation was run until it reached an ESC-like state.</p>
<p><bold>Figure 4c:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.03, C<sub>D</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;4</sup>, C<sub>R</sub> &#x003D; 0.30, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N &#x003D; 2, m &#x003D; 5&#x00D7;10<sup>&#x2212;5</sup>, H &#x003D; 20.</p>
<p><bold>Supplementary Figure 1:</bold> same as <xref ref-type="fig" rid="fig2">Figure 2d</xref>.</p>
<p><bold>Supplementary Figure 2:</bold> same as <xref ref-type="fig" rid="fig2">Figure 2d</xref>.</p>
<p><bold>Supplementary Figure 3a: simulations with 1 antibiotic:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35. N &#x003D; &#x007B;4.32&#x00D7;10<sup>5</sup>, 3.5&#x00D7;10<sup>5</sup>, 2.88&#x00D7;10<sup>5</sup>, 2.16&#x00D7;10<sup>5</sup>, 1.44&#x00D7;10<sup>5</sup>, 7.2&#x00D7;10<sup>4</sup>, 3.6&#x00D7;10<sup>4</sup>&#x007D;, corresponding to &#x03BC;N &#x003D; &#x007B;0.1, 0.083, 0.0667, 0.05, 0.033, 0.01667, 0.00833&#x007D;. 500 replicate simulations per &#x03BC;N were run until they reached an ESC-like state.</p>
<p><bold>simulations with 2 antibiotics</bold>: C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3. N &#x003D; &#x007B;3.6&#x00D7;10<sup>5</sup>, 2.88&#x00D7;10<sup>5</sup>, 2.16&#x00D7;10<sup>5</sup>, 1.44&#x00D7;10<sup>5</sup>, 7.2&#x00D7;10<sup>4</sup>&#x007D;, corresponding to &#x03BC;N &#x003D; &#x007B;1, 0.8, 0.6, 0.4, 0.2&#x007D;. 1000 replicate simulations per &#x03BC;N were run for 70,000 ecological cycles.</p>
<p><bold>Supplementary Figure 3b: simulations with 1 antibiotic:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 2&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.35, N &#x003D; 1.44&#x00D7;10<sup>5</sup>, &#x03BC;N constant at 0.1 and N &#x003D; &#x007B;4.32&#x00D7;10<sup>5</sup>, 3.6&#x00D7;10<sup>5</sup>, 2.88&#x00D7;10<sup>5</sup>, 2.16&#x00D7;10<sup>5</sup>, 1.44&#x00D7;10<sup>5</sup>, 7.2&#x00D7;10<sup>4</sup>, 3.6&#x00D7;10<sup>4</sup>&#x007D;. 1000 replicate simulations per &#x03BC;N were run until they reached an ESC-like state.</p>
<p><bold>simulations with 2 antibiotics:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10 <sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3, &#x03BC;N &#x003D; 0.5 and N &#x003D; &#x007B;3.6&#x00D7;10<sup>5</sup>, 2.88&#x00D7;10<sup>5</sup>, 2.16&#x00D7;10<sup>5</sup>, 1.44&#x00D7;10<sup>5</sup>, 7.2&#x00D7;10<sup>4</sup>&#x007D;. 1000 replicate simulations per &#x03BC;N were run for 70,000 cycles.</p>
<p><bold>Supplementary Figure 4:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10 <sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3, N &#x003D; 1.44&#x00D7;10<sup>&#x2212;5</sup>, &#x03BC;N &#x003D; 0.5.</p>
<p><bold>Supplementary Figure 5:</bold> C<sub>D</sub><sup>0</sup> &#x003D; 0.06, C<sub>D</sub> &#x003D; 8&#x00D7;10<sup>&#x2212;4</sup>, C<sub>P</sub> &#x003D; 4&#x00D7;10<sup>&#x2212;5</sup>, C<sub>R</sub> &#x003D; 0.3, N &#x003D; 1.44 &#x00D7; 10<sup>&#x2212;5</sup>. &#x007B;137, 121, 154&#x007D; trajectories leading to community formation were classified by visual inspection for &#x03BC;N &#x003D; &#x007B;0.8, 0.4, 0.2&#x007D;.</p>
</sec>
</sec>
<sec id="s3" sec-type="data-availability">
<title>Code Availability</title>
<p>The computer code is available from the corresponding author upon request.</p>
</sec>
<sec id="s4" sec-type="data-availability">
<title>Data Availability</title>
<p>The datasets generated during this study are available from the corresponding author upon reasonable request.</p>
</sec>
<sec id="s5" sec-type="supplementary-material">
<title>Supplementary Figures</title>
<fig id="figS1" position="float" fig-type="figure" orientation="portrait">
<label>Supplementary Figure 1.</label>
<caption><title>The community formation time, <italic>T</italic>, is exponentially distributed in simulations with 1 antibiotic.</title>
<p>If <italic>T</italic> is exponentially distributed then Prob(<italic>T</italic> &#x2265; t) &#x003D; exp(&#x2212;rt). Shown are the empirically determined distributions of <italic>T</italic> for different <italic>&#x03BC;N</italic> (black points), demonstrating proportionality between log Prob(<italic>T</italic> &#x2265; <italic>t</italic>) and <italic>t</italic>. The slopes of the fitted lines (blue) provide an estimate of the rate of community emergence <italic>r</italic>.</p></caption>
<graphic xlink:href="271015_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure" orientation="portrait">
<label>Supplementary Figure 2.</label>
<caption><title>The community formation time, <italic>T</italic>, is exponentially distributed in simulations with 2 antibiotics.</title>
<p>If <italic>T</italic>is exponentially distributed then Prob(<italic>T</italic> &#x2265; <italic>t</italic>) &#x003D; exp(&#x2212;<italic>rt</italic>). Shown are the empirically determined distributions of <italic>T</italic> for different <italic>&#x03BC;N</italic> (black points), demonstrating proportionality between log Prob(<italic>T</italic> &#x2265; <italic>t</italic>) and <italic>t</italic>. The slopes of the fitted lines (blue) provide an estimate of the rate of community emergence <italic>r</italic>.</p></caption>
<graphic xlink:href="271015_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure" orientation="portrait">
<label>Supplementary Figure 3.</label>
<caption><title>The community formation rate, <italic>r</italic>, is calculated for different values of <italic>N</italic> at fixed <italic>&#x03BC;</italic> or <italic>&#x03BC;N</italic>.</title>
<p>This complements <xref ref-type="fig" rid="fig2">Fig. 2d</xref>, where <italic>&#x03BC;</italic> is changed at constant <italic>N</italic>. <bold>(a)</bold> <italic>N</italic> is changed at constant <italic>&#x03BC;</italic> in simulations with one antibiotic (blue triangles) and two antibiotics (purple diamonds). The dotted lines are based on the scaling relationships found in <xref ref-type="fig" rid="fig2">Fig. 2d</xref>. The data reveals that <italic>r</italic> exhibits the same scaling with <italic>&#x03BC;</italic> and <italic>N</italic>, indicating that <italic>r</italic>(<italic>&#x03BC;, N</italic>) &#x003D; <italic>r</italic>(<italic>&#x03BC;N</italic>). <bold>(b)</bold> <italic>N</italic> is changed at constant <italic>&#x03BC;N</italic>. For one antibiotic, <italic>r</italic> does not depend on <italic>N</italic> for the examined range. For two antibiotics, <italic>r</italic> depends weakly on <italic>N</italic> at low <italic>N</italic>, but becomes independent of <italic>N</italic> for sufficiently large populations. This data confirms that <italic>r</italic>(<italic>&#x03BC;, N</italic>) &#x003D; <italic>r</italic>(<italic>&#x03BC;N</italic>) for large populations. Therefore, the relevant control parameter is the number of mutations per population per ecological cycle <italic>&#x03BC;N</italic>.</p></caption>
<graphic xlink:href="271015_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure" orientation="portrait">
<label>Supplementary Figure 4.</label>
<caption><title>An alternative trajectory for 5-strain community formation in simulations with 2 antibiotics.</title>
<p>This is a variant of the trajectory presented on <xref ref-type="fig" rid="fig3">Fig. 3c</xref> in which DS and SD strains persist for an extended time even though they are not close in fitness. DS can rapidly outcompete SD if the two strains are alone, but their coexistence is maintained by periodic invasions and extinctions of DP strains, which can kill DS when SD is low in abundance and cannot provide cross-protection.</p></caption>
<graphic xlink:href="271015_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure" orientation="portrait">
<label>Supplementary Figure 5.</label>
<caption><title>The majority of pathways for formation of a 5-strain community fall into 3 categories.</title>
<p>Three main classes of pathways were observed: 1) trajectories that passthrough an ecologically stable intermediate community with 3 strains, as in <xref ref-type="fig" rid="fig3">Fig. 3b</xref> (blue, &#x201C;3-str&#x201D;); 2) trajectories that pass through a SD-DS 2-strain intermediate state that is unstable but persists because of near neutrality, as in <xref ref-type="fig" rid="fig3">Fig. 3c</xref> (yellow, &#x201C;DS-SD&#x201D;); 3) trajectories that pass through a SD-DS intermediate state where the two strains are substantially different in fitness, but persistence is prolonged by periodic invasions and extinctions of producer strains, as in <xref ref-type="fig" rid="figS4">Supplementary Fig. 4</xref> (grey, &#x201C;DS-SD&#x00B1;P&#x201D;). Shown is the proportion of different classes for three different <italic>&#x03BC;N</italic>, as determined by visually scoring of trajectories leading to community formation. The proportion of trajectories that pass through a stepping-stone 3-strain community gradually increases with the decrease of <italic>&#x03BC;N</italic>. Strikingly, the power law scaling of <italic>r</italic> with <italic>&#x03BC;N</italic> is maintained despite the significant changes in the ratios of different channels of community formation.</p></caption>
<graphic xlink:href="271015_figS5.tif"/>
</fig>
</sec>
</back>
</article>