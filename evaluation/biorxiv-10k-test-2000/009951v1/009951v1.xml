<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/009951</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>HiFive: A normalization approach for higher-resolution HiC and 5C chromosome conformation data analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5556-9446</contrib-id>
<name>
<surname>Sauria</surname>
<given-names>Michael E. G.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5556-9446</contrib-id>
<name>
<surname>Phillips-Cremins</surname>
<given-names>Jennifer E.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5556-9446</contrib-id>
<name>
<surname>Corces</surname>
<given-names>Victor G.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5079-840X</contrib-id>
<name>
<surname>Taylor</surname>
<given-names>James</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x00A7;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biology, Emory University</institution>, Atlanta, GA 30322, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Departments of Biology and Computer Science, Johns Hopkins University</institution>, Baltimore, MD 21211, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Bioengineering, University of Pennsylvania</institution>, Philadelphia, PA 19103, <country>USA</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x00A7;</label> Corresponding author Email addresses: MEGS: <email>mgehrin@emory.edu</email> JEPC: <email>jcremins@seas.upenn.edu</email> VGC: <email>vcorces@emory.edu</email> JT: <email>james@taylorlab.org</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2014</year>
</pub-date>
<elocation-id>009951</elocation-id>
<history>
<date date-type="received">
<day>02</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>03</day>
<month>10</month>
<year>2014</year>
</date>
</history><permissions>
<copyright-statement>&#x00A9; 2014, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2014</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="009951.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>While sequencing-based proximity assays have established many megabase-scale features of chromosome organization, experimental noise and biases have left finer-scale organization poorly understood. We developed HiFive, an empirically-driven probabilistic modeling approach for normalizing and analyzing HiC and 5C data. HiFive allows reconstruction of chromatin structural features at higher resolution than previously described and meets or outperforms other approaches. With novel feature detection, denoising, and efficient algorithms, HiFive enables utilization of these data with a fraction of the computational power and time without sacrificing resolution. Using HiFive, we demonstrate transcriptionally-associated differential spatial organization of the mouse genome.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>HiC</kwd>
<kwd>5C</kwd>
<kwd>chromatin conformation</kwd>
<kwd>normalization</kwd>
<kwd>software</kwd>
<kwd>transcriptional activity</kwd>
<kwd>spatial organization</kwd>
</kwd-group>
<counts>
<page-count count="27"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Rationale</title>
<p>Although the vast majority of the human genome was sequenced more than a decade ago, it is clear that sequence alone is insufficient to explain the complex gene and RNA regulatory patterns seen across time and cell type in eukaryotes. The context surrounding sequences&#x2014;whether from combinations of DNA binding transcription factors (TFs) [<xref rid="c1" ref-type="bibr">1</xref>-<xref rid="c3" ref-type="bibr">3</xref>], methylation of the DNA itself [<xref rid="c4" ref-type="bibr">4</xref>, <xref rid="c5" ref-type="bibr">5</xref>], or local histone modifications [<xref rid="c5" ref-type="bibr">5</xref>, <xref rid="c6" ref-type="bibr">6</xref>]&#x2014;is integral to how the cell utilizes each sequence element. Although we have known about the potential roles that sequentially distant but spatially proximal sequences and their binding and epigenetic contexts play in regulating expression and function, it has only been over the past decade that new sequencing-based techniques have enabled high-throughput analysis of higher-order structures of chromatin and investigation into how these structures interact amongst themselves and with other genomic elements, to influence cellular function.</p>
<p>Several different methods for assessing chromatin interactions have been devised, all based on the sequencing of hybrid fragments of DNA created preferentially between spatially close sequences. These approaches include ChIA-Pet [<xref rid="c7" ref-type="bibr">7</xref>], tethered chromosome capture [<xref rid="c8" ref-type="bibr">8</xref>], and the chromatin conformation capture technologies of 3C, 4C, 5C, and HiC [<xref rid="c9" ref-type="bibr">9</xref>-<xref rid="c12" ref-type="bibr">12</xref>] (Supplemental Figure 1; see Supplemental Materials: Proximity-mediated ligation assays). While these assays have allowed a rapid expansion of our understanding of the nature of genome structure, they also have presented some formidable challenges.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1</label>
<caption><title>The software architecture of HiFive.</title>
<p>Self-contained units of information are denoted by boxes, with solid arrows denoting dependencies for object creation. The split line marked &#x2018;fragment assignment&#x2019; depends on the type of data being handled and acts upstream or downstream of the mapped reads objects for 5C and HiC, respectively. Dotted lines denote filters limiting information passed from one object to the next. The dashed line denotes an optional input.</p></caption>
<graphic xlink:href="009951_fig1.tif"/>
</fig>
<p>In both HiC and 5C, systematic biases resulting from the nature of the assays have been observed [<xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c14" ref-type="bibr">14</xref>], resulting in differential representation of sequences in the resulting datasets. While analyses at a larger scale are not dramatically affected by these biases due to the large number of data points being averaged over, higher-resolution approaches must first address these challenges. Several analysis methods have been described in the literature and applied to correcting biases in HiC [<xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c15" ref-type="bibr">15</xref>-<xref rid="c18" ref-type="bibr">18</xref>] and 5C data [<xref rid="c19" ref-type="bibr">19</xref>-<xref rid="c23" ref-type="bibr">23</xref>]. There is still, however, room for improving our ability to remove this systematic noise from the data and resolve finer-scale features.</p>
<p>A second challenge posed by data from these types of assays is one of resources. Unlike other next-generation sequencing assays where even single-base resolution is limited to a few billion data points, these assays assess pairwise combinations, potentially increasing the size of the dataset by several orders of magnitude. For a three billion base-pair genome cut with a six-base restriction enzyme (RE), the number of potential interaction pairs is more than half a trillion. Even allowing that the vast majority of those interactions will be absent from the sequencing data, the amount of information that needs to be handled and the complexity of normalizing these data still pose a major computational hurdle, especially for investigators without access to substantial computational resources.</p>
<p>Here we present HiFive, an analysis method developed for handling both HiC and 5C data using a combination of empirically determined and probabilistic signal modeling. We demonstrate that HiFive allows memory- and computationally-efficient HiC and 5C data handling and normalization while retaining high-resolution data for downstream analyses of interaction signals, making fine-scale chromatin structural analysis accessible to a wider range of investigators.</p>
</sec>
<sec id="s2">
<title>Implementation</title>
<sec id="s2a">
<title>Organization of HiFive</title>
<p>HiFive is based on a hierarchy of data modules stored in HDF5-formatted files (a management structure for handling complex and large sets of data) using the package h5py for easy, compact, and fast access that may be shared across experiments and analyses as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. All aspects of the software are written in Python2 and make use of the Cython and NumPy packages to accelerate computationally intensive operations. This gives HiFive speed similar to C-based code with the human readability and ease of use of Python. In addition, certain scripts and functions support parallelization using the package mpi4py to utilize the Message Passing Interface (MPI), greatly increasing the scalability of analysis. This allows computationally intensive processes to be automatically split across multiple processors on a cluster or multicore computer. The overall goal of this implementation is to reduce storage, memory, and processing power requirements without sacrificing analytical power.</p>
<p>For additional details of HiFive&#x2019;s organization, see <italic>Supplemental Materials: HiFive&#x2019;s organization</italic>.</p>
</sec>
<sec id="s2b">
<title>Data filtering</title>
<p>In both experimental approaches, data are filtered in a two-stage process. After mapping is completed and read pairs have been assigned to fragments or fends for 5C and HiC respectively, a set of filters is applied to the data when creating the final dataset. Once a HiC or 5C object is created and linked to a data object, a second filter is applied (Supplemental Figures 2 and 3).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2</label>
<caption><title>Expanding data interpretation using dynamic binning and the boundary index statistic.</title>
<p>a) A schematic detailing the calculation of the boundary index. The genomic coordinates (along the diagonal) are portioned into regions (red numbers). For each region, all fend interactions are found with fends within some width up (A) and downstream (B) of the boundary point (black circle). b) BI smoothing is accomplished by applying Gaussian-distributed weights to a set of surrounding points and finding the weighted mean. c) BI peaks correspond to changes in enrichment patterns. d) Dynamic binning considers each bin individually, expanding its borders in all directions until a user-defined minimum number of observations have been incorporated or a maximum bin size has been reached. This results in different sized bins containing roughly equivalent amounts of data. e) Unbinned data is shown with unobserved interactions in gray. Dynamically binned data is in the same color scale but has no empty bins as they have been expanded as needed to incorporate sufficient reads. The size of each bin is indicated by the number of potential interactions (both observed and unobserved) that are now included in it.</p></caption>
<graphic xlink:href="009951_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3</label>
<caption><title>5C data normalization and correlation with corresponding HiC data.</title>
<p>a) Methods in the upper panel were compared without removal of the distance-dependent portion of the signal, whereas the lower panel shows the correlations in which the distance-dependent signal was removed. b) Visualization of normalized and logged 5C counts. Colors are scaled to maximize the dynamic range, with blue corresponding to the lowest counts, red to the highest, and white to the midpoint between the two. Gray denotes interactions where no reads were observed. Rows and columns correspond to forward and reverse probes, respectively. c) HiC data corrected using HiFive or HiCPipe and binned using the same boundaries as the 5C data. Coloring is as described for b. Dynamically binned HiC data show bins sized to include 20 interactions per bin.</p></caption>
<graphic xlink:href="009951_fig3.tif"/>
</fig>
<p>The first round of filtering is designed to remove non-valid pairings of reads ends. In 5C, this is limited to read ends that originated from primers with the same orientation. HiC is more complicated due to the random shearing and non-sequence-specific assay approach. There are two primary requirements to be considered a value HiC read. First, the distance between the ends of the sequenced fragment cannot be too long, as inferred by the sum of distances from mapping coordinates to the next downstream restriction site. Second, the pair of read ends cannot have originated as the result of a failed restriction cut, circularization of a single fragment, or sequencing of a PCR duplicate (Supplemental Figure 4). A more detailed discussion about read filtering can be found in the <italic>Supplemental Material: Read filtering</italic>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4</label>
<caption><title>HiC normalization and inter-dataset correlation.</title>
<p>a) HiC data from mouse ESCs produced using HindIII and NcoI were normalized using a number of different analysis methods and intra-chromosomal interaction correlations were compared across a range of bin sizes and maximum interaction distances between the two datasets. Interaction range indicates the largest interaction distance included in for the correlation calculation. b) Heatmap data were dynamically binned prior to calculating inter-dataset correlations. Interaction rangers are as described for panel a. c) Correlation between 1Mb-binned inter-chromosomal interactions across datasets after normalization using a variety of methods. d) Inter-chromosome heatmaps were dynamically binned and inter-dataset correlations were calculated for each of the shown methods.</p></caption>
<graphic xlink:href="009951_fig4.tif"/>
</fig>
<p>Once data objects are created and linked to a HiC or 5C object, a filter based on read coverage can be applied to either. Removal of fragments is accomplished using an iterative filtering process. For each fragment or fend, the number of non-filtered interacting sequences for which the pair had a non-zero read count is calculated within a specified maximum interaction distance range. Sequences with fewer than the specified minimum-count of valid interaction pairs are discarded and the process is repeated until all remaining sequences have at least the minimum number of valid interaction pairs.</p>
</sec>
<sec id="s2c">
<title>Estimation of distance-dependent signal</title>
<p>In both HiC and 5C, the largest influence driving interaction signal intensity is the genomic distance between interaction sequences. Given an experiment with dense-enough coverage at shorter ranges of inter-fragment distances, we observe a roughly power-law function such that the log of the interaction counts varies as a linear function of the log of the inter-fragment distance. We find that this relationship holds best when the distance is measured from midpoint to midpoint of the fragment pair and when considering interactions covering ranges from 1 Kb to 1Mb. Because of the uneven distribution of RE sites throughout the genome, we believe it is imperative that any normalization scheme must take fragment spacing into account in order to generate unbiased estimates of relative interaction frequency. To this end, HiFive finds a distance-dependent signal approximation function prior to normalization and incorporates this function into the calculation of expected counts.</p>
<p>In order to approximate the nearly linear relationship between the log of non-zero counts and the log of inter-fragment distances seen in 5C data, HiFive uses a simple regression approach (Supplemental Figure 5a). Because the log of the counts is used, zeros are necessarily excluded from the calculations. We do not, however, feel that this has any negative impact on parameter estimation. To the contrary, we see increased variation at lower read counts suggesting that unobserved fragment pairs are the least accurate data in the experiment. For valid non-zero interaction counts <italic>s</italic> and distances <italic>d</italic> between fragments <italic>i</italic> and <italic>j,</italic> the distance function <italic>D</italic> is estimated with slope <italic>b</italic> and intercept <italic>a as</italic>:
<disp-formula id="ueqn1">
<alternatives>
<graphic xlink:href="009951_ueqn1.gif"/>
</alternatives>
</disp-formula></p>
<p>Counts, <italic>s</italic>, are valid if not filtered in the creation of the data object and originate from non-filtered fragments. These counts are denoted by subset <italic>A</italic>. The slope is defined as:
<disp-formula id="ueqn2">
<alternatives>
<graphic xlink:href="009951_ueqn2.gif"/>
</alternatives>
</disp-formula>
and the intercept is defined as:
<disp-formula id="ueqn3">
<alternatives>
<graphic xlink:href="009951_ueqn3.gif"/>
</alternatives>
</disp-formula></p>
<p>Once calculated, the intercept is held constant. The slope may be updated throughout the normalization procedure.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5</label>
<caption><title>Boundaries identified using boundary index scoring and associated signals.</title>
<p>Boundaries identified from peaks in pooled HindIII BI signal compared to topological domain boundaries found using DI. a) Interaction enrichment signal for a 5 Mb stretch of chromosome 19 and its associated BI signal, BI peaks, and DI domain boundaries. b) The percentage of DI boundaries that have a BI peaks within a given window size. c) Overlap of BI peaks and DI boundary sets using a 40 Kb cutoff for defining overlap. d) Frequency of annotation data peaks across a 1 Mb window centered on each boundary or peak and binned every 10 Kb.</p></caption>
<graphic xlink:href="009951_fig5.tif"/>
</fig>
<p>HiC data have a similar general relationship between signal and inter-fend distance, though the relationship is not linear over the larger range of distances included. In addition, the sparseness of non-zero interaction counts makes direct assessment of the distance-dependent relationship difficult. HiFive overcomes these challenges by using a piecewise approximation approach (Supplemental Figure 5b). Although other non-parametric options are available that may yield more precise estimates, the size of datasets involved in HiC analysis make them impractical from a computational and time standpoint. To find the piecewise approximation, HiFive begins by splitting interactions into <italic>N</italic> bins of equal log-distance sizes covering the complete range of distances for intra-chromosomal interactions. The mean of each bin is calculated from all valid counts, <italic>s</italic>, spanning the bin&#x2019;s range, where valid interactions exclude those filtered out when creating the HiC data object and those originating from removed fends and are denoted as subset <italic>A</italic>. Thus, for the bin <italic>n</italic> with an upper bound of <italic>c</italic>, the mean <italic>&#x03BC;</italic> is calculated as follows:
<disp-formula id="ueqn4">
<alternatives>
<graphic xlink:href="009951_ueqn4.gif"/>
</alternatives>
</disp-formula></p>
<p>To account for noise in the data, HiFive can apply a triangular smoothing function to the bin means using smoothing parameter <italic>k</italic>, giving the smoothed mean value <italic>&#x03BC;&#x2019;</italic>:
<disp-formula id="ueqn5">
<alternatives>
<graphic xlink:href="009951_ueqn5.gif"/>
</alternatives>
</disp-formula></p>
<p>The HiC distance function is defined as a piecewise linear approximation of these smoothed means, where a bin&#x2019;s mean corresponds to a specific distance <italic>g</italic> falling within its upper and lower boundaries denoted as <italic>cu</italic> and <italic>cl</italic>, respectively:
<disp-formula id="ueqn6">
<alternatives>
<graphic xlink:href="009951_ueqn6.gif"/>
</alternatives>
</disp-formula></p>
<p>For an interaction between fends <italic>i</italic> and <italic>j</italic> with a distance falling between two defined points, such as between the distances denoted by <italic>g</italic> associated with bins <italic>n-1</italic> and <italic>n</italic>, the corresponding distance-mean is estimated:
<disp-formula id="ueqn7">
<alternatives>
<graphic xlink:href="009951_ueqn7.gif"/>
</alternatives>
</disp-formula></p>
</sec>
<sec id="s2d">
<title>Data normalization</title>
<p>HiFive&#x2019;s normalization approach uses a combination of empirical distance-dependence estimation and probabilistic modeling to estimate expected signal and enrichment. HiFive works on two key assumptions. First, the majority of interaction reads are derived from a combination of signal that is dependent on inter-fragment distance and fragment-specific bias. Second, the effects of the fragment biases can be described as the product of the individual biases associated with the interaction fragment pair. Thus the expected signal <italic>E</italic> for the interaction between fragments or fends <italic>i</italic> and <italic>j</italic> is the product of the bias correction <italic>f</italic> for each end of the interaction and the distance function <italic>D</italic> as follows:
<disp-formula id="ueqn8">
<alternatives>
<graphic xlink:href="009951_ueqn8.gif"/>
</alternatives>
</disp-formula></p>
<p>This approach allows adjustment for factors known to contribute to differences in fragment observation rates, such as guanine and cytosine (GC) content, fragment length, and mappability [<xref rid="c13" ref-type="bibr">13</xref>, <xref rid="c15" ref-type="bibr">15</xref>] without explicitly limiting the correction to a specific relationship of factors. Although the general framework is the same for both HiC and 5C, differences in the experimental procedures necessitate technique-specific variants of the distance-dependence function and underlying probability distribution.</p>
<p>The 5C observed interactions are modeled with a log-normal distribution around the predicted values with standard deviation <italic>&#x03C3;</italic> such that:
<disp-formula id="ueqn9">
<alternatives>
<graphic xlink:href="009951_ueqn9.gif"/>
</alternatives>
</disp-formula></p>
<p>The standard deviation is estimated at the same time as the distance-dependence parameters prior to learning fragment corrections such that:
<disp-formula id="ueqn10">
<alternatives>
<graphic xlink:href="009951_ueqn10.gif"/>
</alternatives>
</disp-formula></p>
<p>Because estimated counts change as the corrections are learned, HiFive includes the ability to periodically update the parameters of the distance-dependence function. If specified by the user, the slope <italic>b</italic> in the distance function and <italic>&#x03C3;</italic> are updated, although the term <italic>s</italic><sub><italic>i,j</italic></sub> is replaced with the bias-corrected count <italic>s</italic>&#x2019;<sub><italic>i,j</italic></sub> for calculating these parameters such that:
<disp-formula id="ueqn11">
<alternatives>
<graphic xlink:href="009951_ueqn11.gif"/>
</alternatives>
</disp-formula></p>
<p>HiC interaction counts are modeled as a series of Poisson processes with <italic>&#x03BB;</italic> being defined as the predicted value for a given interaction such that:
<disp-formula id="ueqn12">
<alternatives>
<graphic xlink:href="009951_ueqn12.gif"/>
</alternatives>
</disp-formula></p>
<p>Unlike 5C, only a fraction of interactions are used to learn fend bias corrections. Specifically, counts (including zeros) are included in the model if they belong to the set of valid interactions, they are intra-chromosomal, and the distance between their fends is less than or equal to a user-specified maximum interaction distance range. This is done for two reasons; 1) the vast majority of observed interactions occur over short interaction distances and 2) including all possible interactions or simply all possible <italic>cis</italic> interactions is computationally unfeasible for this kind of model.</p>
<p>Like with 5C data, the HiC distance function can be updated during the learning of fend correction values. This is done by substituting the raw count term <italic>si, j</italic> with the corrected interaction count term <italic>s&#x2019;<sub>i,</sub> <sub>j</sub></italic> as described above for finding the distance bin means.</p>
<p>HiFive learns bias parameters for both HiC and 5C data using a two-stage gradient descent approach that maximizes the likelihood of the observed data under the probability distributions described above. In the burn-in phase, fend or fragment bias parameters are updated using a constant learning rate. This is followed by an annealing phase in which the learning rate decreases in a linear fashion to zero.</p>
</sec>
<sec id="s2e">
<title>HiFive-Express, an iterative approximation method for bias correction</title>
<p>Due to the memory and computational requirements associated with rigorous HiC and 5C normalization, HiFive also includes a fast and computationally inexpensive iterative approximation normalization alternative for both data types referred to as HiFive-Express. HiFive-Express makes use of the same framework and underlying predicted value scheme as HiFive, changing only the approach to bias correction value calculations described above. While the results are not as robust as the more computationally expensive HiFive normalization, they are still sufficient for many applications, allowing resolution down to the individual fragment or fend level depending on assay type. In addition, HiFive-Express can be performed on a single processor in minutes with a comparatively small memory footprint and can easily make use of all data, up to and including trans interactions for HiC data.</p>
<p>Unlike HiFive&#x2019;s probability-based maximization, HiFive-Express attempts to minimize the distance between one and the fraction defined by interaction counts over predicted values. Predicted counts can either be found using bias values alone or with bias and distance function values. The advantage of this approach is two-fold: 1) the calculations are simpler (and therefore faster) than calculating the gradients and 2) because the cost is calculated in terms of a fraction with observed counts as the numerator, zero counts always have a fractional value of zero, reducing the needed calculations down to only observed interactions (a small fraction of the total possible interactions) and a single sum of the number of unobserved interactions, although this second point only applies to HiC data. In addition, because HiFive-Express uses an iterative update, no learning rate parameter is necessary.</p>
<p>In 5C data, the normalization using HiFive-Express is still limited to non-zero interactions as the correction approximation is performed on the log of the observed counts. For each round, the fragment correction value <italic>f</italic><sub><italic>i</italic></sub> is updated as follows from the non-zero subset of observed interactions involving fragment <italic>i</italic>, <italic>A</italic><sub><italic>i</italic></sub>:
<disp-formula id="ueqn13">
<alternatives>
<graphic xlink:href="009951_ueqn13.gif"/>
</alternatives>
</disp-formula></p>
<p>If distance-dependence is not taken into account, <italic>D(d<sub>i,j</sub>)</italic> is set to zero.</p>
<p>HiFive-Express uses a similar approach for HiC data although because counts rather than log counts are used, all valid possible interactions are considered including unobserved interactions. For each round of HiC correction approximation, the fend correction factor <italic>f</italic><sub><italic>i</italic></sub> is updated as follows from the valid set of interactions involving fend <italic>i</italic>, <italic>A</italic><sub><italic>i</italic></sub>:</p>
<p><disp-formula id="ueqn14">
<alternatives>
<graphic xlink:href="009951_ueqn14.gif"/>
</alternatives>
</disp-formula></p>
<p>If distance-dependent signal is ignored, <italic>D(d<sub>i,j</sub>)</italic> is set to one.</p>
</sec>
<sec id="s2f">
<title>Dynamic binning</title>
<p>To avoid the trade-off of resolution versus coverage, HiFive employs a dynamic binning approach that takes an initial partitioning of the data space and adjusts each bin size to meet a user-defined minimum number of interactions (<xref ref-type="fig" rid="fig2">Figure 2a-c</xref>). The search space can be limited, possibly resulting in invalid bins for data-sparse regions, or allowed to run until the criterion has been met for each bin. Initial partitioning can be based on fend or fragment boundaries, uniform-sized bins, or arbitrary user-defined bins. Data used when expanding bins can also be at fend- or fragment-level resolution, uniformly sized, or user-defined. In the case of fend- and fragment-resolution data arrays, bins would expand by a single interaction at a time given the non-uniform spacing, whereas a uniformly spaced data array would expand bins in all directions for a bin-size increase of (n &#x002B; 1) &#x002A; 4 per round, where n is the current number of steps the new boundary is from the bin. This process results in a more informative overview of the data, both visually and with respect to removing the effects of stochasticity from data-sparse regions.</p>
<p>See Supplemental Materials: Need for dynamic binning for further discussion.</p>
</sec>
<sec id="s2g">
<title>Boundary index</title>
<p>One approach that has been useful in marking structurally significant features in chromatin conformation data has been identifying shift-points where interactions move from one set of high-interacting partners to another. Dixon, Selvaraj [<xref rid="c24" ref-type="bibr">24</xref>] described a statistic called the directionality index (DI) that measured the difference in overall interaction strength for upstream versus downstream interactions with a set of fragments. This yields a positive or negative value, depending on the bias. Boundaries are then called using an HMM to determine transition points from upstream to down stream bias in the data. While this has proved useful for identifying what they labeled as topological domains, we find that this approach has limitations in identifying smaller structures and boundary features nested within larger ones. In order to investigate these features, we have devised a variant of this statistic called the boundary index (BI), a statistic that captures shifts in interaction partner preference (<xref ref-type="fig" rid="fig2">Figure 2d</xref> and <xref ref-type="fig" rid="fig2">e</xref>). Because the BI detects interaction preference changes rather than overall bias, it is able to identify small domains and subdomain structures that are missed by the DI described by Dixon, Selvaraj [<xref rid="c24" ref-type="bibr">24</xref>].</p>
<p>The boundary index is found at each RE site by taking fends up and downstream of the site falling in equal sized intervals (&#x201C;width&#x201D;), calculating the log enrichment of interactions between fends in these intervals with groups of fends up and downstream of the site grouped into a specified size intervals (&#x201C;height&#x201D;), up to some maximum distance from the site (&#x201C;window&#x201D;). The BI for that site is the mean absolute difference between enrichments for interactions with fends in the upstream width versus the interactions with fends in the downstream width. Thus for boundary point <italic>P</italic> and width <italic>W</italic>, we define fends in sets <italic>I</italic> and <italic>J</italic>:
<disp-formula id="ueqn15">
<alternatives>
<graphic xlink:href="009951_ueqn15.gif"/>
</alternatives>
</disp-formula></p>
<p>These fends interact with fends within a distance defined by the window upstream and downstream of <italic>P</italic> and divided into equal-sized intervals defined by the height, <italic>H</italic>, such that they make up <italic>N</italic> sets (the number of height-sized bins on one side of <italic>P</italic>) denoted by <italic>K</italic> and <italic>M</italic> for upstream and downstream sets, respectively:
<disp-formula id="ueqn16">
<alternatives>
<graphic xlink:href="009951_ueqn16.gif"/>
</alternatives>
</disp-formula></p>
<p>Thus, the BI for point <italic>P</italic> is:
<disp-formula id="ueqn17">
<alternatives>
<graphic xlink:href="009951_ueqn17.gif"/>
</alternatives>
</disp-formula></p>
<p>A user-defined minimum number of bins must be included in the calculation or <italic>BI</italic> is not found for point <italic>P</italic>. A set of BI values can then be smoothed to reduce noise and enable better peak calling using a Gaussian smoother such that for all BI positions within a distance of 2.5 R of <italic>P</italic>, defined as set <italic>T</italic>, the smoothed value <italic>BI&#x2019;<sub>p</sub></italic> is defined as:
<disp-formula id="ueqn18">
<alternatives>
<graphic xlink:href="009951_ueqn18.gif"/>
</alternatives>
</disp-formula></p>
</sec>
<sec id="s2h">
<title>Three dimensional modeling</title>
<p>By using one of HiFive&#x2019;s various binning options and filling in missing values (and increasing the reliability of non-missing values) using the dynamic binning approach, HiFive provides an easy, fast, and intuitive way to approximate the consensus 3-dimensional conformation of chromatin from the two-dimensional array of interaction data generated using either the HiC or 5C assay. By disabling search-space limitations, HiFive guarantees the production of a completely filled matrix of values. By taking these values as <italic>n</italic> examples with <italic>n</italic> features, we are able to make use of simple dimensionality-reduction approaches such as principal component analysis (PCA) to find sets of three coordinates to best describe the bin-similarities. To do this efficiently, we make use of the fast PCA function within the Python machine learning package mlpy to compute only the first three components, enabling us to apply this to higher-resolution data for more detailed models without prohibitive computing time.</p>
</sec>
</sec>
<sec id="s3">
<title>Results and discussion</title>
<sec id="s3a">
<title>HiC Unit of Interaction</title>
<p>One of the ways that HiFive achieves high resolution of HiC data lies in its treatment of DNA fragments that result from RE digestion of the genome. Both HiC and 5C experiments rely on fractionation of the genome by REs. Unlike 5C, however, HiC data is composed of reads that, theoretically, can map anywhere along the restriction fragments. It has been shown that fragment length is inversely related to interaction signal intensity [<xref rid="c13" ref-type="bibr">13</xref>]. In addition, the HiC assay maps reads with an orientation indicating which end of restriction fragments was ligated. With these two facts in mind, we assessed the similarity between interactions within 1 Mb of a set of fends compared to the adjacent fend on either side of them in the raw data and data corrected for distance-dependence, fend bias, and both. We found that fends originating from the same restriction fragment did not show any more similarity in their non-zero log-interactions with other fragments than adjacent fends originating from neighboring restriction fragments (Supplemental Figure 6). We concluded that the nature of the assay coupled with the filtering of reads results in fends that originate from the same fragment acting as independent units of interaction. As such, for all normalization of downstream analysis, they were treated independently.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6</label>
<caption><title>Three-dimensional interpretations of structural data reveal differential spatial organization of genes by activity.</title>
<p>a) A rendering of the chromosome 3 models showing the fixed width bin model in blue and the BI-peak bin model in red. The dotted white line indicates the section blown up in subfigure b. Strand thickness is proportional to the square root of the ratio of physical spacing of the points versus the sequential distance, such that a thicker strand when a longer sequence length occurs between closer 3D endpoints. b) A skeletal rendering of chromosome 3 with points indicating gene TSSs. Genes are color coded by expression level in FPKMs. c) A model painted with binned annotation data. H3K4me1 and H3K4me3 are shown in red. H3K27me3 and H3K9me3 are shown in blue. LaminB is shown in green. Transcription factor for polymerase IIIC is shown in white. Sizes are proportional to signal strength and signals are binned at 10 Kb intervals. d) A whole genome model rending chromosomes rendered in different colors and proportional strand thickness. e) All mouse genes in the same physical configuration as in panel b and colored according to expression levels. f) Mean relative distances between gene TSSs, binned by expression levels (top and left of plots). All non-observed genes are in a single bin and colored gray in the mean expression scale. Intra-chromosomal distances were determined by calculating the log-ratio of the mean physical distance over the mean sequential distance. Inter-chromosomal distances are simply the mean log-physical distances between TSSs.</p></caption>
<graphic xlink:href="009951_fig6.tif"/>
</fig>
<p>The practical result of assessing fends independently is that the number of possible interacting sites is doubled. Further, this increases the number of interactions and therefore the interaction map resolution by a factor of four compared to assessing whole restriction fragments.</p>
</sec>
<sec id="s3b">
<title>5C Performance</title>
<p>In order to assess HiFive&#x2019;s performance in processing 5C data, we applied HiFive&#x2019;s normalization to mouse 5C data produced by Nora, Lajoie [<xref rid="c19" ref-type="bibr">19</xref>] (Supplemental Table 1) and examined the model fit across a variety of factors. These included assessing the effects of normalization on the distance-dependence relationship, the differences between fragments across their signal strength and variance, the relationship between genomic characteristics and signal strength, and the reproducibility of bias correction values across replicates and methods.</p>
<p>After normalization with HiFive, 5C interactions showed an improved fit to the distance-dependence line (Supplemental Figure 5a). This improvement was seen in both the standard HiFive and HiFive-Express algorithms. Reduction in variance amongst reads of similar inter-fragment distances was particularly strong at low counts. The algorithm used (HiFive vs. HiFive-Express) made little difference in the improvement of fit.</p>
<p>To determine whether systemic biases associated with fragment characteristics were removed, two previously cited sources of systematic noise, fragment length and GC content [<xref rid="c14" ref-type="bibr">14</xref>] were assessed across individual reads as well as for fragment averages. In both cases, the magnitude of the effects (slope of the regression line) was reduced, regardless of the correction algorithm (Supplemental Figure 7). Additionally, there was a marked reduction in signal variance for fragment means for both approaches (Supplemental Figure 8). While fragments showed a wide range of mean log interaction counts prior to bias correction, normalized mean log counts showed little difference and maintained a consistent but slightly lower variance between fragments for both correction algorithms.</p>
<p>We also evaluated HiFive&#x2019;s 5C normalization performance by examining consistency between 5C data and HiC data for the same corresponding region and cell type. At the same time, we compared HiFive against two other methods, the approach described in Nora, Lajoie [<xref rid="c19" ref-type="bibr">19</xref>], a variation of the approach using HiCLib as applied to 5C data described in Naumova, Imakaev [<xref rid="c20" ref-type="bibr">20</xref>], and raw 5C data. The resulting normalized values for each method, along with raw 5C data, were compared to HiC data covering the same region normalized using either HiFive or HiCPipe, both using normal and dynamic binning to account for the lower coverage in the HiC dataset. For the comparisons to the Nora <italic>et al</italic> approach, the distance-dependent signal was removed from both HiFive and HiCPipe-normalized HiC data prior to comparison as the Nora et al approach necessarily removes this portion of the signal. HiFive and HiCLib results were tested both with and without the distance-dependent signal portion present.</p>
<p>Normalizations performed using HiFive showed improved correlation between HiC and 5C data compared to alternative methods and raw 5C signal across both replicates when data was dynamically binned, regardless of HiC normalization method (<xref ref-type="fig" rid="fig3">Figure 3</xref>). HiFive-Express also performs well when comparing 5C data against dynamically binned HiC data. Further, in the absence of the distance-dependent portion of the signal, HiFive-Express still performs well, regardless of the HiC correction method. It is unclear, how valid comparisons to the normally binned HiC are, given the extreme differences in coverage between the two types of assays. The dynamically binned HiC, though, clearly recapitulates all of the same structural features seen in the 5C data, suggesting it is a better standard for validation against. Visually, the biases associated with individual fragments are clearly apparent as striations in the raw data. After correction with HiFive and HiFive-Express, these striations are almost entirely absent. Other methods still show marked striping indicative of incomplete fragment-bias removal.</p>
</sec>
<sec id="s3c">
<title>HiC Performance</title>
<p>To assess HiFive&#x2019;s performance in normalizing HiC data, we applied HiFive&#x2019;s normalization approaches to data from Dixon, Selvaraj [<xref rid="c24" ref-type="bibr">24</xref>] (Supplemental Table 1) and examined the effects of correction across a number of factors. These included the following: correlations of GC content, sequence mappability, and fend length to signal; between-fend signal variation; and correction value differences between data replicates and algorithms. There were hardly any normalization effects on the distance-dependence relationship. For further details, see <italic>Supplemental Materials: HiC normalization and distance-dependence</italic>.</p>
<p>Examining the effects of fend length, GC content, and mappability, we find that only the former and latter show a strong influence on the mean signal of its associated fend, although average GC content does show some influence on signal after removing the distance-dependence portion of the signal (Supplemental Figure 10). Correction using HiFive and HiFive-Express both greatly reduced effects of length, mappability, and GC content to the extent that it was present. Only HiFive reduced the variance among fend means for counts with and without the distance-dependent signal present while HiFive-Express appeared to overcorrect if distance-dependence was still included in the signal when stats were calculated. When the distance-dependent signal was removed prior to finding fend means, the variance for interactions corrected with HiFive-Express was reduced to nearly zero, reflecting fundamental differences in the underlying transformation of counts between these two approaches for HiC data. These correction trends held for correction of both HindIII- and NcoI-produced data. Comparing these same effects on bias relationships in data corrected by HiCPipe, we found much higher variance and stronger bias relationships after normalization (Supplemental Figure 11). The large variance in counts is especially interesting given the mappability cutoff of that HiCPipe recommends of 50&#x0025;. HiCNorm could not be included due to the unreasonable resources needed to produce fend-level corrections ad HiCLib was not included because its performance was comparable to HiFive&#x2019;s (see below).</p>
<p>Next, we examined the range of fend means and variance across all valid fends before and after correction. Raw fend means showed a large range of means and variances for counts within one Mb interaction range for both cis and trans interactions (Supplemental Figures 12 and 13). After correction with either HiFive or HiFive-Express, fend means and variances were highly consistent, although variances were slightly higher when HiFive-Express was used in both cis and trans interactions. This was true regardless of RE used. Conversely we see the trend of increasing means persist to a much larger percent in HiCPipe-corrected data for both RE-produced datasets (Supplemental Figures 14 and 15). We also found that fend variance for cis interactions was much more varied across bins.</p>
<p>To assess the effectiveness of HiFive&#x2019;s HiC normalization compared to other methodologies, we examined correlations of corrected data across datasets produced using different REs. To do this, normalized data was generated for each dataset using HiFive, HiFive-Express, HiCPipe [<xref rid="c13" ref-type="bibr">13</xref>], HiCLib [<xref rid="c16" ref-type="bibr">16</xref>], and HiCNorm [<xref rid="c15" ref-type="bibr">15</xref>]. Data were binned at four resolutions, 10 Kb, 25 Kb, 100 Kb and 1 Mb, and inter-dataset correlations were calculated across a series of maximum interaction distance ranges for cis interactions. Trans interaction correlations were also determined at the 1 Mb resolution.</p>
<p>At the 1 Mb and 100 Kb resolutions, HiFive showed superior performance to all other methods across all interaction (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). HiCPipe performed nearly as well at these lower resolutions, followed by HiCNorm. HiFive-Express performed equal or better to HiCPipe using 100 Kb bins and just slightly worse than HiCPipe using 1 Mb bins across all interaction distance ranges. Neither HiCNorm nor HiCLib matched the performance of HiFive, HiFive-Express, or HiCPipe at the 1 Mb bin size. At the 100 Kb bin size, HiCLib was below the other methods and for all but the shortest interaction range cutoffs, HiCNorm performed nearly identically to HiCPipe. At 25 Kb, HiFive and HiFive-Express outperformed other methods, though HiFive-Express actually showed better inter-dataset correlations for short range interactions than the standard HiFive normalization. At the 10 Kb resolution, HiFive showed a slight performance dip relative to HiCPipe and HiFive-Express when comparing interactions under 200 Kb apart, though HiFive-Express still outperformed HiCPipe across all ranges and both showed better performance than HiCNorm and HiCLib. Including interactions with ranges greater than 200 Kb, HiFive showed better agreement between datasets than HiCPipe.</p>
<p>We believe one of HiFive&#x2019;s strengths is its ability to predict expected values for unobserved interactions. To assess this in the context dataset correlations, we dynamically binned data at the 25 Kb, 100 Kb, and 1 Mb bin sizes and reran the correlation analysis between RE datasets (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). HiCLib was excluded because dynamic binning requires predicted counts to calculate while HiCLib returns only corrected values. Across all size ranges and bin sizes, HiFive showed superior performance. HiFive-Express also performed the second best for all but 1 Mb binned data.</p>
<p>Although they were designed with short-range interactions and high-resolution analysis as their target purpose, HiFive and HiFive-Express still performed relatively well in normalizing trans interactions (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). Interestingly, HiFive-Express performed better on this measure than HiFive, showing performance just slightly below that of HiCPipe. We also examined trans-interaction correlations after dynamically binning the trans interaction heatmaps. While all correlations increased, the performance of HiFive, HiFive-Express and HiCPipe more than double when using dynamically binned data. Further, HiFive showed superior performance to HiFive-Express, though neither quite reaches the level of correlations produced by HiCPipe for trans interactions. For further discussion on the two algorithmic approaches and their differing performances, see <italic>Supplemental Materials: HiFive&#x2019;s HiC algorithm performance differences</italic>.</p>
</sec>
<sec id="s3d">
<title>The boundary index captures more significant features than the directionality index</title>
<p>To verify the performance of our boundary index statistic, we began by using a cutoff yielding 3,078 peaks and comparing these to the 3,051 TAD boundaries generated by Dixon, Selvaraj [<xref rid="c24" ref-type="bibr">24</xref>] across chromosomes 1-19. We found that there was a high amount of overlap between the two sets of boundary calls with more than 60&#x0025; of the DI-based boundaries in regions with BI coverage falling within 40 Kb of a BI-based peak (<xref ref-type="fig" rid="fig5">Figure 5</xref>). We partitioned boundaries into overlapping and unique and then found occupancy profiles for them based on CTCF, Smc1, H3K4me3, and PolII occupancy sites as well as TSS locations (Supplemental Table 2) [<xref rid="c25" ref-type="bibr">25</xref>-<xref rid="c27" ref-type="bibr">27</xref>]. Occupancy data was found up and downstream of each and binned at 10 Kb intervals. In sites that were considered equivalent between the two methods, we found nearly identical profiles, although signal was higher for the transcriptionally associated features H3K4me3, PolII, and TSSs centered on BI peaks. We attribute this to finer-scale positioning of the boundary. Across sites unique to each method, the general profile shape was similar. Like the overlapping sites, though, we saw a stronger signal for boundary sites generated using the DI method, particularly at the boundary site itself. Interestingly, we saw an increased background signal in unique BI-called sites compared to unique DI boundaries. This may be indicative of BI-called sites having a higher sensitivity for finding structural features occurring within domains as a higher background suggests additional structure features are occurring in relatively close proximity to these sites.</p>
</sec>
<sec id="s3e">
<title>Three-dimensional modeling</title>
<p>HiFive&#x2019;s modeling strategy was assessed by determining the ability of its structural modeling approach to reproduce the fend-corrected interaction signal based on coordinate-distances alone for individual chromosomes as well as across the whole genome simultaneously. Two segmentations were used to create the distance matrices used for coordinate estimation, a partitioning based on BI peaks and a fixed-width binning producing a comparable number of breaks. After dynamically binning the data to create complete distance matrices, we used the mlpy fast-PCA algorithm to calculate the first three components as coordinates.</p>
<p>The PCA-based modeling approach, when coupled with dynamic binning for complete distance matrices shows a high degree of robustness. Correlations between models and data ranged from 82.5-88.9&#x0025; (86.1&#x0025; mean) and 82.7-89.2&#x0025; (86.5&#x0025; mean) for BI-peak and fixed width partitioning, respectively (Supplemental Figure 17). The whole genome models showed much lower correlations between model predictions and data at 44.5&#x0025; and 41.7&#x0025; for BI-peak and fixed width approaches, respectively. Comparisons between distance matrices for the two alternate binning approaches showed extremely high correlation with individual chromosome model correlations ranging from 98.27-99.97&#x0025; (99.67&#x0025; mean) and 99.39&#x0025; correlation between whole genome models. This consistence in resulting models is also apparent when directly comparing the shaped and structures produced in 3D renderings of the chromosomes. Further results can be found in <italic>Supplemental Materials: Three-dimensional modeling</italic>.</p>
<p>Examining the physical shape of the modeled chromosomes, two distinct features are evident both in the individual and whole genome models (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). The chromatin appears to exist predominantly as a combination of two different states: tight, dense coils occupying a small volume of space, and de-condensed stretches looped or folded back and forth creating accessible but still fairly low-volume compartments of chromatin. In both individual and whole genome models, there appears to be a polarization of states with the tightly coiled condensed chromatin orienting in the same general direction suggesting either a common characteristic or external organizer restricting the spatial arrangement of these condensed domains. While we feel confident in the organization of small structures suggested by this modeling approach, we do acknowledge that it is based on data produced from a heterogeneous population and a mix of interactions from pairs of homologous chromosomes. That being said, the smaller structures are likely to be stable and reproducible, whereas the whole chromosome shape or relative positioning amongst chromosomes is an amalgam of configurations representing general organizational trends that likely do hold for large portions of the assayed cell population.</p>
</sec>
<sec id="s3f">
<title>Spatial organization of transcriptional activity</title>
<p>In order to assess the interplay between physical conformation of the chromatin and transcription, we used expression data from Shen, Yue [<xref rid="c26" ref-type="bibr">26</xref>], placing gene TSSs in their approximate locations in space according to our physical models. The physical placement of gene TSSs within the modeled chromatin, both on an individual and whole genome basis, showed a polarization of gene clusters corresponding to expression levels (<xref ref-type="fig" rid="fig6">Figure 6b</xref> and <xref ref-type="fig" rid="fig6">e</xref>). Genes with few or no detectable transcripts are seen clustered together and away from transcriptionally active genes, which are located on less condensed stretches of chromatin and tend towards the opposite region of chromosome-occupied space. This trend is also visible in the whole genome model, with the majority of low expression genes presenting in a sheet across the top of the model and active genes existing on parallel strands extending away from this sheet and converging in space. Interestingly, the highly compact coils appear mainly devoid of genes and are flanked by groups of inactive genes. To quantify this spatial organization, we examined the physical spacing of TSSs with respect to each other partitioned by expression level.</p>
<p>Using this approach we find that expression level is predictive of gene spacing such that low expression gene TSSs are spaced further apart from each other and from more highly expressed genes, given the intervening sequence between them, compared with pairs of more highly expressed genes. This holds true for both intra- and inter-chromosomal gene spacing, suggesting that not only are transcriptionally active genes occupying a separate space from less or non-transcribed genes but also that active genes are being brought together in a way that silent genes are not. It is unclear whether this is an active shepherding process or a consequence of the genes&#x2019; transcriptional activity but these observations hold with other experimental data about the co-localization of co-expressed genes [<xref rid="c28" ref-type="bibr">28</xref>-<xref rid="c30" ref-type="bibr">30</xref>]. In addition, although clustering of inactive genes is not seen in individual chromosomes, we do see shorter distances amongst inactive or very low expression genes.</p>
<p>To examine additional organizing features, we painted the interaction models using a series of genomic annotations (<xref ref-type="fig" rid="fig6">Figure 6c</xref>, Supplemental Table 3). To mark regions associated with active PolII transcription we used H3K4me1 and H3K4me3 [<xref rid="c6" ref-type="bibr">6</xref>]. Repressive regions were marked with H3K9me3 and H3K27me3. Lamin-associated domains (LADs) were marked using Lamin B [<xref rid="c31" ref-type="bibr">31</xref>]. We also marked regions of RNA polymerase III (PolIII) activity with transcription factor for polymerase III C (TFIIIC) associated with PolIII [<xref rid="c32" ref-type="bibr">32</xref>]. Because these are regions associated with transcribing tRNAs and 5S RNAs which have both been shown to localize to the nucleolar periphery, this mark served as our surrogate for nucleolar-associated domains (NADs) [<xref rid="c33" ref-type="bibr">33</xref>]. There is an extreme polarization between LADs and TFIIIC regions. We also noted that TFIIIC marked regions showed an increased compaction compared to other actively transcribed regions. Active marks for PolII transcription occurred in chromatin regions surrounding TFIIIC marks and far from Lamin B. Repressive marks flanked Lamin B-associated regions and tended to show little association with TFIIIC. Based on these consistent findings across all chromosomes (Supplemental Figures 18-36), we propose that LADs and NADs serve as scaffolds in nuclear organization, allowing locally controlled formation of domains in stretches between LAD and NAD connections but globally arranging positions of these domains to some extent along the radius of the nucleus (Supplemental Figure 37). This is a particularly intriguing possibility as Lamin A/C and BAF competitively compete with Lamin B chromatin binding regions and Lamin A/C has been shown to co-localize to the nucleolar periphery while Lamin B shows no such localization [<xref rid="c34" ref-type="bibr">34</xref>]. Coupled with the observation that some LADs overlap with identified NADs, this may serve as a mechanism for regulating pluripotency and lineage specificity [<xref rid="c33" ref-type="bibr">33</xref>, <xref rid="c35" ref-type="bibr">35</xref>].</p>
</sec>
</sec>
<sec id="s4">
<title>Conclusions</title>
<p>HiFive provides an easy-to-use, fast, and efficient framework for working with a variety of chromatin conformation data types. Because of the modular storage scheme, re-analysis and downstream analysis is made easier without additional storage requirements. We have attempted to make all aspects of the normalization procedures adjustable, allowing tuning of these analysis approaches to a user&#x2019;s specific needs. HiFive&#x2019;s approach relies solely on interaction data to find bias corrections, meaning that it is limited to higher sequencing depth experiments. However, as sequencing costs become cheaper we do not foresee coverage in experiments decreasing but rather the opposite. Although other methods like HiCPipe and HiCNorm may have comparable results in some scenarios, the output is more difficult to work and limited to a simple heatmap and model parameters. We also found that HiFive performs better in removing known sources of variance than HiCPipe at resolutions not practical with HiCNorm. HiFive provides support to any number of manipulations of the data on the fly by providing library of tools. HiFive also provides the only ready-to-use normalization approach for basic 5C data analysis. In addition to rigorous normalization of data, HiFive also provides users with alternative options for fast analysis with minimal computational requirements at only a slight accuracy cost, opening high-resolution HiC and 5C analysis to a much larger portion of the scientific community. HiFive can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/bxlab/hifive">https://bitbucket.org/bxlab/hifive</ext-link>.</p>
</sec>
</body>
<back>
<sec>
<title>List of abbreviations used</title>
<def-list>
<def-item>
<term>TF</term>
<def><p>transcription factor;</p></def>
</def-item>
<def-item>
<term>MPI</term>
<def><p>message parsing interface;</p></def>
</def-item>
<def-item>
<term>Fend</term>
<def><p>fragment end;</p></def>
</def-item>
<def-item>
<term>RE</term>
<def><p>restriction enzyme;</p></def>
</def-item>
<def-item>
<term>DI</term>
<def><p>directionality index;</p></def>
</def-item>
<def-item>
<term>BI</term>
<def><p>boundary index;</p></def>
</def-item>
<def-item>
<term>ESC</term>
<def><p>embryonic stem cell;</p></def>
</def-item>
<def-item>
<term>bp</term>
<def><p>base pair;</p></def>
</def-item>
<def-item>
<term>Kb</term>
<def><p>kilobase;</p></def>
</def-item>
<def-item>
<term>Mb</term>
<def><p>megabase;</p></def>
</def-item>
<def-item>
<term>FPKM</term>
<def><p>fragments per kilobase of exon per million fragments mapped;</p></def>
</def-item>
<def-item>
<term>TSS</term>
<def><p>transcription start site;</p></def>
</def-item>
<def-item>
<term>GEO</term>
<def><p>Gene Expression Omnibus.</p></def>
</def-item>
<def-item>
<term>3C</term>
<def><p>chromosome conformation capture;</p></def>
</def-item>
<def-item>
<term>5C</term>
<def><p>chromosome conformation capture carbon copy;</p></def>
</def-item>
<def-item>
<term>TFIIIC</term>
<def><p>transcription factor for polymerase III C.</p></def>
</def-item>
</def-list>
</sec>
<sec sec-type="COI-statement">
<title>Competing interests</title>
<p>The authors declare that they have no competing interests.</p>
</sec>
<sec>
<title>Authors&#x2019; contributions</title>
<p>MEGS, JEPC, VGC, and JT conceived the project and developed feature requirements. JEPC made significant contributions to the design of the 5C tools. MEGS developed all algorithms, designed and wrote all software, and wrote the manuscript. JT contributed to the manuscript and supported the project. All authors read and approved the final manuscript.</p>
</sec>
<sec>
<title>Additional data files</title>
<p>The following additional data files are available with the online version of the paper. Additional data file 1 contains a detailed methods section, three tables listing the sources of datasets used, and supplemental figures. Additional data file 2 contains HiFive documentation. Additional data file 3 contains a tar archive containing the HiFive library, including a set of useful scripts for using the library. Additional data file 4 contains a tar archive containing all scripts using to generate the data, analyses, and figures presented in this paper.</p>
<ack>
<title>Acknowledgements</title>
<p>Research reported in this publication was supported by the National Institutes of Health under awards R01GM035463 to VC and R01DK065806 to JT and by American Recovery and Reinvestment Act (ARRA) funds through grant number RC2HG005542 to JT. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
</ack>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Arnone</surname>, <given-names>M.I.</given-names></string-name> and <string-name><given-names>E.H.</given-names> <surname>Davidson</surname></string-name>, <source>The hardwiring of development: organization and function of genomic regulatory systems. Development</source>, <year>1997</year>. <volume>124</volume>(<issue>10</issue>): p. <fpage>1851</fpage>&#x2013;<lpage>64</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Zinzen</surname>, <given-names>R.P.</given-names></string-name>, <etal>et al.</etal>, <article-title>Combinatorial binding predicts spatio-temporal cis-regulatory activity</article-title>. <source>Nature</source>, <year>2009</year>. <volume>462</volume>(<issue>7269</issue>): p. <fpage>65</fpage>&#x2013;<lpage>70</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>He</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal>, <article-title>Co-occupancy by multiple cardiac transcription factors identifies transcriptional enhancers active in heart</article-title>. <source>Proc Natl Acad Sci U S A</source>, <year>2011</year>. <volume>108</volume>(<issue>14</issue>): p. <fpage>5632</fpage>&#x2013;<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Varriale</surname>, <given-names>A.</given-names></string-name>, <article-title>DNA Methylation, Epigenetics, and Evolution in Vertebrates: Facts and Challenges</article-title>. <source>Int J Evol Biol</source>, <year>2014</year>. <volume>2014</volume>: p. <fpage>475981</fpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Cantone</surname>, <given-names>I.</given-names></string-name> and <string-name><given-names>A.G.</given-names> <surname>Fisher</surname></string-name>, <article-title>Epigenetic programming and reprogramming during development</article-title>. <source>Nat Struct Mol Biol</source>, <year>2013</year>. <volume>20</volume>(<issue>3</issue>): p. <fpage>282</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Kimura</surname>, <given-names>H.</given-names></string-name>, <article-title>Histone modifications for human epigenome analysis</article-title>. <source>J Hum Genet</source>, <year>2013</year>. <volume>58</volume>(<issue>7</issue>): p. <fpage>439</fpage>&#x2013;<lpage>45</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="other"><string-name><surname>Fullwood</surname>, <given-names>M.J.</given-names></string-name>, <etal>et al.</etal>, <article-title>Chromatin interaction analysis using paired-end tag sequencing</article-title>. <source>Curr Protoc Mol Biol</source>, <year>2010</year>. Chapter 21: p. Unit 21 15 <fpage>1</fpage>&#x2013;<lpage>25</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Kalhor</surname>, <given-names>R.</given-names></string-name>, <etal>et al.</etal>, <article-title>Genome architectures revealed by tethered chromosome conformation capture and population-based modeling</article-title>. <source>Nat Biotechnol</source>, <year>2012</year>. <volume>30</volume>(<issue>1</issue>): p. <fpage>90</fpage>&#x2013;<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Dekker</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal>, <article-title>Capturing chromosome conformation</article-title>. <source>Science</source>, <year>2002</year>. <volume>295</volume>(<issue>5558</issue>): p. <fpage>1306</fpage>&#x2013;<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>Z.</given-names></string-name>, <etal>et al.</etal>, <article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title>. <source>Nat Genet</source>, <year>2006</year>. <volume>38</volume>(<issue>11</issue>): p. <fpage>1341</fpage>&#x2013;<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Dostie</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal>, <article-title>Chromosome Conformation Capture Carbon Copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>. <source>Genome Res</source>, <year>2006</year>. <volume>16</volume>(<issue>10</issue>): p. <fpage>1299</fpage>&#x2013;<lpage>309</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Lieberman-Aiden</surname>, <given-names>E.</given-names></string-name>, <etal>et al.</etal>, <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <year>2009</year>. <volume>326</volume>(<issue>5950</issue>): p. <fpage>289</fpage>&#x2013;<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Yaffe</surname>, <given-names>E.</given-names></string-name> and <string-name><given-names>A.</given-names> <surname>Tanay</surname></string-name>, <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>. <source>Nat Genet</source>, <year>2011</year>. <volume>43</volume>(<issue>11</issue>): p. <fpage>1059</fpage>&#x2013;<lpage>65</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>van Berkum</surname>, <given-names>N.L.</given-names></string-name> and <string-name><given-names>J.</given-names> <surname>Dekker</surname></string-name>, <article-title>Determining spatial chromatin organization of large genomic regions using 5C technology</article-title>. <source>Methods Mol Biol</source>, <year>2009</year>. <volume>567</volume>: p. <fpage>189</fpage>&#x2013;<lpage>213</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Hu</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal>, <article-title>HiCNorm: removing biases in Hi-C data via Poisson regression</article-title>. <source>Bioinformatics</source>, <year>2012</year>. <volume>28</volume>(<issue>23</issue>): p. <fpage>3131</fpage>&#x2013;<lpage>3</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Imakaev</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal>, <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>. <source>Nat Methods</source>, <year>2012</year>. <volume>9</volume>(<issue>10</issue>): p. <fpage>999</fpage>&#x2013;<lpage>1003</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Jin</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal>, <article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>. <source>Nature</source>, <year>2013</year>. <volume>503</volume>(<issue>7475</issue>): p. <fpage>290</fpage>&#x2013;<lpage>4</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Hu</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal>, <article-title>Bayesian inference of spatial organizations of chromosomes</article-title>. <source>PLoS Comput Biol</source>, <year>2013</year>. <volume>9</volume>(<issue>1</issue>): p. <fpage>e1002893</fpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Nora</surname>, <given-names>E.P.</given-names></string-name>, <etal>et al.</etal>, <article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>. <source>Nature</source>, <year>2012</year>. <volume>485</volume>(<issue>7398</issue>): p. <fpage>381</fpage>&#x2013;<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Naumova</surname>, <given-names>N.</given-names></string-name>, <etal>et al.</etal>, <article-title>Organization of the mitotic chromosome</article-title>. <source>Science</source>, <year>2013</year>. <volume>342</volume>(<issue>6161</issue>): p. <fpage>948</fpage>&#x2013;<lpage>53</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Sanyal</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal>, <article-title>The long-range interaction landscape of gene promoters</article-title>. <source>Nature</source>, <year>2012</year>. <volume>489</volume>(<issue>7414</issue>): p. <fpage>109</fpage>&#x2013;<lpage>13</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Phillips-Cremins</surname>, <given-names>J.E.</given-names></string-name>, <etal>et al.</etal>, <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>. <source>Cell</source>, <year>2013</year>. <volume>153</volume>(<issue>6</issue>): p. <fpage>1281</fpage>&#x2013;<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Rousseau</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal>, <article-title>Three-dimensional modeling of chromatin structure from interaction frequency data using Markov chain Monte Carlo sampling</article-title>. <source>BMC Bioinformatics</source>, <year>2011</year>. <volume>12</volume>: p. <fpage>414</fpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Dixon</surname>, <given-names>J.R.</given-names></string-name>, <etal>et al.</etal>, <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>, <year>2012</year>. <volume>485</volume>(<issue>7398</issue>): p. <fpage>376</fpage>&#x2013;<lpage>80</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Ren</surname>, <given-names>B.</given-names></string-name> <source>Mouse Encode Project at Ren Lab</source>. Available from:<ext-link ext-link-type="uri" xlink:href="http://chromosome.sdsc.edu/mouse/download.html">http://chromosome.sdsc.edu/mouse/download.html</ext-link>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Shen</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal>, <article-title>A map of the cis-regulatory sequences in the mouse genome</article-title>. <source>Nature</source>, <year>2012</year>. <volume>488</volume>(<issue>7409</issue>): p. <fpage>116</fpage>&#x2013;<lpage>20</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Kagey</surname>, <given-names>M.H.</given-names></string-name>, <etal>et al.</etal>, <article-title>Mediator and cohesin connect gene expression and chromatin architecture</article-title>. <source>Nature</source>, <year>2010</year>. <volume>467</volume>(<issue>7314</issue>): p. <fpage>430</fpage>&#x2013;<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>Z.W.</given-names></string-name>, <etal>et al.</etal>, <article-title>Spatial organization of RNA polymerase II inside a mammalian cell nucleus revealed by reflected light-sheet superresolution microscopy</article-title>. <source>Proc Natl Acad Sci U S A</source>, <year>2014</year>. <volume>111</volume>(<issue>2</issue>): p. <fpage>681</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal>, <article-title>Chromatin connectivity maps reveal dynamic promoter-enhancer long-range associations</article-title>. <source>Nature</source>, <year>2013</year>. <volume>504</volume>(<issue>7479</issue>): p. <fpage>306</fpage>&#x2013;<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Rieder</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal>, <article-title>Co-expressed genes prepositioned in spatial neighborhoods stochastically associate with SC35 speckles and RNA polymerase II factories</article-title>. <source>Cell Mol Life Sci</source>, <year>2014</year>. <volume>71</volume>(<issue>9</issue>): p. <fpage>1741</fpage>&#x2013;<lpage>59</lpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Shimi</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal>, <article-title>The A- and B-type nuclear lamin networks: microdomains involved in chromatin organization and transcription</article-title>. <source>Genes Dev</source>, <year>2008</year>. <volume>22</volume>(<issue>24</issue>): p. <fpage>3409</fpage>&#x2013;<lpage>21</lpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Carriere</surname>, <given-names>L.</given-names></string-name>, <etal>et al.</etal>, <article-title>Genomic binding of Pol III transcription machinery and relationship with TFIIS transcription factor distribution in mouse embryonic stem cells</article-title>. <source>Nucleic Acids Res</source>, <year>2012</year>. <volume>40</volume>(<issue>1</issue>): p. <fpage>270</fpage>&#x2013;<lpage>83</lpage>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Nemeth</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal>, <article-title>Initial genomics of the human nucleolus</article-title>. <source>PLoS Genet</source>, <year>2010</year>. <volume>6</volume>(<issue>3</issue>): p. <fpage>e1000889</fpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Kind</surname>, <given-names>J.</given-names></string-name> and <string-name><given-names>B.</given-names> <surname>van Steensel</surname></string-name>, <article-title>Stochastic genome-nuclear lamina interactions: Modulating roles of Lamin A and BAF</article-title>. <source>Nucleus</source>, <year>2014</year>. <volume>5</volume>(<issue>2</issue>): p. <fpage>124</fpage>&#x2013;<lpage>130</lpage>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>van Koningsbruggen</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal>, <article-title>High-resolution whole-genome sequencing reveals that specific chromatin domains from most human chromosomes associate with nucleoli</article-title>. <source>Mol Biol Cell</source>, <year>2010</year>. <volume>21</volume>(<issue>21</issue>): p. <fpage>3735</fpage>&#x2013;<lpage>48</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>