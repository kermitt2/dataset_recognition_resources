<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/371039</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Every which way? On predicting tumor evolution using cancer progression models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6637-9039</contrib-id>
<name>
<surname>Diaz-Uriarte</surname>
<given-names>Ramon</given-names>
</name>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Vega</surname>
<given-names>Claudia Vasallo</given-names>
</name>
</contrib>
<aff id="a1"><institution>Dept. Biochemistry, Universidad Aut&#x00F3;noma de Madrid, Instituto de Investigaciones Biom&#x00E9;dicas &#x201C;Alberto Sols&#x201D; (UAM-CSIC)</institution>, Madrid, <country>Spain</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>To whom correspondence should be addressed: <email>ramon.diaz@iib.uam.es</email>, <email>rdiaz02@gmail.com</email>, <ext-link ext-link-type="uri" xlink:href="http://ligarto.org/rdiaz">http://ligarto.org/rdiaz</ext-link></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2018</year>
</pub-date>
<elocation-id>371039</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>17</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>7</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="371039.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Cancer progression models (CPMs) use cross-sectional samples to identify restrictions in the order of accumulation of driver mutations. CPMs implicitly encode all the possible tumor progression paths or evolutionary trajectories during cancer progression, which can be of help for diagnostic, prognostic, and treatment purposes. Here we examine whether CPMs can be used to predict the true distribution of tumor progression paths and to estimate evolutionary unpredictability. Using simulations we show that the agreement between the true and the predicted distributions of paths is generally poor, unless sample sizes are very large and fitness landscapes are single peaked (have a single global fitness maximum). Under other fitness landscapes, performance is poor and only improves slightly with increasing sample size. Detection regime can be a key determinant of performance, and evolutionary unpredictability hurts performance except under regimes with very low sample variability. Estimates of evolutionary unpredictability from CPMs tend to overestimate the true unpredictability and the bias is affected by detection regime; CPMs could be useful for estimating upper bounds to the true evolutionary unpredictability. Analysis of eleven cancer data sets supports the relevance of detection regime and shows estimates of evolutionary unpredictability in regions where useful prediction might possible for at least some data sets. But the evolutionary trajectory predictions themselves are unreliable. Our results indicate that, currently, obtaining useful predictions of tumor progression paths from CPMs is dubious and emphasize the need for methodological work that can account for the probably multi-peaked fitness landscapes in cancer.</p>
</abstract>
<counts>
<page-count count="27"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Cancer progression models (CPMs), such as CBN (<xref ref-type="bibr" rid="c28"><italic>Gerstung et al.</italic>, 2009</xref>), CAPRI (<xref ref-type="bibr" rid="c54">Ramazzotti <italic>et al.</italic>, 2015</xref>), or OT (<xref ref-type="bibr" rid="c60">Szabo and Boucher, 2008</xref>), have been developed to identify restrictions in the order of accumulation of mutations during tumor progression from cross-sectional data (<xref ref-type="bibr" rid="c5"><italic>Beerenwinkel et al.</italic>, 2015</xref>, <xref ref-type="bibr" rid="c6">2016</xref>). The identification of these constraints can help find therapeutic targets and disease markers. CPMs also implicitly encode all the possible mutational paths or trajectories of tumor progression, from the initial genotype to the genotype with all driver genes mutated, and the identification of these paths or &#x201C;evolutionary trajectories&#x201D; is a prominent idea in recent CPM publications (e.g. <xref ref-type="bibr" rid="c13"><italic>Caravagna et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c54"><italic>Ramazzotti et al.</italic>, 2015</xref>). Knowing the likely paths of tumor evolution is helpful for diagnostic, prognostic, and treatment purposes as, for example, it would allow us to identify genes that block the most likely paths (<xref ref-type="bibr" rid="c30">Greaves, 2015</xref>; <xref ref-type="bibr" rid="c37"><italic>Lipinski et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c42"><italic>McPherson et al.</italic>, 2018</xref>). This interest in predicting paths of progression is, of course, not exclusive to cancer (see reviews in <xref ref-type="bibr" rid="c35"><italic>L&#x00E4;ssig et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c39">Losos, 2018</xref>). For example, in some cases antibiotic resistance shows parallel evolution with mutations being acquired in a similar order (<xref ref-type="bibr" rid="c63"><italic>Toprak et al.</italic>, 2012</xref>), and here &#x201C;Even a modest predictive power might improve therapeutic outcomes by informing the selection of drugs, the preference between monotherapy or combination therapy and the temporal dosing regimen (&#x2026;)&#x201D; (<xref ref-type="bibr" rid="c49">Palmer and Kishony, 2013</xref>, p. 243 i). But detailed information about the distribution of paths of tumor evolution is currently not available. Obtaining it requires large numbers of multiple within-patient samples with timing information (alternatively, detailed knowledge of the fitness landscape together with information about major determinants of dynamics such as mutation rates, population sizes, and growth models &#x2014;e.g., <xref ref-type="bibr" rid="c3"><italic>Bank et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c19">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="c35"><italic>L&#x00E4;ssig et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c39">Losos, 2018</xref>; <xref ref-type="bibr" rid="c61"><italic>Szendro et al.</italic>, 2013</xref>&#x2014; might allow us to model or simulate the evolutionary process to estimate the distribution of paths). Since CPMs can capture the paths of tumor progression from cross-sectional data, they offer a promising alternative, especially given the currently available and growing number of cross-sectional data sets.</p>
<p>The first aim of this paper is to examine if we can use CPMs to predict the likely paths of tumor evolution. The question we will ask is how close to the truth are the predictions about the distribution of paths of tumor evolution. When addressing this question we need to take into account possible deviations from the models assumed by CPMs. In particular, CPMs assume that the acquisition of a mutation in a driver gene does not decrease the probability of gaining a mutation in another driver gene (<xref ref-type="bibr" rid="c43"><italic>Misra et al.</italic>, 2014</xref>); this implies that the fitness landscapes assumed by CPMs cannot have reciprocal sign epistasis (<xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>: under reciprocal sign epistasis two mutations that individually increase fitness reduce it when combined <xref ref-type="bibr" rid="c17">Crona <italic>et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="c51"><italic>Poelwijk et al.</italic>, 2007</xref>, <xref ref-type="bibr" rid="c52">2011</xref>). This also means that the fitness landscapes assumed by CPMs only have a single global fitness maximum (the genotype with all drivers mutated).</p>
<p>But reciprocal sign epistasis is likely to be common in cancer (<xref ref-type="bibr" rid="c15"><italic>Chiotti et al.</italic>, 2014</xref>), an argument supported by how common synthetic lethality is in both cancer cells (<xref ref-type="bibr" rid="c7"><italic>Beijersbergen et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c48"><italic>O&#x2019;Neil et al.</italic>, 2017</xref>) and the human genome (<xref ref-type="bibr" rid="c9"><italic>Blomen et al.</italic>, 2015</xref>). Moreover, if there are many combinations of a small number of drivers, out of a larger pool of drivers (<xref ref-type="bibr" rid="c62">Tomasetti <italic>et al.</italic>, 2015</xref>), that result in the escape genotype, it is likely that cancer landscapes will have several local fitness maxima (i.e., be multi-peaked). As we have shown before (<xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>), the performance of CPMs for predicting what genotypes can and cannot exist degrades considerably when the assumption of absence of reciprocal sign epistasis is violated. Those results, however, do not provide a direct answer to the question of predictability: if our objective is predicting paths of tumor progression we want to measure directly the quality of the predictions of paths of progression. For example, getting some of the edges of the DAG of restrictions wrong, or predicting some of the genotypes incorrectly, might be of little importance if the main paths of disease are captured and this happens in evolutionary scenarios where disease progression follows only a limited set of paths. Thus, to answer the question of whether CPMs can be used to predict paths of progression we will need to look directly at the prediction of paths and do that both under scenarios where CPM&#x2019;s assumptions are met and under scenarios with relevant deviations from the assumptions (see <xref ref-type="fig" rid="fig1">Figure 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Fitness landscapes, paths of tumor progression, and DAGs of restrictions in the order of accumulation of mutations for the three types of landscapes used. (a) representable; (b) local maxima; (c) RMF. In each row, on the left, the fitness landscape (representation based on <xref ref-type="bibr" rid="c12"><italic>Brouillet et al.</italic>, 2015</xref>) that shows the accessible genotypes (where the notation &#x201C;AB&#x201D; means a genotype with both genes A and B mutated) and on the right the fitness graphs or graphs of mutational paths (<xref ref-type="bibr" rid="c17"><italic>Crona et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="c19">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="c27">Franke <italic>et al.</italic>, 2011</xref>), where nodes are genotypes and arrows point toward mutational neighbors of higher fitness. Fitness graphs show all the paths of tumor progression, the set of accessible mutational paths and adaptive walks that, under the restriction that there can be no back mutations, start from the &#x201C;wild type&#x201D; (WT) genotype &#x2014;where we absorb all cancer initiation events&#x2014; and end in the local fitness maxima (or single global fitness maximum). Each path from WT to a maximum corresponds to a different Line of Descent (LOD). For (b) and (c), gray edges and nodes denote those that are present in (a) but missing in (b) or (c). The inset in the first row shows the DAG of restrictions in the order of accumulation of mutations that applies to (a) and (b). A DAG of restrictions shows genes in the nodes; an arrow (directed edge) from gene <italic>i</italic> to gene <italic>j</italic> indicates a direct dependency of a mutation in <italic>j</italic> on a mutation on <italic>i</italic>; a mutation in <italic>j</italic> cannot be observed unless <italic>i</italic> is mutated. In the example, a mutation in gene D can only be observed if both A and B are mutated; the absence of an arrow between two genes indicates a lack of direct dependencies between the two genes. The set of genotypes that can exist under both (a) and (b) is the same, and all of them satisfy the restrictions in the DAG of restrictions. But the fitness landscape in (b) has three maxima; there are fewer paths to &#x201C;ABCD&#x201D; and several paths end in the other two maxima (&#x201C;AC&#x201D;, &#x201C;BC&#x201D;). Thus, the fitness graph of (b) does not fulfil the assumptions of CPMs. The defining features of (b) are that the set of accessible genotypes can be represented by a DAG of restrictions, but there are missing paths. The fitness landscape in (c) cannot be represented by any DAG of restrictions; e.g., no DAG of restrictions can account at the same time for the presence of genotypes &#x201C;A&#x201D;, &#x201C;B&#x201D;, &#x201C;C&#x201D;, and the absence of every double mutant with &#x201C;C&#x201D;. Relative to (a), (c) is missing both paths and genotypes (relative to other DAGs of restrictions it could either be missing and/or adding genotypes and paths).</p></caption>
<graphic xlink:href="371039_fig1.tif"/>
</fig>
<p>And relevant scenarios highlight another key consideration when attempting predictions of tumor progression. That a particular method can reconstruct well the actual distribution of paths of tumor progression might be of little importance if that happens in an evolutionary scenario where the true evolutionary unpredictability itself is very large; for practical purposes, forecasting here would be useless. Which brings us to the second and third objectives of this paper: to understand what factors, including intrinsic evolutionary unpredictability itself, affect the quality of those predictions and to asses if, regardless of the performance predicting the actual paths of tumor progression, we can use CPMs to estimate evolutionary unpredictability itself.</p>
<p>To address the above three questions (can we predict the paths of tumor evolution using CPMs?; how is predictability affected by evolutionary unpredictability?; can we estimate evolutionary unpredictability using CPMs?) we use evolutionary simulations on 1260 fitness landscapes that include from none to severe deviations from the assumptions of CPMs. Since the role of evolutionary unpredictability is an important focus of this paper, we simulate evolution under different population sizes and mutation rates, so as to generate varying amounts of evolutionary unpredictability. This paper does not attempt to understand the determinants of evolutionary predictability (see, e.g., <xref ref-type="bibr" rid="c3"><italic>Bank et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c19">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="c35"><italic>L&#x00E4;ssig et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c39">Losos, 2018</xref>; <xref ref-type="bibr" rid="c61"><italic>Szendro et al.</italic>, 2013</xref>) but, instead, we focus on the effects of evolutionary unpredictability for CPMs. This is why we use variation in key determinants of predictability (e.g., variation in population sizes and mutation rates) but these factors, themselves, are only used to generate variability in unpredictability, and not themselves the focus of the study. To better assess the quality of predictions, we use sample sizes that cover the range from what is commonly used to what are much larger sample sizes than currently available. We also include variation in the cancer detection process, since it has been found before to affect the quality of inferences (<xref ref-type="bibr" rid="c21">Diaz-Uriarte, 2015</xref>, <xref ref-type="bibr" rid="c23">2018</xref>). We find that the agreement between the true and the predicted distributions of paths is generally poor, unless sample sizes are very large and fitness landscapes conform to the restrictive assumptions of CPMs. Both detection regime and evolutionary unpredictability itself have major effects on performance. But in spite of the unreliability of the predictions of actual paths of tumor progression, CPMs can be useful for estimating upper bounds to the true evolutionary unpredictability.</p>
<p>We then analyze eleven cancer data sets for which the truth is not known, but using boot-strap samples allows us to examine the robustness of the inferences. Our results emphasize again the relevance of detection regime. And if the estimates of evolutionary unpredictability do indeed provide an upper bound to the true evolutionary unpredictability, the data indicate that at least some of the data reflect conditions where useful predictions could be possible. But for most data sets these results are thwarted by the unreliability of the predictions themselves. Our results question the use of CPMs for predicting paths of tumor progression.</p>
<sec id="s1a">
<label>1.1</label>
<title>Assumptions</title>
<p>CPMs assume that the different individuals in a data set constitute independent realizations of the same evolutionary process and therefore that the same constraints hold for all tumors (<xref ref-type="bibr" rid="c5"><italic>Beerenwinkel et al.</italic>, 2015</xref>, <xref ref-type="bibr" rid="c6">2016</xref>; <xref ref-type="bibr" rid="c29"><italic>Gerstung et al.</italic>, 2011</xref>). Thus, a data set can be regarded as a set of replicate evolutionary experiments where all individuals are under the same genetic constraints, though they might later be exposed to different conditions. We also make other common assumptions in this field, listed in <xref ref-type="bibr" rid="c23">Diaz-Uriarte (2018)</xref> (<xref ref-type="sec" rid="s1a">section 1.1</xref>). Briefly, we use biallelic loci, back mutations are not allowed, and mutations are single-gene mutations (<xref ref-type="bibr" rid="c4">Beerenwinkel <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="c10"><italic>Bozic et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="c41"><italic>McFarland et al.</italic>, 2013</xref>). All tumors start cancer progression without any of the mutations considered, but other mutations could be present that have caused the initial tumor growth, so we absorb the cancer initiation process in the root node (<xref ref-type="bibr" rid="c1"><italic>Attolini et al.</italic>, 2010</xref>); this is necessary to simulate data consistent with cross-sectional sampling. The driver genes are known and there are no observational errors.</p>
</sec>
</sec>
<sec id="s2">
<label>2</label>
<title>Material and methods</title>
<sec id="s2a">
<label>2.1</label>
<title>Overview of the simulation study</title>
<p>We used simulations of tumor evolution on fitness landscapes of different types (see <xref ref-type="fig" rid="fig1">Figure 1</xref>), for landscapes of seven and ten genes, under different initial population sizes and mutation rates. As explained above, variation in initial population size and mutation rates is used to generate variability in evolutionary predictability, but not of interest <italic>per se</italic>. We have used a total of 1260 fitness landscapes &#x003D; 35 random fitness landscapes &#x00D7; two conditions of numbers of genes &#x00D7; three types of fitness landscapes &#x00D7; three initial population sizes &#x00D7; two mutation regimes. For each one of the 1260 fitness landscapes, we simulated 20000 evolutionary runs (with the specified parameters for initial population size and mutation rate) using a logistic-like growth model until one of the genotypes at the local fitness maxima (or the single global fitness maximum) reached fixation. Each set of 20000 simulated runs was then sampled under three detection regimes (so that each fitness landscape generated three sets of 20000 simulated genotypes). From each of these sets, we obtained five different splits of the genotypes for each of three sample sizes (50, 200, 4000); thus a total of 56700 (&#x003D; 1260 &#x00D7; 3 &#x00D7; 3 &#x00D7; 5 combinations of 1260 fitness landscapes, 3 detection regimes, 3 sample sizes, 5 splits) data sets were produced. Each of these 56700 data sets was analyzed with each of six CPM methods.</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Evolutionary simulations and data sampling</title>
<p>We used three initial population sizes, 2000, 50000, and 1 &#x00D7; 10<sup>6</sup> cells, for the simulations; these are ranges that have been previously used in the literature and cover a range of population sizes at tumor initiation (e.g. <xref ref-type="bibr" rid="c4"><italic>Beerenwinkel et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="c29"><italic>Gerstung et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="c41"><italic>McFarland et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="c65">Wodarz and Komarova, 2014</xref>). We also used two mutation regimes; in the first one, all genes had a common mutation rate of 1 &#x00D7; 10<sup><italic>&#x2212;</italic>5</sup>; in the second, genes had different mutation rates, uniformly distributed in the log scale between (1/5) 1 &#x00D7; 10<sup><italic>&#x2212;</italic>5</sup> and 5 &#x00D7; 10<sup><italic>&#x2212;</italic>5</sup> (i.e., the largest ratio between largest and smallest mutation rates was 25), so that the arithmetic mean of mutation rates was 1.5 &#x00D7; 10<sup><italic>&#x2212;</italic>5</sup> and the geometric mean 1 &#x00D7; 10<sup><italic>&#x2212;</italic>5</sup>. These mutation rates are within ranges previously used in the literature (<xref ref-type="bibr" rid="c10"><italic>Bozic et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="c41"><italic>McFarland et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="c47"><italic>Nowak et al.</italic>, 2004</xref>), with a bias towards larger numbers (since we use only seven or ten genes relevant for population growth and we could be modeling pathways, not individual genes). Initial population size and mutation rates are not of intrinsic interest here (since our focus is not the determinants of evolutionary predictability <italic>per se</italic>), but are used to generate variability in evolutionary predictability; see <xref ref-type="sec" rid="s3a">section 3.1</xref>.</p>
<p>For each of the combinations of number of genes (seven and ten), initial population size (50, 200, 1 &#x00D7; 10<sup>6</sup>), and mutation rate (constant, variable), we generated random fitness landscapes of three kinds (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). We generated the DAG-derived <bold>representable</bold> fitness landscapes by generating a random DAG of restrictions and from it the fitness graph. We then assigned birth rates to genotypes using an iterative procedure on the fitness graph where, starting from the genotype without any driver mutation with a birth rate of 1, the birth rate of each descendant genotype was set equal to the maximum fitness of its parent genotypes times a random uniform variate between 1.01 and 1.19 (yielding, thus, an average multiplicate increase in fitness of 0.1, again within values previously used; <xref ref-type="bibr" rid="c10"><italic>Bozic et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="c41">McFarland <italic>et al.</italic>, 2013</xref>). Birth rate of genotypes without dependencies satisfied was set to 0. (Note that for the growth model used here &#x2014;see below&#x2014; birth rates determine fitness at any population size as death rates are identical for all genotypes and depend only on population size. Note also that genotypes with birth rate of 0 are never added to the population; thus, they cannot mutate before dying, so this simulation scheme strictly adheres to the assumptions about accessible and non-accessible genotypes under the CPM model). The DAG-derived <bold>local-maxima</bold> fitness landscapes were obtained by generating a random DAG and from it the fitness graph. Before assigning fitness to genotypes, a random selection of edges of the fitness graph were removed so that all accessible genotypes remained accessible but from a possibly much smaller set of parents. Fitness was then assigned as above (with the iterative procedure on the fitness graph, where fitness of child &#x003D; <italic>max</italic>(fitness parents) <italic>U</italic>(1.01, 1.19)). For each DAG we repeated this procedure 50 times, and kept the one that introduced the largest number of local maxima. Creating local maxima almost always resulted in creating reciprocal sign epistasis (but see Supplementary Material &#x201C;Generating random fitness landscapes&#x201D;). The local maxima fitness landscapes used in this paper are representable in the weaker sense of <xref ref-type="bibr" rid="c23">Diaz-Uriarte (2018)</xref>, as all genotypes that should be accessible under the DAG of restrictions are accessible. What the local-maxima landscapes are missing are mutational paths to the genotype with all genes mutated, because we have introduced local fitness maxima (and once we introduce local maxima there is no longer a one-to-one correspondence between DAGs of restrictions and fitness graphs and, thus, there is no longer a one-to-one correspondence between DAGs of restrictions and sets of tumor progression paths). These local maxima landscapes are &#x201C;easier&#x201D; than the DAG-derived fitness landscapes used in (<xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>), as those also missed some genotypes that should exist under the DAG of restrictions. Our local maxima are easier by design as we want to isolate the effect of multi-peaked landscapes or local maxima (or, equivalently, missing paths), without the additional burden of missing genotypes. The Rough Mount Fuji (<bold>RMF</bold>) fitness landscapes we obtained from an RMF model, a model that has been useful to model empirical fitness landscapes (<xref ref-type="bibr" rid="c19">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="c27"><italic>Franke et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="c45">Neidhart <italic>et al.</italic>, 2014</xref>), where the reference genotype and the decrease in birth rate of a genotype per each unit increase in Hamming distance from the reference genotype were randomly chosen (see &#x201C;Random fitness landscapes&#x201D; in Supplementary Material). These fitness landscape cannot be represented by DAGs of restrictions with respect to neither paths to the maximum or accessible genotypes (see also <xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>).</p>
<p>Once a fitness landscape had been generated, we simulated 20000 evolutionary processes. We used the continuous-time, logistic-like model of <xref ref-type="bibr" rid="c41"><italic>McFarland et al.</italic> (2013)</xref>, in which death rate depends on total population size, as implemented in OncoSimulR (<xref ref-type="bibr" rid="c22">Diaz-Uriarte, 2017</xref>), with the specified parameters of initial population size and mutation rate. Each individual simulation was run until one of the genotypes at the local fitness maxima (or the single global fitness maximum) reached fixation (see details in &#x201C;Simulations&#x201D; in Supplementary Material). We also verified that all seven or ten genes had appeared in at least some genotypes, i.e., were part of the paths of tumor progression. If this condition was not fulfilled, a new fitness landscape was generated and the processes started again. This procedure is independent of the detection process that generates the actual samples of genotypes (next).</p>
<p>To obtain the actual samples of genotypes that were analyzed by the CPMs, we used three different detection regimes to emulate single-cell sampling at total tumor sizes (number of cells) that are, in the log scale, approximately uniformly distributed (<bold>uniform</bold> detection regime), biased towards large sizes (<bold>large</bold>) or biased towards small sizes (<bold>small</bold>). (Working on the log-scale of tumor size is appropriate as in the model of <xref ref-type="bibr" rid="c41"><italic>McFarland et al.</italic>, 2013</xref>, tumor population size increases logarithmically with number of driver mutations). We drew random deviates from beta distributions with parameters B(1, 1), B(5, 3), and B(3, 5) (for uniform, large, and small, respectively), rescaled them to the range of observed sizes, and obtained the sample with actual population size closest to the target (see details in Supplementary Material &#x201C;Detection regimes: sampling&#x201D;). For each sample, the genotype returned was the single genotype with the largest frequency (so we did not introduce possible additional noise due to whole-tumor, or bulk, sequencing). Finally, for each of the three <bold>sample sizes</bold> of 50, 200, and 4000, we splitted the 20000 simulations into five sets of non-overlapping data sets. These are the data sets that were analyzed with the six CPMs.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Cancer Progression Models (OT, CBN, CAPRI, CAPRESE) and paths of tumor progression</title>
<p>We have used four different CPM methods (methods not considered here are either too slow for routine work, have no software available, or have dependencies on non-open source external libraries &#x2014;see Supplementary Material &#x201C;CPM software&#x201D;). Two of the methods used have two with variants, yielding a total of six methods. Only a brief overview is provided here; detailed descriptions can be found in <xref ref-type="bibr" rid="c13"><italic>Caravagna et al.</italic> (2016)</xref>; <xref ref-type="bibr" rid="c20"><italic>Desper et al.</italic> (1999)</xref>; <xref ref-type="bibr" rid="c28"><italic>Gerstung et al.</italic> (2009</xref>, 2011); <xref ref-type="bibr" rid="c38"><italic>Loohuis et al.</italic> (2014)</xref>; <xref ref-type="bibr" rid="c44"><italic>Montazeri et al.</italic> (2016)</xref>; <xref ref-type="bibr" rid="c54"><italic>Ramazzotti et al.</italic> (2015)</xref>; <xref ref-type="bibr" rid="c60">Szabo and Boucher (2008)</xref>. CPM methods assume that the different individuals in a data set constitute independent realizations of the same evolutionary process &#x2014;see above. These methods try to identify restrictions in the order of accumulation of mutations from cross-sectional data. The cross-sectional data is a matrix of subjects or samples by driver alteration events, where each entry in the matrix is binary coded as mutated or not-mutated. For the simulations, we will refer to these driver alteration events as &#x201C;genes&#x201D;, but they can be individual genes, parts or states of genes, or modules or pathways made from several genes (e.g. <xref ref-type="bibr" rid="c13"><italic>Caravagna et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c29"><italic>Gerstung et al.</italic>, 2011</xref>). When we analyze the eleven cancer data sets (see <xref ref-type="sec" rid="s2e">section 2.5</xref>) we will use the generic term &#x201C;features&#x201D; as some of those data sets use genes whereas others use pathway information. Both Oncogenetic trees (OT) (<xref ref-type="bibr" rid="c20"><italic>Desper et al.</italic>, 1999</xref>; <xref ref-type="bibr" rid="c60">Szabo and Boucher, 2008</xref>) and CAPRESE (<xref ref-type="bibr" rid="c38"><italic>Loohuis et al.</italic>, 2014</xref>) describe the accumulation of mutations with order constraints that can be represented as trees. A key difference between the two is that CAPRESE reconstructs these models using a probability raising notion of causation in the framework of Suppes probabilistic causation, whereas in OT weights along edges can be directly interpreted as probabilities of transition along the edges by the time of observation (<xref ref-type="bibr" rid="c60">Szabo and Boucher, 2008</xref>, p. 4). Both CAPRI and CBN allow modeling the dependence of an event on more than one previous event: the output of the model are graphs (DAGs) where some nodes have multiple parents, instead of a single parent (as in trees). CAPRI tries to identify events (alterations) that constitute &#x201C;selective advantage relationships&#x201D; again using probability raising in the framework of Suppes probabilistic causation. We have used two versions of CAPRI, that we will call CAPRI AIC and CAPRI BIC, that differ in the penalization used in the maximum likelihood fit (AIC or BIC, respectively). For CBN we have also used two variants, the one described in <xref ref-type="bibr" rid="c28"><italic>Gerstung et al.</italic> (2009,</xref> 2011) that uses simulated annealing with a nested EM algorithm for estimation, and MCCBN, described in <xref ref-type="bibr" rid="c44"><italic>Montazeri et al.</italic> (2016)</xref>, that uses a Monte-Carlo EM algorithm that allows it to fit data sets with many more genes. See Supplementary Material, &#x201C;CPM software&#x201D; for further details.</p>
<p>Because (the transitive reduction of) a DAG of restrictions determines a fitness graph (see <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>), the set of paths to the maximum encoded by the output from a CPM is obtained from the fitness graph. This we did for all methods. From CBN and MC-CBN we can also obtain the estimated probability of each path of tumor progression to the fitness maximum, since both CBN and MCCBN return the parameters of the transition rates between genotypes (see e.g., p. i729 in <xref ref-type="bibr" rid="c44"><italic>Montazeri et al.</italic>, 2016</xref>, <xref ref-type="sec" rid="s2b">section 2.2</xref> in <xref ref-type="bibr" rid="c28"><italic>Gerstung et al.</italic>, 2009</xref>, or <xref ref-type="bibr" rid="c32">Hosseini, 2018</xref>). It is also possible to perform a similar operation with the output of OT, and use the edge weights from the fits of OT to obtain the probabilities of transition to each descendant genotype and, from them, the probabilities of the different paths to the global maximum. It must be noted that this is really abusing the model, since the OTs used are untimed oncogenetic trees (<xref ref-type="bibr" rid="c20"><italic>Desper et al.</italic>, 1999</xref>; <xref ref-type="bibr" rid="c60">Szabo and Boucher, 2008</xref>). We will refer to paths with probabilities assigned in the above way as <bold>probability-weighted paths</bold>. For CAPRESE and CAPRI, it is not possible to map the output to different probabilities of paths of progression (see also Supplementary Material &#x201C;CAPRI, CAPRESE, and paths of tumor progression&#x201D;) and in all computations that require probability of paths we will assign the same probability to each path.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Measures of performance and predictability</title>
<p>We have characterized evolutionary unpredictability using the diversity of Lines of Descent (LOD). LODs were introduced by <xref ref-type="bibr" rid="c61"><italic>Szendro et al.</italic> (2013)</xref> and &#x201C;(&#x2026;) represent the lineages that arrive at the most populated genotype at the final time&#x201D; (p. 572). In other words, a LOD is a sequence of parent-child genotypes, from the initial genotype to a local maximum. In the context of this paper, a LOD is the path that a tumor has taken until fixation. The final genotype in a LOD is a local fitness maximum, but there are no guarantees that any intermediate genotype in the LOD will have been the most common genotype at any time point (specially if there is clonal interference and stochastic tunneling &#x2014; <xref ref-type="bibr" rid="c19">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="c59">Sniegowski and Gerrish, 2010</xref>). As in <xref ref-type="bibr" rid="c61"><italic>Szendro et al.</italic> (2013)</xref>, we can use the entropy of these paths to measure the indeterminism with respect to the paths of evolution, or evolutionary unpredictabilty, and we will define <italic>S<sub>p</sub></italic> &#x003D; &#x2013;&#x2211; <italic>p<sub>i</sub></italic> ln <italic>p<sub>i</sub></italic>, where <italic>p<sub>i</sub></italic> is the observed probability of each LOD (each path) computed from the 20000 simulations, and the sum is over all paths or LODs. Evolutionary unpredictability, as estimated by the CPMs, will analogously be defined as <italic>S<sub>c</sub></italic> &#x003D; &#x2013;&#x2211; <italic>q<sub>j</sub></italic> ln <italic>q<sub>j</sub></italic>, where <italic>q<sub>j</sub></italic> is the probability of each path to the maximum according to the cancer progression model considered, and the sum is over all paths predicted by the CPMs. (<xref ref-type="bibr" rid="c32">Hosseini, 2018</xref>, normalizes predictability by dividing by the maximum entropy, similar to dividing by the prior entropy in the &#x201C;information gain&#x201D; statistic in <xref ref-type="bibr" rid="c35"><italic>L&#x00E4;ssig et al.</italic>, 2017</xref>; but the maximum entropy is a constant for each number of genes, i.e., 7&#x0021; or 10&#x0021; for our simulations).</p>
<p>To measure how well CPMs predict actual tumor progression, we use three different statistics. To compare the overall similarity of the distribution of paths predicted by CPMs with the observed one (i.e., the distribution of LODs) we have used the Jensen-Shannon divergence (<bold>JS</bold>) (<xref ref-type="bibr" rid="c18">Crooks, 2017</xref>; <xref ref-type="bibr" rid="c36">Lin, 1991</xref>), scaled between 0 and 1 (equivalent to using the logarithm of base 2). JS is a symmetrized Kullback-Leibler divergence between two distributions and is defined even if the two distributions do not have the same sample space, i.e., even if <italic>P</italic>(<italic>i</italic>) &#x2260; 0 and <italic>Q</italic>(<italic>i</italic>) &#x003D; 0 (or <italic>Q</italic>(<italic>i</italic>) &#x2260; 0 and <italic>P</italic>(<italic>i</italic>) &#x003D; 0), as can often be the case for our data. A value of 0 means that the distributions are identical, and a value of 1 that they do not overlap. Therefore, predictions of CPMs are closer to the truth the smaller the value of JS. The sum of the probabilities of the paths in the LODs that are not among the paths allowed by the CPMs, <italic>P</italic>(&#x00AC;<italic>DAG&#x007C;LOD</italic>), is equivalent to <bold>1 - recall</bold>. Larger values of 1-recall mean that the CPM is not capturing a large fraction of the actual evolutionary paths to the maximum (or maxima). The sum of the predicted probabilities of paths according to the CPMs that are not used by evolution (i.e., that are not LODs), <italic>P</italic>(&#x00AC;<italic>LOD&#x007C;DAG</italic>), is equivalent to <bold>1 - precision</bold>. Larger values of 1-precision mean that the CPMs predict paths to the maximum that are not used by evolution. Some figures in the Supplementary Material also use as statistic the <bold>probability of recovering the most common LOD</bold>; we will rarely refer to this statistic in the main paper since it follows a pattern very similar to recall (see Supplementary Material, section &#x201C;Probability of recovering the most common LOD&#x201D;). Statistics 1-recall and 1-precision can, however, overestimate performance: they could both have a value of 0, even when JS is very close to 1 (see example in Supplementary Material &#x201C;Example where perfect recall and precision do not guarantee Jensen-Shannon divergence of 0&#x201D;). Thus, the basic overall performance measure will be JS.</p>
<sec id="s2d1">
<label>2.4.1</label>
<title>Comparing paths from CPMs with LODs of different lengths</title>
<p>When all paths from the CPM and the LOD have equal length (they end in a genotype with the same number of genes mutated, <italic>K</italic>) computing the above statistics is straightforward. But paths could differ in length. In fitness landscapes with local maxima, LODs can differ in length; some could have <italic>K<sub>i</sub></italic> (the number of mutations at the fixated genotype, or the length of the path) larger than <italic>K<sub>C</sub></italic> (all paths from a CPM have the same number of mutations, since all arrive at the genotype with all <italic>K<sub>C</sub></italic> genes mutated). It is also possible that <italic>K<sub>i</sub> &#x003E; K<sub>C</sub></italic> if the CPM has been built from a fitness landscape with a data set that contains fewer genes than the number of genes in the landscape (e.g., because one or more genes were absent &#x2014;see Supplementary material &#x201C;Preprocessing of data for CPMs&#x201D;). In fact, in representable fitness landscapes, all <italic>K<sub>i</sub> &#x003E; K<sub>C</sub></italic> if the CPM has been built from a fitness landscape with a data set that contains fewer genes than the number of genes in the landscape (all <italic>K<sub>i</sub></italic> will be equal to either seven or 10). We need a procedure to compute JS, 1-recall, and 1-precision that will cover all those cases. This procedure should ignore specifics of the sampling model and should reduce to the simpler procedure in the above section when all <italic>K<sub>i</sub></italic> &#x003D; <italic>K<sub>C</sub></italic>.</p>
<p>Let <italic>i</italic> and <italic>i</italic> denote two paths, one from the LOD and the other from the CPM, with corresponding probabilities <italic>p<sub>i</sub></italic> and <italic>q<sub>j</sub></italic>; in contrast to the previous section, and to minimize notation, <italic>p</italic>, <italic>q</italic> could refer to a path from the LOD and a path from the CPM, xor a path from the CPM and a path from a LOD. Let <italic>K<sub>i</sub></italic>, <italic>K<sub>j</sub></italic> denote the length of paths <italic>i</italic> and <italic>j</italic>, respectively. At least one set of either <italic>K<sub>i</sub></italic> or <italic>K<sub>j</sub></italic> has all elements identical (e.g., if <italic>j</italic> refers to indices of the paths from the CPM, it is necessarily the case that <italic>K</italic><sub>1</sub> &#x003D; <italic>K</italic><sub>2</sub> &#x003D; &#x2026; &#x003D; <italic>K<sub>m</sub></italic> &#x003D; <italic>K<sub>C</sub></italic>, with <italic>m</italic> the total number of paths from the CPM).</p>
<p>The procedure has to fulfill two desiderata. a) If <italic>K<sub>i</sub> &#x003E; K<sub>j</sub></italic>, but <italic>i<sup>k</sup></italic>, the path <italic>i</italic> up to <italic>K<sub>i</sub></italic> &#x003D; <italic>k</italic> mutations (i.e., from the WT genotype to the genotype with <italic>k</italic> mutations) is identical to <italic>j</italic>, then path <italic>j</italic> is included in path <italic>i</italic>. All of <italic>q<sub>j</sub></italic> is accounted for by <italic>i</italic>. b) Path <italic>i</italic> is partially included (or accounted for) by path <italic>j</italic>, but a fraction of it, (<italic>K<sub>i</sub> &#x2013; K<sub>j</sub></italic>)/<italic>K<sub>i</sub></italic>, is missing or unaccounted. The above applies directly to calculations of 1-recall and 1-precision. For computing JS, there will be two entries in the vectors with the probability distributions that will be compared: <inline-formula><alternatives><inline-graphic xlink:href="371039_inline1.gif"/></alternatives></inline-formula>, <italic>Q</italic> &#x003D; [<italic>q<sub>i</sub></italic>, 0]. This procedure can be applied to all elements <italic>i</italic>, <italic>j</italic>, summing all unmatched entries (<inline-formula><alternatives><inline-graphic xlink:href="371039_inline2.gif"/></alternatives></inline-formula>: this is the total flow in the set of <italic>i</italic>s that cannot be matched by the <italic>j</italic>s because they are shorter). To simplify computations, that unmatched term can include &#x2211; <italic>p<sub>u</sub></italic>, where <italic>u</italic> denote those paths in <italic>i</italic> that do not match any <italic>j</italic>. Likewise, all paths <italic>i</italic> with <italic>K<sub>i</sub> &#x003E; K<sub>j</sub></italic> such that the paths become indistinguishable up to <italic>K<sub>j</sub></italic> can be summed in a single entry: <inline-formula><alternatives><inline-graphic xlink:href="371039_inline3.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="371039_inline4.gif"/></alternatives></inline-formula> for the matched and unmatched fractions, respectively. All computations have their corresponding counterparts for elements <italic>i</italic>, <italic>j</italic> when <italic>K<sub>i</sub> &#x003C; K<sub>j</sub></italic>. This procedure results in unique JS (remember the <italic>K</italic> are all the same for at least one of the sets of paths) as well as unique 1-precision and 1-recall, and it reduces to <xref ref-type="sec" rid="s2d">section 2.4</xref> when all <italic>K<sub>i</sub></italic> are equal and equal to all <italic>K<sub>j</sub></italic>. A commented example is provided in the Supplementary Material (&#x201C;Commented example for paths of unequal length&#x201D;)</p>
</sec>
<sec id="s2d2">
<label>2.4.2</label>
<title>Statistical modeling of performance</title>
<p>We have used generalized linear mixed-effects models, with a beta model for the dependent variable (<xref ref-type="bibr" rid="c25">Ferrari and Cribari-Neto, 2004</xref>; <xref ref-type="bibr" rid="c31"><italic>Gr&#x00FC;n et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="c58">Smithson and Verkuilen, 2006</xref>), to model how JS, 1-recall, and 1-precision, are affected by <italic>S<sub>p</sub></italic>, detection regime, sample size, number of genes, and type of fitness landscape. All models used, as response variables, the average from the five split replicates of each landscape by sample size by detection regime combination, and we have used fitness landscape as random effect. When the dependent variable had values exactly equal to 0 or 1, we have used the transformation suggested in <xref ref-type="bibr" rid="c58">Smithson and Verkuilen (2006)</xref>. Models were fitted using sum-to-zero contrasts (<xref ref-type="bibr" rid="c40">McCullagh and Nelder, 1989</xref>). All regressors have been used as discrete regressors, except <italic>S<sub>p</sub></italic>, which has been scaled (mean 0, variance 1) for easier interpretation and so that the intercept term is interpreted as the predicted response at the average value of the regressors (see further details in Supplementary Data&#x201C;Coefficients of linear models&#x201D;). We have used the glmmTMB (<xref ref-type="bibr" rid="c11"><italic>Brooks et al.</italic>, 2017</xref>) and car (<xref ref-type="bibr" rid="c26">Fox and Weisberg, 2011</xref>) packages for R (<xref ref-type="bibr" rid="c53">R Core Team, 2018</xref>) for statistical model fitting and analysis.</p>
</sec>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>Cancer data sets</title>
<p>We have used eleven cancer data sets (including glioblastoma, lung, ovarian, colorectal, and pancreatic cancer); some code mutations in terms of genes and some in terms of pathways. These data were obtained from <xref ref-type="bibr" rid="c13"><italic>Caravagna et al.</italic> (2016)</xref>; <xref ref-type="bibr" rid="c29"><italic>Gerstung et al.</italic> (2011)</xref>; <xref ref-type="bibr" rid="c43"><italic>Misra et al.</italic> (2014)</xref>, with the original sources for the data being <xref ref-type="bibr" rid="c8"><italic>Bell et al.</italic> (2011)</xref>; <xref ref-type="bibr" rid="c24"><italic>Ding et al.</italic> (2008)</xref>; <xref ref-type="bibr" rid="c34"><italic>Jones et al.</italic> (2008)</xref>; <xref ref-type="bibr" rid="c46">Network (2012)</xref>; <xref ref-type="bibr" rid="c50">Parsons (2008)</xref>; <xref ref-type="bibr" rid="c66"><italic>Wood et al.</italic> (2007)</xref>. Details on sources, names, and how the data were obtained are provided in the the Supplementary Data (&#x201C;Cancer data sets&#x201D;).</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<sec id="s3a">
<label>3.1</label>
<title>Simulated fitness landscapes: characteristics, evolutionary predictability, clonal interference, and sampled genotypes</title>
<p>In the Supplementary Material (see section &#x201C;Plots of fitness landscapes and inferred DAGs&#x201D;) we show all the fitness landscapes used; in section &#x201C;Fitness landscapes: characteristics, evolutionary predictability, clonal interference, and sampled genotypes&#x201D;) we show the main characteristics of the fitness landscapes used, the variability in evolutionary predictability, and the main characteristics of the samples obtained under the three detection regimes. The three types of fitness landscapes had comparable numbers of accessible genotypes but differed strongly in the number of local fitness maxima and reciprocal sign epistasis, with reciprocal sign epistasis being associated to number local fitness maxima in the local maxima landscapes. Simulations resulted in varied amounts of clonal interference, as measured by the average frequency of the most common genotype (or, similarly, the inverse of the average number of clones with frequency <italic>&#x003E;</italic> 5&#x0025;); as seen in the plots in the Supplementary Material, scenarios where clonal sweeps dominate (i.e., those characterized by the smallest clonal interference) corresponded to initial population sizes of 2000, with clonal interference being much larger at the other population sizes.</p>
<p>Simulations resulted in observed numbers of paths to the maximum (number of distinct LODs) that showed a wide range, from 2 to 3082 (median of 228, 95, and 55, for representable, local maxima, and RMF, respectively), with fitness landscapes with 10 genes with a disproportionately larger number (105 vs. 1340, 55 vs. 261, 33 vs. 113, for representable, local maxima, and RMF, respectively). LOD diversities (<italic>S<sub>p</sub></italic>) ranged from 0.3 to 8.7, with RMF models showing lower <italic>S<sub>p</sub></italic>, although RMF landscapes had the largest number and diversity of observed local fitness maxima. <italic>S<sub>p</sub></italic> was strongly associated to the number of accessible genotypes.</p>
<p>The number of different sampled genotypes was comparable between detection regimes, but diversity differed, with the uniform detection regime showing generally larger sampled diversity. The mean and median number of mutations of sampled genotypes differed between detection regimes in the expected direction (largest in large detection regime, and smallest in small detection regime); the standard deviation and coefficient of variation in the number of mutations were largest in the uniform detection regime (thus, the uniform detection regime showed both the largest variation in number of mutations of genotypes and the largest diversity of genotypes). The differences in sample characteristics between detection regimes often differed between fitness landscapes (in particular, the coefficient of variation in the number of mutations was largest in the RMF landscapes).</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Predicting paths of evolution with CPMs: overall patterns</title>
<p>The six methods used can be divided into three groups: methods that return trees (OT and CAPRESE) and two families of methods that return DAGs, CAPRI (CAPRI AIC and CAPRI BIC) and CBN (CBN and MCCBN). As seen in the Supplementary Material &#x201C;Overall patterns for the six methods&#x201D;, comparing within groups with respect to JS, one member of the pair consistently outperformed the other. OT was significantly better than CAPRESE (paired <italic>t</italic>-test over all 56595 pairs: <italic>t</italic><sub>56594</sub> &#x003D; &#x2013;161.1.2, <italic>P &#x003C;</italic> 0.0001), CBN was significantly better than MC-CBN (<italic>t</italic><sub>56593</sub> &#x003D; &#x2013;42.6, <italic>P &#x003C;</italic> 0.0001), and CAPRI_AIC was significantly better than CAPRI BIC (<italic>t</italic><sub>56594</sub> &#x003D; &#x2013;41.9, <italic>P &#x003C;</italic> 0.0001).</p>
<p>This ranking within types of methods does not always apply for the other two measures of performance, most notably CAPRESE with respect to 1-recall, where its performance can be one of the best, and often better than that of OT. CAPRESE&#x2019;s better recall, however, is more than offset by its poor precision (often the worst or among the worst). Similar comments apply to other reversals (e.g., MCCBN&#x2019;s slightly better precision in some scenarios being offset by its considerably worse recall). Remember we will asses performance using mainly JS (see 2.4). In what follows, therefore, and for the sake of brevity, we will focus on OT, CBN, and CAPRI AIC, since the overall performance of their alternatives is worse.</p>
<p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows how the performance measures for OT, CBN, and CAPRI AIC change with sample size for all combinations of type of landscape by detection regime by number of genes (results for probability of recovering the most common LOD are shown in the Supplementary Material and the patterns are essentially those of recall). The measures of JS and 1-precision for OT and CBN (and MCCBN) use probability-weighted paths computed as explained in 2.4, because there was strong evidence for all three methods that the probability-weighted paths led to better results (JS, paired <italic>t</italic>-test over all pairs: OT, <italic>t</italic><sub>56594</sub> &#x003D; 195.8, <italic>P &#x003C;</italic> 0.0001; CBN: <italic>t</italic><sub>56594</sub> &#x003D; 222.3, <italic>P &#x003C;</italic> 0.0001; MCCBN: <italic>t</italic><sub>56593</sub> &#x003D; 149.0, <italic>P &#x003C;</italic> 0.0001; 1-precision: OT: <italic>t</italic><sub>56594</sub> &#x003D; 187.6, <italic>P &#x003C;</italic> 0.0001; CBN: <italic>t</italic><sub>56594</sub> &#x003D; 217.6, <italic>P &#x003C;</italic> 0.0001; MCCBN: <italic>t</italic><sub>56593</sub> &#x003D; 130.3, <italic>P &#x003C;</italic> 0.0001). (See also Supplementary Material, &#x201C;OT and CBN, JS, weighted vs. unweighted&#x201D;, &#x201C;CAPRESE and OT, 1-precision, unweighted&#x201D; and &#x201C;CAPRI and CBN, 1-precision, unweighted&#x201D; for figures that show the improvement due to weighting).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Summary performance measures (see definitions in 2.4) for OT, CAPRI (with AIC penalty) and CBN for all combinations of sample size by type of landscape by detection regime by number of genes. For all measures, smaller is better. For OT and CBN, Jensen-Shannon divergence (JS) and 1-precision use probability-weighted predicted paths (see text). Each point represented is the average of 210 points (35 replicates of each one of the six combinations of 3 initial size by 2 mutation rate regimes &#x2014;see 2.1); we are thus marginalizing over mutation rate by initial simulation size combinations. Each one of the 210 points is, itself, the average of five runs on different partitions of the simulated data. See Supplementary Material, &#x201C;Overall patterns for the six methods&#x201D; for results for all six methods used.</p></caption>
<graphic xlink:href="371039_fig2.tif"/>
</fig>
<p>Overall, CBN was the method with the best performance (<italic>P &#x003C;</italic> 0.0001 from all pairwise comparisons between the six methods with Tukey&#x2019;s contrasts and single-step multiple testing p-value adjustment <xref ref-type="bibr" rid="c33"><italic>Hothorn et al.</italic>, 2008</xref>). It must be noted, however, that CBN was one of the most variable methods in performance, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> (also Supplementary Material, &#x201C;Overall patterns for the six methods&#x201D;).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Coefficient of variation (standard deviation/mean) of JS for each method for all combinations of sample size by type of landscape by detection regime by number of genes. The coefficient of variation has been computed from the five runs for each landscape on each combination of sample size and detection regime. For OT and CBN, JS is computed using the probability-weighted predicted paths (see text). Each point plotted is the average of 210 points (see <xref ref-type="fig" rid="fig2">Figure 2</xref>).</p></caption>
<graphic xlink:href="371039_fig3.tif"/>
</fig>
<p>JS differed between type of landscape, number of genes, detection regime, and sample size, but the magnitude and even direction of effects differed between combinations of those factors, as seen in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>. Generalized linear mixed-effects models fitted to the complete data set and to the different combinations of method and type of landscape (see Supplementary Material, section &#x201C;Analysis of deviance tables for fitted models&#x201D;) also showed highly significant (<italic>P &#x003C;</italic> 0.0001) two-, three-, and four-way interactions between most of the factors, in particular those involving type of landscape and detection regime.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Coefficients from generalized linear mixed-effects models, with separate models fitted for each combination of method and type of fitness landscape. Coefficients are from models with sum-to-zero contrasts (see text and Supplementary Material). Within each panel, coefficients have been ordered from left to right according to decreasing absolute value of coefficient. The dotted horizontal gray line indicates 0 (i.e. no effect). Coefficients with a large positive value indicate factors that lead to a large decrease in performance. Only coefficients that correspond to a term with a P-value <italic>&#x003C;</italic> 0.05 in Type II Wald chi-square tests are shown. The coefficient that corresponds to Number of genes 7 is not shown (as it is minus the coefficient for 10 genes &#x2014;from using sum-to-zero contrasts). &#x201C;N Genes&#x201D;: number of genes; &#x201C;S Size&#x201D;: sample size; &#x201C;Detect&#x201D;: detection regime; &#x201C;LOD div&#x201D;: LOD diversity (<italic>S<sub>p</sub></italic>).</p></caption>
<graphic xlink:href="371039_fig4.tif"/>
</fig>
<p>Under representable fitness landscapes, performance improved with increasing sample size and with the uniform detection regime, but decreased as the number of genes increased (<xref ref-type="fig" rid="fig2">Figure 2</xref>, panel A; <xref ref-type="fig" rid="fig4">Figure 4</xref>, top row). The decrease in performance with the number of genes is related both to missing evolutionary paths (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), and allowing paths that are not used by evolution (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). With CAPRI, however, the effect of sample size is much weaker and increases in sample size can even lead to decreases in performance, specially under the uniform detection regime (highly significant, <italic>P &#x003C;</italic> 0.0001, interactions of detection and sample size &#x2014; see Supplementary Material); this is attributable to CAPRI excluding many paths taken during evolution (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). This behavior of CAPRI can also be seen in <xref ref-type="fig" rid="fig6">Figure 6A</xref>, where the number of paths allowed under CAPRI goes from slight to very severe underestimation as sample size increases under the uniform detection regime. This is itself caused by CAPRI sometimes allowing only a few or even just one path to the maximum (Supplementary Material, section &#x201C;Number of paths inferred&#x201D;).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Estimated slopes of the regression of Jensen-Shannon divergence (JS) on LOD diversity (<italic>S<sub>p</sub></italic>) for all combinations of type of landscape by detection regime by number of genes by sample size. A beta regression was fitted to each subset of data. Slopes not significantly different from 0 (<italic>P &#x003E;</italic> 0.05) shown as 0. Each regression was fitted to 210 points, each of which is itself the average of five replicates, one for each of the five runs on different partitions of the simulated data.</p></caption>
<graphic xlink:href="371039_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Number of paths and path diversities inferred from CPMs relative to the true values from LODs. Panel A: average of the ratio of number of paths to the maximum from the CPMs relative to the observed number of distinct LODs for all combinations of type of landscape by detection regime by number of genes by sample size. Panel B like panel A, but for diversities of paths to the maxima. As in <xref ref-type="fig" rid="fig2">Figure 2</xref>, each point represented is the average of 210 points. Panel C shows the slope of the regression <italic>S<sub>c</sub></italic> on <italic>S<sub>p</sub></italic>; each point is thus a slope from a regression of 210 points, each of which is itself the average of 5 replicates (see <xref ref-type="fig" rid="fig5">Figure 5</xref>). For comparison, panel C shows also the regression of diversity of the observed genotype samples on <italic>S<sub>p</sub></italic> (gray line). Panels B and C show different features of the data: panel B shows whether evolutionary unpredictability (<italic>S<sub>p</sub></italic>) tends to be over-or under-estimated by <italic>S<sub>c</sub></italic>; panel C shows how <italic>S<sub>c</sub></italic> changes with <italic>S<sub>p</sub></italic> &#x2014;see Supplementary Material, &#x201C;LOD and CPM diversity: ratios and slopes&#x201D; for an example of positive ratios with negative slopes.</p></caption>
<graphic xlink:href="371039_fig6.tif"/>
</fig>
<p>Under the RMF landscape overall performance was worse. Increasing sample size for OT and CBN led to minor decreases in performance (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref> bottom row). CPMs failed to capture about 50&#x0025; of the evolutionary paths to the local maxima (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) and included more than 75&#x0025; of paths (or fractions of paths) that were never taken by evolution (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). The behavior under local maxima was similar to that of representable fitness landscapes in terms of the direction of most effects, but effects were generally weaker. An important exception was evolutionary unpredictability where increasing <italic>S<sub>p</sub></italic> was associated to a decrease in performance similar to, but of smaller magnitude than, in RMF landscapes (see next).</p>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>Predicting paths of evolution with CPMs: effects of evolutionary unpredictability</title>
<p>There were no marginal effects of evolutionary unpredictability on performance in representable fitness landscapes (<xref ref-type="fig" rid="fig4">Figure 4</xref>). But the effects of evolutionary unpredictability were, in fact, more complex than depicted in <xref ref-type="fig" rid="fig4">Figure 4</xref>, as there were highly significant interactions (<italic>P &#x003C;</italic> 0.0001) between <italic>S<sub>p</sub></italic>, detection regime, and sample size, within representable and local maxima land-scapes, as well as in the overall models (see Supplementary Material, &#x201C;Analysis of deviance tables for fitted models&#x201D;). In many cases, the sign of the slope was reverted from its main effect, as is shown in <xref ref-type="fig" rid="fig5">Figure 5</xref> (see also Supplementary Material, &#x201C;Slopes of regressions of recall and precision on LOD diversity&#x201D;).</p>
<p>In most scenarios, performance was worse with larger unpredictability (larger <italic>S<sub>p</sub></italic>) as seen by the positive slopes of JS on <italic>S<sub>p</sub></italic>. But under representable landscapes, in the small and large detection regime and for sample sizes 50 and 200, larger evolutionary unpredictability was associated with better performance; the difference in effects was itself significantly affected by the number of genes (see also Supplementary data, section &#x201C;Analysis of deviance tables for fitted models&#x201D;). Note, however, that despite the change in relationship between unpredictability and performance, performance was still better with a sample size of 4000 than with sample sizes of 50 or 200 (<xref ref-type="fig" rid="fig2">Figure 2</xref>) in representable and local maxima landscapes. Under RMF fitness landscapes, large evolutionary unpredictability (larger <italic>S<sub>p</sub></italic>), in contrast to what happened in representable landscapes, was associated with poorer performance. Under local maxima, the effect of evolutionary unpredictability depended strongly on sample size and detection regime, with reversal of effects from sample size of 50 compared to 4000 under the large detection regime, similar to those mentioned above for representable landscapes.</p>
</sec>
<sec id="s3d">
<label>3.4</label>
<title>Inferring evolutionary unpredictability from CPMs</title>
<p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows the relationship between the estimated and true numbers and diversities of paths of tumor progression.</p>
<p>Even under representable fitness landscapes, and for the two methods with the best behavior, CBN and OT, there was large variability in the estimates of the number of paths to the maximum relative to the true number of paths associated to differences in sample size and number of genes, as shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref>.</p>
<p>Average ratios of estimated paths to the maximum over true paths to the maximum were 1.4 and 6.9 for 7 and 10 genes for CBN (and 0.4 and 1.9 for OT). But values for CBN range from 0.5 (7 genes, sample size 50, uniform detection regime), to 33.9 (10 genes, sample size 4000, large detection regime); for OT they range from 0.2 (7 genes, sample size 200, uniform, detection) to 5.6 (10 genes, sample size 4000, large detection regime). In <xref ref-type="sec" rid="s3a">section 3.1</xref> (see also Supplementary Material, &#x201C;Fitness landscapes: characteristics, evolutionary predictability, clonal interference&#x201D;) we saw that the true number of paths to the maximum increased with the number of genes; what we see here is that the inferred number of evolutionary paths to the maximum from CBN and OT often increased even faster, a consequence of worse recall under 10 genes. Detection regime and sample size had a large effect: number of paths inferred increased with sample size, specially under the large detection regime.</p>
<p>For both CBN and OT that disproportionate increase in the number of inferred paths carried only a small penalty in terms of estimating evolutionary unpredictability (the diversity of paths to the maximum, <italic>S<sub>p</sub></italic>), as can be seen from <xref ref-type="fig" rid="fig6">Figure 6B</xref>. For example, for CBN the ratio of inferred to observed diversities, <italic>S<sub>c</sub></italic>/<italic>S<sub>p</sub></italic>, remained close to 1 with values from 0.68&#x00D7; to 1.04&#x00D7; over all combinations of type of landscape by detection regime by number of genes by sample size (averages of 0.81&#x00D7; and 0.93&#x00D7; for seven and ten genes); the values were closest to one with sample size 4000 and under the uniform detection regime.</p>
<p>In contrast to CBN and OT, patterns for CAPRI seemed dominated by the tendency of CAPRI to only allow very few paths as the sample size grows large, and mainly under the uniform detection regime (see also Supplementary Material, section &#x201C;Number of paths inferred&#x201D;). Under representable landscapes, CAPRI underestimates, sometimes severely, the true diversity of paths to the maximum (<xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p>
<p>The above results apply to representable landscapes. Under RMF, the number of paths tended to be overstimated by very large factors (averages over seven and ten genes: paths: CBN 2.9<italic>&#x00D7;</italic> and 55.6<italic>&#x00D7;</italic>; OT: 5.1<italic>&#x00D7;</italic> and 128<italic>&#x00D7;</italic>; CAPRI: 3.5<italic>&#x00D7;</italic> and 61<italic>&#x00D7;</italic>), especially with 10 genes and sample sizes of 4000 (CBN: 112<italic>&#x00D7;</italic>; OT: 236<italic>&#x00D7;</italic>; CAPRI: 61<italic>&#x00D7;</italic>). Diversity was also overstimated but, as above, by smaller factors (averages over seven and ten genes: CBN 1.1<italic>&#x00D7;</italic> and 1.6<italic>&#x00D7;</italic>; OT: 2.1&#x00D7; and 2.8&#x00D7;; CAPRI: 3.0&#x00D7; and 3.5&#x00D7;; values for 10 genes and sample sizes of 4000: CBN: 2.2; OT: 3.5&#x00D7;; CAPRI: 4.0&#x00D7;).</p>
<p>And how does the estimated evolutionary unpredictability change with the true evolutionary unpredictability? <xref ref-type="fig" rid="fig6">Figure 6C</xref> shows that the slopes of regressions of estimated unpredictability from CPMs (<italic>S<sub>c</sub></italic>) on true unpredictability (<italic>S<sub>p</sub></italic>) changed depending on fitness landscape, detection regime, and sample size, including slopes over and under 1, and even inversion of signs (ranges of slopes over all combinations of type of landscape by detection regime by number of genes by sample size: CBN: 0.47 to 1.27; OT: 0.43 to 1.50; CAPRI: -1.04 to 1.19); in contrast, those slopes remained basically constant over sample size if we simply regressed sample diversity on <italic>S<sub>p</sub></italic>.</p>
</sec>
<sec id="s3e">
<label>3.5</label>
<title>Cancer data sets</title>
<p>We will use CPMs on eleven cancer data sets to examine their usefulness for predicting tumor evolution. These data include five different cancer types, with number of patients that range from 27 to 326 and number of features from seven to 192. Three data sets code mutations in terms both of genes and pathways (colon, glioblastoma, pancreas; genes, pathways). We have analyzed all the data sets with CBN (the best performing method &#x2014;see <xref ref-type="sec" rid="s3b">sections 3.2</xref> and <xref ref-type="sec" rid="s3d">3.4</xref>). We have run the analysis three times per data set, limiting the number of features analyzed to the seven, ten, and 13 most common ones, so as to examine how our assessments depend on the number of features; the first two thresholds use the same number of features as the simulations. (Of course, for data sets with 7 or fewer features, there are no differences in the data sets used under the 7, 10, and 13 thresholds, so the values show below reflect variability between runs; ditto for data sets with 8 to 10 features with respect to thresholds 10 and 13).</p>
<p>We do not know the true paths of tumor progression, but we can use the bootstrap to asses the robustness of the inferences. To do so, we repeated the process above with 20 bootstrap samples (see Supplementary Material &#x201C;Bootstrapping on the cancer data sets&#x201D;). We measured the JS between the distribution of paths to the maximum from the original data set and each of the bootstrapped samples (<italic>JS<sub>o,b</sub></italic>). Large differences in the distribution of paths between the analyses with the bootstrap samples and the analysis with the original sample suggests that the inferences cannot be trusted (but small differences do not indicate that the inferred paths match the distribution of the true ones).</p>
<p>The results are shown in <xref ref-type="fig" rid="fig7">Figure 7</xref>. Performance (<italic>JS<sub>o,b</sub></italic>) was generally poor for most data sets, and very poor for some of them. These results would not be unexpected, even if the true fitness landscapes were representable ones, as most of the data sets have small sample sizes, and we have seen that performance (<italic>JS</italic>) is poor for that range of sample sizes (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). When the same data set was analyzed using pathways and genes, performance was generally better using pathways. As the number of features analyzed increased from 7 to 10 to 13, the unreliability of the inferences generally increased too.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Results from the cancer data sets analyzed with CBN. In A) and B), data sets have been ordered by increasing sample size, and the x-axis labels provide the acronym (shown in full in the inset legend). Below the data set acronym are the sample size and the total number of features, respectively. We used CBN for all analyses. Analysis were run three times, limiting the number of features analyzed to the seven, ten, and 13 most common ones; the boxplots for each data set are shown in increasing order of number of features. For data sets such as, say, Pancreas genes, using 7, 10, or 13 maximum features makes no difference in the actual number of features analyzed; the three replicate runs show run-to-run variability. A) <italic>JS<sub>o</sub></italic><sub>,<italic>b</italic></sub>: JS statistic for the comparison of the distribution of paths from running CBN on the original data set against the distribution of paths from running CBN on each one of the bootstrap runs. B) Diamonds show the <italic>S<sub>c</sub></italic> from the full data, and boxplots the <italic>S<sub>c</sub></italic> from the boostrap runs. Right axis labeled by number of equiprobable paths equivalent to the <italic>S<sub>c</sub></italic>. C) Histograms of number of mutations per individual in the data set. D) Scatterplot of the mean of the JS statistic (panel A) vs. <italic>S<sub>c</sub></italic> (both from analyses with up to 13 features).</p></caption>
<graphic xlink:href="371039_fig7.tif"/>
</fig>
<p>What determines the variation in <italic>JS<sub>o,b</sub></italic> in <xref ref-type="fig" rid="fig7">Figure 7A</xref>? The pancreas pathways data has the smallest <italic>JS<sub>o,b</sub></italic> and this contrasts with the much larger <italic>JS<sub>o,b</sub></italic> of the same data analyzed using genes. A similar, though not as extreme, pattern appears in glioblastoma. Determinants of performance are complex and related to the association between features and distribution of genotypes. But one possible explanation is shown in <xref ref-type="fig" rid="fig7">Figure 7C</xref>: the data set for pancreas pathways contains 68 subjects with the same five pathways mutated, whereas in the pancreas genes most subjects have only a few mutations. In general, data sets where most subjects had only a few mutations, relative to the number of features in the data set, had very large <italic>JS<sub>o,b</sub></italic>. When most individuals in the sample have very few mutations, estimations of the restrictions on the downstream mutations are probably very noisy and, thus, different between bootstrapped data sets.</p>
<p>Values for <italic>S<sub>c</sub></italic> were well within the ranges of <italic>S<sub>c</sub></italic> estimated by CBN for the simulated data (see Supplementary Material, &#x201C;Estimated <italic>S<sub>c</sub></italic> by CBN&#x201D;). Of course, <italic>S<sub>c</sub></italic> increased with numbers of features analyzed. Given the results from <xref ref-type="sec" rid="s3d">section 3.4</xref>, where generally <italic>S<sub>p</sub> &#x003C; S<sub>c</sub></italic>, this suggests that the true evolutionary unpredictability (when analyzing up to 13 features) for eight of the data sets should be less than that corresponding to about 100 equiprobable paths to the maximum, but only four are below the much more manageable, and useful, 20 equiprobable paths. The pancreas pathways data set is here also an extreme case: examination of the output shows that there was one single path with estimated probability <italic>&#x003E;</italic> 0.97. There was a positive association between <italic>S<sub>c</sub></italic> and <italic>JS<sub>o,b</sub></italic> between the full and bootstrapped data sets (<xref ref-type="fig" rid="fig7">Figure 7 D</xref>), but some data sets with small <italic>S<sub>c</sub></italic> had very unreliable path predictions (e.g., colon and glioblastoma genes, MSI, MSS); conversely, the data set with pathway information from three cancers (All Pathways), even if it had the largest <italic>S<sub>c</sub></italic> had a moderate <italic>JS<sub>o,b</sub></italic>.</p>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion</title>
<p>Can we predict the likely course of tumor progression using CPMs? CBN, the best performing CPM method in our study, under the representable fitness landscapes (the easiest scenario, as it fits the underlying model), returned estimates of the probability of paths of tumor evolution that were not far from the true distribution of paths of evolution (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) when sample size was very large. But we find that performance with moderate (and more realistic) sample sizes was considerably worse and was affected by detection regimen. The analysis of the cancer data sets revealed that performance (<italic>JS<sub>o,b</sub></italic>>) was poor or very poor for most data sets. What factors, and how, affect performance?</p>
<p>Detection regime and LOD diversity (<italic>S<sub>p</sub></italic>) affected individually and jointly all performance measures (<xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig4">4</xref>, <xref ref-type="fig" rid="fig5">5</xref>), and increasing sample size improved all performance measures. CBN had better performance under the uniform detection regime (where more genotypes, with larger diversity, and larger dispersion in the number of mutations, are represented in the samples). But all performance measures (<xref ref-type="fig" rid="fig5">Figure 5</xref>, Supplementary Material &#x201C;Slopes of regressions of recall and precision on LOD diversity&#x201D;), improved with increasing unpredictability in the large and small detection regimes, specially with smaller samples sizes. The large and small detection regimes differ from the uniform in number of mutations, each in a different direction. What is common to both the large and small detection regimes is that increased evolutionary unpredictability leads to a larger range of observed genotypes. Increased unpredictability is thus associated to improved performance probably because it provides a surplus variability (but the improved performance does not rise up to the levels of the uniform detection regime). The summary messages from the simulations are, thus: a) increased evolutionary unpredictability hurts performance, unless the sampled genotypes (because of sample size or detection regime) have too low variability; b) detection regime can be a key determinant of performance, as already found in previous work (<xref ref-type="bibr" rid="c21">Diaz-Uriarte, 2015</xref>, 2018). The analysis of the cancer data sets reinforces the last conclusion: the distribution of mutations per sample is likely a major determinant of performance.</p>
<p>Performance was also affected by the number of features analyzed, the dimension of the fitness landscape. Performance in the simulated data sets (JS) was worse with 10 than with 7 seven genes (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and, of course, <italic>S<sub>p</sub></italic> itself was larger under 10 genes (see Supplementary Material). In the eleven cancer data sets, both estimated unpredictability (<italic>S<sub>c</sub></italic>) and deviations of JS between the full and bootstrapped data sets (<italic>JS<sub>o</sub></italic><sub>,<italic>b</italic></sub>) increased with number of features. This result is not surprising, but brings forth the problem of the selection of the relevant features for analysis (<xref ref-type="bibr" rid="c13"><italic>Caravagna et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c16"><italic>Cristea et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c29"><italic>Gerstung et al.</italic>, 2011</xref>). We have shown that feature selection can have a very detrimental impact on the performance of CPM methods (<xref ref-type="bibr" rid="c21">Diaz-Uriarte, 2015</xref>). Using pathways instead of genes in the analyses (see, e.g., <xref ref-type="bibr" rid="c16"><italic>Cristea et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c55">Raphael and Vandin, 2015</xref>) can alleviate some of the problems of feature selection. Pathways can also improve predictability and how close the estimates of path distributions are to the truth because they are more similar to heritable phenotypes, which often have smoother phenotype-fitness maps and tend to show more repeatable evolution (<xref ref-type="bibr" rid="c35"><italic>L&#x00E4;ssig et al.</italic>, 2017</xref>; see also <xref ref-type="bibr" rid="c64"><italic>Wang et al.</italic>, 2015</xref>, but also <xref ref-type="bibr" rid="c14">Chebib and Guillaume, 2017</xref>; <xref ref-type="bibr" rid="c56">Sailer and Harms, 2017</xref>). <xref ref-type="bibr" rid="c29">Gerstung <italic>et al.</italic> (2011)</xref> found that analysis using pathways gave stronger evidence for order constraints than analysis using genes and we also see in <xref ref-type="fig" rid="fig7">Figure 7</xref> that both <italic>S<sub>c</sub></italic> and <italic>JS<sub>o,b</sub></italic> tend to decrease if we use pathways; &#x201C;All Pathways&#x201D; constitutes a promising case because it has large <italic>S<sub>c</sub></italic> but moderate <italic>JS<sub>o,b</sub></italic>.</p>
<p><xref ref-type="bibr" rid="c32">Hosseini (2018)</xref> has reanalized the DAG-derived representable and a subset (those where the fully mutated genotype has largest fitness) of the DAG-derived non-representable fitness landscapes in <xref ref-type="bibr" rid="c23">Diaz-Uriarte (2018)</xref>. He finds good agreement (small Kullback-Leibler divergence) between the distributions of paths to the maximum from CBN and the fitness landscape-based probability distribution of paths to the maximum. Our results for CBN under the best conditions are not as optimistic. Two differences in the studies explain the differences. First, <xref ref-type="bibr" rid="c32">Hosseini (2018)</xref> computes the fitness landscape-based probability of paths assuming a strong selection weak mutation regime, not by directly examining the actual distribution of the paths to the maximum in each simulation (i.e., he does not use the LODs) and, second, he uses CBN with the very large sample size of 20000 (the full data sets in <xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>).</p>
<p>An important caveat of the discussion so far (which also applies to <xref ref-type="bibr" rid="c32">Hosseini, 2018</xref>,&#x2019;s results) is that very good performance simply tells us that the true and estimated probability distributions of the paths to the maximum agree closely. If the true evolutionary unpredictability is large, then for practical purposes our capacity to predict what will happen (in the sense of providing a small set of likely outcomes) is very limited. To give a feeling for these values, 25 equiprobable paths have a diversity of 3.2, and 400 equiprobable paths a diversity of 6.0 (see also <xref ref-type="fig" rid="fig7">Figure 7</xref>), values of diversity comparable to those seen for representable fitness landscapes of seven and ten genes in our data (see Supplementary Material), and similar to those of several of the eleven cancer data sets. The inability to narrow down the likely paths to a small set of paths in these cases is, of course, not a limitation of the methods, but a problem inherent to the unpredictability of the evolutionary process in many scenarios, which could severely limit the usefulness of even perfect predictions.</p>
<p>We have focused on three families of methods. The behavior of CAPRI contrasted with that of OT and CBN in terms of recall: it improved little or even degraded with increasing sample size. That is because CAPRI allowed few paths to the maximum (it encodes too many restrictions in the DAGs of restrictions), and their number decreased with sample size (Supplementary Material &#x201C;Number of paths inferred&#x201D; and <xref ref-type="fig" rid="fig6">Figure 6A</xref>). CAPRI&#x2019;s precision is not surprising: the few paths to the maximum that it allowed were actually used by evolution. This is related to the increased false negative discoveries for CAPRI discussed in <xref ref-type="bibr" rid="c23">Diaz-Uriarte (2018)</xref>. Briefly, because of both the objective of CAPRI (identification of &#x201C;probability raising&#x201D; relationships) and its workings (fitting a Bayesian Network using penalized likelihood after filtering relationships to fit probability raising and temporal priority), it is not possible to obtain probabilities of paths (<xref ref-type="sec" rid="s2d">section 2.4</xref>) but, moreover, the results of CAPRI cannot be mapped unambiguously to sets of possible and non-possible paths of tumor evolution, in contrast to OT and CBN (see details in Supplementary Material &#x201C;CAPRI, CAPRESE, and paths of tumor progression&#x201D;).</p>
<p>The above discussion has centered on representable fitness landscapes. As argued above, it is reasonable to suspect fitness landscapes with local fitness maxima are common in cancer. Interestingly, for small sample sizes, recall was sometimes better in DAG-derived and RMF than under representable landscapes (<xref ref-type="fig" rid="fig2">Figure 2</xref>): with local fitness maxima, achieving good recall involves the relatively easier task of getting right the first part of short paths to the maximum (see Supplementary Material,&#x201C;Number of mutations of local maxima and performance&#x201D;, where 1-recall increases with the average number of mutations of local fitness maxima). But good recall was more than offset by the low precision: overall predictability was very poor. The decrease in precision is the consequence of local fitness maxima: CPMs are fitting models with paths of tumor progression that extend beyond the true end point of the progression. In addition, RMF fitness landscapes strongly violate the CPM assumption that acquiring a mutation in one gene does not decrease the probability of acquiring a mutation in another gene (see <xref ref-type="bibr" rid="c23">Diaz-Uriarte, 2018</xref>).</p>
<p>Returning to our third original question, even if achieving good performance in predicting the actual paths of tumor progression is unlikely, inferring evolutionary unpredictability could be an easier task. Can we use inferences of evolutionary unpredictability from CPMs as estimates of the true evolutionary unpredictability? Under representable fitness landscapes, CBN, the best performing method also for this task (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), returned values of <italic>S<sub>c</sub></italic> very similar to <italic>S<sub>p</sub></italic>, the evolutionary unpredictability estimated from the diversity of paths, and this held over detection regimes and sample sizes. <xref ref-type="bibr" rid="c32">Hosseini (2018)</xref> also finds that the estimates of predictability from CBN correlate well with the true evolutionary predictability, and his slopes of the regression of CPM-based on landscape-based predictability are generally slightly below 1, which agrees with our <xref ref-type="fig" rid="fig6">Figure 6C</xref> (left-most column). These good results do not hold under the other two fitness landscapes: evolutionary unpredictability is overestimated, and increasing sample sizes makes the problems worse. Could we do better by trying to infer the true evolutionary unpredictability by using an inverse regression procedure of a regression of CPM path diversity (estimated unpredictability, <italic>S<sub>c</sub></italic>) on LOD diversity (true unpredictability, <italic>S<sub>p</sub></italic>)? As shown in <xref ref-type="fig" rid="fig6">Figure 6C</xref> this is also unlikely to succeed: different scenarios, sample sizes, and detection regimes have different relationships of estimated predictability regressed on true unpredictability, and marginalizing over all those factors leads to a very large spread around a single regression line (see Supplementary Material &#x201C;Regression of individual CBN unpredictability estimates on LOD diversity&#x201D;). Trying the inverse regression approach properly with experimental data would require that many other details of the process (e.g., type of landscape, detection regime) were known, and this are currently unknown (and unlikely to be known in the future). But our results indicate that we can use CBN to set upper bounds on the true <italic>S<sub>p</sub></italic>; obtaining tighter estimates is an issue for further research to explore. And here our analysis of eleven cancer data sets suggests that the true evolutionary unpredictability of at least some cancer scenarios might be reasonably small, specially if <italic>S<sub>c</sub></italic> is overestimating the true unpredictability.</p>
<sec id="s4a">
<label>4.1</label>
<title>Conclusion</title>
<p>The answer to the question &#x201C;can we predict the likely course of tumor progression using CPMs?&#x201D; is, unfortunately, &#x201C;only with moderate success and only under representable fitness landscapes and with very large sample sizes; but even perfect predictions might be of little use if evolutionary unpredictability is large&#x201D;. Estimating upper bounds to evolutionary unpredictability is a more modest, though more likely to succeed, use of CPMs. There are three key difficulties for successful prediction: the sheer size of the problem even for moderate numbers of genes, the intrinsic evolutionary unpredictability in many scenarios, and the deviations from the assumptions of CPMs that are likely to hold in most cancer data. In addition to the caveat about using methods under scenarios where performance is very poor, this paper raises the general question of what can we really predict about likely paths of tumor progression from cross-sectional data, for instance to guide therapeutic interventions.</p>
</sec>
</sec>
</body>
<back>
<ack>
<label>5</label>
<title>Acknowledgements</title>
<p>S. Alvarez-Tolcheff for help writing some of the code to generate to local maxima fitness landscapes. N. Beerenwinkel, S. Posada-C&#x00E9;spedes, and G. Caravagna for discussion about progression models or software, and S.-R. Hosseini for providing a preprint of his MSc. thesis.</p>
<p>Supported by BFU2015-67302-R (MINECO/FEDER, EU). CVV supported by PEJD-2016/MED-2116 from Comunidad de Madrid.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Attolini</surname>, <given-names>C.</given-names></string-name> <etal>et al</etal> (<year>2010</year>). <article-title>A mathematical framework to determine the temporal sequence of somatic genetic events in cancer</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>107</volume>(<issue>41</issue>), <fpage>17604</fpage>&#x2013;<lpage>17609</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bamford</surname>, <given-names>S.</given-names></string-name> <etal>et al</etal> (<year>2004</year>). <article-title>The COSMIC (Catalogue of Somatic Mutations in Cancer) database and website</article-title>. <source>Br J Cancer</source>, <volume>91</volume>(<issue>2</issue>), <fpage>355</fpage>&#x2013;<lpage>358</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bank</surname>, <given-names>C.</given-names></string-name> <etal>et al</etal> (<year>2016</year>). <article-title>On the (un)predictability of a large intragenic fitness landscape</article-title>. <source>PNAS</source>, <volume>113</volume>(<issue>49</issue>), <fpage>14085</fpage>&#x2013;<lpage>14090</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Beerenwinkel</surname>, <given-names>N.</given-names></string-name> <etal>et al</etal> (<year>2007</year>). <article-title>Genetic progression and the waiting time to cancer</article-title>. <source>PLoS computational biology</source>, <volume>3</volume>(<issue>11</issue>), <fpage>e225</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Beerenwinkel</surname>, <given-names>N.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>Cancer evolution: Mathematical models and computational inference</article-title>. <source>Systematic Biology</source>, <volume>64</volume>(<issue>1</issue>), <fpage>e1</fpage>&#x2013;<lpage>e25</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Beerenwinkel</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Greenman</surname>, <given-names>C.D.</given-names></string-name> and <string-name><surname>Lagergren</surname>, <given-names>J.</given-names></string-name> (<year>2016</year>). <article-title>Computational Cancer Biology: An Evolutionary Perspective</article-title>. <source>PLoS Comput. Biol.</source>, <volume>12</volume>(<issue>2</issue>), <fpage>e1004717</fpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Beijersbergen</surname>, <given-names>R.L.</given-names></string-name>, <string-name><surname>Wessels</surname>, <given-names>L.F.A.</given-names></string-name> and <string-name><surname>Bernards</surname>, <given-names>R.</given-names></string-name> (<year>2017</year>). <article-title>Synthetic Lethality in Cancer Therapeutics</article-title>. <source>Annual Review of Cancer Biology</source>, <volume>1</volume>(<issue>1</issue>), <fpage>141</fpage>&#x2013;<lpage>161</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Bell</surname>, <given-names>D.</given-names></string-name> <etal>et al</etal> (<year>2011</year>). <article-title>Integrated genomic analyses of ovarian carcinoma</article-title>. <source>Nature</source>, <volume>474</volume>(<issue>7353</issue>), <fpage>609</fpage>&#x2013;<lpage>615</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Blomen</surname>, <given-names>V.A.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>Gene essentiality and synthetic lethality in haploid human cells</article-title>. <source>Science</source>, <volume>350</volume>(<issue>6264</issue>), <fpage>1092</fpage>&#x2013;<lpage>1096</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Bozic</surname>, <given-names>I.</given-names></string-name> <etal>et al</etal> (<year>2010</year>). <article-title>Accumulation of driver and passenger mutations during tumor progression</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>107</volume>, <fpage>18545</fpage>&#x2013;<lpage>18550</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Brooks</surname>, <given-names>M.E.</given-names></string-name> <etal>et al</etal> (<year>2017</year>). <article-title>glmmTMB Balances Speed and Flexibility Among Packages for Zero-inflated Generalized Linear Mixed Modeling</article-title>. <source>The R Journal</source>, <volume>9</volume>(<issue>2</issue>), <fpage>378</fpage>&#x2013;<lpage>400</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Brouillet</surname>, <given-names>S.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>MAGELLAN: A tool to explore small fitness landscapes</article-title>. <source>bioRxiv</source>, page <fpage>031583</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Caravagna</surname>, <given-names>G.</given-names></string-name> <etal>et al</etal> (<year>2016</year>). <article-title>Algorithmic methods to infer the evolutionary trajectories in cancer progression</article-title>. <source>PNAS</source>, <volume>113</volume>(<issue>28</issue>), <fpage>E4025</fpage>&#x2013;<lpage>E4034</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Chebib</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Guillaume</surname>, <given-names>F.</given-names></string-name> (<year>2017</year>). <article-title>What affects the predictability of evolutionary constraints using a G-matrix? The relative effects of modular pleiotropy and mutational correlation</article-title>. <source>Evolution</source>, <volume>71</volume>(<issue>10</issue>), <fpage>2298</fpage>&#x2013;<lpage>2312</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Chiotti</surname>, <given-names>K.E.</given-names></string-name> <etal>et al</etal> (<year>2014</year>). <article-title>The Valley-of-Death: Reciprocal sign epistasis constrains adaptive trajectories in a constant, nutrient limiting environment</article-title>. <source>Genomics</source>, <volume>104</volume>(<issue>6, Part A</issue>), <fpage>431</fpage>&#x2013;<lpage>437</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Cristea</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kuipers</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Beerenwinkel</surname>, <given-names>N.</given-names></string-name> (<year>2016</year>). <article-title>pathTiMEx: Joint Inference of Mutually Exclusive Cancer Pathways and Their Progression Dynamics</article-title>. <source>Journal of Computational Biology</source>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Crona</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Greene</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Barlow</surname>, <given-names>M.</given-names></string-name> (<year>2013</year>). <article-title>The peaks and geometry of fitness landscapes</article-title>. <source>Journal of Theoretical Biology</source>, <volume>317</volume>, <fpage>1</fpage>&#x2013;<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Crooks</surname>, <given-names>G.E.</given-names></string-name> (<year>2017</year>). <article-title>On measures of entropy and information</article-title>. <source>Technical report</source>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>de Visser</surname>, <given-names>J.A.G.M.</given-names></string-name> and <string-name><surname>Krug</surname>, <given-names>J.</given-names></string-name> (<year>2014</year>). <article-title>Empirical fitness landscapes and the predictability of evolution</article-title>. <source>Nat Rev Genet</source>, <volume>15</volume>(<issue>7</issue>), <fpage>480</fpage>&#x2013;<lpage>490</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Desper</surname>, <given-names>R.</given-names></string-name> <etal>et al</etal> (<year>1999</year>). <article-title>Inferring tree models for oncogenesis from comparative genome hybridization data</article-title>. <source>J Comput Biol</source>, <volume>6</volume>(<issue>1</issue>), <fpage>37</fpage>&#x2013;<lpage>51</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Diaz-Uriarte</surname>, <given-names>R.</given-names></string-name> (<year>2015</year>). <article-title>Identifying restrictions in the order of accumulation of mutations during tumor progression: Effects of passengers, evolutionary models, and sampling</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>(<issue>41</issue>), <fpage>0</fpage>&#x2013;<lpage>36</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Diaz-Uriarte</surname>, <given-names>R.</given-names></string-name> (<year>2017</year>). <article-title>OncoSimulR: Genetic simulation with arbitrary epistasis and mutator genes in asexual populations</article-title>. <source>Bioinformatics</source>, <volume>33</volume>(<issue>12</issue>), <fpage>1898</fpage>&#x2013;<lpage>1899</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Diaz-Uriarte</surname>, <given-names>R.</given-names></string-name> (<year>2018</year>). <article-title>Cancer progression models and fitness landscapes: A many-to-many relationship</article-title>. <source>Bioinformatics</source>, <volume>34</volume>(<issue>5</issue>), <fpage>836</fpage>&#x2013;<lpage>844</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Ding</surname>, <given-names>L.</given-names></string-name> <etal>et al</etal> (<year>2008</year>). <article-title>Somatic mutations affect key pathways in lung adenocarcinoma</article-title>. <source>Nature</source>, <volume>455</volume>(<issue>7216</issue>), <fpage>1069</fpage>&#x2013;<lpage>1075</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Ferrari</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Cribari-Neto</surname>, <given-names>F.</given-names></string-name> (<year>2004</year>). <article-title>Beta Regression for Modelling Rates and Proportions</article-title>. <source>Journal of Applied Statistics</source>, <volume>31</volume>(<issue>7</issue>), <fpage>799</fpage>&#x2013;<lpage>815</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="book"><string-name><surname>Fox</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Weisberg</surname>, <given-names>S.</given-names></string-name> (<year>2011</year>). <source>An R Companion to Applied Regression</source>, <edition>2nd Ed</edition>. <publisher-name>Sage, Thousand Oaks, CA</publisher-name>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Franke</surname>, <given-names>J.</given-names></string-name> <etal>et al</etal> (<year>2011</year>). <article-title>Evolutionary Accessibility of Mutational Pathways</article-title>. <source>PLoS Comput Biol</source>, <volume>7</volume>(<issue>8</issue>), <fpage>e1002134</fpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Gerstung</surname>, <given-names>M.</given-names></string-name> <etal>et al</etal> (<year>2009</year>). <article-title>Quantifying cancer progression with conjunctive Bayesian networks</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>25</volume>(<issue>21</issue>), <fpage>2809</fpage>&#x2013;<lpage>2815</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Gerstung</surname>, <given-names>M.</given-names></string-name> <etal>et al</etal> (<year>2011</year>). <article-title>The Temporal Order of Genetic and Pathway Alterations in Tumorigenesis</article-title>. <source>PLoS ONE</source>, <volume>6</volume>(<issue>11</issue>), <fpage>e27136</fpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Greaves</surname>, <given-names>M.</given-names></string-name> (<year>2015</year>). <article-title>Evolutionary Determinants of Cancer</article-title>. <source>Cancer Discovery</source>, <volume>5</volume>(<issue>8</issue>), <fpage>806</fpage>&#x2013;<lpage>820</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Gr&#x00FC;n</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Kosmidis</surname>, <given-names>I.</given-names></string-name> and <string-name><surname>Zeileis</surname>, <given-names>A.</given-names></string-name> (<year>2012</year>). <article-title>Extended Beta Regression in <italic>R</italic> : Shaken, Stirred, Mixed, and Partitioned</article-title>. <source>Journal of Statistical Software</source>, <volume>48</volume>(<issue>11</issue>).</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="thesis"><string-name><surname>Hosseini</surname>, <given-names>S.R.</given-names></string-name> (<year>2018</year>). <source>Quantifying the Predictability of Cancer Progression Using Conjunctive Bayeisan Networks</source>. Ph.D. thesis, ETH, Zurich.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Hothorn</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Bretz</surname>, <given-names>F.</given-names></string-name> and <string-name><surname>Westfall</surname>, <given-names>P.</given-names></string-name> (<year>2008</year>). <article-title>Simultaneous inference in general parametric models</article-title>. <source>Biom J</source>, <volume>50</volume>(<issue>3</issue>), <fpage>346</fpage>&#x2013;<lpage>363</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="book"><string-name><surname>Jones</surname>, <given-names>S.</given-names></string-name> <etal>et al</etal> (<year>2008</year>). <chapter-title>Core signaling pathways in human pancreatic cancers revealed by global genomic analyses</chapter-title>. <source>Science</source> (<publisher-name>New York, N.Y</publisher-name>.), <volume>321</volume>(<issue>5897</issue>), <fpage>1801</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>L&#x00E4;ssig</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mustonen</surname>, <given-names>V.</given-names></string-name> and <string-name><surname>Walczak</surname>, <given-names>A.M.</given-names></string-name> (<year>2017</year>). <article-title>Predicting evolution</article-title>. <source>Nature Ecology &#x0026; Evolution</source>, <volume>1</volume>(<issue>3</issue>), <fpage>s41559&#x2013;017</fpage>&#x2013;<lpage>0077&#x2013;017</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Lin</surname>, <given-names>J.</given-names></string-name> (<year>1991</year>). <article-title>Divergence measures based on the Shannon entropy</article-title>. <source>IEEE Transactions on Information theory</source>, <volume>37</volume>(<issue>1</issue>), <fpage>145</fpage>&#x2013;<lpage>151</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Lipinski</surname>, <given-names>K.A.</given-names></string-name> <etal>et al</etal> (<year>2016</year>). <article-title>Cancer Evolution and the Limits of Predictability in Precision Cancer Medicine</article-title>. <source>Trends in Cancer</source>, <volume>2</volume>(<issue>1</issue>), <fpage>49</fpage>&#x2013;<lpage>63</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Loohuis</surname>, <given-names>L.O.</given-names></string-name> <etal>et al</etal> (<year>2014</year>). <article-title>Inferring Tree Causal Models of Cancer Progression with Probability Raising</article-title>. <source>PLoS ONE</source>, <volume>9</volume>(<issue>10</issue>), <fpage>e108358</fpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="book"><string-name><surname>Losos</surname>, <given-names>J.B.</given-names></string-name> (<year>2018</year>). <source>Improbable Destinies: Fate, Chance, and the Future of Evolution</source>. <publisher-name>Riverhead Books, S.l</publisher-name>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="book"><string-name><surname>McCullagh</surname>, <given-names>P.</given-names></string-name> and <string-name><surname>Nelder</surname>, <given-names>J.</given-names></string-name> (<year>1989</year>). <source>Generalized Linear Models</source>, <edition>2nd Ed</edition>. <publisher-name>Chapman and Hall/CRC</publisher-name>, <publisher-loc>London</publisher-loc>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>McFarland</surname>, <given-names>C.D.</given-names></string-name> <etal>et al</etal> (<year>2013</year>). <article-title>Impact of deleterious passenger mutations on cancer progression</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>110</volume>(<issue>8</issue>), <fpage>2910</fpage>&#x2013;<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>McPherson</surname>, <given-names>A.W.</given-names></string-name>, <string-name><surname>Chan</surname>, <given-names>F.C.</given-names></string-name> and <string-name><surname>Shah</surname>, <given-names>S.P.</given-names></string-name> (<year>2018</year>). <article-title>Observing Clonal Dynamics across Spatiotemporal Axes: A Prelude to Quantitative Fitness Models for Cancer</article-title>. <source>Cold Spring Harb Perspect Med</source>, <volume>8</volume>(<issue>2</issue>).</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Misra</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Szczurek</surname>, <given-names>E.</given-names></string-name> and <string-name><surname>Vingron</surname>, <given-names>M.</given-names></string-name> (<year>2014</year>). <article-title>Inferring the paths of somatic evolution in cancer</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>30</volume>(<issue>17</issue>), <fpage>2456</fpage>&#x2013;<lpage>2463</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Montazeri</surname>, <given-names>H.</given-names></string-name> <etal>et al</etal> (<year>2016</year>). <article-title>Large-scale inference of conjunctive Bayesian networks</article-title>. <source>Bioinformatics</source>, <volume>32</volume>(<issue>17</issue>), <fpage>i727</fpage>&#x2013;<lpage>i735</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Neidhart</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Szendro</surname>, <given-names>I.G.</given-names></string-name> and <string-name><surname>Krug</surname>, <given-names>J.</given-names></string-name> (<year>2014</year>). <article-title>Adaptation in Tunably Rugged Fitness Landscapes: The Rough Mount Fuji Model</article-title>. <source>Genetics</source>, <volume>198</volume>(<issue>2</issue>), <fpage>699</fpage>&#x2013;<lpage>721</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Network</surname>, <given-names>T.C.G.A.</given-names></string-name> (<year>2012</year>). <article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title>. <source>Nature</source>, <volume>487</volume>(<issue>7407</issue>), <fpage>330</fpage>&#x2013;<lpage>337</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Nowak</surname>, <given-names>M.A.</given-names></string-name> <etal>et al</etal> (<year>2004</year>). <article-title>Evolutionary dynamics of tumor suppressor gene inactivation</article-title>. <source>PNAS</source>, <volume>101</volume>(<issue>29</issue>), <fpage>10635</fpage>&#x2013;<lpage>10638</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>O&#x2019;Neil</surname>, <given-names>N.J.</given-names></string-name>, <string-name><surname>Bailey</surname>, <given-names>M.L.</given-names></string-name> and <string-name><surname>Hieter</surname>, <given-names>P.</given-names></string-name> (<year>2017</year>). <article-title>Synthetic lethality and cancer</article-title>. <source>Nat Rev Genet</source>, <volume>18</volume>(<issue>10</issue>), <fpage>613</fpage>&#x2013;<lpage>623</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Palmer</surname>, <given-names>A.C.</given-names></string-name> and <string-name><surname>Kishony</surname>, <given-names>R.</given-names></string-name> (<year>2013</year>). <article-title>Understanding, predicting and manipulating the genotypic evolution of antibiotic resistance</article-title>. <source>Nature Reviews Genetics</source>, <volume>14</volume>(<issue>4</issue>), <fpage>243</fpage>&#x2013;<lpage>248</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Parsons</surname>, <given-names>B.L.</given-names></string-name> (<year>2008</year>). <article-title>Many different tumor types have polyclonal tumor origin: Evidence and implications</article-title>. <source>Mutation research</source>, <volume>659</volume>(<issue>3</issue>), <fpage>232</fpage>&#x2013;<lpage>47</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Poelwijk</surname>, <given-names>F.J.</given-names></string-name> <etal>et al</etal> (<year>2007</year>). <article-title>Empirical fitness landscapes reveal accessible evolutionary paths</article-title>. <source>Nature</source>, <volume>445</volume>(<issue>7126</issue>), <fpage>383</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Poelwijk</surname>, <given-names>F.J.</given-names></string-name> <etal>et al</etal> (<year>2011</year>). <article-title>Reciprocal sign epistasis is a necessary condition for multi-peaked fitness landscapes</article-title>. <source>Journal of Theoretical Biology</source>, <volume>272</volume>(<issue>1</issue>), <fpage>141</fpage>&#x2013;<lpage>144</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2018</year>). <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Ramazzotti</surname>, <given-names>D.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>CAPRI: Efficient inference of cancer progression models from cross-sectional data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>(<issue>18</issue>), <fpage>3016</fpage>&#x2013;<lpage>3026</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Raphael</surname>, <given-names>B.J.</given-names></string-name> and <string-name><surname>Vandin</surname>, <given-names>F.</given-names></string-name> (<year>2015</year>). <article-title>Simultaneous Inference of Cancer Pathways and Tumor Progression from CrossSectional Mutation Data</article-title>. <source>Journal of Computational Biology</source>, <volume>22</volume>(<issue>00</issue>), <fpage>250</fpage>&#x2013;<lpage>264</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Sailer</surname>, <given-names>Z.R.</given-names></string-name> and <string-name><surname>Harms</surname>, <given-names>M.J.</given-names></string-name> (<year>2017</year>). <article-title>Molecular ensembles make evolution unpredictable</article-title>. <source>PNAS</source>, <volume>114</volume>(<issue>45</issue>), <fpage>11938</fpage>&#x2013;<lpage>11943</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Sjoblom</surname>, <given-names>T.</given-names></string-name> <etal>et al</etal> (<year>2006</year>). <article-title>The Consensus Coding Sequences of Human Breast and Colorectal Cancers</article-title>. <source>Science</source>, <volume>314</volume>(<issue>5797</issue>), <fpage>268</fpage>&#x2013;<lpage>274</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Smithson</surname>, <given-names>M.</given-names></string-name> and <string-name><surname>Verkuilen</surname>, <given-names>J.</given-names></string-name> (<year>2006</year>). <article-title>A better lemon squeezer? Maximum-likelihood regression with beta-distributed dependent variables</article-title>. <source>Psychological methods</source>, <volume>11</volume>(<issue>1</issue>), <fpage>54</fpage>&#x2013;<lpage>71</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Sniegowski</surname>, <given-names>P.D.</given-names></string-name> and <string-name><surname>Gerrish</surname>, <given-names>P.J.</given-names></string-name> (<year>2010</year>). <article-title>Beneficial mutations and the dynamics of adaptation in asexual populations</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>, <volume>365</volume>(<issue>1544</issue>), <fpage>1255</fpage>&#x2013;<lpage>1263</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="book"><string-name><surname>Szabo</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Boucher</surname>, <given-names>K.M.</given-names></string-name> (<year>2008</year>). <chapter-title>Oncogenetic trees</chapter-title>. In <person-group person-group-type="editor"><string-name><given-names>W.-Y.</given-names> <surname>Tan</surname></string-name> and <string-name><given-names>L.</given-names> <surname>Hanin</surname></string-name></person-group>, editors, <source>Handbook of Cancer Models with Applications</source>, pages <fpage>1</fpage>&#x2013;<lpage>24</lpage>. <publisher-name>World Scientific</publisher-name>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Szendro</surname>, <given-names>I.G.</given-names></string-name> <etal>et al</etal> (<year>2013</year>). <article-title>Predictability of evolution depends nonmonotonically on population size</article-title>. <source>PNAS</source>, <volume>110</volume>(<issue>2</issue>), <fpage>571</fpage>&#x2013;<lpage>576</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Tomasetti</surname>, <given-names>C.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>Only three driver gene mutations are required for the development of lung and colorectal cancers</article-title>. <source>PNAS</source>, <volume>112</volume>(<issue>1</issue>), <fpage>118</fpage>&#x2013;<lpage>123</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Toprak</surname>, <given-names>E.</given-names></string-name> <etal>et al</etal> (<year>2012</year>). <article-title>Evolutionary paths to antibiotic resistance under dynamically sustained drug selection</article-title>. <source>Nature Genetics</source>, <volume>44</volume>(<issue>1</issue>), <fpage>101</fpage>&#x2013;<lpage>105</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>E.</given-names></string-name> <etal>et al</etal> (<year>2015</year>). <article-title>Predictive genomics: A cancer hallmark network framework for predicting tumor clinical phenotypes using genome sequencing data</article-title>. <source>Seminars in Cancer Biology</source>, <volume>30</volume>, <fpage>4</fpage>&#x2013;<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Wodarz</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Komarova</surname>, <given-names>N.L.</given-names></string-name> (<year>2014</year>). <source>Dynamics of Cancer: Mathematical Foundations of Oncology</source>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Wood</surname>, <given-names>L.D.</given-names></string-name> <etal>et al</etal> (<year>2007</year>). <article-title>The Genomic Landscapes of Human Breast and Colorectal Cancers</article-title>. <source>Science</source>, <volume>318</volume>(<issue>5853</issue>), <fpage>1108</fpage>&#x2013;<lpage>1113</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>