<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/006940</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Convergent Evolution During Local Adaptation to Patchy Landscapes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Ralph</surname><given-names>Peter L.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Coop</surname><given-names>Graham</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Computational Biology and Bioinformatics, University of Southern California</institution>, Los Angeles, CA</aff>
<aff id="a2"><label>2</label><institution>Center for Population Biology &#x0026; Department of Evolution and Ecology, University of California &#x2013; Davis</institution>, Davis, CA, 95616</aff>
</contrib-group>
<author-notes>
<fn><p>email: <email>pralph@usc.edu</email>, <email>gmcoop@ucdavis.edu</email></p></fn>
</author-notes>
<pub-date pub-type="epub"><year>2014</year></pub-date>
<elocation-id>006940</elocation-id>
<history>
<date date-type="received">
<day>07</day>
<month>7</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>08</day>
<month>7</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2014, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2014</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="006940.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Species often encounter, and adapt to, many patches of locally similar environmental conditions across their range. Such adaptation can occur through convergent evolution as different alleles arise and spread in different patches, or through the spread of alleles by migration acting to synchronize adaptation across the species. The tension between the two reflects the degree of constraint imposed on evolution by the underlying genetic architecture versus how how effectively selection acts to inhibit the geographic spread of locally adapted alleles. This paper studies a model of the balance between these two routes to adaptation in continuous environments with patchy selection pressures. We address the following questions: How long does it take for a new, locally adapted allele to appear in a patch of habitat where it is favored through new mutation? Or, through migration from another, already adapted patch? Which is more likely to occur, as a function of distance between the patches? How can we tell which has occurred, i.e. what population genetic signal is left by the spread of migrant alleles and how long does this signal persist for? To answer these questions we decompose the migration&#x2013;selection equilibrium surrounding an already adapted patch into families of migrant alleles, in particular treating those rare families that reach new patches as spatial branching processes. This provides a way to understand the role of geographic separation between patches in promoting convergent adaptation and the genomic signals it leaves behind. We illustrate these ideas using the convergent evolution of cryptic coloration in the rock pocket mouse, <italic>Chaetodipus intermedius</italic>, as an empirical example.</p>
</abstract>
<counts>
<page-count count="27"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>The convergent evolution of similar phenotypes in response to shared selection pressures is a testament to the power of selection to repeatedly sculpt phenotypic variation. In some cases this convergence extends to the molecular level, with disparate taxa converging to the same phenotype through parallel genetic changes in the same pathway, genes, or even by precisely the same genetic changes [<xref ref-type="bibr" rid="c60">Stern, 2013</xref>, <xref ref-type="bibr" rid="c62">Zhen et al., 2012</xref>, <xref ref-type="bibr" rid="c42">Martin and Orgogozo, 2013</xref>]. Convergent adaptation can also occur within species, if individuals within a species adapt to the same environment, in parallel, through different genetic changes. There are a growing number of examples of this in a range of well studied organisms and phenotypes [<xref ref-type="bibr" rid="c3">Arendt and Reznick, 2008</xref>]. Such evolution of convergent phenotypes is favored by higher mutational input, i.e. larger mutational target and/or population size [<xref ref-type="bibr" rid="c49">Pennings and Hermisson, 2006</xref>]. The geographic distribution of populations can also affect the probability of parallel mutation within a species: a widespread species is more likely to adapt by multiple, parallel mutations if dispersal is geographically limited, since subpopulations will adapt via new mutations before the adaptive allele arrives via migration [<xref ref-type="bibr" rid="c53">Ralph and Coop, 2010</xref>]. Standing variation for a trait can also increase the probability of convergence, as standing variation for an allele increases the probability that the selective sweep will be <italic>soft</italic> (beginning from a base of multiple copies), leading to genetic patterns similar to convergent adaptation [<xref ref-type="bibr" rid="c48">Orr and Betancourt, 2001</xref>, <xref ref-type="bibr" rid="c28">Hermisson and Pennings, 2005</xref>].</p>
<p>Intuitively, convergence is also more likely when geographically separated populations adapt to ecologically similar conditions. The probability that convergent adaptations arise independently before adaptations spread between the populations by migration will be larger if these adaptive alleles are maladapted in intervening environments, since such adverse conditions can strongly spatially restrict the spread of locally adapted alleles [<xref ref-type="bibr" rid="c58">Slatkin, 1973</xref>].</p>
<p>One elegant set of such examples is provided by the assortment of plant species that have repeatedly adapted to patches of soil with high concentrations of heavy metals (e.g. serpentine outcrops and mine tailings) [<bold>?</bold><xref ref-type="bibr" rid="c61">Turner et al., 2010</xref>, <xref ref-type="bibr" rid="c41">Macnair, 1991</xref>, <xref ref-type="bibr" rid="c56">Schat et al., 1996</xref>]; the alleles conferring heavy metal tolerance are thought to be locally restricted because they incur a cost off of these patches. Similarly, across the American Southwest, a variety of species of animals have developed locally adaptive cryptic coloration to particular substrates, e.g. dark rock outcrops or white sand dunes [<xref ref-type="bibr" rid="c7">Benson, 1933</xref>]. One of the best-known examples is the rock pocket mouse (<italic>Chaetodipus intermedius</italic>), which is on a number of black lava flows has much darker pelage than on intervening, much lighter soil [<xref ref-type="bibr" rid="c16">Dice and Blossom, 1937</xref>]. Strong predator-mediated selection appears to favour such crypsis [<xref ref-type="bibr" rid="c35">Kaufman, 1974</xref>], and, perhaps as a result of this strong selection against migrants, at least two distinct genetic changes are responsible for the dark pigmentation found on different outcrops [<xref ref-type="bibr" rid="c30">Hoekstra and Nachman, 2003</xref>]. Similar situations have been demonstrated in other small rodent systems [<xref ref-type="bibr" rid="c59">Steiner et al., 2009</xref>, <xref ref-type="bibr" rid="c36">Kingsley et al., 2009</xref>, <xref ref-type="bibr" rid="c15">Dice, 1940</xref>] and in lizards [<xref ref-type="bibr" rid="c55">Rosenblum et al., 2010</xref>].</p>
<p>In this paper, we study this situation, namely, when a set of alleles provide an adaptive benefit in geographically localized patches, separated by (inhabited) regions where the alleles are deleterious. The main questions are: Under what conditions is it likely that each patch adapts in parallel, through new mutation, and when is it likely that migration carries these alleles between patches? How easy will it be to detect adaptive alleles that are shared by migration, i.e. over what genomic scale will a population genetic signal be visible?</p>
<p>We work in a model of continuous geography, using a variety of known results and new methods. In <xref rid="s2b" ref-type="sec">section 2.2</xref> we develop a simple approximation, equation (<xref rid="eqn2" ref-type="disp-formula">2</xref>), for the rate at which patches become established by new mutations. The most important conceptual work of the paper occurs in <xref rid="s2d" ref-type="sec">section 2.4</xref>, where we develop an understanding of the process by which alleles move from an existing patch to colonize a novel patch, culminating in equation (<xref rid="eqn12" ref-type="disp-formula">12</xref>) for the rate at which this happens. We combine these two results in <xref rid="s2e" ref-type="sec">section 2.5</xref> to discuss to the probability of parallel adaptation, equation (<xref rid="eqn14" ref-type="disp-formula">14</xref>). To understand the genomic signal left by adaptations shared by migration in <xref rid="s2f" ref-type="sec">section 2.6</xref> we approximate the time it will take for an allele to transit between patches, equation (<xref rid="eqn19" ref-type="disp-formula">19</xref>), and use this to approximate the length of haplotype that hitchhikes with it, equation (<xref rid="eqn21" ref-type="disp-formula">21</xref>). We then quantify how quickly this haplotype decays within patches equation (<xref rid="eqn24" ref-type="disp-formula">24</xref>) and use this to obtain properties about the equilibrium distribution of haplotype lengths, equation (<xref rid="eqn25" ref-type="disp-formula">25</xref>) in <xref rid="s2g" ref-type="sec">section 2.7</xref>. Finally, in <xref rid="s2h" ref-type="sec">section 2.8</xref> we apply this work to understand the geographic scale of convergent evolution in <italic>Chaetodipus intermedius</italic>.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Methods</title>
<sec id="s2a">
<label>2.1</label><title>Model of a patchy landscape</title>
<p>Consider a population spread across a landscape, within which are patches of habitat to which individuals are (initially) poorly adapted, surrounded by large areas to which the population is well adapted. (When we refer to &#x201C;patches&#x201D; it is to these pieces of poor habitat.) Suppose it takes only a single mutational change to create an allele (<italic>B</italic>) that adapts an individual to the poor habitat type. The required change could be as specific as a single base change, or as general as a knockout of a gene or one of a set of genes. We assume that this mutational change occurs at a (low) rate of <italic>&#x00B5;</italic> per chromosome per generation, and that this initially rare new allele has fitness 1 &#x002B; <italic>s<sub>p</sub></italic> relative to the unmutated type (<italic>b</italic>) in these &#x201C;poor&#x201D; habitat patches. Outside of these patches we assume that the new allele has a relative fitness 1 <italic>&#x2212; s<sub>m</sub></italic> when rare in the intervening areas, with <italic>s<sub>p</sub></italic> and <italic>s<sub>m</sub></italic> both positive. (Here we take &#x201C;fitness&#x201D; to be the intrinsic growth rate of the type when rare.) To simplify matters, we assume that the disadvantage <italic>s<sub>m</sub></italic> is sufficiently large that, on the relevant timescale, the allele is very unlikely to fix locally in the regions where it is at a disadvantage. (The case where <italic>s<sub>m</sub></italic> &#x003D; 0 requires a different approach, which we do not treat here.)</p>
<p>We are interested in the establishment of mutations in the &#x201C;poor&#x201D; patches by either migration or mutation, and so are mainly interested in whether the allele can escape initial loss by drift when rare. Therefore, we do not have to specify the fitness of the homozygote; only that the dynamics of the allele when rare are determined by the fitness of the heterozygote. More general dominance will only make small corrections to the dynamics until initial fixation, with the exception of the recessive case, which we omit. In other words, we follow the literature in treating the diploid model as essentially haploid.</p>
<p>Also, to avoid introducing more parameters, we assume population density <italic>&#x03C1;</italic> is equal across the range (even in the &#x201C;poor&#x201D; patches). If this is not the case, in most equations below, the population density that should be used is the density on the poor patches; see <xref ref-type="bibr" rid="c38">Lenormand [2002]</xref> for a more thorough approach. We further assume that the variance in offspring number is <italic>&#x03BE;</italic><sup>2</sup>, and that the mean squared distance between parent and child is <italic>&#x03C3;</italic><sup>2</sup> (i.e. <italic>&#x03C3;</italic> is the dispersal distance).</p>
<sec id="s2a1">
<title>Past work on spatial models</title>
<p>We will make use of several previous results from the literature on migration in spatially varying selection models. <xref ref-type="bibr" rid="c25">Haldane [1948]</xref>, <xref ref-type="bibr" rid="c21">Fisher [1950]</xref>, and later <xref ref-type="bibr" rid="c58">Slatkin [1973]</xref> first analyzed deterministic models of of this sort. <xref ref-type="bibr" rid="c46">Nagylaki [1975]</xref> and <xref ref-type="bibr" rid="c13">Conley [1975]</xref> showed that in one dimension, if the physical width of the patch is less than <inline-formula><alternatives><inline-graphic xlink:href="006940_inline1.gif"/></alternatives></inline-formula> then there is no stable equilibrium with both <italic>b</italic> and <italic>B</italic> present, so that migrational swamping prevents <italic>B</italic> from establishing [see also <xref ref-type="bibr" rid="c38">Lenormand, 2002</xref>, for a review]. <xref ref-type="bibr" rid="c4">Barton [1987]</xref>, using general theory of <xref ref-type="bibr" rid="c52">Pollak [1966]</xref>, showed that patches must be at least this critical size so that a new mutation has positive probability of establishment (in the large population density limit). The same paper also showed that this probability of establishment of a new mutation decays exponentially with distance from the patch, with the scale given <inline-formula><alternatives><inline-graphic xlink:href="006940_inline2.gif"/></alternatives></inline-formula> Mutations appearing within the patch have probability of establishment strictly less than the probability for a panmictic population, but approaching this as the size of the patch increases. This latter panmictic probability of establishment we denote <italic>p<sub>e</sub></italic>, and often approximate by 2<italic>s<sub>p</sub>/&#x03BE;</italic><sup>2</sup> [<xref ref-type="bibr" rid="c26">Haldane, 1927</xref>, <xref ref-type="bibr" rid="c20">Fisher, 1930</xref>]. This result holds quite generally for a geographically spread population that experiences a uniform selection pressure [<xref ref-type="bibr" rid="c43">Maruyama, 1970</xref>, <xref ref-type="bibr" rid="c12">Cherry and Wakeley, 2003</xref>]. More general work on the mathematically equivalent problem of density-dependent population growth has obtained much more general criteria under which a habitat configuration will support a stable polymorphic equilibrium [<xref ref-type="bibr" rid="c9">Cantrell and Cosner, 1989</xref>], and determined the habitat configuration that maximizes the probability of establishment [<xref ref-type="bibr" rid="c40">Lou and Yanagida, 2006</xref>].</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label><title>Establishment of a locally adaptive allele due to mutational influx</title>
<p>Consider first a single, isolated poor habitat patch in which no <italic>B</italic> allele has yet become established. We first compute the time scale on which a new <italic>B</italic> mutations will appear and fix in such a patch, if the rate of mutation from <italic>b</italic> to <italic>B</italic> is <italic>&#x00B5;</italic> per individual per generation. As we are interested in patches where local adaptation can occur, we will assume that our patch is larger than the cutoff for local establishment mentioned above.</p>
<p>Let <italic>p</italic>(<italic>x</italic>) be the probability that a new mutant <italic>B</italic> allele arising at location <italic>x</italic> relative to the patch fixes within the poor habitat patch. Under various assumptions, precise expressions can be found for <italic>p</italic>(<italic>x</italic>) [<xref ref-type="bibr" rid="c4">Barton, 1987</xref>], but results will be more interpretable if we proceed with a simple approximation. The total influx per generation of mutations that successfully establish is given by the integral of <italic>p</italic>(<italic>x</italic>) over the entire species range:
<disp-formula id="eqn1">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn1.gif"/></alternatives>
</disp-formula>
and hence depends in a complicated way on the patch geometry and selection coefficients, but still scales linearly with the mutational influx density <italic>&#x03C1;&#x00B5;</italic>. If we consider a patch of area <italic>A</italic>, whose width is large relative to <inline-formula><alternatives><inline-graphic xlink:href="006940_inline3.gif"/></alternatives></inline-formula> then a reasonable approximation is to ignore migration, so that <italic>p</italic>(<italic>x</italic>) &#x003D; <italic>p<sub>e</sub> &#x2248;</italic> 2<italic>s<sub>p</sub>/&#x03BE;</italic><sup>2</sup> within the patch, and <italic>p</italic>(<italic>x</italic>) &#x003D; 0 otherwise. This approximates the integrand <italic>p</italic>(<italic>x</italic>) in (1) by a step function, which will be a good approximation if the patch is large relative the scale over which <italic>p</italic>(<italic>x</italic>) goes from 0 to <italic>p<sub>e</sub></italic>, or if <italic>p</italic>(<italic>x</italic>) is symmetric about the edge of the patch. We examine this more generally via exact calculation of <italic>p</italic>(<italic>x</italic>) in Appendix A.</p>
<p>The rate at which mutations arise and colonize a patch of area <italic>A</italic> is then
<disp-formula id="eqn2">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn2.gif"/></alternatives>
</disp-formula>
i.e. the product of mutational influx in the patch (<italic>&#x03C1;A&#x00B5;</italic>) and the probability of establishment (2<italic>s<sub>p</sub>/&#x03BE;</italic><sup>2</sup>). If this rate is low, then the time (in generations) until a mutation arises that will become locally established within the patch is exponentially distributed with mean 1<italic>/&#x03BB;</italic><sub>mut</sub>. Assuming that once a mutation becomes established it quickly reaches its equilibrium frequency across the patch, the time scale on which new patches become colonized by the <italic>B</italic> allele from new mutation is therefore approximately 1<italic>/&#x03BB;</italic><sub>mut</sub>.</p>
</sec>
<sec id="s2c">
<label>2.3</label><title>Simulation methods</title>
<p>First we briefly describe the simulations used below for illustration and validation. We simulated forward-time dynamics of the number of alleles of each type in a regular grid of demes with fixed size <italic>N</italic> . Each generation, each individual independently chose to reproduce or not with a probability depending on her type and location in the grid; locally beneficial alleles were more likely to reproduce. Each then produced a random, Poisson distributed number of offspring that each independently migrated to demes no more than six steps away according to a symmetric migration kernel. Once migrants were distributed, each deme was uniformly resampled back down to <italic>N</italic> individuals. (Although we described the simulation in terms of individuals, we kept track only of total numbers in an equivalent way.)</p>
<p>The reproduction rate in simulations for type <italic>b</italic> alleles was 30&#x0025;; this was then multiplied by 1 &#x002B; <italic>s</italic> to get the probability of reproduction for type <italic>B</italic>. These <italic>s</italic> are the values reported in the figures, and do not depend on the basic rate of reproduction. However, to obtain values for <italic>s<sub>p</sub></italic> and <italic>s<sub>m</sub></italic> when comparing theory to simulation, we computed the rate of intrinsic growth, i.e. the <italic>s</italic> so that the numbers of <italic>B</italic> alleles when rare would change by <italic>e<sup>st</sup></italic> after <italic>t</italic> generations in the absence of migration. (The resulting values are close to the first notion of <italic>s</italic>, but give better agreement with theory, which uses the second definition.)</p>
<p>To sample lineages, we first simulated forwards in time the population dynamics, then sampled lineages moving back through time by, in each generation, moving each lineage to a new deme with probability proportional to the reverse migration probability weighted by the number of <italic>B</italic> alleles in that deme in the previous time step. If more than one lineage was found in a deme with <italic>n B</italic> alleles, then each lineage picked a label uniformly from 1 &#x2026; <italic>n</italic>, and those picking the same label coalesced. Since reproduction is Poisson, this correctly samples from the distribution of lineages given the population dynamics.</p>
</sec>
<sec id="s2d">
<label>2.4</label><title>Establishment of a locally adaptive allele due to migrational influx</title>
<p>Now suppose that there are two patches, each of area <italic>A</italic> and separated by distance <italic>R</italic>. If the <italic>B</italic> allele has arisen and become established in the first patch, but has not yet appeared in the second, we would like to know the time scale on which copies of <italic>B</italic> move between patches by migration (supposing that no <italic>B</italic> allele arises independently by mutation in the meantime). To determine this, we dissect the process by which an allele transits between the patches, along the way obtaining other useful information about the genealogy of <italic>B</italic> alleles.</p>
<p>Migration&#x2013;selection balance ensures that there will be some number of <italic>B</italic> alleles present in the regions where they are disadvantageous, but only very few, and rarely, far away from the patch where <italic>B</italic> is established. Denote the expected frequency of allele <italic>B</italic> at location <italic>x</italic> relative to the patch by <italic>q</italic>(<italic>x</italic>), and assume that the shape of the patch is at least roughly circular. Following <xref ref-type="bibr" rid="c25">Haldane [1948]</xref> or <xref ref-type="bibr" rid="c58">Slatkin [1973]</xref>, one can write down a differential equation to which <italic>q</italic>(<italic>x</italic>) is the solution, and show that <italic>q</italic>(<italic>x</italic>) decays exponentially for large <italic>&#x007C;x&#x007C;</italic>, with a square-root correction in two dimensions:
<disp-formula id="eqn3">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn3.gif"/></alternatives>
</disp-formula>
where <italic>d</italic> is the dimension (<italic>d</italic> &#x003D; 1 or 2), and <italic>C</italic> is a constant depending on the geographic shape of the populations and the selection coefficients. These asymptotics fit simulations quite well, as shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>. To be clear about the assumptions (especially regarding scaling) implicit here, we provide a derivation in Appendix B; as well as justification for the asymptotics in Appendix B.1. In one dimension, the equation can be solved to give <italic>q</italic>(<italic>x</italic>) in terms of Jacobi elliptic functions; see Appendix B.2. In applications we fit <italic>C</italic> to the data; to get concrete numbers from theory we take <italic>C</italic> &#x003D; 1 if necessary. From simulations, <italic>C</italic> seems to be not too far from 1 in practice (see below).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p><bold>(A)</bold> Mean occupation frequencies of individual demes (grey dots) and averaged over demes at similar distances (black circles), on a one-dimensional grid of 201 demes, and a two-dimensional grid of 101 &#x00D7; 101 demes. Superimposed in color is the decay predicted by (3), with <italic>C</italic> chosen arbitrarily to give a reasonable fit. (The disagreement at long distances is due to boundary effects near the edge of the range.) <bold>(B)</bold> Fluctuations: colored lines are snapshots of allele frequencies at evenly spaced times from a one-dimensional grid of 151 demes; the solid line shows the cumulative mean occupation frequency across all generations. For both plots, the simulation was run for 1000 generations; the focal allele is beneficial in the central 10 demes, with <italic>s<sub>p</sub></italic> &#x003D; 0.1, and deleterious elsewhere, with <italic>s<sub>m</sub></italic> &#x003D; &#x2212;0.02; demes had 1000 individuals in each; dispersal was to nearby demes with a mean dispersal distance of <italic>&#x03C3; &#x2248;</italic> 1.66 times the deme spacing.</p></caption>
<graphic xlink:href="006940_fig1.tif"/>
</fig>
<p>This expected frequency <italic>q</italic>(<italic>x</italic>) is the <italic>time-averaged</italic> occupation frequency, i.e. the total number of <italic>B</italic> alleles found across <italic>T</italic> generations near location <italic>x</italic>, per unit area, divided by <italic>T</italic> . If, for instance, <italic>q</italic>(<italic>x</italic>) &#x003D; .01 and the population density is <italic>&#x03C1;</italic> &#x003D; 10 individuals per unit area, then in a survey tract of unit area around <italic>x</italic> we expect to find one individual every 10 generations &#x2013; or, perhaps more likely, 10 individuals every 100 generations. This points to an important fact: close to the original patch, the &#x201C;equilibrium frequency&#x201D; <italic>q</italic>(<italic>x</italic>) describes well the density of the <italic>B</italic> allele at most times, but far away from the patch, the equilibrium is composed of rare excursions of families of <italic>B</italic> alleles, interspersed by long periods of absence. An example of one of these rare excursions is shown in <xref rid="fig2" ref-type="fig">Figure 2</xref>. The relevant time scale on which <italic>B</italic> alleles migrate between patches is given by the rate of appearance of such families. To compute the rate of establishment by such migration, we argue that these families (suitably defined) can be approximated by independent branching processes whose spatial motion is described by Brownian motion. Properties of these, combined with equation (<xref rid="eqn3" ref-type="disp-formula">3</xref>), will lead us eventually to the expression (12) for the rate of effective migration, an approximation that is valid if the distance <italic>R</italic> is large (at least five times <inline-formula><alternatives><inline-graphic xlink:href="006940_inline4.gif"/></alternatives></inline-formula> say).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>A segment of the temporal dynamics of the same simulation as <xref rid="fig1" ref-type="fig">Figure 1B</xref>. Space is again shown across the horizontal axis, with time on the vertical axis; demes are colored darker red the greater their allele frequency at the corresponding time. The 50&#x0025; and 5&#x0025; frequency contour lines are in grey, and the genealogy of 50 individuals in a rare long-distance excursion is traced back with black lines.</p></caption>
<graphic xlink:href="006940_fig2.tif"/>
</fig>
<p>To make the argument, we decompose the genealogy of <italic>B</italic> alleles into families in the following way. First, consider the genealogy of all <italic>B</italic> alleles that were alive at any time outside of the original patch. This is a collection of trees, each rooted at an allele living outside the patch whose parent was born inside the patch. Next, fix some intermediate distance <italic>r</italic><sub>0</sub> from the established patch, and erase from the genealogy every allele that has no ancestors living further away than <italic>r</italic><sub>0</sub> to the patch. This fragments the original set of trees into a collection of smaller trees that relate to each other all <italic>B</italic> alleles living outside of <italic>r</italic><sub>0</sub> at any time, and some living inside of <italic>r</italic><sub>0</sub>; we refer to these trees as &#x201C;families&#x201D;. If <italic>r</italic><sub>0</sub> is large enough that there are not too many families and interactions between family members are weak, then these families can be approximated by a collection of independent spatial branching processes whose members are ignored if they enter the original patch. (This can be made formal in the limit of large population density, also taking <italic>r</italic><sub>0</sub> large enough that the chance of reaching the original patch is small.) This decomposition is illustrated in <xref rid="fig3" ref-type="fig">figure 3</xref>. In terms of these families, the equilibrium frequency above is then
<disp-formula id="eqn4">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn4.gif"/></alternatives>
</disp-formula>
and the quantity we wish to compute, the effective rate of at which <italic>families of</italic> migrant <italic>B</italic> alleles establish in a new patch at displacement <italic>x</italic> from the original, is
<disp-formula id="eqn5">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn5.gif"/></alternatives>
</disp-formula>
The quantities on the right-hand side depend implicitly on <italic>r</italic><sub>0</sub>. All terms except the &#x201C;outflux of families&#x201D; are calculations with spatial branching processes; and we can solve for this outflux using the established form for <italic>q</italic>(<italic>r</italic>) in (4). Note that <italic>&#x03BB;</italic><sub>mig</sub> reflects the mean number of establishing migrant families per unit time, rather than individuals &#x2013; a naive calculation using <italic>q</italic>(<italic>x</italic>) that assumes migrants are independent would overestimate the effective migration rate.</p>
<sec id="s2d1">
<label>2.4.1</label><title>The genealogy of migrant families</title>
<p>To understand the process of adaptation by migration, we therefore need to look more closely at the rare families of <italic>B</italic> alleles far from the patch where it is established. Consider one such family, that lives far from the original patch. As noted above, we will model this by assuming that each individual migrates, then reproduces, independently of all other family members. The mean squared migration distance is <italic>&#x03C3;</italic><sup>2</sup>, takes the migrant in a random direction, and if migration takes the individual into a patch where the <italic>B</italic> allele is favored, we drop the individual from our family. Since the <italic>B</italic> allele is uniformly deleterious elsewhere, we can decouple reproduction and migration by first forming a tree in which each individual has a random number of offspring then recursively assigning spatial locations to each individual in the tree, and finally pruning any branches that happen to wander into a patch. By our definition of fitness, the mean number of offspring per individual is exp(&#x2212;<italic>s<sub>m</sub></italic>) <italic>&#x2248;</italic> 1 &#x2212; <italic>s<sub>m</sub></italic>, and the variance is <italic>&#x03BE;</italic><sup>2</sup>. This pruning removes both branches leading back into the already established patch (which are irrelevant) and branches leading into the new patch (we will need to count these). Since we are concerned with the rare migrant families that transit quickly between patches, back migrants to the already established patch will contribute little, since they are going the wrong direction; so to simplify the analysis we ignore this detail.</p>
<p>Since each individual has on average <inline-formula><alternatives><inline-graphic xlink:href="006940_inline5.gif"/></alternatives></inline-formula> offspring, the expected family size after time <italic>t</italic> is <inline-formula><alternatives><inline-graphic xlink:href="006940_inline6.gif"/></alternatives></inline-formula> Therefore, if we define <italic>k<sub>e</sub></italic>(<italic>t</italic>) to be the chance that the family has gone extinct by time <italic>t</italic>, and let <italic>K<sub>t</sub></italic> be the (random) family size conditioned on nonextinction, then by Bayes&#x2019; rule, <inline-formula><alternatives><inline-graphic xlink:href="006940_inline7.gif"/></alternatives></inline-formula> It turns out that if the distribution of offspring numbers is not too heavy-tailed [see <xref ref-type="bibr" rid="c34">Jagers, 1975</xref>, for details], then <italic>K<sub>t</sub></italic> has a limiting distribution: <inline-formula><alternatives><inline-graphic xlink:href="006940_inline8.gif"/></alternatives></inline-formula> In other words, the chance of survival to time <italic>t</italic> is a constant multiplied by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline80.gif"/></alternatives></inline-formula> and conditional on survival, the family size is given by a fixed distribution.</p>
<p>This suggests that families can be well-described by motion of a central &#x201C;trunk&#x201D;, which dies at a random time whose distribution is given by <italic>k<sub>e</sub></italic>(<italic>t</italic>), and conditional on survival of this trunk, the family is composed of side &#x201C;branches&#x201D; off of this trunk, as depicted in <xref rid="fig3" ref-type="fig">Figure 3</xref>. We can understand this quite concretely, by a method described rigorously by <xref ref-type="bibr" rid="c23">Geiger [1999]</xref> [see also <xref ref-type="bibr" rid="c11">Chauvin et al., 1991</xref>]. When we condition on survival until <italic>t</italic>, we condition on existence of at least one &#x201C;trunk&#x201D; lineage surviving from time 0 to time <italic>t</italic> (the long red lineage in <xref rid="fig3" ref-type="fig">Figure 3</xref>). Given this lineage, nothing distinguishes any of the other reproduction events &#x2013; each individual along the trunk lineage must give birth to at least one offspring, and all other reproduction events are unconditioned. In other words, the genealogy of a family that survives until <italic>t</italic> can be decomposed into a &#x201C;trunk&#x201D; that lasts until <italic>t</italic> which sprouts independent &#x201C;branches&#x201D; that may or may not survive until <italic>t</italic>. Concretely, if we write <italic>Z<sub>t</sub></italic> for the number of offspring in the branching process alive at time <italic>t</italic>, then this gives the following decomposition:
<disp-formula id="eqn6">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn6.gif"/></alternatives>
</disp-formula>
where each <italic>Z</italic><sup>(</sup><italic><sup>s,k</sup></italic><sup>)</sup> is an independent copy of <italic>Z</italic> that arose from the main branch in generation <italic>s</italic>, and each <italic>W<sub>s</sub></italic> is an independent copy of the offspring distribution, conditioned on <italic>W<sub>s</sub> &#x2265;</italic> 1.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Cartoon of the decomposition described in the text. Migrants families that get further than <italic>r</italic><sub>0</sub> from the already-established patch (grey circle) are each composed of a &#x201C;trunk&#x201D; lineage (in red), whose spatial motion we follow, embellished by transient branches. For the depicted long-lived family, these are further distinguished by those still alive at time <italic>t</italic> (in black) and those that did not survive until <italic>t</italic> (in grey). <xref rid="fig2" ref-type="fig">Figure 2</xref> has a depiction of such a family, from a simulation. Note that the spatial motions of lineages are independent random walks (and hence should be much wigglier than in this cartoon, which confounds space and time).</p></caption>
<graphic xlink:href="006940_fig3.tif"/>
</fig>
<p>This suggests that we add in the spatial motion by following only the motion of the &#x201C;trunk&#x201D; (i.e. the red line in <xref rid="fig3" ref-type="fig">figure 3</xref>), whose motion is is approximately Brownian, with variance <italic>&#x03C3;</italic><sup>2</sup> per generation. (Recall <italic>&#x03C3;</italic> is the dispersal distance.) We can use these two ingredients, Brownian motion and a branching process, to compute the terms of equations (<xref rid="eqn4" ref-type="disp-formula">4</xref>) and (<xref rid="eqn5" ref-type="disp-formula">5</xref>).</p>
</sec>
<sec id="s2d2">
<title>The outflux of migrant alleles</title>
<p>We are approximating the dynamics of the focal allele in the region further away than <italic>r</italic><sub>0</sub> from the patch as the sum of independent migrant families, each of whose dynamics are given by a spatial branching process (as depicted in <xref rid="fig3" ref-type="fig">Figure 3</xref>). Call <italic>B</italic>(<italic>r</italic><sub>0</sub>) the region closer than <italic>r</italic><sub>0</sub> to the patch, and <italic>&#x2202;B</italic>(<italic>r</italic><sub>0</sub>) its boundary. Suppose that there is a constant outflux of migrant families from each point <italic>x</italic> &#x2208; <italic>&#x2202;B</italic>(<italic>r</italic><sub>0</sub>), such that the long-term proportion of individuals near a point <italic>x</italic> in <italic>&#x2202;B</italic>(<italic>r</italic><sub>0</sub>) that initiate new migrant families is <italic>&#x03B3;</italic>(<italic>x</italic>). To make expressions (4) and (5) more concrete, we need to replace &#x201C;outflux of families&#x201D; by a sum over points at distance <italic>r</italic><sub>0</sub> from the patch of the outflux <italic>&#x03B3;</italic> at that point, multiplied by the relevant second quantity. By examining the constituent terms, it will turn out that equation (<xref rid="eqn5" ref-type="disp-formula">5</xref>) is well-approximated by a constant multiple of (4).</p>
<p>First consider equation (<xref rid="eqn4" ref-type="disp-formula">4</xref>) for the equilibrium frequency. Suppose that <italic>Z</italic> is one such spatial branching process as above, started at time 0 with a single individual at <italic>x</italic>, and denote by <italic>Z<sub>t</sub></italic>(<italic>A</italic>) is the number of descendant individuals alive at time <italic>t</italic> living in the spatial region <italic>A</italic>. The <italic>mean occupation density</italic> of <italic>Z</italic> can be thought of as the expected total number of offspring of a family beginning at <italic>x</italic> that ever live at <italic>y</italic> Concretely, it is the density of <inline-formula><alternatives><inline-graphic xlink:href="006940_inline9.gif"/></alternatives></inline-formula> i.e. the smooth function <italic>u</italic>(<italic>x, y</italic>) that, integrated over a set <italic>S</italic>, gives the expected total number of individuals ever living in <italic>S</italic>:
<disp-formula id="eqn7">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn7.gif"/></alternatives>
</disp-formula></p>
<p>Since reproduction and spatial motion are independent, <italic>u</italic>(<italic>x, y</italic>) is the sum across all generations of the expected number of individuals alive in that generation, multiplied by the probability density that spatial motion takes a lineage from <italic>x</italic> to <italic>y</italic>, i.e.
<disp-formula id="eqn8">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn8.gif"/></alternatives>
</disp-formula>
The equilibrium frequency as decomposed in expression (4) is the sum of mean occupation densities of a constant outflux of branching processes from <italic>&#x2202;B</italic>(<italic>r</italic><sub>0</sub>):
<disp-formula id="eqn9">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn9.gif"/></alternatives>
</disp-formula>
This form we can now compare to the expression (5) for the outflux of successful migrants. Consider the probability that a migrant family beginning with a single individual at <italic>x</italic> will ever establish in the new patch, which we assume is circular, has relatively small area <italic>A</italic> and is centered at position <italic>y</italic>. It would be possible to analyze directly the probability that a given migrant family establishes in the patch, as in <xref ref-type="bibr" rid="c4">Barton [1987]</xref>; but we make a simpler approximation, approximating this probability by the chance that the &#x201C;trunk&#x201D; hits the new patch, multiplied by the chance that at least one member of the family escapes demographic stochasticity, successfully establishing in the new patch. Write <italic>h<sub>A</sub></italic>(<italic>x, y</italic>) for the probability that the Brownian trunk hits the new patch centered at <italic>y</italic> before the family dies out, and <italic>f</italic> (<italic>A</italic>) for the chance that the family manages to establish in the new patch, given that it successfully arrives. As for <italic>q</italic>(<italic>y</italic>) above, expression (5) is properly an integral against the outflux <italic>&#x03B3;</italic>(<italic>x</italic>):
<disp-formula id="eqn10">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn10.gif"/></alternatives>
</disp-formula></p>
<p>Intuitively, <italic>h<sub>A</sub></italic>(<italic>x, y</italic>) counts each family once if it hits the patch, while the occupation density <italic>u</italic>(<italic>x, y</italic>) counts the total amount of time that the family spends in the patch. Since the expected total time spent in the patch does not depend on the distance at which the family started if we know that it survived to hit the patch, it is intuitively reasonable that <italic>u</italic>(<italic>x, y</italic>) and <italic>h<sub>A</sub></italic>(<italic>x, y</italic>) are simply related. Following this intuition, and that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline10.gif"/></alternatives></inline-formula> it turns out (see Appendix C) that
<disp-formula id="eqn11">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn11.gif"/></alternatives>
</disp-formula>
where <italic>g</italic>(<italic>A</italic>) is the total expected occupation time of the patch given the family arrives, and recall that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline11.gif"/></alternatives></inline-formula> is the expected family size after a large number of generations, given survival. Since the integrands in expressions 9 and 10 only differ by a factor that (at least asymptotically) does not depend on the distance between <italic>x</italic> and <italic>y</italic>, we can obtain the migration rate by multiplying the equilibrium frequency by this factor. The probability <italic>f</italic> (<italic>A</italic>) that the family does not die out once it arrives at the new patch is approximately <inline-formula><alternatives><inline-graphic xlink:href="006940_inline12.gif"/></alternatives></inline-formula> if each member arriving has chance <italic>p<sub>e</sub></italic> of establishing, independently. Combining with expressions for <italic>g</italic>(<italic>A</italic>) in Appendix C, we obtain that
<disp-formula id="eqn12">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn12.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn13">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn13.gif"/></alternatives>
</disp-formula></p>
<p>This does not depend on <italic>A</italic>, because although <italic>f</italic> (<italic>A</italic>) and <italic>g</italic>(<italic>A</italic>) in principle depend on the patch size (and geometry), the dependence is very weak: for instance, the width of a circular patch only very weakly affects the chance of establishment of a new migrant that appears on its edge, as long as the patch is large enough. For more discussion, including an expression for the outflux of migrants <italic>&#x03B3;</italic>(<italic>x</italic>), see Appendix C.</p>
</sec>
</sec>
<sec id="s2e">
<label>2.5</label><title>The probability of parallel adaptation between patches</title>
<p>We now turn to the question of whether the separated patches adapt by parallel genetic changes or by the spread of a migrant allele between the patches (or both, or neither). As only a single mutation is required for individuals to adapt to the poor habitat patch, subsequent mutations that arise after an allele becomes established in the patch gain no selective benefit. Similarly, an allele introduced into a patch by migration will not be favored by selection to spread, if the patch has already been colonized. Therefore, mutations selectively exclude each other from patches, over short time scales, and will only slowly mix together over longer time scales by drift and migration, an assumption we also made in [<xref ref-type="bibr" rid="c53">Ralph and Coop, 2010</xref>]. In reality, different mutations will likely not be truly selectively equivalent, in which case this mixing occurs over a time-scale dictated by the difference in selection coefficients.</p>
<p>We will assume that once a <italic>B</italic> allele is introduced (by migration or mutation) and successfully begins to establish, it becomes established in the poor habitat patch rapidly. Under this approximation, and the &#x201C;selective exclusion&#x201D; just discussed, after one of the patches becomes colonized by a single <italic>B</italic> allele, the other patch will become colonized by migration or mutation, but not by both. As such, the question of how the second patch adapts simply comes down to whether a new mutation or a migrant allele is the first to become established in the second patch. To work out how adaptation is likely to proceed, we can compare expressions (2) and (12) above for the effective rates of adaptation by new mutation and by migration. We work in one dimension, as the square root term appearing for two dimensions is relatively unimportant (see <xref rid="fig1" ref-type="fig">figure 1</xref>).</p>
<p>The first thing to notice is that effective migration and mutation rates will be on the same order if <inline-formula><alternatives><inline-graphic xlink:href="006940_inline13.gif"/></alternatives></inline-formula> where recall that <italic>R</italic> is the distance between the patches, and <italic>A</italic> is the area of the not-yet-adapted patch. In other words, the migrational analogue of &#x201C;mutational influx&#x201D; (<italic>&#x00B5;&#x03C1;A</italic>) is <inline-formula><alternatives><inline-graphic xlink:href="006940_inline14.gif"/></alternatives></inline-formula>, which depends fairly strongly on the selective disadvantage <italic>s<sub>m</sub></italic> between patches. Equivalently, the rates are roughly equal if <inline-formula><alternatives><inline-graphic xlink:href="006940_inline15.gif"/></alternatives></inline-formula>, which gives the critical gap size past which adaptation will be mostly parallel in terms of selection coefficients, patch size, and mutation rate.</p>
<p>If we take the mutational influx in a patch to be one per 1,000 generations (<italic>&#x03C1;A&#x00B5;</italic> &#x003D; .001) and the population density to be 1 (<italic>&#x03C1;</italic> &#x003D; 1, so log(<italic>A&#x00B5;</italic>) &#x2248; 7) then adaptation is mostly parallel for patches separated by gaps larger than <inline-formula><alternatives><inline-graphic xlink:href="006940_inline16.gif"/></alternatives></inline-formula> If the selective pressure is fairly strong (say, <italic>s<sub>m</sub></italic> &#x003D; .05), then for migration to be slower than mutation, the distance between patches must be at least 30 times the dispersal distance (i.e. <italic>R/&#x03C3; &#x003E;</italic> 30) for convergence to occur. If <italic>s<sub>m</sub></italic> is much smaller, say <italic>s<sub>m</sub></italic> &#x003D; .001, then the patches must be separated by several hundred times the dispersal distance (i.e. <italic>R/&#x03C3; &#x003E;</italic> 300). The situation does not change much if the influx is quite a bit higher &#x2013; even if <italic>A&#x00B5;</italic> &#x003D; 1 (so log(<italic>A&#x00B5;</italic>) <italic>&#x2248;</italic> 2.3), the required separation between patches is only reduced to <italic>R/&#x03C3; &#x003E;</italic> 10 with <italic>s<sub>m</sub></italic> &#x003D; .05 and <italic>R/&#x03C3; &#x003E;</italic> 150 for <italic>s<sub>m</sub></italic> &#x003D; .001. On the other hand, if the separation is much smaller than this transitional value, then adaptations are likely to be shared between patches.</p>
<p>One way to visualize this is by a phase diagram. In <xref rid="fig4" ref-type="fig">figure 4</xref>, we give a contour plot for the time until adaptation by migration (<italic>T</italic><sub>mig</sub> &#x003D; 1<italic>/&#x03BB;</italic><sub>mig</sub>) and by new mutation (<italic>T</italic><sub>mut</sub> &#x003D; 1<italic>/&#x03BB;</italic><sub>mut</sub>) as a function of various parameters. This gives us an idea of not only the parameter space where parallel adaptation is likely (<italic>T</italic><sub>mig</sub> &#x226A; <italic>T</italic><sub>mut</sub>), but also where adaptation by any means takes a very long time (<italic>T</italic><sub>mig</sub> and <italic>T</italic><sub>mut</sub> both very large), an important check in applications of these results.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Shaded contour plots of mean time until adaptation in a new patch occurs by migration (<italic>T</italic><sub>mig</sub>, blue) or by mutation (<italic>T</italic><sub>mut</sub>, red), as a function of population density (<italic>&#x03C1;</italic>), distance to an already adapted patch in units of dispersal distance (<italic>R/&#x03C3;</italic>), strength of deleterious selection (<italic>s<sub>m</sub></italic>), and mutation rate scaled by patch area (<italic>&#x00B5;A</italic>). The black, dotted line shows values where <italic>T</italic><sub>mig</sub> &#x003D; <italic>T</italic><sub>mut</sub>. Default parameter values were <italic>A</italic> &#x003D; 100, <italic>&#x03C1;</italic> &#x003D; 10, <italic>&#x00B5;</italic> &#x003D; 10<sup>&#x2212;8</sup>, <italic>s<sub>p</sub></italic> &#x003D; 0.1, <italic>s<sub>m</sub></italic> &#x003D; 0.01, <italic>R/&#x03C3;</italic> &#x003D; 50, and <italic>&#x03BE;</italic><sup>2</sup> &#x003D; 1. Note that population density <italic>&#x03C1;</italic> and mutation influx <italic>A&#x00B5;</italic> are shown on a log scale.</p></caption>
<graphic xlink:href="006940_fig4.tif"/>
</fig>
<p>Taking these approximations at face value, and assuming both rates are small, the time until the first of the two patches is colonized by the <italic>B</italic> allele will be approximately exponentially distributed with mean 1/(2<italic>&#x03BB;</italic><sub>mut</sub>). Following this, the time until the second patch is subsequently colonized (via either migration or new mutation) will be exponentially distributed with mean 1/(<italic>&#x03BB;</italic><sub>mut</sub> &#x002B; <italic>&#x03BB;</italic><sub>mig</sub>). Both these rates scale linearly with population density (<italic>&#x03C1;</italic>) and the probability of establishment of a rare allele (<italic>p<sub>e</sub></italic> &#x2248; 2<italic>s<sub>b</sub>/&#x03BE;</italic><sup>2</sup>), so that the overall time to adaptation is robustly predicted to increase with offspring variance (<italic>&#x03BE;</italic><sup>2</sup>) and decrease with population density and beneficial selection coefficient. Furthermore, the probability that the second adaptation is a new mutation, i.e. the probability of parallel adaptation, is
<disp-formula id="eqn14">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn14.gif"/></alternatives>
</disp-formula>
so that the probability of parallel mutation should increase approximately logistically with the distance between the patches, at rate <inline-formula><alternatives><inline-graphic xlink:href="006940_inline17.gif"/></alternatives></inline-formula></p>
<sec id="s2e1">
<label>2.5.1</label><title>Multiple patches</title>
<p>Above we worked with two patches separated by distance <italic>R</italic>; but these calculations apply as well to multiple patches in which the <italic>B</italic> allele can facilitate local adaptation. Under our assumptions of mutational exclusion and rapid establishment, each patch will adapt through establishment of a single copy of the <italic>B</italic> allele, either by migration or mutation. If we imagine that the times between successive establishments are the result of many nearly-independent attempts with small probability of success, the process of occupation is well approximated by a Markov chain, whose state records the labeling of patches according to the colonizing allele (or none, for those that haven&#x0027;t yet adapted).</p>
<p>If not yet adapted, a patch of area <italic>A</italic> will acquire the adaptation by new mutation at rate 2<italic>s<sub>p</sub>&#x00B5;&#x03C1;A/&#x03BE;</italic><sup>2</sup> (equation (<xref rid="eqn2" ref-type="disp-formula">2</xref>)). Suppose that patches 1<italic>, &#x2026;, k</italic> are already adapted, and that these patches are at distances <italic>r</italic><sub>1</sub><italic>, &#x2026;, r<sub>k</sub></italic> away from this unadapted patch. The total rate of adaptation through migration, from equation (<xref rid="eqn12" ref-type="disp-formula">12</xref>), is
<disp-formula id="eqn15">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn15.gif"/></alternatives>
</disp-formula>
and if the patch adapts through migration, the probability the adapted allele comes from patch <italic>i</italic> is
<disp-formula id="eqn16">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn16.gif"/></alternatives>
</disp-formula></p>
<p>These specify the transition rates of the process.</p>
<p>Since the compound parameter <italic>s<sub>p</sub>&#x03C1;/&#x03BE;</italic><sup>2</sup> is common to both rates, it functions only as a time scaling of the process, and therefore has no effect on the final configuration, namely, the sets of patches sharing the genetic basis of their adaptive response.</p>
<p>Also note that we can rescale time by the typical patch size, and introduce a parameter, say <italic>a<sub>k</sub></italic> &#x003D; <italic>A<sub>k</sub>/&#x0100;</italic>, making the properties (other that the time scaling) of the discrete model independent of the <italic>numerical sizes</italic> of the demes themselves. This is complementary to the results of <xref ref-type="bibr" rid="c49">Pennings and Hermisson [2006]</xref>, who showed that multiple mutations are likely to arise <italic>within</italic> a panmictic deme if the population-scaled mutation rate 2<italic>N &#x00B5;</italic> is greater than 1.</p>
<p>The resulting discrete process is quite general, but if we oversimplify back to the island model, it is tractable: suppose the probability of adaptation by mutation is the same for each patch and by distance is the same for each pair of patches. The resulting process is a continuous-time version of the &#x201C;Chinese restaurant process&#x201D; described in <xref ref-type="bibr" rid="c1">Aldous [1985]</xref> and <xref ref-type="bibr" rid="c51">Pitman [1995]</xref>, and so the final partition of types across demes has the Ewens sampling distribution with parameter <inline-formula><alternatives><inline-graphic xlink:href="006940_inline18.gif"/></alternatives></inline-formula> Now we can compute most properties we might want about the process. For instance, the proportion of demes that shares the same origin as a randomly sampled deme is approximately Beta distributed &#x2013; see <xref ref-type="bibr" rid="c17">Donnelly and Joyce [1989]</xref>. The high connectedness of the discrete deme island model means that the expected number of distinct alleles grows with the log of the number of demes, which strongly contrasts with the continuous spatial model where the local nature of dispersal means that doubling the species range will double the number of mutations expected.</p>
</sec>
</sec>
<sec id="s2f">
<label>2.6</label><title>Length of the hitchhiking haplotype</title>
<p>If a patch adapts through new mutation or a rare migrant lineage, the genomic region surrounding the selected site will hitchhike along with it [<xref ref-type="bibr" rid="c44">Maynard Smith and Haigh, 1974</xref>], so that at least initially, all adapted individuals within a patch share a fairly long stretch of haplotype. Pairs of individuals within a patch will share a haplotype of mean genetic length of about log(<italic>&#x03C1;As<sub>p</sub></italic>)<italic>/s<sub>p</sub></italic> around the selected site, as long as the patch is reasonably well mixed by dispersal [otherwise see <xref ref-type="bibr" rid="c5">Barton et al., 2013</xref>]. This association gets slowly whittled down by recombination during interbreeding at the edge of the patch; but there will always be longer LD nearby to the selected site.</p>
<p>When an already adapted patch colonizes another through migration, the newly colonized patch will inherit a long piece of haplotype around the selected site from the originating patch. The genetic length of this haplotype is roughly inversely proportional to the number of generations the allele spends &#x201C;in transit&#x201D;, because each reproductive event in locations where the allele is at low frequency will likely recombine haplotypes of the <italic>b</italic> allele closer to the adaptive allele. In this case, the haplotype is literally hitchhiking across geography! <xref rid="fig5" ref-type="fig">Figure 5</xref> shows a simulation of such an event, including the lineage that founds an adaptive population on a second patch, and the length of the haplotype shared between this lineage and one in the original patch. The entire time that the lineage is outside the region where the <italic>B</italic> allele is common (dark red in <xref rid="fig5" ref-type="fig">Figure 5</xref>), the haplotype that accompanies it is broken down rapidly. After the lineage establishes on the patch, the rate of decay of the haplotype is slowed significantly, since most others with which it recombines have similar haplotypic backgrounds. We first discuss the transit of the lineage, and its accompanying haplotype, and return to how haplotypes are whittled down within established patches in the next section.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Adaptation by migration:</title>
<p>An initially unadapted patch (10 demes at the left end of the range) is colonized around generation 5000; a representative lineage is shown in the new patch, which follows the original migrant &#x201C;trunk&#x201D; lineage between the patches and coalesces with a lineage in the unadapted patch. In the left panel, as in <xref rid="fig2" ref-type="fig">Figure 2</xref>, color and contours show allele frequency across space and time; other simulation parameters are as in <xref rid="fig1" ref-type="fig">Figures 1B</xref> and <xref rid="fig2" ref-type="fig">2</xref>. The right panel shows (in red) the extent of the shared haplotype between the two lineages around the selected locus (at position 0), which decreases as time progresses.</p></caption>
<graphic xlink:href="006940_fig5.tif"/>
</fig>
<p>Above we argued that a good model for this transit is a single Brownian trunk lineage surrounded by a cloud of close relatives of random size <italic>K</italic> whose chance of surviving until <italic>t</italic> generations is 1 <italic>&#x2212; k<sub>e</sub></italic>(<italic>t</italic>). Consider a single such family, and let <italic>&#x03C4;</italic> be the (random) time at which it first hits the new patch, with <italic>&#x03C4;</italic> &#x003D; <italic>&#x221E;</italic> if it never does. We assume that the length of the hitchhiking segment depends only on the time spent by the trunk lineage of the first successful migrant &#x201C;in transit&#x201D; between the patches, i.e. <italic>&#x03C4;</italic> conditioned on <italic>&#x03C4; &#x003C; &#x221E;</italic>. In so doing, we neglect recombination between <italic>B</italic> alleles (since they are at low density in transit, we assume this is rare), and the possibility that more than one successful migrant family is in transit at once (so that faster migrants would be more likely to have arrived first); but these factors should be minor if the rest of our framework fits.</p>
<p>Our first obstacle is that we do not know 1 <italic>&#x2212; k<sub>e</sub></italic>(<italic>t</italic>), the probability a family survives until <italic>t</italic>, exactly. However, we do know that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline19.gif"/></alternatives></inline-formula> that it has exponential tails. Since <inline-formula><alternatives><inline-graphic xlink:href="006940_inline20.gif"/></alternatives></inline-formula> it is sensible to make one further approximation, replacing this random time by an exponential with rate <italic>s<sub>m</sub></italic>. Once we do this, we can use standard results on hitting times of <italic>d</italic>-dimensional Brownian motion that is killed at rate <italic>s<sub>m</sub></italic> &#x2013; Borodin and Salminen [see 2002, (2.2.0.1 and 4.2.0.1)]. In particular, if the patch is circular with radius <italic>w</italic> and lies at distance <italic>R</italic> from the already adapted patch, then we know that the Laplace transform of the transit time <italic>&#x03C4;</italic> is
<disp-formula id="eqn17">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn17.gif"/></alternatives>
</disp-formula>
where <italic>K</italic><sub>0</sub> is a modified Bessel function of the second kind. We are interested in lineages that manage to reach the patch before being killed, i.e. having <italic>&#x03C4; &#x003C; &#x221E;</italic>, which occurs with probability <inline-formula><alternatives><inline-graphic xlink:href="006940_inline21.gif"/></alternatives></inline-formula><inline-formula><alternatives><inline-graphic xlink:href="006940_inline22.gif"/></alternatives></inline-formula></p>
<p>To keep the expressions simple, in the remainder of this section we only compute quantities for one dimension. By Bayes&#x2019; rule, the Laplace transform of <italic>&#x03C4;</italic> for a successful lineage is
<disp-formula id="eqn18">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn18.gif"/></alternatives>
</disp-formula>
This can be differentiated to find that the expected transit time is
<disp-formula id="eqn19">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn19.gif"/></alternatives>
</disp-formula>
and that Var<inline-formula><alternatives><inline-graphic xlink:href="006940_inline23.gif"/></alternatives></inline-formula></p>
<p>Since each generation spent in transit provides an opportunity for recombination, if recombination is Poisson, the length of the haplotype (in Morgans) initially shared between populations on each side of the selected locus is exponentially distributed with mean <italic>&#x03C4;</italic>, so that if <italic>L</italic> is the length of hitchhiking segment on, say, the right of the selected locus, then
<disp-formula id="eqn20">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn20.gif"/></alternatives>
</disp-formula>
and so (one minus) equation (<xref rid="eqn18" ref-type="disp-formula">18</xref>) in fact gives the cumulative distribution function of <italic>L</italic>. The form of this distribution function implies that if <italic>Y</italic> is an exponential random variable with rate <inline-formula><alternatives><inline-graphic xlink:href="006940_inline24.gif"/></alternatives></inline-formula> then <italic>L</italic> has the same distribution as <inline-formula><alternatives><inline-graphic xlink:href="006940_inline25.gif"/></alternatives></inline-formula> Furthermore, the expected length of shared hitchhiking haplotype is
<disp-formula id="eqn21">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn21.gif"/></alternatives>
</disp-formula>
and <inline-formula><alternatives><inline-graphic xlink:href="006940_inline26.gif"/></alternatives></inline-formula> For two dimensions, asymptotics of Bessel functions show that <italic>L</italic> has the same tail behavior; but how other properties might change is unclear.</p>
<p>As a general rule of thumb, equation (<xref rid="eqn19" ref-type="disp-formula">19</xref>) means that families who successfully establish move at speed <inline-formula><alternatives><inline-graphic xlink:href="006940_inline27.gif"/></alternatives></inline-formula> towards the new patch &#x2013; if <italic>s<sub>m</sub></italic>, the strength of the selection against them, is smaller, the need to move quickly is less imperative. Then, equation (<xref rid="eqn21" ref-type="disp-formula">21</xref>) means that the haplotype length is roughly the length one would expect given the mean transit time. Note that we have become used to seeing <italic>&#x03C3;</italic> divided by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline28.gif"/></alternatives></inline-formula> rather than multiplied; it appears here because <inline-formula><alternatives><inline-graphic xlink:href="006940_inline29.gif"/></alternatives></inline-formula> is a length scale, and to convert it to a speed this is divided by 1<italic>/s<sub>m</sub></italic>. This intuitive picture can be expanded by a central limit theorem: for large <italic>R</italic>, the deviation of <italic>&#x03C4;</italic> about its mean is asymptotically Gaussian, and the haplotype halflength <italic>L</italic> is exponential.</p>
</sec>
<sec id="s2g">
<label>2.7</label><title>Length of the shared haplotype within a patch</title>
<p>The other key issue in thinking about the population genetic signal of adaptation in spatial patches is the process by which haplotypes are whittled down within patches, which plays into a number of aspects of haplotype sharing. The initial haplotype that sweeps within a patch will be dispersed over time by recombination; likewise, the haplotype that is shared between patches coadapted by migration (<xref rid="eqn2" ref-type="disp-formula">equation 2</xref>1) will also break down. However, a long time after the initial sweep, we may still expect to find individuals within the patch sharing longer haplotypes around the selected locus than with individuals elsewhere, since selection against migrants decreases mean coalescence times within the patch near the selected locus. We first develop a simple approximation to the rate at which recombination breaks down haplotypes within patches.</p>
<p>Refer again to <xref rid="fig5" ref-type="fig">Figure 5</xref>. When a lineage is in a region with high frequency of <italic>B</italic> alleles (dark red), it is very unlikely to recombine off the <italic>B</italic> background. However, when it wanders out of the patch, into regions with lower frequency of <italic>B</italic> alleles, when it recombines it will usually be on to the background of the <italic>b</italic> allele.</p>
<p>A detailed treatment of this is well beyond the scope of this paper, but we can get a good idea of the genomic scale of these effects through heuristic arguments. To understand the probability of a recombination moving our lineage off of the B background we need to understand what fraction of the time our lineage spends in geographic regions where <italic>b</italic> is common. Consider the lineage of a single <italic>B</italic> allele, moving back through time, in a patch at migration-selection balance, i.e. with the local proportion of <italic>B</italic> alleles near <italic>x</italic> equal to <italic>p</italic>(<italic>x</italic>), and suppose that the lineage stays close enough to the patch that fluctuations about <italic>p</italic>(<italic>x</italic>) are small. (Note that this assumption differs from previous sections, but here our focus is on a typical lineage in the patch rather than the rare lineages that make it far from the patch). If we suppose that type <italic>B</italic> individuals at location <italic>y</italic> reproduce at rate 1 &#x002B; <italic>s</italic>(<italic>y</italic>), and the chance their offspring move to <italic>x</italic> is <italic>m</italic>(<italic>y, x</italic>) (with <inline-formula><alternatives><inline-graphic xlink:href="006940_inline30.gif"/></alternatives></inline-formula> then the total rate of influx of <italic>B</italic> alleles from <italic>y</italic> into <italic>x</italic> is <italic>&#x03C1;p</italic>(<italic>y</italic>)(1 &#x002B; <italic>s</italic>(<italic>y</italic>))<italic>m</italic>(<italic>y, x</italic>). As argued by <xref ref-type="bibr" rid="c33">Hudson and Kaplan [1988]</xref>, the rate at which a <italic>B</italic> lineage moves from <italic>x</italic> to <italic>y</italic> is this influx divided by the local abundance of <italic>B</italic> alleles, or <italic>p</italic>(<italic>y</italic>)(1 &#x002B; <italic>s</italic>(<italic>y</italic>))<italic>m</italic>(<italic>y, x</italic>)<italic>/p</italic>(<italic>x</italic>). After the same large-population, continuous-space limit that underlies the rest of this paper (Appendix B), if the assumption that fluctuations in <italic>p</italic>(<italic>x</italic>) are small, this motion should converge to a diffusion process [as assumed by e.g. <xref ref-type="bibr" rid="c27">Hallatschek and Nelson, 2008</xref>], notwithstanding some technical difficulties (e.g. discontinuity of <italic>s</italic>(<italic>x</italic>)). This diffusion, when at <italic>x</italic>, is pulled toward regions with more <italic>B</italic> alleles by a drift term <inline-formula><alternatives><inline-graphic xlink:href="006940_inline31.gif"/></alternatives></inline-formula> where <italic>s</italic>(<italic>x</italic>) &#x003D; <italic>s<sub>p</sub></italic> if <italic>x</italic> is in the patch and <italic>s(x)</italic> &#x003D; <italic>s<sub>m</sub></italic> otherwise, and moves at speed <inline-formula><alternatives><inline-graphic xlink:href="006940_inline32.gif"/></alternatives></inline-formula> (which is nearly constant, since <italic>s</italic>(<italic>x</italic>) is small). In It&#x00F4; differential notation, the location <italic>X<sub>t</sub></italic> of a <italic>B</italic> lineage <italic>t</italic> generations ago satisfies
<disp-formula id="eqn22">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn22.gif"/></alternatives>
</disp-formula>
where <italic>B<sub>t</sub></italic> is a standard Brownian motion. Furthermore, it is easy to verify that the stationary distribution of this process has density
<disp-formula id="eqn23">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn23.gif"/></alternatives>
</disp-formula>
A lineage at a locus at genetic distance <italic>r</italic> that begins linked to a <italic>B</italic> allele moves as a <italic>B</italic> lineage up until the most recent time it recombined from a <italic>b</italic> background to a <italic>B</italic> background, which occurs when at <italic>x</italic> with rate <italic>r</italic>(1 <italic>&#x2212; p</italic>(<italic>x</italic>))(1 &#x002B; <italic>s</italic>(<italic>x</italic>)/2). The Feynman-Kac formula could then be used to write down differential equations solved by various moments of the haplotype length as a function of the sampling location of the lineage; instead, we only use the above as a guide for rough approximation.</p>
<p>Based on this picture of the lineage bouncing around in the patch, we propose a simple heuristic to describe the probability of recombination. If recombination is on a slower time scale than mixing within the patch, then the time until the last recombination is the integral of <italic>r</italic>(1 <italic>&#x2212; p</italic>(<italic>x</italic>))(1 &#x002B; <italic>s</italic>(<italic>x</italic>)/2) against the stationary distribution (<xref rid="eqn2" ref-type="disp-formula">equation 2</xref>3). Within the patch, <italic>p</italic>(<italic>x</italic>) <italic>&#x2248;</italic> 1, so recombination off the <italic>B</italic> background is unlikely to occur, and so the rate of recombination depends to a first approximation on the proportion of the patch in which <italic>p</italic>(<italic>x</italic>) is intermediate, i.e. where both <italic>B</italic> and <italic>b</italic> are present. This region where <italic>p</italic>(<italic>x</italic>) is intermediate has width of order <inline-formula><alternatives><inline-graphic xlink:href="006940_inline33.gif"/></alternatives></inline-formula> where <italic>s</italic> &#x003D; min(<italic>s<sub>p</sub>, s<sub>m</sub></italic>). As we increase the size of a patch, the area on which <italic>p</italic>(<italic>x</italic>) is intermediate scales with the perimeter of the patch. The per generation rate of recombination of a locus linked to the <italic>b</italic> background is thus reduced by a factor roughly equal to the proportion of the patch lying within distance <inline-formula><alternatives><inline-graphic xlink:href="006940_inline34.gif"/></alternatives></inline-formula> of the boundary, so the effective recombination rate is
<disp-formula id="eqn24">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn24.gif"/></alternatives>
</disp-formula>
so that <italic>T</italic> generations after the founding of a patch we expect a haplotype of genetic length 1/(<italic>r</italic><sub>eff</sub><italic>T)</italic> Morgans to remain linked to the <italic>B</italic> allele in a typical lineage. Note that the length of haplotype decays at a rate roughly proportional to <inline-formula><alternatives><inline-graphic xlink:href="006940_inline35.gif"/></alternatives></inline-formula> as the narrower the cline the less opportunity for recombination to move our lineage off the <italic>B</italic> background.</p>
<p>Finally we can consider the expected length of haplotype shared within a patch. To do this, we compare the rate of recombination between <italic>B</italic> and <italic>b</italic> haplotypes (<xref rid="eqn24" ref-type="disp-formula">equation 24</xref>) to the rate of coalescence of <italic>B</italic> haplotypes within a patch. We will assume that mixing within the patch is fast compared to the rate of drift, so that the rate of coalescence of <italic>B</italic> alleles within a patch is <italic>&#x03BE;</italic><sup>2</sup>/(<italic>A&#x03C1;</italic>), the &#x201C;variance effective population size&#x201D; of the patch (this bypasses the well-known difficulties to spatial coalescence [<xref ref-type="bibr" rid="c19">Felsenstein, 1975</xref>, <xref ref-type="bibr" rid="c6">Barton et al., 2002</xref>]). The rate of recombination and coalescence will be on the same order if <inline-formula><alternatives><inline-graphic xlink:href="006940_inline36.gif"/></alternatives></inline-formula> and hence the genetic length of the haplotype shared between pairs of individuals within the same patches at equilibrium is on the order of
<disp-formula id="eqn25">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn25.gif"/></alternatives>
</disp-formula>
This does not depend on <italic>A</italic> in one dimension, but decreases with <inline-formula><alternatives><inline-graphic xlink:href="006940_inline37.gif"/></alternatives></inline-formula> in two dimensions. In applications, this can be compared to equation (<xref rid="eqn21" ref-type="disp-formula">21</xref>) for the length of shared haplotype between patches.</p>
</sec>
<sec id="s2h">
<label>2.8</label><title>Applications</title>
<p>Coat color in the rock pocket mouse <italic>Chaetodipus intermedius</italic> is a classic example of local adaptation [<xref ref-type="bibr" rid="c7">Benson, 1933</xref>, <xref ref-type="bibr" rid="c16">Dice and Blossom, 1937</xref>]. These mice live on rocky outcrops throughout the southwestern United States and northern Mexico, and generally have a light pelage similar to the predominant rock color. However, in some regions these mice live on darker substrates (e.g. old lava flows), and in these patches have much darker pigmentation, presumably to avoid visual predators. <xref ref-type="bibr" rid="c45">Nachman et al. [2003]</xref> demonstrated that on one of these flows (Pinacate), much of the change in coloration is due to an allele at the MC1R locus. This dark allele differs from the light allele by four amino acid changes, and has a dominant or partially dominant effect depending on the measure of coat color assessed. These areas of dark rock are separated from each other by a range of distances, with some being separated from any other by hundreds of kilometers of light colored substrate. The Pinacate allele is not present in a number of other populations of dark colored rock pocket mouse, suggesting these populations have adapted in parallel [<xref ref-type="bibr" rid="c45">Nachman et al., 2003</xref>, <xref ref-type="bibr" rid="c30">Hoekstra and Nachman, 2003</xref>]. However, <xref ref-type="bibr" rid="c32">Hoekstra et al. [2005]</xref> reasoned that, elsewhere in the range, multiple close dark outcrops may share a dark phenotype whose genetic basis has been spread by migration despite intervening light habitat. We apply our theory to this example, in particular investigating how the probability of parallel mutation depends on the distance between dark outcrops.</p>
<p>A key parameter above was the dispersal distance divided by the square root of strength of selection against the focal allele between patches, <inline-formula><alternatives><inline-graphic xlink:href="006940_inline38.gif"/></alternatives></inline-formula> <xref ref-type="bibr" rid="c31">Hoekstra et al. [2004]</xref> studied the frequency of the dark MC1R allele and coat color phenotypes, at sites across the (dark) Pinacate lava flow and at two nearby sites in light-colored rock. On the lava flow the dark MC1R allele is at 86&#x0025; frequency, while at a site with light substrate 12 km to the west (Tule), the frequency is 3&#x0025;. The dark allele was entirely absent from Christmas pass, a site with light substrate 7 km north of Tule, and 3 km further from the lava flow. In the other direction, the dark MC1R allele was at 34&#x0025; at a site with light substrate 10 km to the east of the flow (O&#x0027;Neill). These numbers give us a sense of a plausible range of characteristic lengths. Assuming the dark allele is at 50&#x0025; frequency at the edge of the lava flow, we can fit formula (3) to these frequencies [similar to <xref ref-type="bibr" rid="c31">Hoekstra et al., 2004</xref>]. Doing this for Tule we obtain <inline-formula><alternatives><inline-graphic xlink:href="006940_inline39.gif"/></alternatives></inline-formula> and for O&#x0027;Neill, <inline-formula><alternatives><inline-graphic xlink:href="006940_inline40.gif"/></alternatives></inline-formula> giving us a range of cline widths. We also need estimate of <italic>s<sub>m</sub></italic>. Using &#x03C3; &#x2248; 1 km [<xref ref-type="bibr" rid="c22">French et al., 1968</xref>, <xref ref-type="bibr" rid="c2">Allred and Beck, 1963</xref>], these cline widths imply that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline41.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="006940_inline42.gif"/></alternatives></inline-formula> are reasonable values.</p>
<p>The mutational target size <italic>&#x00B5;</italic> for the trait is unclear. While the Pinacate dark haplotype differs from the light haplotype at four amino acid residues, it is likely that not all of these changes are needed for a population to begin to adapt. Also there a number of genes besides MC1R at which adaptive changes affecting pigmentation have been identified in closely related species and more broadly across vertebrates [<xref ref-type="bibr" rid="c29">Hoekstra, 2006</xref>]. To span a range of plausible values, we use a low mutation rate of <italic>&#x00B5;</italic> &#x003D; 10<sup>&#x2212;8</sup>, where the adaptive mutation has to occur at a single base pair; and a high mutation rate <italic>&#x00B5;</italic> &#x003D; 10<sup>&#x2212;5</sup>, equivalent to the mutation being able to arise at any of a thousand base pairs. Finally, we set <italic>A</italic> &#x003D; 100km<sup>2</sup> (roughly the size of the Pinacate patch). In <xref rid="fig6" ref-type="fig">Figure 6</xref> we show the dependence of the probability of parallel mutation on the distance between lava flow patches using these parameters, showing that parallel mutation should become likely over a scale of tens to a few hundred kilometers between patches.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Top panel: The probability of parallel mutation as a function of the distance between environmental patches for two different cline widths and two different mutation rates (using equation (<xref rid="eqn14" ref-type="disp-formula">14</xref>)). The parameters were chosen to match the example of <italic>Chaetodipus intermedius</italic>; see text. Bottom panel: The initial genetic length of the haplotype shared between patches due to adaptation via migration as a function of the distance between environmental patches.</p></caption>
<graphic xlink:href="006940_fig6.tif"/>
</fig>
<p>Given the large selection coefficient associated with the dark allele on the dark substrate, we expect the initial haplotype associated with either a new mutation or migrant allele to be large. We can use equation (<xref rid="eqn21" ref-type="disp-formula">21</xref>) to calculate how long the founding haplotype shared between populations is expected to be, as shown in <xref rid="fig6" ref-type="fig">Figure 6</xref>. The initial length can be quite long between geographically close patches (tens of kilometers). However, for the wider cline width <inline-formula><alternatives><inline-graphic xlink:href="006940_inline43.gif"/></alternatives></inline-formula> adaptation by migration can still be likely for patches 100 km apart, but the shared basis may be hard to detect, as the length of shared haplotype can be quite short.</p>
<p>Furthermore, given the relatively small radius of the patches of dark substrate (often <italic>&#x003C;</italic> 10 km), we should expect the haplotype to be rapidly whittled down within patches after establishment (<xref rid="eqn24" ref-type="disp-formula">equation 24</xref>). We estimate that the effective recombination rate is no less than 50&#x0025; of the actual recombination rate. Indeed, if we take the population density to be roughly <italic>&#x03C1;</italic> &#x2248; 10 per hectare (M. Nachman, personal communication), and the variance in offspring number to be <italic>&#x03BE;</italic><sup>2</sup> &#x003D; 3 (mostly to get round numbers), then the shared haplotype length within patches from equation (<xref rid="eqn25" ref-type="disp-formula">25</xref>) is only expected to be on the order of hundreds or thousands of bases (10<sup>&#x2212;3</sup>&#x2013;10<sup>&#x2212;4</sup>cM). This suggests that unless the migration has happened fairly recently then it will be difficult to identify shared haplotypes (how recently depends on the background level of LD in the population).</p>
</sec>
</sec>
<sec id="s3">
<label>3</label><title>Discussion</title>
<p>This paper is an investigation into the basic question: What is the spatial resolution of convergent local adaptation? In other words, over what spatial scale of environmental patchiness will the process of adaptation develop independent solutions to evolutionary problems? The answer to this depends most strongly on <inline-formula><alternatives><inline-graphic xlink:href="006940_inline44.gif"/></alternatives></inline-formula>, the dispersal distance divided by the square root of the strength of selection against the allele between patches. It depends much more weakly on the selective benefit within the patches or (perhaps surprisingly) the population density, although these two factors will determine the time-scale over which adaptation will occur. This is in contrast with models of panmictic populations [<xref ref-type="bibr" rid="c28">Hermisson and Pennings, 2005</xref>, <bold>?</bold>, <bold>?</bold>] and geographically spread populations adapting to homogeneous selection pressures [<xref ref-type="bibr" rid="c53">Ralph and Coop, 2010</xref>], where the probability of multiple, independently arising adaptive alleles increases with the population size/density. However, in all of these models the dependence on the beneficial selection coefficient is absent or weak, due to the fact that selection both aids establishment of new alleles and the spread of existing alleles [but see <bold>?</bold>, for the complications of varying population sizes].</p>
<p>We have also shown that while weaker selection against alleles will make sharing of adaptations between patches easier, it will also makes it harder to spot the sharing, since the lucky alleles that manage to colonize new patches move slower, and thus carry a shorter shared haplotype. This issue is amplified by the fact that the length of haplotype shared within patches decays over time, potentially making the identification of shared adaptations to old selection pressures difficult.</p>
<p>Perhaps the most useful rule-of-thumb quantities we found were the following. The effective rate of migration into an as-yet-unadapted patch from an already-adapted patch distance <italic>R</italic> away &#x2013; the analogue of the mutational influx <inline-formula><alternatives><inline-graphic xlink:href="006940_inline45.gif"/></alternatives></inline-formula> Equivalently, the critical gap size between patches past which adaptation is likely independent is <inline-formula><alternatives><inline-graphic xlink:href="006940_inline46.gif"/></alternatives></inline-formula> Finally, successfully transiting migrant lineages move at rate <inline-formula><alternatives><inline-graphic xlink:href="006940_inline47.gif"/></alternatives></inline-formula> and so shared haplotype lengths between patches will be of order <inline-formula><alternatives><inline-graphic xlink:href="006940_inline48.gif"/></alternatives></inline-formula></p>
<p>In developing the set of approximations in the paper we have ignored a number of complicating factors. We now briefly discuss these.</p>
<sec id="s3a">
<title>Standing variation</title>
<p>We have tended to focus on relative rates of adaptation, since we are thinking of applications in which we know that adaptation has occurred, and the question is whether or not adaptations in distinct patches have appeared independently or not. However, especially absolute if rates of adaptation by new mutation are very low, any adaptation that does occur may have to make use of standing variation. The unstructured case was studied by <xref ref-type="bibr" rid="c28">Hermisson and Pennings [2005]</xref>; we study the continuous, spatial case in an upcoming paper. If parallelism in local adaptation of the sort we study here is due to standing variation rather than new mutation, then the dynamics of adaptation should not depend strongly on migration patterns (but note that the initial spatial distribution of standing variation may be).</p>
</sec>
<sec id="s3b">
<title>Dominance</title>
<p>We have mostly swept the issue of dominance under the rug by dealing with essentially haploid models, and appealing to the fact that the dynamics we study occur where the mutation is rare, and hence mostly present only in heterozygotes. Our results should hold as a good approximation to dominant and partially dominant alleles (with <italic>s<sub>m</sub></italic> the selection against heterozygotes). If, however, the mutation is recessive, then it is essentially neutral where rare, and so would encounter much less resistance to spreading between patches. The shape of the cline obtained is given by <xref ref-type="bibr" rid="c25">Haldane [1948]</xref>. This is counteracted, however, by the increased difficulty with which the mutation would establish once arriving in a new patch. As such it is not clear what our intuition should be about the contribution of recessive alleles to adaptation via migration. Further work is needed to put empirical observations of local adaptation by recessive alleles in a theoretical context.</p>
</sec>
<sec id="s3c">
<title>Long distance migration</title>
<p>We have also ignored the possibility of very long distance migration, instead focusing on local dispersal (and using a Gaussian model). However, dispersal distributions can be very heavy tailed, with a small fraction of individuals moving very long distances indeed [<xref ref-type="bibr" rid="c39">Levin et al., 2003</xref>, <xref ref-type="bibr" rid="c54">Reynolds and Rhodes, 2009</xref>]. In addition, over long time-scales, very rare chance events (mice sucked up in hurricanes and the like) could play a role in spreading migrant alleles if adaptation by other means is sufficiently unlikely. Such tail events could greatly increase the probability of parallel adaptation above that predicted by our model. Furthermore, if adaptive alleles do move between distant patches via rare, long distance migration then they will be associated with a much longer shared haplotype than predicted by equation (<xref rid="eqn21" ref-type="disp-formula">21</xref>). As such, we view our results as a null model by which the contribution of long distribution migrants to adaptation could be empirically judged.</p>
</sec>
<sec id="s3d">
<title>Other patch geometries</title>
<p>Here we have studied circular patches of habitat at long distances from each other, while real habitat is can be much more complex &#x2013; archipelagos of patches of varying sizes, or connected by long, skinny corridors, for instance. The work of <xref ref-type="bibr" rid="c10">Cantrell and Cosner [1991]</xref> comes closest to a general theory of balanced polymorphisms in such habitats, and it is possible that our techniques could be applied in their much more general setting, as both are based, fundamentally, on branching process approximations.</p>
</sec>
<sec id="s3e">
<title>Concluding thoughts</title>
<p>The falling cost of population genomic sequencing means that we will soon have the opportunity to study the interplay of adaptation with geography and ecology across many populations within a species. Our work suggests that even quite geographically close populations may be forced to locally adapt convergently when migration is geographically limited and selective pressures are divergent. Thus, systems where populations have been repeatedly subject to strong local selection pressures may offer the opportunity to study highly replicated convergent adaptation within a similar genetic background [<xref ref-type="bibr" rid="c60">Stern, 2013</xref>]. Such empirical work will also strongly inform our understanding of the ability of gene flow to keep ecologically similar populations evolving in concert [<xref ref-type="bibr" rid="c57">Sexton et al., 2013</xref>]. Our results suggest that adaptation to shared environments is certainly no guarantee of a shared genetic basis to adaptation, suggesting that rapid adaptation to a shared environment could potentially drive speciation if the alleles that spread in each population fail to work well together [<xref ref-type="bibr" rid="c37">Kondrashov, 2003</xref>].</p>
</sec>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="book"><string-name><given-names>David J.</given-names> <surname>Aldous</surname></string-name>. <chapter-title>Exchangeability and related topics</chapter-title>. In <source>&#x00C9;cole d&#x2019;&#x00E9;t&#x00E9; de probabilit&#x00E9;s de Saint-Flour, XIII&#x2014;1983</source>, volume <volume>1117</volume> of <series>Lecture Notes in Math.</series>, pages <fpage>1</fpage>&#x2013;<lpage>198</lpage>. <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin</publisher-loc>, <year>1985</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/content/c31v17440871210x/fulltext.pdf">http://www.springerlink.com/content/c31v17440871210x/fulltext.pdf</ext-link>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><given-names>Dorald M.</given-names> <surname>Allred</surname></string-name> and <string-name><given-names>D.</given-names> <surname>Elden Beck</surname></string-name>. <article-title>Range of movement and dispersal of some rodents at the Nevada atomic test site</article-title>. <source>Journal of Mammalogy</source>, <volume>44</volume>(<issue>2</issue>):pp. <fpage>190</fpage>&#x2013;<lpage>200</lpage>, <year>1963</year>. ISSN <issn>00222372</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/1377452">http://www.jstor.org/stable/1377452</ext-link>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>J</given-names> <surname>Arendt</surname></string-name> and <string-name><given-names>D</given-names> <surname>Reznick</surname></string-name>. <article-title>Convergence and parallelism reconsidered: what have we learned about the genetics of adaptation?</article-title> <source>Trends Ecol Evol</source>, <volume>23</volume>(<issue>1</issue>):<fpage>26</fpage>&#x2013;<lpage>32</lpage>, January <year>2008</year>. doi: <pub-id pub-id-type="doi">10.1016/j.tree.2007.09.011</pub-id>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><given-names>NH</given-names> <surname>Barton</surname></string-name>. <article-title>The probability of establishment of an advantageous mutant in a subdivided population</article-title>. <source>Genetics Research</source>, <volume>50</volume>(<issue>1</issue>):<fpage>35</fpage>&#x2013;<lpage>40</lpage>, <year>1987</year>. doi: <pub-id pub-id-type="doi">10.1017/S0016672300023314</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0016672300023314">http://dx.doi.org/10.1017/S0016672300023314</ext-link>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><given-names>N.H.</given-names> <surname>Barton</surname></string-name>, <string-name><given-names>A.M.</given-names> <surname>Etheridge</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Kelleher</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Vber</surname></string-name>. <article-title>Genetic hitchhiking in spatially extended populations</article-title>. <source>Theoretical Population Biology</source>, (<volume>0</volume>):&#x2013;, <year>2013</year>. ISSN <issn>0040-5809</issn>. doi: <pub-id pub-id-type="doi">10.1016/j.tpb.2012.12.001</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0040580912001359">http://www.sciencedirect.com/science/article/pii/S0040580912001359</ext-link>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><given-names>Nick H.</given-names> <surname>Barton</surname></string-name>, <string-name><given-names>Frantz</given-names> <surname>Depaulis</surname></string-name>, and <string-name><given-names>Alison M.</given-names> <surname>Etheridge</surname></string-name>. <article-title>Neutral evolution in spatially continuous populations</article-title>. <source>Theoretical Population Biology</source>, <volume>61</volume>(<issue>1</issue>):<fpage>31</fpage>&#x2013;<lpage>48</lpage>, February <year>2002</year>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/tpbi.2001.1557">http://dx.doi.org/10.1006/tpbi.2001.1557</ext-link>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="book"><string-name><given-names>S.B.</given-names> <surname>Benson</surname></string-name>. <source>Concealing coloration among some desert rodents of the southwestern United States</source>. Number v. 40 in University of California publications in zoology. <publisher-name>University of California Press</publisher-name>, <year>1933</year>. URL <ext-link ext-link-type="uri" xlink:href="http://books.google.com/books?id&#x003D;Lis-AQAAIAAJ">http://books.google.com/books?id&#x003D;Lis-AQAAIAAJ</ext-link>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="book"><string-name><given-names>Andrei N</given-names> <surname>Borodin</surname></string-name> and <string-name><given-names>Paavo</given-names> <surname>Salminen</surname></string-name>. <source>Handbook of Brownian motion: facts and formulae</source>. <publisher-name>Springer</publisher-name>, <year>2002</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><given-names>Robert Stephen</given-names> <surname>Cantrell</surname></string-name> and <string-name><given-names>Chris</given-names> <surname>Cosner</surname></string-name>. <article-title>Diffusive logistic equations with indefinite weights: population models in disrupted environments</article-title>. <source>Proceedings of the Royal Society of Edinburgh, Section: A Mathematics</source>, <volume>112</volume>(<issue>3&#x2013;4</issue>):<fpage>293</fpage>&#x2013;<lpage>318</lpage>, 0 <year>1989</year>. ISSN <issn>1473-7124</issn>. doi: <pub-id pub-id-type="doi">10.1017/S030821050001876X</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://journals.cambridge.org/article_S030821050001876X">http://journals.cambridge.org/article_S030821050001876X</ext-link>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>Robert Stephen</given-names> <surname>Cantrell</surname></string-name> and <string-name><given-names>Chris</given-names> <surname>Cosner</surname></string-name>. <article-title>Diffusive logistic equations with indefinite weights: population models in disrupted environments. II</article-title>. <source>SIAM J. Math. Anal</source>., <volume>22</volume>(<issue>4</issue>):<fpage>1043</fpage>&#x2013;<lpage>1064</lpage>, <year>1991</year>. ISSN <issn>0036-1410</issn>. doi: <pub-id pub-id-type="doi">10.1137/0522068</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/0522068">http://dx.doi.org/10.1137/0522068</ext-link>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>Brigitte</given-names> <surname>Chauvin</surname></string-name>, <string-name><given-names>Alain</given-names> <surname>Rouault</surname></string-name>, and <string-name><given-names>Anton</given-names> <surname>Wakolbinger</surname></string-name>. <article-title>Growing conditioned trees</article-title>. <source>Stochastic Process. Appl.</source>, <volume>39</volume>(<issue>1</issue>):<fpage>117</fpage>&#x2013;<lpage>130</lpage>, <year>1991</year>. ISSN 0304-4149. doi: <pub-id pub-id-type="doi">10.1016/0304-4149(91)90036-C</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx">http://dx.doi.org/10.1016/0304-4149(91)90036-C</ext-link>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><given-names>J L</given-names> <surname>Cherry</surname></string-name> and <string-name><given-names>J</given-names> <surname>Wakeley</surname></string-name>. <article-title>A diffusion approximation for selection and drift in a subdivided population</article-title>. <source>Genetics</source>, <volume>163</volume>(<issue>1</issue>):<fpage>421</fpage>&#x2013;<lpage>428</lpage>, January <year>2003</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/12586727">http://www.ncbi.nlm.nih.gov/pubmed/12586727</ext-link>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Conley</surname></string-name>. <article-title>An application of Wazewski&#x0027;s method to a non-linear boundary value problem which arises in population genetics</article-title>. <source>Journal of Mathematical Biology</source>, <volume>2</volume>(<issue>3</issue>):<fpage>241</fpage>&#x2013;<lpage>249</lpage>, <year>1975</year>. ISSN 0303-6812. doi: <pub-id pub-id-type="doi">10.1007/BF00277153</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00277153">http://dx.doi.org/10.1007/BF00277153</ext-link>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="book"><string-name><given-names>Donald A.</given-names> <surname>Dawson</surname></string-name>. <chapter-title>Measure-valued Markov processes</chapter-title>. In <source>&#x00C9;cole d&#x0027;&#x00C9;t&#x00E9; de Probabilit&#x00E9;s de Saint-Flour XXI&#x2014;1991</source>, volume <volume>1541</volume> of <series>Lecture Notes in Math.</series>, pages <fpage>1</fpage>&#x2013;<lpage>260</lpage>. <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin</publisher-loc>, <year>1993</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><given-names>Lee R.</given-names> <surname>Dice</surname></string-name>. <article-title>Ecologic and genetic variability within species of <italic>Peromyscus</italic></article-title>. <source>The American Naturalist</source>, <volume>74</volume> (<issue>752</issue>):pp. <fpage>212</fpage>&#x2013;<lpage>221</lpage>, <year>1940</year>. ISSN <issn>00030147</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2457573">http://www.jstor.org/stable/2457573</ext-link>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="book"><string-name><given-names>L.R.</given-names> <surname>Dice</surname></string-name> and <string-name><given-names>P.M.</given-names> <surname>Blossom</surname></string-name>. <source>Studies of Mammalian Ecology in Southwestern North America With Special Attention to the Colors of Desert Mammals</source>. <publisher-name>Carnegie Institution</publisher-name>, <year>1937</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><given-names>Peter</given-names> <surname>Donnelly</surname></string-name> and <string-name><given-names>Paul</given-names> <surname>Joyce</surname></string-name>. <article-title>Continuity and weak convergence of ranked and size-biased permutations on the infinite simplex</article-title>. <source>Stochastic Process. Appl</source>., <volume>31</volume>(<issue>1</issue>):<fpage>89</fpage>&#x2013;<lpage>103</lpage>, <year>1989</year>. ISSN <issn>0304-4149</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science?_ob&#x003D;ArticleURL&#x0026;_udi&#x003D;B6V1B-45FKRNK-2F&#x0026;_user&#x003D;4420&#x0026;_rdoc&#x003D;1&#x0026;_fmt&#x003D;&#x0026;_orig&#x003D;search&#x0026;_sort&#x003D;d&#x0026;view&#x003D;c&#x0026;_version&#x003D;1&#x0026;_urlVersion&#x003D;0&#x0026;_userid&#x003D;4420&#x0026;md5&#x003D;dff57a00ce4ce9c390959575a1ea8009">http://www.sciencedirect.com/science?_ob&#x003D;ArticleURL&#x0026;_udi&#x003D;B6V1B-45FKRNK-2F&#x0026;_user&#x003D;4420&#x0026;_rdoc&#x003D;1&#x0026;_fmt&#x003D;&#x0026;_orig&#x003D;search&#x0026;_sort&#x003D;d&#x0026;view&#x003D;c&#x0026;_version&#x003D;1&#x0026;_urlVersion&#x003D;0&#x0026;_userid&#x003D;4420&#x0026;md5&#x003D;dff57a00ce4ce9c390959575a1ea8009</ext-link>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="book"><string-name><given-names>Alison M.</given-names> <surname>Etheridge</surname></string-name>. <source>An introduction to superprocesses</source>, volume <volume>20</volume> of <series>University Lecture Series</series>. <publisher-name>American Mathematical Society</publisher-name>, <publisher-loc>Providence, RI</publisher-loc>, <year>2000</year>. ISBN <isbn>0-8218-2706-5</isbn>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><given-names>Joseph</given-names> <surname>Felsenstein</surname></string-name>. <article-title>A pain in the torus: Some difficulties with models of isolation by distance</article-title>. <source>The American Naturalist</source>, <volume>109</volume>(<issue>967</issue>):<fpage>359</fpage>&#x2013;<lpage>368</lpage>, <year>1975</year>. ISSN <issn>00030147</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2459700">http://www.jstor.org/stable/2459700</ext-link>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="book"><string-name><given-names>R. A.</given-names> <surname>Fisher</surname></string-name>. <source>The genetical theory of natural selection</source>. <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>, <year>1930</year>. ISBN <isbn>0-19-850440-3</isbn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.archive.org/details/geneticaltheoryo031631mbp">http://www.archive.org/details/geneticaltheoryo031631mbp</ext-link>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><given-names>R. A.</given-names> <surname>Fisher</surname></string-name>. <article-title>Gene frequencies in a cline determined by selection and diffusion</article-title>. <source>Biometrics</source>, <volume>6</volume>(<issue>4</issue>):pp. <fpage>353</fpage>&#x2013;<lpage>361</lpage>, <year>1950</year>. ISSN <issn>0006341X</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/3001780">http://www.jstor.org/stable/3001780</ext-link>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><given-names>Norman R.</given-names> <surname>French</surname></string-name>, <string-name><given-names>Theodore Y.</given-names> <surname>Tagami</surname></string-name>, and <string-name><given-names>Page</given-names> <surname>Hayden</surname></string-name>. <article-title>Dispersal in a population of desert rodents</article-title>. <source>Journal of Mammalogy</source>, <volume>49</volume>(<issue>2</issue>):pp. <fpage>272</fpage>&#x2013;<lpage>280</lpage>, <year>1968</year>. ISSN <issn>00222372</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/1377984">http://www.jstor.org/stable/1377984</ext-link>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><given-names>Jochen</given-names> <surname>Geiger</surname></string-name>. <article-title>Elementary new proofs of classical limit theorems for Galton-Watson processes</article-title>. <source>Journal of Applied Probability</source>, <volume>36</volume>(<issue>2</issue>):pp. <fpage>301</fpage>&#x2013;<lpage>309</lpage>, <year>1999</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/3215457">http://www.jstor.org/stable/3215457</ext-link>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="book"><string-name><given-names>I. S.</given-names> <surname>Gradshteyn</surname></string-name> and <string-name><given-names>I. M.</given-names> <surname>Ryzhik</surname></string-name>. <source>Table of integrals, series, and products</source>. <publisher-name>Elsevier/Academic Press</publisher-name>, <publisher-loc>Amsterdam</publisher-loc>, <edition>seventh edition</edition>, <year>2007</year>. ISBN <isbn>978-0-12-373637-6</isbn>; <isbn>0-12-373637-4</isbn>. Translated from the Russian, Translation edited and with a preface by Alan Jeffrey and Daniel Zwillinger, With one CD-ROM (Windows, Macintosh and UNIX).</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><given-names>J B</given-names> <surname>Haldane</surname></string-name>. <article-title>The theory of a cline</article-title>. <source>J Genet</source>, <volume>48</volume>(<issue>3</issue>):<fpage>277</fpage>&#x2013;<lpage>284</lpage>, January <year>1948</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18905075">http://www.ncbi.nlm.nih.gov/pubmed/18905075</ext-link>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><given-names>I. B. S.</given-names> <surname>Haldane</surname></string-name>. <article-title>A mathematical theory of natural and artificial selection, part V: Selection and mutation</article-title>. <source>Mathematical Proceedings of the Cambridge Philosophical Society</source>, <volume>23</volume>(<issue>07</issue>):<fpage>838</fpage>&#x2013;<lpage>844</lpage>, 7 <year>1927</year>. ISSN <issn>1469-8064</issn>. doi: <pub-id pub-id-type="doi">10.1017/S0305004100015644</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://journals.cambridge.org/article_S0305004100015644">http://journals.cambridge.org/article_S0305004100015644</ext-link>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><given-names>O</given-names> <surname>Hallatschek</surname></string-name> and <string-name><given-names>D R</given-names> <surname>Nelson</surname></string-name>. <article-title>Gene surfing in expanding populations</article-title>. <source>Theor Popul Biol</source>, <volume>73</volume>(<issue>1</issue>):<fpage>158</fpage>&#x2013;<lpage>170</lpage>, February <year>2008</year>. doi: <pub-id pub-id-type="doi">10.1016/j.tpb.2007.08.008</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17963807">http://www.ncbi.nlm.nih.gov/pubmed/17963807</ext-link>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><given-names>J</given-names> <surname>Hermisson</surname></string-name> and <string-name><given-names>P S</given-names> <surname>Pennings</surname></string-name>. <article-title>Soft sweeps: molecular population genetics of adaptation from standing genetic variation</article-title>. <source>Genetics</source>, <volume>169</volume>(<issue>4</issue>):<fpage>2335</fpage>&#x2013;<lpage>2352</lpage>, April <year>2005</year>. doi: <pub-id pub-id-type="doi">10.1534/genetics.104.036947</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?tool&#x003D;pubmed&#x0026;pubmedid&#x003D;15716498">http://www.pubmedcentral.nih.gov/articlerender.fcgi?tool&#x003D;pubmed&#x0026;pubmedid&#x003D;15716498</ext-link>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><given-names>H. E.</given-names> <surname>Hoekstra</surname></string-name>. <article-title>Genetics, development and evolution of adaptive pigmentation in vertebrates</article-title>. <source>Heredity (Edinb)</source>, <volume>97</volume>(<issue>3</issue>):<fpage>222</fpage>&#x2013;<lpage>234</lpage>, Sep <year>2006</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><given-names>H. E.</given-names> <surname>Hoekstra</surname></string-name> and <string-name><given-names>M. W.</given-names> <surname>Nachman</surname></string-name>. <article-title>Different genes underlie adaptive melanism in different populations of rock pocket mice</article-title>. <source>Mol. Ecol.</source>, <volume>12</volume>:<fpage>1185</fpage>&#x2013;<lpage>1194</lpage>, May <year>2003</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www3.interscience.wiley.com/journal/118890526/abstract">http://www3.interscience.wiley.com/journal/118890526/abstract</ext-link>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><given-names>H E</given-names> <surname>Hoekstra</surname></string-name>, <string-name><given-names>K E</given-names> <surname>Drumm</surname></string-name>, and <string-name><given-names>M W</given-names> <surname>Nachman</surname></string-name>. <article-title>Ecological genetics of adaptive color polymorphism in pocket mice: geographic variation in selected and neutral genes</article-title>. <source>Evolution</source>, <volume>58</volume>(<issue>6</issue>):<fpage>1329</fpage>&#x2013;<lpage>1341</lpage>, June <year>2004</year>. URL <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1111/j.0014-3820.2004.tb01711.x/abstract">http://onlinelibrary.wiley.com/doi/10.1111/j.0014-3820.2004.tb01711.x/abstract</ext-link>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><given-names>H E</given-names> <surname>Hoekstra</surname></string-name>, <string-name><given-names>J G</given-names> <surname>Krenz</surname></string-name>, and <string-name><given-names>M W</given-names> <surname>Nachman</surname></string-name>. <article-title>Local adaptation in the rock pocket mouse (<italic>Chaetodipus intermedius</italic>): natural selection and phylogenetic history of populations</article-title>. <source>Heredity</source>, <volume>94</volume>(<issue>2</issue>):<fpage>217</fpage>&#x2013;<lpage>228</lpage>, November <year>2005</year>. ISSN <issn>0018067X</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.hdy.6800600">http://dx.doi.org/10.1038/sj.hdy.6800600</ext-link>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><given-names>R R</given-names> <surname>Hudson</surname></string-name> and <string-name><given-names>N L</given-names> <surname>Kaplan</surname></string-name>. <article-title>The coalescent process in models with selection and recombination</article-title>. <source>Genetics</source>, <volume>120</volume>(<issue>3</issue>):<fpage>831</fpage>&#x2013;<lpage>840</lpage>, November <year>1988</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1203560/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1203560/</ext-link>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="book"><string-name><given-names>P.</given-names> <surname>Jagers</surname></string-name>. <source>Branching processes with biological applications</source>. <series>Wiley Series in Probability and Statistics: Applied Probability and Statistics Section Series</series>. <publisher-name>Wiley</publisher-name>, <year>1975</year>. ISBN <isbn>9780471436522</isbn>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><given-names>Donald W.</given-names> <surname>Kaufman</surname></string-name>. <article-title>Adaptive coloration in <italic>Peromyscus polionotus</italic>: Experimental selection by owls</article-title>. <source>Journal of Mammalogy</source>, <volume>55</volume>(<issue>2</issue>):pp. <fpage>271</fpage>&#x2013;<lpage>283</lpage>, <year>1974</year>. ISSN <issn>00222372</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/1378997">http://www.jstor.org/stable/1378997</ext-link>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><given-names>E. P.</given-names> <surname>Kingsley</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Manceau</surname></string-name>, <string-name><given-names>C. D.</given-names> <surname>Wiley</surname></string-name>, and <string-name><given-names>H. E.</given-names> <surname>Hoekstra</surname></string-name>. <article-title>Melanism in <italic>Peromyscus</italic> is caused by independent mutations in agouti</article-title>. <source>PLoS ONE</source>, <volume>4</volume>:<issue>e6435</issue>, <year>2009</year>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371&#x0025;2Fjournal.pone.0006435">http://dx.doi.org/10.1371&#x0025;2Fjournal.pone.0006435</ext-link>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><given-names>A. S.</given-names> <surname>Kondrashov</surname></string-name>. <article-title>Accumulation of Dobzhansky-Muller incompatibilities within a spatially structured population</article-title>. <source>Evolution</source>, <volume>57</volume>(<issue>1</issue>):<fpage>151</fpage>&#x2013;<lpage>153</lpage>, Jan <year>2003</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><given-names>Thomas</given-names> <surname>Lenormand</surname></string-name>. <article-title>Gene flow and the limits to natural selection</article-title>. <source>Trends in Ecology &#x0026; Evolution</source>, <volume>17</volume> (<issue>4</issue>):<fpage>183</fpage>&#x2013;<lpage>189</lpage>, <year>2002</year>. ISSN <issn>0169-5347</issn>. doi: DOI:<pub-id pub-id-type="doi">10.1016/S0169-5347(02)02497-7</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/B6VJ1-45BCHTS-G/2/815bb21b2179c1f813f44cc1e5f3785a">http://www.sciencedirect.com/science/article/B6VJ1-45BCHTS-G/2/815bb21b2179c1f813f44cc1e5f3785a</ext-link>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><given-names>Simon A.</given-names> <surname>Levin</surname></string-name>, <string-name><given-names>Helene C.</given-names> <surname>Muller-Landau</surname></string-name>, <string-name><given-names>Ran</given-names> <surname>Nathan</surname></string-name>, and <string-name><given-names>J&#x00E9;r&#x00F4;me</given-names> <surname>Chave</surname></string-name>. <article-title>The ecology and evolution of seed dispersal: a theoretical perspective</article-title>. <source>Annu. Rev. Ecol. Evol. Syst</source>., <volume>34</volume>:<fpage>575</fpage>&#x2013;<lpage>604</lpage>, <year>2003</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arjournals.annualreviews.org/doi/pdf/10.1146/annurev.ecolsys.34.011802.132428">http://arjournals.annualreviews.org/doi/pdf/10.1146/annurev.ecolsys.34.011802.132428</ext-link>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><given-names>Yuan</given-names> <surname>Lou</surname></string-name> and <string-name><given-names>Eiji</given-names> <surname>Yanagida</surname></string-name>. <article-title>Minimization of the principal eigenvalue for an elliptic boundary value problem with indefinite weight, and applications to population dynamics</article-title>. <source>Japan J. Indust. Appl. Math</source>., <volume>23</volume> (<issue>3</issue>):<fpage>275</fpage>&#x2013;<lpage>292</lpage>, <year>2006</year>. ISSN <issn>0916-7005</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://projecteuclid.org/getRecord?id&#x003D;euclid.jjiam/1197390801">http://projecteuclid.org/getRecord?id&#x003D;euclid.jjiam/1197390801</ext-link>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><given-names>M.R.</given-names> <surname>Macnair</surname></string-name>. <article-title>Why the evolution of resistance to anthropogenic toxins normally involves major gene changes: the limits to natural selection</article-title>. <source>Genetica</source>, <volume>84</volume>(<issue>3</issue>):<fpage>213</fpage>&#x2013;<lpage>219</lpage>, <year>1991</year>. ISSN <issn>0016-6707</issn>. doi: <pub-id pub-id-type="doi">10.1007/ BF00127250</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00127250">http://dx.doi.org/10.1007/BF00127250</ext-link>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><given-names>Arnaud</given-names> <surname>Martin</surname></string-name> and <string-name><given-names>Virginie</given-names> <surname>Orgogozo</surname></string-name>. <article-title>The loci of repeated evolution: a catalog of genetic hotspots of phenotypic variation</article-title>. <source>Evolution</source>, <volume>67</volume>(<issue>5</issue>):<fpage>1235</fpage>&#x2013;<lpage>1250</lpage>, <year>2013</year>. ISSN <issn>1558-5646</issn>. doi: <pub-id pub-id-type="doi">10.1111/evo.12081</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/evo.12081">http://dx.doi.org/10.1111/evo.12081</ext-link>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><given-names>Takeo</given-names> <surname>Maruyama</surname></string-name>. <article-title>On the fixation probability of mutant genes in a subdivided population</article-title>. <source>Genetics Research</source>, <volume>15</volume>(<issue>02</issue>):<fpage>221</fpage>&#x2013;<lpage>225</lpage>, <year>1970</year>. doi: <pub-id pub-id-type="doi">10.1017/S0016672300001543</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0016672300001543">http://dx.doi.org/10.1017/S0016672300001543</ext-link>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><given-names>J</given-names> <surname>Maynard Smith</surname></string-name> and <string-name><given-names>J</given-names> <surname>Haigh</surname></string-name>. <article-title>The hitch-hiking effect of a favourable gene</article-title>. <source>Genet Res</source>, <volume>23</volume>(<issue>1</issue>):<fpage>23</fpage>&#x2013;<lpage>35</lpage>, February <year>1974</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/4407212">http://www.ncbi.nlm.nih.gov/pubmed/4407212</ext-link>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><given-names>M W</given-names> <surname>Nachman</surname></string-name>, <string-name><given-names>H E</given-names> <surname>Hoekstra</surname></string-name>, and <string-name><given-names>S L</given-names> <surname>D&#x0027;Agostino</surname></string-name>. <article-title>The genetic basis of adaptive melanism in pocket mice</article-title>. <source>Proc Natl Acad Sci U S A</source>, <volume>100</volume>(<issue>9</issue>):<fpage>5268</fpage>&#x2013;<lpage>5273</lpage>, April <year>2003</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.0431157100</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/12704245">http://www.ncbi.nlm.nih.gov/pubmed/12704245</ext-link>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><given-names>Thomas</given-names> <surname>Nagylaki</surname></string-name>. <article-title>Conditions for the existence of clines</article-title>. <source>Genetics</source>, <volume>80</volume>(<issue>3</issue>):<fpage>595</fpage>&#x2013;<lpage>615</lpage>, <year>1975</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/80/3/595.abstract">http://www.genetics.org/content/80/3/595.abstract</ext-link>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="website"><collab>NEQwiki</collab>. <article-title>NEQwiki, the nonlinear equations encyclopedia</article-title>, <year>2013</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.primat.mephi.ru/wiki/ow.asp?Korteweg-de_Vries_equation">http://www.primat.mephi.ru/wiki/ow.asp?Korteweg-de_Vries_equation</ext-link>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><given-names>H A</given-names> <surname>Orr</surname></string-name> and <string-name><given-names>A J</given-names> <surname>Betancourt</surname></string-name>. <article-title>Haldane&#x0027;s sieve and adaptation from the standing genetic variation</article-title>. <source>Genetics</source>, <volume>157</volume>(<issue>2</issue>):<fpage>875</fpage>&#x2013;<lpage>884</lpage>, February <year>2001</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/11157004">http://www.ncbi.nlm.nih.gov/pubmed/11157004</ext-link>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><given-names>Pleuni S.</given-names> <surname>Pennings</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Hermisson</surname></string-name>. <article-title>Soft sweeps II - molecular population genetics of adaptation from recurrent mutation or migration</article-title>. <source>Mol Biol Evol</source>, page msj117, <year>2006</year>. doi: <pub-id pub-id-type="doi">10.1093/molbev/msj117</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/abstract/msj117v1">http://mbe.oxfordjournals.org/cgi/content/abstract/msj117v1</ext-link>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Perman</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Pitman</surname></string-name>, and <string-name><given-names>M.</given-names> <surname>Yor</surname></string-name>. <article-title>Size-biased sampling of Poisson point processes and excursions</article-title>. <source>Probability Theory and Related Fields</source>, <volume>92</volume>(<issue>1</issue>):<fpage>21</fpage>&#x2013;<lpage>39</lpage>, <year>1992</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/content/n08754882308h67n/">http://www.springerlink.com/content/n08754882308h67n/</ext-link>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><given-names>Jim</given-names> <surname>Pitman</surname></string-name>. <article-title>Exchangeable and partially exchangeable random partitions</article-title>. <source>Probab. Theory Related Fields</source>, <volume>102</volume>(<issue>2</issue>):<fpage>145</fpage>&#x2013;<lpage>158</lpage>, <year>1995</year>. ISSN <issn>0178-8051</issn>. doi: <pub-id pub-id-type="doi">10.1007/BF01213386</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF01213386">http://dx.doi.org/10.1007/BF01213386</ext-link>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><given-names>Edward</given-names> <surname>Pollak</surname></string-name>. <article-title>On the survival of a gene in a subdivided population</article-title>. <source>Journal of Applied Probability</source>, <volume>3</volume> (<issue>1</issue>):<fpage>142</fpage>&#x2013;<lpage>155</lpage>, <year>1966</year>. ISSN <issn>00219002</issn>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/3212043">http://www.jstor.org/stable/3212043</ext-link>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><given-names>Peter</given-names> <surname>Ralph</surname></string-name> and <string-name><given-names>Graham</given-names> <surname>Coop</surname></string-name>. <article-title>Parallel adaptation: One or many waves of advance of an advantageous allele?</article-title> <source>Genetics</source>, <volume>186</volume>(<issue>2</issue>):<fpage>647</fpage>&#x2013;<lpage>668</lpage>, <year>2010</year>. doi: <pub-id pub-id-type="doi">10.1534/genetics.110.119594</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/cgi/content/abstract/186/2/647">http://www.genetics.org/cgi/content/abstract/186/2/647</ext-link>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><given-names>A M</given-names> <surname>Reynolds</surname></string-name> and <string-name><given-names>C J</given-names> <surname>Rhodes</surname></string-name>. <article-title>The &#x013A;evy flight paradigm: random search patterns and mechanisms</article-title>. <source>Ecology</source>, <volume>90</volume>(<issue>4</issue>):<fpage>877</fpage>&#x2013;<lpage>887</lpage>, April <year>2009</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.esajournals.org/doi/abs/10.1890/08-0153.1">http://www.esajournals.org/doi/abs/10.1890/08-0153.1</ext-link>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><given-names>Erica Bree</given-names> <surname>Rosenblum</surname></string-name>, <string-name><given-names>Holger</given-names> <surname>R&#x00F6;mpler</surname></string-name>, <string-name><given-names>Torsten</given-names> <surname>Sch&#x00F6;neberg</surname></string-name>, and <string-name><given-names>Hopi E.</given-names> <surname>Hoekstra</surname></string-name>. <article-title>Molecular and functional basis of phenotypic convergence in white lizards at White Sands</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>107</volume>(<issue>5</issue>):<fpage>2113</fpage>&#x2013;<lpage>2117</lpage>, <year>2010</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.0911042107</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/content/107/5/2113.abstract">http://www.pnas.org/content/107/5/2113.abstract</ext-link>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><given-names>Henk</given-names> <surname>Schat</surname></string-name>, <string-name><given-names>Riet</given-names> <surname>Vooijs</surname></string-name>, and <string-name><given-names>Eric</given-names> <surname>Kuiper</surname></string-name>. <article-title>Identical major gene loci for heavy metal tolerances that have independently evolved in different local populations and subspecies of <italic>Silene vulgaris</italic></article-title>. <source>Evolution</source>, <volume>50</volume> (<issue>5</issue>):pp. <fpage>1888</fpage>&#x2013;<lpage>1895</lpage>, <year>1996</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2410747">http://www.jstor.org/stable/2410747</ext-link>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><given-names>Jason P.</given-names> <surname>Sexton</surname></string-name>, <string-name><given-names>Sandra B.</given-names> <surname>Hangartner</surname></string-name>, and <string-name><given-names>Ary A.</given-names> <surname>Hoffmann</surname></string-name>. <article-title>Genetic isolation by environment or distance: Which pattern of gene flow is most common?</article-title> <source>Evolution, pages n/a&#x2013;n/a</source>, <year>2013</year>. ISSN <issn>1558-5646</issn>. doi: <pub-id pub-id-type="doi">10.1111/evo.12258</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/evo.12258">http://dx.doi.org/10.1111/evo.12258</ext-link>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><given-names>Montgomery</given-names> <surname>Slatkin</surname></string-name>. <article-title>Gene flow and selection in a cline</article-title>. <source>Genetics</source>, <volume>75</volume>(<issue>4</issue>):<fpage>733</fpage>&#x2013;<lpage>756</lpage>, <year>1973</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/cgi/content/abstract/75/4/733">http://www.genetics.org/cgi/content/abstract/75/4/733</ext-link>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><given-names>Cynthia C.</given-names> <surname>Steiner</surname></string-name>, <string-name><given-names>Holger</given-names> <surname>Rompler</surname></string-name>, <string-name><given-names>Linda M.</given-names> <surname>Boettger</surname></string-name>, <string-name><given-names>Torsten</given-names> <surname>Schoneberg</surname></string-name>, and <string-name><given-names>Hopi E.</given-names> <surname>Hoekstra</surname></string-name>. <article-title>The genetic basis of phenotypic convergence in beach mice: Similar pigment patterns but different genes</article-title>. <source>Mol Biol Evol</source>, <volume>26</volume>(<issue>1</issue>):<fpage>35</fpage>&#x2013;<lpage>45</lpage>, <year>2009</year>. doi: <pub-id pub-id-type="doi">10.1093/molbev/msn218</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/abstract/26/1/35">http://mbe.oxfordjournals.org/cgi/content/abstract/26/1/35</ext-link>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><given-names>D L</given-names> <surname>Stern</surname></string-name>. <article-title>The genetic causes of convergent evolution</article-title>. <source>Nat Rev Genet</source>, <volume>14</volume>(<issue>11</issue>):<fpage>751</fpage>&#x2013;<lpage>764</lpage>, November <year>2013</year>. doi: <pub-id pub-id-type="doi">10.1038/nrg3483</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/24105273">http://www.ncbi.nlm.nih.gov/pubmed/24105273</ext-link>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><given-names>TL</given-names> <surname>Turner</surname></string-name>, <string-name><given-names>EC</given-names> <surname>Bourne</surname></string-name>, <string-name><given-names>EJ</given-names> <surname>Von Wettberg</surname></string-name>, <string-name><given-names>TT</given-names> <surname>Hu</surname></string-name>, and <string-name><given-names>SV</given-names> <surname>Nuzhdin</surname></string-name>. <article-title>Population resequencing reveals local adaptation of arabidopsis lyrata to serpentine soils</article-title>. <source>Nat. Genet</source>., <volume>42</volume>(<issue>3</issue>):<fpage>260</fpage>&#x2013;<lpage>3</lpage>, January <year>2010</year>. URL <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20101244">http://www.ncbi.nlm.nih.gov/pubmed/20101244</ext-link>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><given-names>Ying</given-names> <surname>Zhen</surname></string-name>, <string-name><given-names>Matthew L.</given-names> <surname>Aardema</surname></string-name>, <string-name><given-names>Edgar M.</given-names> <surname>Medina</surname></string-name>, <string-name><given-names>Molly</given-names> <surname>Schumer</surname></string-name>, and <string-name><given-names>Peter</given-names> <surname>Andolfatto</surname></string-name>. <article-title>Parallel molecular evolution in an herbivore community</article-title>. <source>Science</source>, <volume>337</volume>(<issue>6102</issue>):<fpage>1634</fpage>&#x2013;<lpage>1637</lpage>, <year>2012</year>. doi: <pub-id pub-id-type="doi">10.1126/science.1226630</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/content/337/6102/1634.abstract">http://www.sciencemag.org/content/337/6102/1634.abstract</ext-link>.</mixed-citation></ref>
</ref-list>
<sec id="s4">
<label>A</label>
<title>Numerical calculation of the probability of establishment</title>
<p>When rare, under at least some demographic models, copies of a new mutant allele are approximately independent and experience a uniform selective benefit; and can therefore be treated as a branching process (a spatial branching process in this case). Furthermore, whether or not a new, beneficial mutation establishes or is lost to demographic stochasticity is determined by this phase where it is rare. Fortunately, the probability that a branching process does not establish (i.e. dies out) can be found as a fixed point of the generating function of the process [<xref ref-type="bibr" rid="c34">Jagers, 1975</xref>]. Therefore, we calculated explicitly the generating function for a spatial branching process with nearest-neighbor migration on a one-dimensional lattice and a Poisson number of offspring with mean 1 &#x002B; <italic>s</italic>, where <italic>s</italic> could vary by location, and iterated this forward to convergence to obtain 1 &#x2212; <italic>p</italic>(<italic>x</italic>), the probability a single mutation appearing at <italic>x</italic> would fail to establish. We considered two situations: where <italic>s</italic> is a step function, and where it has a linear transition. These solutions are shown, and parameters described, in <xref rid="fig7" ref-type="fig">figure 7</xref>.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><p>The probability of establishment of a new mutant allele as a function of distance from the edge of the region where it is beneficial, in an abrupt transition (left) and a gradual transition (right). The allele is deleterious to the left and beneficial to the right (with selection coefficients &#x2213; 0.05 respectively); and the selection coefficient interpolates linearly between these in the central hatched region. The number of offspring is Poisson. The underlying landscape has demes every 15 km and a migration rate of 0.5 between neighboring demes; the probability was found by numerically solving the equation for the probability of establishment of a multi-type branching process. Note that the approximation used in the text is here <italic>p<sub>e</sub></italic> &#x2248; 2<italic>s<sub>p</sub>/&#x03BE;</italic><sup>2</sup> &#x003D; 0.1, agreeing with the asymptotic value on the right.</p></caption>
<graphic xlink:href="006940_fig7.tif"/>
</fig>
<p>Here (and at other parameter choices) we see that the probability of establishment <italic>p</italic>(<italic>x</italic>) goes to the equilibrium value (approximately <italic>p<sub>e</sub></italic> &#x003D; 2<italic>s/&#x03BE;</italic><sup>2</sup>) within the patch; the transition is fairly symmetrical about the edge of the patch, even if the edge of the patch is not sharp. The fit is equally good for other parameter values, even if migration can move further than one deme and offspring numbers are not Poisson (results not shown). This lends credence to our approximation that the integral of <italic>p</italic>(<italic>x</italic>) over the entire range is close to <italic>p<sub>e</sub></italic> multiplied by the area of the patch.</p></sec>
<sec id="s5">
<label>B</label>
<title>The equilibrium frequency</title>
<p>For completeness, and clarity as to the scalings on the relevant parameters, here we provide a derivation of the differential equations referred to above equation (<xref rid="eqn3" ref-type="disp-formula">3</xref>), and establish the asymptotics given in that equation. One route to the &#x201C;equilibrium frequency&#x201D; of the allele outside the range where it is advantageous is as follows; see <xref ref-type="bibr" rid="c58">Slatkin [1973]</xref> or <xref ref-type="bibr" rid="c4">Barton [1987]</xref>, <xref ref-type="bibr" rid="c52">Pollak [1966]</xref> (or <bold>?</bold> or <bold>?</bold> or <xref ref-type="bibr" rid="c25">Haldane [1948]</xref>) for other arguments in equivalent models, or <xref ref-type="bibr" rid="c18">Etheridge [2000]</xref> and/or <xref ref-type="bibr" rid="c14">Dawson [1993]</xref> for general theory used below. Following is a description of a discrete model (which is nearly the one we simulate from). Suppose that the population is composed of a finite number of small demes of equal size <italic>N</italic> arranged in a regular grid, and that selection (for or against) the allele is given by the function <italic>s</italic>(<italic>x</italic>), with <italic>x</italic> denoting the spatial location. Each individual at location <italic>x</italic> reproduces after a random lifetime, dying, and then leaving behind in the same deme a random number of offspring with distribution given by <italic>X</italic>; each offspring then migrates independently to a new location chosen randomly from the distribution given by <italic>x</italic> &#x002B; <italic>R</italic>, where she replaces a randomly chosen individual. If <italic>x</italic> &#x002B; <italic>R</italic> is outside of the range, then she perishes. Each individual&#x2019;s time until reproduction is exponentially distributed: the reproduction rate is 1 if it carries the original allele, or with rate 1 &#x002B; <italic>s</italic>(<italic>x</italic>) if it carries the mutant allele. Suppose that the number of offspring <italic>X</italic> has mean <italic>&#x00B5;</italic>; the variance of <italic>X</italic> will not enter into the formula (but assume <italic>X</italic> is well-behaved). Also suppose that the migration displacement <italic>R</italic> has mean zero and variance <italic>&#x03C3;</italic><sup>2</sup>; if we are in more than one dimension, we mean that the components of the dispersal distance are uncorrelated and each have variance <italic>&#x03C3;</italic><sup>2</sup>. We also assume that the distribution of <italic>R</italic> makes the associated random walk irreducible and aperiodic.</p>
<p>Let <inline-formula><alternatives><inline-graphic xlink:href="006940_inline49.gif"/></alternatives></inline-formula> be the proportion of mutant alleles present at location <italic>x</italic> at time <italic>t</italic>, and &#x03A6;<italic>t</italic>(<italic>x</italic>) the process obtained by taking <italic>N &#x2192; &#x221E;</italic> (which we assume exists). Denote by <italic>&#x03B4;<sub>x</sub></italic> a single unit at location <italic>x</italic>, so that e.g. <inline-formula><alternatives><inline-graphic xlink:href="006940_inline50.gif"/></alternatives></inline-formula> is the configuration after a mutant allele has been added to location <italic>x</italic>. For 0 <italic>&#x2264; &#x03D5; &#x2264;</italic> 1, we also denote by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline51.gif"/></alternatives></inline-formula> the random number of mutant alleles added if <italic>X</italic> new offspring carrying mutant alleles replace randomly chosen individuals in a deme where the mutant allele is at frequency <italic>&#x03D5;</italic> (i.e. hypergeometric with parameters (<italic>X, &#x03D5;</italic>)); similarly, <inline-formula><alternatives><inline-graphic xlink:href="006940_inline52.gif"/></alternatives></inline-formula> is the number lost if the new offspring do not carry the allele (i.e. hypergeometric with parameters (<italic>X,</italic> 1 &#x2212; <italic>&#x03D5;</italic>)). (We like to think of <inline-formula><alternatives><inline-graphic xlink:href="006940_inline53.gif"/></alternatives></inline-formula> as a measure, but it does not hurt to think of &#x03A6;<italic><sup>N</sup></italic> as a vector; we aren&#x0027;t providing the rigorous justification here.) Then the above description implies that for any sufficiently nice function <italic>f</italic> (&#x03A6;) that
<disp-formula id="eqn26">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn26.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn27">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn27.gif"/></alternatives>
</disp-formula></p>
<p>In the final expectation, <italic>R</italic> and &#x03A6; are independent. This follows by taking first-order terms in 1<italic>/N</italic> in the Taylor series for <italic>f</italic>, and the fact that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline54.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="006940_inline55.gif"/></alternatives></inline-formula> We can see two things from this: First, since this is a first-order differential operator, the limiting stochastic process &#x03A6; obtained as <italic>N &#x2192; &#x221E;</italic> is in fact deterministic (check by applying to <italic>f</italic> (&#x03A6;) &#x003D; &#x03A6;(<italic>x</italic>)<sup>2</sup> to find the variance). Second, if we want to rescale space as well to get the usual differential equation, we need to choose Var[<italic>R</italic>] &#x003D; <italic>&#x03C3;</italic><sup>2</sup> and <italic>s</italic>(<italic>x</italic>) to be of the same, small, order; this is another way of seeing that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline56.gif"/></alternatives></inline-formula> is the relevant length scale [as noted by <xref ref-type="bibr" rid="c58">Slatkin, 1973</xref>]. More concretely, suppose that the grid size is <italic>&#x2208; &#x2192;</italic> 0, that Var[<italic>R</italic>] &#x003D; (<italic>&#x03C3;&#x2208;</italic>)<sup>2</sup>, and that the strength of selection is <italic>s</italic>(<italic>x</italic>)<italic>&#x2208;</italic>, and suppose that &#x03A6;<sub><italic>t</italic></sub>(<italic>x</italic>) is deterministic (and sufficiently differentiable) and let <italic>&#x03BE;</italic>(<italic>t, x</italic>) &#x003D; &#x03A6;<italic><sub>t/&#x2208;</sub></italic>(<italic>x</italic>); then the previous equation with <italic>f</italic> (&#x03A6;) &#x003D; &#x03A6;(<italic>x</italic>) converges to the familiar form:
<disp-formula id="eqn28">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn28.gif"/></alternatives>
</disp-formula>
Here we have taken first the population size <italic>N &#x2192; &#x221E;</italic> and then the grid size <italic>&#x2208; &#x2192;</italic> 0; we could alternatively take both limits together, but not if &#x2208; goes to zero too much faster than <italic>N</italic> grows. One reason for this is that at finite <italic>N</italic>, the process &#x03A6;<sub><italic>t</italic></sub> is an irreducible, aperiodic finite-state Markov chain with absorbing states at 0 and 1; therefore, the inevitable outcome is extinction of one type or another, which is not the regime we want to study.</p>
<p>In one dimension, we are done (see section B.2); in higher dimensions, we are more interested in the mean frequency at a given distance <italic>r</italic> from a patch. If we take a radially symmetric patch centered at the origin (so <italic>s</italic> only depends on <italic>r</italic>), and let <italic>&#x03BE;</italic>(<italic>t, r</italic>) denote the mean occupation frequency at distance <italic>r</italic>, then the polar form of the Laplacian in <italic>d</italic> dimensions gives us that (28) is
<disp-formula id="eqn29">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn29.gif"/></alternatives>
</disp-formula></p>
<sec id="s5a">
<label>B.1</label>
<title>Asymptotic solution for the equilibrium frequency</title>
<p>If <italic>q</italic>(<italic>r</italic>) is a radially symmetric equilibrium frequency and <italic>&#x03BE;</italic>(<italic>t, x</italic>) &#x003D; <italic>q</italic>(<italic>&#x007C;x&#x007C;</italic>), then <italic>&#x2202;<sub>t</sub>&#x03BE;</italic>(<italic>t, x</italic>) &#x003D; 0. So, using (29), a radially symmetric solution with <italic>s</italic>(<italic>r</italic>) &#x003D; <italic>&#x2212;s &#x003C;</italic> 0 for all <italic>r &#x003E; r</italic><sub>0</sub> solves, for <italic>r</italic><sub>0</sub> <italic>&#x003C; r &#x003C; &#x221E;</italic>,
<disp-formula id="eqn30">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn30.gif"/></alternatives>
</disp-formula>
</p>
<disp-formula id="eqn31">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn31.gif"/></alternatives>
</disp-formula>
<p>Since <italic>q</italic>(<italic>r</italic>) <italic>&#x2192;</italic> 0 as <italic>r &#x2192; &#x221E;</italic>, so <italic>q</italic>(<italic>r</italic>)(1 &#x2212; <italic>q</italic>(<italic>r</italic>)) <italic>&#x2248; q</italic>(<italic>r</italic>), it can be shown that the true equilibrium frequency <italic>q</italic> is close, for large <italic>r</italic>, to the solution to
<disp-formula id="eqn32">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn32.gif"/></alternatives>
</disp-formula>
</p>
<disp-formula id="eqn33">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn33.gif"/></alternatives>
</disp-formula>
<p>This has general solution given by a modified Bessel function: using <xref ref-type="bibr" rid="c24">Gradshteyn and Ryzhik [2007]</xref> 8.494.9, the general solution is
<disp-formula id="eqn34">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn34.gif"/></alternatives>
</disp-formula>
where <italic>C<sup>&#x2032;</sup></italic> and <italic>r</italic><sub>0</sub> are chosen to match boundary conditions. Asymptotics of Bessel functions [<xref ref-type="bibr" rid="c24">Gradshteyn and Ryzhik, 2007</xref>, 8.451.6] then imply that
<disp-formula id="eqn35">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn35.gif"/></alternatives>
</disp-formula>
where <italic>C</italic> is a different constant.</p>
</sec>
<sec id="s5b">
<label>B.2</label>
<title>The exact solution to the equilibrium frequency</title>
<p>Here we describe how to solve (30) exactly in one dimension, i.e. the Fisher-KPP equation with piecewise constant selection. Let <italic>p</italic>(<italic>t, x</italic>) be the proportion of the allele under spatially varying selection <italic>s</italic>(<italic>x</italic>) in one dimension, so that
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn1.gif"/></alternatives>
</disp-formula></p>
<p>The stable distribution <italic>&#x03D5;</italic>(<italic>x</italic>) &#x003D; lim<sub><italic>t&#x2192;&#x221E;</italic></sub> <italic>p</italic>(<italic>t, x</italic>) then solves
<disp-formula id="eqn36">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn36.gif"/></alternatives>
</disp-formula>
with appropriate boundary conditions. First rescale space by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline57.gif"/></alternatives></inline-formula> so the <italic>&#x03C3;</italic><sup>2</sup>/2 term disappears. If we now assume that <italic>s</italic>(<italic>x</italic>) is piecewise constant, <italic>s</italic>(<italic>x</italic>) &#x003D; <italic>s<sub>i</sub></italic> for <italic>x</italic> &#x2208; [<italic>x<sub>i</sub>, x</italic><sub><italic>i</italic> &#x002B; 1</sub>), with <italic>x</italic><sub>0</sub> &#x003D; <italic>&#x2212;&#x221E;</italic> and <italic>x<sub>n &#x002B; 2</sub></italic> &#x003D; <italic>&#x221E;</italic>, then the equation is integrable: if we multiply through by 2<italic>&#x2202;<sub>x</sub>&#x03D5;</italic>(<italic>x</italic>) and integrate, then we get that
<disp-formula id="eqn37">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn37.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn38">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn38.gif"/></alternatives>
</disp-formula>
if we define
<disp-formula id="eqn39">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn39.gif"/></alternatives>
</disp-formula>
For ease of reference, we define
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn2.gif"/></alternatives>
</disp-formula>
Note that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline58.gif"/></alternatives></inline-formula> that <italic>V<sub>i</sub></italic>(0) &#x003D; <italic>K<sub>i</sub></italic> and <italic>V<sub>i</sub></italic>(1) &#x003D; <italic>K<sub>i</sub></italic> &#x002B;<italic>s<sub>i</sub>/</italic>3. We will always have that <italic>V</italic> (<italic>&#x03D5;</italic>) <italic>&#x2264;</italic> 0. (We have then that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline59.gif"/></alternatives></inline-formula> the equation of motion of a particle in potential <italic>V</italic>. Also note that this implies &#x201C;conservation of energy&#x201D;, i.e. (<italic>&#x2202;<sub>x</sub>&#x03D5;</italic>(<italic>x</italic>))<sup>2</sup> &#x002B; <italic>V</italic> (<italic>&#x03D5;</italic>(<italic>x</italic>)) is constant.) Rearranging, we get that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline60.gif"/></alternatives></inline-formula> so where <italic>&#x03D5;</italic>(<italic>x</italic>) is monotone, the inverse is
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn3.gif"/></alternatives>
</disp-formula>
For each <italic>i</italic> then define the elliptic function
<disp-formula id="eqn40">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn40.gif"/></alternatives>
</disp-formula>
where take the positive branch of the square root, and <inline-formula><alternatives><inline-graphic xlink:href="006940_inline61.gif"/></alternatives></inline-formula> will be chosen later. Then we have that <italic>x</italic>(<italic>&#x03D5;</italic>) &#x2212; <italic>x</italic>(<italic>&#x03D5;</italic><sub>0</sub>) &#x003D; <italic>&#x00B1;</italic>(<italic>F</italic> (<italic>&#x03D5;</italic>) &#x2212; <italic>F</italic> (<italic>&#x03D5;</italic><sub>0</sub>)), or for an appropriate <italic>x</italic><sub>0</sub>,
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn4.gif"/></alternatives>
</disp-formula>
We clearly want lim<sub><italic>x</italic>&#x2192;&#x221E;</sub> &#x2202;<italic><sub>x</sub>&#x03D5;</italic>(<italic>&#x00B1;x</italic>) &#x003D; 0, and lim<italic><sub>x&#x2192;&#x221E;</sub> &#x03D5;</italic>(<italic>&#x00B1;x</italic>) to be zero or one depending on the sign of <italic>s</italic><sub>0</sub> and <italic>s</italic><sub><italic>n</italic>&#x002B;1</sub>. Since (<italic>&#x2202;<sub>x</sub>&#x03D5;</italic>(<italic>x</italic>))<sup>2</sup> &#x003D; <italic>&#x2212;V</italic> (<italic>x</italic>), this implies that if <italic>s</italic><sub>0</sub> <italic>&#x003C;</italic> 0, then <italic>K</italic><sub>0</sub> &#x003D; 0, while if <italic>s</italic><sub>0</sub> <italic>&#x003E;</italic> 0 then <italic>K</italic><sub>0</sub> &#x003D; <italic>s</italic><sub>0</sub>/6; and likewise for <italic>K</italic><sub><italic>n</italic>&#x002B;1</sub>.</p>
<p>We also require that <italic>&#x03D5;</italic>(<italic>x</italic>) and <italic>&#x03D5;<sup>&#x2032;</sup></italic>(<italic>x</italic>) are continuous. Continuity of <italic>&#x03D5;<sup>&#x2032;</sup></italic>(<italic>x</italic>) is equivalent to <italic>V<sub>i</sub></italic>(<italic>x</italic><sub><italic>i</italic>&#x002B;1</sub>) &#x003D; <italic>V</italic><sub><italic>i</italic> &#x002B; 1</sub>(<italic>x</italic><sub><italic>i</italic>&#x002B;1</sub>), which we can rearrange to find an equation for <italic>K</italic><sub><italic>i</italic> &#x002B; 1</sub> in terms of <italic>K<sub>i</sub></italic> and <italic>&#x03D5;</italic>(<italic>x</italic><sub><italic>i</italic> &#x002B; 1</sub>):
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn5.gif"/></alternatives>
</disp-formula>
What about the frequency at the points the selection changes, <italic>&#x03D5;</italic>(<italic>x<sub>i</sub></italic>)? Well, if <italic>&#x03D5;</italic>(<italic>x</italic>) is monotone on [<italic>x<sub>i</sub>, x<sub>i</sub></italic><sub>&#x002B;1</sub>) then we can without loss of generality take <inline-formula><alternatives><inline-graphic xlink:href="006940_inline62.gif"/></alternatives></inline-formula> &#x003D; 0 or 1 depending on the sign of <italic>s<sub>i</sub></italic>. Otherwise, let <inline-formula><alternatives><inline-graphic xlink:href="006940_inline63.gif"/></alternatives></inline-formula> be the (unique) root of <italic>V<sub>i</sub></italic> in [<italic>x<sub>i</sub>, x<sub>i</sub></italic><sub>&#x002B;1</sub>), so <inline-formula><alternatives><inline-graphic xlink:href="006940_inline64.gif"/></alternatives></inline-formula> In this case, <inline-formula><alternatives><inline-graphic xlink:href="006940_inline65.gif"/></alternatives></inline-formula> is the maximum or minimum of <italic>&#x03D5;</italic> in the interval: if <italic>s &#x003E;</italic> 0, then <italic>&#x03D5;<sub>i</sub></italic> &#x003D; max&#x007B;<italic>&#x03D5;</italic>(<italic>x</italic>) : <italic>x</italic> &#x2208;[<italic>x<sub>i</sub>, x</italic><sub><italic>i</italic>&#x002B;1</sub>)&#x007D;. Recall we defined <italic>F<sub>i</sub></italic> using <inline-formula><alternatives><inline-graphic xlink:href="006940_inline66.gif"/></alternatives></inline-formula>; now using the fact that <italic>&#x03D5;</italic> is monotone with the opposite sign on either side of <inline-formula><alternatives><inline-graphic xlink:href="006940_inline67.gif"/></alternatives></inline-formula><inline-formula><alternatives><inline-graphic xlink:href="006940_inline68.gif"/></alternatives></inline-formula> and that <inline-formula><alternatives><inline-graphic xlink:href="006940_inline69.gif"/></alternatives></inline-formula> we know that the length of the <italic>i</italic>th stretch is
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn6.gif"/></alternatives>
</disp-formula>
Note that all the <italic>&#x00B1;</italic>&#x2019;s are easily relatable to the signs of <italic>s<sub>i</sub></italic>. If we knew <italic>&#x03D5;</italic>(<italic>x</italic><sub>1</sub>) and <italic>&#x03D5;<sup>&#x2032;</sup></italic>(<italic>x</italic><sub>1</sub>), then we&#x0027;d be able to solve the equations for <italic>&#x03D5;</italic>(<italic>x<sub>i</sub></italic>) and <italic>K<sub>i</sub></italic> recursively upwards. In some cases, such as <xref ref-type="bibr" rid="c58">Slatkin [1973]</xref>, we can infer <italic>&#x03D5;</italic>(0) and <italic>&#x2202;<sub>x</sub>&#x03D5;</italic>(0) by spatial symmetry. In other cases, we are only given <italic>&#x03D5;</italic>(&#x2212;<italic>&#x221E;</italic>) and <italic>&#x03D5;</italic>(<italic>&#x221E;</italic>), and have to work inwards from the ends.</p>
</sec>
<sec id="s5c">
<label>B.3</label>
<title>Doing the integrals</title>
<p>An important ingredient in the above method is the integral (40), to which a method for solving the Korteweg-de Vries equation can be applied [<xref ref-type="bibr" rid="c47">NEQwiki, 2013</xref>]. Recall that <italic>V<sub>i</sub></italic>(<italic>&#x03D5;</italic>) &#x003D; <italic>s<sub>i</sub>&#x03D5;</italic><sup>2</sup>(1 &#x2212; 2<italic>&#x03D5;/</italic>3) &#x002B; <italic>K<sub>i</sub></italic>, with <italic>K<sub>i</sub></italic> &#x003D; <italic>V<sub>i</sub></italic>(0) chosen to match <italic>V</italic> at the boundaries; since we&#x2019;re just working within an interval with <italic>s</italic> constant, we can rescale space by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline81.gif"/></alternatives></inline-formula> so that <italic>s</italic> and <italic>&#x03C3;</italic> drop from the equation. We then want to integrate
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn7.gif"/></alternatives>
</disp-formula>
over a domain where <italic>V</italic> is always negative. Let <italic>&#x03D5;</italic><sup>2</sup>(1 &#x2212; 2<italic>&#x03D5;/</italic>3) &#x002B; <italic>K</italic> &#x003D; (<italic>&#x03B1; &#x2212; &#x03D5;</italic>)(<italic>&#x03D5; &#x2212; &#x03B2;</italic>)(<italic>&#x03D5; &#x2212; &#x03B3;</italic>), and change variables first to <italic>y</italic><sup>2</sup> &#x003D; (<italic>&#x03B1; &#x2212; &#x03D5;</italic>), and then to <inline-formula><alternatives><inline-graphic xlink:href="006940_inline82.gif"/></alternatives></inline-formula> so that
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn8.gif"/></alternatives>
</disp-formula>
with <italic>S</italic><sup>2</sup> &#x003D; (<italic>&#x03B1; &#x2212; &#x03B2;</italic>)/(<italic>&#x03B1; &#x2212; &#x03B3;</italic>). Now Jacobi&#x0027;s incomplete elliptic integral of the first kind is defined by
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn9.gif"/></alternatives>
</disp-formula>
and the Jacobian elliptic function sn(<italic>x</italic>; <italic>k</italic>) is the inverse: <italic>F</italic> (sn(<italic>x</italic>; <italic>k</italic>); <italic>k</italic>) &#x003D; <italic>x</italic>. As <italic>k &#x2192;</italic> 0, sn(<italic>x</italic>; <italic>k</italic>) <italic>&#x2192;</italic> sin(<italic>x</italic>), while as <italic>k &#x2192;</italic> 1, sn(<italic>x</italic>; <italic>k</italic>) <italic>&#x2192;</italic> sinh(<italic>x</italic>).</p>
</sec>
</sec>
<sec id="s6">
<label>C</label>
<title>Hitting and occupation</title>
<p>Consider a single migrant family <italic>Z</italic> beginning at <italic>x</italic>, and write <italic>S</italic> for the new patch, which has area <italic>A</italic> and is centered at <italic>y</italic>. Let <italic>B<sub>t</sub></italic> be a Brownian motion with variance <italic>&#x03C3;</italic><sup>2</sup>, and <italic>&#x03C4;<sub>&#x2020;</sub></italic> an independent Exponential(<italic>s<sub>m</sub></italic>) time. The mean occupation time of <italic>Z</italic> spent in a region <italic>S</italic> is, since the marginal distribution of a single lineage is Brownian,
<disp-formula id="eqn41">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn41.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn42">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn42.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn43">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn43.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn44">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn44.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn45">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn45.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="006940_inline70.gif"/></alternatives></inline-formula> gives probabilities for Brownian motion begun at <italic>x</italic> (i.e. <italic>B</italic><sub>0</sub> &#x003D; <italic>x</italic>), and likewise <inline-formula><alternatives><inline-graphic xlink:href="006940_inline71.gif"/></alternatives></inline-formula> If we define <italic>&#x03C4;S</italic> to be the hitting time of <italic>S</italic> by the Brownian motion <italic>B</italic>, and <italic>&#x00B5;S</italic> (<italic>x</italic>) to be the hitting distribution of <italic>&#x2202;S</italic> by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline72.gif"/></alternatives></inline-formula> by the strong Markov property this is equal to
<disp-formula id="eqn46">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn46.gif"/></alternatives>
</disp-formula>
where now <inline-formula><alternatives><inline-graphic xlink:href="006940_inline73.gif"/></alternatives></inline-formula> denotes expectations for Brownian motion for which the distribution of <italic>B</italic><sub>0</sub> is <italic>&#x00B5;</italic>, provided <italic>S</italic> is not pathological. If <italic>S</italic> is circular with area <italic>A</italic>, the latter expectation will not depend on <italic>x</italic>; call this <italic>g</italic>(<italic>A</italic>).</p>
<p>Now consider the chance that <italic>Z</italic> ever hits the new patch, which we call <italic>h</italic>(<italic>x, S</italic>). (In the main body, this was <italic>h<sub>A</sub></italic>(<italic>x, y</italic>), here modified to parallel <italic>u</italic>(<italic>x, S</italic>).) If we make the approximation that <italic>Z</italic> hits the new patch only if the trunk of <italic>Z</italic> does, and recall that 1 &#x2212; <italic>k<sub>e</sub></italic>(<italic>t</italic>) is the chance that <italic>Z</italic> survives for <italic>t</italic> generations, then this is equal to
<disp-formula id="eqn47">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn47.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn48">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn48.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn49">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn49.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn50">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn50.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn51">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn51.gif"/></alternatives>
</disp-formula></p>
<p>Therefore, we have that
<disp-formula id="eqn52">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn52.gif"/></alternatives>
</disp-formula>
If we let <inline-formula><alternatives><inline-graphic xlink:href="006940_inline74.gif"/></alternatives></inline-formula> be the total equilibrium occupation of <italic>S</italic>, then by equations (<xref rid="eqn9" ref-type="disp-formula">9</xref>) and (<xref rid="eqn10" ref-type="disp-formula">10</xref>),
<disp-formula id="eqn53">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn53.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn54">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn54.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn55">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn55.gif"/></alternatives>
</disp-formula></p>
<p>The function <italic>g</italic>(<italic>A</italic>) is the expected amount of time that a Brownian motion begun on the edge of a disk of area <italic>A</italic> is expected to spend inside the disk before <italic>&#x03C4;</italic><sub>&#x2020;</sub>. This is integral of the Green function for the Bessel process of the appropriate order, so using <xref ref-type="bibr" rid="c8">Borodin and Salminen [2002]</xref>, and letting <italic>w</italic> be the width of the patch, in <italic>d</italic> &#x003D; 1,
<disp-formula id="eqn56">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn56.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn57">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn57.gif"/></alternatives>
</disp-formula>
and in <italic>d</italic> &#x003D; 2, by <xref ref-type="bibr" rid="c24">Gradshteyn and Ryzhik [2007]</xref> 5.56.2,
<disp-formula id="eqn58">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn58.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn59">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn59.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn60">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn60.gif"/></alternatives>
</disp-formula></p>
<p>In either case, <italic>g</italic>(<italic>A</italic>) <italic>&#x2248;</italic> 1/(2<italic>s<sub>m</sub></italic>), which is the approximation we use in the main text.</p>
<sec id="s6a">
<label>C.1</label>
<title>The outflux of families</title>
<p>It is of interest to have an expression for the &#x201C;outflux of families&#x201D;, <italic>&#x03B3;</italic>(<italic>r</italic><sub>0</sub>), defined to be the mean proportion of <italic>B</italic> alleles at distance <italic>r</italic><sub>0</sub> whose lineage traces back to the original patch without venturing further away than <italic>r</italic><sub>0</sub>. By expression (9),
<disp-formula>
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_ueqn10.gif"/></alternatives>
</disp-formula>
for any <italic>y</italic>. Take <italic>y</italic> &#x003D; (<italic>r</italic>, 0). Note that after scaling by <inline-formula><alternatives><inline-graphic xlink:href="006940_inline75.gif"/></alternatives></inline-formula>
<disp-formula id="eqn61">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn61.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn62">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn62.gif"/></alternatives>
</disp-formula>
Now let <italic>x</italic> &#x003D; (<italic>r</italic><sub>0</sub> cos <italic>&#x03B8;, r</italic><sub>0</sub> sin <italic>&#x03B8;</italic>), so that the expression in the exponent is to, first order in 1<italic>/r</italic>,
<disp-formula id="eqn63">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn63.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn64">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn64.gif"/></alternatives>
</disp-formula></p>
<p>This implies that, still with <italic>r</italic>, <italic>r</italic><sub>0</sub>, and <italic>&#x03B8;</italic> defined as above,
<disp-formula id="eqn65">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn65.gif"/></alternatives>
</disp-formula>
In one dimension we are done. In two dimensions, by bounded convergence and <xref ref-type="bibr" rid="c24">Gradshteyn and Ryzhik [2007]</xref> (3.339),
<disp-formula id="eqn66">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn66.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn67">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn67.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn68">
<alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="006940_eqn68.gif"/></alternatives>
</disp-formula>
where <italic>I</italic><sub>0</sub> is a modified Bessel function of order zero of the first kind. The effect of the scaling is to express</p>
<p><italic>r</italic><sub>0</sub> in natural units, i.e. changing the result to <inline-formula><alternatives><inline-graphic xlink:href="006940_inline76.gif"/></alternatives></inline-formula></p>
</sec>
</sec>
</back>
</article>