<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/171561</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Mechanistic hierarchical population model identifies latent causes of cell-to-cell variability</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3680-0627</contrib-id>
<name><surname>Loos</surname><given-names>Carolin</given-names></name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7974-1658</contrib-id>
<name><surname>Moeller</surname><given-names>Katharina</given-names></name>
<xref ref-type="aff" rid="a3">c</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5360-4292</contrib-id>
<name><surname>Fr&#x00F6;hlich</surname><given-names>Fabian</given-names></name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4147-9308</contrib-id>
<name><surname>Hucho</surname><given-names>Tim</given-names></name>
<xref ref-type="aff" rid="a3">c</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4935-3312</contrib-id>
<name><surname>Hasenauer</surname><given-names>Jan</given-names></name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="author-notes" rid="n2">2</xref>
</contrib>
<aff id="a1"><label>a</label><institution>Helmholtz Zentrum M&#x00FC;nchen-German Research Center for Environmental Health, Institute of Computational Biology</institution>, 85764 Neuherberg, <country>Germany</country>;</aff>
<aff id="a2"><label>b</label><institution>Technische Universit&#x00E4;t M&#x00FC;nchen, Center for Mathematics, Chair of Mathematical Modeling of Biological Systems</institution>, 85748 Garching, <country>Germany</country>;</aff>
<aff id="a3"><label>c</label><institution>Division of Experimental Anesthesiology and Pain Research, Department of Anesthesiology and Intensive Care Medicine, University Hospital Cologne</institution>, 50937 Cologne, <country>Germany</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>1</label> <p>C.L. and K.M. contributed equally to this work.</p></fn>
<fn id="n2" fn-type="other"><label>2</label> <p>Lead contact, e-mail: <email>jan.hasenauer@helmholtz-muenchen.de</email>.</p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>171561</elocation-id>
<history>
<date date-type="received">
<day>02</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>02</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>02</day>
<month>8</month>
<year>2017</year>
</date>
</history><permissions><copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions>
<self-uri xlink:href="171561.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Summary</title>
<p>All biological systems exhibit cell-to-cell variability, and this variability often has functional implications. To gain a thorough understanding of biological processes, the latent causes and underlying mechanisms of this variability must be elucidated. Cell populations comprising multiple distinct subpopulations are commonplace in biology, yet no current methods allow the sources of variability between and within individual subpopulations to be identified. This limits the analysis of single-cell data, for example provided by flow cytometry and microscopy. In this study, we present a data-driven modeling framework for the analysis of populations comprising heterogeneous subpopulations. Our approach combines mixture modeling with frameworks for distribution approximation, facilitating the integration of multiple single-cell datasets and the detection of causal differences between and within subpopulations. The computational efficiency of our framework allows hundreds of competing hypotheses to be compared, giving unprecedented depth of a study. We demonstrated the ability of our method to capture multiple levels of heterogeneity in the analyzes of simulated data and data from highly heterogeneous sensory neurons involved in pain initiation. Our approach identified the sources of cell-to-cell variability and revealed mechanisms that underlie the modulation of nerve growth factor-induced Erk1/2 signaling by extracellular scaffolds.</p>
<sec>
<title>Highlights</title>
<list list-type="bullet">
<list-item>
<p>Mechanistic model for populations consisting of multiple heterogeneous subpopulations</p></list-item>
<list-item>
<p>Scalable parameter estimation and model selection using multivariate single-cell data</p></list-item>
<list-item>
<p>Study of pain sensitization in primary sensory neurons</p></list-item>
<list-item>
<p>Proof of principle for fitting of mechanistic model with single-cell data</p></list-item>
</list>
</sec>
</abstract>
<counts>
<page-count count="40"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Cellular heterogeneity is a common phenomenon in biological processes (<xref ref-type="bibr" rid="c10">Elsasser, 1984</xref>; <xref ref-type="bibr" rid="c7">De Vargas Roditi and Claassen, 2015</xref>). Even isogenic cells of the same cell-type may respond differently to identical stimuli (<xref ref-type="bibr" rid="c45">Tay et al., 2010</xref>). This cellular heterogeneity is critical for cellular decision making and the formation of complex organisms (<xref ref-type="bibr" rid="c4">Bal&#x00E1;zsi et al., 2011</xref>). It is also a cause of failure in treatments of cancer, pain, and a wide range of common diseases (<xref ref-type="bibr" rid="c49">Willyard, 2016</xref>). Many studies have attempted to gain a deeper understanding of cell-to-cell variability (<xref ref-type="bibr" rid="c41">Rubin, 1990</xref>), and recently even a large-scale initiative was found to investigate this heterogeneity (<xref ref-type="bibr" rid="c38">Regev et al., 2017</xref>).</p>
<p>Experimentally, most common approaches use methods giving single-cell resolution, such as microscopy (<xref ref-type="bibr" rid="c44">Schroeder, 2011</xref>), flow and mass cytometry (<xref ref-type="bibr" rid="c34">Pyne et al., 2009</xref>), and single-cell RNA sequencing (<xref ref-type="bibr" rid="c23">Islam et al., 2014</xref>). These techniques yield increasing amounts of data, which are commonly analyzed using powerful statistical techniques. Unfortunately, these are unable to identify causalities and latent causes, or to reconstruct the governing equations of the process (see e.g., <xref ref-type="bibr" rid="c33">Moignard et al. (2013)</xref>). Improved methods of data analysis are therefore required. We propose a model-based analysis framework for systems exhibiting cell-to-cell variability at different levels:</p>
<list list-type="bullet">
<list-item>
<p>differences between cell-types or cellular subpopulations, for example, caused by the cellular microenvironment (<xref ref-type="bibr" rid="c8">Ebinger et al., 2016</xref>) or stable epigenetic markers established during cell differentiation (<xref ref-type="bibr" rid="c39">Reik, 2007</xref>), and</p></list-item>
<list-item>
<p>differences between cells of the same cell population that arise, for example, from differences in the cell state (<xref ref-type="bibr" rid="c6">Buettner et al., 2015</xref>) or from intrinsic stochastic fluctuations (<xref ref-type="bibr" rid="c9">Elowitz et al., 2002</xref>).</p></list-item></list>
<p>In the case of homogeneous cell populations, the reaction rate equations (RREs) provide a description of the population behavior in the form of ordinary differential equations (ODEs) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Stochastic fluctuations or latent differences between cells result in cell-to-cell variability and a distribution of cell states (<xref ref-type="bibr" rid="c16">Hasenauer et al., 2011</xref>; <xref ref-type="bibr" rid="c51">Zechner et al., 2012</xref>; <xref ref-type="bibr" rid="c50">Yao et al., 2016</xref>; <xref ref-type="bibr" rid="c12">Filippi et al., 2016</xref>) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The statistical moments of this distribution are described by moment-closure approximation equations (<xref ref-type="bibr" rid="c11">Engblom, 2006</xref>) and system size expansions (<xref ref-type="bibr" rid="c47">van Kampen, 2007</xref>; <xref ref-type="bibr" rid="c13">Fr&#x00F6;hlich et al., 2016</xref>). These methods provide scalable approximations for a range of processes in which variability arises from different sources, the approximation might be cure, e.g. even negative variances might be predicted(<xref ref-type="bibr" rid="c43">Schnoerr et al., 2014</xref>). Additionally, they fail to provide an accurate description of the population heterogeneity when subpopulations are present and cannot be used to study the causal differences between cells and subpopulations.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption>
<p>Cell populations exhibiting different levels of heterogeneity. Properties of cells, e.g., receptor levels or reaction rates, indicated by different gray shades for individual cells, can be (<italic>A</italic>) homogeneous: the property is the same for the entire cell population; (<italic>B</italic>) cell-to-cell variable: the property has a unimodal distribution across the cells; (<italic>C</italic>) subpopulation variable: the population can be separated into subpopulations, but within each subpopulation, the property does not vary; (<italic>D</italic>) inter- and intra-subpopulation variable: the property splits the population into subpopulations and also varies between cells within a subpopulation.</p>
</caption>
<graphic xlink:href="171561_fig1.tif"/>
</fig>
<p>To address parameter differences between cell population, <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref> introduced a method that combines mixture modeling and mechanistic RRE modeling of the subpopulation means (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Cell-to-cell variability within a subpopulation is treated naively as an additional parameter that is to be estimated. Thus, the method assumes that the subpopulations are homogeneous and no mechanistic description of cell-to-cell variability within a subpopulation is possible. Moreover, the extant method can only be applied to one-dimensional measurements. When multivariate measurements are used, only marginal distributions can be analyzed and correlations between measurements are neglected, which may result in a substantial loss of information (<xref ref-type="bibr" rid="c1">Altschuler and Wu, 2010</xref>; <xref ref-type="bibr" rid="c5">Buchholz et al., 2013</xref>).</p>
<p>In this study, we introduced a non-trivial combination of mixture models that is able to capture subpopulation structures and models for individual subpopulations that account for differences between individual cells (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The approach therefore covers several levels of heterogeneity simultaneously (<xref ref-type="fig" rid="fig1">Figure 1A-D</xref>). This was not possible using the afore-mentioned approaches, which are all special cases of our model. The means and covariances of the observed species in each subpopulation are linked to a mixture distribution, allowing the entire cell population to be described and providing a mechanistic description of inter- and intra-subpopulation variability. We used the sigma-point approximation (<xref ref-type="bibr" rid="c46">van der Merwe, 2004</xref>), a scalable approach allowing for the analysis of large models, to capture the distribution of cell properties within a subpopulation. Similarly, our framework is able to exploit moment equations and system size expansion for the description of individual subpopulations. In contrast with previous work in (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>), the proposed framework can fully leverage the correlation information in multivariate data, rendering a better conditioned problem and improving identifiability.</p>
<p>We applied this framework to study signal transduction in the extracellular-signal regulated kinase (Erk) pathway, a signaling cascade that is involved in a range of biological processes. Our specific focus was on the pain sensitization of primary sensory neurons in response to nerve growth factor (NGF) stimulation (<xref ref-type="bibr" rid="c21">Hucho and Levine, 2007</xref>; <xref ref-type="bibr" rid="c24">Ji et al., 2009</xref>; <xref ref-type="bibr" rid="c3">Andres et al., 2012</xref>). These neurons encounter a broad range of extracellular environments, including various extracellular scaffolds, and are highly heterogeneous. Performing single-cell microscopy experiments (<xref ref-type="bibr" rid="c2">Andres et al., 2010</xref>; <xref ref-type="bibr" rid="c22">Isensee et al., 2014</xref>), we investigated the influence of extracellular scaffolds on the response of individual subpopulations. Our computational framework was demonstrated to capture several levels of heterogeneity, including differences between subpopulations as well as differences between cells within a single subpopulation. Our findings suggest that extracellular scaffold structures play a crucial role in pain sensitization signaling and that several underlying mechanistic changes are involved in this.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Mechanistic hierarchical population model for single-cell data</title>
<p>We considered populations comprising heterogeneous subpopulations. To allow coverage of multiple levels of heterogeneity, we linked a mixture distribution <italic>&#x03D5;</italic> to a mechanistic model of the means and covariances of individual subpopulations. The distribution of the parameters, e.g., initial conditions or kinetic rates, produces a distribution of cell states and observables (<xref ref-type="fig" rid="fig2">Figure 2A-B</xref>). This distribution can be simulated using Monte Carlo methods by drawing parameters from the parameter distribution and simulating the single-cell model. Since this approach is computationally demanding, we approximated the distribution of parameters, states, and observables using finite mixture distributions. The components of the mixture describe the individual subpopulations.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption>
<p>Illustration of the dynamics of a heterogeneous cell population and the mechanistic hierarchical population model. (A) Parameter distribution of a cell population consisting of two subpopulations. The contour lines illustrate the (approximated) parameter density of the cell-to-cell variable parameter 1 and the inter-and intra-subpopulation variable parameters 2. The heterogeneity of parameters is propagated from the latent parameter space to the observed measurement space. (B) Heterogeneity in parameters yields heterogeneous observables <bold>y</bold> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>)<sup><italic>T</italic></sup> that separate into two subpopulations after stimulation at time point <italic>t</italic><sub>0</sub>. (C) Structure of the singlecell system and approximation by the hierarchical population model using plate notation. Squares indicate fixed parameters, whereas circles indicate random variables. Gray shading of the circles/squares indicates a known value, whereas the other values are latent. The upper plate illustrates the variables associated with a cell <italic>j</italic>. Each of the <italic>n<sub>j</sub></italic> cells has parameters <italic>&#x03C8;<sup>j</sup></italic> drawn from a distribution defined by <italic><bold>&#x03BE;</bold><sub>s</sub></italic> and <bold>w</bold>. The states of the species <bold>x</bold><sup><italic>j</italic></sup>, resulting from the single-cell dynamics, yield the observables <bold>&#x0079;&#x0304;</bold><sup><italic>j</italic></sup>, additionally influenced by measurement noise <bold>&#x0393;</bold>. The bottom plate visualizes the statistics of the corresponding cells of a subpopulation. For each subpopulation, the subpopulation parameters <italic><bold>&#x03BE;</bold><sub>s</sub></italic> are mapped to the means and covariances of the species of a subpopulation <bold>z</bold><sub><italic>s</italic></sub>, which then are mapped to the distribution parameters <italic>&#x03C6;<sub>s</sub></italic>. The observables at the population level are considered to be distributed according to <xref ref-type="disp-formula" rid="eqn2">(2)</xref>.</p>
</caption>
<graphic xlink:href="171561_fig2.tif"/>
</fig>
<p>Each cell <italic>j</italic> has cellular properties encoded in the parameter vector <italic>&#x03C8;<sup>j</sup></italic>. In the hierarchical framework (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), these parameters are considered to be drawn from a mixture distribution, as follows:
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn1.gif"/></alternatives>
</disp-formula>
with subpopulation weight <italic>w<sub>s</sub></italic>, mean <italic><bold>&#x03B2;</bold><sub>s</sub></italic> and covariance <bold>D</bold><sub><italic>s</italic></sub> for subpopulation <italic>s</italic> = 1,&#x2026;, <italic>N</italic>. The subpopulation parameters <italic><bold>&#x03BE;</bold><sub>s</sub></italic> = (<italic><bold>&#x03B2;</bold><sub>s</sub></italic>, <italic><bold>D</bold><sub>s</sub></italic>) classify the variability of a property <italic>&#x03C8;<sub>i</sub></italic> as follows:
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn2.gif"/></alternatives>
</disp-formula></p>
<p>The temporal evolution of the statistical properties of the cells of a subpopulation, including the mean and covariance, are computed using scalable methods. System size expansions and moment equations (<xref ref-type="bibr" rid="c47">van Kampen, 2007</xref>; <xref ref-type="bibr" rid="c11">Engblom, 2006</xref>) are used to describe stochastic single-cell dynamics, whereas sigmapoints (<xref ref-type="bibr" rid="c46">van der Merwe, 2004</xref>) are used otherwise. These approaches yield an ODE model of the statistical moments, comprising the means and covariances <bold>z</bold><sub><italic>s</italic></sub> = (<bold>m</bold><sub><italic>s</italic></sub>, <bold>C</bold><sub><italic>s</italic></sub>)<sup><italic>T</italic></sup> of species <bold>x</bold>. The model is simulated for each of the <italic>N</italic> subpopulations
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="171561_eqn1.gif"/></alternatives>
</disp-formula>
with initial conditions <bold>z</bold><sub>0</sub> and experimental condition <italic>u</italic>. The moments of the species in a subpopulation are then mapped to the distribution parameters <italic>&#x03C6;<sub>s</sub></italic> = <italic>h</italic> (<bold>z</bold><sub><italic>s</italic></sub>, <italic><bold>&#x03BE;</bold><sub>s</sub></italic>, <italic>u</italic>) of the distribution <italic>&#x03D5;</italic>, including measurement noise <bold>&#x0393;</bold>, which is assumed to be the same for all subpopulations. The observables, the quantities of the biological system that can be measured experimentally, are assumed to have the distribution
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="171561_eqn2.gif"/></alternatives>
</disp-formula>
at the population level. In this study, we used mixtures of multivariate log-normal distributions, yielding <italic>&#x03C6;<sub>s</sub></italic> = (<italic><bold>&#x03BC;</bold><sub>s</sub></italic>, <bold>&#x03A3;</bold><sub><italic>s</italic></sub>). The sigma-point approximation (detailed in supplementary Information) provides time-dependent moments of the system defined in <xref ref-type="disp-formula" rid="eqn1">(1)</xref> and accounts for cell-to-cell variability. When combined with subpopulation variability, this yields both the inter- and intra-subpopulation variability. For a comparison of our approach to existing methods, we refer to the supplementary Information.</p>
</sec>
<sec id="s2b">
<title>Parameter estimation and model selection</title>
<p>The parameters of biochemical processes, the sources of cell-to-cell and subpopulation variability, and the precise network structure are in general unknown. We therefore calibrated the hierarchical population model using single-cell snapshot data <bold>&#x0079;&#x0304;</bold><sup><italic>e</italic>,<italic>k</italic>,<italic>j</italic></sup> with cell <italic>j</italic> measured at time point <italic>t<sub>k</sub></italic> under experimental condition <italic>u<sub>e</sub></italic>, for example, representing a drug dosage. The parameters <bold><italic>&#x03B8;</italic></bold> &#x2208; &#x0211D;<sup><italic>n<sub>&#x03B8;</sub></italic></sup> usually comprise characteristics of a subpopulation (e.g., the means and covariances of the parameter distributions), subpopulation sizes and measurement noise. Maximum likelihood estimation was used to derive these parameters from the data. The maximum likelihood estimate <bold><italic>&#x03B8;&#x0302;</italic></bold> was obtained by solving the following optimization problem:
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn3.gif"/></alternatives>
</disp-formula></p>
<p>The likelihood function &#x1d4db; incorporates all cells, time points, and experimental conditions. For efficient parameter estimation, we performed multi-start local optimization with a robust evaluation scheme for the log-likelihood function and its gradient. The gradient of the log-likelihood function with respect to the parameters was computed using forward sensitivity analysis (see (<xref ref-type="bibr" rid="c36">Raue et al., 2009</xref>; <xref ref-type="bibr" rid="c30">Loos et al., 2016</xref>) and supplementary Information).</p>
<p>To infer the subpopulation structure, the difference between subpopulations, the variability within subpopulations, and the influence of the experimental condition, a collection of hierarchical models is formulated. We compare these models and the corresponding hypotheses using the Bayesian Information Criterion (BIC) (<xref ref-type="bibr" rid="c35">Raftery, 1999</xref>).</p>
<p>The hierarchical models were implemented in the MATLAB toolbox, incorporating efficient simulations for the individual subpopulations. While any simulation that provides means and covariances of the subpopulations can be employed, in this study, we used the sigma-point approximation. This approach accounts for cell-to-cell variability, which is manifested in the parameters (see supplementary Information for more details).</p>
</sec>
<sec id="s2c">
<title>Unraveling sources of heterogeneity</title>
<p>To demonstrate the advantages of the hierarchical population model, which incorporates a mechanistic description of the means and variances, over the method proposed by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref>, we applied our approach to simulated data on a simple conversion process. Such conversions are common in biological systems, for example, in phosphorylation. The conversion process comprised two species A and B, with cell-to-cell variable conversions from B to A (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), corresponding to different levels of phosphatase in the cells. Two subpopulations were assumed with different responses to stimulus <italic>u</italic>. This produced subpopulations with different rates of stimulus-dependent conversion from A to B. Artificial measurement noise was added to allow the capability of the framework to distinguish measurement noise from biological variability to be assessed. We assumed the underlying subpopulation structure, i.e., the subpopulation variability of <italic>k</italic><sub>1</sub>, to be known (detailed in supplementary Information).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption>
<p>Inference of cell-to-cell variability using mechanistic models. (A) Model of a conversion between two species <italic>A</italic> and <italic>B</italic> comprising two subpopulations differing in their response to stimulus <italic>u</italic>. Different colors indicate the variability of the reaction rates. (B) Model selection with the Bayesian Information Criterion (BIC). The first three models use RREs according to (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>) and vary in the number of additional parameters (1, 2, and 10) for the variances of the mixture distribution. The last models use the mean and variance obtained by sigma-points and differ in their sources of heterogeneity. (C) Data on the conversion process (1000 cells per time point) and fit corresponding to the best and true underlying model. (D) Confidence intervals for the variability of <italic>k</italic><sub>3</sub> and the measurement noise (<italic>&#x03C3;</italic><sub>noise</sub>). Horizontal bars show the confidence intervals corresponding to the 80&#x0025;, 90&#x0025;, 95&#x0025;, and 99&#x0025; confidence levels, and the vertical lines the maximum likelihood estimates (MLE).</p>
</caption>
<graphic xlink:href="171561_fig3.tif"/>
</fig>
<p>The simulated data were analyzed using (i) the approach introduced by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref> which describes the subpopulations using RREs and (ii) the proposed approach using hierarchical single-cell analysis. The first approach does not model the temporal evolution of the variance, requiring different parameterizations to be compared, i.e., constant, time-dependent, and time/subpopulation-dependent variability. Model selection with the BIC indicates that different parameters for each subpopulation at every time point are required to be used to describe the data (<xref ref-type="fig" rid="fig3">Figures 3B</xref> and <xref ref-type="fig" rid="figS1">S1</xref>). This demonstrates that the observed cell-to-cell variability changes over time but provides no information about the sources of the observed cell-to-cell variability.</p>
<p>The mechanistic modeling of multiple levels of heterogeneity facilitates the identification of its causal source via model selection. We considered a range of hypotheses and performed model selection using BIC (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Given the subpopulation structure, the additional source of heterogeneity, namely, the conversion from B to A, was correctly identified using the BIC and the corresponding model provided a good fit to the data (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The BICs for most of the hierarchical models were substantially lower than that of the best model that incorporates only the mean. This confirms that a mechanistic description of the variability is more appropriate.</p>
<p>We analyzed the ability of the hierarchical model to identify the different contributions of cell-to-cell variability and measurement noise, as both are normally present in single-cell experiments. The uncertainty analysis suggested that the hierarchical modeling approach was able to distinguish between the two (<xref ref-type="fig" rid="fig3">Figure 3D</xref>).</p>
<p>This example shows how the hierarchical population model outperforms the variants of models presented by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref>. We confirmed the power of the proposed approach by studying a model of stochastic gene expression (<xref ref-type="fig" rid="figS6">Figure S6</xref>) and comparing the approach to the method by <xref ref-type="bibr" rid="c51">Zechner et al. (2012)</xref> (see supplementary Information). Our model employs a mechanistic description of the variability, thereby enabling a more detailed insight into the heterogeneity of the population and reducing the number of parameters that need to be estimated from the data.</p>
</sec>
<sec id="s2d">
<title>Identification of differential protein expression using multivariate data</title>
<p>Many single-cell technologies provide multivariate measurements and therefore convey information about the correlations between the observables. To incorporate this, we extended our hierarchical modeling framework to multivariate data and demonstrated its capability to reconstruct the differential protein expression of cellular subpopulations (<xref ref-type="bibr" rid="c42">Sauvageau et al., 1994</xref>; <xref ref-type="bibr" rid="c26">Kharchenko et al., 2014</xref>) using simulated data. We considered a model describing the abundance of two proteins, the expression of which is regulated by stimulus <italic>u</italic> (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The influence of <italic>u</italic> varies between cell populations and is therefore able to capture, e.g., different levels of membrane receptors. We generated multivariate data by simulating a single-cell model (see supplementary Information for more details).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption>
<p>Reconstruction of differential protein expression in heterogeneous populations using multivariate data. (A) Model of differentially expressed proteins A and B. (B) Upper row: data points (1000 cells per time point) and kernel density estimation. Lower row: data points and model for the full distribution. (C,D) Confidence intervals for the parameters of the model using (C) the full distribution and (D) the marginal distributions. Horizontal bars show the confidence intervals corresponding to the 80&#x0025;, 90&#x0025;, 95&#x0025;, and 99&#x0025; confidence levels. The vertical lines show the MLE.</p>
</caption>
<graphic xlink:href="171561_fig4.tif"/>
</fig>
<p>An analysis using our hierarchical approach confirmed the ability of the proposed model to reproduce the data (<xref ref-type="fig" rid="fig4">Figure 4B</xref>) and to provide reliable parameter estimates (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Such multivariate data cannot be exploited by the existing model-based approaches. When the temporal evolution of proteins is measured individually, the correlation information is missing and a symmetry arises in the system (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). This is reflected in the multimodal profiles of the parameters &#x03BB;<sub>B,1</sub> and &#x03BB;<sub>B,2</sub>, indicating a lack of practical identifiability.</p>
<p>Our framework exploits the correlation structures of multivariate data, which in this simulation example allowed us to conclude that each subpopulation had a high expression of only a single protein. This only becomes possible when the correlations are analyzed.</p>
</sec>
<sec id="s2e">
<title>Modeling signal transduction in neuronal populations</title>
<p>We applied the hierarchical modeling approach to investigate the influence of an extracellular scaffold on NGF-induced Erk1/2 activation in cultures of adult sensory neurons (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). This was done by monitoring the rates of NGF-mediated Erk1/2 phosphorylation in dissociated cultures of the primary sensory neurons of rat dorsal root ganglia. NGF-mediated Erk1/2 signaling has been shown to play a crucial role in nociceptor sensitization in thermal and mechanical hyperalgesia (<xref ref-type="bibr" rid="c52">Zhuang et al., 2004</xref>; <xref ref-type="bibr" rid="c32">Malik-Hall et al., 2005</xref>). Primary sensory neurons form a heterogeneous population, from which, upon NGF stimulation, a subpopulation reacts with a graded Erk1/2 phosphorylation response. Previous models have attempted to approximate this by assuming the existence of responders and non-responders with differing levels of the NGF receptor TrkA (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>). In the current study, we refined this substantially by modeling the overall population using two heterogeneous subpopulations that differed in their average response. To calibrate this refined model, we collected quantitative single-cell microscopy data on NGF-induced Erk1/2 phosphorylation kinetics and dose response curves using immunofluorescence labeling of pErk1/2 alone, co-labeled with Erk1/2 and TrkA antibodies (see supplementary Information for more details).</p>
<p>Our analysis used the ODE model introduced in (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>). This has six structurally identifiable parameters <italic>k</italic><sub>1</sub>, <italic>k</italic><sub>2</sub>, <italic>k</italic><sub>4</sub>, <italic>k</italic><sub>5</sub>, <italic>k</italic><sub>3</sub>[TrkA]<sub>0</sub> and <italic>c</italic>[Erk]<sub>0</sub>. Based on the experimental observations, we assumed cell-to-cell variability in relative Erk1/2 expression and in cellular TrkA activity.</p>
</sec>
<sec id="s2f">
<title>Causal differences between neuron subpopulations</title>
<p>To study the differences between responders and non-responders, we used experimental kinetic and dose response data from sensory neurons cultured on the adherence substrate poly-D-lysine (PDL). We fitted 64 models accounting for all combinations of the six potential differences between subpopulations, which was only feasible due to the computational efficiency of our approach. Our assessment of the importance of individual differences between the subpopulations using a BIC-based ranking scheme suggested that cellular TrkA activity (<italic>k</italic><sub>3</sub>[TrkA]<sub>0</sub>) made the greatest contribution (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). This was indicated by a high BIC weight, which captures differences by Bayesian model averaging (see supplementary Information for more details), and the substantially better mean rank of the models using differences in cellular TrkA activity compared with those using other differences. The additional subpopulation variability of TrkA expression levels was also confirmed experimentally in the cultures (<xref ref-type="fig" rid="fig5">Figure 5D</xref>) and use of this difference alone produced an excellent fit to the experimental data (<xref ref-type="fig" rid="fig5">Figures 5C</xref> and <xref ref-type="fig" rid="figS4">S4</xref>). The following potential differences are the relative Erk1/2 expression levels (<italic>c</italic>[Erk]<sub>0</sub>) and the dephosphorylation rate (<italic>k</italic><sub>5</sub>). However, our experimental data showed no statistically significant difference in total Erk1/2 levels between responders and non-responders (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). To assess the relevance of the dephosphorylation rate and thus the corresponding phosphatase activity we performed experiments in which we monitored the pErk1/2 decline dynamics after inhibiting the mitogen-activated protein kinase (Mek) that phosphorylates Erk1/2. If the phosphatase activity does vary, we would expect to observe different equilibration dynamics. However, this could not be confirmed (<xref ref-type="fig" rid="fig5">Figures 5F</xref> and <xref ref-type="fig" rid="figS3">S3</xref>). This demonstrated that the hierarchical approach provided an appropriate ranking of differences and suggested that the total TrkA levels differed between subpopulations.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption>
<p>Detecting the sources of heterogeneity between subpopulations in primary sensory neurons. (A) Pathway model of NGF-induced Erk signaling. (B) Ranking according to the BIC values for the 64 hierarchical models, in which the colored dots indicate those parameters that are assumed to differ between the subpopulations. The importance of the differences is ranked according to the BIC weights. The black circles indicate the mean rank of the models including the corresponding difference. (C) Data and fit for measurements of pErk1/2 levels (approximately 1400 cells per time point and 4300 cells per dosage) and multivariate measurements of pErk/TrkA and pErk/Erk levels (approximately 3000 cells per dosage) measured for 60 min under NGF stimulation with indicated concentrations. The measured values are in arbitrary units of intensity. For the multivariate data, the contour lines of the kernel density estimation of the data and the level sets of the density of the hierarchical model are shown. Mean and standard deviation of (D) TrkA levels (<italic>n<sub>r</sub></italic> = 4 replicates) (E) Erk1/2 levels (<italic>n<sub>r</sub></italic> = 4) and (F) Erk1/2 dephosphorylation (<italic>n<sub>r</sub></italic> = 4) of non-responsive (pErk-) and responsive (pErk&#x002B;) sensory neurons after NGF stimulation with varying concentrations (as indicated in (C) for 60 min).</p>
</caption>
<graphic xlink:href="171561_fig5.tif"/>
</fig>
</sec>
<sec id="s2g">
<title>Influence of extracellular scaffolds on sensitization signaling</title>
<p>It is well established that during painful conditions, a plethora of different soluble molecules in the extracellular space, including cytokines, neurotrophins, and neuropeptides, induce nociceptor sensitization (<xref ref-type="bibr" rid="c21">Hucho and Levine, 2007</xref>). It is also known that the extracellular scaffolding structures, namely extracellular matrix molecules, are often highly altered in painful conditions such as wounds or tumors. However, much less is known about the role of cell scaffolds in sensitization of nociceptive neurons. We therefore compared the modification of NGF-induced sensitization signaling of sensory neurons by collagen type I (Col I), a classical extracellular matrix protein that forms receptor-matrix interactions, and by poly-D-lysine (PDL), a neutral scaffolding that promotes cell adherence by electrostatic interaction. We determined the kinetics and dose response curves of NGF-induced Erk1/2 phosphorylation in sensory neurons cultured overnight on Col I or PDL (see supplementary Information for more details). It was found that the mean Erk1/2 activation was approximately 17&#x0025; higher in Col I compared to PDL after NGF treatment (<xref ref-type="fig" rid="fig6">Figure 6A</xref> for pErk1/2 dose responses and <xref ref-type="fig" rid="figS5">Figure S5A</xref> for the other datasets). In addition to showing increased NGF-induced Erk1/2 activation, the number of cells was observed to be 1.5 times lower in the collagen cultures than in the polylysine cultures. These observations raised questions about the source of the measured increase in mean NGF-mediated Erk1/2 activation. We considered two hypotheses: (i) the increase results from a biological action of the different scaffolds onto the neurons and (ii) the increase reflects a shift of the subpopulation sizes arising from a nonrandom loss of parts of the high-responder subpopulation due to reduced cell adherence in the collagen cultures. To unravel the causal differences between the primary sensory neurons cultured on PDL and on Col I, we applied 128 hierarchical models using the previously derived subpopulation structure. These models considered all combinations of differences between the cell population on different scaffolds, including the size of subpopulations. The model for each adherence substrate accounted for the cell-to-cell variability of Erk1/2 and the inter- and intra-subpopulation variability of cellular TrkA activity. The model ranked first by the BIC (<xref ref-type="fig" rid="fig6">Figures 6B</xref>) gave a good fit to the data and took account of differences in Erk1/2 expression (<italic>c</italic>[Erk]<sub>0</sub>), Erk1/2 dephoshorylation (<italic>k</italic><sub>5</sub>), and cellular TrkA activity (<italic>k</italic><sub>3</sub>[TrkA]<sub>0</sub>) (<xref ref-type="fig" rid="fig6">Figures 6C-D</xref> and <xref ref-type="fig" rid="figS5">S5B-D</xref>). These differences were assumed to explain the higher response on Col I, and therefore supported hypothesis (i). The model that assumed no difference between the extracellular scaffolds (rank 128) or changes only in the relative size of the subpopulations (rank 127) performed worst, indicating that hypothesis (ii) failed to explain the data. The differences in relative TrkA and Erk1/2 expression levels were also observed experimentally (<xref ref-type="fig" rid="fig6">Figures 6D-E</xref>). These results confirmed the model-based analysis and suggested an impact of the classical extracellular matrix protein collagen I on protein expression.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption>
<p>Differences in NGF-induced Erk1/2 phosphorylation mediated by different extracellular scaffolds. Primary sensory neurons were provided with the two different scaffolds poly-D-lysine (PDL) and collagen type I (Col I) in an overnight culture. (A) Sensory neurons grown on the Col I substrate showed a significantly higher mean phospho-Erk1/2 response to indicated doses of NGF after 1h of stimulation. Means and standard deviations of four replicates are shown. (B) BIC-based ranking for the potential differences between culture conditions. The colored dots indicate which parameters are assumed to differ between the extracellular scaffolds. (C) Experimental data and fit for measurements of pErk1/2 distributions from Col I (approximately 2300 cells per dosage) and PDL (approximately 4300 cells per dosage) cultured neurons after treatment with indicated NGF concentrations for 1 h. (D) Marginal levels for TrkA and Erk1/2, which were assumed to be constant over varying doses and time (approximately 2000 cells in Col I and 2900 in PDL). Mean and standard deviation of (E) TrkA and (F) Erk1/2 levels of NGF dose response curve data, which showed significant elevations in Col I treated neurons. For this calculation, 24 samples were used (4 replicates for 6 doses).</p>
</caption>
<graphic xlink:href="171561_fig6.tif"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Elucidating the causes of cellular heterogeneity is a challenging task in systems biology and requires appropriate mechanistic models for use with single-cell data. In this study, we proposed a hierarchical modeling framework that for the first time allowed different levels of heterogeneity to be investigated, including subpopulation structures and cell-to-cell variability within subpopulations. It also provides mechanistic insights. Beyond cell-to-cell variability, the method accounts for measurement noise and is able to deconvolute these sources.</p>
<p>This modeling approach unifies available description frameworks (<xref ref-type="bibr" rid="c51">Zechner et al., 2012</xref>; <xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>) and exploits efficient simulation methods for cellular subpopulations. We focused on the cell-to-cell variability encoded in parameter values (<xref ref-type="bibr" rid="c27">Koeppl et al., 2012</xref>) and used sigma-point approximation to determine the subpopulation means and variances. To address variability arising from stochastic fluctuations, moment equations (<xref ref-type="fig" rid="figS6">Figure S6</xref>) and other methods, including the system size expansion (<xref ref-type="bibr" rid="c13">Fr&#x00F6;hlich et al., 2016</xref>), can be used. The proposed method facilitates the integration and simultaneous analysis of multiple datasets, without requiring complex pre-processing of the data (<xref ref-type="bibr" rid="c29">Lee et al., 2011</xref>). The modeling approach is implemented in the open-source MATLAB Toolbox ODEMM which is available on GitHub and ready to be reused by the community.</p>
<p>Differences between cell types can be analyzed and modeled in the same manner as differences between cellular subgroups. The method is also able to handle more than two subpopulations, and the number of subpopulations might even be inferred using a data-driven approach.</p>
<p>To demonstrate and evaluate the method, we collected a comprehensive dataset on NGF-induced Erk1/2 signaling in primary sensory neurons, a challenging experimental system. We investigated the subpopulation structures and assessed the influence of different scaffolding environments on the signaling pathway and the composition of subpopulations. Using simultanous fitting of dose responses and activation kinetics for the different adherence substrates, our method revealed an association between collagen type I and elevated NGF-mediated Erk1/2 signaling, demonstrating that extracellular scaffolds play a role in nociceptor sensitization signaling. In this study, we compared Col I with the artificial PDL substrate, but a wide range of extracellular matrix proteins are altered in conditions such as wounds and tumors. Further analysis will be needed to determine the impact of single extracellular matrix components on sensitization signaling of nociceptive neurons. Further research is also needed to investigate whether modulated signaling leads to increased excitability of these neurons.</p>
<p>Procedures such as a forward-backward algorithm (e.g., <xref ref-type="bibr" rid="c18">Hastie et al. (2009)</xref>) or reversible jump Markov Chain Monte Carlo (<xref ref-type="bibr" rid="c15">Green, 1995</xref>) could be implemented to simultaneously perform parameter estimation and model selection. In this study, mixtures of log-normal distributions were used to model the cell population. However, other distributions, including the Laplace distribution, could be integrated with the computational framework to improve robustness against outliers (<xref ref-type="bibr" rid="c31">Maier et al., 2017</xref>).</p>
<p>The inference of mechanistic models from single-cell data relies on statistical models for the measurement and sampling process. In many modeling studies using single-cell data, no distinction is made between cells from different batches, obscuring cell-to-cell variability and differences between experimental batches (<xref ref-type="bibr" rid="c19">Hicks et al., 2015</xref>). In this study, we observed that the derived likelihood function can be overly sensitive and that model selection is biased towards complex models. To circumvent this issue, we used a ranking of potential differences rather than a precise measure of statistical significance. However, this problem will need to be addressed, as the use of single-cell data is increasingly common.</p>
<p>In summary, we proposed the use of hierarchical population models as a novel tool to study heterogeneity in multivariate single-cell data and evaluated their performance. Our framework is the first to account for multiple levels of heterogeneity simultaneously. Our results on simulation and application examples suggest that this method can be used to obtain a more holistic understanding of heterogeneity.</p>
</sec>
</body>
<back>
<sec>
<title>Author Contributions</title>
<p>C.L., F.F., and J.H. developed the method. K.M. and T.H. designed the experiments. K.M. performed the experiments. C.L. analyzed the data. C.L., K.M, F.F., T.H., and J.H. wrote the paper.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>C.L., F.F., and J.H. acknowledge financial support from the German Research Foundation (DFG) and the Postdoctoral Fellowship Program of the Helmholtz Zentrum M&#x00FC;nchen. K.M. was supported by the Evangelisches Studienwerk Villigst and the graduate program in Pharmacology and Experimental Therapeutics at the University of Cologne which is financially and scientifically supported by Bayer. This work was supported by the German Research Foundation (DFG; <ext-link ext-link-type="uri" xlink:href="http://www.dfg.de">http://www.dfg.de</ext-link>) through the Graduate School of Quantitative Biosciences Munich (QBM; FF).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><given-names>S. J.</given-names> <surname>Altschuler</surname></string-name> and <string-name><given-names>L. F.</given-names> <surname>Wu</surname></string-name>. <article-title>Cellular heterogeneity: when do differences make a difference?</article-title> <source>Cell</source>, <volume>141</volume> (<issue>4</issue>):<fpage>559</fpage>&#x2013;<lpage>563</lpage>, <year>2010</year></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Andres</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Meyer</surname></string-name>, <string-name><given-names>O. A.</given-names> <surname>Dina</surname></string-name>, <string-name><given-names>J. D.</given-names> <surname>Levine</surname></string-name>, and <string-name><given-names>T.</given-names> <surname>Hucho</surname></string-name>. <article-title>Quantitative automated microscopy (QuAM) elucidates growth factor specific signalling in pain sensitization</article-title>. <source>Molecular Pain</source>, <volume>6</volume>(<issue>98</issue>):<fpage>1</fpage>&#x2013;<lpage>16</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Andres</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Allg&#x00F6;wer</surname></string-name>, and <string-name><given-names>T.</given-names> <surname>Hucho</surname></string-name>. <article-title>Threshold-free population analysis identifies larger DRG neurons to respond stronger to NGF stimulation</article-title>. <source>PLoS ONE</source>, <volume>7</volume>(<issue>3</issue>):<fpage>e34257</fpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Bal&#x00E1;zsi</surname></string-name>, <string-name><given-names>A.</given-names> <surname>van Oudenaarden</surname></string-name>, and <string-name><given-names>J. J.</given-names> <surname>Collins</surname></string-name>. <article-title>Cellular decision making and biological noise: from microbes to mammals</article-title>. <source>Cell</source>, <volume>144</volume>(<issue>6</issue>):<fpage>910</fpage>&#x2013;<lpage>925</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><given-names>V. R.</given-names> <surname>Buchholz</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Flossdorf</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Hensel</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Kretschmer</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Weissbrich</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Gr&#x00E4;f</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Verschoor</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Schiemann</surname></string-name>, <string-name><given-names>T.</given-names> <surname>H&#x00F6;fer</surname></string-name>, and <string-name><given-names>D. H.</given-names> <surname>Busch</surname></string-name>. <article-title>Disparate individual fates compose robust CD8&#x002B; T cell immunity</article-title>. <source>Science</source>, <volume>340</volume>(<issue>6132</issue>):<fpage>630</fpage>&#x2013;<lpage>635</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><given-names>F.</given-names> <surname>Buettner</surname></string-name>, <string-name><given-names>K. N.</given-names> <surname>Natarajan</surname></string-name>, <string-name><given-names>F. P.</given-names> <surname>Casale</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Proserpio</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Scialdone</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name><given-names>S. A.</given-names> <surname>Teichmann</surname></string-name>, <string-name><given-names>J. C.</given-names> <surname>Marioni</surname></string-name>, and <string-name><given-names>O.</given-names> <surname>Stegle</surname></string-name>. <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat. Biotechnol.</source>, <volume>33</volume>(<issue>2</issue>):<fpage>155</fpage>&#x2013;<lpage>160</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><given-names>L.</given-names> <surname>De Vargas Roditi</surname></string-name> and <string-name><given-names>M.</given-names> <surname>Claassen</surname></string-name>. <article-title>Computational and experimental single cell biology techniques for the definition of cell type heterogeneity, interplay and intracellular dynamics</article-title>. <source>Curr. Opin. Biotechnol.</source>, <volume>34</volume>:<fpage>9</fpage>&#x2013;<lpage>15</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Ebinger</surname></string-name>, <string-name><given-names>E. Z.</given-names> <surname>&#x00D6;zdemir</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Ziegenhain</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Tiedt</surname></string-name>, <string-name><given-names>C. C.</given-names> <surname>Alves</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Grunert</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Dworzak</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Lutz</surname></string-name>, <string-name><given-names>V. A.</given-names> <surname>Turati</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Enver</surname></string-name>, <string-name><given-names>H.-P.</given-names> <surname>Horny</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Sotlar</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Parekh</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Spiekermann</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Hiddemann</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Schepers</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Polzer</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Kirsch</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hoffmann</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Knapp</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Pfeifer</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Panzer-Gr&#x00FC;mayer</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Enard</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Gires</surname></string-name>, and <string-name><given-names>I.</given-names> <surname>Jeremias</surname></string-name>. <article-title>Characterization of rare, dormant, and therapy-resistant cells in acute lymphoblastic leukemia</article-title>. <source>Cancer Cell</source>, <volume>30</volume>(<issue>6</issue>):<fpage>849</fpage>&#x2013;<lpage>862</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><given-names>M. B.</given-names> <surname>Elowitz</surname></string-name>, <string-name><given-names>A. J.</given-names> <surname>Levine</surname></string-name>, <string-name><given-names>E. D.</given-names> <surname>Siggia</surname></string-name>, and <string-name><given-names>P. S.</given-names> <surname>Swain</surname></string-name>. <article-title>Stochastic gene expression in a single cell</article-title>. <source>Science</source>, <volume>297</volume>(<issue>5584</issue>):<fpage>1183</fpage>&#x2013;<lpage>1186</lpage>, <year>2002</year>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>W. M.</given-names> <surname>Elsasser</surname></string-name>. <article-title>Outline of a theory of cellular heterogeneity</article-title>. <source>Proc. Natl. Acad. Sci. U S A</source>, <volume>81</volume>(<issue>16</issue>): <fpage>5126</fpage>&#x2013;<lpage>5129</lpage>, <year>1984</year></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Engblom</surname></string-name>. <article-title>Computing the moments of high dimensional solutions of the master equation</article-title>. <source>Appl. Math. Comp.</source>, <volume>180</volume>:<fpage>498</fpage>&#x2013;<lpage>515</lpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Filippi</surname></string-name>, <string-name><given-names>C. P.</given-names> <surname>Barnes</surname></string-name>, <string-name><given-names>P. D.</given-names> <surname>Kirk</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Kudo</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Kunida</surname></string-name>, <string-name><given-names>S. S.</given-names> <surname>McMahon</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Tsuchiya</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Wada</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Kuroda</surname></string-name>, and <string-name><given-names>M. P.</given-names> <surname>Stumpf</surname></string-name>. <article-title>Robustness of mek-erk dynamics and origins of cell-to-cell variability in mapk signaling</article-title>. <source>Cell Reports</source>, <volume>15</volume>(<issue>11</issue>):<fpage>2524</fpage>&#x2013;<lpage>2535</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><given-names>F.</given-names> <surname>Fr&#x00F6;hlich</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Thomas</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Kazeroonian</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Grima</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title>Inference for stochastic chemical kinetics using moment equations and system size expansion</article-title>. <source>PLoS Comput. Biol.</source>, <volume>12</volume>(<issue>7</issue>): <fpage>e1005030</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><given-names>D. T.</given-names> <surname>Gillespie</surname></string-name>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>J. Phys. Chem.</source>, <volume>81</volume>(<issue>25</issue>): <fpage>2340</fpage>&#x2013;<lpage>2361</lpage>, <year>1977</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><given-names>P. J.</given-names> <surname>Green</surname></string-name>. <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source>, <volume>82</volume>(<issue>4</issue>):<fpage>711</fpage>&#x2013;<lpage>732</lpage>, <year>1995</year>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Waldherr</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Doszczak</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Radde</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Scheurich</surname></string-name>, and <string-name><given-names>F.</given-names> <surname>Allg&#x00F6;wer</surname></string-name>. <article-title>Identification of models of heterogeneous cell populations from population snapshot data</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume> (<issue>125</issue>), <year>2011</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Hucho</surname></string-name>, and <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>. <article-title>ODE constrained mixture modelling: A method for unraveling subpopulation structures and dynamics</article-title>. <source>PLoS Comput. Biol.</source>, <volume>10</volume>(<issue>7</issue>):<fpage>e1003686</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="book"><string-name><given-names>T.</given-names> <surname>Hastie</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Tibshirani</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Friedman</surname></string-name>. <source>The elements of statistical learning</source>, volume <volume>2</volume>. <publisher-name>Springer</publisher-name>, <year>2009</year></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><given-names>S. C.</given-names> <surname>Hicks</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Teng</surname></string-name>, and <string-name><given-names>R. A.</given-names> <surname>Irizarry</surname></string-name>. <article-title>On the widespread and critical impact of systematic bias and batch effects in single-cell RNA-seq data</article-title>. <source>bioRxiv</source>, page <fpage>025528</fpage>, <year>2015</year></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Hross</surname></string-name> and <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title>Analysis of CFSE time-series data using division-, age- and label-structured population models</article-title>. <source>Bioinformatics</source>, <volume>32</volume>(<issue>15</issue>):<fpage>2321</fpage>&#x2013;<lpage>2329</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><given-names>T.</given-names> <surname>Hucho</surname></string-name> and <string-name><given-names>J. D.</given-names> <surname>Levine</surname></string-name>. <article-title>Signaling pathways in sensitization: toward a nociceptor cell biology</article-title>. <source>Neuron</source>, <volume>55</volume>(<issue>3</issue>):<fpage>365</fpage>&#x2013;<lpage>376</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Isensee</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Diskar</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Waldherr</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Buschow</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Prinz</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Allg&#x00F6;wer</surname></string-name>, <string-name><given-names>F. W.</given-names> <surname>Herberg</surname></string-name>, and <string-name><given-names>T.</given-names> <surname>Hucho</surname></string-name>. <article-title>Pain modulators regulate the dynamics of PKA-RII phosphorylation in subgroups of sensory neurons</article-title>. <source>J. Cell Sci.</source>, <volume>127</volume>:<fpage>216</fpage>&#x2013;<lpage>229</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Islam</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Zeisel</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Joost</surname></string-name>, <string-name><given-names>G.</given-names> <surname>La Manno</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Zajac</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Kasper</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Lonnerberg</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Linnarsson</surname></string-name>. <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nat. Methods</source>, <volume>11</volume>(<issue>2</issue>):<fpage>163</fpage>&#x2013;<lpage>166</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><given-names>R. -R.</given-names> <surname>Ji</surname></string-name>, <string-name><given-names>R. W.</given-names> <surname>Gereau</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Malcangio</surname></string-name>, and <string-name><given-names>G. R.</given-names> <surname>Strichartz</surname></string-name>. <article-title>MAP kinase and pain</article-title>. <source>Brain Res Rev.</source>, <volume>60</volume> (<issue>1</issue>):<fpage>135</fpage>&#x2013;<lpage>148</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Kazeroonian</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Fr&#x00F6;hlich</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title>CERENA: ChEmical REaction Network Analyzer&#x2013;A toolbox for the simulation and analysis of stochastic chemical kinetics</article-title>. <source>PLoS One</source>, <volume>11</volume>(<issue>1</issue>):<fpage>e0146732</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><given-names>P. V.</given-names> <surname>Kharchenko</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Silberstein</surname></string-name>, and <string-name><given-names>D. T.</given-names> <surname>Scadden</surname></string-name>. <article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>(<issue>7</issue>):<fpage>740</fpage>&#x2013;<lpage>742</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Koeppl</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Zechner</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Ganguly</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Pelet</surname></string-name>, and <string-name><given-names>M.</given-names> <surname>Peter</surname></string-name>. <article-title>Accounting for extrinsic variability in the estimation of stochastic rate constants</article-title>. <source>Int. J. Robust Nonlinear Control</source>, <volume>22</volume>(<issue>10</issue>):<fpage>1</fpage>&#x2013;<lpage>21</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><given-names>C. H.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>K. H.</given-names> <surname>Kim</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Kim</surname></string-name>. <article-title>A moment closure method for stochastic reaction networks</article-title>. <source>J. Chem. Phys.</source>, <volume>130</volume>(<issue>13</issue>):<fpage>134107</fpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Finn</surname></string-name>, and <string-name><given-names>C.</given-names> <surname>Scott</surname></string-name>. <article-title>Statistical file matching of flow cytometry data</article-title>. <source>J. Biomed. Inform.</source>, <volume>44</volume> (<issue>4</issue>):<fpage>663</fpage>&#x2013;<lpage>676</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="book"><string-name><given-names>C.</given-names> <surname>Loos</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Fiedler</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <chapter-title>Parameter estimation for reaction rate equation constrained mixture models</chapter-title>. In <person-group><string-name><given-names>E.</given-names> <surname>Bartocci</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Lio</surname></string-name>, and <string-name><given-names>N.</given-names> <surname>Paoletti</surname></string-name></person-group>, editors, <source>Proceedings of the 13th Computational Methods in Systems Biology, Cambridge, UK, volume 9859 of LNCS</source>, pages <fpage>186</fpage>&#x2013;<lpage>200</lpage>. <publisher-name>Springer International Publishing</publisher-name>, <year>2016</year>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Maier</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Loos</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title>Robust parameter estimation for dynamical systems from outlier-corrupted data</article-title>. <source>Bioinformatics</source>, <volume>33</volume>(<issue>5</issue>):<fpage>718</fpage>&#x2013;<lpage>725</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Malik-Hall</surname></string-name>, <string-name><given-names>O. A.</given-names> <surname>Dina</surname></string-name>, and <string-name><given-names>J. D.</given-names> <surname>Levine</surname></string-name>. <article-title>Primary afferent nociceptor mechanisms mediating ngf-induced mechanical hyperalgesia</article-title>. <source>Eur. J. Neurosci.</source>, <volume>21</volume>(<issue>12</issue>):<fpage>3387</fpage>&#x2013;<lpage>3394</lpage>, <year>2005</year>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><given-names>V.</given-names> <surname>Moignard</surname></string-name>, <string-name><given-names>I. C.</given-names> <surname>Macaulay</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Swiers</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Buettner</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Sch&#x00FC;tte</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Calero-Nieto</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Kinston</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Joshi</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Hannah</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name><given-names>S. E.</given-names> <surname>Jacobsen</surname></string-name>, <string-name><given-names>M. F.</given-names> <surname>de Bruijn</surname></string-name>, and <string-name><given-names>B.</given-names> <surname>G&#x00F6;ttgens</surname></string-name>. <article-title>Characterization of transcriptional networks in blood stem and progenitor cells using high-throughput single-cell gene expression analysis</article-title>. <source>Nat. Cell Biol.</source>, <volume>15</volume>(<issue>4</issue>):<fpage>363</fpage>&#x2013;<lpage>372</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Pyne</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Hu</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Rossin</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Maier</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Baecher-Allan</surname></string-name>, <string-name><given-names>G.</given-names> <surname>McLachlan</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Tamayo</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Hafler</surname></string-name>, <string-name><given-names>P.</given-names> <surname>De Jager</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Mesirov</surname></string-name>. <article-title>Automated high-dimensional flow cytometric data analysis</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>106</volume>(<issue>21</issue>):<fpage>8519</fpage>&#x2013;<lpage>8124</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><given-names>A. E.</given-names> <surname>Raftery</surname></string-name>. <article-title>Bayes factors and BIC</article-title>. <source>Socio. Meth. Res.</source>, <volume>27</volume>(<issue>3</issue>):<fpage>411</fpage>&#x2013;<lpage>417</lpage>, <year>1999</year>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Kreutz</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Maiwald</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bachmann</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Schilling</surname></string-name>, <string-name><given-names>U.</given-names> <surname>Klingm&#x00FC;ller</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Timmer</surname></string-name>. <article-title>Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood</article-title>. <source>Bioinformatics</source>, <volume>25</volume>(<issue>25</issue>):<fpage>1923</fpage>&#x2013;<lpage>1929</lpage>, <year>2009</year></mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Schilling</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bachmann</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Matteson</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Schelke</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Kaschek</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Hug</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Kreutz</surname></string-name>, <string-name><given-names>B. D.</given-names> <surname>Harms</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name><given-names>U.</given-names> <surname>Klingm&#x00FC;ller</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Timmer</surname></string-name>. <article-title>Lessons learned from quantitative dynamical modeling in systems biology</article-title>. <source>PLoS One</source>, <volume>8</volume>(<issue>9</issue>):<fpage>e74335</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Regev</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Teichmann</surname></string-name>, <string-name><given-names>E. S.</given-names> <surname>Lander</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Amit</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Benoist</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Birney</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Bodenmiller</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Campbell</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Carninci</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Clatworthy</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Clevers</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Deplancke</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Dunham</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Eberwine</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Eils</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Enard</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Farmer</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Fugger</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Gottgens</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Hacohen</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Haniffa</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hemberg</surname></string-name>, <string-name><given-names>S. K.</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Klenerman</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Kriegstein</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Lein</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Linnarsson</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Lundeberg</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Majumder</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Marioni</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Merad</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Mh-langa</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Nawijn</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Netea</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Nolan</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Pe&#x2019;er</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Philipakis</surname></string-name>, <string-name><given-names>C. P.</given-names> <surname>Ponting</surname></string-name>, <string-name><given-names>S. R.</given-names> <surname>Quake</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Reik</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Rozenblatt-Rosen</surname></string-name>, <string-name><given-names>J. R.</given-names> <surname>Sanes</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Satija</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Shumacher</surname></string-name>, <string-name><given-names>A. K.</given-names> <surname>Shalek</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Shapiro</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Sharma</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Shin</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Stegle</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Stratton</surname></string-name>, <string-name><given-names>M. J. T.</given-names> <surname>Stubbington</surname></string-name>, <string-name><given-names>A.</given-names> <surname>van Oudenaarden</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Wagner</surname></string-name>, <string-name><given-names>F. M.</given-names> <surname>Watt</surname></string-name>, <string-name><given-names>J. S.</given-names> <surname>Weissman</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Wold</surname></string-name>, <string-name><given-names>R. J.</given-names> <surname>Xavier</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Yosef</surname></string-name>, and <collab>Human Cell Atlas Meeting Participants</collab>. <article-title>The Human Cell Atlas</article-title>. <source>bioRxiv</source>, page <fpage>121202</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><given-names>W.</given-names> <surname>Reik</surname></string-name>. <article-title>Stability and flexibility of epigenetic gene regulation in mammalian development</article-title>. <source>Nature</source>, <volume>447</volume> (<issue>7143</issue>):<fpage>425</fpage>&#x2013;<lpage>432</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Roederer</surname></string-name>. <article-title>Compensation in flow cytometry</article-title>. <source>Curr. Protoc. Cytom.</source>, pages <fpage>1</fpage>&#x2013;<lpage>14</lpage>, <year>2002</year></mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Rubin</surname></string-name>. <article-title>The significance of biological heterogeneity</article-title>. <source>Cancer Metastasis Rev.</source>, <volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>&#x2013;<lpage>20</lpage>, <year>1990</year>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Sauvageau</surname></string-name>, <string-name><given-names>P. M.</given-names> <surname>Lansdorp</surname></string-name>, <string-name><given-names>C. J.</given-names> <surname>Eaves</surname></string-name>, <string-name><given-names>D. E.</given-names> <surname>Hogge</surname></string-name>, <string-name><given-names>W. H.</given-names> <surname>Dragowska</surname></string-name>, <string-name><given-names>D. S.</given-names> <surname>Reid</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Largman</surname></string-name>, <string-name><given-names>H. J.</given-names> <surname>Lawrence</surname></string-name>, and <string-name><given-names>R. K.</given-names> <surname>Humphries</surname></string-name>. <article-title>Differential expression of homeobox genes in functionally distinct CD34&#x002B; subpopulations of human bone marrow cells</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>91</volume>(<issue>25</issue>):<fpage>12223</fpage>&#x2013;<lpage>12227</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Schnoerr</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Sanguinetti</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Grima</surname></string-name>. <article-title>Validity conditions for moment closure approximations in stochastic chemical kinetics</article-title>. <source>J. Chem. Phys.</source>, <volume>141</volume>(<issue>8</issue>):<fpage>084103</fpage>, <year>2014</year></mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><given-names>T.</given-names> <surname>Schroeder</surname></string-name>. <article-title>Long-term single-cell imaging of mammalian stem cells</article-title>. <source>Nat. Methods</source>, <volume>8</volume>(<issue>4</issue>):<fpage>30</fpage>&#x2013;<lpage>35</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Tay</surname></string-name>, <string-name><given-names>J. J.</given-names> <surname>Hughey</surname></string-name>, <string-name><given-names>T. K.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Lipniacki</surname></string-name>, <string-name><given-names>S. R.</given-names> <surname>Quake</surname></string-name>, and <string-name><given-names>M. W.</given-names> <surname>Covert</surname></string-name>. <article-title>Single-cell NF-&#x03BA;B dynamics reveal digital activation and analogue information processing</article-title>. <source>Nature</source>, <volume>466</volume>:<fpage>267</fpage>&#x2013;<lpage>271</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="book"><string-name><given-names>R.</given-names> <surname>van der Merwe</surname></string-name>. <chapter-title>Sigma-point Kalman filters for probabilistic inference in dynamic state-space models</chapter-title>. <source>Ph.d. thesis</source>, <publisher-name>Oregon Health &#x0026; Science University</publisher-name>, <year>2004</year></mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="book"><string-name><given-names>N. G.</given-names> <surname>van Kampen</surname></string-name>. <source>Stochastic processes in physics and chemistry</source>. <publisher-loc>North-Holland, Amsterdam</publisher-loc>, <edition>3rd</edition> edition, <year>2007</year></mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><given-names>P. M.</given-names> <surname>Williams</surname></string-name>. <article-title>Matrix logarithm parametrizations for neural network covariance models</article-title>. <source>Neural Netw.</source>, <volume>12</volume>(<issue>2</issue>):<fpage>299</fpage>&#x2013;<lpage>308</lpage>, <year>1999</year>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Willyard</surname></string-name>. <article-title>Cancer therapy: an evolved approach</article-title>. <source>Nature</source>, <volume>532</volume>:<fpage>166</fpage>&#x2013;<lpage>168</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Yao</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Pilko</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Wollman</surname></string-name>. <article-title>Distinct cellular states determine calcium signaling response</article-title>. <source>Mol. Syst. Biol.</source>, <volume>12</volume>(<issue>12</issue>):<fpage>894</fpage>, <year>2016</year></mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Zechner</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Ruess</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Krenn</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Pelet</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Peter</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Lygeros</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Koeppl</surname></string-name>. <article-title>Moment-based inference predicts bimodality in transient gene expression</article-title>. <source>Proc. Natl. Acad. Sci. U S A</source>, <volume>109</volume>(<issue>21</issue>):<fpage>8340</fpage>&#x2013;<lpage>8345</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><given-names>Z.-Y.</given-names> <surname>Zhuang</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Xu</surname></string-name>, <string-name><given-names>D. E.</given-names> <surname>Clapham</surname></string-name>, and <string-name><given-names>R.-R.</given-names> <surname>Ji</surname></string-name>. <article-title>Phosphatidylinositol 3-kinase activates ERK in primary sensory neurons and mediates inflammatory heat hyperalgesia through TRPV1 sensitization. J</article-title>. <source>Neurosci.</source>, <volume>24</volume>(<issue>38</issue>):<fpage>8300</fpage>&#x2013;<lpage>8309</lpage>, <year>2004</year>.</mixed-citation></ref>
</ref-list>
<sec sec-type="supplementary-material">
<title>Supplementary Information</title>
<sec id="s4">
<title>Experimental model</title>
<sec id="s4a">
<title>Antibodies</title>
<p>The following antibodies were used in this study: chicken polyclonal antibody against UCHL1 (1:4000; Novus, &#x0023;NB110-58872), mouse monoclonal antibody against UCHL1 (1:1000, MorphoSys, &#x0023;7863-2004), rabbit monoclonal antibody against phospho-Erk1/2 (1:250, Cell Signaling, &#x0023;4370L), mouse monoclonal antibody against ERK1/2 (1:500, Cell Signaling, cat&#x0023; 4696 S), goat polyclonal antibody against TrkA (1:500, R&#x0026;D Systems, &#x0023;AF1056), and highly cross adsorbed Alexa Fluor 488, Alexa Fluor 568, Alexa Fluor 594-, and Alexa Fluor 488-conjugated secondary antibodies (Invitrogen).</p>
</sec>
<sec id="s4b">
<title>Reagents</title>
<p>NGF (50<italic>&#x03BC;</italic>g/ml in 0.1 &#x0025; BSA), GDNF (20<italic>&#x03BC;</italic>g/ml in 0.1 &#x0025; BSA), U0126 (50 mM in DMSO) were purchased from Alomone labs (&#x0023;N-240), PeproTech (cat&#x0023; 450-51), and Calbiochem (&#x0023; 662005), respectively, and were prepared as indicated. Concentrations used are indicated in the text or figure legend. Collagen type I (Cell Systems, &#x0023;5056-A) and poly-D-lysine (Sigma,&#x0023; P6407-5MG) were diluted in 1xPBS to final concentrations of 3.4 <italic>&#x03BC;</italic>g/ml and 10 <italic>&#x03BC;</italic>g/ml.</p>
</sec>
<sec id="s4c">
<title>Animals</title>
<p>Male Sprague Dawley rats (200250 g, 8-10 weeks old) were obtained from Harlan Laboratories. All experiments were performed in accordance with the German animal welfare law with permission of the District Government for Nature and Environment, NRW (LANUV NRW, license 84-02.05.20.13.045). Rats were sacrificed by CO<sub>2</sub> intoxication for tissue isolation.</p>
</sec>
<sec id="s4d">
<title>Coating</title>
<p>96-well imaging plates (Greiner) were coated with 50 <italic>&#x03BC;</italic>l volume of matrix protein dilutions per well for 3h at 37 C. Wells were washed one time with 1xPBS for 10 min. PDL coatings were dried and washing solution of Col I treated wells was removed immediately before cell seeding.</p>
</sec>
</sec>
<sec id="s4e">
<title>Primary sensory neuron culture</title>
<p>L1-L6 dorsal root ganglia (DRG) were isolated, desheathed, pooled and incubated in Neurobasal-A (NB) medium supplemented with collagenase P for 1 h in 5 &#x0025; CO<sub>2</sub> atmosphere at 37 C. Neurons were dissociated by trituration with fire-polished siliconated Pasteur pipettes and axonal debris and disrupted cells were removed by a 14&#x0025; BSA gradient centrifugation (120g, 8min). Cells were resuspended in NB medium supplemented with B27 medium, L-Glutamine, L-Glutamate and Penicillin-Streptomycin. subsequently, they were plated on pre-coated 96-well imaging plates and incubated overnight in a 5 &#x0025; CO<sub>2</sub> atmosphere at 37 C.</p>
</sec>
<sec id="s4f">
<title>Stimulation and fixation of neuronal cultures</title>
<p>Neuronal cultures were stimulated 15 h after isolation by removal of 50 <italic>&#x03BC;</italic>l culture medium, mixing with the compound and returning to the corresponding culture well. Solvent controls were treated alike. Stimulation was performed with automated eight-channel pipettes (Eppendorf) on pre-warmed heating blocks (37 C), and stimulated cells were placed back into the incubator. Neurons were fixed by adding 8 &#x0025; PFA (final concentration 4&#x0025; PFA) for 10 min at RT and subsequently washed three times with 1xPBS for 10min. Kinetic experiments involved time courses of 0, 1, 5, 15, 30, 60 and 120 min NGF stimulation (20ng/ml), whereas dose response curves were obtained by NGF stimulations with the following NGF concentrations for 1 h: 0.16, 0.8, 4, 20, 100, 500ng/ml.</p>
</sec>
<sec id="s4g">
<title>Immunocytochemistry</title>
<p>Cells were blocked and permeabilized with 2&#x0025; normal goat serum or 2 &#x0025; normal donkey serum supplemented with 1 &#x0025; BSA, 0.1 &#x0025; Triton X-100, 0.05&#x0025; Tween 20 for 1 h at RT. Primary antibodies were added in 1 &#x0025; BSA in 1xPBS and cells were incubated overnight at 4 C. After three washes with 1xPBS for 10 min at RT, cells were incubated with secondary antibodies diluted in 1xPBS for 1 h at RT. Plates were stored at 4 C after three additional washes with 1xPBS (10 min, RT) until scanning.</p>
</sec>
<sec id="s4h">
<title>Quantitative microscopy</title>
<p>Immunofluorescently labelled neurons were imaged via the Cellomics ArrayScan microscope using a 10x objective as described previously (<xref ref-type="bibr" rid="c22">Isensee et al., 2014</xref>). Images of 512 &#x00D7; 512 pixels were analyzed using the Cellomics software package. Briefly, images of all channels were background corrected (low pass filter), objects were identified using fixed thresholding (intensity 900) and segmentation by shape (parameter 15). Neurons were validated by the following object selection parameters: size: 1657500<italic>&#x03BC;</italic>m<sup>2</sup>; circularity (perimeter<sup>2</sup>/4<italic>&#x03C0;</italic> area): 12; length-to-width ratio: 12.67; average intensity: 90012.000; total intensity: 2 10<sup>5</sup> to 5 10<sup>7</sup>. The image masks were then used to quantify signals in other channels. Raw values of three to four independent experiments were further processed via the R software. Raw fluorescence data was compensated and normalized. In brief, three controls were prepared for a triple staining: 1. UCHL1 alone, 2. UCHL1 &#x002B; antibody 1, and 3. UCHL1 &#x002B; antibody 2. Raw fluorescence data of the controls were used to calculate the bleed-through between fluorescence channels. The slope of best fit straight lines were determined by linear regression and used to compensate bleed through as described previously (<xref ref-type="bibr" rid="c40">Roederer, 2002</xref>). Compensated data were scaled to a mean value of 1000 for the unstimulated cells of the poly-D-lysine control to adjust for variability between experimental days.</p>
</sec>
</sec>
<sec id="s5">
<title>Methods</title>
<sec id="s5a">
<title>Models for individual subpopulations</title>
<p>The hierarchical modeling approach introduced in this manuscript describes the population dynamics based on the dynamics of individual subpopulations. In this section, we introduce the modeling approaches at the subpopulation level that are used in our study.</p>
<p>First, we considered the simple case that only the mean of a subpopulation is modeled mechanistically, whereas the variance and higher order moments are not linked to the underlying biochemical reaction network. For this, the reaction rate equation (RRE) was used
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="171561_eqn3.gif"/></alternatives>
</disp-formula></p>
<p>Here, <bold>x</bold> = (<italic>x</italic><sub>1</sub>,&#x2026;, <italic>x<sub>n</sub></italic>) denotes the biochemical species, <bold>y</bold> = (<italic>y</italic><sub>1</sub>,&#x2026;, <italic>y<sub>d</sub></italic>) the observables of the system, and <italic>&#x03c8;</italic> the parameters, such as reaction rates, protein abundances, or initial conditions. This follows the method introduced by (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>).</p>
<p>The RRE is based on the assumption that the subpopulations are homogeneous. However, many cellular processes exhibit substantial intrinsic or extrinsic cell-to-cell variability. To account for this variability, we considered models accounting for random parameters and stochastic reaction kinetics.</p>
<sec id="s5a1">
<title>Sigma-point approximation</title>
<p>In this study, we modeled extrinsic variability by heterogeneity in <italic>L</italic> parameters of the parameter vector <italic>&#x03C8;</italic> &#x2208; &#x0211D;<sup><italic>n<sub>&#x03C8;</sub></italic></sup> of individual cells. The parameters <italic>&#x03C8;</italic> were assumed to follow a probability distribution <italic>p<sub>&#x03C8;</sub></italic> (<italic>&#x03C8;</italic>). This distribution in the parameters <italic>p<sub>&#x03C8;</sub></italic> (<italic>&#x03C8;</italic>) is mapped to a distribution of cell states and observables of the subpopulation, which need to be computed for the parameter estimation. A detailed analysis of this image requires sampling from <italic>p<sub>&#x03C8;</sub></italic> (<italic>&#x03C8;</italic>) and subsequent evaluation of the state and observable vectors by simulation. This procedure is, however, computationally demanding. We employed the sigma-point approximation (<xref ref-type="bibr" rid="c46">van der Merwe, 2004</xref>) to obtain an approximation of the statistical moments of the image, mean and covariance and their dynamics in time, using a small number of simulations. The sigma-point approximation uses only the image of 2<italic>L</italic> &#x002B; 1 deterministically chosen parameter vectors. These parameter vectors, the so called sigma-points, are chosen to represent the mean <italic>&#x03B2;</italic> and the covariance <bold>D</bold> of <italic>p<sub>&#x03C8;</sub></italic>. For the parameters that were considered to be homogeneous, i.e., not variable across the cells, it was assumed that <italic>&#x03B2;<sub>i</sub></italic> = <italic>&#x03C8;<sub>i</sub></italic> and <italic>D<sub>ii</sub></italic> = <italic>D<sub>j</sub></italic> = 0, &#x2200;<italic>j</italic>.</p>
<p>Following <xref ref-type="bibr" rid="c46">van der Merwe (2004)</xref>, the sigma-points {<italic>v<sub>l</sub></italic>, &#x1d4e2;<sub><italic>l</italic></sub>} are defined as
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn4.gif"/></alternatives>
</disp-formula></p>
<p>We used <italic>&#x03B7;</italic><sub>2</sub> = 2 and <italic>&#x03B7;</italic><sub>3</sub> =
<inline-formula><alternatives><inline-graphic xlink:href="171561_inline1.gif"/></alternatives></inline-formula>
with <italic>&#x03B7;</italic><sub>1</sub> = 0.7 and <italic>&#x03B7;</italic><sub>4</sub> = 0 as proposed by <xref ref-type="bibr" rid="c46">van der Merwe (2004)</xref>. The superscripts for <italic>v<sub>l</sub></italic> indicate whether it is used for the calculation of the mean <sup>(<italic>m</italic>)</sup> or the covariance (<italic>c</italic>).</p>
<p>For the examples and applications presented in the manuscript, we assumed that the variability between cells is completely explained by differences in the model parameters. For a set of given parameters, the dynamics of individual cells were described by the RRE <xref ref-type="disp-formula" rid="eqn3">(3)</xref>. Accordingly, the images of the sigmapoints in the state and the observation space, &#x1d4e7;<sub><italic>l</italic></sub> and &#x1d4e8;<sub><italic>l</italic></sub>, were computed as
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="171561_eqn4.gif"/></alternatives>
</disp-formula></p>
<p>The mean and covariances of the species were computed as
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn5.gif"/></alternatives>
</disp-formula></p>
<p>The mean and covariances of the observables read
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="171561_eqn5.gif"/></alternatives>
</disp-formula></p>
<p>In our MATLAB SPToolbox, the parametrization of <bold>D</bold> was implemented by either a diagonal matrix logarithm or a matrix logarithm (<xref ref-type="bibr" rid="c48">Williams, 1999</xref>), in case of correlations between parameters. For our study, we assumed a log-normal distribution of the parameters, i.e., <italic><bold>&#x03B2;</bold></italic> and <bold>D</bold> described the median and scale matrix of the corresponding log-normal distribution and the exponent of &#x1d4e2;<sub><italic>l</italic></sub> was used in <xref ref-type="disp-formula" rid="eqn4">(4)</xref>.</p>
</sec>
<sec id="s5a2">
<title>Moment-closure approximation</title>
<p>In this study, we also considered intrinsic variability of biochemical reactions as introduced by discreteness and stochasticity of biochemical reactions. The single-cell dynamics are described by continuous time discrete state Markov chains (CTMCs). We approximated the time-dependent moments of this process using the moment-closure approximation (<xref ref-type="bibr" rid="c11">Engblom, 2006</xref>; <xref ref-type="bibr" rid="c28">Lee et al., 2009</xref>). This method provided equations for the temporal evolution of moments of the species, i.e., the mean
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn6.gif"/></alternatives>
</disp-formula>
of species <italic>x<sub>i</sub></italic>, and higher order moments such as the covariance
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn7.gif"/></alternatives>
</disp-formula>
between species <italic>x<sub>i</sub></italic> and <italic>x<sub>j</sub></italic>. Here, <italic>p</italic>(<italic>x</italic>, <italic>t</italic>) denotes the chemical master equation, &#x03A9; the set of possible states, and <italic>n</italic> the number of species. Given the moments of the species, we calculated the moments of the observables by
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="171561_eqn6.gif"/></alternatives>
</disp-formula></p>
<p>For the automatic generation of the moment-closure approximation and the corresponding simulation files, we employed the MATLAB toolbox CERENA (<xref ref-type="bibr" rid="c25">Kazeroonian et al., 2016</xref>). In addition, this toolbox provided the equations for the system size expansion, which can also be incorporated into our modeling framework as an alternative to the moment equations.</p>
</sec>
</sec>
<sec id="s5b">
<title>Mechanistic hierarchical population model</title>
<p>For the hierarchical population model, the mechanistic description of individual subpopulations, as introduced in the previous section, is combined with mixture models to describe the entire cell population.</p>
<sec id="s5b1">
<title>Hierarchical model and its approximations</title>
<p>We considered heterogeneous cell populations consisting of multiple subpopulations, <italic>s</italic> = 1,&#x2026;,<italic>N</italic>. Assuming independence, the distribution of the states and observables in the overall population is the weighted sum of the distribution of the states and observables in the subpopulations, <italic>p<sub>s</sub></italic>(<bold>x</bold>|<italic>t</italic>) and <italic>p<sub>s</sub></italic>(<bold>y</bold>|<italic>t</italic>). The weights <italic>w<sub>s</sub></italic>(<italic>t</italic>) are the relative populations sizes, with &#x2200;<italic>t</italic>: &#x2211;<sub><italic>s</italic></sub> <italic>w<sub>s</sub></italic>(<italic>t</italic>) = 1. This yields the hierarchical population model
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn8.gif"/></alternatives>
</disp-formula></p>
<p>The distribution of states and observables in the subpopulations originate according to the single cell properties. As the measurements &#x0079;&#x0304; are in general noise corrupted, <bold>&#x0079;&#x0304;</bold> &#x007E; <italic>p</italic>(&#x0079;&#x0304;|<bold>y</bold>), we also considered the distribution
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn9.gif"/></alternatives>
</disp-formula></p>
<p>To ensure computational efficiency, the probability distributions <italic>p<sub>s</sub></italic>(<bold>x</bold>|<italic>t</italic>),<italic>p<sub>s</sub></italic>(<bold>y</bold>|<italic>t</italic>) and <italic>p<sub>s</sub></italic>(<bold>&#x0079;&#x0304;</bold>|<italic>t</italic>) were approximated using the statistical moments. For the measured observables, the computed statistical moments were encoded in <italic><bold>&#x03C6;</bold><sub>s</sub></italic>, yielding
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn10.gif"/></alternatives>
</disp-formula>
with parametric probability distribution <italic>&#x03D5;</italic>. In this study, we employed the multivariate normal distribution
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="171561_eqn7.gif"/></alternatives>
</disp-formula>
and multivariate log-normal distribution
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="171561_eqn8.gif"/></alternatives>
</disp-formula>
with distribution parameters <italic><bold>&#x03C6;</bold><sub>s</sub></italic> = (<italic><bold>&#x03BC;</bold></italic>, <bold>&#x03A3;</bold><sub><italic>s</italic></sub>,). For example, for the multivariate normal distribution and no measurement noise, the distributions parameters were obtained by <italic><bold>&#x03BC;</bold><sub>s</sub></italic> = <bold>m</bold><sub><italic>s</italic>,<italic>y</italic></sub> and <bold>&#x03A3;</bold><sub><italic>s</italic></sub> = <bold>C</bold><sub><italic>s</italic>,<italic>y</italic></sub>.</p>
</sec>
<sec id="s5b2">
<title>Likelihood function</title>
<p>The parameters of the hierarchical population model <bold><italic>&#x03B8;</italic></bold> comprise the means/medians of the cell parameters <italic><bold>&#x03B2;</bold></italic>, <italic><bold>&#x03B2;</bold><sub>s</sub></italic> as well as the entries of the scale matrices <bold>D</bold>, <bold>D</bold><sub><italic>s</italic></sub>, the mixture weights <italic>w<sub>s</sub></italic>, and measurement noise <bold>&#x0393;</bold>. These parameters were estimated using maximum likelihood estimation. The likelihood function for multivariate measurement data <bold>&#x0079;&#x0304;</bold><sup><italic>e</italic>,<italic>k</italic>,<italic>j</italic></sup> &#x2208; &#x0211D;<sup><italic>d</italic></sup> is given by
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="171561_eqn9.gif"/></alternatives>
</disp-formula>
with means and covariances
<inline-formula><alternatives><inline-graphic xlink:href="171561_inline2.gif"/></alternatives></inline-formula>
of species <bold>x</bold>. The means and covariances are provided by some map <italic>g</italic>, e.g., the sigma-point approximation or the moment-closure approximation. The subpopulation parameters <italic><bold>&#x03BE;</bold><sub>s</sub></italic> = (<italic><bold>&#x03B2;</bold><sub>s</sub></italic>, <italic><bold>D</bold><sub>s</sub></italic>) are given by
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn11.gif"/></alternatives>
</disp-formula></p>
<p>The mapping <italic>h</italic> links the computed moments to the moments of the measurand including measurement noise, which are denoted by <bold>m</bold><sub><italic>y</italic></sub> = (<italic>m</italic><sub><italic>y</italic>, 1</sub>,&#x2026;, <italic>m</italic><sub><italic>y</italic>,<italic>d</italic></sub>) and <bold>C</bold><sub><italic>y</italic></sub> and can be calculated as described, e.g., in <xref ref-type="disp-formula" rid="eqn5">(5)</xref> and <xref ref-type="disp-formula" rid="eqn6">(6)</xref>. For a mixture of normal distributions <xref ref-type="disp-formula" rid="eqn7">(7)</xref>, the means and covariances were linked to the parameters of the normal distribution
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn12.gif"/></alternatives>
</disp-formula>
including additive normally distributed measurement noise parametrized by
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn13.gif"/></alternatives>
</disp-formula></p>
<p>For the log-normal distribution <xref ref-type="disp-formula" rid="eqn8">(8)</xref>, the distribution parameters were directly simulated with the sigmapoint approximation for the logarithm of the observable, yielding the relation
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn14.gif"/></alternatives>
</disp-formula>
accounting for multiplicative log-normally distributed measurement noise. Alternatively, the mean of the simulation was linked to the mean of the log-normal distribution by
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn15.gif"/></alternatives>
</disp-formula></p>
<p>In principle also other distributions can be incorporated in the presented modeling framework. Due numerical reasons, we used the log-likelihood function (<xref ref-type="bibr" rid="c30">Loos et al., 2016</xref>).</p>
</sec>
<sec id="s5b3">
<title>Gradient of likelihood function</title>
<p>To promote efficiency of the numerical optimization and robust convergence, we derived the gradient of the log-likelihood function. For this, the gradient of the corresponding mixture distribution <italic>&#x03D5;</italic> with respect to <italic>&#x03B8;</italic> was calculated using
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn16.gif"/></alternatives>
</disp-formula>
and the relation
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn17.gif"/></alternatives>
</disp-formula></p>
<p>Additionally, the sensitivities of the distribution parameters
<inline-formula><alternatives><inline-graphic xlink:href="171561_inline3.gif"/></alternatives></inline-formula>
were required, which were obtained by simulating the sensitivity equation for the sigma-point or the moment-closure approximation and mapping it to the distribution parameters using <italic>h</italic>.</p>
</sec>
</sec>
<sec id="s5c">
<title>Comparison with existing models</title>
<p>A comparison of the hierarchical population model with existing methods is given in the following:</p>
<table-wrap id="utbl1" orientation="portrait" position="float">
<graphic xlink:href="171561_utbl1.tif"/>
</table-wrap>
</sec>
<sec id="s5d">
<title>Parameter estimation</title>
<p>For parameter estimation, we used the MATLAB toolbox PESTO, which employs the function <monospace>fmincon.m</monospace> for local optimization. We used the interior-point algorithm and provided the analytic gradient of the log-likelihood function. Due to numerical better properties, we estimated the log<sub>10</sub>-transformed parameters. To explore the full parameter space, we performed multi-start optimization which has shown to outperform global optimization methods (<xref ref-type="bibr" rid="c37">Raue et al., 2013</xref>; <xref ref-type="bibr" rid="c20">Hross and Hasenauer, 2016</xref>). For this, randomly drawn initial parameter values were used for the optimization. For the uncertainty analysis, we calculated profile likelihoods (<xref ref-type="bibr" rid="c36">Raue et al., 2009</xref>) and the confidence intervals using the corresponding PESTO functions.</p>
</sec>
<sec id="s5e">
<title>Conversion process</title>
<p>In the manuscript, we considered a model of a conversion process. In the following, we provide a detailed description of the data generation and data analysis. We first introduce the single-cell model of the conversion process. Afterwards, we present the results for the model accounting for the mean, and the hierarchical model accounting for the mean and covariances.</p>
<sec id="s5e1">
<title>Single-cell model</title>
<p>The conversion process is described by the following reactions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn18.gif"/></alternatives>
</disp-formula></p>
<p>Reaction R<sub>1</sub> describes the stimulus-dependend conversion, whereas reaction R<sub>2</sub> models the basal conversion from A to B. The conversion from B to A, reaction R<sub>3</sub>, does not depend on stimulus <italic>u</italic> (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>). The concentrations of the species A and B are denoted by [A] and [B]. The RRE for (<italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>) = ([A], [B]) is given by
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn19.gif"/></alternatives>
</disp-formula>
with initial conditions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn20.gif"/></alternatives>
</disp-formula>
accounting for mass conservation [A] &#x002B; [B] = 1 and the assumption that the system was in steady state before the stimulus was added at 0 min. We assumed the conversion from B to A to be cell-to-cell variable,
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="171561_eqn10.gif"/></alternatives>
</disp-formula>
yielding cell-to-cell variable initial conditions. The parameter <italic>k</italic><sub>1</sub> was considered to differ between subpopulations and therefore was parametrized by <italic>k</italic><sub>1,1</sub> and <italic>k</italic><sub>1,2</sub>. The weight <italic>w<sub>i</sub></italic> indicated the proportion of the low responsive subpopulation. We generated artificial data for the parameters
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn21.gif"/></alternatives>
</disp-formula></p>
<p>We observed the concentration of B, i.e. <italic>y</italic> = <italic>x</italic><sub>2</sub>. The data was created including 1000 cells at 5 time points for <italic>u</italic> = 1 by sampling from the distribution for <italic>k</italic><sub>3</sub> <xref ref-type="disp-formula" rid="eqn10">(10)</xref> and simulating the corresponding RREs. Of the 1000 cells, 700 cells belonged to subpopulation 1 with low response to stimulation and 300 cells to the high responsive subpopulation 2. Additionally, the measurements of both subpopulations were assumed to be subject to logarithmic multiplicative measurement noise parameterized by <italic>&#x03C3;</italic><sub>noise</sub>. We assumed the parameters <italic><bold>&#x03B8;</bold></italic> to be unknown and estimated them from the data with</p>
<list list-type="roman-lower">
<list-item>
<p>the approach introduced by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref> using the means (obtained by the RRE) and</p></list-item>
<list-item>
<p>hierarchical population model describing the means and covariances (obtained by the sigma-point approximation)</p></list-item>
</list>
<p>For both approaches, the underlying subpopulation structure was given, i.e., subpopulation variability of <italic>k</italic><sub>1</sub>.</p>
</sec>
<sec id="s5e2">
<title>Hierarchical model using RREs</title>
<p>We considered a hierarchical model with subpopulation means that were described by the RRE. The distribution of the observables was assumed to be log-normal and the scale parameters were estimated from the data. We distinguished the following scenarios:</p>
<list list-type="bullet">
<list-item>
<p>one scale parameter that is shared across time points and subpopulations,</p></list-item>
<list-item>
<p>one scale parameter for every subpopulations, which is shared between time points,</p></list-item>
<list-item>
<p>10 scale parameters that differ for each subpopulation and time-point.</p></list-item>
</list>
<p>These scale parameters were estimated along with <italic>k</italic><sub>1,</sub>, <italic>k</italic><sub>1,2</sub>, <italic>k</italic><sub>2</sub>,<italic>k</italic><sub>3</sub>, and <italic>w</italic><sub>1</sub> for this setting, which corresponds to the ODE constrained mixture modeling described by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref>. For optimization, the kinetic parameters <italic>k<sub>i</sub></italic> were assumed to be in the interval [10<sup>&#x2212;3</sup>,10<sup>3</sup>], the weight <italic>w</italic><sub>1</sub> in [0,1], and the scale parameters for the log-normal distribution were restricted to the interval [10<sup>&#x2212;2</sup>,10<sup>2</sup>]. For each model we performed 50 multi-starts at randomly drawn initial points. The fits corresponding to the optimal parameter values are shown in <xref ref-type="fig" rid="figS1">Figure S1</xref>.</p>
</sec>
<sec id="s5e3">
<title>Hierarchical model using sigma-point approximations</title>
<p>For the hierarchical population model, the parameter vector for subpopulation <italic>s</italic> was given by <italic><bold>&#x03BE;</bold><sub>s</sub></italic> = (<italic><bold>&#x03B2;</bold><sub>s</sub></italic>, <bold>D</bold><sub><italic>s</italic></sub>) with
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn22.gif"/></alternatives>
</disp-formula>
and
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn23.gif"/></alternatives>
</disp-formula></p>
<p>To describe the introduced cell-to-cell variability in <italic>k</italic><sub>3</sub> <xref ref-type="disp-formula" rid="eqn10">(10)</xref> we used the sigma-point approximation for the log-parameters.</p>
<p>To assess whether the true source of heterogeneity can be detected, we tested all possible combinations of additional cell-to-cell variability in <italic>k</italic><sub>1,<italic>s</italic></sub>, <italic>k</italic><sub>2</sub>, or <italic>k</italic><sub>3</sub>. For this, the sigma-point approximation was applied to the logarithm of the observable, to link the mean and variance of the simulation directly to the distribution parameters of the log-normal distribution. The case of no additional cell-to-cell variability corresponds to the RRE models and is therefore not covered here.</p>
<p>For optimization, the kinetic parameters or their means (in case of cell-to-cell variability) were assumed to be in the interval [10<sup>&#x2212;3</sup>,10<sup>3</sup>], the scale parameters <italic>&#x03C3;<sub>k<sub>i</sub></sub></italic> and measurement noise <italic>&#x03C3;</italic><sub>noise</sub> in [10<sup>&#x2212;3</sup>, 10<sup>2</sup>] and the weight <italic>w</italic><sub>1</sub> in [0,1]. As for the RRE model, we performed 50 multi-starts. The fits corresponding to the optimal parameter values for each model are shown in <xref ref-type="fig" rid="figS1">Figure S1</xref>.</p>
<p>To evaluate how the method scales with the number of measured cells, we generated datasets with <italic>n<sub>j</sub></italic> = {10<sup>1</sup>,10<sup>2</sup>,10<sup>3</sup>, 10<sup>4</sup>,10<sup>5</sup>} measured cells per time point. The average computation time for three replicates for 10 optimization starts for the varying number of data points is shown in <xref ref-type="fig" rid="figS2">Figure S2</xref>. The contribution of the evaluation of the density <italic>&#x03D5;</italic>(<bold>&#x0079;&#x0304;</bold>|<italic>&#x03C6;<sub>s</sub></italic>) increased linearly with the number of data points. However, the simulation time was almost constant for increasing number of data points, since the simulation did not depend on the number of measured cells. The slight increase can be explained by the increased number of iterations needed for optimization, which might have occurred due to different effective optimizer tolerances that were not comparable for varying number of data points.</p>
</sec>
</sec>
<sec id="s5f">
<title>Differential protein expression</title>
<p>In the main manuscript, we investigated multivariate measurements of differential protein expression. Here, we provide the detailed description of the data generation and the data analysis using the hierarchical model for the full and the marginal distributions.</p>
<sec id="s5f1">
<title>Single-cell model</title>
<p>The simple model of differential protein expression considers six reactions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn24.gif"/></alternatives>
</disp-formula>
comprising the basal expression with rate &#x03BB;<sub>0</sub>, degradation with rate <italic>&#x03B3;</italic> and stimulus-induced expression, depending on <italic>u</italic>, with rate &#x03BB;<sub>A</sub> and &#x03BB;<sub>B</sub> for protein A and B, respectively. The corresponding ODE system for the temporal evolution of (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>) = ([A], [B]) is
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn25.gif"/></alternatives>
</disp-formula>
with initial conditions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn26.gif"/></alternatives>
</disp-formula>
obtained by assuming that the system was in steady state before the stimulus was added at 0 min. Two subpopulations were assumed, one showing high expression of A while the other shows high expression of B after stimulation with <italic>u</italic>. The degradation rate <italic>&#x03B3;</italic> was considered to be cell-to-cell variable,
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="171561_eqn11.gif"/></alternatives>
</disp-formula>
with median <italic>&#x03B2;<sub>&#x03B3;</sub></italic> and scale <italic>&#x03C3;<sub>&#x03B3;</sub></italic> which were equal between the subpopulations. The measurements were exposed to log-normally distributed multiplicative measurement noise parametrized by <italic>&#x03C3;</italic><sub>noise</sub>.</p>
</sec>
<sec id="s5f2">
<title>Hierarchical model</title>
<p>The hierarchical model accounted for the subpopulation variability of &#x03BB;<sub>A</sub> and &#x03BB;<sub>B</sub> and the cell-to-cell variability of <italic>&#x03B3;</italic>. This yielded the subpopulation parameters
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn27.gif"/></alternatives>
</disp-formula></p>
<p>As before, the sigma-point approximation was applied to the log-transformed parameters accounting for the log-normal distribution of <italic>&#x03B3;</italic>. We performed 100 starts using as data either the full or the marginal distribution of A and B. The parameters and corresponding boundaries are:</p>
<table-wrap id="utbl2" orientation="portrait" position="float">
<graphic xlink:href="171561_utbl2.tif"/>
</table-wrap>
<p>Using a statistical approach to obtain the number of converged starts (<xref ref-type="bibr" rid="c20">Hross and Hasenauer, 2016</xref>), we found that 84/100 starts converged for the full distribution and 91/100 for the marginal distributions.</p>
</sec>
</sec>
<sec id="s5g">
<title>NGF-induced Erk1/2 signaling</title>
<p>Here, we provide details for the analysis of NGF-induced Erk1/2 signaling. We employed the model proposed by <xref ref-type="bibr" rid="c17">Hasenauer et al. (2014)</xref>, which comprises the reactions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn28.gif"/></alternatives>
</disp-formula>
Conservation of mass yields
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn29.gif"/></alternatives>
</disp-formula></p>
<p>To eliminate structurally non-identifiable parameters, the model was reparametrized to
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="171561_eqn12.gif"/></alternatives>
</disp-formula>
with <italic>x</italic><sub>1</sub> = <italic>k</italic><sub>3</sub>[TrkA:NGF] and <italic>x</italic><sub>2</sub> = <italic>c<sub>p</sub></italic>[pErk]. The observables for the considered experimental conditions are
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn30.gif"/></alternatives>
</disp-formula>
to compare the subpopulations on poly-D-lysine (PDL) and
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn31.gif"/></alternatives>
</disp-formula>
to study the effects of the extracellular scaffolds PDL and collagen type I (Col I) on the neurons (PDL: <italic>e</italic> = 1, 3, 5, 7, Col I: <italic>e</italic> = 2, 4, 6, 8).</p>
<p>The pErk1/2, TrkA and Erk1/2 levels could only be measured up to some scaling constants denoted by <italic>c<sub>p</sub></italic>, <italic>c<sub>T</sub></italic> and <italic>c<sub>E</sub></italic>, respectively, and with some offsets denoted by <italic>o<sub>p</sub></italic>, <italic>o<sub>T</sub></italic> and <italic>o<sub>E</sub></italic>. Each observable was assumed to be subject to multiplicative log-normally distributed measurement noise parameterized by
<inline-formula><alternatives><inline-graphic xlink:href="171561_inline4.gif"/></alternatives></inline-formula>
For the comparison of the extracellular scaffold, the same scaling, offset, and measurement noise parameters were used for PDL and Col I. For each subpopulation, we used the sigmapoint approximation accounting for cell-to-cell variability in cellular TrkA activity and Erk1/2 levels. The covariance between TrkA activity and relative Erk1/2 expression was parametrized, accounting for correlations, with the matrix logarithm parametrization <italic>M</italic>(<italic>&#x03C3;<sub>p</sub></italic>, <italic>&#x03C3;<sub>p</sub></italic>, <italic>&#x03C3;<sub>TE</sub></italic>) &#x2208; &#x0211D;<sup>2&#x00D7;2</sup>. All other entries of <bold>D</bold><sub><italic>s</italic></sub> were assumed to be 0.</p>
<sec id="s5g1">
<title>Data pre-processing</title>
<p>For our analysis, we scaled each replicate such that the quadratic difference of the log-transformed fluorescence mean intensities across replicates is minimal (see <monospace>getScalingFactors.m</monospace>). The scaled intensities of the cells of each replicate were then pooled and analyzed together.</p>
</sec>
<sec id="s5g2">
<title>Subpopulation differences</title>
<p>We accounted for all possible combinations of subpopulation variability of <italic>k</italic><sub>1</sub>, <italic>k</italic><sub>2</sub>, <italic>k</italic><sub>4</sub>, <italic>k</italic><sub>5</sub>, <italic>k</italic><sub>3</sub>[TrkA]<sub>0</sub>, and
<inline-formula><alternatives><inline-graphic xlink:href="171561_inline5.gif"/></alternatives></inline-formula>
This yielded in total 2<sup>6</sup> = 64 models that were tested, ranging from <italic>n<sub>&#x03B8;</sub></italic> = 26 parameters, for the model assuming no subpopulations at all, to <italic>n<sub>&#x03B8;</sub></italic> = 33 parameters, assuming that the subpopulations differ in all parameters. To take into account all hierarchical models, we considered the BIC weights for model <italic>m</italic>
<disp-formula id="eqn13">
<alternatives><graphic xlink:href="171561_eqn13.gif"/></alternatives>
</disp-formula>
and obtained the BIC weights of a difference by summing over all models that included the corresponding difference.</p>
</sec>
<sec id="s5g3">
<title>Dephosphorylation rates</title>
<p>To validate, whether the two subpopulations differ in their dephosphorylation/phosphotase activity (parameterized by <italic>k</italic><sub>5</sub>), we inhibited cells with the Mek-inhibitor U0126 (10<italic>&#x03BC;</italic>M). NGF binds to the TrkA&#x002B; subpopulation and activates pErk1/2 signaling, whereas GDNF binds to the Ret receptor on the opposing subpopulation (TrkA-) and yields pErk1/2 signaling in this neuronal subgroup. Cells were pre-stimulated for 1h with the combined stimuli NGF (20 ng/ml) and GDNF (100 ng/ml) to obtain responses in both subpopulations. We measured pErk1/2 levels to obtain the dynamics of the dephosphorylation as well as TrkA levels to distinguish the two subpopulations. Cells were considered to belong to the TrkA&#x002B; subpopulation if their intensity was above 670 and to the TrkA-subpopulation if their intensity was below 630. The measurements were taken at 0,1, 4, 7,10,13,16,19, 22, 25, 28, 31, 34, and 37 min and collected for four replicates.</p>
<p>To obtain the de-phosphorylation rate <italic>k</italic><sub>5</sub>, we normalized the values of pErk1/2 to 1 at <italic>t</italic> =0 min and 0 at <italic>t</italic><sub>max</sub> = 37 min. We fitted an exponential decay
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn32.gif"/></alternatives>
</disp-formula>
to the scaled data of the four replicates. The scaling <italic>E<sub>c</sub></italic> and offset <italic>E<sub>o</sub></italic> could be determined from the boundary conditions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn33.gif"/></alternatives>
</disp-formula></p>
<p>This yielded the four values for the de-phosphorylation in the TrkA&#x002B; subpopulation and in the TrkA-subpopulation shown in <xref ref-type="fig" rid="figS3">Figure S3</xref>. A two-sample t-test with Welch&#x2019;s correction gave a p-value of 0.6163, indicating that the dephosphorylation rates in the two subpopulations were not significantly different.</p>
</sec>
<sec id="s5g4">
<title>Final model</title>
<p>The final model accounted for subpopulation differences in cellular TrkA activity (<xref ref-type="fig" rid="figS4">Figure S4A</xref>) and also took into account differences in the variance of TrkA activity between the subpopulations. The fits for the data, which are not shown in the main manuscript are visualized in <xref ref-type="fig" rid="figS4">Figure S4B</xref> for the multivariate measurements of pErk1/2 and TrkA, and in <xref ref-type="fig" rid="fig4">Figure 4C</xref> for the measurements of pErk1/2 and Erk1/2.</p>
</sec>
<sec id="s5g5">
<title>Differences mediated by extracellular scaffolds</title>
<p>For the mechanistic comparison of the influence of the extracellular scaffolds, we used the model which assumes subpopulation differences in TrkA levels. The differences between the extracellular scaffolds were parameterized as
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn34.gif"/></alternatives>
</disp-formula>
and the parameters were related by
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn35.gif"/></alternatives>
</disp-formula></p>
<p>Accounting for these 7 potential differences, we defined 128 hierarchical models. Each model was fitted to the data with multi-start local optimization using at least 20 starts. We sorted the models with respect to their BIC value, for which a low value indicates a good trade-off between model complexity and goodness of fit. The BIC weights for the differences were computed by summing over the BIC weights <xref ref-type="disp-formula" rid="eqn13">(13)</xref> of the models accounting for the corresponding differences. We found that the best model comprised differences in Erk1/2 expression, Erk1/2 dephosphorylation and cellular TrkA activity. The least suitable model was the model which did not allow differences between the extracellular scaffolds at all. This model was directly followed by the model only accounting for differences in the subpopulation weighting. The fit for the model accounting for differences in Erk1/2 expression, Erk1/2 dephosphorylation and cellular TrkA activity is shown in <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="figS5">Figure S5</xref>. The estimated parameters, their boundaries and the 95&#x0025; confidence interval are</p>
<table-wrap id="utbl3" orientation="portrait" position="float">
<graphic xlink:href="171561_utbl3.tif"/>
</table-wrap>
</sec>
</sec>
<sec id="sh">
<title>Accounting for intrinsic noise</title>
<p>To study the possibility of accounting for intrinsic noise in the hierarchical population model, we generated artificial data of a two stage gene expression (<xref ref-type="fig" rid="figS6">Figure S6A</xref>) using Gillespie&#x2019;s stochastic simulation algorithm (<xref ref-type="bibr" rid="c14">Gillespie, 1977</xref>) incorporated in the MATLAB Toolbox CERENA (<xref ref-type="bibr" rid="c25">Kazeroonian et al., 2016</xref>). The system comprises the following reactions
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn36.gif"/></alternatives>
</disp-formula></p>
<p>Here, mA denotes the mRNA and A the protein and we assumed that only A could be observed. The two subpopulations differed in their response to stimulus <italic>u</italic> yielding different rates <italic>k</italic><sub>2,1</sub> and <italic>k</italic><sub>2,2</sub>. For this setting, we only accounted for homogeneous and subpopulation variable parameters. However, the intrinsic variability of the births and deaths of individual molecules gave cell-to-cell variability in the cellular states. Cell-to-cell variability in parameters can also be incorporated using the moment-closure approximation.</p>
<p>The ODEs for the temporal evolution of the means and covariances were provided by the toolbox CERENA. In particular, the means <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> and the variances <italic>C</italic><sub>11</sub> and <italic>C</italic><sub>22</sub> of mRNA mA and protein A, respectively, were described as well as the correlation <italic>C</italic><sub>12</sub> of mA and A. The ODE system reads
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn37.gif"/></alternatives>
</disp-formula>
with system size &#x03A9; = 1000. Under the assumption that the system was in steady state before stimulation with <italic>u</italic> the initial conditions are
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn38.gif"/></alternatives>
</disp-formula></p>
<p>The true parameters used for the generation of the data were
<disp-formula>
<alternatives><graphic xlink:href="171561_ueqn39.gif"/></alternatives>
</disp-formula></p>
<p>In this example, we employed mixtures of normal distributions, for which the mean and variance were linked to the distribution parameters by <italic><bold>&#x03BC;</bold><sub>s</sub></italic> = <bold>m</bold><sub><italic>s</italic></sub> and <bold>&#x03A3;</bold><sub><italic>s</italic></sub> = <bold>C</bold><sub><italic>s</italic></sub>. First, we compared a model accounting for the mean, which was obtained by the RRE (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>), and a hierarchical model accounting for the mean and covariances, which were obtained by the moment-closure approximation (MA), both accounting for two subpopulations. For the RRE model 10 parameters for the parametrization of the variances were introduced, yielding in total <italic>n<sub>&#x03B8;</sub></italic> = 17. The model using the MA only comprised <italic>n<sub>&#x03B8;</sub></italic> = 7, since a mechanistic description of the variances was incorporated. For parameter estimation, the kinetic parameters were restricted to the interval [10<sup>&#x2212;3</sup>,10<sup>3</sup>] and the log<sub>10</sub>-transformed parameters were fitted, whereas the weight <italic>w</italic><sub>1</sub> was restricted to [0,1] and fitted linearly. For the RRE model, the parameters for the variance were assumed to lie within [10<sup>&#x2212;4</sup>,10<sup>2</sup>] and also fitted in log<sub>10</sub>-space. Second, we also studied two models that incorporate the mechanistic description of the variance by the MA, but did not consider the presence of two subpopulations (MA, no subpop.). One of these models, however, accounts for cell-to-cell variability of each parameter (MA, cell-to-cell variability, no subpop.), which corresponds to the description by <xref ref-type="bibr" rid="c51">Zechner et al. (2012)</xref>.</p>
<p>The models not accounting for subpopulation structures did not fit the data at all (<xref ref-type="fig" rid="figS6">Figure S6B</xref>). Even the included variability in parameters did not improve the fit substantially. In contrast, both subpopulation models provided a good fit to the data. However, the BIC for the MA model was substantially better than for the RRE model (BIC<sub>RRE</sub> &#x2013; BIC<sub>M</sub>A = 79.09). We found that the MA model gave the optimal value for 40&#x0025; of the starts and the optimization for the RRE model ended in the optimum for 36&#x0025; of the starts (<xref ref-type="fig" rid="figS6">Figure S6C</xref>). In terms of computation time there was a clear benefit using the mechanistic description of the variance (<xref ref-type="fig" rid="figS6">Figure S6D</xref>). The time required for one optimization start was about two-fold faster when using the MA (median = 6.43 sec) instead of RREs (median = 13.13 sec).</p>
<p>Furthermore, we studied the uncertainty of the parameter estimates using profile likelihoods (<xref ref-type="fig" rid="figS6">Figure S6E</xref>). Using the MA with subpopulations, all parameters were identifiable, indicated by a narrow profile. This was not the case for RREs, for which some parameters could not be identified from the the data and showed a flat profile. For the case of no subpopulations, most of the true parameters do not lie within the estimated intervals (<xref ref-type="fig" rid="figS6">Figure S6F-G</xref>). This emphasizes the importance of taking into account subpopulation structures.</p>
</sec>
</sec>
<sec id="s6">
<title>Statistical analysis</title>
<p>For the analysis of the differences in pErk1/2 activity in the kinetic and dose responses for PDL and Col I, we employed a two-way ANOVA and Sidak&#x2019;s post-hoc test using GraphPad Prism. For assessing the statistical significance of the predicted differences, we applied the two-sample Welch&#x2019;s t-test employed by the MATLAB function <monospace>ttest2</monospace>. Significances are indicated as <sup>&#x002A;</sup> (<italic>p</italic> &#x003C; 0.05), <sup>&#x002A;&#x002A;</sup> (<italic>p</italic> &#x003C; 0.01), and <sup>&#x002A;&#x002A;&#x002A;</sup> (<italic>p</italic> &#x003C; 0.001). Model selection was performed using the BIC. We computed confidence intervals based on the profile likelihoods.</p>
</sec>
<sec id="s7" sec-type="data-availability">
<title>Data and software availability</title>
<p>The toolbox ODEMM was used to implement the proposed hierarchical modeling framework as well as previous versions. This toolbox also provided the likelihood function and analytical gradient required for parameter estimation. The simulation of the means and covariance using sigma-points was implemented in the SPToolbox. Simulation of the RREs and corresponding sensitivity equations was conducted using the toolbox AMICI (<xref ref-type="bibr" rid="c13">Fr&#x00F6;hlich et al., 2016</xref>). For the parameter estimation, we employed the toolbox PESTO. All toolboxes and the experimental data are available at <monospace><ext-link ext-link-type="uri" xlink:href="https://github.com/ICB-DCM">https://github.com/ICB-DCM</ext-link></monospace>.</p>
<fig id="figS1" position="float" fig-type="figure">
<label>Figure S1:</label>
<caption>
<title>Fitted models for the conversion process.</title>
<p>Upper part: Models accounting only for the means using RREs according to (<xref ref-type="bibr" rid="c17">Hasenauer et al., 2014</xref>). Lower part: Models accounting for the means and variances using sigma-point approximations.</p>
</caption>
<graphic xlink:href="171561_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Figure S2:</label>
<caption>
<title>Computation time of the method for the conversion process.</title>
<p>The overall computation time for 10 starts is depicted for varying number of measured cells per time point. The circles indicate the mean for three replicates. Different contributions to the overall computation time needed are shown: The time needed for the evaluation of the values for the cells under the density of the mixture distribution (yellow) and the time needed for simulation (orange).</p>
</caption>
<graphic xlink:href="171561_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Figure S3:</label>
<caption>
<title>Erk1/2 dephosphorylation in TrkA- and TrkA&#x002B; subpopulations.</title>
<p>Erk1/2 phosphorylation was induced in both neuronal subgroups TrkA-(blue) and TrkA&#x002B; (red) by an 1 h treatment with the combined stimuli NGF (acting on TrkA&#x002B; neurons) and GDNF (acting on TrkA-neurons expressing the GDNF receptor Ret). subsequent inhibition of Mek by U0126 induced a pErk1/2 decline. Data of four individual experiments are shown with estimated exponential decay fit. The corresponding values <italic>k</italic><sub>5</sub> for the dephosphorylation are noted for both subpopulations.</p>
</caption>
<graphic xlink:href="171561_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Figure S4:</label>
<caption>
<title>Data and fit for NGF-induced Erk1/2 signaling on PDL.</title>
<p>(A) Pathway model with color-coding of the variability of cellular properties. (B,C) Data and fit for combined measurements of (B) TrkA and pErk1/2 levels and (C) Erk1/2 and pErk1/2 levels. The upper rows illustrate the data together with a kernel density estimate. The bottom rows visualize the data together with the contour lines of the hierarchical model.</p>
</caption>
<graphic xlink:href="171561_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Figure S5:</label>
<caption>
<title>NGF-induced Erk1/2 signaling on different extracellular scaffolds.</title>
<p>(A) Mean response to NGF stimulation on Col I compared to PDL. A two-way ANOVA showed significant differences (<italic>p</italic> &#x003C; 0.001) between the extracellular scaffolds for each experiment. Significances for individual time-points/doses obtained by Sidak&#x2019;s multiple comparisons test are indicated by <sup>&#x002A;</sup> (<italic>p</italic> &#x003C; 0.05), <sup>&#x002A;&#x002A;</sup> (<italic>p</italic> &#x003C; 0.01), and <sup>&#x002A;&#x002A;&#x002A;</sup> (<italic>p</italic> &#x003C; 0.001). (B-D) Data and fit for NGF-induced Erk1/2 signaling on different extracellular scaffolds. (B) pErk1/2 kinetics and dose responses for PDL (green) and Col I (purple). (C,D) Multivariate measurements of (C) pErk/TrkA levels and (D) pErk/Erk levels. The upper rows illustrate the data together with a kernel density estimate. The bottom rows visualize the data together with the contour lines of the hierarchical model, accounting for differences in Erk1/2 levels, Erk1/2 dephosphorylation, and cellular TrkA activity.</p>
</caption>
<graphic xlink:href="171561_figS5.tif"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Figure S6:</label>
<caption>
<title>Analysis of a stochastic two stage gene expression model.</title>
<p>(A) Illustration of the system. (B) Data and fitted models for the moment-closure approximation (MA), for the case of accounting for subpopulation structures and disregarding subpopulation structures, and reaction rate eqations (RRE). (C) Log-likelihood values for 100 optimization starts sorted decreasingly for MA (green) and RRE (blue). The zoom in shows the best 60 optimization runs. (D) Boxplot for the CPU time needed for one optimizer start. (E) Profile likelihoods of the parameters for the models capturing the subpopulation structure. (F) Profile likelihoods of the parameters for the model using the MA without accounting for subpopulations. (G) Profile likelihoods of the means rates for the model using the MA, accounting for cell-to-cell variability of all parameters but not for subpopulations. This corresponds to the method proposed by <xref ref-type="bibr" rid="c51">Zechner et al. (2012)</xref>. Note that the range in x-direction differs for subplots (E)-(G).</p>
</caption>
<graphic xlink:href="171561_figS6.tif"/>
</fig>
</sec>
</back>
</article>