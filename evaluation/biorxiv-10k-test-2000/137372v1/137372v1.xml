<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/137372</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Inferring Genetic Interactions from Comparative Fitness Data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Crona</surname><given-names>Kristina</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
<xref ref-type="author-notes" rid="n2">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Gavryushkin</surname><given-names>Alex</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
<xref ref-type="author-notes" rid="n2">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Greene</surname><given-names>Devin</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
<xref ref-type="author-notes" rid="n2">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0573-6119</contrib-id>
<name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Mathematics and Statistics, American University</institution>, Washington D.C.</aff>
<aff id="a2"><label>2</label><institution>Department of Biosystems Science and Engineering, ETH Zurich, Basel</institution>, Switzerland; SIB Swiss Institute of Bioinformatics, Basel, <country>Switzerland</country></aff>
</contrib-group>
<author-notes>
<fn id="n1"><label>1</label><p>E-mail addresses: <email>kcrona@american.edu</email>, <email>alex@gavruskin.com</email>, <email>deving@american.edu</email>, <email>niko.beerenwinkel@bsse.ethz.ch</email>.</p></fn>
<fn id="n2" fn-type="equal"><label>&#x002A;</label><p>Alphabetic order. These authors contributed equally.</p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>137372</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>5</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>5</month>
<year>2017</year>
</date>
</history><permissions><copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="137372.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>ABSTRACT</title>
<p>Darwinian fitness is a central concept in evolutionary biology. In practice, however, it is hardly possible to measure fitness for all genotypes in a natural population. Here, we present quantitative tools to make inferences about epistatic gene interactions when the fitness landscape is only incompletely determined due to imprecise measurements or missing observations. We demonstrate that genetic interactions can often be inferred from fitness rank orders, where all genotypes are ordered according to fitness, and even from partial fitness orders. We provide a complete characterization of rank orders that imply higher order epistasis. Our theory applies to all common types of gene interactions and facilitates comprehensive investigations of diverse genetic interactions. We analyzed various genetic systems comprising HIV-1, the malaria-causing parasite <italic>Plasmodium vivax</italic>, the fungus <italic>Aspergillus niger</italic>, and the TEM-family of <italic>&#x03B2;</italic>-lactamase associated with antibiotic resistance. For all systems, our approach revealed higher order interactions among mutations.</p>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>Fitness landscape</kwd>
<kwd>epistasis</kwd>
<kwd>gene interactions</kwd>
<kwd>fitness graph</kwd>
<kwd>rank order</kwd>
<kwd>partial order</kwd>
</kwd-group>
<counts>
<page-count count="44"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><label>1.</label><title>Introduction</title>
<p>The fitness of an individual with a particular genotype is a measure of its expected contribution to the next generation of the population. The collection of all fitness values for all genotypes, referred to as the fitness landscape, is a central concept in evolutionary biology (<xref ref-type="bibr" rid="c36">Wright 1932</xref>; <xref ref-type="bibr" rid="c19">Orr 2009</xref>). The fitness landscape can have a strong impact on the fate of the evolving population, such as, for example, the risk of a pathogen population to develop drug resistance and to survive under drug treatment.</p>
<p>Genetic interactions, or epistasis, are abundant in nature. They can have many causes and occur at various scales, for instance, among mutations of a protein-coding sequence or between sequences coding for different genes. Unless there are genetic interactions, we assume that fitness is additive, i.e., the fitness effects of individual mutations sum. An additive fitness landscape is determined by the wild-type and single-mutant fitness values.</p>
<p>If the fitness landscape is determined by the wild-type, singlemutant, and double-mutant fitness values, then we say that it has no higher order epistasis. Intuitively, higher order epistasis means that the fitness of a multiple mutant is unexpected given the fitness of the wild type and all single and double mutants. For example, Weinreich, Delaney, et al. (2006) showed that five mutations jointly increase antibiotic resistance considerably more than expected.</p>
<p>Measuring fitness experimentally is challenging. Fitness measurements tend to come with high uncertainty and they are often obtained only for a subset of genotypes. Moreover, fitness can sometimes not be measured directly at all. Instead, phenotypes are considered that can be measured and are believed to approximate fitness well. For instance, antimicrobial drug resistance is the dominating survival factor for a bacterial population under drug exposure, so that the degree of resistance is a good substitute measure of fitness. Several such fitness proxies are used in microbiology, including survival as measured by disc diffusion tests. Fitness proxies cannot in general be used for determining epistasis. Although it is possible to study epistasis of the proxy phenotype, additive proxy data does not in general imply absence of epistasis with respect to fitness.</p>
<p>Experimentally, epistatic interactions have been measured in several genetic systems, including <italic>E. col&#x2211;</italic><sub><italic>i</italic></sub>Khan et al. 2011; Weinreich, Delaney, et al. 2006; Poelwijk, Kiviet, et al. 2007), HIV-1 (Silva et al. 2010; <xref ref-type="bibr" rid="c27">Segal, Barbour, and Grant 2004</xref>), and other viruses (<xref ref-type="bibr" rid="c38">Wylie and Shakhnovich 2011</xref>; Sanju&#x00E1;n 2010). These and similar studies involve the analysis of standing genetic variation or spontaneous mutations (Bonhoeffer et al. 2004; Bershtein et al. 2006), engineered site-directed mutations (Sanju&#x00E1;n, Moya, and Elena 2004; Weinreich, Delaney, et al. 2006), and combinations of both (Sanju&#x00E1;n, Cuevas, et al. 2005; <xref ref-type="bibr" rid="c22">Poon and Chao 2006</xref>). Competition experiments are also frequently employed to learn mutational fitness effects. For example, Sanju&#x00E1;n, Moya, and Elena (2004) studied the distribution of deleterious mutational effects in RNA viruses using this approach. Such experiments are typically run on single-nucleotide substitution mutants produced by site-directed mutagenesis. However, little is known about whether or not it is possible to learn higher order genetic interactions from the data produced in competition experiments.</p>
<p>Due to the rapid growth of the number of possible interactions with the number of loci, all interactions can exhaustively be studied only for a small number of loci. At the human genome scale, for example, a complete study of only pairwise gene interactions would already require hundreds of millions of experiments. On the other hand, for smaller organisms, such as yeast, all pairwise and several three-way gene interactions have been measured experimentally (Costanzo et al. 2010). Only when restricting to a small set of preselected loci, can one assess all combinations of mutations. This approach has been pursued, for example, by Weinreich, Delaney, et al. (2006) for a five-locus system associated with bacterial drug resistance.</p>
<p>Historically, the study of genetic interactions was mostly restricted to pairwise epistasis. According to Crow and Kimura (p. 224, 1970) higher order interactions were generally believed not to be significant in nature, with references to Fisher, Haldane, and Wright. More recent arguments for the same view have been stated in the context of protein folding (<xref ref-type="bibr" rid="c12">Gupta and Adami 2016</xref>). On the other hand, empirical findings suggest that the opposite is true for many other systems. For example, Weinreich, Lan, et al. (2013) argue that three-way and four-way interactions can be as strong as pairwise epistasis and refer to various empirical fitness studies. A similar view is expressed in <xref ref-type="bibr" rid="c23">Sailer and Harms (2017)</xref>. Although the significance of higher order interactions may vary between systems, the topic has not been thoroughly investigated. This is partly due to lack of adequate methodology to quantitatively assess the interactions underlying an observed empirical fitness landscape. Improved mathematical and statistical tools for detecting higher order interactions, as well as more empirical results, are necessary for more conclusive answers regarding the importance of higher order interactions.</p>
<p>In this paper, we consider fitness data that comes in the form of pairwise comparisons. Such data are frequent in practice and can arise in different ways. First, some assays rely on comparing the fitness of two genotypes, for example, by letting them grow in direct competition. Each competition experiment is informative about which of the two genotypes has higher fitness, without estimating the fitness values themselves. Second, direct but uncertain fitness measurements are also often summarized as pairwise fitness relations by recording only whether two genotypes displayed significantly different fitness values or not. Third, rather than fitness itself, a fitness proxy, i.e., a phenotype closely related to fitness, may be considered. Fitness proxies cannot be used directly to measure epistasis, because they generally do not preserve fitness linearity (<xref ref-type="bibr" rid="c10">Gong, Suchard, and Bloom 2013</xref>), but if proxy data preserves pairwise comparisons, they may be used instead. Lists of mutants found in a new environment, such as, for example, a new host for a pathogen or a drug environment can be utilized similarly. Assuming that the capability to transition to and survive in the new environment is an indication of higher fitness, this type of observational data also provides pairwise fitness comparisons. Similarly, the population frequency of genotypes can sometimes be considered to draw conclusions about fitness. For example, by employing a specific model of viral evolution, fitness was inferred computationally from deep sequencing data of an HIV-1 population, and pairwise credible fitness differences were reported (Seifert et al. 2015).</p>
<p>Irrespective of how they were obtained, any consistent set of pairwise fitness relations can be regarded as a partial order of the genotypes with respect to fitness. Two specific types of partial orders play important roles for fitness landscapes. First, if comparisons are available for all pairs of genotypes, then the partial order is a total order, or rank order. In this case, all genotypes are ordered according to fitness. Second, several studies compare fitness only between mutational neighbors, i.e., genotypes which differ at exactly one locus. The resulting partial orders are referred to as fitness graphs and have recently been used extensively (Ogbunugafor, Wylie, et al. 2016; Wu et al. 2016; <xref ref-type="bibr" rid="c30">Smith and Cobey 2016</xref>; Mira et al. 2015).</p>
<p>The question addressed in the present study is whether higher order interactions can be inferred from rank orders, fitness graphs, and general partial orders. Connections between rank orders and fitness graphs to epistasis and global properties of fitness landscapes have been observed repeatedly (<xref ref-type="bibr" rid="c11">Greene and Crona 2014</xref>; Poelwijk, T&#x0103;nase-Nicola, et al. 2011; Weinreich, Delaney, et al. 2006; <xref ref-type="bibr" rid="c35">Weinreich, Watson, and Chao 2005</xref>). Most recently, Wu et al. (2016) discussed an example of a fitness graph that implies higher order epistasis. It is known that some fitness graphs imply epistasis and an exact condition was given in <xref ref-type="bibr" rid="c6">Crona, Greene, and Barlow (2013)</xref>. The significance of rank orders of genotypes for epistasis was recognized by <xref ref-type="bibr" rid="c35">Weinreich, Watson, and Chao (2005)</xref>. The authors introduced the concept of sign epistasis, which refers to the two-locus system. Here, we develop a more general approach that applies to any number of loci and can be regraded as a higher order analogue to sign epistasis. In addition to the theoretical work mentioned above, rank order arguments have been used for developing antimicrobial treatment strategies (e.g <xref ref-type="bibr" rid="c30">Smith and Cobey 2016</xref>; Nichol et al. 2015; Mira et al. 2015).</p>
<p>However, the full potential of rank order consideration for the comprehensive analysis of epistatic gene interactions in general <italic>n</italic>-locus genetic systems has not been exploited. Furthermore, to the best of our knowledge the general case of arbitrary partial fitness orders has yet to be considered.</p>
<p>Here, we develop quantitative tools to detect virtually any type of gene interaction described in the literature, including epistasis as described by Fourier coefficients, Walsh coefficients, and circuits (Beeren-winkel, Pachter, and Sturmfels 2007; Weinreich, Lan, et al. 2013). In particular, our approach applies to total <italic>n</italic>-way epistasis, conditional epistasis, and marginal epistasis. We used our approach to analyze genetic interactions in HIV-1, the parasite <italic>Plasmodium vivax</italic>, the fungus <italic>Asbergillus niger</italic>, and <italic>&#x03B2;</italic>-lactamase antibiotic resistance systems. In all cases, we detect higher order interactions based only on partial information about the fitness order of genotypes, without knowing or estimating the actual fitness values.</p>
</sec>
<sec id="s2"><label>2.</label><title>Results</title>
<p>We consider genetic systems consisting of <italic>n</italic> biallelic loci. A genotype can then be represented as a binary string of zeros and ones of length <italic>n</italic>, where 0 denotes the wild-type allele and 1 the alternative allele. We assume that fitness is additive in the absence of epistasis. The fitness of a genotype <italic>g</italic> is denoted by <italic>w</italic><sub><italic>g</italic></sub>, and we assume that the fitness landscape <italic>w</italic> is generic in the sense that no two genotypes have exactly the same fitness.</p>
<p>A complete analysis of all epistatic interactions would require fitness measurements of all 2<sup><italic>n</italic></sup> genotypes. However, this level of completeness is rarely available in empirical data sets due to experimental design or an infeasible number of genotypes. To address this limitation, we developed methods that are applicable to partial orders of genotypes according to fitness. For example, the two fitness relations <italic>w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>00</sub> and <italic>w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>11</sub> together define a partial order. One can always extend a partial order to a rank order, i.e., a total order of the genotypes in the system from highest to lowest fitness. For example, the total order <italic>w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>11</sub> <italic>&#x003E; w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>00</sub> extends the partial order above. Our goal is to understand what fitness rank orders and more generally partial fitness orders of genotypes reveal about gene interactions.</p>
<sec id="s2a"><title>Two-locus case</title>
<p>We first consider epistasis for a biallelic two-locus population consisting of the unmutated genotype, or wild type, 00, the two single mutants 01 and 10, and the double mutant 11. In this case, epistasis is denoted by <italic>&#x03B5;</italic><sub>2</sub>, where the index 2 refers to the number of loci. It is defined as the deviation from additivity,
<disp-formula id="eqn1"><alternatives><graphic xlink:href="137372_eqn1.gif"/></alternatives></disp-formula></p>
<p>The system has no epistasis if <italic>&#x03B5;</italic><sub>2</sub> = 0, positive epistasis if <italic>&#x03B5;</italic><sub>2</sub> <italic>&#x003E;</italic> 0 and negative epistasis if <italic>&#x03B5;</italic><sub>2</sub> <italic>&#x003C;</italic> 0.</p>
<p>We first assume that the available information on fitness is a rank order of the genotypes (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The rank order is sometimes sufficient for determining that the system has epistasis. For instance, the rank order <italic>w</italic><sub>11</sub> <italic>&#x003E; w</italic><sub>00</sub> <italic>&#x003E; w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>01</sub> (<xref ref-type="fig" rid="fig1">Figure 1</xref> rank order 3), implies <italic>w</italic><sub>00</sub> &#x002B; <italic>w</italic><sub>11</sub> <italic>&#x003E; w</italic><sub>01</sub> &#x002B; <italic>w</italic><sub>10</sub>, so <italic>&#x03B5;</italic><sub>2</sub> <italic>&#x003E;</italic> 0. It follows that the rank order alone allows one to detect positive epistasis without knowledge of the actual fitness values. There are 24 rank orders of the biallelic two-locus system. Among these, eight imply positive epistasis, eight imply negative epistasis, and eight do not permit any inference regarding epistasis. In total two thirds of the rank orders imply epistasis. Each rank order which implies epistasis also determines the sign of <italic>&#x03B5;</italic><sub>2</sub> (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p>
<fig id="fig1" position="float" fig-type="figure"><label>FIGURE 1.</label>
<caption><p>All 24 rank orders of the biallelic two-locus system, where the 16 colored rank orders imply epistasis. Red (top row) indicates positive epistasis and blue (middle row) negative epistasis.</p></caption>
<graphic xlink:href="137372_fig1.tif"/>
</fig>
<p>Sometimes even a partial order of the genotypes is sufficient for determining that the system has epistasis. For instance, if we know that <italic>w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>00</sub> and <italic>w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>11</sub>, then we can infer that the system has negative epistasis (<xref ref-type="fig" rid="fig2">Figure 2</xref> (a)). To see this, we consider all rank orders that extend the partial order. There are six such total extensions, namely rank orders 9, 10, 12, 13, 14, and 16 in <xref ref-type="fig" rid="fig1">Figure 1</xref>, and all imply negative epistasis. We conclude that the partial order implies epistasis, based on only two fitness comparisons and without knowing any of the actual fitness values. This observation holds in general: If all total extensions imply epistasis then the same is true for the partial order. We will use this argument repeatedly.</p>
<fig id="fig2" position="float" fig-type="figure"><label>FIGURE 2.</label>
<caption><p>(a) A partial fitness order of genotypes. The rank orders that extend this partial order are orders (9), (10), (12), (13), (14), and (16) in <xref ref-type="fig" rid="fig1">Figure 1</xref>. All of them imply negative epistasis (<italic>&#x03B5;</italic><sub>2</sub> <italic>&#x003C;</italic> 0). (b) A partial order of genotypes with all its total extensions shown on the right. The first extension shown in red implies positive epistasis (<italic>&#x03B5;</italic><sub>2</sub> <italic>&#x003E;</italic> 0), while the second one in black does not.</p></caption>
<graphic xlink:href="137372_fig2.tif"/>
</fig>
<p>A partial order can also be compatible with several rank orders, some of which might imply epistasis while others do not. In this case, the information is not sufficient to detect epistasis from the partial order alone. For example, the partial order <italic>w</italic><sub>00</sub> <italic>&#x003E; w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>10</sub>, <italic>w</italic><sub>11</sub> is compatible with the two rank orders <italic>w</italic><sub>00</sub> <italic>&#x003E; w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>11</sub> <italic>&#x003E; w</italic><sub>10</sub> and <italic>w</italic><sub>00</sub> <italic>&#x003E; w</italic><sub>01</sub> <italic>&#x003E; w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>11</sub> (<xref ref-type="fig" rid="fig2">Figure 2</xref>(b)). The first rank order implies positive epistasis, but the other one does not. Consequently, the partial order does not reveal whether or not the system has epistasis, and further comparisons are needed for a conclusion.</p>
<p>Fitness graphs constitute an important subclass of partial orders, as they often are the reported result of experiments, and because of their relevance for evolutionary processes (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Briefly, the nodes of a fitness graph represent genotypes and for each pair of mutational neighbors, i.e., genotypes which differ at exactly one locus, an arrow points toward the genotype of higher fitness (SectionA.3).</p>
<fig id="fig3" position="float" fig-type="figure"><label>FIGURE 3.</label>
<caption><p>For a biallelic two-locus system where the genotype 00 has the lowest fitness, there are four fitness graphs. The graph (a) is compatible with additive fitness, whereas the remaining graphs imply negative epistasis.</p></caption>
<graphic xlink:href="137372_fig3.tif"/>
</fig>
<p>A fitness graph implies epistasis exactly when all rank orders compatible with the graph do, as is the case for partial orders in general. For example, <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the four fitness graphs where genotype 00 has lowest fitness in the system. The graphs (b), (c) and (d) imply epistasis, whereas (a) is compatible with additive fitness.</p>
<p>A couple of observations from <xref ref-type="fig" rid="fig3">Figure 3</xref> are useful for determining if a system is compatible with additive fitness. First, any rank order compatible with the graph (a) has the following property: For each genotype, replacing 0 by 1 results in a genotype of higher fitness. If the genotype 00 has minimal fitness in the system, then rank orders are compatible with additive fitness exactly if they satisfy the property. The second observation is that a fitness graph such that 00 has minimal fitness is compatible with additive fitness exactly if all arrows point up. Both observation generalize to any number of loci, and can be phrased in full generality (see Section A.3).</p>
</sec>
<sec id="s2b"><title>Three-locus case</title>
<p>The biallelic three-locus system consists of the eight genotypes 000, 001, 010, 011, 100, 101, 110, and 111. The system has total three-way epistasis if
<disp-formula id="eqn2"><alternatives><graphic xlink:href="137372_eqn2.gif"/></alternatives></disp-formula></p>
<p>For the three-locus system, we distinguish between fitness landscapes with no epistasis (fitness is additive), with pairwise but not higher order epistasis (fitness is not additive but <italic>&#x03B5;</italic><sub>3</sub> = 0), and with three-way epistasis (<italic>&#x03B5;</italic><sub>3</sub> <italic>&#x2260;</italic> 0)</p>
<p>Some rank orders imply three-way epistasis, similar to our observation of epistasis in the two-locus case. The condition for when a rank order implies three-way epistasis is remarkably simple, and we demonstrate it with an example. Consider the rank order
<disp-formula id="eqn3"><alternatives><graphic xlink:href="137372_eqn3.gif"/></alternatives></disp-formula>
We can represent this rank order by a word in the letters <italic>e</italic> and <italic>o</italic> using the following procedure. The genotype 110 with the highest fitness is represented by <italic>e</italic> because it has an even number of 1&#x2019;s, the genotype 111 with the second highest fitness is represented by <italic>o</italic> because it has an odd number of 1&#x2019;s, and so forth. Working from highest to lowest fitness, we obtain the word
<disp-formula id="eqn4"><alternatives><graphic xlink:href="137372_eqn4.gif"/></alternatives></disp-formula>
If one reads the word letter by letter from left to right, then one has never encountered more <italic>o</italic>&#x2019;s than <italic>e</italic>&#x2019;s. This property means that <italic>eoeeooeo</italic> is a Dyck word (<xref ref-type="bibr" rid="c31">Stanley 1999</xref>).</p>
<p>For a biallelic three-locus system, a rank order implies three-way epistasis exactly if its associated word (where the role of <italic>e</italic> and <italic>o</italic> can be interchanged) is a Dyck word (Supplementary Information, Proposition 1). This simple rule allows us to conclude that an empirical system has three-way epistasis. As in the two-locus case, a landscape may have three-way epistasis even if the rank order does not imply it. For biallelic three-locus systems, there are in total 40,320 rank orders, of which 16,128 (40&#x0025;) imply three-way epistasis (Supplementary Information, Proposition 1).</p>
<p>Fitness graphs can be analyzed by using our results on rank orders as in the two-locus case. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows three fitness graphs for three-locus systems. The fitness graph (a) implies three-way epistasis, the graph (b) pairwise but not higher order epistasis, and the graph (c) is compatible with additive fitness.</p>
<fig id="fig4" position="float" fig-type="figure"><label>FIGURE 4.</label>
<caption><p>The fitness graph (a) implies three way epistasis, the graph (b) implies epistasis, but not higher order epistasis, and (c) does not imply epistasis, since all arrows point up.</p></caption>
<graphic xlink:href="137372_fig4.tif"/>
</fig>
<p>There are in total 1, 862 fitness graphs for the biallelic three-locus system, of which 698 graphs (37&#x0025;) imply three-way epistasis. In principle one can check a particular three-locus system for higher order epistasis using this result. However, it is not convenient to work with a list of over one thousand graphs. In order to make the problem more tractable, we can utilize the fact that some fitness graphs are isomorphic (Supplementary <xref ref-type="fig" rid="fig8">Figure 8</xref>). There are 54 distinct isomorphism classes of graphs for the three-locus system, of which 20 imply higher order epistasis (Supplementary Information, Section A.3). Consequently, to detect three-way epistasis, one can find the isomorphism class and then check 54 graphs, namely one for each isomorphism class (Supplementary Information, <xref ref-type="fig" rid="fig10">Figure 10</xref>).</p>
<fig id="fig10" position="float" fig-type="figure"><label>FIGURE 10.</label>
<caption><p>All 54 fitness graph types. Those depicted in red imply three-way epistasis.</p></caption>
<graphic xlink:href="137372_fig10.tif"/>
<graphic xlink:href="137372_fig10a.tif"/>
<graphic xlink:href="137372_fig10b.tif"/>
</fig>
<p>We complete the consideration of the three-locus case by analyzing partial orders. Again, in favorable cases one can infer three-way epistasis. Indeed, if there exists a partition of all eight genotypes into four pairs (<italic>g</italic><sub><italic>e</italic></sub>, <italic>g</italic><sub><italic>o</italic></sub>), where <italic>e</italic> and <italic>o</italic> are as above, and <inline-formula><alternatives><inline-graphic xlink:href="137372_inline1.gif"/></alternatives></inline-formula> for each pair, then one can conclude three-way epistasis (Supplementary Information, Proposition 7).</p>
</sec>
<sec id="s2c"><title>General <italic>n</italic>-locus case</title>
<p>The results on rank orders and higher order epistasis for <italic>n</italic> = 3 generalize to any number of loci. The definition of <italic>n</italic>-way epistasis in an <italic>n</italic>-locus system is analogous to the three-locus case, as is the condition for when rank orders imply <italic>n</italic>-way epistasis. Accordingly, a characterization of rank orders that imply <italic>n</italic>-way epistasis can be phrased in terms of Dyck words (Supplementary Information, Proposition 1). From this result it follows that the fraction of rank orders that imply <italic>n</italic>-way epistasis is 2<italic>/</italic>(2<sup><italic>n-</italic>1</sup> &#x002B; 1) (Supplementary Information, Corollary 2) and that it can be determined in a computationally efficient manner whether or not a rank order implies <italic>n</italic>-way epistasis.</p>
<p>Rank order methods are useful for analyzing the total <italic>n</italic>-way epistasis for an <italic>n</italic>-locus system, as demonstrated. However, a single quantity cannot capture all possible gene interactions. Rank order approaches have the capacity to reveal finer interactions as well. We start with a description of gene interactions based on the approach in (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>), before exploring what rank orders can reveal about these interactions. For simplicity, we restrict our analysis to the three-locus system, although the arguments used are readily extendable to any number of loci <italic>n</italic>.</p>
<p>First, we consider gene interactions that directly correspond to the two-locus case by fixing one allele at the third locus. For example, if we fix the third locus at 0, then
<disp-formula id="ueqn1"><alternatives><graphic xlink:href="137372_ueqn1.gif"/></alternatives></disp-formula>
measures pairwise epistasis between the first and second locus. Similarly, if we set the third locus to 1, then
<disp-formula id="ueqn2"><alternatives><graphic xlink:href="137372_ueqn2.gif"/></alternatives></disp-formula>
measures pairwise epistasis between the first and the second locus. The interactions described by <italic>a</italic> and <italic>b</italic> are referred to as conditional epistasis.</p>
<p>An example of an interaction with no correspondence in the two-locus setting is
<disp-formula id="ueqn3"><alternatives><graphic xlink:href="137372_ueqn3.gif"/></alternatives></disp-formula>
which compares the fitness of the triple mutant 111 to the three single mutants. This expression is negative if the triple mutant has higher fitness than one would expect based on the fitness effects of the three single mutations. Expressions of these kinds are known as circuits, or minimal dependence relations, and for the biallelic three-locus system, there are twenty of them in total, including <italic>a</italic>, <italic>b</italic>, and <italic>m</italic> (Supplementary Information, Section A.2).</p>
<p>If interactions <italic>a</italic> and <italic>b</italic> differ substantially, it may be important to consider both of them. However, sometimes we are rather interested in the average interaction for two loci, i.e., epistasis averaged over all genetic backgrounds. We refer to such average effects as interaction coordinates. The four interaction coordinates differ from Walsh coefficients only by a constant scaling factor.</p>
<p>Arguments based on Dyck words can be used for analyzing rank orders and finer gene interactions, including interaction coordinates and circuits, exactly as for three-way epistasis. For each circuit and interaction coordinate, we identify all rank orders that determine its sign. The characterization is given in terms of general Dyck word conditions. We found that for each interaction coordinate, 2<italic>/</italic>5 of all rank orders determine its sign; for each circuit corresponding to either conditional two-way interaction or marginal epistasis between two pairs of loci, 2<italic>/</italic>3 of all rank orders determine its sign; and for each circuit relating the three-way interaction to the total two-way epistasis, 1<italic>/</italic>2 of all rank orders determine its sign (Supplementary Information, Corollary 4).</p>
<p>The signs of all twenty circuits determines the polyhedral shape of the fitness landscape (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>). The shape combines the circuit information into a more manageable object. However, no rank order determines a shape for <italic>n</italic> = 3 (Supplementary Information, Section A.2).</p>
<p>Our tools for detecting gene interactions work for total <italic>n</italic>-way epistasis, interaction coordinates and circuits. Moreover, our approach applies to any type of gene interaction that can be expressed by a linear form (Supplementary Information, Theorem 3), such as Fourier coefficients (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>) and Walsh coefficients (Weinreich, Lan, et al. 2013). We have implemented algorithms for detecting the gene interactions described in this section, both for rank orders and partial orders for three locus systems (<monospace><ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#fitlands">https://github.com/gavruskin/fitlands#fitlands</ext-link></monospace>). In particular, algorithms for three-way epistasis, interaction coordinates and circuits are provided (Supplementary Information, Section B).</p>
</sec>
<sec id="s2d"><title>Analysis of empirical fitness data</title>
<p>As proof of principle, we applied our tools to fitness data from a diverse set of biological systems, ranging from HIV-1 (<xref ref-type="bibr" rid="c27">Segal, Barbour, and Grant 2004</xref>), malaria (<xref ref-type="bibr" rid="c17">Ogbunugafor and Hartl 2016</xref>), antibiotic resistance (Mira et al. 2015), to the fungus <italic>Aspergillus Niger</italic> (Franke et al. 2011). Our approach reveals higher order epistasis for all of these systems, only by considering rank orders and partial orders of genotypes, without the need to access direct fitness measurements or estimates.</p>
<p>Our first application is to the HIV-1 data published by <xref ref-type="bibr" rid="c27">Segal, Barbour, and Grant (2004)</xref>. Following <xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels (2007)</xref>, we consider the three-locus biallelic system that consists of the mutation L90M in the protease and mutations M184V and T215Y in the reverse transcriptase of HIV-1. Fitness was measured as the number of offspring in a single replication cycle of the virus in the original study, and was reported relative to the wild-type strain NL4-3 on a logarithmic scale. The data consist of 288 fitness measurements, including between 5 and 214 replicates per genotype.</p>
<p>The following rank order was obtained by comparing the mean fitness of the eight genotypes:
<disp-formula id="ueqn4"><alternatives><graphic xlink:href="137372_ueqn4.gif"/></alternatives></disp-formula>
where 000 corresponds to the sequence of amino acids LMT and 111 to MVY comprising the three selected loci. This rank order implies positive three-way epistasis because the associated word
<disp-formula id="ueqn5"><alternatives><graphic xlink:href="137372_ueqn5.gif"/></alternatives></disp-formula>
is a Dyck word. It follows that the three mutations under consideration together have a stronger effect on fitness than one would predict from single and double mutants. A closer inspection of the word reveals more information. If we swap any two adjacent letters in the word, then we still have a Dyck word, with the single exception of the first two letters. In other words, only one pair of adjacent genotypes in the rank order, namely 000 and 100, could violate the conclusion if transposed.</p>
<p>If the experiment was to continue, our analysis could be used to direct the data collection process. Indeed, the argument above suggests that the position of the genotype 100 may violate the conclusion of positive three-way epistasis. To quantify the uncertainty in the ranking of 100 with respect to the wild type 000, we employed the Wilcoxon rank sum test on the replicate fitness measurements. The p-value of the test is 0.47 for the relation <italic>w</italic><sub>000</sub> <italic>&#x003E; w</italic><sub>100</sub>, which implies considerable uncertainty and justifies our recommendation of further experiments to clarify the position of 100. Importantly, the suggested experiment reduces the number of measurements required to make a more robust conclusion about epistasis considerably, namely to one out of 28 possible comparisons.</p>
<p>We proceeded by considering other types of gene interactions in this data set. When considering all 20 circuits, the rank order implies interactions for 55&#x0025; of the circuits, with positive sign for 30&#x0025; and negative for 25&#x0025; of the circuits. This result is consistent with the conventional statistical approaches that use direct fitness measurements. Indeed, since the empirical study of <xref ref-type="bibr" rid="c27">Segal, Barbour, and Grant (2004)</xref> provided multiple fitness measurements of each genotype, it was possible to compare the conclusions of our analysis with statistical tests based on fitness estimates (Supplementary Information, Section B). Testing for interactions directly based on the replicate fitness measurements of each genotype confirmed our results based only on the rank order. Specifically, both approaches detected three-way epistasis. Furthermore, 11 of the 20 circuit interactions have been detected by our method and confirmed by t-test. In addition to the 11 interactions, the t-test found 6 circuit interactions as significant (Supplementary Information, <xref ref-type="table" rid="tbl2">Table 2</xref>). We emphasize that the rank order approach required much less information to arrive at the same conclusions, thus demonstrating the power of the method.</p>
<p>We conclude that the three sites in the HIV-1 genome under consideration are prone to a diverse set of interactions. Specifically, the strong support for the three-way epistasis, along with the 55&#x0025; of informative circuit interactions, imply that the three loci together interact in a complex manner, meaning that the interactions cannot be explained using pairwise interactions alone. Thus, in this data set, higher order interactions have a strong impact on the fitness landscape.</p>
<p>Our second application is to a study of antimicrobial drug resistance in malaria (<xref ref-type="bibr" rid="c17">Ogbunugafor and Hartl 2016</xref>). The authors measured growth rates for several mutants of <italic>Plasmodium vivax</italic> under exposure to the antimalarial drug pyrimethamine. We identified higher order epistasis by analyzing rank orders. More precisely, we considered a three-locus sub-system of the study that consists of mutations N50I, S58R, and S117N, in the context of T173L, a fixed mutation, under nine different concentrations of pyrimethamine. The genotypes comprising positions 50, 58, and 117 are labeled 000 (NSS), 100, 010, 001, 110, 101, 011, and 111 (IRN). The three highest concentrations of the drug resulted in the following rank orders:
<disp-formula id="ueqn6"><alternatives><graphic xlink:href="137372_ueqn6.gif"/></alternatives></disp-formula></p>
<p>The corresponding words are <italic>oeoeooee</italic> for the first rank order, obtained under the highest concentration of the drug, and <italic>oeoooeee</italic> for the second and third rank orders. Since we obtain Dyck words in all cases, the system has negative three-way epistasis for the three highest concentrations of the drug. This consistency shows that the result is robust.</p>
<p>Next, we applied our tools to a study of the TEM-family of <italic>&#x03B2;</italic>-lactamase, associated with antibiotic resistance (Mira et al. 2015), The study measured growth rates for 16 genotypes exposed to 15 different antibiotics. Specifically, all 16 genotypes that combine subsets of the four amino acid substitutions M69L, E104K, G238S, N276D found in TEM-50, including eight known enzymes, were created using sitedirected mutagenesis. We considered the fitness graph obtained when the system was exposed to the antibiotic FEP Cefepime at a concentration of 0.0156 <italic>&#x03BC;</italic>g/ml (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The fitness graph implies higher order epistasis (Supplementary Information, Proposition 7), that is, the fitness of TEM-50 cannot be predicted even with complete knowledge of the fitness values of the remaining genotypes in the system. We conclude that even though some of the single and triple mutants confer low antibiotic resistance, a large population of triple mutants alone is more prone to become antibiotic resistant due to the epistatic fitness advantage of TEM-50, as compared to a setting with no higher order epistasis.</p>
<fig id="fig5" position="float" fig-type="figure"><label>FIGURE 5.</label>
<caption><p>The TEM-family of <italic>&#x03B2;</italic>-lactamase contributes to antibiotic resistance problems in hospitals. The fitness graph shows a four-locus system consisting of the wild type, TEM-1, the quadruple mutant, TEM-50, and all intermediate mutants, including six clinically found mutants in the TEM family. The mutation M69L corresponds to 1000, E104K to 0100, G238S to 0010, and N276D to 0001. Growth rates were measured for the 16 genotypes under exposure to the antibiotic FEP Cefepime, and the fitness graph was determined accordingly (Mira et al. 2015). The graph reveals higher order epistasis.</p></caption>
<graphic xlink:href="137372_fig5.tif"/>
</fig>
<p>Finally, we investigated a study of the filamentous fungus <italic>Aspergillus Niger</italic> (Franke et al. 2011). We considered a system consisting of the wild type and all combinations of the four individually deleterious mutations fwnA1, leuA1, oliC2 and crnB12 (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Fitness was estimated with two-fold replication by measuring the linear mycelium growth rate in the original study. The fitness graph implies higher order epistasis (Supplementary Information, Proposition 7).</p>
<fig id="fig6" position="float" fig-type="figure"><label>FIGURE 6.</label>
<caption><p>The fitness graph shows a four-locus system for the filamentous fungus <italic>Aspergillus Niger</italic>. The system consists of all combinations of the four individually deleteriouis mutations <italic>f wnA</italic>1, <italic>leuA</italic>1, <italic>oliC</italic>2 and <italic>crnB</italic>12. The landscape has in total four peaks, labeled 0000, 1100, 0011 and 1001.</p></caption>
<graphic xlink:href="137372_fig6.tif"/>
</fig>
<p>All four arrows incident to 0000 point towards the genotype, so that the genotype 0000 is a peak in the landscape. The same is true for the genotypes 1100, 0011, and 1001. Because of the four peaks, it is possible that the fungus population gets stranded at a suboptimal peak during the course of evolution (we do not necessarily assume that the starting point for an evolutionary process is at 0000). In contrast, an additive fitness landscape is single peaked. This example illustrates that epistasis may have an impact on the evolutionary dynamics. Several peaks can make the evolutionary process less predictable, depending also on other factors such as population size, mutation rate, etc. More generally, for three-locus fitness graphs, we analyzed the impact of higher order epistasis versus only pairwise epistasis systematically. We found that higher order epistasis correlates with more peaks as well as other features that can lead to involved evolutionary dynamics (Supplementary Information, Section A.4).</p>
</sec>
</sec>
<sec id="s3"><label>3.</label><title>Discussion</title>
<p>Gene interactions play a critical role in evolutionary processes. Important features of fitness landscapes, such as the number of peaks, and accessible evolutionary trajectories, depend on epistastic gene interactions. The importance of higher order versus pairwise epistasis, within and among genes or in non-coding regions, as well as the impact of higher order epistasis on evolutionary dynamics, has not been thoroughly investigated. Progress in all of these areas requires adequate mathematical and statistical approaches, in addition to empirical studies.</p>
<p>Here, we have developed new quantitative tools for detecting gene interactions from empirical data. The main advantage of our tools is that they can reveal gene interactions from the types of data frequently generated in empirical studies, specifically rank orders, fitness graphs, and general partial orders of genotypes. The reasons why, in practice, these types of data are available more often than precise fitness measurements for each genotype are manifold. They include restricted comparative experimental designs and known and unknown confounding factors in measuring fitness that can result in uncertain and biased estimates. The methods presented here allow for studying epistatic interactions even when direct fitness measurements are lacking or only a subset of pairwise fitness comparisons is available, either as the immediate outcome of the experiment or the reported summary.</p>
<p>We provide a complete characterization of rank orders that imply higher order epistasis, along with precise results for fitness graphs of three-locus systems. In principle, our approach applies to general partial orders as well, and we have implemented algorithms accordingly. However, because of the increasing complexity it would be desirable to have theoretical results for handling large systems. In particular, a characterization of fitness graphs that imply higher order epistasis is of independent mathematical interest.</p>
<p>We found that for biallelic three-locus systems, 40&#x0025; of all possible rank orders and 37&#x0025; of all possible fitness graphs imply higher order epistasis. These fractions suggest that our methods have a good capacity to detect higher order epistasis among three loci, even if exact and complete fitness measurements or estimates are not available. Moreover, the power of our methods was demonstrated for a diverse set of biological systems. We detected higher order epistasis for HIV, malaria, the fungus <italic>Aspergillus Niger</italic>, and antibiotic resistance systems. Our findings suggest that genetic interactions beyond two-way epistasis shape the fitness landscapes of these genetic systems and may play an important role in determining their evolutionary trajectories. We also exhaustively investigated various types of higher order interactions in HIV-1 and discovered a complex pattern of interactions, confirming that our approach is powerful enough to detect finer gene interactions. Specifically, we identified over twenty interactions by conventional approaches, and rank order methods detected about half of them.</p>
<p>Another important application of our method is to experimental design. When the information available in the data does not contradict an interaction, but is not conclusive enough to claim the interaction, for example because the number of performed competition experiments is too small, then the method allows for prioritizing further experiments by suggesting additional comparisons of genotypes. This feature may prove useful in guiding fitness experiments that aim for testing specific interactions and allow for iteration.</p>
<p>For a more theoretical perspective, we emphasize the distinction between rank order-induced gene interactions, and interactions that do not change the rank order of genotypes. This distinction was pointed out for bialellic two-locus subsystems by Weinreich, Delaney, et al. (2006), who introduced the term &#x201C;sign epistasis&#x201D;. In our terminology, sign epistasis is a special case of rank order-induced epistasis. Rank order induced epistasis can thus be considered a higher order analogue to sign epistasis, and this new concept is meaningful in a broader context. Indeed, there exist a number of possible ways to quantify and interpret higher order interactions (Weinreich, Lan, et al. 2013; <xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>; Hallgr&#x00EC; msd&#x00F2;ttir and Yuster 2008), and our rank order approach applies to virtually any type of gene interaction. In particular, we can detect interactions as described by Fourier coefficients and Walsh coefficients. From our general argument based on Dyck words we investigated three-locus systems, and determined the number of rank orders that imply circuit interactions, including conditional and marginal epistasis, and similarly for interactions coordinates. The method works equally well for for other interactions.</p>
<p>Further investigation of rank order-induced interaction has the potential to relate global and local properties of fitness landscapes, similarly to results on sign epistasis (Weinreich, Delaney, et al. 2006; Poelwijk, T&#x0103;nase-Nicola, et al. 2011; <xref ref-type="bibr" rid="c6">Crona, Greene, and Barlow 2013</xref>). Global properties concern peaks and mutational trajectories in the fitness landscape, whereas local properties concern, for instance, fitness graphs for small system. The relation between global and local properties is important since only local properties can be easily observed in experiments or nature.</p>
<p>Although we have applied our method here only to fitness, any other continuous phenotype of interest can be analyzed in exactly the same manner. The fitness landscape <italic>w</italic> is then replaced by a more general genotype-to-phenotype map. For example, rather than using it as a fitness proxy, one may be concerned about the drug resistance phenotype itself and its genetic architecture.</p>
<p>In summary, rank order methods have potential for the interpretation of empirical data, as well as for relating higher order gene interactions and evolutionary dynamics. Our approach facilitates detecting higher order epistasis from a very broad range of empirical data, and will therefore contribute to enhancing our general understanding of empirical fitness landscapes and epistatic gene interactions.</p>
</sec>
</body>
<back>
<ack><title>Acknowledgments</title>
<p>This work was done in part while the authors were visiting the Simons Institute for the Theory of Computing.</p>
</ack>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Beerenwinkel</surname>, <given-names>Niko</given-names></string-name>, <string-name><given-names>Lior</given-names> <surname>Pachter</surname></string-name>, and <string-name><given-names>Bernd</given-names> <surname>Sturmfels</surname></string-name> (<year>2007</year>). &#x201C;<article-title>Epistasis and Shapes of Fitness Landscapes</article-title>&#x201D;. <source>In: Statistica Sinica</source> <volume>17</volume>, pp. <fpage>1317</fpage>&#x2013;<lpage>1342</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/q-bio/0603034">http://arxiv.org/abs/q-bio/0603034</ext-link>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="website"><string-name><surname>Bershtein</surname>, <given-names>Shimon</given-names></string-name> <etal>et al.</etal> (<year>2006</year>). &#x201C;<article-title>Robustness&#x2013;epistasis link shapes the fitness landscape of a randomly drifting protein</article-title>&#x201D;. <source>en. In: Nature</source> <volume>444.7121</volume>, pp. <fpage>929</fpage>&#x2013;<lpage>932</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.DOI.org/10.1038/nature05385">http://dx.DOI.org/10.1038/nature05385</ext-link>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="website"><string-name><surname>Bonhoeffer</surname>, <given-names>Sebastian</given-names></string-name> <etal>et al.</etal> (<year>2004</year>). &#x201C;<article-title>Evidence for positive epistasis in HIV-1</article-title>&#x201D;. <source>en. In: Science</source> <volume>306.5701</volume>, pp. <fpage>1547</fpage>&#x2013;<lpage>1550</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1101786">http://dx.doi.org/10.1126/science.1101786</ext-link>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="website"><string-name><surname>Costanzo</surname>, <given-names>Michael</given-names></string-name> <etal>et al.</etal> (<year>2010</year>). &#x201C;<article-title>The genetic landscape of a cell</article-title>&#x201D;. <source>en. In: Science</source> <volume>327.5964</volume>, pp. <fpage>425</fpage>&#x2013;<lpage>431</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1180823">http://dx.doi.org/10.1126/science.1180823</ext-link>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="book"><string-name><surname>Coxeter</surname>, <given-names>Harold Scott Macdonald</given-names></string-name> (<year>1973</year>). <source>Regular polytopes</source>. <publisher-name>Courier Corporation</publisher-name>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="website"><string-name><surname>Crona</surname>, <given-names>Kristina</given-names></string-name>, <string-name><given-names>Devin</given-names> <surname>Greene</surname></string-name>, and <string-name><given-names>Miriam</given-names> <surname>Barlow</surname></string-name> (<year>2013</year>). &#x201C;<article-title>The peaks and geometry of fitness landscapes</article-title>&#x201D;. <source>In: J. Theor. Biol</source>. <volume>317</volume>, pp. <fpage>1</fpage>&#x2013;<lpage>10</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2012.09.028">http://dx.doi.org/10.1016/j.jtbi.2012.09.028</ext-link>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="book"><string-name><surname>Crow</surname>, <given-names>J F</given-names></string-name> and M Kimura (<year>1970</year>). <source>An introduction to population genetics theory</source>. <publisher-name>Harper and Row</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="website"><string-name><surname>Franke</surname>, <given-names>Jasper</given-names></string-name> <etal>et al.</etal> (<year>2011</year>). &#x201C;<article-title>Evolutionary accessibility of mutational pathways</article-title>&#x201D;. <source>en. In: PLoS Comput. Biol</source>. <volume>7.8</volume>, <fpage>e1002134</fpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002134">http://dx.doi.org/10.1371/journal.pcbi.1002134</ext-link>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="website"><string-name><surname>G&#x00E4;rtner</surname>, <given-names>B</given-names></string-name> and V Kaibel (<year>1998</year>). &#x201C;<source>Abstract objective function graphs on the 3-cube</source>&#x201D;. In: url: <ext-link ext-link-type="uri" xlink:href="http://e-collection.library.ethz.ch/view/eth:4337">http://e-collection.library.ethz.ch/view/eth:4337</ext-link>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="website"><string-name><surname>Gong</surname>, <given-names>Lizhi Ian</given-names></string-name>, <string-name><given-names>Marc A</given-names> <surname>Suchard</surname></string-name>, and <string-name><given-names>Jesse D</given-names> <surname>Bloom</surname></string-name> (<year>2013</year>). &#x201C;<article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title>&#x201D;. <source>en. In: Elife</source> <volume>2</volume>, <fpage>e00631</fpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.DOI.org/10.7554/eLife.00631">http://dx.DOI.org/10.7554/eLife.00631</ext-link>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Greene</surname>, <given-names>Devin</given-names></string-name> and <string-name><given-names>Kristina</given-names> <surname>Crona</surname></string-name> (<year>2014</year>). &#x201C;<article-title>The changing geometry of a fitness landscape along an adaptive walk</article-title>&#x201D;. <source>In: PLOS Comput Biol</source> <volume>10.5</volume>, <fpage>e1003520</fpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="website"><string-name><surname>Gupta</surname>, <given-names>Aditi</given-names></string-name> and <string-name><given-names>Christoph</given-names> <surname>Adami</surname></string-name> (<year>2016</year>). &#x201C;<article-title>Strong Selection Significantly Increases Epistatic Interactions in the Long-Term Evolution of a Protein</article-title>&#x201D;. <source>en. In: PLoS Genet</source>. <volume>12.3</volume>, <fpage>e1005960</fpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1005960">http://dx.doi.org/10.1371/journal.pgen.1005960</ext-link>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Hallg&#x0155;fimsd&#x00F3;ttir</surname>, <given-names>Ingileif B</given-names></string-name> and <string-name><given-names>Debbie S</given-names> <surname>Yuster</surname></string-name> (<year>2008</year>). &#x201C;<article-title>A complete classification of epistatic two-locus models</article-title>&#x201D;. <source>In: BMC genetics</source> <volume>9.1</volume>,. <fpage>17</fpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="website"><string-name><surname>Khan</surname>, <given-names>Aisha I</given-names></string-name> <etal>et al.</etal> (<year>2011</year>). &#x201C;<article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title>&#x201D;. <source>en. In: Science</source> <volume>332.6034</volume>, pp. <fpage>1193</fpage>&#x2013;<lpage>1196</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.DOI.org/10.1126/science.1203801">http://dx.DOI.org/10.1126/science.1203801</ext-link>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="website"><string-name><surname>Mira</surname>, <given-names>Portia M</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). &#x201C;<article-title>Rational design of antibiotic treatment plans: a treatment strategy for managing evolution and reversing resistance</article-title>&#x201D;. <source>en. In: PLoS One</source> <volume>10.5</volume>, <fpage>e0122283</fpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0122283">http://dx.doi.org/10.1371/journal.pone.0122283</ext-link>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Nichol</surname>, <given-names>Daniel</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). &#x201C;<article-title>Steering evolution with sequential therapy to prevent the emergence of bacterial antibiotic resistance</article-title>&#x201D;. <source>In: PLoS Comput Biol</source> <volume>11.9</volume>, <fpage>e1004493</fpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="website"><string-name><surname>Ogbunugafor</surname>, <given-names>C Brandon</given-names></string-name> and <string-name><given-names>Daniel</given-names> <surname>Hartl</surname></string-name> (<year>2016</year>). &#x201C;<article-title>A pivot mutation impedes reverse evolution across an adaptive landscape for drug resistance in Plasmodium vivax</article-title>&#x201D;. <source>en. In: Malar. J</source>. <volume>15</volume>, p. <fpage>40</fpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12936-016-1090-3">http://dx.doi.org/10.1186/s12936-016-1090-3</ext-link>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Ogbunugafor</surname>, <given-names>C</given-names></string-name> <string-name><surname>Brandon</surname>, <given-names>C</given-names></string-name> <string-name><given-names>Scott</given-names> <surname>Wylie</surname></string-name>, <etal>et al.</etal> (<year>2016</year>). &#x201C;<article-title>Adaptive land-scape by environment interactions dictate evolutionary dynamics in models of drug resistance</article-title>&#x201D;. <source>In: PLoS Comput Biol</source> <volume>12.1</volume>, <fpage>e1004710</fpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="website"><string-name><surname>Orr</surname>, <given-names>H Allen</given-names></string-name> (<year>2009</year>). &#x201C;<article-title>Fitness and its role in evolutionary genetics</article-title>&#x201D;. <source>en. In: Nat. Rev. Genet</source>. <volume>10.8</volume>, pp. <fpage>531</fpage>&#x2013;<lpage>539</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2603">http://dx.doi.org/10.1038/nrg2603</ext-link>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Poelwijk</surname>, <given-names>Frank J</given-names></string-name>, <string-name><given-names>Daniel J</given-names> <surname>Kiviet</surname></string-name>, <etal>et al.</etal> (<year>2007</year>). &#x201C;<article-title>Empirical fitness landscapes reveal accessible evolutionary paths</article-title>&#x201D;. <source>en. In: Nature</source> <volume>445.7126</volume>, pp. <fpage>383</fpage>&#x2013;<lpage>386</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05451">http://dx.doi.org/10.1038/nature05451</ext-link>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Poelwijk</surname>, <given-names>Frank J</given-names></string-name>, <string-name><surname>Sorin</surname> <given-names>T&#x03D5;anase-Nicola</given-names></string-name>, <etal>et al.</etal> (<year>2011</year>). &#x201C;<article-title>Reciprocal sign epistasis is a necessary condition for multi-peaked fitness land-scapes</article-title>&#x201D;. <source>In: Journal of theoretical biology</source> <volume>272.1</volume>, pp. <fpage>141</fpage>&#x2013;<lpage>144</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="website"><string-name><surname>Poon</surname>, <given-names>Art F Y</given-names></string-name> and <string-name><given-names>Lin</given-names> <surname>Chao</surname></string-name> (<year>2006</year>). &#x201C;<article-title>Functional origins of fitness effect-sizes of compensatory mutations in the DNA bacteriophage &#x03D5;X174</article-title>&#x201D;. <source>In: Evolution</source> <volume>60.10</volume>, pp. <fpage>2032</fpage>&#x2013;<lpage>2043</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1554/06-013.1">http://dx.doi.org/10.1554/06-013.1</ext-link>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Sailer</surname>, <given-names>Zachary R</given-names></string-name> and <string-name><given-names>Michael J</given-names> <surname>Harms</surname></string-name> (<year>2017</year>). &#x201C;<article-title>Detecting High-Order Epistasis in Nonlinear Genotype-Phenotype Maps</article-title>&#x201D;. <source>In: Genetics</source> <volume>205.3</volume>, pp. <fpage>1079</fpage>&#x2013;<lpage>1088</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="website"><string-name><surname>Sanju&#x000E1;n</surname>, <given-names>Rafael</given-names></string-name> (<year>2010</year>). &#x201C;<article-title>Mutational fitness effects in RNA and single-stranded DNA viruses: common patterns revealed by site-directed mutagenesis studies</article-title>&#x201D;. <source>en. In: Philos. Trans. R. Soc. Lond. B Biol. Sci</source>. <volume>365.1548</volume>, pp. <fpage>1975</fpage>&#x2013;<lpage>1982</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/">http://dx.doi.org/10.1098/</ext-link> rstb.2010.0063.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="website"><string-name><surname>Sanju&#x000E1;n</surname>, <given-names>Rafael</given-names></string-name>, <string-name><surname>Jos&#x00E9;</surname> <given-names>M Cuevas</given-names></string-name>, <etal>et al.</etal> (<year>2005</year>). &#x201C;<article-title>Epistasis and the adaptability of an RNA virus</article-title>&#x201D;. <source>en. In: Genetics</source> <volume>170.3</volume>, pp. <fpage>1001</fpage>&#x2013;<lpage>1008</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.105.040741">http://dx.doi.org/10.1534/genetics.105.040741</ext-link>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="website"><string-name><surname>Sanju&#x000E1;n</surname>, <given-names>Rafael</given-names></string-name>, <string-name><surname>Andr&#x00E9;s</surname> <given-names>Moya</given-names></string-name>, and <string-name><given-names>Santiago F</given-names> <surname>Elena</surname></string-name> (<year>2004</year>). &#x201C;<article-title>The distribution of fitness effects caused by single-nucleotide substitutions in an RNA virus</article-title>&#x201D;. <source>en. In: Proc. Natl. Acad. Sci. U. S. A</source>. <volume>101.22</volume>, pp. <fpage>8396</fpage>&#x2013;<lpage>8401</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0400146101">http://dx.doi.org/10.1073/pnas.0400146101</ext-link>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="website"><string-name><surname>Segal</surname>, <given-names>Mark R</given-names></string-name>, <string-name><given-names>Jason D</given-names> <surname>Barbour</surname></string-name>, and <string-name><given-names>Robert M</given-names> <surname>Grant</surname></string-name> (<year>2004</year>). &#x201C;<article-title>Relating HIV-1 sequence variation to replication capacity via trees and forests</article-title>&#x201D;. <source>en. In: Stat. Appl. Genet. Mol. Biol</source>. <volume>3</volume>, <comment>Article2, discussion article 7, article 9</comment>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2202/1544-6115.1031">http://dx.doi.org/10.2202/1544-6115.1031</ext-link>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="website"><string-name><surname>Seifert</surname>, <given-names>David</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). &#x201C;<article-title>A Framework for Inferring Fitness Land-scapes of Patient-Derived Viruses Using Quasispecies Theory</article-title>&#x201D;. <source>In: Genetics</source> <volume>199.1</volume>, pp. <fpage>191</fpage>&#x2013;<lpage>203</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/199/1/191.abstract">http://www.genetics.org/content/199/1/191.abstract</ext-link>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="website"><string-name><surname>Silva</surname>, <given-names>Jack da</given-names></string-name> <etal>et al.</etal> (<year>2010</year>). &#x201C;<article-title>Fitness epistasis and constraints on adaptation in a human immunodeficiency virus type 1 protein region</article-title>&#x201D;. <source>en. In: Genetics</source> <volume>185.1</volume>, pp. <fpage>293</fpage>&#x2013;<lpage>303</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.109.112458">http://dx.doi.org/10.1534/genetics.109.112458</ext-link>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="other"><string-name><surname>Smith</surname>, <given-names>Maria</given-names></string-name> and <string-name><given-names>Sarah</given-names> <surname>Cobey</surname></string-name> (<year>2016</year>). &#x201C;<article-title>Fitness landscapes reveal simple strategies for steering evolution to minimize antibiotic resistance</article-title>&#x201D;. <source>In: bioRxiv</source>, p. <fpage>093153</fpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="website"><string-name><surname>Stanley</surname>, <given-names>Richard P</given-names></string-name> (<year>1999</year>). <source>Enumerative Combinatorics</source>. vol. <volume>2</volume>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>. URL: <ext-link ext-link-type="uri" xlink:href="http://ebooks.cambridge.org/ref/id/CBO9780511609589">http://ebooks.cambridge.org/ref/id/CBO9780511609589</ext-link>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="collab"><collab>The On-Line Encyclopedia of Integer Sequences</collab> (<year>2016</year>). <ext-link ext-link-type="uri" xlink:href="https://oeis.org/">https://oeis.org/</ext-link>. <date-in-citation>Accessed: 2016-8-19</date-in-citation>. URL: <ext-link ext-link-type="uri" xlink:href="https://oeis.org/">https://oeis.org/</ext-link>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="website"><string-name><surname>Weinreich</surname>, <given-names>Daniel M</given-names></string-name>, <string-name><given-names>Nigel F</given-names> <surname>Delaney</surname></string-name>, <etal>et al.</etal> (<year>2006</year>). &#x201C;<article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title>&#x201D;. <source>en. In: Science</source> <volume>312.5770</volume>, pp. <fpage>111</fpage>&#x2013;<lpage>114</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1123539">http://dx.doi.org/10.1126/science.1123539</ext-link>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="website"><string-name><surname>Weinreich</surname>, <given-names>Daniel M</given-names></string-name>, <string-name><surname>Yinghong</surname> <given-names>Lan</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). &#x201C;<article-title>Should evolutionary geneticists worry about higher-order epistasis?</article-title>&#x201D; <source>en. In: Curr. Opin. Genet. Dev</source>. <volume>23.6</volume>, pp. <fpage>700</fpage>&#x2013;<lpage>707</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gde.2013.10.007">http://dx.doi.org/10.1016/j.gde.2013.10.007</ext-link>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="website"><string-name><surname>Weinreich</surname>, <given-names>Daniel M</given-names></string-name>, <string-name><given-names>Richard A</given-names> <surname>Watson</surname></string-name>, and <string-name><given-names>Lin</given-names> <surname>Chao</surname></string-name> (<year>2005</year>). &#x201C;<article-title>Perspective: Sign epistasis and genetic constraint on evolutionary trajectories</article-title>&#x201D;. <source>en. In: Evolution</source> <volume>59.6</volume>, pp. <fpage>1165</fpage>&#x2013;<lpage>1174</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/16050094">https://www.ncbi.nlm.nih.gov/pubmed/16050094</ext-link>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="website"><string-name><surname>Wright</surname>, <given-names>S</given-names></string-name> (<year>1932</year>). &#x201C;<article-title>The roles of mutation, inbreeding, crossbreeding, and selection in evolution</article-title>&#x201D;. <source>In: Proc 6th Int. Cong. Genet</source>. <volume>1</volume>, pp. <fpage>356</fpage>&#x2013; url: <ext-link ext-link-type="uri" xlink:href="http://www.esp.org/books/6th-congress/facsimile/contents/6th-cong-p356-wright.pdf">http://www.esp.org/books/6th-congress/facsimile/contents/6th-cong-p356-wright.pdf</ext-link>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="website"><string-name><surname>Wu</surname>, <given-names>Nicholas C</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). &#x201C;<source>Adaptation in protein fitness land-scapes is facilitated by indirect paths</source>&#x201D;. URL: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2016/03/22/045096">http://biorxiv.org/content/early/2016/03/22/045096</ext-link>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Wylie</surname>, <given-names>C Scott</given-names></string-name> and <string-name><given-names>Eugene I</given-names> <surname>Shakhnovich</surname></string-name> (<year>2011</year>). &#x201C;<article-title>A biophysical protein folding model accounts for most mutational fitness effects in viruses</article-title>&#x201D;. <source>en. In: Proc. Natl. Acad. Sci. U. S. A</source>. <volume>108.24</volume>, pp. <fpage>9916</fpage>&#x2013;<lpage>9921</lpage>. URL: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1017572108">http://dx.doi.org/10.1073/pnas.1017572108</ext-link>.</mixed-citation></ref>
</ref-list>
<sec id="s4" sec-type="supplementary-material"><title>Supplementary Information</title>
<sec id="s4a"><label>A.</label><title>MATHEMATICAL FRAMEWORK AND PROOFS</title>
<p>Here we provide proofs for the results in the main text, and give a brief background on the discrete Fourier transform, Dyck words, and Catalan numbers. We start with rank orders and the total <italic>n</italic>-way epistasis, followed by more general results on rank orders, circuits and other linear forms. The next topic is epistasis and fitness graphs, including some related graph theory. Finally we provide a few observations on epistasis and partial orders.</p>
<p>Gene interactions for a biallelic <italic>n</italic>-locus system can be described in terms of the Fourier transform for (&#x2124; <sub>2</sub>)<sup><italic>n</italic></sup> defined as
<disp-formula id="ueqn7"><alternatives><graphic xlink:href="137372_ueqn7.gif"/></alternatives></disp-formula></p>
<p>The interaction coordinate <italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> measures the total <italic>n</italic>-way epistasis. By abuse of notation we will ignore the scaling factor <inline-formula><alternatives><inline-graphic xlink:href="137372_inline2.gif"/></alternatives></inline-formula>, so that
<disp-formula id="ueqn8"><alternatives><graphic xlink:href="137372_ueqn8.gif"/></alternatives></disp-formula></p>
<p>In particular,
<disp-formula id="ueqn9"><alternatives><graphic xlink:href="137372_ueqn9.gif"/></alternatives></disp-formula>
and
<disp-formula id="ueqn10"><alternatives><graphic xlink:href="137372_ueqn10.gif"/></alternatives></disp-formula>
as defined in Eqs. 1 and 2 in the main text. A biallelic three-locus system has three-way epistasis exactly if <italic>u</italic><sub>111</sub> &#x2260; 0. Otherwise the system has only pairwise interactions. Similarly, a biallelic <italic>n</italic>-locus system has (total) <italic>n</italic>-way epistasis exactly if <italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> <italic>&#x2260;</italic> 0.</p>
<sec id="s4a1"><label>A.1.</label><title>Rank orders</title>
<p>We will determine the number of rank orders which imply <italic>n</italic>-way epistasis. The proof depends on Catalan numbers and Dyck words (<xref ref-type="bibr" rid="c31">Stanley 1999</xref>). Let <italic>C</italic><sub><italic>i</italic></sub> denote the <italic>i</italic><sup>th</sup> Catalan number for <italic>i &#x2265;</italic> 0, that is <inline-formula><alternatives><inline-graphic xlink:href="137372_inline3.gif"/></alternatives></inline-formula>,. In particular, <italic>C</italic><sub>0</sub> = <italic>C</italic><sub>1</sub> = 1, <italic>C</italic><sub>2</sub> = 5, <italic>C</italic><sub>3</sub> = 14 and <italic>C</italic><sub>4</sub> = 42. A Dyck word of length 2<italic>n</italic> in the letters <italic>X</italic> and <italic>Y</italic> is a string consisting of <italic>n X</italic>&#x2019;s and <italic>n Y</italic> &#x2018;s such that no initial segment of the string has more <italic>Y</italic> &#x2018;s than <italic>X</italic>&#x2019;s. For instance, the Dyck words of length 4 are <italic>XXY Y</italic> and <italic>XY XY</italic>. The initial segments of <italic>XXY Y</italic> are <italic>X</italic>, <italic>XX</italic>, <italic>XXY</italic>, and <italic>XXY Y</italic>.</p>
<p><bold>Proposition 1.</bold> <italic>Consider a biallelic n-locus system. The number of rank orders which imply n-way epistasis is</italic>
<disp-formula id="ueqn11"><alternatives><graphic xlink:href="137372_ueqn11.gif"/></alternatives></disp-formula>
<italic>Proof.</italic> There are (2<sup><italic>n</italic></sup>)! rank orders in total. Let <italic>e</italic><sub><italic>i</italic></sub> denote the fitnesses of genotypes with an even number of 1&#x2019;s in the subscripts (<italic>w</italic><sub>0<italic>&#x2026;</italic>0</sub>, <italic>w</italic><sub>110<italic>&#x2026;</italic>0</sub>, and so forth) and <italic>o</italic><sub><italic>i</italic></sub> the fitnesses of genotypes with an odd number of 1&#x2019;s, ordered in such a way that <italic>e</italic><sub><italic>i</italic></sub> <italic>&#x003E; e</italic><sub><italic>i</italic>&#x002B;1</sub> and <italic>o</italic><sub><italic>i</italic></sub> <italic>&#x003E; o</italic><sub><italic>i</italic>&#x002B;1</sub> for all <italic>i</italic>. We will refer to even and odd elements from now on. Let <italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> denote the interaction coordinate as defined above. Notice that <italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> = 0 exactly if &#x2211;<sub>i</sub><italic>e &#x2211;</italic><sub>i</sub><italic>o</italic><sub>i</sub> = 0. Consequently a rank order implies positive <italic>n</italic>-way epistasis (<italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> <italic>&#x003E;</italic> 0) when the sum <italic>&#x2211;</italic> <sub>i</sub> (<italic>e</italic><sub><italic>i</italic></sub> <italic>o</italic><sub><italic>i</italic></sub>) is positive for all fitness landscapes compatible with the rank order. It is therefore sufficient to count such rank orders.</p>
<p>We define a map from fitness rank orders to words in the alphabet {<italic>e, o</italic>} as follows: <italic>e</italic><sub><italic>i</italic></sub> <italic>&#x2192; e, o</italic><sub><italic>i</italic></sub> <italic>&#x2192; o</italic>. For instance, the order <italic>w</italic><sub>00</sub> <italic>&#x003E; w</italic><sub>11</sub> <italic>&#x003E; w</italic><sub>10</sub> <italic>&#x003E; w</italic><sub>01</sub> is mapped to <italic>eeoo</italic>. We claim that a rank order satisfies <italic>&#x2211;</italic><sub><italic>i</italic></sub> (<italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003E;</italic> 0 exactly when it is mapped to a Dyck word (where <italic>e</italic> precedes <italic>o</italic>).</p>
<p>It is immediate that <italic>&#x2211;</italic><sub><italic>i</italic></sub> (<italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003E;</italic> 0 holds if the rank order is mapped to a Dyck word. Conversely, suppose that a rank order is not mapped to a Dyck word. Let <italic>s</italic> be the least number such that the number of <italic>o</italic>&#x2019;s exceeds the number of <italic>e</italic>&#x2019;s for an initial segment of length <italic>s</italic> (note that <italic>s</italic> has to be odd in this case) and let <inline-formula><alternatives><inline-graphic xlink:href="137372_inline4.gif"/></alternatives></inline-formula>. Clearly one can make the sum of <inline-formula><alternatives><inline-graphic xlink:href="137372_inline5.gif"/></alternatives></inline-formula> negative for a particular choice of <italic>e</italic><sub><italic>i</italic></sub> and <italic>o</italic><sub><italic>i</italic></sub>. By choosing the remaining numbers <italic>e</italic><sub><italic>i</italic></sub>, <italic>o</italic><sub><italic>i</italic></sub> sufficiently small, we get <italic>&#x2211;</italic><sub><italic>i</italic></sub> (<italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003C;</italic> 0, which proves the claim.</p>
<p>It remains to count the rank orders where <italic>&#x2211;</italic><sub><italic>i</italic></sub><italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003E;</italic> 0. Such rank orders are mapped to Dyck words (where <italic>e</italic> precedes <italic>o</italic>) consisting of 2<sup><italic>n-</italic>1</sup> <italic>e</italic>&#x2019;s and 2<sup><italic>n-</italic>1</sup> <italic>o</italic>&#x2019;s. There are <italic>C</italic><sub>2</sub><sup>n-1</sup> such Dyck words (<xref ref-type="bibr" rid="c31">Stanley 1999</xref>). For each word there are (2<sup><italic>n-</italic>1</sup>)! <italic>&#x00D7;</italic> (2<sup><italic>n-</italic>1</sup>)! fitness rank orders which map to the word. Indeed, one can choose the ordering of even and odd elements each in (2<sup><italic>n-</italic>1</sup>)! different ways.</p>
<p>In total there are <italic>C</italic><sub>2</sub><italic>n-</italic>1 <italic>&#x00D7;</italic> (2<sup><italic>n-</italic>1</sup>)! <italic>&#x00D7;</italic> (2<sup><italic>n-</italic>1</sup>)! fitness rank orders such that <italic>&#x2211;</italic><sub><italic>i</italic></sub><italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003E;</italic> 0 for all landscapes. By symmetry, the same number of fitness rank orders satisfy the negative epistasis condition <italic>&#x2211;</italic><sub><italic>i</italic></sub><italic>e</italic><sub><italic>i</italic></sub> <italic>- o</italic><sub><italic>i</italic></sub>) <italic>&#x003C;</italic> 0. One verifies that
<disp-formula id="ueqn12"><alternatives><graphic xlink:href="137372_ueqn12.gif"/></alternatives></disp-formula>
which completes the proof. &#x25A1;</p>
<p>A few observations in the proof of Proposition 1 are of interest. Importantly, the proof gives a computationally efficient method (linear in the number of genotypes) for checking if a rank order implies <italic>n</italic>-way epistasis. Indeed, the rank order implies higher order epistasis exactly if it is mapped to a Dyck word. Moreover, the proposition states that <inline-formula><alternatives><inline-graphic xlink:href="137372_inline6.gif"/></alternatives></inline-formula>orders imply <italic>n</italic>-way epistasis. From the proof it is clear that half of these orders imply positive <italic>n</italic>-way epistasis (<italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> <italic>&#x003E;</italic> 0) and the other half negative <italic>n</italic>-way epistasis (<italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub> <italic>&#x003C;</italic> 0). Also, the proof points out some symmetries. If a rank order implies epistasis, then the same is true for rank orders obtained by (i) any permutation of the even elements, (ii) any permutation of the odd elements, and (iii) the flip obtained by replacing every &#x201C;<italic>&#x003C;</italic> &#x201C;by &#x201C;<italic>&#x003E;</italic>&#x201C; in the rank order. It follows that each rank order that implies three-way epistasis belongs to a class of 1152 (= 4! <italic>&#x00B7;</italic> 4! <italic>&#x00B7;</italic> 2) elements, which differ by the operations (i)&#x2013;(iii) only.</p>
<p><bold>Corollary 2.</bold> <italic>The fraction of rank orders that imply n-way epistasis among all rank orders is</italic>
<disp-formula id="ueqn13"><alternatives><graphic xlink:href="137372_ueqn13.gif"/></alternatives></disp-formula></p>
<p><italic>Proof.</italic> Since the number of all rank orders is (2<sup><italic>n</italic></sup>)!, the result follows.&#x25A1;</p>
<p>The results on rank orders and epistasis for 2 <italic>&#x2264; n &#x2264;</italic> 4 are summarized in <xref ref-type="table" rid="tbl1">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float"><label>TABLE 1.</label>
<caption><p>Numbers and fractions of rank orders that imply <italic>n</italic>-way epistasis.</p></caption>
<graphic xlink:href="137372_tbl1.tif"/>
</table-wrap>
<p>Interestingly, no integer sequence that starts with 16, 16 128, <italic>&#x2026;</italic> is available at <italic>The On-Line Encyclopedia of Integer Sequences</italic> (2016).</p>
</sec>
<sec id="s4a2"><label>A.2.</label><title>Circuits</title>
<p>The proof of Proposition 1 depends on the map defined from the rank orders to words in the alphabet {<italic>e, o</italic>}. We will use a generalization of the map in subsequent proofs. The starting point is a given linear form. The form determines a map from rank orders to words. Although the idea is closely related to the previous proof, we will work with positive and negative coefficients in the linear forms. For that reason, we will use <italic>P</italic> and <italic>N</italic> rather than <italic>e</italic> and <italic>o</italic> (even and odd is no longer meaningful).</p>
<p>We start with a clarifying example. Assume that a given linear form has integer coefficients and that the sum of its coefficients is zero. For instance, the form
<disp-formula id="ueqn14"><alternatives><graphic xlink:href="137372_ueqn14.gif"/></alternatives></disp-formula>
defines a map <italic>&#x03C6;</italic><sup><italic>m</italic></sup> as follows: Each of the variables <italic>w</italic><sub>001</sub>, <italic>w</italic><sub>010</sub>, <italic>w</italic><sub>100</sub> corresponds to the letter <italic>P</italic> (for positive), and the variable <italic>w</italic><sub>111</sub> corresponds to <italic>N</italic> (for negative). The variable <italic>w</italic><sub>000</sub> corresponds to <italic>N N</italic>, because of the coefficient <italic>-</italic>2. In this case, the rank order
<disp-formula id="ueqn15"><alternatives><graphic xlink:href="137372_ueqn15.gif"/></alternatives></disp-formula>
is mapped to <italic>N P N N P P</italic> under <italic>&#x03C6;</italic><sup><italic>m</italic></sup>. Specifically, starting from left <italic>w</italic><sub>111</sub> corresponds to <italic>N</italic>, <italic>w</italic><sub>001</sub> to <italic>P</italic>, <italic>w</italic><sub>000</sub> to <italic>N N</italic>, <italic>w</italic><sub>100</sub> to <italic>P</italic>, and <italic>w</italic><sub>100</sub> to <italic>P</italic>. The remaining variables <italic>w</italic><sub>110</sub>, <italic>w</italic><sub>101</sub>, <italic>w</italic><sub>011</sub> do not impact the word, since their coefficients are zero for the form <italic>m</italic>.</p>
<p><bold>Definition 1.</bold> Let <italic>f</italic> be a linear form with integer coefficients. Assume that the sum of its coefficients is zero. Let <italic>&#x03C6;</italic> <sup><italic>f</italic></sup> denote the map from a total order on the variables (a rank order) to words in the alphabet <italic>{P, N}</italic> defined as follows: Each variable of <italic>f</italic> with a positive integer coefficient <italic>c</italic> corresponds to a substring of <italic>c</italic> letters <italic>P</italic>. Each variable in <italic>f</italic> with a negative integer coefficient <italic>c</italic>&#x2019; corresponds to a substring of <italic>c</italic>&#x2019; letters <italic>N</italic>. A rank order of the variables is mapped to the word consisting of the substrings obtained for each variable with non-zero coefficient in <italic>f</italic>. Specifically, the substrings (from left to right) of the word correspond to the variables in the rank order (from highest to lowest).</p>
<p>The proof of Proposition 1 uses <italic>e</italic> and <italic>o</italic> instead of <italic>P</italic> and <italic>N</italic>. However, notice that the map from rank orders to words in <italic>e</italic>&#x2019;s and <italic>o</italic>&#x2019;s is exactly <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub></sup> (modulo the labeling). The next result is a generalization of Proposition 1. The proof is similar in every step with the modification that <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub></sup> is replaced by <italic>&#x03C6;</italic><sup><italic>f</italic></sup> for an arbitrary form <italic>f</italic>, so we omit the details.</p>
<p><bold>Theorem 3.</bold> <italic>Let f be a linear form with integer coefficients. Assume that the sum of its coefficients is zero. Then a rank order implies that f is not zero if and only if it is mapped to a Dyck word by &#x03C6;</italic><sup><italic>f</italic></sup>.</p>
<p>The theorem can be applied in different contexts, and we start with circuits for biallelic three-locus systems. Recall from the main text that <italic>a</italic> = <italic>w</italic><sub>000</sub> <italic>- w</italic><sub>010</sub> <italic>- w</italic><sub>100</sub> &#x002B; <italic>w</italic><sub>110</sub> is a circuit. Notice that <italic>a</italic> = 0 for all additive fitness landscapes. Moreover, <italic>a</italic> is minimal with this property, in the sense that no linear form in a proper subset of {<italic>w</italic><sub>000</sub>, <italic>w</italic><sub>010</sub>, <italic>w</italic><sub>100</sub>, <italic>w</italic><sub>110</sub>} equals zero for all additive landscapes. The cir-cuits for a system of genotypes are defined as such minimal dependence relations. For a complete description of the gene interactions one can analyze the circuits.</p>
<p>There are 20 circuits <italic>a,&#x2026;, t</italic> for three-locus systems (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>), namely
<disp-formula id="ueqn16"><alternatives><graphic xlink:href="137372_ueqn16.gif"/></alternatives></disp-formula>
The circuits <italic>a,&#x2026;, f</italic> measure conditional two-way epistasis between two loci when the allele at the third locus is fixed, the circuits <italic>g,&#x2026;, l</italic> relate marginal epistasis of two pairs of loci, and the circuits <italic>m,&#x2026;, t</italic> relate the three-way interaction to the total two-way epistasis. (Beeren-winkel, Pachter, and Sturmfels 2007).</p>
<p>For a given circuit, some rank orders imply that the circuit is positive, i.e., the circuit is positive for all fitness values compatible with the rank order. Similarly, some rank orders imply that the circuit is negative, whereas the sign cannot be determined from other rank orders. We will use Theorem 3 to check whether a rank order determines the sign of a circuit or not.</p>
<p><bold>Corollary 4.</bold> <italic>For the circuits a,&#x2026; l, two thirds of all possible rank orders determine the sign of the circuit. For the circuits m,&#x2026;, t, one half of all possible rank orders determine the sign of the circuit.</italic></p>
<p><italic>Proof.</italic> Fix one of the circuits from <italic>a</italic> to <italic>l</italic> and a rank order. The circuit has exactly four variables with non-zero coefficients (for instance, for the circuit <italic>a</italic> the variables are <italic>w</italic><sub>000</sub>, <italic>w</italic><sub>100</sub>, <italic>w</italic><sub>010</sub>, <italic>w</italic><sub>110</sub>, so that <italic>&#x03C6;</italic><sup><italic>a</italic></sup> maps rank orders to four-letter words). By Theorem 3, the rank order implies that the circuit differs from zero when it is mapped to one of the Dyck words <italic>P P N N</italic>, <italic>P N P N</italic>, <italic>N N P P</italic> or <italic>N P N P</italic> under <italic>&#x03C6;</italic>, whereas the sign of the circuit is not determined when the word is <italic>P N N P</italic> or <italic>N P P N</italic>. One concludes that the sign of a given circuit from <italic>a</italic> to <italic>l</italic> is determined for 2<italic>/</italic>3 of the rank orders.</p>
<p>Using a similar argument, we consider words of length 6 for the circuits labeled <italic>m</italic> to <italic>t</italic>. There are in total 20 words consisting of 3 <italic>P</italic> &#x2018;s and 3 <italic>N</italic> &#x2018;s. Ten of them are Dyck words. We conclude that the sign of a given circuit from <italic>m</italic> to <italic>t</italic> is determined for 1<italic>/</italic>2 of the rank orders. &#x25A1;</p>
<p>The gene interactions for a biallelic three-locus system can be classified in terms of shapes of the fitness landscape, or triangulations of the 3-cube (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>). There are 74 shapes for the 3-cube. The shape of the fitness landscapes is determined by the signs of the 20 circuits. It follows that rank orders provide some information about possible shapes. However, the following result shows that rank orders do not determine shapes.</p>
<p><bold>Proposition 5.</bold> <italic>Consider a three-locus biallelic system. No rank order determines the shape of a fitness landscape.</italic></p>
<p><italic>Proof.</italic> The result follows from the characterization of shapes for the 3-cube in (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>), where each shape is described in terms of a circuit sign pattern. We verified computationally that no rank order implies that all the circuits have the signs which describe a particular shape (<monospace><ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#analysis-of-rank-orders">https://github.com/gavruskin/fitlands#analysis-of-rank-orders</ext-link></monospace>). More precisely, for every circuit <italic>a,&#x2026;, t</italic>, we determined the set of all rank orders that imply that the circuit is positive or negative.</p>
<p>For every rank order, we then considered the circuit signs determined by the order. In no case did a rank order determine all the circuit signs necessary for describing a particular shape. &#x25A1;</p>
<p>The fact that rank orders do not determine the shape of a fitness landscape over a three-locus system is expected. Shapes reflect interactions in a very fine scaled way, whereas rank orders provide only coarse information.</p>
<p>In addition to <italic>u</italic><sub>111</sub>, there exist three other interaction coordinates <italic>u</italic><sub>110</sub>, <italic>u</italic><sub>101</sub>, <italic>u</italic><sub>011</sub>. These coordinates correspond to two-way epistasis marginalized over the loci marked by 0 (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>). We again apply Theorem 3 to identify rank orders that determine the sign of the interaction coordinates.</p>
<p><bold>Corollary 6.</bold> <italic>For each of the interaction coordinates u</italic><sub>110</sub>, <italic>u</italic><sub>101</sub>, <italic>and u</italic><sub>011</sub>, <italic>the number of rank orders which imply three-way epistasis is 16,128.</italic></p>
<p><italic>Proof.</italic> The linear form for each interaction coordinate consists of 8 elements, 4 with positive signs and 4 with negative signs. Notice that 16, 128 rank orders imply three-way epistasis, by Proposition 1. By Theorem 3 the problem can be reduced to counting Dyck words of length 8. It follows that the number of rank orders is 16, 128 for each interaction coordinate. &#x25A1;</p>
<p>The approach to epistasis given in (Weinreich, Lan, et al. 2013) depends on Walsh coefficients. Notice that interaction coordinates and Walsh coefficients are closely related in this case. Specifically, the Walsh coefficients <italic>E</italic><sub>110</sub>, <italic>E</italic><sub>101</sub>, <italic>E</italic><sub>011</sub> differ from the interaction coordinates <italic>u</italic><sub>110</sub>, <italic>u</italic><sub>101</sub>, <italic>u</italic><sub>011</sub> only by a scalar, so that Corollary 6 applies to the coefficients as well.</p>
</sec>
<sec id="s4a3"><label>A.3.</label><title>Partial orders and fitness graphs</title>
<p>We now consider partial orders, for instance,
<disp-formula id="ueqn17"><alternatives><graphic xlink:href="137372_ueqn17.gif"/></alternatives></disp-formula>
for a three-locus system. Arguing as in the proof of Proposition 1, the (unknown) total order is mapped to the word <italic>oxxxxeee</italic> under <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub></sup>, where <italic>xxxx</italic> is some permutation of <italic>eooo</italic>. For any such permutation we get a Dyck word. It follows that the system has three-way epistasis. This condition can be stated and proved in a more general form.</p>
<p><bold>Proposition 7.</bold> <italic>Consider an n-locus biallelic system. Let e</italic><sub><italic>i</italic></sub> <italic>and o</italic><sub><italic>i</italic></sub> <italic>be defined as in the proof of Proposition 1. If there exists a partition of the total set of fitness values into pairs</italic> (<italic>e</italic><sub><italic>i</italic></sub>, <italic>o</italic><sub><italic>i</italic></sub>), <italic>where e</italic><sub><italic>i</italic></sub> <italic>&#x003E; o</italic><sub><italic>i</italic></sub> <italic>for all i, then one can conclude n-way epistasis. By symmetry, the same is true for a partition where e</italic><sub><italic>i</italic></sub> <italic>&#x003C; o</italic><sub><italic>i</italic></sub> <italic>for each pair.</italic></p>
<p><italic>Proof.</italic> We will verify that the existence of a partition as described is equivalent to the order being mapped to a Dyck word under the map <italic>&#x03C6;</italic><sup><italic>u</italic></sup>1<italic>&#x2026;</italic>1. It is immediate that the existence of such a partition implies that the order is mapped to a Dyck word. Conversely, if the rank order is mapped to a Dyck word under <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub></sup>, then one can construct a partition as follows. One pair in the partition corresponds to the first <italic>e</italic> and the first <italic>o</italic> in the Dyck word, a second pair corresponds to the second <italic>e</italic> and the second <italic>o</italic> in the word, and so forth. This partition has the desired property. &#x25A1;</p>
<p>A fitness graph is a directed acyclic graph where each node represents a genotype, and arrows connect each pair of mutational neighbors, directed toward the node representing the genotype of higher fitness. Moreover, fitness graphs are structured so that the node labeled 0 <italic>&#x2026;</italic> 0 is at the bottom, genotypes with exactly one 1 on the level above, and so forth (see <xref ref-type="fig" rid="fig10">Figure 10</xref>).</p>
<p>Some fitness graphs imply epistasis, whereas other fitness graphs are compatible with additive fitness. As illustrated in the two-locus case, a fitness graph is compatible with additive fitness if all arrows point up, that is toward a higher level. More generally, a fitness graph implies epistasis unless it is isomorphic to a graph with all arrows up (<xref ref-type="bibr" rid="c6">Crona, Greene, and Barlow 2013</xref>).</p>
<p>Similarly, we can easily characterize rank orders that are compatible with additive fitness. After relabeling genotypes, we can assume that the genotype 0 <italic>&#x2026;</italic> 0 has the lowest fitness in the system. Then a rank order is compatible with additive fitness, exactly if for each genotype replacing 0 by 1 results in higher fitness. Otherwise the rank order implies epistasis. For instance, <italic>w</italic><sub>00</sub> <italic>&#x003C; w</italic><sub>10</sub> <italic>&#x003C; w</italic><sub>01</sub> <italic>&#x003C; w</italic><sub>11</sub> is compatible with additive fitness, whereas the rank order <italic>w</italic><sub>00</sub> <italic>&#x003C; w</italic><sub>11</sub> <italic>&#x003C; w</italic><sub>01</sub> <italic>&#x003C; w</italic><sub>10</sub>implies epistasis. The claims follows immediately from the result stated above for fitness graphs.</p>
<p>As we have already seen, rank orders have potential far beyond detecting whether or not there is epistasis in a system. The same is true for fitness graphs, and we proceed with higher order interactions. In order to analyze fitness graphs and three-way epistasis, we consider the set of rank orders compatible with a given fitness graphs. For instance, the fitness graph in <xref ref-type="fig" rid="fig7">Figure 7</xref> is compatible with the following two rank orders:
<disp-formula id="eqn5"><alternatives><graphic xlink:href="137372_eqn5.gif"/></alternatives></disp-formula>
<disp-formula id="eqn6"><alternatives><graphic xlink:href="137372_eqn6.gif"/></alternatives></disp-formula>
<fig id="fig7" position="float" fig-type="figure"><label>FIGURE 7.</label>
<caption><p>The fitness graph is compatible with the two rank orders (5) and (6).</p></caption>
<graphic xlink:href="137372_fig7.tif"/>
</fig>
</p>
<p>The first order implies three-way epistasis (it is mapped to <italic>oeoooeee</italic> under <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1,&#x2026;,1</sub></sup> and the second does not (it is mapped to <italic>eooooeee</italic> under <italic>&#x03C6;</italic><sup><italic>u</italic><sub>1<italic>&#x2026;</italic>1</sub></sup>). We conclude that in this case, the fitness graph does not imply higher order epistasis. However, if every rank order compatible with the fitness graph implies higher order epistasis, then the fitness graph itself does imply higher order epistasis. More generally, the same observation holds for any partial order.</p>
<p><bold>Remark.</bold> A partial order implies higher order epistasis exactly if all its total extensions imply higher order epistasis.</p>
<p>Indeed, if all total extensions imply higher order epistasis, then in particular the (unknown) rank order does. The converse holds by definition.</p>
<p>Consequently, one can in principle determine if a fitness graph implies higher order epistasis by checking all of the compatible rank orders. For a systematic study of the three-locus case, it is convenient to reduce the problem to isomorphic graphs. In biological terms, isomorphic graphs differ by the labeling of the genotypes only (a relabeling needs to respect the adjacency structure so that mutational neighbors stay neighbors). <xref ref-type="fig" rid="fig8">Figure 8</xref> shows 4 isomorphic fitness graphs.</p>
<fig id="fig8" position="float" fig-type="figure"><label>FIGURE 8.</label>
<caption><p>The four graphs are isomorphic (by abuse of notation, we do not follow the level convention for the fitness graphs). In biological terms, the fitness graphs differ only by the labeling of the genotypes. For instance, the second graph differs from the first by a 90 degree clockwise rotation of the label system.</p></caption>
<graphic xlink:href="137372_fig8.tif"/>
</fig>
<p>As mentioned in the main text, there are in total 1, 862 fitness graphs for three-locus systems, and the number of fitness graphs that imply higher order epistasis is 698 (37 percent). Up to isomorphism there are in total 54 fitness graphs, and 20 graphs imply higher order epistasis. This result was verified by reducing the study of all 1862 graphs for three-locus systems, to a non-redundant list of 54 graphs, i.e., no two graphs in the list are isomorphic.</p>
<p>Isomorphisms between three-locus systems have a geometric interpretion. The fitness graph can be regarded as a three-dimensional cube, with vertices corresponding to genotypes and edges corresponding to arrows. The group of isomorphisms then corresponds to the symmetry group of the three dimensional cube (<xref ref-type="bibr" rid="c5">Coxeter 1973</xref>). Indeed, it was by way of this equivalence that we carried out the enumeration described above.</p>
</sec>
<sec id="s4a4"><label>A.4.</label><title>Graph theoretical aspects</title>
<p>As mentioned in the main text, the 20 graphs which imply higher order epistasis (see Supplementary <xref ref-type="fig" rid="fig10">Figure 10</xref>) constitute a diverse category. We analyzed the category from a graph theoretical point of view, but could not see that the graphs have any property which singles them out.</p>
<p>Recall that a unique sink orientation is a graph where each face has no more than one sink. Equivalently, there is no subsystems with reciprocal sign epistasis (<xref ref-type="bibr" rid="c6">Crona, Greene, and Barlow 2013</xref>; Poelwijk, Kiviet, et al. 2007). The category of 20 graphs includes unique sink orientations (also called USO or AOF graphs), as well as non-USO&#x2019;s. Moreover, in the terminology of G&#x00F6;artner and Kaibel (1998), the category includes separable and non-separable graphs, as well as realizable and non-realizable graphs.</p>
<p>There were some indications of higher complexity for the category, but only in a statistical sense. Indeed, as can be verified from <xref ref-type="fig" rid="fig10">Figure 10</xref>, the graphs in the category have on average 1.8 sinks (a sink corresponds to a peak in the landscape), whereas the average number of sinks for all graphs is 1.6. Moreover, 5 out of the 20 graphs (25 percent) in the category are unique sink orientations, whereas in total 19 out of the 54 graphs (35 percent) are unique sink orientations.</p>
<p>Even though the category of fitness graphs which implies epistasis is diverse, it is still possible that a characterization exists. This is an open problem.</p>
</sec>
</sec>
</sec>
<sec id="s4b"><label>B.</label><title>SOFTWARE AND HIV-1 STUDY</title>
<p>In this section, we provide the details of our analysis of the HIV-1 data in Section 2, after a brief discussion of code related to this paper. We have implemented algorithms based on our theoretical results in an open source software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#fitlands">https://github.com/gavruskin/fitlands#fitlands</ext-link>). The package provides algorithms for detecting gene interactions as described in the main text for two- and three-locus systems. In particular, algorithms for detecting total three-way epistasis, interaction coordinates and circuits have been implemented. The documentation also explains how to reproduce results for our application to HIV-1 data described in the main text.</p>
<p>For the HIV-1 study, we had the opportunity to compare our rank order based approach with conventional methods. To compare our rank order methods with conventional Wilcoxon rank sum tests, we used the replicate fitness measurements provided in the original study (<xref ref-type="bibr" rid="c27">Segal, Barbour, and Grant 2004</xref>). We computed the values of interaction coordinates and circuit interactions for the summary statistics reported in (<xref ref-type="bibr" rid="c1">Beerenwinkel, Pachter, and Sturmfels 2007</xref>). <xref ref-type="fig" rid="fig9">Figure 9</xref> shows that our rank order methods detected the majority of circuit interactions identified by using the summary statistics.</p>
<fig id="fig9" position="float" fig-type="figure"><label>FIGURE 9.</label>
<caption><p>Interactions detected from fitness summary statistics and from rank orders. The horizontal axis is labeled by the four interaction coordinates <italic>u</italic><sub>110</sub>, <italic>&#x2026;, u</italic><sub>111</sub> and twenty circuits <italic>a,&#x2026;, t</italic>. The boxplots show the distributions given by the fintess values and the stars indicate whether or not the interaction has been detected using our rank order methods. The star with Y-coordinate 1 means positive interaction, with Y-coordinate &#x2013;1 negative interaction, and with Y-coordinate 0 means the rank order does not imply interaction.</p></caption>
<graphic xlink:href="137372_fig9.tif"/>
</fig>
<p>Second, we applied Student&#x2019;s t-test to detect interactions and quantify the significance of the estimates. <xref ref-type="table" rid="tbl2">Table 2</xref> summarizes the results, and for related code see <ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands/blob/master/HIV&#x005F;2007&#x005F;conventional&#x005F;analysis.ipynb">https://github.com/gavruskin/fitlands/blob/master/HIV&#x005F;2007&#x005F;conventional&#x005F;analysis.ipynb</ext-link></p>
<table-wrap id="tbl2" orientation="portrait" position="float"><label>TABLE 2.</label>
<caption><p>The first column lists the four interaction coordinates and twenty circuits. The second column shows p-values returened by Student&#x2019;s t-test based on fitness measurements. The third column shows which interactions are significant based on 0.03 threshold and their signs. For comparison, the last column displays the results obtained from rank order methods.</p></caption>
<graphic xlink:href="137372_tbl2.tif"/>
</table-wrap>
</sec>
</back>
</article>
