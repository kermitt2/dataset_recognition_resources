<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/024547</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>S/HIC: Robust identification of soft and hard sweeps using machine learning</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Schrider</surname>
<given-names>Daniel R.</given-names>
</name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
<xref ref-type="corresp" rid="cor1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kern</surname>
<given-names>Andrew D.</given-names>
</name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
<xref ref-type="aff" rid="a2">&#x2020;</xref>
</contrib>
<aff id="a1"><label>&#x002A;</label><institution>Department of Genetics, Rutgers University</institution>, Piscataway, NJ 08854</aff>
<aff id="a2"><label>&#x2020;</label><institution>Human Genetics Institute of New Jersey</institution>, Rutgers University, Piscataway, NJ 08854</aff>
</contrib-group>
<author-notes>
<corresp id="cor1">
<label>1</label>Corresponding author: Department of Genetics, Rutgers University, 604 Allison Rd., Piscataway, NJ 08854. E-mail: <email>dan.schrider@rutgers.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2015</year>
</pub-date>
<elocation-id>024547</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>8</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>8</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="024547.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<p>Detecting the targets of adaptive natural selection from whole genome sequencing data is a central problem for population genetics. However, to date most methods have shown sub-optimal performance under realistic demographic scenarios. Moreover, over the past decade there has been a renewed interest in determining the importance of selection from standing variation in adaptation of natural populations, yet very few methods for inferring this model of adaptation at the genome scale have been introduced. Here we introduce a new method, S/HIC, which uses supervised machine learning to precisely infer the location of both hard and soft selective sweeps. We show that S/HIC has unrivaled accuracy for detecting sweeps under demographic histories that are relevant to human populations, and distinguishing sweeps from linked as well as neutrally evolving regions. Moreover we show that S/HIC is uniquely robust among its competitors to model misspecification. Thus even if the true demographic model of a population differs catastrophically from that specified by the user, S/HIC still retains impressive discriminatory power. Finally we apply S/HIC to the case of resequencing data from human chromosome 18 in a European population sample and demonstrate that we can reliably recover selective sweeps that have been identified earlier using less specific and sensitive methods.</p>
</abstract>
<counts>
<page-count count="40"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>INTRODUCTION</title>
<p>The availability of population genomic data has empowered efforts to uncover the selective, demographic, and stochastic forces driving patterns of genetic variation within species. Chief among these are attempts to uncover the genetic basis of recent adaptation (<xref ref-type="bibr" rid="c1">Akey 2009</xref>). Indeed, recent advances in genotyping and sequencing technologies have been accompanied by a proliferation of statistical methods for identifying recent positive selection (see <xref ref-type="bibr" rid="c61">Wollstein and Stephan 2015</xref> for recent review).</p>
<p>Most methods for identifying positive selection search for the population genetic signature of a &#x201C;selective sweep&#x201D; (<xref ref-type="bibr" rid="c3">Berry et al. 1991</xref>), wherein the rapid fixation of a new beneficial allele leaves a valley of diversity around the selected site (<xref ref-type="bibr" rid="c33">Maynard Smith and Haigh 1974</xref>; <xref ref-type="bibr" rid="c24">Kaplan et al. 1989</xref>; <xref ref-type="bibr" rid="c51">Stephan et al. 1992</xref>), about which every individual in the population exhibits the same haplotype (i.e. the genetic background on which the beneficial mutation occurred). At greater genetic distances, polymorphism recovers as recombination frees linked neutral variants from the homogenizing force of the sweep (<xref ref-type="bibr" rid="c24">Kaplan et al. 1989</xref>). This process also produces an excess of low-and high-frequency derived alleles (<xref ref-type="bibr" rid="c5">Braverman et al. 1995</xref>; <xref ref-type="bibr" rid="c9">Fay and Wu 2000</xref>), and increased allelic association, or linkage disequilibrium (LD), on either side of the sweep (<xref ref-type="bibr" rid="c25">Kelly 1997</xref>), but not across the two flanks of the sweep (<xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>; <xref ref-type="bibr" rid="c50">Stephan et al. 2006</xref>). Selective fixation <italic>de novo</italic> beneficial mutations such as described by <xref ref-type="bibr" rid="c33">Maynard Smith and Haigh (1974)</xref> are often referred to as &#x201C;hard sweeps.&#x201D;</p>
<p>More recently, population geneticists have begun to consider the impact of positive selection on previously standing genetic variants (<xref ref-type="bibr" rid="c38">Orr and Betancourt 2001</xref>; <xref ref-type="bibr" rid="c17">Hermisson and Pennings 2005</xref>). Under this model of adaptation, an allele initially evolves under drift for some time, until a change in the selective environment causes it to confer a fitness advantage and sweep to fixation. In contrast to the hard sweep model, the selected allele is present in multiple copies prior to the sweep. Thus, because of mutation and recombination events occurring near the selected site during the drift phase, the region containing this site may exhibit multiple haplotypes upon fixation (<xref ref-type="bibr" rid="c40">Pennings and Hermisson 2006a</xref>). The resulting reduction in diversity is therefore less pronounced than under the hard sweep model (<xref ref-type="bibr" rid="c20">Innan and Kim 2004</xref>; <xref ref-type="bibr" rid="c17">Hermisson and Pennings 2005</xref>). For this reason such events are often referred to as &#x201C;soft sweeps.&#x201D; Soft sweeps will not skew the allele frequencies of linked neutral polymorphisms toward low and high frequencies to the same extent as hard sweeps (<xref ref-type="bibr" rid="c44">Przeworski et al. 2005</xref>), and may even present an excess of intermediate frequencies (<xref ref-type="bibr" rid="c55">Teshima et al. 2006</xref>). This mode of selection will also have a different impact on linkage disequilibrium: LD will be highest at the target of selection rather than in flanking regions (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). In very large populations, selection on mutations that are immediately beneficial may also produce patterns of soft sweeps rather than hard sweeps, as the adaptive allele may be introduced multiple times via recurrent mutation before the sweep completes (<xref ref-type="bibr" rid="c41">Pennings and Hermisson 2006b</xref>, a).</p>
<p>Adaptation could proceed primarily through selection on standing variation if the selective environment shifts frequently relative to the time scale of molecular evolution, and if there is enough standing variation segregating in the population on which selection may act following such a shift (<xref ref-type="bibr" rid="c15">Gillespie 1991</xref>; <xref ref-type="bibr" rid="c17">Hermisson and Pennings 2005</xref>). However, it is important to note that selection on standing variation may produce a hard sweep of only one haplotype containing the adaptive mutation if this allele is present at low enough frequency prior to sweep (<xref ref-type="bibr" rid="c44">Przeworski et al. 2005</xref>; <xref ref-type="bibr" rid="c21">Jensen 2014</xref>). In other words, the observation of hard sweeps may be consistent with selection on standing variation as well as selection on <italic>de novo</italic> mutations. For these and other reasons, there is some controversy over whether adaptation will result in soft sweeps in nature (<xref ref-type="bibr" rid="c21">Jensen 2014</xref>). This could be resolved by methods that can accurately discriminate between hard and soft sweeps. To this end, some recently devised methods for detecting population genetic signatures of positive selection consider both types of sweeps (<xref ref-type="bibr" rid="c42">Peter et al. 2012</xref>; <xref ref-type="bibr" rid="c10">Ferrer-Admetlla et al. 2014</xref>; <xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>). Unfortunately, it may often be difficult to distinguish soft sweeps from regions flanking hard sweeps due to the &#x201C;soft shoulder&#x201D; effect (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>).</p>
<p>Here we present a method that is able to accurately distinguish between hard sweeps, soft sweeps, regions linked to sweeps (or the &#x201C;shoulders&#x201D; of sweeps), and regions evolving neutrally. This method incorporates spatial patterns of a variety of population genetic summary statistics across a large genomic window in order to infer the mode of evolution governing a focal region at the center of this window. We combine many statistics used to test for selection using an Extremely Randomized Trees classifier (<xref ref-type="bibr" rid="c13">Geurts et al. 2006</xref>), a powerful supervised machine learning classification technique. We refer to this method as Soft/Hard Inference through Classification (S/HIC). By incorporating multiple signals in this manner S/HIC achieves inferential power exceeding that of any individual test. Furthermore, by using spatial patterns of these statistics within a broad genomic region, S/HIC is able to distinguish selective sweeps not only from neutrality, but also from linked selection with much greater accuracy than other methods. Thus, S/HIC has the potential to identify smaller candidate regions around recent selective sweeps, thereby narrowing down searches for the target locus of selection. We also show that S/HIC&#x2019;s reliance on large-scale spatial patterns makes it more robust to non-equilibrium demography than previous methods, even if the demographic model is misspecified during training. This is vitally important, as the true demographic history of a population sample may be unknown. Finally, we demonstrate the utility of our approach by applying it to chromosome 18 in the CEU sample from the 1000 Genomes dataset (<xref ref-type="bibr" rid="c2">Altshuler et al. 2012</xref>), recovering most of the sweeps identified previously in this population through other methods.</p>
</sec>
<sec id="s2">
<title>METHODS</title>
<sec id="s2a">
<title>Combining multiple facets of genetic variation to detect soft and hard sweeps</title>
<p>We sought to devise a method that could not only accurately distinguish among hard sweeps, soft sweeps, and neutral evolution, but also among these modes of evolution and regions linked to hard and soft sweeps, respectively (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). Such a method would not only be robust to the soft shoulder effect, but would also be able to more precisely delineate the region containing the target of selection by correctly classifying unselected but closely linked regions. In order to accomplish this, we sought to exploit the impact of positive selection on spatial patterns of several aspects of variation surrounding a sweep. Not only will a hard sweep create a valley of diversity centered around a sweep, but it will also create a skew toward high frequency derived alleles flanking the sweep and intermediate frequencies at further distances (<xref ref-type="bibr" rid="c5">Braverman et al. 1995</xref>; <xref ref-type="bibr" rid="c9">Fay and Wu 2000</xref>), reduced haplotypic diversity at the sweep site (<xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>), and increased LD along the two flanks of the sweep but not between them (<xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>). For soft sweeps, these expected patterns may differ considerably (<xref ref-type="bibr" rid="c44">Przeworski et al. 2005</xref>; <xref ref-type="bibr" rid="c40">Pennings and Hermisson 2006a</xref>; <xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>), but also depart from the neutral expectation.</p>
<p>While some of these patterns of variation have been used individually for sweep detection (e.g. <xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>; <xref ref-type="bibr" rid="c37">Nielsen et al. 2005</xref>), we reasoned that by combining spatial patterns of multiple facets of variation we would be able to do so more accurately. To this end, we designed a classifier that leverages spatial patterns of a variety of population genetic summary statistics in order to infer whether a large genomic window recently experienced a selective sweep at its center. We accomplished this by partitioning this large window into adjacent subwindows, measuring the values of each summary statistic in each subwindow, and normalizing by dividing the value for a given subwindow by the sum of values for this statistic across all subwindows. Thus, for a given summary statistic <italic>x</italic>, we used the following vector:
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="024547_ueqn1.gif"/></alternatives>
</disp-formula>
where the larger window has been divided into <italic>n</italic> subwindows, and <italic>x</italic><sub><italic>i</italic></sub> is the value of the summary statistic <italic>x</italic> in the <italic>i</italic><sup>th</sup> subwindow. Thus, this vector captures differences in the relative values of a statistic across space within a large genomic window, but does not include the actual values of the statistic. In addition to allowing for discrimination between sweeps and linked regions, this strategy was motivated by the need for accurate sweep detection in the face of a potentially unknown nonequilibrium demographic history, which may grossly affect values of these statistics but may skew their expected spatial patterns to a much lesser extent. In total, we constructed these vectors for each of &#x03C0; (<xref ref-type="bibr" rid="c36">Nei and Li 1979</xref>), <inline-formula><alternatives><inline-graphic xlink:href="024547_inline1.gif"/></alternatives></inline-formula> (<xref ref-type="bibr" rid="c59">Watterson 1975</xref>),<inline-formula><alternatives><inline-graphic xlink:href="024547_inline2.gif"/></alternatives></inline-formula> (<xref ref-type="bibr" rid="c9">Fay and Wu 2000</xref>), the number of distinct haplotypes, average haplotype homozygosity, <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> (<xref ref-type="bibr" rid="c34">Messer and Petrov 2013</xref>; <xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>), <italic>Z</italic><sub><italic>nS</italic></sub> (<xref ref-type="bibr" rid="c25">Kelly 1997</xref>), and <italic>&#x03C9;</italic> (<xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>). Thus, we represent each large genomic window by the following vector, to which we refer as the feature vector:
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="024547_ueqn2.gif"/></alternatives>
</disp-formula>
</p>
<p>We sought to discriminate between hard sweeps, regions linked to hard sweeps, soft sweeps, regions linked to soft sweeps, and neutrally evolving regions on the basis of the values of the vectors defined above. Because there is no analytical expectation of the values of these statistics at varying distances from a sweep, we opted to use a supervised machine learning framework, wherein a classifier is trained from regions known to belong to one of these five classes. We trained an Extra-Trees classifier (or extremely randomized forest; <xref ref-type="bibr" rid="c13">Geurts et al. 2006</xref>) from coalescent simulations (described below) in order to classify large genomic windows as experiencing a hard sweep in the central subwindow, a soft sweep in the central subwindow, being closely linked to a hard sweep, being closely linked to a soft sweep, or evolving neutrally according to the values of its feature vector (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Examples of the five classes used by S/HIC.</title>
<p>S/HIC classifies each window as a hard sweep (blue), linked to a hard sweep (purple), a soft sweep (red), linked to a soft sweep (orange), or neutral (gray). This classifier accomplishes this by examining values of various summary statistics in 11 different windows in order to infer the mode of evolution in the central window (the horizontal blue, purple, red, orange, and gray brackets). Regions that are centered on a hard (soft) selective sweep are defined as hard (soft). Regions that are not centered on selective sweeps but have their diversity impacted by a hard (soft) selective sweep but are not centered on the sweep are defined as hard-linked (soft-linked). Remaining windows are defined as neutral. S/HIC is trained on simulated examples of these five classes in order to distinguish selective sweeps from linked and neutral regions in population genomic data.</p></caption>
<graphic xlink:href="024547_fig1.tif"/>
</fig>
<p>Briefly, the Extra-Trees classifier is an ensemble classification technique that harnesses a large number classifiers referred to as decision trees. A decision tree is a simple classification tool that uses the values of multiple features for a given data instance, and creates a branching tree structure where each node in the tree is assigned a threshold value for a given feature. If a given data point&#x2019;s (or instance&#x2019;s) value of the feature at this node is below the threshold, this instance takes the left branch, and otherwise it takes the right. At the next lowest level of the tree, the value of another feature is examined. When the data instance reaches the bottom of the tree, it is assigned a class inference based on which leaf it has landed (<xref ref-type="bibr" rid="c46">Quinlan 1986</xref>). Typically, a decision tree is built according to an algorithm designed to optimize its accuracy (<xref ref-type="bibr" rid="c46">Quinlan 1986</xref>). The Extra-Trees classifier, on the other hand, builds a specified number of semi-randomly generated decision trees. Classification is then performed by simply taking the class receiving the most &#x201C;votes&#x201D; from these trees (<xref ref-type="bibr" rid="c13">Geurts et al. 2006</xref>), building on the strategy of random forests (<xref ref-type="bibr" rid="c6">Breiman 2001</xref>). While individual decision trees may be highly inaccurate, the practice of aggregating predictions from many semi-randomly generated decision trees has been proved to be quite powerful (<xref ref-type="bibr" rid="c18">Ho 1995</xref>).</p>
<p>In the following sections we describe our methodology for training, testing, and applying our Extra-Trees classifier for identifying positive selection. We also experimented with support vector machines (SVMs; <xref ref-type="bibr" rid="c7">Cortes and Vapnik 1995</xref>), but found that for this classification problem the Extra-Trees classifier slightly but consistently outperformed SVMs (data not shown).</p>
</sec>
<sec id="s2b">
<title>Coalescent simulations for training and testing</title>
<p>We simulated data for training and testing of our classifier using our coalescent simulator, discoal&#x005F;multipop (<ext-link ext-link-type="uri" xlink:href="https://github.com/kern-lab/discoal&#x005F;multipop">https://github.com/kern-lab/discoal&#x005F;multipop</ext-link>). As discussed in the Results, we simulated training sets with different demographic histories (Table S1), and, for positively selected training examples, different ranges of selection coefficients (<italic>&#x03B1;</italic>=2<italic>Ns</italic>, where <italic>s</italic> is the selective advantage and <italic>N</italic> is the population size). For each combination of demographic history and range of selection coefficients, we simulated large chromosomal windows that we later subdivided into 11 adjacent and equally sized subwindows. We then simulated training examples with a hard selective sweep whose selection coefficient was uniformly drawn from the specified range, <italic>U</italic>(<italic>&#x03B1;</italic><sub>low</sub>, <italic>&#x03B1;</italic><sub>high</sub>). We generated 11,000 sweeps: 1000 where the sweep occurred in the center of the leftmost of the 11 subwindows, 1000 where the sweep occurred in the second subwindow, and so on. We repeated this same process for soft sweeps at each location; these simulations had an additional parameter, the derived allele frequency, <italic>f</italic>, at which the mutation switches from evolving under drift to sweeping to fixation, which we drew from <italic>U</italic>(0.05, 0.2). For our equilibrium demography scenario, we drew the fixation time of the selective sweep from <italic>U</italic>(0, 0.2)&#x00D7;<italic>N</italic> generations ago, while for non-equilibrium demography the sweeps completed more recently (see below). We also simulated 1000 neutrally evolving regions. Unless otherwise noted, for each simulation the sample size was set to 100 chromosomes.</p>
<p>For each combination of demographic scenario and selection coefficient, we combined our simulated data into 5 equally-sized training sets (<xref rid="fig1" ref-type="fig">Fig. 1</xref>): a set of 1000 hard sweeps where the sweep occurs in the middle of the central subwindow (i.e. all simulated hard sweeps); a set of 1000 soft sweeps (all simulated soft sweeps); a set of 1000 windows where the central subwindow is linked to a hard sweep that occurred in one of the other 10 windows (i.e. 1000 simulations drawn randomly from the set of 10000 simulations with a hard sweep occurring in a non-central window); a set of 1000 windows where the central subwindow is linked to a soft sweep (1000 simulations drawn from the set of 10000 simulations with a flanking soft sweep); and a set of 1000 neutrally evolving windows unlinked to a sweep. We then generated a replicate set of these simulations for use as an independent test set.</p>
</sec>
<sec id="s2c">
<title>Training the Extra-Trees classifier</title>
<p>We used the python scikit-learn package (<ext-link ext-link-type="uri" xlink:href="http://scikit-learn.org/">http://scikit-learn.org/</ext-link>) to train our Extra-Trees classifier and to perform classifications. Given a training set, we trained our classifier by performing a grid search of multiple values of each of the following parameters: max&#x005F;features (the maximum number of features that could be considered at each branching step of building the decision trees, which was set to 1, 3, <inline-formula><alternatives><inline-graphic xlink:href="024547_inline3.gif"/></alternatives></inline-formula>, or <italic>n</italic>, where <italic>n</italic> is the total number of features); max&#x005F;depth (the maximum depth a decision tree can reach; set to 3, 10, or no limit), min&#x005F;samples&#x005F;split (the minimum number of training instances that must follow each branch when adding a new split to the tree in order for the split to be retained; set to 1, 3, or 10); min&#x005F;samples&#x005F;leaf. (the minimum number of training instances that must be present at each leaf in the decision tree in order for the split to be retained; set to 1, 3, or 10); bootstrap (whether or not bootstrap sampling is used to create decision trees); criterion (the criterion used to assess the quality of a proposed split in the tree, which is set to either Gini impurity or to information gain). The number of decision trees included in the forest was always set to 100. After performing a grid-search with 10-fold cross validation in order to identify the optimal combination of these parameters, we used this set of parameters to train the final classifier.</p>
</sec>
<sec id="s2d">
<title>Comparisons with other methods</title>
<p>We compared the performance of our classifier to that of various other methods. First, we examined two population genetic summary statistics: <xref ref-type="bibr" rid="c52">Tajima&#x2019;s <italic>D</italic> (1983)</xref> and Kim and Nielsen&#x2019;s <italic>&#x03C9;</italic> (2004), calculating their values in each subwindow within each large simulated chromosome that we generated for testing (see above). We also used Nielsen et al.&#x2019;s composite likelihood ratio test, referred to as CLR or SweepFinder (2005), which searches for the spatial skew in allele frequencies expected surrounding a hard selective sweep. When testing SweepFinder&#x2019;s ability to discriminate between modes of evolution within larger regions, we computed the composite-likelihood ratio between the sweep and neutral models for a site located at the center of each of the 11 subwindows of our large simulated test regions. The only training necessary for SweepFinder was to specify the neutral site frequency spectrum.</p>
<p>Next, we used scikit-learn to implement Ronen et al.&#x2019;s (2013) <italic>SFselect</italic>, a support vector machine classifier that discriminates between selection and neutrality on the basis of a region&#x2019;s binned and weighted site frequency spectrum (SFS). In our implementation we collapsed the SFS into 10 bins as suggested by Ronen et al., and also added soft sweeps as a third class (in addition to hard sweeps and neutrality), using <xref ref-type="bibr" rid="c28">Knerr et al.&#x2019;s (1990)</xref> method for extending a binary classifier to perform multi-class classification. We trained this classifier from simulated data following the same demographic and selective scenarios used to train our own classifier, and with the same number of simulated training instances, but these simulations encapsulated much smaller regions (equivalent to the size of one of our eleven subwindows). To avoid confusion with the original <italic>SFselect</italic>, which only handles hard sweeps, we refer to this implementation as <italic>SFselect</italic>&#x002B;.</p>
<p>Finally, we implemented a version of Garud et al.&#x2019;s (2015) scan for hard and soft sweeps. Garud et al.&#x2019;s method uses an Approximate Bayesian Computation-like approach to calculate Bayes Factors to determine whether a given region is more similar to a hard sweep or a soft sweep by performing coalescent simulations. For this we performed simulations with the same parameters as we used to train <italic>SFselect</italic>&#x002B;, but generated 100,000 simulations of each scenario in order to ensure that there was enough data for rejection sampling. We then used two statistics to summarize haplotypic diversity within these simulated data: <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> (<xref ref-type="bibr" rid="c34">Messer and Petrov 2013</xref>). All simulated regions whose vector [<italic>H</italic><sub>12</sub> <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>] lies within a Euclidean distance of 0.1 away from the vector corresponding to the data instance to be classified are then counted (<xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>). The ratio of simulated hard sweeps to simulated soft sweeps within this distance cutoff is then taken as the Bayes Factor. We also computed Bayes Factors for discriminating between selection and neutrality in the same manner. Note that this step was not taken by Garud et al., who restricted their analysis of the <italic>D. melanogaster</italic> genome to only the strongest signals of positive selection, only asking whether they more closely resembled hard or soft sweeps. When testing the ability of Garud et al.&#x2019;s method to distinguish selective sweeps from both linked and neutrally evolving regions, we used large simulated windows and examined values of <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> only within the subwindow that exhibited the largest value of <italic>H</italic><sub>12</sub>, in an effort to mimic their strategy of using <italic>H</italic><sub>12</sub> peaks (<xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>).</p>
<p>We summarized each method&#x2019;s power using the receiver operating characteristic (ROC) curve, making these comparisons for the following binary classification problems: discriminating between hard sweeps and neutrality, between hard sweeps and soft sweeps, between selective sweeps (hard or soft) and neutrality, and between selective sweeps (hard or soft) and unselected regions (including both neutrally evolving regions and regions linked to selective sweeps). For each of these comparisons we constructed a balanced test set with a total of 1000 simulated regions in each class, so that the expected accuracy of a completely random classifier was 50&#x0025;, and the expected area under the ROC curve (AUC) was 0.5. Whenever the task involved a class that was a composite of two or more modes of evolution, we ensured that the test set was comprised of equal parts of each subclass. For example, in the selected (hard or soft) versus unselected (neutral or linked selection) test, the selected class consisted of 500 hard sweeps and 500 soft sweeps, while the unselected class consisted of 333 neutrally evolving regions, 333 regions linked to hard sweeps, and 333 regions linked to soft sweeps (and one additional simulated region from one of these test sets randomly selected, so that the total size of the unselected test set was 1000 instances). As with our training sets, we considered the true class of a simulated test region containing a hard (soft) sweep occurring in any but the central subwindow to be hard-linked (soft-linked)&#x2014;even if the sweep occurred only one subwindow away from the center.</p>
<p>The ROC curve is generated by measuring performance at increasingly lenient thresholds for discriminating between the two classes. We therefore required each method to output a real-valued measure proportional to its confidence that a particular data instance belongs the first of the two classes. For S/HIC, we used the posterior classification probability from the Extra-Trees classifier obtained using scikit-learn&#x2019;s predict&#x005F;proba method. For <italic>SFselect</italic>&#x002B;, we used the value of the SVM decision function. For SweepFinder, we used the composite likelihood ratio. For Garud et al.&#x2019;s method, we used the fraction of accepted simulations (i.e. within a Euclidean distance of 0.1 from the test instance) that were of the first class: for example, for hard vs. soft, this is the number of accepted simulations that were hard sweeps divided by the number of accepted simulations that were either hard sweeps or soft sweeps. For Tajima&#x2019;s <italic>D</italic> (<xref ref-type="bibr" rid="c53">Tajima 1989</xref>) and Kim and Nielsen&#x2019;s <italic>&#x03C9;</italic> (<xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>), we simply used the values of these statistics.</p>
</sec>
<sec id="s2e">
<title>Simulating sweeps under non-equilibrium demographic models</title>
<p>We simulated training and test datasets from Tennessen et al.&#x2019;s (2012) European demographic model (Table S1). This model parameterizes a population contraction associated with migration out of Africa, a second contraction followed by exponential population growth, and a more recent phase of even faster exponential growth. Values of <italic>&#x03B8;</italic> and <italic>&#x03C1;</italic>=4<italic>Nr</italic> were drawn from prior distributions (Table S1), allowing for variation within the training data, whose means were selected from recent estimates of human mutation (<xref ref-type="bibr" rid="c29">Kong et al. 2012</xref>) and recombination rates (<xref ref-type="bibr" rid="c30">Kong et al. 2010</xref>), respectively. For simulations with selection, we drew values of <italic>&#x03B1;</italic> from <italic>U</italic>(5.0&#x00D7;10<sup>3</sup>, 5.0&#x00D7;10<sup>5</sup>), and drew the fixation time of the sweeping allele form <italic>U</italic>(0, 51,000) years ago (i.e. the sweep completed after the migration out of Africa).</p>
<p>We also generated simulations of Tennessen et al.&#x2019;s African demographic model, which consists of exponential population growth beginning &#x223C;5,100 years ago (Table S1). We generated two sets of these simulations: one where <italic>&#x03B1;</italic> was drawn from <italic>U</italic>(5.0&#x00D7;10<sup>4</sup>, 5.0&#x00D7;10<sup>5</sup>), and one with <italic>&#x03B1;</italic> drawn from <italic>U</italic>(5.0&#x00D7;10<sup>4</sup>, 5.0&#x00D7;10<sup>5</sup>). The sample size of these simulated data sets was set to 100 chromosomes. These two sets were then combined into a single training set. For these simulations, the sweep was constrained to complete some time during the exponential growth phase (no later than 5,100 years ago). As for simulations with constant population size, when simulating soft sweeps on a previously standing variant, we drew the derived allele frequency at the onset of positive selection from <italic>U</italic>(0.05, 0.2).</p>
</sec>
<sec id="s2f">
<title>Application to the human chromosome 18 from the 1000 Genomes CEU sample</title>
<p>We applied our method to chromosome 18 from the Phase I data release from the 1000 Genomes project (<xref ref-type="bibr" rid="c2">Altshuler et al. 2012</xref>). We restricted this analysis to the CEU population sample (individuals with European ancestry, sampled from Utah), and trained S/HIC using data from the European demographic model described above. After training this classifier, we prepared data from chromosome 18 in CEU for classification. Prior to constructing feature vectors, we first performed extensive filtering for data quality. First, we masked all sites flagged by the 1000 Genomes Project as being unfit for population genetic analyses due to having either limited or excessive read-depth or poor mapping quality (according to the strictMask files for the Phase I data set which are available at <ext-link ext-link-type="uri" xlink:href="http://www.1000genomes.org/">http://www.1000genomes.org/</ext-link>). In order to remove additional sites lying within repetitive sequence wherein genotyping may be hindered, we eliminated sites with 50 bp read mappability scores less than one (<xref ref-type="bibr" rid="c8">Derrien et al. 2012</xref>) and also sites masked by RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org">http://www.repeatmasker.org</ext-link>). Finally, we attempted to infer the ancestral state at each remaining site, using the chimpanzee (<xref ref-type="bibr" rid="c35">Mikkelsen et al. 2005</xref>) and macaque (<xref ref-type="bibr" rid="c14">Gibbs et al. 2007</xref>) genomes as outgroups. For each site, if the chimpanzee and macaque genomes agreed, we used this nucleotide as our inferred ancestral state. If instead only the chimpanzee or the macaque genome had a nucleotide aligned to the site, we used this base as our inferred ancestral state. For sites that were SNPs, we also required that the inferred ancestral state matched one of the two human alleles. For all cases where these criteria were not met, we discarded the site.</p>
<p>After data filtering, we calculated summary statistics within adjacent 200 kb windows across the entire chromosome. Windows with &#x003E;50&#x0025; of sites removed during the filtering processes were omitted from our analysis. For the remaining windows, we used a sliding window approach with a 2.2 Mb window and a 200 kb step size to calculate the feature vector in the same manner as for our simulated data, and then applied S/HIC to this feature vector to infer whether the central subwindow of this 2.2 Mb region contained a hard sweep, a soft sweep, was linked to a hard sweep, linked to a soft sweep, or evolving neutrally. Visualization of candidate regions was performed using the UCSC Genome Browser (<xref ref-type="bibr" rid="c26">Kent et al. 2002</xref>).</p>
</sec>
<sec id="s2g" sec-type="data_availability">
<title>Software availability</title>
<p>Our classification tool is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kern-lab/shIC">https://github.com/kern-lab/shIC</ext-link>, along with software for generating the feature vectors used in this paper (either from simulated training data or from real data for classification).</p>
</sec>
</sec>
<sec id="s3">
<title>RESULTS</title>
<sec id="s3a">
<title>S/HIC accurately detects hard sweeps</title>
<p>The most basic task that a selection scan must be able to perform is to distinguish between hard sweeps and neutrally evolving regions, as the expected patterns of nucleotide diversity, haplotypic diversity, and linkage disequilibrium produced by these two modes of evolution differ dramatically (<xref ref-type="bibr" rid="c33">Maynard Smith and Haigh 1974</xref>; <xref ref-type="bibr" rid="c9">Fay and Wu 2000</xref>; <xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>; <xref ref-type="bibr" rid="c23">Jensen et al. 2007</xref>; <xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>; <xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). We therefore begin by comparing S/HIC&#x2019;s power to discriminate between hard sweeps and neutrality to that of several previously published methods: these include SweepFinder (aka CLR; <xref ref-type="bibr" rid="c37">Nielsen et al. 2005</xref>), <italic>SFselect</italic> (<xref ref-type="bibr" rid="c47">Ronen et al. 2013</xref>), Garud et al.&#x2019;s haplotype approach using the <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> statistics (<xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>), Tajima&#x2019;s <italic>D</italic> (1989), and Kim and Nielsen&#x2019;s <italic>&#x03C9;</italic> (2004). We extended <italic>SFselect</italic> to allow for soft sweeps (Methods), and therefore refer to this classifier as <italic>SFselect</italic>&#x002B; in order to avoid confusion. We summarize the power of each of these approaches with the receiver operating characteristic (ROC) curve, which plots the method&#x2019;s false positive rate on the <italic>x</italic>-axis and the true positive rate on the <italic>y</italic>-axis (Methods). Powerful methods that are able to detect many true positives with very few false positives will thus have a large area under the curve (AUC), while methods performing no better than random guessing are expected to have an AUC of 0.5.</p>
<p>We began by assessing the ability of these tests to detect selection in populations with constant population size and no population structure. First, we used test sets where the selection coefficient <italic>&#x03B1;</italic>=2<italic>Ns</italic> was drawn uniformly from <italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>), finding that S/HIC outperformed every other method except <italic>SFselect</italic>&#x002B;&#x2014;both methods had perfect accuracy (AUC=1.0; Fig. S1A). We observed the same result with drawing <italic>&#x03B1;</italic> from <italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>) (AUC=1.0; Fig. S1B). For weaker selection (<italic>&#x03B1;</italic> &#x223C;<italic>U</italic>(25, 2.5&#x00D7;10<sup>2</sup>)) this classification task is more challenging, and the accuracies of most of the methods we tested dropped substantially. S/HIC, however, performed quite well, with an AUC of 0.9845, slightly better than <italic>SFselect</italic>&#x002B;, and substantially better than the remainder of the methods (Fig. S1C). Note that Garud et al.&#x2019;s method leveraging <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> performed quite poorly in these comparisons, especially in the case of weak selection. This is likely because the fixation times of the sweeps that we simulated ranged from 0 to 0.2&#x00D7;<italic>N</italic> generations ago, and the impact of selection on haplotype homozygosity decays quite rapidly after a sweep completes (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). If we repeat this comparison with sweeps completing immediately prior to sampling, this method performs quite well (consistent with results from <xref ref-type="bibr" rid="c12">Garud et al. 2015</xref>), though not as well as our method or <italic>SFselect</italic>&#x002B; (data not shown).</p>
<p>For the above comparisons, our classifier, Garud et al.&#x2019;s method, and <italic>SFselect</italic>&#x002B; were trained with the same range of selection coefficients used in these test sets. Thus, these results may inflate the performance of these methods relative to other methods, which do not require training from simulated selective sweeps. If one does not know the strength of selection, one strategy is to train a classifier using a wide range of selection coefficients so that it may be able to detect sweeps of varying strengths (<xref ref-type="bibr" rid="c47">Ronen et al. 2013</xref>). We therefore combined the three training sets from the three different ranges of <italic>&#x03B1;</italic> described above into a larger training set consisting of sweeps of <italic>&#x03B1;</italic> raging from as low as 25 to as high as 25,000. This step was done not only for S/HIC, but also for <italic>SFselect</italic>&#x002B; and our implementation of Garud et al.&#x2019;s method, and we use this approach for the remainder of the paper when using classifiers trained from constant population size data. When trained on a large range of selection coefficients, S/HIC still detected sweeps with <italic>&#x03B1;</italic> drawn from <italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>) with perfect accuracy, as did <italic>SFselect</italic>&#x002B; (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>). For stronger sweeps, we again had excellent accuracy (AUC=0.999; <xref rid="fig2" ref-type="fig">Fig. 2B</xref>) and outperformed all other methods except <italic>SFselect</italic>&#x002B; (AUC=1.0). For weaker sweeps our method had the highest accuracy (AUC=0.9854, versus 0.9697 for <italic>SFselect</italic>&#x002B; and lower for other methods; <xref rid="fig2" ref-type="fig">Fig. 2C</xref>). Thus, S/HIC can distinguish hard selective sweeps of greatly varying strengths of selection from neutrally evolving regions as well as if not better than previous methods.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a hard sweep and neutrally evolving regions.</title>
<p>A) For intermediate strengths of selection (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>)). B) For stronger selective sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>)). C) For weaker sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>)). Here, and for all other ROC curves unless otherwise noted, methods that require training from simulated sweeps were trained by combining three different training sets: one where <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>), one where <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>), and one where <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>).</p></caption>
<graphic xlink:href="024547_fig2.tif"/>
</fig>
</sec>
<sec id="s3b">
<title>S/HIC can uncover soft sweeps and distinguish them from hard sweeps</title>
<p>In order to uncover the targets of recent selective sweeps and also determine which mode of positive selection was responsible, one must be able to detect the signatures of soft as well as hard sweeps and to distinguish between them. We therefore assessed the power of each method to distinguish sets of simulated selective sweeps consisting of equal numbers of hard and soft sweeps from neutral simulations, using the same training data (for methods that require it) as for the analysis in <xref rid="fig2" ref-type="fig">Fig. 2</xref>. For all ranges of selection coefficients, S/HIC has excellent power to distinguish hard and soft sweeps from neutrality; our AUC scores ranging from 0.9636 to 0.9898, and are higher than every other method in each scenario (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). S/HIC also distinguishes hard sweeps from soft sweeps as well as or better than each other method, except in the case of weak sweeps where <italic>SFselect</italic>&#x002B; has slightly better power (AUC=0.7998 versus 0.8237, respectively; <xref rid="fig4" ref-type="fig">Fig. 4</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a sweep (either hard or soft) and unselected regions (either neutral or linked to sweeps).</title>
<p>A) For intermediate strengths of selection (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>)). B) For stronger selective sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>)). C) For weaker sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>)).</p></caption>
<graphic xlink:href="024547_fig3.tif"/>
</fig>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Heatmaps showing the fraction of regions at varying distances from sweeps inferred to belong to each class by S/HIC, <italic>SFselect</italic>&#x002B;, and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>.</title>
<p>The location of any sweep relative to the classified window (or &#x201C;Neutral&#x201D; if there is no sweep) is shown on the <italic>y</italic>-axis, while the inferred class on the <italic>x</italic>-axis. Here, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>). When classifying regions with <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>, if a hard (soft) sweep was detected, the region was classified as hard (soft) if the maximum <italic>H</italic><sub>12</sub> value was found in the central subwindow, and as hard-linked (soft-linked) otherwise.</p></caption>
<graphic xlink:href="024547_fig4.tif"/>
</fig>
</sec>
<sec id="s3c">
<title>Distinguishing sweeps from linked selection to narrow the target of adaptation</title>
<p>The goal of genomic scans for selective sweeps is not merely to quantify the extent to which positive selection impacts patterns of variation, but also to identify the targets of selection in hopes of elucidating the molecular basis of adaption. Unfortunately, hitchhiking events can skew patterns of variation across large chromosomal stretches often encompassing many loci. Furthermore, this problem not only confounds selection scan by obscuring the true target of selection, it may also lead to falsely inferred soft sweeps as a result of the soft shoulder effect (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). Our goal in designing S/HIC was to be able to accurately distinguish among positive selection, linked selection, and neutrality, thereby addressing both of these challenging problems.</p>
<p>In order to assess the ability of our approach and other methods to perform this task, we repeated the test shown in <xref rid="fig3" ref-type="fig">Fig. 3</xref>, but this time we included regions linked to selective sweeps among the set of neutral test instances. Thus, we ask how well these methods distinguish genomic windows containing the targets of selective sweeps (soft or hard) from neutrally evolving windows or windows closely linked to sweeps. Encouragingly, we find that S/HIC is able confidently distinguish windows experiencing selective sweeps from linked as well as neutrally evolving regions (<xref rid="fig5" ref-type="fig">Fig. 5</xref>)&#x2014;S/HIC achieves substantially higher accuracy than each other methods (AUC=0.9628 or higher for all values of <italic>&#x03B1;</italic>, while no other method has AUC&#x003E;0.9 for any <italic>&#x03B1;</italic>). As the selection coefficient increases, S/HIC&#x2019;s performance increase relative to that of other methods is particularly pronounced (<xref rid="fig5" ref-type="fig">Fig. 5A, B</xref>), which is unsurprising because in these cases the impact of selection on variation within linked regions is much further reaching than for weak sweeps (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Heatmaps showing the fraction of regions at varying distances from sweeps inferred to belong to each class by S/HIC, <italic>SFselect&#x002B;</italic>, and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>.</title>
<p>The location of any sweep relative to the classified window (or &#x201C;Neutral&#x201D; if there is no sweep) is shown on the <italic>y</italic>-axis, while the inferred class on the <italic>x</italic>-axis. Here, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>).</p></caption>
<graphic xlink:href="024547_fig5.tif"/>
</fig>
<p>While ROC curves provide useful information about power, a more complete view of our ability to distinguishing among hard sweeps, soft sweeps, linked selection, and neutrality can be obtained by asking how our classifier behaves at varying distances from selective sweeps. We directly compared our method&#x2019;s ability to classify regions ranging from 5 subwindows upstream of a hard sweep to 5 subwindows downstream of a hard sweep to <italic>SFselect</italic>&#x002B; (the top performer among all other methods we had examined) and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> (the only other method among those we examined that is designed to detect soft sweeps). For these simulations, each subwindow had a total recombination rate 4<italic>Nr</italic>=80, corresponding to 0.2 cM per subwindow when <italic>N</italic>=10,000. We then counted the fraction of simulations predicted to belong to each of our five classes (hard, hard-linked, soft, soft-linked, and neutral) or the three classes used for <italic>SFselect</italic>&#x002B;. As shown in <xref rid="fig6" ref-type="fig">Fig. 6</xref>, we find that when <italic>&#x03B1;</italic> ranges from 250 to 2500 and there has been a hard sweep in the central window, that the <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> method often detects the sweep, but infers it to be in one of the 10 flanking windows (based on the location of the maximum <italic>H</italic><sub>12</sub> value). S/HIC and <italic>SFSelect</italic>&#x002B; on the other hand recover the sweep with high frequency when examining the correct window (95.9&#x0025; and 96.7&#x0025; accuracy, respectively). However, as we move away from the selected site, a large number of windows are misclassified as hard sweeps by <italic>SFSelect</italic>&#x002B;. For example, <italic>SFselect</italic>&#x002B; misclassifies 47&#x0025; of cases two windows away from the true sweep as hard sweeps, and almost all of the remaining examples as soft sweeps. In contrast, our method classifies &#x003C;4&#x0025; of these regions as sweeps, correctly classifying &#x003E;93&#x0025; of these windows as hard-linked instead. At a distance of 5 windows away from the sweep, <italic>SFselect</italic>&#x002B; classifies the majority of windows as soft sweeps and many others as hard sweeps, while we classify &#x003E;95&#x0025; of windows as hard-linked, and &#x003C;1&#x0025; as sweeps of either mode. For soft sweeps, we have better sensitivity in the sweep window than <italic>SFselect</italic>&#x002B; (79.1&#x0025; versus &#x0025;). We also narrow the target of selection down to a smaller region, as we classify the majority of flanking windows as soft-linked, while <italic>SFselect</italic>&#x002B; produces many soft sweep calls in these windows.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a sweep (either hard or soft) and unselected regions (either neutral or linked to sweeps) when testing on simulations with Tennessen et al.&#x2019;s European demographic model.</title>
<p>Here, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>5</sup>), and the methods that require training from simulated sweeps were trained from the same simulations with equilibrium demography as used for <xref ref-type="fig" rid="fig2">Figures 2</xref>-<xref ref-type="fig" rid="fig7">7</xref>.</p></caption>
<graphic xlink:href="024547_fig6.tif"/>
</fig>
<p>The difference between S/HIC and <italic>SFselect</italic>&#x002B; is amplified when testing these classifiers on stronger hard sweeps (<italic>&#x03B1;</italic> ranging from 2,500 to 25,000). Our classifier is better able to narrow down the selected region by classifying flanking windows as hard-linked, while <italic>SFselect</italic>&#x002B; classifies the vast majority of simulations even 5 windows away from the target of selection as hard sweeps (<xref rid="fig7" ref-type="fig">Fig. 7</xref>). Though here <italic>SFselect</italic>&#x002B; has more sensitivity to detect hard sweeps when examining the correct window (99.6&#x0025; versus 87.9&#x0025;), as S/HIC misclassifies 11.7&#x0025; of these stronger sweeps as linked-Hard. On the other hand, we recover 80.3&#x0025; of soft sweeps versus 77.7&#x0025; for <italic>SFselect</italic>&#x002B;. We also misclassify relatively few linked regions as sweeps (&#x223C;13&#x0025; when one window away, versus &#x223C;50&#x0025; for <italic>SFselect</italic>&#x002B;). For weaker sweeps (<italic>&#x03B1;</italic> &#x223C;<italic>U</italic>(25, 250)), the impact of selection on linked regions is reduced, and <italic>SFselect</italic>&#x002B; calls fewer false sweeps in linked regions. However, S/HIC has greater sensitivity than <italic>SFselect</italic>&#x002B; to detect both hard and soft sweeps at the correct window, and also misclassify fewer flanking regions as sweeps (Fig. S2). Across the entire range of selection coefficients, S/HIC mislabeled fewer neutral simulations as sweeps (&#x223C;6&#x0025; for our classifier in each cases, versus &#x003E;9&#x0025; for <italic>SFselect</italic>&#x002B;). Garud et al.&#x2019;s method also produces relatively few false positives, but has poor sensitivity to detect hard sweeps (especially in the correct window), and even less sensitivity to soft sweeps. In summary, across all selection coefficients S/HIC has greater sensitivity than <italic>SFselect</italic>&#x002B; to detect soft sweeps, and also for hard sweeps except when selection is very strong. Importantly, for both types of sweeps S/HIC will identify a smaller candidate region around the selective sweep than <italic>SFselect</italic>&#x002B;. S/HIC is able to classify far fewer linked windows as selected because it has two classes for this purpose, hard-linked and soft-linked, that <italic>SFselect</italic>&#x002B; lacks. Though <italic>SFselect</italic>&#x002B; could be improved by incorporating these classes, it may prove difficult to determine whether a window is selected or merely linked to a sweep on the basis of its SFS alone (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>), rather than examining larger scale spatial patterns of variation.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Heatmaps showing the fraction of regions simulated under Tennessen et al.&#x2019;s European demographic model located at varying distances from sweeps inferred to belong to each class by S/HIC, <italic>SFselect</italic>&#x002B;, and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>.</title>
<p>The location of any sweep relative to the classified window (or &#x201C;Neutral&#x201D; if there is no sweep) is shown on the <italic>y</italic>-axis, while the inferred class on the <italic>x</italic>-axis. Here, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>5</sup>). These three classifiers were trained from simulations with equilibrium demography.</p></caption>
<graphic xlink:href="024547_fig7.tif"/>
</fig>
</sec>
<sec id="s3d">
<title>The impact of population size change and demographic misspecification</title>
<p>Non-equilibrium demographic histories have the potential to confound population genetic scans for selective sweeps (<xref ref-type="bibr" rid="c49">Simonsen et al. 1995</xref>; <xref ref-type="bibr" rid="c58">Wakeley and Aliacar 2001</xref>). We therefore sought to assess the power of S/HIC and other methods to detect selection occurring in populations experiencing dramatic changes in population size. To this end we trained and tested our classifiers first on a model of recent exponential population size growth (the African model from <xref ref-type="bibr" rid="c54">Tennessen et al. 2012</xref>; Table S1), and then on a model of recurrent population contraction followed by first slow and then accelerated population growth (Tennessen et al&#x2019;s European model; Table S1). For both of these demographic histories, S/HIC has the highest accuracy of all of those that we examined (ROC curves shown in Fig. S3).</p>
<p>A more pessimistic scenario is one where the true demographic history of the population is not known, and therefore misspecified during training. Most demographic events should impact patterns of variation genome-wide rather than smaller regions (but see <xref ref-type="bibr" rid="c43">Przeworski 2002</xref>; <xref ref-type="bibr" rid="c22">Jensen et al. 2005</xref>). Thus, approaches that search for spatial patterns of polymorphism consistent with selective sweeps may be more robust to demographic misspecification than methods examining local levels of variation only (as demonstrated by <xref ref-type="bibr" rid="c37">Nielsen et al. 2005</xref>). To test this, we trained S/HIC and other classifiers on equilibrium datasets, and measured their accuracy on test data simulated under the non-equilibrium demographic models described above. In Fig. S4A we show the power of these classifiers to detect selective sweeps occurring under the African model of recent exponential growth. Under this scenario, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5.0&#x00D7;10<sup>3</sup>, 5.0&#x00D7;10<sup>4</sup>) (equivalent to <italic>s</italic>&#x223C;<italic>U</italic>(6.0&#x00D7;10<sup>-3</sup>, 6.0&#x00D7;10<sup>-2</sup>) with <italic>N</italic>=424,000), S/HIC achieves an AUC of 0.7992, while the next-highest performing method is <italic>SFselect</italic>&#x002B; (AUC=0.7077). Similarly, we perform better than other methods when searching for stronger selection (<italic>&#x03B1;</italic> ranging from 5.0&#x00D7;10<sup>4</sup> to 5.0&#x00D7;10<sup>5</sup>; AUC=0.9846 versus &#x003C;0.92 for all others; Fig. S4B).</p>
<p>Note that the simple summary statistic methods <italic>&#x03C9;</italic> and Tajima&#x2019;s <italic>D</italic> have some power to detect selection even under non-equilibrium demography (Fig S3). However, this result is probably quite optimistic: the ROC curve is generated by repeatedly adjusting the critical threshold and measuring true and false positive rates. In practice, a single critical threshold may be chosen to identify putative sweeps. If this critical value is chosen based on values of the statistic generated under the incorrect demographic model, then the false positive rate may be quite high. For example, <xref ref-type="bibr" rid="c37">Nielsen et al. (2005)</xref> showed that when a threshold for Tajima&#x2019;s <italic>D</italic> is selected based on simulations under equilibrium, 100&#x0025; of neutral simulations under a population growth model exceed this threshold. In other words, the ROC curve is useful for illustrating a method&#x2019;s potential power if an appropriate threshold is selected, but this may not always be the case in practice.</p>
<p>A more informative approach to evaluating our power may thus be to examine the fraction of regions including sweeps, linked to sweeps at various recombination distances, or evolving neutrally, that were assigned to each class (as done in <xref rid="fig6" ref-type="fig">Figs. 6</xref>-7 for constant population size). We show this in Fig. S5, which better illustrates S/HIC&#x2019;s power and robustness to unknown demographic history. With <italic>&#x03B1;</italic> &#x223C;<italic>U</italic>(5.0&#x00D7;10<sup>4</sup>, 5.0&#x00D7;10<sup>5</sup>) we recover 86.7&#x0025; of hard sweeps versus 85.7&#x0025; for <italic>SFselect</italic>&#x002B; and 35.3&#x0025; for <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub> (Fig. S5D-F). Moreover, while <italic>SFselect</italic>&#x002B; classifies the vast majority of linked regions as hard or soft sweeps, we classify most of these as hard-linked, and most of the remainder as soft-linked&#x2014;we classify very few linked regions as selective sweeps. This comparison yields similar results in regions flanking soft sweeps.</p>
<p>In the context of scans for positive selection, the primary concern with non-equilibrium demography is that it will produce a large number of false selective sweep calls. Indeed, when trained on an equilibrium demographic history and tested on the exponential growth model, <italic>SFselect</italic>&#x002B; classifies roughly one-fourth of all neutral loci as having experienced recent positive selection. In stark contrast, S/HIC does not seem to be greatly affected by this problem: we classify only &#x223C;7&#x0025; of neutrally evolving regions as sweeps. As shown in Fig. S5C-D, we obtain similar results when examining sweeps with <italic>&#x03B1;</italic> &#x223C;<italic>U</italic>(5.0&#x00D7;10<sup>4</sup>, 5.0&#x00D7;10<sup>5</sup>).</p>
<p>Next, we examined the impact of demographic misspecification on power to detect selection occurring under Tennessen et al.&#x2019;s model of the population size history of Europeans following their migration out of Africa (<xref ref-type="bibr" rid="c54">Tennessen et al. 2012</xref>) but having trained S/HIC under the standard neutral model. This demographic history presents an even greater challenge for identifying positive selection than the African model, as it is characterized by two population contractions followed by exponential growth, and then a more recent phase of faster population growth (Methods). For this scenario, a single range of selection coefficients was used: <italic>&#x03B1;</italic> &#x223C;<italic>U</italic>(5.0&#x00D7;10<sup>3</sup>, 5.0&#x00D7;10<sup>5</sup>). Here, we find that, perhaps unsurprisingly, the performance of most methods is lower than in the African scenario. However, S/HIC once again appears substantially more robust to misspecification of the demographic model than other methods (AUC=0.8247 versus 0.5609 for the next best method; <xref rid="fig8" ref-type="fig">Fig. 8</xref>).</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>Browser screenshot showing patterns of variation around a putative selective sweep in Europeans near <italic>CD226</italic> and <italic>RTTN</italic> in chr18.</title>
<p>Values of <italic>&#x03A0;</italic>, Tajima&#x2019;s <italic>D</italic>, Fay and Wu&#x2019;s <italic>H</italic>, Kelley&#x2019;s <italic>Z</italic><sub><italic>nS</italic></sub>, and Nielsen et al&#x2019;s composite likelihood ratio, all from <xref ref-type="bibr" rid="c45">Pybus et al. (2013)</xref>, are shown. Beneath these statistics we show the classifications from S/HIC (red: hard sweep; faded red: hard-linked; blue: soft sweep; faded blue: soft-linked; black: neutral). This image was generated using the UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu">http://genome.ucsc.edu</ext-link>).</p></caption>
<graphic xlink:href="024547_fig8.tif"/>
</fig>
<p>When we take a closer look and examine the proportion of windows at various distances from sweeps that are assigned to each class, we find that while S/HIC classifies hard sweeps with lower sensitivity than under constant population size scenario (63.9&#x0025; and 12.5&#x0025; of test examples are classified as hard and soft, respectively), relatively few linked windows are classified as sweeps (Fig. 9A). For soft sweeps S/HIC fares less well (16.7&#x0025; of windows are correctly classified, and 34.5&#x0025; classified as hard sweeps), though again relatively few false positives are produced in linked regions. In contrast, <italic>SFselect</italic>&#x002B; classifies the majority of windows as soft sweeps (Fig. 9B), including 62.6&#x0025; of hard sweeps, and 91.5&#x0025; of neutral regions. Thus, under this model our method remains fairly sensitive to selective sweeps, though it struggles to correctly infer the mode of selection, while avoiding the enormous false positive rates that may plague other methods. Together, the above results lend credence to the idea that spatial patterns of variation will be far less impaired by misspecification of the demographic model.</p>
</sec>
<sec id="s3e">
<title>Identifying selective sweeps in a human population sample with European ancestry</title>
<p>The results from simulated data described above suggest that our method has the potential to identify selective sweeps and distinguish them from linked selection and neutrality with excellent accuracy. In order to demonstrate our method&#x2019;s practical utility, we used it to perform a scan for positive selection in humans. In particular, we searched the 1000 Genomes Project&#x2019;s CEU population sample (European individuals from Utah) for selective sweeps occurring after the migration out of Africa. We focused this search on chromosome 18, where several putative selective sweeps have been identified in Europeans (<xref ref-type="bibr" rid="c60">Williamson et al. 2007</xref>). The steps we took to train our classifier and filter the 1000 Genomes data prior to conducting our scan are described in the Methods.</p>
<p>In total, we examined 345 windows, each 200 kb in length. We classified 17 windows (4.9&#x0025;) as centered around a hard sweep, 183 (53.0&#x0025;) as linked to a hard sweep, 38 (11.0&#x0025;) as centered around a soft sweep, 77 (8.7&#x0025;) as linked to a soft sweep, and 30 (8.7&#x0025;) as neutral. Surprisingly, we infer that over 60&#x0025; of windows lie within regions whose patterns of variation are affected by linked sweeps, even though sweeps appear to be quite rare. This implies that, given the genomic landscape of recombination in humans, even rare selective events may be strong enough to impact variation across much larger stretches of the genome.</p>
<p>Encouragingly, our scan recovered 4 of the 5 putative sweeps on chromosome 18 in Europeans identified by <xref ref-type="bibr" rid="c60">Williamson et al. (2007)</xref> using SweepFinder. These include <italic>CCDC178</italic> (which we classify as a hard sweep), <italic>DTNA</italic> (which we classify as soft), <italic>CCDC102B</italic> (soft), and the region spanning portions of <italic>CD226</italic> and <italic>RTTN</italic> (hard; shown in Fig. 10). In each of these loci, the windows that we predicted to contain the sweep overlapped regions of elevated composite likelihood ratio (CLR) values from SweepFinder (visualized using data from <xref ref-type="bibr" rid="c45">Pybus et al. 2013</xref>). Although the CLR statistic is not completely orthogonal to the summary statistics we examine to perform our classifications, the close overlap that we observe between these two methods underscores our ability to precisely detect the targets of recent positive selection. The complete set of coordinates of putative sweeps from this scan is listed in Table S2.</p>
<p>Next, we asked whether S/HIC recovered evidence of positive selection on the <italic>LCT</italic> (lactase) locus. Previous studies have found evidence for very recent and strong selection on this gene in the form population differentiation and long-range haplotype homozygosity (<xref ref-type="bibr" rid="c19">Hollox et al. 2001</xref>; <xref ref-type="bibr" rid="c4">Bersaglieri et al. 2004</xref>; <xref ref-type="bibr" rid="c56">Tishkoff et al. 2007</xref>). Moreover, several variants in this region are associated with lactase persistence. Nielsen et al.&#x2019;s CLR has also identified this region (<xref ref-type="bibr" rid="c37">Nielsen et al. 2005</xref>), but not consistently: Williamson et al.&#x2019;s (<xref ref-type="bibr" rid="c60">Williamson et al. 2007</xref>) CLR scan did not detect a sweep at this locus, nor does a recent scan using the 1000 Genomes data (data from <xref ref-type="bibr" rid="c45">Pybus et al. 2013</xref>; Fig. S6). This may be expected, as the selection on lactase persistence alleles appears to have not yet produced completed sweeps. Overall, there is very strong evidence of recent and perhaps ongoing selection for lactase persistence in human populations relying on diary for nutrition.</p>
<p>Like the SweepFinder CLR, S/HIC in its current form is also designed to detect completed sweeps. Nonetheless, we applied S/HIC to a 4 Mb region on chromosome 2 spanning <italic>LCT</italic> and neighboring loci. Consistent with previous studies, we found an extremely strong signal of recent positive selection, with a 1 Mb region encompassing <italic>LCT</italic> classified as a hard sweep (Fig. S6). This result is also in agreement with <xref ref-type="bibr" rid="c42">Peter et al. (2012)</xref>, whose approximate Bayesian computation (ABC) approach supported a hard sweep over selection on standing variation at <italic>LCT</italic>. Such a large candidate region might be expected after a very strong selective sweep as is believed to have occurred (or may be ongoing) at <italic>LCT</italic>. However, we cannot rule the possibility of additional targets of selection in this region of chromosome 2: our candidate window also overlaps a region identified by <xref ref-type="bibr" rid="c16">Green et al. (2010)</xref> as having an excess of derived alleles in the human genome relative to the number observed in Neanderthal.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>Detecting the genetic targets of recent adaptation and the mode of positive selection acting on them&#x2014;selection on <italic>de novo</italic> mutations versus previously standing variants&#x2014;remains an important challenge in population genetics. The majority of efforts to this end have relied on population genetic summary statistics designed to uncover loci where patterns of allele frequency (e.g. <xref ref-type="bibr" rid="c53">Tajima 1989</xref>; <xref ref-type="bibr" rid="c11">Fu and Li 1993</xref>; <xref ref-type="bibr" rid="c9">Fay and Wu 2000</xref>) or linkage disequilibrium (e.g. <xref ref-type="bibr" rid="c25">Kelly 1997</xref>; <xref ref-type="bibr" rid="c27">Kim and Nielsen 2004</xref>) depart from the neutral expectation. Recently, powerful machine learning techniques have begun to be applied to this problem, showing great promise (<xref ref-type="bibr" rid="c39">Pavlidis et al. 2010</xref>; <xref ref-type="bibr" rid="c32">Lin et al. 2011</xref>; <xref ref-type="bibr" rid="c47">Ronen et al. 2013</xref>; <xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). Here we have adopted a machine learning approach to develop S/HIC, a method designed to not only uncover selective sweeps, but to distinguish them from regions linked to sweeps as well as neutrally evolving regions, and to identify the mode of selection. This is achieved by examining spatial patterns of a variety of population genetic summary statistics that capture different facets of variation across a large-scale genomic region. Currently, this method examines the values of nine statistics across eleven different windows in infer the mode of evolution in the central window&#x2014;this makes for a total of 99 different values considered by the classifier. By leveraging all of this information jointly, our Extra-Trees classifier is able to detect selection with accuracy unattainable by methods examining a single statistic, underscoring the potential of the machine learning paradigm for population genetic inference. Indeed, on simulated datasets with constant population size, S/HIC has power matching or exceeding previous methods when linked selection is not considered (i.e. the sweep site is known <italic>a priori</italic>), and vastly outperforms them under the more realistic scenario where positive selection must be distinguished from linked selection as well as neutrality.</p>
<p>We argue that the task of discriminating between the targets of positive selection and linked but unselected regions is an extremely important and underappreciated problem that must be solved if we hope to identify the genetic underpinnings of recent adaptation in practice. This is especially so in organisms where the impact of positive selection is pervasive, and therefore much of the genome may be linked to recent selective sweeps (e.g. <xref ref-type="bibr" rid="c31">Langley et al. 2012</xref>). A method that can discriminate between sweeps and linked selection would have three important benefits. First, it will reduce the number of spurious sweep calls in flanking regions, thereby mitigating the soft shoulder problem (<xref ref-type="bibr" rid="c48">Schrider et al. 2015</xref>). Second, such a method would have the potential to narrow down the candidate genomic region of adaptation. Third, such a method would be able to find those regions <italic>least</italic> affected by linked selection, which themselves might act as excellent neutral proxies for inference into demography or mutation. We have shown that S/HIC is able to distinguish among selection, linked selection, and neutrality with remarkable power, granting it the ability to localize selective sweeps with unrivaled accuracy and precision, demonstrating its practical utility.</p>
<p>While S/HIC performs favorably to other approaches under the ideal scenario where the true demographic history of the population is known, in practice this may not always be the case. However, because our method relies on spatial patterns of variation, we are especially robust to demography: if the demographic model is misspecified, the disparity in accuracy between S/HIC and other methods is even more dramatic. For example, if we train S/HIC with simulated datasets with constant population size, but test it on simulated population samples experiencing recent exponential growth (e.g. the African model from <xref ref-type="bibr" rid="c54">Tennessen et al. 2012</xref>), we still identify sweeps and infer the mode of selection with impressive accuracy, and vastly outperform other methods. We also tested S/HIC on a more challenging model with two population contractions followed by slow exponential growth, and more recent accelerated growth (the European model from <xref ref-type="bibr" rid="c54">Tennessen et al. 2012</xref>). Though S/HIC performs far better than other tests for selection in this case, power for all methods is far lower than under constant population size, even if the demographic model is properly specified during training. The reason for this is somewhat disconcerting: under this demographic model, the impact of selective sweeps on genetic diversity is blunted, making it far more difficult for any method to identify selection and discriminate between hard and soft sweeps. This underscores a problem that could prove especially difficult to overcome. That is, for some demographic histories all but the strongest selective sweeps may produce almost no impact on diversity for selection scans to exploit.</p>
<p>A second and related confounding effect of misspecified demography is that following population contraction and recovery/expansion, much of the genome may depart from the neutral expectation, even if selective sweeps are rare. By examining the relative levels of various summaries of variation across a large region, rather than the actual values of these statistics, we are quite robust to this problem (Fig. 9; <xref ref-type="fig" rid="figS5">Fig S5</xref>). In other words, while non-equilibrium demography may reduce S/HIC&#x2019;s sensitivity to selection and its ability to discriminate between hard and soft sweeps, we still classify relatively few neutral or even linked regions as selected. Thus, although inferring the mode of positive selection with high confidence may remain extremely difficult in some populations, our method appears to be particularly well suited for detecting selection in populations with non-equilibrium demographic histories whose parameters are uncertain. Indeed, applying our approach to chromosome 18 in a European human population, we detect most of the putative sweeps previously reported by <xref ref-type="bibr" rid="c60">Williamson et al. (2007)</xref>.</p>
<p>In summary, we have devised a machine learning-based scan for positive selection that possesses not only unparalleled accuracy, but is also exceptionally robust to demography. Adjustments to the feature space can easily be made to better suit a particular study population. For example, if haplotypic phase is unknown, one can replace measures of gametic LD with zygotic LD. Additional classes could also be incorporated into the classifier (e.g. &#x201C;partial&#x201D; or incomplete sweeps), along with relevant summary statistics (features) such as <italic>iHS</italic> and <italic>nS</italic><sub>L</sub> (<xref ref-type="bibr" rid="c57">Voight et al. 2006</xref>; <xref ref-type="bibr" rid="c10">Ferrer-Admetlla et al. 2014</xref>). Thus, our approach is practical and flexible. As additional population genetic summary statistics and tests for selection are devised, they can be incorporated into our feature space, thereby strengthening an already powerful method which has the potential to illuminate the impact of selection on genomic variation with unprecedented detail.</p>
</sec>
</body>
<back>
<ack>
<title>ACKNOWLEDGEMENTS</title>
<p>We thank Matthew Hahn and Adam Siepel for comments on the manuscript. D.R.S. was supported by the National Institutes of Health (NIH) under Ruth L. Kirschstein National Research Service Award F32 GM105231. A.D.K. was supported by National Science Foundation Award MCB-1161367, and by the National Institute of General Medical Sciences of the NIH under award no. R01GM078204.</p>
</ack>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Akey</surname> <given-names>JM</given-names></string-name>. <year>2009</year>. <article-title>Constructing genomic maps of positive selection in humans: Where do we go from here?</article-title> <source>Genome research</source> <volume>19</volume>: <fpage>711</fpage>&#x2013;<lpage>722</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Altshuler</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Durbin</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Abecasis</surname> <given-names>GR</given-names></string-name>, <etal>et al.</etal> <year>2012</year>. <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source> <volume>491</volume>: <fpage>56</fpage>&#x2013;<lpage>65</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Berry</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Ajioka</surname> <given-names>J</given-names></string-name> and <string-name><surname>Kreitman</surname> <given-names>M.</given-names></string-name> <year>1991</year>. <article-title>Lack of polymorphism on the Drosophila fourth chromosome resulting from selection</article-title>. <source>Genetics</source> <volume>129</volume>: <fpage>1111</fpage>&#x2013;<lpage>1117</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Bersaglieri</surname> <given-names>T</given-names></string-name>, <string-name><surname>Sabeti</surname> <given-names>PC</given-names></string-name>, <string-name><surname>Patterson</surname> <given-names>N</given-names></string-name>, <string-name><surname>Vanderploeg</surname> <given-names>T</given-names></string-name>, <string-name><surname>Schaffner</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Drake</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Rhodes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reich</surname> <given-names>DE</given-names></string-name> and <string-name><surname>Hirschhorn</surname> <given-names>JN.</given-names></string-name> <year>2004</year>. <article-title>Genetic signatures of strong recent positive selection at the lactase gene</article-title>. <source>The American Journal of Human Genetics</source> <volume>74</volume>: <fpage>1111</fpage>&#x2013;<lpage>1120</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Braverman</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Hudson</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Kaplan</surname> <given-names>NL</given-names></string-name>, <string-name><surname>Langley</surname> <given-names>CH</given-names></string-name> and <string-name><surname>Stephan</surname> <given-names>W.</given-names></string-name> <year>1995</year>. <article-title>The hitchhiking effect on the site frequency spectrum of DNA polymorphisms</article-title>. <source>Genetics</source> <volume>140</volume>: <fpage>783</fpage>&#x2013;<lpage>796</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Breiman</surname> <given-names>L.</given-names></string-name> <year>2001</year>. <article-title>Random forests</article-title>. <source>Machine learning</source> <volume>45</volume>: <fpage>5</fpage>&#x2013;<lpage>32</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Cortes</surname> <given-names>C</given-names></string-name> and <string-name><surname>Vapnik</surname> <given-names>V.</given-names></string-name> <year>1995</year>. <article-title>Support-vector networks</article-title>. <source>Machine learning</source> <volume>20</volume>: <fpage>273</fpage>&#x2013;<lpage>297</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Derrien</surname> <given-names>T</given-names></string-name>, <string-name><surname>Estell&#x00E9;</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sola</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Knowles</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Raineri</surname> <given-names>E</given-names></string-name>, <string-name><surname>Guig&#x00F3;</surname> <given-names>R</given-names></string-name> and <string-name><surname>Ribeca</surname> <given-names>P.</given-names></string-name> <year>2012</year>. <article-title>Fast computation and applications of genome mappability</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e30377</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Fay</surname> <given-names>JC</given-names></string-name> and <string-name><surname>Wu</surname> <given-names>C-I.</given-names></string-name> <year>2000</year>. <article-title>Hitchhiking under positive Darwinian selection</article-title>. <source>Genetics</source> <volume>155</volume>: <fpage>14051413</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Ferrer-Admetlla</surname> <given-names>A</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>M</given-names></string-name>, <string-name><surname>Korneliussen</surname> <given-names>T</given-names></string-name> and <string-name><surname>Nielsen</surname> <given-names>R.</given-names></string-name> <year>2014</year>. <article-title>On detecting incomplete soft or hard selective sweeps using haplotype structure</article-title>. <source>Molecular Biology and Evolution</source> <volume>31</volume>: <fpage>1275</fpage>&#x2013;<lpage>1291</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Fu</surname> <given-names>Y-X</given-names></string-name> and <string-name><surname>Li</surname> <given-names>W-H.</given-names></string-name> <year>1993</year>. <article-title>Statistical tests of neutrality of mutations</article-title>. <source>Genetics</source> <volume>133</volume>: <fpage>693</fpage>&#x2013;<lpage>709</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Garud</surname> <given-names>NR</given-names></string-name>, <string-name><surname>Messer</surname> <given-names>PW</given-names></string-name>, <string-name><surname>Buzbas</surname> <given-names>EO</given-names></string-name> and <string-name><surname>Petrov</surname> <given-names>DA</given-names></string-name>. <year>2015</year>. <article-title>Recent selective sweeps in North American Drosophila melanogaster show signatures of soft sweeps</article-title>. <source>PLoS genetics</source> <volume>11</volume>: <fpage>e1005004</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Geurts</surname> <given-names>P</given-names></string-name>, <string-name><surname>Ernst</surname> <given-names>D</given-names></string-name> and <string-name><surname>Wehenkel</surname> <given-names>L.</given-names></string-name> <year>2006</year>. <article-title>Extremely randomized trees</article-title>. <source>Machine learning</source> <volume>63</volume>: <fpage>342</fpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Gibbs</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Rogers</surname> <given-names>J</given-names></string-name>, <string-name><surname>Katze</surname> <given-names>MG</given-names></string-name>, <etal>et al.</etal> <year>2007</year>. <article-title>Evolutionary and biomedical insights from the rhesus macaque genome</article-title>. <source>Science</source> <volume>316</volume>: <fpage>222</fpage>&#x2013;<lpage>234</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="book"><string-name><surname>Gillespie</surname> <given-names>JH</given-names></string-name>. <year>1991</year>. <source>The causes of molecular evolution</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Green</surname> <given-names>RE</given-names></string-name>, <string-name><surname>Krause</surname> <given-names>J</given-names></string-name>, <string-name><surname>Briggs</surname> <given-names>AW</given-names></string-name>, <etal>et al.</etal> <year>2010</year>. <article-title>A draft sequence of the Neandertal genome</article-title>. <source>Science</source> <volume>328</volume>: <fpage>710</fpage>&#x2013;<lpage>722</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Hermisson</surname> <given-names>J</given-names></string-name> and <string-name><surname>Pennings</surname> <given-names>PS</given-names></string-name>. <year>2005</year>. <article-title>Soft sweeps molecular population genetics of adaptation from standing genetic variation</article-title>. <source>Genetics</source> <volume>169</volume>: <fpage>2335</fpage>&#x2013;<lpage>2352</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="confproc"><person-group person-group-type="editor"><string-name><surname>Ho</surname> <given-names>TK</given-names></string-name></person-group> editor. <article-title>Document Analysis and Recognition, 1995</article-title>, <conf-name>Proceedings of the Third International Conference on</conf-name>. <year>1995</year>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Hollox</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Poulter</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zvarik</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ferak</surname> <given-names>V</given-names></string-name>, <string-name><surname>Krause</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jenkins</surname> <given-names>T</given-names></string-name>, <string-name><surname>Saha</surname> <given-names>N</given-names></string-name>, <string-name><surname>Kozlov</surname> <given-names>AI</given-names></string-name> and <string-name><surname>Swallow</surname> <given-names>DM</given-names></string-name>. <year>2001</year>. <article-title>Lactase haplotype diversity in the Old World</article-title>. <source>The American Journal of Human Genetics</source> <volume>68</volume>: <fpage>160</fpage>&#x2013;<lpage>172</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Innan</surname> <given-names>H</given-names></string-name> and <string-name><surname>Kim</surname> <given-names>Y.</given-names></string-name> <year>2004</year>. <article-title>Pattern of polymorphism after strong artificial selection in a domestication event</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>101</volume>: <fpage>10667</fpage>&#x2013;<lpage>10672</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Jensen</surname> <given-names>JD</given-names></string-name>. <year>2014</year>. <article-title>On the unfounded enthusiasm for soft selective sweeps</article-title>. <source>Nature communications</source> <volume>5</volume>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Jensen</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>Y</given-names></string-name>, <string-name><surname>DuMont</surname> <given-names>VB</given-names></string-name>, <string-name><surname>Aquadro</surname> <given-names>CF</given-names></string-name> and <string-name><surname>Bustamante</surname> <given-names>CD</given-names></string-name>. <year>2005</year>. <article-title>Distinguishing between selective sweeps and demography using DNA polymorphism data</article-title>. <source>Genetics</source> <volume>170</volume>: <fpage>1401</fpage>&#x2013;<lpage>1410</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Jensen</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Thornton</surname> <given-names>KR</given-names></string-name>, <string-name><surname>Bustamante</surname> <given-names>CD</given-names></string-name> and <string-name><surname>Aquadro</surname> <given-names>CF</given-names></string-name>. <year>2007</year>. <article-title>On the utility of linkage disequilibrium as a statistic for identifying targets of positive selection in nonequilibrium populations</article-title>. <source>Genetics</source> <volume>176</volume>: <fpage>2371</fpage>&#x2013;<lpage>2379</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Kaplan</surname> <given-names>NL</given-names></string-name>, <string-name><surname>Hudson</surname> <given-names>R</given-names></string-name> and <string-name><surname>Langley</surname> <given-names>C.</given-names></string-name> <year>1989</year>. <article-title>The&#x201D; hitchhiking effect&#x201D; revisited</article-title>. <source>Genetics</source> <volume>123</volume>: <fpage>887</fpage>&#x2013;<lpage>899</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Kelly</surname> <given-names>JK</given-names></string-name>. <year>1997</year>. <article-title>A test of neutrality based on interlocus associations</article-title>. <source>Genetics</source> <volume>146</volume>: <fpage>1197</fpage>&#x2013;<lpage>1206</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Kent</surname> <given-names>WJ</given-names></string-name>, <string-name><surname>Sugnet</surname> <given-names>CW</given-names></string-name>, <string-name><surname>Furey</surname> <given-names>TS</given-names></string-name>, <string-name><surname>Roskin</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Pringle</surname> <given-names>TH</given-names></string-name>, <string-name><surname>Zahler</surname> <given-names>AM</given-names></string-name> and <string-name><surname>Haussler</surname> <given-names>D.</given-names></string-name> <year>2002</year>. <article-title>The human genome browser at UCSC</article-title>. <source>Genome research</source> <volume>12</volume>: <fpage>996</fpage>&#x2013;<lpage>1006</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>Y</given-names></string-name> and <string-name><surname>Nielsen</surname> <given-names>R.</given-names></string-name> <year>2004</year>. <article-title>Linkage disequilibrium as a signature of selective sweeps</article-title>. <source>Genetics</source> <volume>167</volume>:<fpage>1513</fpage>&#x2013;<lpage>1524</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="book"><string-name><surname>Knerr</surname> <given-names>S</given-names></string-name>, <string-name><surname>Personnaz</surname> <given-names>L</given-names></string-name> and <string-name><surname>Dreyfus</surname> <given-names>G.</given-names></string-name> <year>1990</year>. <chapter-title>Single-layer learning revisited: a stepwise procedure for building and training a neural network</chapter-title>. <source>In. Neurocomputing</source>: <publisher-name>Springer</publisher-name>. p. <fpage>41</fpage>&#x2013;<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Kong</surname> <given-names>A</given-names></string-name>, <string-name><surname>Frigge</surname> <given-names>ML</given-names></string-name>, <string-name><surname>Masson</surname> <given-names>G</given-names></string-name>, <etal>et al.</etal> <year>2012</year>. <article-title>Rate of de novo mutations and the importance of father/&#x2019;s age to disease risk</article-title>. <source>Nature</source> <volume>488</volume>: <fpage>471</fpage>&#x2013;<lpage>475</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Kong</surname> <given-names>A</given-names></string-name>, <string-name><surname>Thorleifsson</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gudbjartsson</surname> <given-names>DF</given-names></string-name>, <etal>et al.</etal> <year>2010</year>. <article-title>Fine-scale recombination rate differences between sexes, populations and individuals</article-title>. <source>Nature</source> <volume>467</volume>: <fpage>1099</fpage>&#x2013;<lpage>1103</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Langley</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Stevens</surname> <given-names>K</given-names></string-name>, <string-name><surname>Cardeno</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal> <year>2012</year>. <article-title>Genomic variation in natural populations of <italic>Drosophila melanogaster</italic></article-title>. <source>Genetics</source> <volume>192</volume>: <fpage>533</fpage>&#x2013;<lpage>598</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Lin</surname> <given-names>K</given-names></string-name>, <string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Schl&#x00F6;tterer</surname> <given-names>C</given-names></string-name> and <string-name><surname>Futschik</surname> <given-names>A.</given-names></string-name> <year>2011</year>. <article-title>Distinguishing positive selection from neutral evolution: boosting the performance of summary statistics</article-title>. <source>Genetics</source> <volume>187</volume>: <fpage>229</fpage>&#x2013;<lpage>244</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Maynard Smith</surname> <given-names>J</given-names></string-name> and <string-name><surname>Haigh</surname> <given-names>J.</given-names></string-name> <year>1974</year>. <article-title>The hitch-hiking effect of a favourable gene</article-title>. <source>Genetical Research</source> <volume>23</volume>: <fpage>23</fpage>&#x2013;<lpage>35</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Messer</surname> <given-names>PW</given-names></string-name> and <string-name><surname>Petrov</surname> <given-names>DA</given-names></string-name>. <year>2013</year>. <article-title>Population genomics of rapid adaptation by soft selective sweeps</article-title>. <source>Trends in Ecology &#x0026; Evolution</source> <volume>28</volume>: <fpage>659</fpage>&#x2013;<lpage>669</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Mikkelsen</surname> <given-names>TS</given-names></string-name>, <string-name><surname>Hillier</surname> <given-names>LW</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>EE</given-names></string-name>, <etal>et al.</etal> <year>2005</year>. <article-title>Initial sequence of the chimpanzee genome and comparison with the human genome</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>69</fpage>&#x2013;<lpage>87</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Nei</surname> <given-names>M</given-names></string-name> and <string-name><surname>Li</surname> <given-names>W-H.</given-names></string-name> <year>1979</year>. <article-title>Mathematical model for studying genetic variation in terms of restriction endonucleases</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>76</volume>: <fpage>52695273</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Nielsen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Williamson</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Hubisz</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Clark</surname> <given-names>AG</given-names></string-name> and <string-name><surname>Bustamante</surname> <given-names>C.</given-names></string-name> <year>2005</year>. <article-title>Genomic scans for selective sweeps using SNP data</article-title>. <source>Genome Research</source> <volume>15</volume>: <fpage>1566</fpage>&#x2013;<lpage>1575</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Orr</surname> <given-names>HA</given-names></string-name> and <string-name><surname>Betancourt</surname> <given-names>AJ</given-names></string-name>. <year>2001</year>. <article-title>Haldane&#x2019;s sieve and adaptation from the standing genetic variation</article-title>. <source>Genetics</source> <volume>157</volume>: <fpage>875</fpage>&#x2013;<lpage>884</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Pavlidis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Jensen</surname> <given-names>JD</given-names></string-name> and <string-name><surname>Stephan</surname> <given-names>W.</given-names></string-name> <year>2010</year>. <article-title>Searching for footprints of positive selection in whole-genome SNP data from nonequilibrium populations</article-title>. <source>Genetics</source> <volume>185</volume>: <fpage>907</fpage>&#x2013;<lpage>922</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Pennings</surname> <given-names>PS</given-names></string-name> and <string-name><surname>Hermisson</surname> <given-names>J.</given-names></string-name> <year>2006a</year>. <article-title>Soft sweeps II&#x2013;molecular population genetics of adaptation from recurrent mutation or migration</article-title>. <source>Molecular Biology and Evolution</source> <volume>23</volume>: <fpage>1076</fpage>&#x2013;<lpage>1084</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Pennings</surname> <given-names>PS</given-names></string-name> and <string-name><surname>Hermisson</surname> <given-names>J.</given-names></string-name> <year>2006b</year>. <article-title>Soft sweeps III: the signature of positive selection from recurrent mutation</article-title>. <source>PLoS Genetics</source> <volume>2</volume>: <fpage>e186</fpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Peter</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Huerta-Sanchez</surname> <given-names>E</given-names></string-name> and <string-name><surname>Nielsen</surname> <given-names>R.</given-names></string-name> <year>2012</year>. <article-title>Distinguishing between selective sweeps from standing variation and from a <italic>de novo</italic> mutation</article-title>. <source>PLoS Genetics</source> <volume>8</volume>: <fpage>e1003011</fpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Przeworski</surname> <given-names>M.</given-names></string-name> <year>2002</year>. <article-title>The signature of positive selection at randomly chosen loci</article-title>. <source>Genetics</source> <volume>160</volume>: <fpage>1179</fpage>&#x2013;<lpage>1189</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Przeworski</surname> <given-names>M</given-names></string-name>, <string-name><surname>Coop</surname> <given-names>G</given-names></string-name> and <string-name><surname>Wall</surname> <given-names>JD</given-names></string-name>. <year>2005</year>. <article-title>The signature of positive selection on standing genetic variation</article-title>. <source>Evolution</source> <volume>59</volume>: <fpage>2312</fpage>&#x2013;<lpage>2323</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="other"><string-name><surname>Pybus</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dall&#x2019;Olio</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Luisi</surname> <given-names>P</given-names></string-name>, <string-name><surname>Uzkudun</surname> <given-names>M</given-names></string-name>, <string-name><surname>Carre&#x00F1;o-Torres</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pavlidis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Laayouni</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bertranpetit</surname> <given-names>J</given-names></string-name> and <string-name><surname>Engelken</surname> <given-names>J.</given-names></string-name> <year>2013</year>. <article-title>1000 Genomes Selection Browser 1.0: a genome browser dedicated to signatures of natural selection in modern humans</article-title>. <source>Nucleic Acids research</source>: <fpage>gkt 1188</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Quinlan</surname> <given-names>JR</given-names></string-name>. <year>1986</year>. <article-title>Induction of decision trees</article-title>. <source>Machine learning</source> <volume>1</volume>: <fpage>81</fpage>&#x2013;<lpage>106</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="other"><string-name><surname>Ronen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Udpa</surname> <given-names>N</given-names></string-name>, <string-name><surname>Halperin</surname> <given-names>E</given-names></string-name> and <string-name><surname>Bafna</surname> <given-names>V.</given-names></string-name> <year>2013</year>. <article-title>Learning natural selection from the site frequency spectrum</article-title>. <source>Genetics</source>: doi: <pub-id pub-id-type="doi">10.1534/genetics.1113.152587</pub-id>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Schrider</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Mendes</surname> <given-names>FK</given-names></string-name>, <string-name><surname>Hahn</surname> <given-names>MW</given-names></string-name> and <string-name><surname>Kern</surname> <given-names>AD</given-names></string-name>. <year>2015</year>. <article-title>Soft shoulders ahead: spurious signatures of soft and partial selective sweeps result from linked hard sweeps</article-title>. <source>Genetics</source> <volume>200</volume>: <fpage>267</fpage>&#x2013;<lpage>284</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Simonsen</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Churchill</surname> <given-names>GA</given-names></string-name> and <string-name><surname>Aquadro</surname> <given-names>CF</given-names></string-name>. <year>1995</year>. <article-title>Properties of statistical tests of neutrality for DNA polymorphism data</article-title>. <source>Genetics</source> <volume>141</volume>: <fpage>413</fpage>&#x2013;<lpage>429</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Stephan</surname> <given-names>W</given-names></string-name>, <string-name><surname>Song</surname> <given-names>YS</given-names></string-name> and <string-name><surname>Langley</surname> <given-names>CH</given-names></string-name>. <year>2006</year>. <article-title>The hitchhiking effect on linkage disequilibrium between linked neutral loci</article-title>. <source>Genetics</source> <volume>172</volume>: <fpage>2647</fpage>&#x2013;<lpage>2663</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Stephan</surname> <given-names>W</given-names></string-name>, <string-name><surname>Wiehe</surname> <given-names>TH</given-names></string-name> and <string-name><surname>Lenz</surname> <given-names>MW</given-names></string-name>. <year>1992</year>. <article-title>The effect of strongly selected substitutions on neutral polymorphism: analytical results based on diffusion theory</article-title>. <source>Theoretical Population Biology</source> <volume>41</volume>: <fpage>237</fpage>&#x2013;<lpage>254</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Tajima</surname> <given-names>F.</given-names></string-name> <year>1983</year>. <article-title>Evolutionary relationship of DNA sequences in finite populations</article-title>. <source>Genetics</source> <volume>105</volume>: <fpage>437</fpage>&#x2013;<lpage>460</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Tajima</surname> <given-names>F.</given-names></string-name> <year>1989</year>. <article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title>. <source>Genetics</source> <volume>123</volume>: <fpage>585</fpage>&#x2013;<lpage>595</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Tennessen</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bigham</surname> <given-names>AW</given-names></string-name>, <string-name><surname>O&#x2019;Connor</surname> <given-names>TD</given-names></string-name>, <etal>et al.</etal> <year>2012</year>. <article-title>Evolution and functional impact of rare coding variation from deep sequencing of human exomes</article-title>. <source>Science</source> <volume>337</volume>: <fpage>64</fpage>&#x2013;<lpage>69</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Teshima</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Coop</surname> <given-names>G</given-names></string-name> and <string-name><surname>Przeworski</surname> <given-names>M.</given-names></string-name> <year>2006</year>. <article-title>How reliable are empirical genomic scans for selective sweeps?</article-title> <source>Genome Research</source> <volume>16</volume>: <fpage>702</fpage>&#x2013;<lpage>712</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Tishkoff</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Reed</surname> <given-names>FA</given-names></string-name>, <string-name><surname>Ranciaro</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <year>2007</year>. <article-title>Convergent adaptation of human lactase persistence in Africa and Europe</article-title>. <source>Nature genetics</source> <volume>39</volume>: <fpage>31</fpage>&#x2013;<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Voight</surname> <given-names>BF</given-names></string-name>, <string-name><surname>Kudaravalli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wen</surname> <given-names>X</given-names></string-name> and <string-name><surname>Pritchard</surname> <given-names>JK</given-names></string-name>. <year>2006</year>. <article-title>A map of recent positive selection in the human genome</article-title>. <source>PLoS Biology</source> <volume>4</volume>: <fpage>e72</fpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Wakeley</surname> <given-names>J</given-names></string-name> and <string-name><surname>Aliacar</surname> <given-names>N.</given-names></string-name> <year>2001</year>. <article-title>Gene genealogies in a metapopulation</article-title>. <source>Genetics</source> <volume>159</volume>: <fpage>893</fpage>&#x2013;<lpage>905</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Watterson</surname> <given-names>G.</given-names></string-name> <year>1975</year>. <article-title>On the number of segregating sites in genetical models without recombination</article-title>. <source>Theoretical population biology</source> <volume>7</volume>: <fpage>256</fpage>&#x2013;<lpage>276</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Williamson</surname> <given-names>SH</given-names></string-name>, <string-name><surname>Hubisz</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Clark</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Payseur</surname> <given-names>BA</given-names></string-name>, <string-name><surname>Bustamante</surname> <given-names>CD</given-names></string-name> and <string-name><surname>Nielsen</surname> <given-names>R.</given-names></string-name> <year>2007</year>. <article-title>Localizing recent adaptive evolution in the human genome</article-title>. <source>PLoS genetics</source> <volume>3</volume>: <fpage>e90</fpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Wollstein</surname> <given-names>A</given-names></string-name> and <string-name><surname>Stephan</surname> <given-names>W.</given-names></string-name> <year>2015</year>. <article-title>Inferring positive selection in humans from genomic data</article-title>. <source>Investigative genetics</source> <volume>6</volume>: <fpage>5</fpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Figure S1:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a hard sweep and neutrally evolving regions.</title>
<p>A) For intermediate strengths of selection (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>)). B) For stronger selective sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>)). C) For weaker sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>)). Here, the methods that require training from simulated sweeps were trained from a set having the same distribution of selection coefficients as the test set.</p></caption>
<graphic xlink:href="024547_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Figure S2:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a sweep (either hard or soft) and neutrally evolving regions.</title>
<p>For intermediate strengths of selection (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>)). B) For stronger selective sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>)). C) For weaker sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>)).</p></caption>
<graphic xlink:href="024547_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Figure S3:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between hard and soft sweeps.</title>
<p>A) For intermediate strengths of selection (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>2</sup>, 2.5&#x00D7;10<sup>3</sup>)). For stronger selective sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>3</sup>, 2.5&#x00D7;10<sup>4</sup>)). C) For weaker sweeps (<italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>)).</p></caption>
<graphic xlink:href="024547_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Figure S4:</label>
<caption><title>Heatmaps showing the fraction of regions at varying distances from sweeps inferred to belong to each class by S/HIC, <italic>SFselect</italic>&#x002B;, and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>.</title>
<p>The location of any sweep relative to the classified window (or &#x201C;Neutral&#x201D; if there is no sweep) is shown on the <italic>y</italic>-axis, while the inferred class on the <italic>x</italic>-axis. Here, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(2.5&#x00D7;10<sup>1</sup>, 2.5&#x00D7;10<sup>2</sup>).</p></caption>
<graphic xlink:href="024547_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Figure S5:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a sweep (either hard or soft) and unselected regions (either neutral or linked to sweeps) when testing on non-equilibrium demography.</title>
<p>Here, the methods that require training from simulated sweeps were trained from the same demographic model used for testing. A) Testing on the African demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>4</sup>). B) The African demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>4</sup>, 5&#x00D7;10<sup>5</sup>). C) The European demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>5</sup>).</p></caption>
<graphic xlink:href="024547_figS5.tif"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Figure S6:</label>
<caption><title>ROC curves showing the true and false positive rates of various methods/statistics when tasked with discriminating between regions containing a sweep (either hard or soft) and unselected regions (either neutral or linked to sweeps) when training with equilibrium demography but testing on non-equilibrium demography.</title>
<p>Here, the methods that require training from simulated sweeps were trained from the same simulations with equilibrium demography as used for <xref ref-type="fig" rid="fig2">Figures 2</xref>-<xref ref-type="fig" rid="fig7">7</xref>. A) Testing on the African demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>4</sup>). B) The African demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>4</sup>, 2.5&#x00D7;10<sup>5</sup>). C)The European demographic model, with <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>5</sup>). Note that Tajima&#x2019;s <italic>D</italic> and Kim and Nielsen&#x2019;s <italic>&#x03C9;</italic> were omitted from this figure, as we simply used the values of these statistics to generate ROC curves without respect to any demographic model.</p></caption>
<graphic xlink:href="024547_figS6.tif"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Figure S7:</label>
<caption><title>Heatmaps showing the fraction of regions simulated under Tennessen et al.&#x2019;s African demographic model located at varying distances from sweeps inferred to belong to each class by S/HIC, <italic>SFselect</italic>&#x002B;, and Garud et al.&#x2019;s method using <italic>H</italic><sub>12</sub> and <italic>H</italic><sub>2</sub>/<italic>H</italic><sub>1</sub>.</title>
<p>The location of any sweep relative to the classified window (or &#x201C;Neutral&#x201D; if there is no sweep) is shown on the <italic>y</italic>-axis, while the inferred class on the <italic>x</italic>-axis. For panels A&#x2013;C, <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>3</sup>, 5&#x00D7;10<sup>4</sup>), and for D&#x2013;F <italic>&#x03B1;</italic>&#x223C;<italic>U</italic>(5&#x00D7;10<sup>4</sup>, 5&#x00D7;10<sup>5</sup>). These three classifiers were trained from simulations with equilibrium demography.</p></caption>
<graphic xlink:href="024547_figS7.tif"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Figure S8:</label>
<caption><title>Patterns of variation around the <italic>LCT</italic> locus in the CEU population.</title>
<p>Values of <italic>&#x03A0;</italic>, Tajima&#x2019;s <italic>D</italic>, Fay and Wu&#x2019;s <italic>H</italic>, Kelley&#x2019;s <italic>Z</italic><sub><italic>nS</italic></sub>, Kim and Nielsen&#x2019;s <italic>&#x03C9;</italic>, and Nielsen et al&#x2019;s composite likelihood ratio, all from <xref ref-type="bibr" rid="c45">Pybus et al. (2013)</xref>, are shown. Beneath these statistics we show the classifications from S/HIC (red: hard sweep; faded red: hard-linked; blue: soft sweep; faded blue: soft-linked; black: neutral). This image was generated using the UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu">http://genome.ucsc.edu</ext-link>).</p></caption>
<graphic xlink:href="024547_figS8.tif"/>
</fig>
</sec>
<sec>
<title>SUPPLEMENTAL TABLE LEGENDS</title>
<p>Table S1: Parameters used for simulating training and test datasets of large chromosomal regions.</p>
<p>Table S2: Predicted sweeps on chromosome 18 from the CEU sample from Phase I of the 1000 Genomes Project.</p>
</sec>
</back>
</article>
