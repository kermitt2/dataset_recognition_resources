<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/388116</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Tree Shape-based approaches for the Comparative study of Cophylogeny</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6796-2453</contrib-id>
<name>
<surname>Avino</surname>
<given-names>Mariano</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ng</surname>
<given-names>Garway T.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>He</surname>
<given-names>Yiying</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Renaud</surname>
<given-names>Mathias S.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jones</surname>
<given-names>Bradley R.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3779-154X</contrib-id>
<name>
<surname>Poon</surname>
<given-names>Art F. Y.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Pathology and Laboratory Medicine, Dental Sciences Building, Western University</institution>, London, ON N6A 5C1, <country>Canada</country></aff>
<aff id="a2"><label>2</label><institution>BC Centre for Excellence in HIV/AIDS</institution>, 608-1081 Burrard St, Vancouver, BC V6Z1Y6, <country>Canada</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Correspondence to be sent to: Department of Pathology and Laboratory Medicine, Dental Sciences Building, Western University, London, ON N6A 5C1, Canada &#x002B;15196917235, <email>mavino@uwo.ca</email></corresp>
</author-notes>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>388116</elocation-id>
<history>
<date date-type="received">
<day>09</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>09</day>
<month>8</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>09</day>
<month>8</month>
<year>2018</year>
</date>
</history>
<permissions><copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="388116.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Cophylogeny is the congruence of phylogenetic relationships between two different groups of organisms due to their long-term interaction, such as between host and pathogen species. Discordance between host and pathogen phylogenies may occur due to pathogen host-switch events, pathogen speciation within a host species, and extinction. Here, we investigated the use of tree shape distance measures to quantify the degree of cophylogeny for the comparative analysis of host-pathogen interactions across taxonomic groups.</p>
<p>We firstly implemented a coalescent model to simulate pathogen phylogenies within a fixed host tree, given the cospeciation probability, migration rate between hosts, and pathogen speciation rate within hosts.</p>
<p>Next, we used simulations from this model to evaluate 13 distance metrics between these trees and the host tree, including Robinson-Foulds distance and two kernel distances that we developed for labeled and unlabeled trees, which use branch lengths and can accommodate trees of different sizes. Finally, we used these distance metrics to revisit actual datasets from published cophylogenetic studies across all taxonomic groups, where authors described the observed associations as representing a high or low degree of cophylogeny.</p>
<p>Our simulation analyses demonstrated that some metrics are more informative than others with respect to specific coevolution parameters. For example, the Sim metric was the most responsive to variation in coalescence rates, whereas the unlabeled kernel metric was the most responsive to cospeciation probabilities. We also determined that distance metrics were more informative about the model parameters when the underlying parameter values did not assume extreme values, <italic>e.g.,</italic> rapid host switching. When applied to real datasets, projection of these trees&#x2019; associations into a parameter space defined by the 13 distance metrics revealed some clustering of studies reporting low concordance. This suggested that different investigators are describing concordance in a consistent way across biological systems, and that these expert subjective assessments can be at least partly quantified using distance metrics.</p>
<p>Our results support the hypothesis that tree distance measures can be useful for quantifying host and pathogen cophylogeny. This motivates the usage of distance metrics in the field of coevolution and supports the development of simulation-based methods, <italic>i.e.,</italic> approximate Bayesian computation, to estimate coevolutionary parameters from the discordant shapes of host and pathogen trees. [tree shape; cophylogeny; codivergence; coevolution; host switching; tree metrics; kernel]</p>
</abstract>
<counts>
<page-count count="37"/>
</counts>
</article-meta>
</front>
<body>
<p>Coevolution occurs when two or more species exert a reciprocal influence on one another&#x2019;s evolutionary trajectories (<xref ref-type="bibr" rid="c73">Vermeij 1994</xref>). These effects may be mediated by beneficial (mutualistic) or deleterious associations <italic>(e.g.,</italic> parasitism, predation). For simplicity, we will only refer to &#x2018;host&#x2019; and &#x2018;pathogen&#x2019; species, although we recognize that many other roles in coevolutionary interactions exist in nature. A cophylogenetic study is a comparative analysis of the evolutionary relationships within sets of host and pathogen species, and the extent that these relationships are correlated back in time. Host-pathogen associations are frequently visualized by a &#x2018;tanglegram&#x2019;, in which the associations are mapped to the two phylogenies by drawing association edges between the respective host and pathogen taxa (<xref ref-type="bibr" rid="c51">Page 1993</xref>). If the topologies of the two phylogenies are fully concordant, then there exists an arrangement of their branches (by rotation around ancestral nodes) such that the association edges do not intersect &#x2014; the trees are completely &#x2018;untangled&#x2019;. This situation implies that the interactions between the host and pathogen species are so strong that the diversification of the pathogen species is entirely constrained by that of their hosts. Discordant trees can also yield an untangled graph. Thus, the number of intersecting association edges is a more useful metric for optimizing visual layouts than for inferring biological processes.</p>
<p>Any single tanglegram may be explained by a large number of different combinations of events in the past, including pathogen extinction, host switching, incomplete lineage sorting (<xref ref-type="bibr" rid="c52">Pamilo and Nei 1988</xref>), pathogen speciation / duplication, and unobserved species; see <xref ref-type="bibr" rid="c7">Charleston and Perkins (2006)</xref> for a detailed discussion of these event types. Increasing numbers of events in the coevolutionary history of the host and pathogen species will tend to result in a lower degree of topological concordance between their phylogenies. Estimating the optimal reconstruction of such events to explain the present-day associations between the tip taxa of the host and pathogen phylogenies is known as reconciliation inference (<xref ref-type="bibr" rid="c16">Doyon et al. 2011</xref>). A well-characterized approach to reconciliation inference is to assign a cost to each type of event and to identify the most parsimonious (minimum cost) distribution of events. However, the resulting solution is sensitive to the investigator&#x2019;s choice of costs and becomes exceedingly difficult for larger trees &#x2014; indeed, this approach has formally been determined to be a computationally intractable (NP-complete) problem (<xref ref-type="bibr" rid="c50">Ovadia et al. 2011</xref>). On the other hand, it is not uncommon to display the tanglegram and make a qualitative, subjective assessment about the extent of cospeciation. We propose to develop methods that occupy the middle-ground between these extremes, using simple quantitative methods to estimate coevolutionary parameters.</p>
<p>There is an abundance of quantitative methods for comparing trees with respect to their topology and/or branch lengths. For example, numerous investigators have proposed various summary statistics that each extract certain characteristics of tree shapes, such as asymmetry (<italic>e.g.</italic>, Colless&#x2019; index) and thereby reduce the tree to a single number; for a comprehensive review, see <xref ref-type="bibr" rid="c46">Mooers (1997)</xref>. Summary statistics provide a convenient framework for comparing trees, which are otherwise statistically complex objects. However, many of these statistics are difficult to normalize to differences in tree size (<xref ref-type="bibr" rid="c70">Stam 2002</xref>), and can be strongly influenced by sampling for rapidly-evolving taxa (<xref ref-type="bibr" rid="c15">Dearlove and Frost 2015</xref>). In addition the inherent dimensionality reduction of these summary statistics is often accompanied by a critical loss of information about the underlying biological processes, which can limit the utility of any one statistic. For this reason, recent studies have begun to use feature selection methods to find optimal combinations of summary statistics (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c66">Saulnier et al. 2017</xref>).</p>
<p>Where a summary statistic maps a tree to a number, a distance metric maps two trees to a number that quantifies their level of discordance. One of the earliest distances for trees was the cophenetic correlation (<xref ref-type="bibr" rid="c69">Sokal and Rohlf 1962</xref>), in which the ancestral node heights for each pair of tips in the tree is represented by a distance matrix. The ordinary product-moment correlation for two trees is then calculated from the element-wise comparison of their respective matrices. A similar distance described by <xref ref-type="bibr" rid="c74">Williams and Clifford (1971)</xref> restricts this comparison to the internal nodes of the trees, and measures path lengths between tips by the number of nodes &#x2014; following <xref ref-type="bibr" rid="c39">Kuhner and Yamato (2014)</xref> we refer to this distance as &#x2018;Node&#x2019;. Other distances require the tip labels on the trees to match. For instance, the Maximum Agreement Subtree (MAST; <xref ref-type="bibr" rid="c21">Gordon 1980</xref>) distance is based on the largest labeled subtree that is common to both trees. The Robinson-Foulds distance (RF; <xref ref-type="bibr" rid="c63">Robinson and Foulds 1981</xref>) counts the minimum number of operations required to transform one tree topology to another, given that they relate the same set of taxa. It is by far the most popular and cited distance for comparing trees (<xref ref-type="table" rid="tbl1">Table 1</xref>). Subsequently, the RF distance has been extended to incorporate branch lengths (RFL and KF; <xref ref-type="bibr" rid="c62">Robinson and Foulds 1979</xref>; <xref ref-type="bibr" rid="c38">Kuhner and Felsenstein 1994</xref>). In addition, a very similar distance metric to RF that can accommodate unrooted trees and branch lengths was proposed by <xref ref-type="bibr" rid="c55">Penny et al. (1982)</xref>. A normalized version of this metric was later introduced by Geoghegan et al. (nPH85; 2017). <xref ref-type="bibr" rid="c11">Critchlow et al. (1996)</xref> described a distance (Trip) based on the number of shared subtrees relating triples of taxa, which was extended by (<xref ref-type="bibr" rid="c39">Kuhner and Yamato 2014</xref>) to utilize branch lengths (TripL), who also described a second metric (Int) that sums the differences in internode distances in the trees. More recently, <xref ref-type="bibr" rid="c27">Hein et al. (2004)</xref> proposed a distance (Sim) based on the probability that a random point in one tree is on a branch leading to the same set of tip labels in a second tree; and a distance (Align) described by <xref ref-type="bibr" rid="c49">Nye et al. (2005)</xref> counts the number of mismatches in the best one-to-one mapping of branches for two trees.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Summary of tree distance metrics examined in this study. In addition to the kernel metrics kU and kL, we evaluated two additional metrics where branch lengths were normalized by the mean (kUn and kLn). &#x2018;Diff. size&#x2019; indicates which distances do not require the trees to have the same numbers of tips. &#x2018;Diff. labels&#x2019; indicates which distances do not require the trees to relate the same taxa, <italic>i.e.,</italic> to have the same labels. &#x2018;Use lengths&#x2019; indicates which distances utilize the differences in branch lengths when comparing trees. We enumerated citations in the literature by querying Google Scholar (last access date, June 31, 2017) for papers associated with the respective distance metrics and software, and then filtered the results for coevolutionary studies (&#x2018;Coevol.&#x2019;).</p></caption>
<graphic xlink:href="388116_tbl1.tif"/>
</table-wrap>
<p>The majority of these distance metrics can be computed efficiently, and several utilize branch lengths in addition to tree topologies (<xref ref-type="table" rid="tbl1">Table 1</xref>). On the other hand, most of the distances require the trees to have the same numbers of tips and the same tip labels, <italic><italic>e.g.</italic>,</italic> relating the same taxa. In previous work, we proposed a new tree distance measure (<xref ref-type="bibr" rid="c57">Poon et al. 2013</xref>) based on a kernel function from computational linguistics (<xref ref-type="bibr" rid="c47">Moschitti 2006</xref>) that essentially counts the number of isomorphic fragments shared by two trees, while penalizing fragments for their discordance in branch lengths. The resulting distance measure is normalized for differences in tree sizes and can optionally ignore tip labels, such that it can be applied to trees relating different sets of taxa.</p>
<p>A distance metric may be difficult to interpret without some absolute scale or reference distribution. Thus, the discordance between host and pathogen trees can also be quantified by an independence test (<xref ref-type="bibr" rid="c14">De Vienne et al. 2013</xref>), which evaluates the probability that an equal or shorter distance is obtained by chance given a null distribution. Hence, this test essentially maps the distance metric to a more interpretable scale. The null distribution can be either generated at random from the simulation of trees given a parametric model, or by the non-parametric permutation of the host and pathogen trees. Finally, we note that this is not a comprehensive review of distance metrics on trees; we acknowledge more recent and ongoing advances in this area in the Discussion section.</p>
<p>Although such distance measures have been widely utilized in the comparison of trees in both evolutionary and broader contexts, there are surprisingly few references to these measures in the cophylogeny literature (<xref ref-type="table" rid="tbl1">Table 1</xref>). We propose that tree distance metrics may provide a useful alternative to the visual assessment of tanglegrams or reconciliation methods that require the investigator to make one or more subjective decisions. In this study, our objective is to assess how much information these distance measures can extract about coevolutionary events from the discordance of host and pathogen phylogenies. This however requires evaluating these distances on sets of trees where the underlying cophylogeny process is known with absolute certainty that reconciliation methods cannot provide. Thus, we developed a reverse-time simulation framework for generating pathogen trees along a fixed host tree, from the tips towards the root, for given rates of cospeciation, duplication and host switching. This work provides a critical quantitative assessment on the potential utility of distance metrics for cophylogenetic studies, and provides detailed guidance for choosing among those metrics given prior information on the relative importance of different coevolutionary events, or to focus on specific metrics are more informative than others about coevolutionary processes.</p>
<sec id="s1">
<title>Methods</title>
<sec id="s1a">
<title>Simulation methods</title>
<p>To simulate pathogen trees within host trees, we implemented a coalescent (reverse-time) simulation method with a custom Python script. The required inputs of this script are: (1) a Newick string representation of the host tree, with branches scaled in units of real time; (2) the coalescence rate of two pathogen lineages within the same host, &#x039B;; (3) the migration rate for pathogen lineages between hosts (host switching), <italic>M</italic>, and; (4) the probability of cospeciation, <italic>P</italic>. The coalescence of host species was a non-random event determined by the input tree. Stochastic events were simulated using the standard Gillespie method (<xref ref-type="bibr" rid="c20">Gillespie 1977</xref>). The total rate of stochastic events was:
<disp-formula>
<alternatives>
<graphic xlink:href="388116_ueqn1.gif"/>
</alternatives>
</disp-formula>
where <italic>n<sub>h</sub></italic>(<italic>t</italic>) is the number of extant host lineages at time <italic>t</italic>, <italic>n<sub>p</sub>(t</italic>) is the number of extant pathogen lineages, and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline1.gif"/></alternatives></inline-formula> is the number of extant pathogen lineages within the i-th host. The coalescence of pathogen lineages within a host is the reverse-time analog of a duplication event, <italic>i.e</italic>., the speciation of a pathogen lineage into two derived species within the same host lineage. We assumed that host switching was a random process that occurred at a constant and uniform rate for any single pathogen lineage. If there was only one extant host lineage at time <italic>t</italic>, then we assumed that the total host switching rate <italic>&#x03BB;<sub>M</sub></italic> was effectively zero.</p>
<p>The simulation was initialized at the most recent tips of the host tree (<italic>t</italic> &#x003D; 0), with a single pathogen lineage assigned to each sampled host. We did not require all host species to be sampled at the same time. The heights (relative to the most recent tip at <italic>t</italic> &#x003D; 0) of host species as determined by the input tree are denoted as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline2.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline3.gif"/></alternatives></inline-formula> is the total number of tips in the host tree. Moreover, the sampling times of host species determined by the input tree are denoted <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline4.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline5.gif"/></alternatives></inline-formula> for at least one value of j. The simulation was updated iteratively back in time with a random sequence of events on the time scale of the input tree. The waiting time until the next event was drawn from an exponential distribution, &#x0394;<italic>t</italic> &#x007E; exp(&#x03BB;). If the waiting time exceeded the time interval to the next highest host node <italic>&#x03C4;</italic>, then we updated the vector of extant host nodes and reset the simulation time. If the next highest host node was a tip, then we set <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline6.gif"/></alternatives></inline-formula> and incremented <italic>n<sub>p</sub></italic> (<italic>&#x03C4;<sub>j</sub></italic>) by one. Otherwise if the next highest host node was an internal node, then we set <italic>t</italic> &#x003D; <italic>&#x03C4;<sub>i</sub></italic>. All pathogen lineages carried by the affected host lineages were transferred to the ancestral host lineage, with a cospeciation probability <italic>P</italic> of two randomly selected lineages from the respective derived hosts being coalesced into a single ancestral lineage.</p>
<p>If the waiting time does not exceed the time interval to the next-highest host node <italic>&#x03C4;</italic>, then we determined whether the next event was a host-switch or a within-host coalescence of pathogen lineages. If a host-switch event occurred with probability <italic>&#x03BB;<sub>M</sub>/&#x03BB;</italic>, then we selected an extant pathogen lineage at random from n<sub>p</sub> and reassigned this lineage to an extant host drawn at random from <italic>n<sub>h</sub></italic> excluding the original host. We made the simplifying assumption that all host switching events were &#x2018;complete&#x2019;, in that migration to another host species was followed by extinction in the original host. A pathogen coalescence event otherwise occurred with probability <italic>&#x03BB;<sub>P</sub>/&#x03BB;</italic> (&#x003D; 1 &#x2013; <italic>&#x03BB;<sub>M</sub>/&#x03BB;</italic>), in which we selected a pair of lineages occupying the same host at random to coalesce into a single ancestral lineage. Thus, the specific migration and coalescence events were uniform across pathogen lineages and pairs of lineages, respectively. Subsequently, we incremented the simulation time t by the waiting time &#x0394;t and drew the next waiting time. The simulation halts when the number of extant hosts returns to one and all tips in the host tree have been sampled. If there are multiple pathogen lineages within this ancestral host, then the simulation proceeds back in time with coalescence at a constant rate per pair until only one pathogen lineage remains.</p>
<p>We used the Python library <italic>ete3</italic> (<xref ref-type="bibr" rid="c33">Huerta-Cepas et al. 2016</xref>) to parse and construct tree objects. For each simulation we generated two different pathogen tree outputs: a tree in which branches were partitioned by nodes of degree-size two to record all within-host coalescence and host-switch events <italic>(ete3</italic> format 1); and a second tree in which this information was removed, leaving only internal nodes with degree-size 3 and terminal nodes with degree-size 1 <italic>(ete3</italic> format 5). Terminal node labels were subsequently removed with R package <italic>phytools</italic> v0.6-00 (<xref ref-type="bibr" rid="c61">Revell 2012</xref>). The Python script (along with data, see below) is available at our GitHub repository <ext-link ext-link-type="uri" xlink:href="http://github.com/PoonLab/cophylo">http://github.com/PoonLab/cophylo</ext-link> and released to the public domain under the GNU General Public License (version 3).</p>
</sec>
<sec id="s1b">
<title>Simulation analysis</title>
<p>To initialize our simulation experiments, we selected a tree relating hosts of the Hepadnaviri-dae (HBV) family from a recent study of host-pathogen coevolution among RNA virus families (<xref ref-type="bibr" rid="c19">Geoghegan et al. 2017</xref>). The authors found that the trees corresponding to this virus family and its hosts had the highest level of concordance, based on their normalized version of the <xref ref-type="bibr" rid="c55">Penny et al. (1982)</xref> metric (nPH85). However, the host tree Newick file published by the authors did not include any branch lengths. Consequently we obtained the time-scaled phylogenetic tree relating Metazoa published at <ext-link ext-link-type="uri" xlink:href="http://timetree.org">http://timetree.org</ext-link>, and pruned the tree down to the host species associated with HBV, including fish, reptiles and amphibians (treated by the authors as one single host category), birds and mammals. Since a number of the distance metrics evaluated in this study required the host and pathogen trees to share the same set of tip labels, we labeled the simulated pathogen trees by their host, and initialized simulations with only one pathogen lineage per host tip.</p>
<p>Using this host tree, we conducted a series of &#x2018;edge case&#x2019; simulation experiments in which two of the parameters were fixed to extreme values, and the third parameter was varied over a broad range (<xref ref-type="table" rid="tblS1">Table S1</xref>). The purpose of these edge case simulations was to provide outputs that were easy to interpret for validating the simulation model, and as a preliminary assessment of how the various distance metrics responded to the model parameters. To visually inspect the simulation outputs, we plotted random samples of edge case simulations alongside the host tree with DensiTree v2.2.5 (<xref ref-type="bibr" rid="c6">Bouckaert 2010</xref>). Next, we used Latin hypercube sampling to randomly generate 500 points that were evenly distributed in the parameter space. Specifically, we partitioned the range &#x039B; &#x003D; [0,1] into 500 intervals such that their midpoints were evenly-spaced after a log-transformation; we applied the same scheme to the range <italic>M</italic> &#x003D; [0,1]. Since the parameter <italic>P</italic> is a probability instead of a range, we partitioned the range <italic>P</italic> &#x003D; [0,1] into 500 intervals without any transformation. Next, we generated a random permutation of intervals independently along each axis, uniformly sampled one point within each cube defined by the intersection of three intervals, and simulated 100 pathogen trees using those parameter values for a total of 50,000 simulations. Correlations and mutual information (MI) tests on the performance and collinearity of metrics were performed using the R package Entropy (<xref ref-type="bibr" rid="c25">Hausser and Strimmer 2009</xref>).</p>
</sec>
<sec id="s1c">
<title>Data collection</title>
<p>Finally, we evaluated the distance metrics on phylogenies reconstructed from actual data sets. First, we collected published data sets from the literature of host and pathogen coevolution. We queried Google Scholar (<ext-link ext-link-type="uri" xlink:href="https://scholar.google.ca/">https://scholar.google.ca/</ext-link>) on the title and abstract fields of publications with at least one of the following search terms &#x2018;concordance&#x2019;, &#x2018;cophylogeny&#x2019; (or &#x2018;co-phylogeny&#x2019;), &#x2018;host&#x2019;, &#x2018;pathogen&#x2019;, &#x2018;parasite&#x2019; and &#x2018;symbiont&#x2019;. Next, we manually reviewed, filtered and sorted the resulting article records into two categories (<xref ref-type="table" rid="tbl2">Table 2</xref>): (1) studies where the reported degree of cospeciation / codivergence, based on authors&#x2019; assessment, was moderate to high, and; (2) studies where the degree was low, with phylogenies considered too difficult to reconcile due to extensive host switching, duplication or extinction events. For each study, we obtained the sequence data using a batch query of the Genbank accession numbers. The resulting collection of 36 trees are summarized in <xref ref-type="table" rid="tbl2">Table 2</xref> and are referred herein as the &#x2018;General&#x2019; collection.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>Summary of cophylogeny studies and data sets collected from the literature (the &#x2018;General&#x2019; collection). The keys are used to map these entries to subsequent figures. <italic>N</italic> denotes the number of tips in the corresponding host or parasite tree.</p></caption>
<graphic xlink:href="388116_tbl2.tif"/>
</table-wrap>
<p>Second, we obtained all of the 19 host-virus data sets from <xref ref-type="bibr" rid="c19">Geoghegan et al. (2017)</xref>, which we refer to as the &#x2018;Viral&#x2019; collection. Because the host trees in <xref ref-type="bibr" rid="c19">Geoghegan et al. (2017)</xref> were not available with branch lengths, we reconstructed these lengths by extracting them from time-scaled trees published at <ext-link ext-link-type="uri" xlink:href="http://www.timetree.org">http://www.timetree.org</ext-link> (<xref ref-type="bibr" rid="c26">Hedges et al. 2006</xref>). We retrieved the Metazoa (n &#x003D; 1,456 tips) and Viridiplantae (n &#x003D; 373 tips) trees from this database at the taxonomic resolution of families. We mapped host species annotations from the virus phylogenies to these family-level trees using the NCBI BLAST taxonomy (<xref ref-type="bibr" rid="c67">Sayers et al. 2009</xref>). When more than one tip in a virus phylogeny mapped to the same host family, we collapsed those tips into a single terminal branch as in <xref ref-type="bibr" rid="c19">Geoghegan et al. (2017)</xref>. For consistency with the original study, we applied midpoint rooting to the pathogen trees; however, we also evaluated outgroup rooting and placement of the root to minimize the distance to the host tree, but we found no significant effect on our results.</p>
</sec>
<sec id="s1d">
<title>Data processing</title>
<p>Because sequence alignments were not available from the studies in the &#x2018;General&#x2019; collection, we reconstructed alignments of nucleotide or amino acid sequence data using MUSCLE (version 3.8.425, (<xref ref-type="bibr" rid="c18">Edgar 2004</xref>)) with the default settings. The resulting alignments were visually inspected and refined using AliView (<xref ref-type="bibr" rid="c41">Larsson 2014</xref>). We determined the optimal substitution model for each alignment using jModelTest 2.0 (<xref ref-type="bibr" rid="c13">Darriba et al. 2012</xref>) for nucleotide sequences and prottest3 (<xref ref-type="bibr" rid="c12">Darriba et al. 2011</xref>) for amino acid sequences, both of which employ the Akaike information criterion for model selection. Phylogenetic trees were reconstructed by maximum likelihood using PhyML 3.0 (<xref ref-type="bibr" rid="c22">Guindon and Gascuel 2003</xref>) and, for the &#x2018;General&#x2019; dataset, rooted on the branches determined by the respective studies. These trees were visually inspected in FigTree (<xref ref-type="bibr" rid="c59">Rambaut 2009</xref>) to verify that the result was consistent with the source publications.</p>
</sec>
<sec id="s1e">
<title>Distance metrics</title>
<p>We used the implementation of the Robinson-Foulds (RF) distance in the R library <italic>phangorn</italic> v2.4.0 (<xref ref-type="bibr" rid="c68">Schliep 2011</xref>) with default parameters. An extension of RF (RFL/KF) incorporates branch length information into the comparison of tree topologies. We used the function KF.dist in the R library <italic>phangorn</italic> v2.4.0 to calculate this extended metric under the default parameters. In addition, we used the function nPH85 in R library <italic>NELSI</italic> v0.2 (<xref ref-type="bibr" rid="c29">Ho et al. 2015</xref>) to calculate the related normalized Penny-Hendy metric. To calculate the metrics Align, Node, MAST, Trip and TripL in the same framework, we ported the respective implementations from the Python script published by Kuhner and Yamato (<xref ref-type="bibr" rid="c39">Kuhner and Yamato 2014</xref>) into a custom R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/PoonLab/Kaphi">https://github.com/PoonLab/Kaphi</ext-link>).</p>
<p>A kernel function computes the inner product between two objects that have been mapped to a high-dimensional feature space (<xref ref-type="bibr" rid="c1">Aizerman et al. 1964</xref>). It is a highly efficient method for comparing complex objects for which there is a potentially enormous number of features in each object, because the kernel restricts its calculation to the comparable tiny subset of features that occur in at least one of the two objects. A larger inner product indicates that the objects share a greater number of features; hence, the kernel can be used as a measure of similarity. <xref ref-type="bibr" rid="c57">Poon et al. (2013)</xref> previously adapted a kernel function that operates on tree-like objects in natural language processing (<xref ref-type="bibr" rid="c10">Collins and Duffy 2002</xref>) to compare phylogenetic trees. The features counted by this kernel are subset trees. A subset tree is a fragment of a tree that is rooted at an ancestral node and extends down towards its descendants. It does not necessarily extend all the way to the tips of the tree &#x2013; if it does, however, then it is referred to as a &#x2018;subtree&#x2019; (<xref ref-type="bibr" rid="c47">Moschitti 2006</xref>). The tree shape kernel, essentially counts the number of times that subset trees with the same topology appear in both phylogenies, and then penalizes this number by the discordance in branch lengths (<xref ref-type="bibr" rid="c57">Poon et al. 2013</xref>). This kernel does not utilize tip labels, so we refer to it here as the unlabeled kernel distance (kU).</p>
<p>Furthermore, we extended the kernel method to compare subset trees on the basis of shared tip labels. We modified the recursive function used to calculate the kernel score, by substituting an indicator function <bold>1</bold><sub><italic>n</italic><sub>1</sub>,<italic>n</italic><sub>2</sub></sub> in place of the constant 1 when the two nodes being compared are both tips (<xref ref-type="bibr" rid="c10">Collins and Duffy 2002</xref>; <xref ref-type="bibr" rid="c57">Poon et al. 2013</xref>). The function <bold>1</bold><sub><italic>n</italic><sub>1</sub>,<italic>n</italic><sub>2</sub></sub> assumes the value 1 if <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> have the same labels, and otherwise returns 0. We refer to the resulting distance as the labeled kernel (kL). To generate kernel similarity matrices for the &#x2018;General&#x2019; and &#x2018;Viral&#x2019; data sets in this study, we first imported the Newick tree strings using the BioPython <italic>phylo</italic> module (<xref ref-type="bibr" rid="c71">Talevich et al. 2012</xref>). Branch lengths might subsequently be normalized by the mean branch length in each phylogeny to facilitate the comparison between host and pathogen trees with different overall rates of evolution (indicated by &#x2018;n&#x2019; suffix for unlabeled and labeled kernels, or kUn and kLn). The kernel scores were also normalized, using the cosine method, to adjust for differences in the overall size (number of nodes) of the respective trees (<xref ref-type="bibr" rid="c10">Collins and Duffy 2002</xref>). Kernel principal components analysis and projections for the resulting matrices were generated using the <italic>kernlab</italic> package in R (<xref ref-type="bibr" rid="c75">Zeileis et al. 2004</xref>).</p>
<p>The behavior of the kernel function is controlled by several parameters. First, the branch length penalty is determined by a Gaussian radial basis function centered at zero with variance parameter &#x03C3;, where a smaller &#x03C3; results in a more severe penalty for subset trees with different branch lengths. Second, the kernel function includes a decay parameter &#x03BB; that penalizes matching subset trees that are too large, which is useful to avoid the &#x2018;large diagonal problem&#x2019; (<xref ref-type="bibr" rid="c10">Collins and Duffy 2002</xref>). Third, <xref ref-type="bibr" rid="c47">Moschitti (2006)</xref> introduced a parameter &#x03C3; to control for subset tree matching, which we renamed s to avoid confusion with the Gaussian parameter. If <italic>s</italic> &#x003D; 0, then matched subset trees must extend to the tips (subtrees) to be counted by the kernel. Since our trees have labels only on the tips, we fixed <italic>s</italic> &#x003D; 0 for kL or kLn. Otherwise, the effect of labels was overwhelmed by subset tree shapes. Thus, with s &#x003D; 1, the subset trees do not have to include all tips (kU or kUn). This parameter has especially significant importance for comparisons of labeled trees, because trees with congruent shapes and different sets of labels on their tips may be scored as highly similar when s &#x003D; 1, and completely dissimilar when s &#x003D; 0. Based on previous work (<xref ref-type="bibr" rid="c57">Poon et al. 2013</xref>), to evaluate the effect of these tuning parameters on the kernel function&#x2019;s sensitivity and specificity for simulated data, we initiated our analyses with the default unlabeled kernel settings &#x03BB; &#x003D; 0.2, <italic>&#x03C3; &#x003D;</italic> 2 and s &#x003D; 1. For &#x2018;General&#x2019; and &#x2018;Viral collection&#x2019; experiments, we also evaluated other combinations of the tuning parameters at the following values: &#x03BB; &#x003D; &#x007B;0.1,0.3&#x007D;, &#x03C3; &#x003D; &#x007B;0.5,1,5,10,50,100&#x007D;, and <italic>s</italic> &#x003D; &#x007B;0.5&#x007D;.</p>
</sec>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Edge case simulations</title>
<p>We implemented a backward-time (coalescent) model to simulates pathogen trees, given a fixed host tree and coevolutionary parameters: the within-host coalescence (lineage duplication) rate, &#x039B;; migration rate, <italic>M</italic>; and cospeciation probability, <italic>P</italic>. To examine the response of different distance metrics (<xref ref-type="table" rid="tbl1">Table 1</xref>) to variation in these coevolutionary parameters, we initially adjusted each parameter individually while holding the others constant (Supplementary Material <xref ref-type="table" rid="tblS1">Table S1</xref>). The purpose of these edge case simulation experiments was to verify the expected effect of each model parameter under extreme conditions where their expected influence on pathogen tree shape was unambiguous. We also used these experiments to establish the potential for various distance measures to extract information about cospeciation processes by comparing the shapes of host and pathogen trees. To examine how pathogen tree shapes responded to changes in each model parameters, we plotted pathogen and host trees together for a small number of parameter values per edge case scenario (<xref ref-type="fig" rid="fig1">Fig. 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Effect of varying model parameters on simulated pathogen trees under edge cases scenarios. The host phylogeny is displayed with broad gray branches. (left) Decreasing coalescence rates &#x039B; &#x003D; &#x007B;1,0.04,0.001&#x007D; for green, yellow and red, respectively; <italic>P</italic> &#x003D; 0, <italic>M</italic> &#x003D; 0) results in a greater frequency of deep coalescent events. (centre) Increasing migration rates <italic>M</italic> &#x003D; &#x007B;0.00055,0.004375,1&#x007D; for green, yellow and red, respectively; &#x039B; &#x003D; 1, <italic>P</italic> &#x003D; 1) results in a greater frequency of host switching events. (right) Decreasing cospeciation rates <italic>P</italic> &#x003D; &#x007B;1,0.50,0.25&#x007D; for green, yellow and red, respectively; &#x039B; &#x003D; 10<sup>&#x2212;6</sup>, <italic>M</italic> &#x003D; 0) results in a greater frequency of deep coalescent events.</p></caption>
<graphic xlink:href="388116_fig1.tif"/>
</fig>
<p>Under the &#x2018;coalescent only&#x2019; scenario, we varied the coalescence rate &#x039B; while fixing the migration rate <italic>M</italic> to 10<sup>-6</sup> and cospeciation probability <italic>P</italic> to 0. Decreasing &#x039B; led to a greater chance of duplication events where multiple pathogen lineages co-exist in an ancestral host species (<xref ref-type="fig" rid="fig1">Fig. 1</xref>, left panel). Conversely, high values of &#x039B; resulted in high concordance between pathogen and host trees. In the &#x2018;migration only&#x2019; scenario, we varied <italic>M</italic> and fixed <italic>P</italic> to 0 and &#x039B; to 1, the highest rate that we evaluated in this study. Increasing <italic>M</italic> resulted in greater discordance in shape between the host and pathogen trees as pathogen lineages switched into other hosts and immediately coalesced with the extant pathogen species, which also compressed the time-scale of the pathogen tree (<xref ref-type="fig" rid="fig1">Fig. 1</xref>, central panel). Finally, we varied P in the &#x2018;cospeciation only&#x2019; scenario with <italic>M</italic> set to 0 and &#x039B; set to 10<sup>&#x2014;6</sup>. Setting &#x039B; to the lowest value exaggerated the effect of reducing <italic>P</italic>, since any pathogen lineages that did not cospeciate with the host became free to coalesce on a much longer time scale (<xref ref-type="fig" rid="fig1">Fig. 1</xref>, right panel).</p>
<p>Next, we evaluated the response of the various distance metrics to individually varying the parameters within each of these three scenarios (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). We observed substantial variation among the different tree distance measures (each scaled to their respective empirical range) in response to the within-host coalescence rate, &#x039B; (<xref ref-type="fig" rid="fig2">Fig. 2</xref>, left panel), migration rate (<xref ref-type="fig" rid="fig2">Fig. 2</xref>, central panel) and cospeciation rate (<xref ref-type="fig" rid="fig2">Fig. 2</xref>, right panel). We characterized this variation by the approximate &#x039B;, <italic>M</italic> and <italic>P</italic> values where the trends crossed a scaled distance of 0.5 (&#x039B;<sub>50</sub>, <italic>M</italic><sub>50</sub>, <italic>P</italic><sub>50</sub>, respectively). For the majority of distance measures (RF, nPH85, MAST, Align, Node, kLn, kUn), the &#x039B;<sub>50</sub> was about 0.02/pair/Ma. The unnormalized kernel measures kU and kL were more responsive at higher coalescence rates (&#x039B;<sub>50</sub> &#x2248; 0.4). Trip and Sim were responsive to lower rates (&#x039B;<sub>50</sub> &#x2248; 0.003) and TripL and KF changed only when &#x039B; was very low (&#x039B;<sub>50</sub> &#x2248; 3.5 &#x00D7; 10<sup>-6</sup>). Most of the distances displayed an approximately monotonic relationship with &#x039B; except for Node and Align, which both increased in distance as &#x039B; approached 1. Node, Align and KF were more responsive to slightly lower rates of migration (<italic>M</italic><sub>50</sub> &#x003D; 10<sup>-4</sup>) than the other distances. All the distance metrics displayed a monotonic relationship with <italic>M</italic>, with the exception of TripL, Align, Node and KF, which switched around <italic>M</italic>&#x003D;0.01/lineage/Ma. Finally, all metrics were more responsive to higher values of <italic>P</italic> (0.8 &#x2014; 1.0) but with more variation in their response to this parameter than <italic>M</italic>. For example, Sim, Node and kUn sharply declined as <italic>P</italic> approached 1, whereas the other metrics displayed a more gradual decline with <italic>P</italic>. kL was the only metric that displayed a roughly linear decrease of scaled distance with <italic>P</italic>.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Summary of associations between tree distance measures and model parameters. Each point represents the mean distance measure (text label) for 100 replicate simulations, rescaled to range from 0 to 1 to facilitate comparisons between different measures.</p></caption>
<graphic xlink:href="388116_fig2.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Simulation - hypercube sampling</title>
<p>For 500 different points sampled evenly from the parameter space defined by &#x039B;, <italic>M</italic> and <italic>P</italic>, we used the nested coalescent model to simulate 100 pathogen trees on the phylogeny relating hosts of viruses in the HBV family, for a total of 50,000 simulations. Next, we computed the distance measures in <xref ref-type="table" rid="tbl1">Table 1</xref> for every simulated tree to the &#x2018;observed&#x2019; host tree, and averaged the distances for each of the 500 parameter settings.</p>
<p><xref ref-type="fig" rid="fig3">Figure 3</xref> summarizes the nonparametric (Spearman&#x2019;s rank-order) correlation tests for all pairs of distance measures. We observed strong correlations (<italic>&#x03C1;</italic> &#x003E; 0.95) among the distances kLn, RF, Trip, nPH85 and MAST. In particular, we found very high correlations between KF and TripL (<italic>&#x03C1;</italic> &#x003D; 1), Align and Node (<italic>&#x03C1;</italic> &#x003D; 0.94), and the two unnormalized kernels kU and kL, (<italic>&#x03C1;</italic> &#x003D; 0.94). Interestingly, Trip and Sim, which had the same response in edge case experiments for &#x039B; and <italic>M</italic>, did not have a strong positive correlation (<italic>&#x03C1;</italic> &#x003D; 0.62).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Summary of correlation matrix of tree distance measures. Spearman&#x2019;s rank correlations were calculated for 10,000 trees simulated under varying model parameter settings, wider and blue-darker is the bubble, higher is the correlation.</p></caption>
<graphic xlink:href="388116_fig3.tif"/>
</fig>
<p>We used the mutual information (MI) to quantify the information content of each metric with respect to the three model parameters. Based on our preliminary results with the edge case scenarios, we calculated a second set of MI values where the parameter space was constrained to <italic>P</italic> &#x003E; 0.8 for <italic>M</italic> and &#x039B;; and by <italic>M</italic> &#x003C; 10 <sup>4</sup>/lineage/Ma for &#x039B; and <italic>P</italic> (<xref ref-type="fig" rid="fig4">Fig. 4</xref>). Overall, Sim was the most informative metric for &#x039B;, while kU and kL were the most informative for P. Several metrics obtained similar levels of MI for M, including kL, RF and nPH85.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Barplots summarizing the mutual information of distance measures on the cophylogeny model parameters. The mutual information I was calculated by discretizing each distance <italic>d</italic> and model parameter <italic>&#x03B8;</italic> into 10 bins respectively, for a total of 100 bins in the joint distribution <italic>p</italic>(<italic>d</italic>, <italic>&#x03B8;</italic>), and then computing the sum <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="388116_inline7.gif"/></alternatives></inline-formula>. If <italic>I</italic> &#x003D; 0, then <italic>d</italic> is independent of <italic>&#x03B8;</italic>. Two values of <italic>I</italic> were computed for each distance. The left values were computed from the entire parameter space, whereas the right values were constrained as follows: (&#x039B;) low coalescence, <italic>M</italic> &#x003C; 10<sup>-4</sup>; (<italic>M</italic>) high cospeciation <italic>P</italic> &#x003E; 0.8, and; (<italic>P</italic>) low migration, <italic>M</italic> &#x003C; 10 <sup>-4</sup>.</p></caption>
<graphic xlink:href="388116_fig4.tif"/>
</fig>
<p>To examine the response of kU to variation in <italic>P</italic> and <italic>M</italic> more closely, we generated contour plots for this metric and the popular RF distance for comparison (<xref ref-type="fig" rid="fig5">Fig. 5</xref>). These plots clearly illustrate that the information content of either metric on P is dependent on the migration rate, and decays as M becomes too high. We note that unlike <xref ref-type="fig" rid="fig1">Figure 1</xref>, where the coalescence rate was fixed, these contour plots mask extensive variation in &#x039B; among simulations. Similarly, <xref ref-type="fig" rid="fig6">Figure 6</xref> illustrates the response of the metrics Sim and kUn to variation in &#x039B; and <italic>M</italic>. Again the information content of either metric on &#x039B; decays when <italic>M</italic> becomes too high; this effect is more conspicuous for Sim.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Contour plots summarizing the response of the unlabeled kernel (kU) and Robinson-Foulds distance (RF) to variation in cospeciation probability (<italic>P</italic>) and migration rate (<italic>M</italic>). Each point represents the average of 100 replicate simulations for a given parameterization of the cophylogeny model. The area and colouring of points is proportional to the distance metric.</p></caption>
<graphic xlink:href="388116_fig5.tif"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Contour plots summarizing the response of the Sim distance and normalized unlabeled kernel (kUn) to variation in coalescence (&#x039B;) and migration (M) rates. Each point represents the average of 100 replicate simulations for a given parameterization of the cophylogeny model. The area and colouring of points is proportional to the distance metric.</title></caption>
<graphic xlink:href="388116_fig6.tif"/>
</fig>
</sec>
<sec id="s2c">
<title>Application to real data sets</title>
<p>Our simulation experiments reveal that the different distance measures respond differently to variation in coalescence, migration and cospeciation rates. Furthermore, none of the distance measures is independently capable of conveying substantial information about all three cospeciation parameters. Although the simulated data provide a &#x2018;ground truth&#x2019; to these parameters, the underlying model relies on unrealistic assumptions (see Discussion section) that limit the biological realism of these data. To assess the response of these distance measures to phylogenies reconstructed from actual data, we collected published trees or sequences for matched sets of host and pathogen species from the literature. We searched the literature for studies of host-pathogen cospe-ciation where the system was qualitatively described as having high or low levels of phylogenetic concordance due to cospeciation (the &#x2018;General&#x2019; collection, <xref ref-type="table" rid="tbl2">Table 2</xref>). We used these descriptions to partition the &#x2018;General&#x2019; collection into two categories.</p>
<p>This transition from simulated to actual data highlighted significant obstacles in the use of distance measures to cophylogeny studies. First, the metrics often require the trees to be the same size, <italic>i.e.</italic>, to have equal numbers of tips (<xref ref-type="table" rid="tbl1">Table 1</xref>). Distance metrics that utilize labels, such as the RF distance, also require that the trees have the same labels, <italic>e.g.</italic>, that the trees are alternative models for relating the same taxa. When simulating the data sets, it was trivial to generate pathogen trees that matched the labels of the host tree by initializing a single pathogen lineage in each host species. The biological reality of host-pathogen associations is frequently more complex, however. A pathogen species may be found in more than one host species, and a host species may be associated with multiple pathogen species. These cases may be accommodated by grafting additional branches with zero lengths to tips with multiple associations, to enforce a one-to-one map between the host and pathogen phylogenies (<xref ref-type="bibr" rid="c19">Geoghegan et al. 2017</xref>). Similarly, we grafted zero-length branches to equalize the numbers and labels of tips in each pair of trees in the &#x2018;General&#x2019; data collection, and then calculated tree distance measures for each pair. When examining each distance measure individually, we did not observe any clear separation between high and low codivergence tree sets in the &#x2018;General&#x2019; collection (Supplementary Material <xref ref-type="fig" rid="figS1">Fig. S1</xref>). This is consistent with findings from our simulation analysis that the distance measures vary substantially in their response to different cospeciation parameters. We next used a principal components analysis to examine the joint distribution of the general collection as a biplot (<xref ref-type="fig" rid="fig7">Fig. 7</xref>). This plot illustrates a rough separation between cases of high and low codivergence, with the exception of one low outlier (31-32) and a cluster of high outliers (1-2, 9-10, 21-22). Since the tree pair 31-32 has the fewest tips of any case (<italic>n</italic> &#x003D; 5 for both hosts and parasites, <xref ref-type="table" rid="tbl2">Table 2</xref>), its placement in the biplot may simply be due to sampling variation. The low loadings on TripL and KF in the biplot are consistent with their low mutual information with respect to any cospeciation parameters in our simulations (<xref ref-type="fig" rid="fig4">Fig. 4</xref>). Similarly, the variable loadings on the first component of the biplot &#x2014; combined with our simulation results &#x2014; suggest that the characterization of phylogenetic concordance in these studies is strongly influenced by host switching (migration) events.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Biplot of a principal components analysis on distance measures for the general dataset. Each label represents a pair of host and pathogen trees that were characterized in the respective sources as cases of high (red) or low (blue) codivergence (see also <xref ref-type="table" rid="tbl2">Table 2</xref>). The gray vectors represent the variable loadings for the respective distance measures.</p></caption>
<graphic xlink:href="388116_fig7.tif"/>
</fig>
<p>One of the unique features of the kernel methods compared to the other distance measures in this study is that they can be applied to unlabeled trees. This enables us to not only compute a distance between a pair of host and pathogen trees, but we can also compute distances between a host tree and pathogen trees from other pairings. In other words, it is not possible to compute the RF distance between the trees relating crinoids (sea lilies, <xref ref-type="bibr" rid="c40">Lanterbecq et al. (2010)</xref>, from couple 2122) and the gut bacteria of termites (<xref ref-type="bibr" rid="c48">Noda et al. (2007)</xref>, from couple 37-38) even though these trees are the same size. We can therefore embed all the trees into a common feature space defined by a given kernel (Supplementary Material <xref ref-type="fig" rid="figS2">Fig. S2</xref>). We exploited this characteristic to test whether pairs of trees in the general collection were significantly closer together in this feature space than expected by chance with a randomization test. We drew 18 random pairings of host and pathogen trees from the &#x2018;General&#x2019; collection, calculated the mean unlabeled kernel score (kU), and repeated this procedure to obtain 1,000 replicate means to approximate a null distribution. The mean kernel score for the actual tree pairs (<italic>E</italic>(<italic>kU</italic>) &#x003D; 0.90) was located in the 99.9 percentile of this distribution, indicating that the actual pairs were significantly closer in the kU-defined space than expected by chance (<italic>p</italic> &#x003D; 2.0 &#x00D7; 10<sup>-4</sup>).</p>
<p>Finally, we examined a second collection, the &#x2018;Viral&#x2019;, of host and pathogen trees corresponding to 19 different virus families from a previous study (<xref ref-type="bibr" rid="c19">Geoghegan et al. 2017</xref>). Since the host trees were derived from a common time tree, we generalized the host tip labels to the family taxonomic level, making it feasible to compare non-associated trees with both unlabeled and labeled kernels. In addition, branch lengths in the host trees were scaled in time to millions of years, whereas the pathogen trees were scaled to evolutionary time (expected numbers of nucleotide substitutions). This difference made it necessary to renormalize branch lengths in both host and pathogen trees (dividing by mean branch length) for kernel-mediated comparison (kUn and kLn). Supplementary Material <xref ref-type="fig" rid="figS3">Figure S3</xref> comprises two PCA plots from the analysis of the similarity matrices using the unlabeled (kUn) and labeled (kLn) kernel functions, respectively. Again, we ran randomization tests for this collection using either kUn and kLn. When we ignored labels in comparing tree shapes, the mean kernel score for the actual tree pairs was <italic>E</italic>(kUn) &#x003D; 0.78 and located in the 33.1 percentile (<italic>p</italic> &#x003D; 0.67) of a randomized null distribution, indicating that the actual pairs were not significantly closer in the kUn-defined space than expected by chance. We obtained substantially different results with a labeled kernel: the mean score (E(kLn) &#x003D; 0.19) was located at the 99.9 percentile of the randomized distribution (<italic>p</italic> &#x003D; 7.0 &#x00D7; 10<sup>-4</sup>), indicating that the actual pairs were significantly closer in this feature space than expected by chance. <xref ref-type="bibr" rid="c19">Geoghegan et al. (2017)</xref> previously reported that the phylogenies of DNA viruses and their hosts tended to be more concordant than RNA viruses, which was attributed to their relatively higher rates of cospeciation and lower rates of migration. Here we observed the same trend for families of DNA viruses, especially Hep-adnaviridae, Poxviridae and Papillomaviridae. However, we also observed significant clustering for the RNA virus families Orthomyxoviridae and Potyviridae. In the latter case, clustering was most likely driven by the unique distribution of these viruses in plant host species. Using non-parametric Wilcoxon tests, we found no significant difference in kUn distances separating DNA or RNA virus trees from their respective host trees (<italic>p</italic> &#x003D; 0.17), but significantly greater labeled (kLn) distances for RNA viruses (<italic>p</italic> &#x003D; 0.02).</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>There is a deep literature on developing distance measures for the comparison of phylogenetic trees in order to quantify biological processes such as speciation (<xref ref-type="bibr" rid="c46">Mooers 1997</xref>; <xref ref-type="bibr" rid="c39">Kuhner and Yamato 2014</xref>). Multiple quantitative frameworks for the comparison of phylogenetic trees have also been developed for the study of cophylogeny, to determine whether the two sets of organisms share a coevolutionary history (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c31">Huelsenbeck et al. 2000</xref>; <xref ref-type="bibr" rid="c16">Doyon et al. 2011</xref>). We therefore anticipated extensive applications of tree distances in the literature for analyzing cophylogeny or coevolution. However, our survey on papers citing the tree distance metrics found only four studies that have made use of metrics for coevolutionary studies (0.001&#x0025; of all studies reviewed, <xref ref-type="table" rid="tbl1">Table 1</xref>), which is a surprising outcome given the similar objectives of the respective fields. Instead, the comparison of trees in coevolutionary studies had frequently relied on other methods where a tanglegram is either assessed qualitatively by the investigator, or analyzed with a reconciliation method, which is computationally complex and requires a subjective assignment of cost functions to the respective coevolutionary events (<italic>e.g.</italic>, cospeciation, host switching and extinction). The objective of our study was to assess the potential utility of distance metrics for cophylogenetic studies.</p>
<p>In this study, we did not attempt to evaluate a comprehensive set of all available distance metrics. Instead we have focused on a subset of metrics from a recent review by Kuhner and Yamato (<xref ref-type="bibr" rid="c39">Kuhner and Yamato 2014</xref>), augmented with a small number of additional metrics including the kernel metrics. In addition to the metrics in our study, there is a large number of distance metrics that can be constructed from summary statistics such as Sackin&#x2019;s index (<xref ref-type="bibr" rid="c5">Blum and Fran&#x00E7;ois 2005</xref>). A summary statistic reduces a tree down to a single number that quantifies a biologically significant aspect of tree shape such as asymmetry (<xref ref-type="bibr" rid="c46">Mooers 1997</xref>). Thus, we can obtain a distance from a summary statistic by taking its difference between the host and pathogen trees. However these summary statistics usually do not incorporate tip labels, placing greater emphasis on similarity in tree shapes, and they can be difficult to normalize for comparing pairs of trees with different sizes (<xref ref-type="bibr" rid="c56">Pompei et al. 2012</xref>). In addition, there are several spectral methods that can be applied to trees by interpreting these objects as graphs (<xref ref-type="bibr" rid="c28">Hendy and Penny 1993</xref>) and the further development of tree distances continues to be an active area of research (<xref ref-type="bibr" rid="c36">Kendall and Colijn 2016</xref>; <xref ref-type="bibr" rid="c9">Colijn and Plazzotta 2017</xref>). It is therefore not feasible to evaluate all possible distances and for our purposes, we have only evaluated a representative subset of distance measures, including commonly used measures such as the RF distance.</p>
<p>Simulation experiments are an essential step to evaluate the response of a metric to variation in the data because the underlying parameters are known without ambiguity. However the inherent assumptions of the simulation model may limit our ability to extrapolate from that analysis to real applications. In this study, we have taken the unusual approach of simulating the pathogen trees backwards in time along a fixed host tree. Our motivation for this approach is that it is more efficient to start from &#x2018;sampled&#x2019; lineages and converge back in time to their common ancestors, then to simulate forward from a single ancestor and discard cases that are not compatible with the expected endpoints. For example, a forward-time simulation may simply go extinct before any lineages can become sampled. This approach makes it difficult to incorporate unobserved extinction events, although inferring these events is already difficult due to the sensitivity of extinction rate estimates to model misspecification (<xref ref-type="bibr" rid="c58">Rabosky 2010</xref>). In addition, we made a simplifying assumption that a single pathogen lineage was sampled per host. Although it is straight-forward to model the sampling of multiple pathogen lineages in a host species within our reverse-time framework, we sought to minimize the complexity of the parameter space to evaluate in our simulation experiments. Similarly, we assumed complete sampling of all extant pathogen lineages.</p>
<p>Our simulation analyses of tree distance metrics demonstrated that some metrics were more informative than others with respect to specific cospeciation parameters. For example, the Sim metric (<xref ref-type="bibr" rid="c27">Hein et al. 2004</xref>) was the most responsive to variation in coalescence rates, and the un labeled kernel (kU) to variation in cospeciation probabilities. The metrics evaluated in this study were frequently correlated with each other, but the correlations are seldom so extreme that the metrics were essentially redundant, <italic>e.g.</italic>, the RF and nPH85 distances. We also determined that distance metrics were more informative about the model parameters when the underlying parameter values were not so extreme that the host tree has essentially no influence on the shape of the pathogen tree; i.e., when the migration (host switching) rate was not too high, or when the cospe-ciation probability was substantially less than one and the pathogen coalescence rate was near zero (<xref ref-type="fig" rid="fig1">Fig. 1</xref>). These scenarios would make it difficult to meaningfully quantify cophylogeny by any method. If the host switching rate is exceedingly high, then the pathogen species are &#x2018;cosmopolitan&#x2019; and freely utilize whichever host species they encounter, which would negate any influence of cophylogenetic effects on the pathogen phylogeny. In the second scenario, the pathogen speciation rate is so low that pathogen lineages speciate on a much longer time scale than their hosts, making the distribution of coalescent events independent of the host phylogeny. This scenario may arise when pathogen gene flow is unrestricted among host species (<xref ref-type="bibr" rid="c35">Johnson et al. 2003</xref>).</p>
<p>Next, we applied these metrics to two collections of phylogenies that were reconstructed from actual biological data. In the &#x2018;General&#x2019; collection of coevolutionary studies across all taxonomic groups, we retrieved a total of 18 studies &#x2014; including parasitic and symbiotic associations &#x2014; where authors described the trees as having a high or low degree of concordance. Only 6 of these studies reported low concordance. These assignments were largely based on a subjective qualitative assessment of phylogenetic concordance, and there are no quantitative criteria that have been applied generally across taxa. Given the broad diversity of taxonomic groups being studied, it is unlikely that any one of the coevolutionary processes is consistently determining either outcome. It is also not feasible to determine with complete certainty how each process contributed to the varying levels of concordance across these empirical studies. Nevertheless, the projection of these trees into a parameter space defined by the 13 distance metrics revealed some clustering of studies reporting low concordance. This suggests that different investigators are describing concordance in a consistent way across biological systems, and that these subjective assessments can be at least partly quantified using distance metrics. In <xref ref-type="fig" rid="fig7">Figure 7</xref>, we observed a small cluster of studies, where the authors reported high concordance between host and pathogen trees (1-2, 9-10 and 21-22), that did not associate with the main grouping of &#x2018;high concordance&#x2019; studies. We found that these studies may have placed greater emphasis on a relative lack of crossed association edges in the tanglegrams that implies a low rate of host switching. However, the topologies of the trees in the respective studies are markedly dissimilar in shape, such that we believe these studies should instead be classified as examples of low concordance. Our analysis suggests that this discordance in these cases may be driven by a lower probability of cospeciation, based on our assessment of the tanglegrams in the respective publications, the alignment of this cluster with the kU vector, and our simulation results.</p>
<p>Reconciliation methods implicitly assume that the pathogen phylogeny is the outcome of a stochastic process that has unfolded along the host phylogeny, shaped by events such as cospeciation or migration that have occurred at different rates. The distance-based approach that we have evaluated in this paper is analogous to fitting a non-parametric model to the shape of the pathogen phylogeny, conditional on the host phylogeny &#x2014; none of these processes is explicitly modeled by any of the distances evaluated in this study. Although many methods employ maximum parsimony to infer these events, the problem of reconciliation lends itself to probabilistic inference through maximum likelihood (<xref ref-type="bibr" rid="c32">Huelsenbeck et al. 1997</xref>) and Bayesian (<xref ref-type="bibr" rid="c31">Huelsenbeck et al. 2000</xref>) frameworks, which have already been developed for restricted scenarios, <italic>e.g.</italic>, no speciation within hosts (<xref ref-type="bibr" rid="c53">Paterson and Banks 2001</xref>). The ideal Bayesian approach would be to jointly sample the host and pathogen phylogenies and reconstructions of coevolutionary events given the sequence and associational data &#x2014; however, the enormous model space this would entail would likely limit this approach to small data sets. There is growing interest across disciplines in using simulation-based methods, <italic>e.g.</italic>, approximate Bayesian computation (ABC), to estimate parameters instead of directly calculating model likelihoods (<xref ref-type="bibr" rid="c72">Tavar&#x00E9; et al. 1997</xref>). The basic premise of ABC is that fitting can proceed by adjusting the parameters of the model until it yields simulations that resemble the observed data. Although ABC is intuitively appealing and relatively straight-forward to implement, it is challenging to find similarity measures for comparing simulated and observed trees that are efficient to compute and sufficiently informative to estimate the parameters. <xref ref-type="bibr" rid="c4">Baudet et al. (2014)</xref> recently used an ABC approach to cophylogeny using forward-time simulation of pathogen trees on a fixed host phylogeny, and employed a single distance metric based on the number of tip labels shared between the largest isomorphic subtrees. Their results indicated a general lack of parameter identifiability, such that a given pair of trees can be explained equally well by a broad range of event combinations. In another recent paper, <xref ref-type="bibr" rid="c2">Alcala et al. (2017)</xref> applied multiple network statistics (<italic>e.g</italic>., degree size) to simulated tanglegrams to estimate host switching and cospeciation rates using a rejection ABC method. We anticipate that the analysis of distance metrics presented here will provide an important foundation for the further development of ABC-based methods as a promising approach to the study of cophylogeny.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work was supported in part by the Government of Canada, through Genome Canada and the Ontario Genomics Institute (OGI-131), and by grants from the Canadian Institutes of Health Research (PJT-155990, PJT-156178) and the Natural Sciences and Engineering Research Council of Canada (RGPIN-2018-05516). We also thank Eric Wong and Vidhu Joshi, for their assistance in searching the literature for cophylogeny studies and collecting published data sets, Faisal Abu-Sardanah and David W. Dick for technical support.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Aizerman</surname> <given-names>M.A.</given-names></string-name>, <string-name><surname>Braverman</surname> <given-names>&#x00C8;.M.</given-names></string-name>, <string-name><surname>Rozonoer</surname> <given-names>L.I.</given-names></string-name> <year>1964</year>. <article-title>Theoretical foundations of potential function method in pattern recognition</article-title>, <source>Automat. Rem. Contr&#x002B;</source> <volume>25</volume>:<fpage>917</fpage>&#x2013;<lpage>936</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Alcala</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Jenkins</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Christe</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Vuilleumier</surname> <given-names>S.</given-names></string-name> <year>2017</year>. <article-title>Host shift and cospeciation rate estimation from co-phylogenies</article-title>, <source>Ecol. Lett.</source> <volume>20</volume>:<fpage>1014</fpage>&#x2013;<lpage>1024</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Arai</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Gu</surname> <given-names>S.H.</given-names></string-name>, <string-name><surname>Baek</surname> <given-names>L.J.</given-names></string-name>, <string-name><surname>Tabara</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>S.N.</given-names></string-name>, <string-name><surname>Oh</surname> <given-names>H.S.</given-names></string-name>, <string-name><surname>Takada</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Kang</surname> <given-names>H.J.</given-names></string-name>, <string-name><surname>Tanaka-Taya</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Morikawa</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Okabe</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Yanagihara</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Song</surname> <given-names>J.W.</given-names></string-name> <year>2012</year>. <article-title>Divergent ancestral lineages of newfound hantaviruses harbored by phylogenetically related crocidurine shrew species in Korea</article-title>, <source>Virology</source> <volume>424</volume>:<fpage>99</fpage>&#x2013;<lpage>105</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Baudet</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Donati</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Sinaimeri</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Crescenzi</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Gautier</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Matias</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Sagot</surname> <given-names>M.F.</given-names></string-name> <year>2014</year>. <article-title>Cophylogeny reconstruction via an approximate Bayesian computation</article-title>, <source>Syst. Biol.</source> <volume>64</volume>:<fpage>416</fpage>&#x2013;<lpage>431</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Blum</surname> <given-names>M.G.</given-names></string-name>, <string-name><surname>Fran&#x00E7;ois</surname> <given-names>O.</given-names></string-name> <year>2005</year>. <article-title>On statistical tests of phylogenetic tree imbalance: the Sackin and other indices revisited</article-title>, <source>Math. Biosci.</source> <volume>195</volume>:<fpage>141</fpage>&#x2013;<lpage>153</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Bouckaert</surname> <given-names>R.R.</given-names></string-name> <year>2010</year>. <article-title>DensiTree: making sense of sets of phylogenetic trees</article-title>, <source>Bioinformatics</source> <volume>26</volume>:<fpage>1372</fpage>&#x2013;<lpage>1373</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Charleston</surname> <given-names>M.A.</given-names></string-name>, <string-name><surname>Perkins</surname> <given-names>S.L.</given-names></string-name> <year>2006</year>. <article-title>Traversing the tangle: algorithms and applications for cophylogenetic studies</article-title>, <source>J. Biomed. Inform.</source> <volume>39</volume>:<fpage>62</fpage>&#x2013;<lpage>71</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Choi</surname> <given-names>Y.J.</given-names></string-name>, <string-name><surname>Thines</surname> <given-names>M.</given-names></string-name> <year>2015</year>. <article-title>Host jumps and radiation, not co-divergence drives diversification of obligate pathogens. A case study in downy mildews and Asteraceae</article-title>, <source>PloS one</source> <volume>10</volume>:<fpage>e0133655</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Colijn</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Plazzotta</surname> <given-names>G.</given-names></string-name> <year>2017</year>. <article-title>A metric on phylogenetic tree shapes</article-title>, <source>Syst. Biol.</source> <volume>67</volume>:<fpage>113</fpage>&#x2013;<lpage>126</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="other"><string-name><surname>Collins</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Duffy</surname> <given-names>N.</given-names></string-name> <year>2002</year>. <article-title>Convolution kernels for natural language</article-title>, in: <source>Adv. Neur. Inf.</source>, <fpage>625</fpage>&#x2013;<lpage>632</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Critchlow</surname> <given-names>D.E.</given-names></string-name>, <string-name><surname>Pearl</surname> <given-names>D.K.</given-names></string-name>, <string-name><surname>Qian</surname> <given-names>C.</given-names></string-name> <year>1996</year>. <article-title>The triples distance for rooted bifurcating phylogenetic trees</article-title>, <source>Sys. Biol.</source> <volume>45</volume>:<fpage>323</fpage>&#x2013;<lpage>334</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Darriba</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Taboada</surname> <given-names>G.L.</given-names></string-name>, <string-name><surname>Doallo</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D.</given-names></string-name> <year>2011</year>. <article-title>ProtTest 3: fast selection of best-fit models of protein evolution</article-title>, <source>Bioinformatics</source> <volume>27</volume>:<fpage>1164</fpage>&#x2013;<lpage>1165</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Darriba</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Taboada</surname> <given-names>G.L.</given-names></string-name>, <string-name><surname>Doallo</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D.</given-names></string-name> <year>2012</year>. <article-title>jModelTest 2: more models, new heuristics and parallel computing</article-title>, <source>Nature methods</source> <volume>9</volume>:<fpage>772</fpage>&#x2013;<lpage>772</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>De Vienne</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Refr&#x00E9;gier</surname> <given-names>G.</given-names></string-name>, <string-name><surname>L&#x00F3;pez-Villavicencio</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Tellier</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Hood</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Giraud</surname> <given-names>T.</given-names></string-name> <year>2013</year>. <article-title>Cospeciation vs host-shift speciation: methods for testing, evidence from natural associations and relation to coevolution</article-title>, <source>New Phytol.</source> <volume>198</volume>:<fpage>347</fpage>&#x2013;<lpage>385</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Dearlove</surname> <given-names>B.L.</given-names></string-name>, <string-name><surname>Frost</surname> <given-names>S.D.</given-names></string-name> <year>2015</year>. <article-title>Measuring asymmetry in time-stamped phylogenies</article-title>, <source>PLoS Comput. Biol.</source> <volume>11</volume>:<fpage>e1004312</fpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Doyon</surname> <given-names>J.P.</given-names></string-name>, <string-name><surname>Ranwez</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Daubin</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Berry</surname> <given-names>V.</given-names></string-name> <year>2011</year>. <article-title>Models, algorithms and programs for phylogeny reconciliation</article-title>, <source>Brief. Bioinf.</source> <volume>12</volume>:<fpage>392</fpage>&#x2013;<lpage>400</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Duron</surname> <given-names>O.</given-names></string-name>, <string-name><surname>No&#x00EB;l</surname> <given-names>V.</given-names></string-name> <year>2016</year>. <article-title>A wide diversity of Pantoea lineages are engaged in mutualistic symbiosis and cospeciation processes with stinkbugs</article-title>, <source>Env. Microbiol. Rep.</source> <volume>8</volume>:<fpage>715</fpage>&#x2013;<lpage>727</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Edgar</surname> <given-names>R.C.</given-names></string-name> <year>2004</year>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>, <source>Nucleic Acids Res.</source> <volume>32</volume>:<fpage>1792</fpage>&#x2013;<lpage>1797</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Geoghegan</surname> <given-names>J.L.</given-names></string-name>, <string-name><surname>Duch&#x00EA;ne</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>E.C.</given-names></string-name> <year>2017</year>. <article-title>Comparative analysis estimates the relative frequencies of co-divergence and cross-species transmission within viral families</article-title>, <source>PLoS Pathog.</source> <volume>13</volume>:<fpage>e1006215</fpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname> <given-names>D.T.</given-names></string-name> <year>1977</year>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>, <source>J. Phys. Chem.</source> <volume>81</volume>:<fpage>2340</fpage>&#x2013;<lpage>2361</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="book"><string-name><surname>Gordon</surname> <given-names>A.</given-names></string-name> <year>1980</year>. <chapter-title>On the assessment and comparison of classifications</chapter-title>, <publisher-name>University of St. Andrews. Department of Statistics</publisher-name>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Guindon</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Gascuel</surname> <given-names>O.</given-names></string-name> <year>2003</year>. <article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title>, <source>Syst. Biol.</source> <volume>52</volume>:<fpage>696</fpage>&#x2013;<lpage>704</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Guo</surname> <given-names>W.P.</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>X.D.</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>W.</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>J.H.</given-names></string-name>, <string-name><surname>Cong</surname> <given-names>M.L.</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>H.L.</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>M.R.</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>R.H.</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>J.B.</given-names></string-name>, <string-name><surname>Li</surname> <given-names>M.H.</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Y.Z.</given-names></string-name> <year>2013</year>. <article-title>Phylogeny and origins of hantaviruses harbored by bats, insectivores, and rodents</article-title>, <source>PLoS Pathog.</source> <volume>9</volume>:<fpage>e1003159</fpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Hall</surname> <given-names>A.A.</given-names></string-name>, <string-name><surname>Morrow</surname> <given-names>J.L.</given-names></string-name>, <string-name><surname>Fromont</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Steinbauer</surname> <given-names>M.J.</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>G.S.</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>S.N.</given-names></string-name>, <string-name><surname>Cook</surname> <given-names>J.M.</given-names></string-name>, <string-name><surname>Riegler</surname> <given-names>M.</given-names></string-name> <year>2016</year>. <article-title>Codivergence of the primary bacterial endosymbiont of psyllids versus host switches and replacement of their secondary bacterial endosymbionts</article-title>, <source>Environ. Microbiol.</source> <volume>18</volume>:<fpage>2591</fpage>&#x2013;<lpage>2603</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Hausser</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Strimmer</surname> <given-names>K.</given-names></string-name> <year>2009</year>. <article-title>Entropy inference and the James-Stein estimator, with application to nonlinear gene association networks</article-title>, <source>J. Mach. Learn. Res.</source> <volume>10</volume>:<fpage>1469</fpage>&#x2013;<lpage>1484</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Hedges</surname> <given-names>S.B.</given-names></string-name>, <string-name><surname>Dudley</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Kumar</surname> <given-names>S.</given-names></string-name> <year>2006</year>. <article-title>TimeTree: a public knowledge-base of divergence times among organisms</article-title>, <source>Bioinformatics</source> <volume>22</volume>:<fpage>2971</fpage>&#x2013;<lpage>2972</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="book"><string-name><surname>Hein</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Schierup</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Wiuf</surname> <given-names>C.</given-names></string-name> <year>2004</year>. <chapter-title>Gene genealogies, variation and evolution: a primer in coalescent theory</chapter-title>, <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>USA</publisher-loc>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Hendy</surname> <given-names>M.D.</given-names></string-name>, <string-name><surname>Penny</surname> <given-names>D.</given-names></string-name> <year>1993</year>. <article-title>Spectral analysis of phylogenetic data</article-title>, <source>J. Classif.</source> <volume>10</volume>:<fpage>5</fpage>&#x2013;<lpage>24</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Ho</surname> <given-names>S.Y.</given-names></string-name>, <string-name><surname>Duch&#x00EA;ne</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Duch&#x00EA;ne</surname> <given-names>D.</given-names></string-name> <year>2015</year>. <article-title>Simulating and detecting autocorrelation of molecular evolutionary rates among lineages</article-title>, <source>Mol. Ecol. Resour.</source> <volume>15</volume>:<fpage>688</fpage>&#x2013;<lpage>696</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Hosokawa</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Kikuchi</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Nikoh</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Shimada</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Fukatsu</surname> <given-names>T.</given-names></string-name> <year>2006</year>. <article-title>Strict host-symbiont cospeciation and reductive genome evolution in insect gut bacteria</article-title>, <source>PLoS Biol.</source> <volume>4</volume>:<fpage>e337</fpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Huelsenbeck</surname> <given-names>J.P.</given-names></string-name>, <string-name><surname>Rannala</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Larget</surname> <given-names>B.</given-names></string-name> <year>2000</year>. <article-title>A Bayesian framework for the analysis of cospeciation</article-title>, <source>Evolution</source> <volume>54</volume>:<fpage>352</fpage>&#x2013;<lpage>364</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Huelsenbeck</surname> <given-names>J.P.</given-names></string-name>, <string-name><surname>Rannala</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>Z.</given-names></string-name> <year>1997</year>. <article-title>Statistical tests of host-parasite cospeciation</article-title>, <source>Evolution</source> <volume>51</volume>:<fpage>410</fpage>&#x2013;<lpage>419</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Huerta-Cepas</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Serra</surname> <given-names>F.</given-names></string-name>, <string-name><surname>Bork</surname> <given-names>P.</given-names></string-name> <year>2016</year>. <article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>, <source>Mol. Biol. Evol.</source> <volume>33</volume>:<fpage>1635</fpage>&#x2013;<lpage>1638</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Hughes</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Kennedy</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>K.P.</given-names></string-name>, <string-name><surname>Palma</surname> <given-names>R.L.</given-names></string-name>, <string-name><surname>Page</surname> <given-names>R.D.</given-names></string-name> <year>2007</year>. <article-title>Multiple cophylogenetic analyses reveal frequent cospeciation between pelecaniform birds and Pectinopygus lice</article-title>, <source>Syst. Biol.</source> <volume>56</volume>:<fpage>232</fpage>&#x2013;<lpage>251</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Johnson</surname> <given-names>K.P.</given-names></string-name>, <string-name><surname>Adams</surname> <given-names>R.J.</given-names></string-name>, <string-name><surname>Page</surname> <given-names>R.D.</given-names></string-name>, <string-name><surname>Clayton</surname> <given-names>D.H.</given-names></string-name> <year>2003</year>. <article-title>When do parasites fail to speciate in response to host speciation?</article-title>, <source>Syst. Biol.</source> <volume>52</volume>:<fpage>37</fpage>&#x2013;<lpage>47</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Kendall</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Colijn</surname> <given-names>C.</given-names></string-name> <year>2016</year>. <article-title>Mapping phylogenetic trees to reveal distinct patterns of evolution</article-title>, <source>Mol. Biol. Evol.</source> <volume>33</volume>:<fpage>2735</fpage>&#x2013;<lpage>2743</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Kikuchi</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Hosokawa</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Nikoh</surname> <given-names>N.</given-names></string-name>, <string-name><surname>Meng</surname> <given-names>X.Y.</given-names></string-name>, <string-name><surname>Kamagata</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Fukatsu</surname> <given-names>T.</given-names></string-name> <year>2009</year>. <article-title>Host-symbiont co-speciation and reductive genome evolution in gut symbiotic bacteria of acanthosomatid stinkbugs</article-title>, <source>Bmc Biol.</source> <volume>7</volume>:<fpage>2</fpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Kuhner</surname> <given-names>M.K.</given-names></string-name>, <string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1994</year>. <article-title>A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates</article-title>., <source>Mol. Biol. Evol.</source> <volume>11</volume>:<fpage>459</fpage>&#x2013;<lpage>468</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Kuhner</surname> <given-names>M.K.</given-names></string-name>, <string-name><surname>Yamato</surname> <given-names>J.</given-names></string-name> <year>2014</year>. <article-title>Practical performance of tree comparison metrics</article-title>, <source>Sys. Biol.</source> <volume>64</volume>:<fpage>205</fpage>&#x2013;<lpage>214</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Lanterbecq</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Rouse</surname> <given-names>G.W.</given-names></string-name>, <string-name><surname>Eeckhaut</surname> <given-names>I.</given-names></string-name> <year>2010</year>. <article-title>Evidence for cospeciation events in the host&#x2013;symbiont system involving crinoids (Echinodermata) and their obligate associates, the myzostomids (Myzostomida, Annelida)</article-title>, <source>Mol. Phylogenet. Evol.</source> <volume>54</volume>:<fpage>357</fpage>&#x2013;<lpage>371</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Larsson</surname> <given-names>A.</given-names></string-name> <year>2014</year>. <article-title>AliView: a fast and lightweight alignment viewer and editor for large datasets</article-title>, <source>Bioinformatics</source> <volume>30</volume>:<fpage>3276</fpage>&#x2013;<lpage>3278</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Lei</surname> <given-names>B.R.</given-names></string-name>, <string-name><surname>Olival</surname> <given-names>K.J.</given-names></string-name> <year>2014</year>. <article-title>Contrasting patterns in mammal&#x2013;bacteria coevolution: Bartonella and Leptospira in bats and rodents</article-title>, <source>PLoS Neglec. Trop. D.</source> <volume>8</volume>:<fpage>e2738</fpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Lim-Fong</surname> <given-names>G.E.</given-names></string-name>, <string-name><surname>Regali</surname> <given-names>L.A.</given-names></string-name>, <string-name><surname>Haygood</surname> <given-names>M.G.</given-names></string-name> <year>2008</year>. <article-title>Evolutionary relationships of Candidatus Endobugula bacterial symbionts and their Bugula bryozoan hosts</article-title>, <source>Appl. Environ. Microb.</source> <volume>74</volume>:<fpage>3605</fpage>&#x2013;<lpage>3609</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Merckx</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Bidartondo</surname> <given-names>M.I.</given-names></string-name> <year>2008</year>. <article-title>Breakdown and delayed cospeciation in the arbuscular mycorrhizal mutualism</article-title>, <source>P. Roy. Soc. Lond. B. Bio.</source> <volume>275</volume>:<fpage>1029</fpage>&#x2013;<lpage>1035</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Mizukoshi</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>K.P.</given-names></string-name>, <string-name><surname>Yoshizawa</surname> <given-names>K.</given-names></string-name> <year>2012</year>. <article-title>Co-phylogeography and morphological evolution of sika deer lice (Damalinia sika) with their hosts (Cervus nippon)</article-title>, <source>Parasitology</source> <volume>139</volume>:<fpage>1614</fpage>&#x2013;<lpage>1629</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="other"><string-name><surname>Mooers</surname> <given-names>A.O.</given-names></string-name> <year>1997</year>. <article-title>Inferring evolutionary process from phylogenetic tree shape</article-title>, <source>Q. Rev. Biol.</source> <fpage>72</fpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Moschitti</surname> <given-names>A.</given-names></string-name> <year>2006</year>. <article-title>Making Tree Kernels Practical for Natural Language Learning</article-title>., in: <source>Eacl</source>, vol. <volume>113</volume>, <fpage>24</fpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Noda</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Kitade</surname> <given-names>O.</given-names></string-name>, <string-name><surname>Inoue</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Kawai</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Kanuka</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Hiroshima</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Hongoh</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Constantino</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Uys</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Zhong</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Kudo</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Ohkuma</surname> <given-names>M.</given-names></string-name> <year>2007</year>. <article-title>Cospeciation in the triplex symbiosis of termite gut protists (Pseudotrichonympha spp.), their hosts, and their bacterial endosymbionts</article-title>, <source>Mol. Ecol.</source> <volume>16</volume>:<fpage>1257</fpage>&#x2013;<lpage>1266</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Nye</surname> <given-names>T.M.</given-names></string-name>, <string-name><surname>Lio</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Gilks</surname> <given-names>W.R.</given-names></string-name> <year>2005</year>. <article-title>A novel algorithm and web-based tool for comparing two alternative phylogenetic trees</article-title>, <source>Bioinformatics</source> <volume>22</volume>:<fpage>117</fpage>&#x2013;<lpage>119</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Ovadia</surname> <given-names>Y.</given-names></string-name>, <string-name><surname>Fielder</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Conow</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Libeskind-Hadas</surname> <given-names>R.</given-names></string-name> <year>2011</year>. <article-title>The cophylogeny reconstruction problem is NP-complete</article-title>, <source>J. Comput. Biol.</source> <volume>18</volume>:<fpage>59</fpage>&#x2013;<lpage>65</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Page</surname> <given-names>R.D.</given-names></string-name> <year>1993</year>. <article-title>Parasites, phylogeny and cospeciation</article-title>, <source>Int. J. Parasitol.</source> <volume>23</volume>:<fpage>499</fpage>&#x2013;<lpage>506</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Pamilo</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Nei</surname> <given-names>M.</given-names></string-name> <year>1988</year>. <article-title>Relationships between gene trees and species trees</article-title>., <source>Mol. Biol. Evol.</source> <volume>5</volume>:<fpage>568</fpage>&#x2013;<lpage>583</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Paterson</surname> <given-names>A.M.</given-names></string-name>, <string-name><surname>Banks</surname> <given-names>J.</given-names></string-name> <year>2001</year>. <article-title>Analytical approaches to measuring cospeciation of host and parasites: through a glass, darkly</article-title>, <source>Int. J. Parasitol.</source> <volume>31</volume>:<fpage>1012</fpage>&#x2013;<lpage>1022</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Peek</surname> <given-names>A.S.</given-names></string-name>, <string-name><surname>Feldman</surname> <given-names>R.A.</given-names></string-name>, <string-name><surname>Lutz</surname> <given-names>R.A.</given-names></string-name>, <string-name><surname>Vrijenhoek</surname> <given-names>R.C.</given-names></string-name> <year>1998</year>. <article-title>Cospeciation of chemoautotrophic bacteria and deep sea clams</article-title>, <source>P. Natl. Acad. Sci.</source> <volume>95</volume>:<fpage>9962</fpage>&#x2013;<lpage>9966</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Penny</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Foulds</surname> <given-names>L.</given-names></string-name>, <string-name><surname>Hendy</surname> <given-names>M.</given-names></string-name> <year>1982</year>. <article-title>Testing the theory of evolution by comparing phylogenetic trees constructed from five different protein sequences</article-title>, <source>Nature</source> <volume>297</volume>:<fpage>197</fpage>&#x2013;<lpage>200</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Pompei</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Loreto</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Tria</surname> <given-names>F.</given-names></string-name> <year>2012</year>. <article-title>Phylogenetic properties of RNA viruses</article-title>, <source>PLoS One</source> <volume>7</volume>:<fpage>e44849</fpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Poon</surname> <given-names>A.F.</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>L.W.</given-names></string-name>, <string-name><surname>Murray</surname> <given-names>H.</given-names></string-name>, <string-name><surname>McCloskey</surname> <given-names>R.M.</given-names></string-name>, <string-name><surname>Harrigan</surname> <given-names>P.R.</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>R.H.</given-names></string-name> <year>2013</year>. <article-title>Mapping the shapes of phylogenetic trees from human and zoonotic RNA viruses</article-title>, <source>PLoS one</source> <volume>8</volume>:<fpage>e78122</fpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Rabosky</surname> <given-names>D.L.</given-names></string-name> <year>2010</year>. <article-title>Extinction rates should not be estimated from molecular phylogenies</article-title>, <source>Evolution</source> <volume>64</volume>:<fpage>1816</fpage>&#x2013;<lpage>1824</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="website"><string-name><surname>Rambaut</surname> <given-names>A.</given-names></string-name> <year>2009</year>. <article-title>FigTree, version 1.3. 1</article-title>, Computer program distributed by the author, website: <ext-link ext-link-type="uri" xlink:href="http://treebioedacuk/software/figtree/">http://treebioedacuk/software/figtree/</ext-link>[<date-in-citation content-type="access-date" iso-8601-date="2011-01-04">accessed January 4, 2011</date-in-citation>].</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Rector</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Lemey</surname> <given-names>P.</given-names></string-name>, <string-name><surname>Tachezy</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Mostmans</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Ghim</surname> <given-names>S.J.</given-names></string-name>, <string-name><surname>Van Doorslaer</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Roelke</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Bush</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Montali</surname> <given-names>R.J.</given-names></string-name>, <string-name><surname>Joslin</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Burk</surname> <given-names>R.</given-names></string-name>, <string-name><surname>Jenson</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Sundberg</surname> <given-names>J.</given-names></string-name>, <string-name><surname>Shapiro</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Van Ranst</surname> <given-names>M.</given-names></string-name> <year>2007</year>. <article-title>Ancient papillomavirus-host co-speciation in Felidae</article-title>, <source>Genome Biol.</source> <volume>8</volume>:<fpage>R57</fpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Revell</surname> <given-names>L.J.</given-names></string-name> <year>2012</year>. <article-title>phytools: an R package for phylogenetic comparative biology (and other things)</article-title>, <source>Methods Ecol. Evol.</source> <volume>3</volume>:<fpage>217</fpage>&#x2013;<lpage>223</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Robinson</surname> <given-names>D.F.</given-names></string-name>, <string-name><surname>Foulds</surname> <given-names>L.R.</given-names></string-name> <year>1979</year>. <article-title>Comparison of weighted labeled trees</article-title>, <source>Lect. Notes Math.</source> <volume>748</volume>:<fpage>119</fpage>&#x2013;<lpage>126</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Robinson</surname> <given-names>D.F.</given-names></string-name>, <string-name><surname>Foulds</surname> <given-names>L.R.</given-names></string-name> <year>1981</year>. <article-title>Comparison of phylogenetic trees</article-title>, <source>Math. Biosci.</source> <volume>53</volume>:<fpage>131</fpage>&#x2013;<lpage>147</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Santiago-Alarcon</surname> <given-names>D.</given-names></string-name>, <string-name><surname>Rodr&#x00ED;guez-Ferraro</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Parker</surname> <given-names>P.G.</given-names></string-name>, <string-name><surname>Ricklefs</surname> <given-names>R.E.</given-names></string-name> <year>2014</year>. <article-title>Different meal, same flavor: cospeciation and host switching of haemosporidian parasites in some non-passerine birds</article-title>, <source>Parasite. Vector.</source> <volume>7</volume>:<fpage>286</fpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Sauer</surname> <given-names>C.</given-names></string-name>, <string-name><surname>Stackebrandt</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Gadau</surname> <given-names>J.</given-names></string-name>, <string-name><surname>H&#x00F6;lldobler</surname> <given-names>B.</given-names></string-name>, <string-name><surname>Gross</surname> <given-names>R.</given-names></string-name> <year>2000</year>. <article-title>Systematic relationships and cospeciation of bacterial endosymbionts and their carpenter ant host species: proposal of the new taxon Candidatus Blochmannia gen. nov</article-title>., <source>Int. J. Syst. Evol. Microbiol.</source> <volume>50</volume>:<fpage>1877</fpage>&#x2013;<lpage>1886</lpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Saulnier</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Gascuel</surname> <given-names>O.</given-names></string-name>, <string-name><surname>Alizon</surname> <given-names>S.</given-names></string-name> <year>2017</year>. <article-title>Inferring epidemiological parameters from phylogenies using regression-ABC: a comparative study</article-title>, <source>PLoS Comput. Biol.</source> <volume>13</volume>:<fpage>e1005416</fpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Sayers</surname> <given-names>E.W.</given-names></string-name>, <string-name><surname>Barrett</surname> <given-names>T.</given-names></string-name>, <string-name><surname>Benson</surname> <given-names>D.A.</given-names></string-name>, <string-name><surname>Bolton</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Bryant</surname> <given-names>S.H.</given-names></string-name>, <string-name><surname>Canese</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Chetvernin</surname> <given-names>V.</given-names></string-name>, <string-name><surname>Church</surname> <given-names>D.M.</given-names></string-name>, <string-name><surname>Dicuccio</surname> <given-names>M.</given-names></string-name>, <string-name><surname>Federhen</surname> <given-names>S.</given-names></string-name>, <etal>et al.</etal> <year>2009</year>. <article-title>Database resources of the national center for biotechnology information</article-title>, <source>Nucleic Acids Res.</source> <volume>38</volume>:<fpage>D5</fpage>&#x2013;<lpage>D16</lpage>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><surname>Schliep</surname> <given-names>K.P.</given-names></string-name> <year>2011</year>. <article-title>phangorn: phylogenetic analysis in R</article-title>, <source>Bioinformatics</source> <volume>27</volume>:<fpage>592</fpage>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><surname>Sokal</surname> <given-names>R.R.</given-names></string-name>, <string-name><surname>Rohlf</surname> <given-names>F.J.</given-names></string-name> <year>1962</year>. <article-title>The comparison of dendrograms by objective methods</article-title>, <source>Taxon</source> <volume>11</volume>:<fpage>33</fpage>&#x2013;<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><string-name><surname>Stam</surname> <given-names>E.</given-names></string-name> <year>2002</year>. <article-title>Does imbalance in phylogenies reflect only bias?</article-title>, <source>Evolution</source> <volume>56</volume>:<fpage>1292</fpage>&#x2013;<lpage>1295</lpage>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><string-name><surname>Talevich</surname> <given-names>E.</given-names></string-name>, <string-name><surname>Invergo</surname> <given-names>B.M.</given-names></string-name>, <string-name><surname>Cock</surname> <given-names>P.J.</given-names></string-name>, <string-name><surname>Chapman</surname> <given-names>B.A.</given-names></string-name> <year>2012</year>. <article-title>Bio. Phylo: a unified toolkit for processing, analyzing and visualizing phylogenetic trees in Biopython</article-title>, <source>BMC bioinformatics</source> <volume>13</volume>:<fpage>209</fpage>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><string-name><surname>Tavar&#x00E9;</surname> <given-names>S.</given-names></string-name>, <string-name><surname>Balding</surname> <given-names>D.J.</given-names></string-name>, <string-name><surname>Griffiths</surname> <given-names>R.C.</given-names></string-name>, <string-name><surname>Donnelly</surname> <given-names>P.</given-names></string-name> <year>1997</year>. <article-title>Inferring coalescence times from DNA sequence data</article-title>, <source>Genetics</source> <volume>145</volume>:<fpage>505</fpage>&#x2013;<lpage>518</lpage>.</mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><string-name><surname>Vermeij</surname> <given-names>G.J.</given-names></string-name> <year>1994</year>. <article-title>The evolutionary interaction among species: selection, escalation, and coevolution</article-title>, <source>Annual Review of Ecology and Systematics</source> <volume>25</volume>:<fpage>219</fpage>&#x2013;<lpage>236</lpage>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="other"><string-name><surname>Williams</surname> <given-names>W.T.</given-names></string-name>, <string-name><surname>Clifford</surname> <given-names>H.T.</given-names></string-name> <year>1971</year>. <article-title>On the comparison of two classifications of the same set of elements</article-title>, <source>Taxon</source> <fpage>519</fpage>&#x2013;<lpage>522</lpage>.</mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><string-name><surname>Zeileis</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Hornik</surname> <given-names>K.</given-names></string-name>, <string-name><surname>Smola</surname> <given-names>A.</given-names></string-name>, <string-name><surname>Karatzoglou</surname> <given-names>A</given-names></string-name>. <year>2004</year>. <article-title>kernlab-an S4 package for kernel methods in R</article-title>, <source>J. Stat. Soft.</source> <volume>11</volume>:<fpage>1</fpage>&#x2013;<lpage>20</lpage>.</mixed-citation></ref>
</ref-list>
<sec sec-type="supplementary-material">
<title>Supplementary Material Figures</title>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure">
<label>Figure S1:</label>
<caption><p>Tree distance measures for the general collection of host-pathogen trees. High- (circles) and low-codivergence (crosses) assignments were drawn from the publications associated with each pair (<xref ref-type="table" rid="tbl2">Table 2</xref>). We grafted zero-length branches to tips with multiple relations, <italic>e.g.</italic>, a pathogen species found in two host species, to enforce a one-to-one relation between tips in the host and pathogen trees. To facilitate comparisons across distance measures, each measure x was normalized to range from 0 to 1 by applying the transformation (<italic>x</italic> &#x2014; min(<italic>x</italic>))/ (max(<italic>x</italic>) &#x2014; min(<italic>x</italic>)).</p></caption>
<graphic xlink:href="388116_figS1.tif"/>
</fig>
<fig id="figS2" position="float" orientation="portrait" fig-type="figure">
<label>Figure S2:</label>
<caption><p>PCA on &#x2018;General&#x2019; collection unlabeled kernel (kU) scores showing host and pathogen pairs coming from high co-divergence (in red) and low-codivergence (in cyan) studies as summarized in <xref ref-type="table" rid="tbl2">Table 2</xref>. Every single point represents host or pathogen tree&#x2019; eigenvalue, with the one belonging to the same pair united by a straight line.</p></caption>
<graphic xlink:href="388116_figS2.tif"/>
</fig>
<fig id="figS3" position="float" orientation="portrait" fig-type="figure">
<label>Figure S3:</label>
<caption><p>PCA for 19 virus families, a: kUn; b: kLn. In red pairs including DNA-viruses, in cyan pairs icluding RNA-viruses. Aden: Adenoviridae, Buny: Bunyaviridae, Cali: Caliciviri-dae, Coro: Coronaviridae, Flav: Flaviviridae, Hepa: Hepadnaviridae, Herp: Herpesviridae, Orth: Orthomyxoviridae, Papi: Papillomaviridae, Para: Paramyxoviridae, Parv: Parvoviridae, Pico: Pi-cornaviridae, Poly: Polyomaviridae, Poty: Potyviridae, Poxv: Poxviridae, Reov: Reoviridae, Retr: Retroviridae, Rhab: Rhabdoviridae, Toga: Togaviridae, H: Host tree, V: Virus tree, host and virus&#x2019; trees have same symbol.</p></caption>
<graphic xlink:href="388116_figS3.tif"/>
</fig>
</sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material Tables</title>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1:</label>
<caption><p>Parameter settings used for simulation experiments corresponding to three edge cases. Each edge case varied one of the model parameters over the range 0 to 1 inclusive. In addition to these endpoints, we selected 10 to 12 arbitrarily chosen intermediate values. For each parameter combination, we simulated 100 replicate pathogen trees.</p></caption>
<graphic xlink:href="388116_tblS1.tif"/>
</table-wrap>
</sec>
</back>
</article>