<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/201897</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>FACSanadu: Graphical user interface for rapid visualization and quantification of flow cytometry data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7703-7774</contrib-id>
<name><surname>B&#x00FC;rglin</surname><given-names>T.R.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7745-2844</contrib-id>
<name><surname>Henriksson</surname><given-names>J.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biomedicine, University of Basel</institution>, Mattenstrasse 28, 4058 Basel, <country>Switzerland</country></aff>
<aff id="a2"><label>2</label><institution>Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus</institution>, Hinxton, CB10 1SA Cambridge, <country>UK</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author</corresp>
</author-notes>
<pub-date pub-type="epub"><year>2017</year></pub-date>
<elocation-id>201897</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>13</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="201897.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<sec>
<title>Motivation</title>
<p>Flow cytometry is a fundamental technique in cell biology, yet few open source packages are available to analyse these data. Here we describe FACSanadu, an interactive package for rapid visualization and measurement of flow cytometry data. It is the first open source package that can read length profile data from
the COPAS Biosorter.</p>
</sec>
<sec>
<title>Availability and Implementation</title>
<p>FACSanadu is implemented in Java and uses the Qt framework for display. Binary distributions are made for all major operating systems (Windows, Macintosh, Linux). The source code and documentation is available as free software at <ext-link ext-link-type="uri" xlink:href="http://www.facsanadu.org">http://www.facsanadu.org</ext-link>.</p>
<p><bold>Contact:</bold> <email>mahogny@areta.org</email></p>
</sec>
</abstract>
<counts>
<page-count count="2"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1.</label>
<title>INTRODUCTION</title>
<p>Flow cytometry is a routine method for analyzing populations of cells. The ease of flow cytometry measurements, in conjunction with antibody markers that allow identification of many cell types, makes it one of the most important tools in biology and for clinical pathology (ref some review). This resulted in a strong need for standardization of file formats (<xref ref-type="bibr" rid="c4">Spidlen et al., 2010</xref>). Most instruments from manufacturers come with their own proprietary software, which generally does not allow customizations and makes analysis difficult when data from different instruments are collated. Hence, third party software has become available for data analysis, the two most prevalent software packages being &#x201C;FlowJo&#x201D; (<ext-link ext-link-type="uri" xlink:href="http://www.flowjo.com">http://www.flowjo.com</ext-link>) and &#x201C;FCS Express&#x201D; (<ext-link ext-link-type="uri" xlink:href="http://www.denovosoftware.com">http://www.denovosoftware.com</ext-link>). But the unavailability of the source code prevents us from adapting it for our purposes. Free analysis packages exist; one is &#x201C;Flowing&#x201D; from the Turku Centre of Biotechnology (<ext-link ext-link-type="uri" xlink:href="http://www.flowingsoftware.com">http://www.flowingsoftware.com</ext-link>). but since it is written in a proprietary programming language (Visual Basic) it is not easy to modify, nor to run on non-windows platforms. A simpler interactive alternative is &#x201C;FlowPy&#x201D; (<ext-link ext-link-type="uri" xlink:href="flowpy.wikidot.com">flowpy.wikidot.com</ext-link>), but it also only runs on Windows. For users experienced with the R programming language, the &#x201C;flowCore&#x201D; Bioconductor package can handle FCS-files (<xref ref-type="bibr" rid="c2">Hahne et al., 2009</xref>). This allows one to use all the powerful statistics of the language, but it is not suitable for the casual flow cytometry users and there is no option to interactively browse the data and define gates. A similar R package able to read the COPAS specific file format exists as well (<xref ref-type="bibr" rid="c3">Shimko &#x0026; Andersen, 2014</xref>) but it only covers the Reflux portion of the instrument. To our knowledge, none of these packages allow data analysis of COPAS Biosorter length profile data. This specialized flow sorter is becoming more popular as larger samples (e.g. <italic>C</italic>. <italic>elegans</italic>, embryos, organoids) are being analyzed more routinely. We hence decided to write our own portable package for flow cytometry analysis, with strong emphasis on fast exploration and ease of use, in particular for COPAS data.</p></sec>
<sec id="s2">
<label>2.</label>
<title>OVERVIEW OF FACSANADU</title>
<p>FACSanadu is a portable open-source software package implemented in Java using the Qt cross platform application framework (<ext-link ext-link-type="uri" xlink:href="http://www.qt-project.org">http://www.qt-project.org</ext-link>) and Qt Jambi (<ext-link ext-link-type="uri" xlink:href="http://www.qtjambi.org">http://www.qtjambi.org</ext-link>). This has made it easy to maintain ports for all operating systems, each with the feeling of a modern native user interface. The software can load most common FCS files as well as native files from the COPAS Biosorter.</p>
<p>As expected, FACSanadu can generate scatter plots and histograms of the data. However, to speed up the data processing, we have decided against letting the user manually place out gates on a &#x201C;worksheet&#x201D; as commonly found in other programs. Instead, the graphs, upon selection of data, are placed automatically in a compact grid layout; different views are on one axis and datasets on the other axis (<xref ref-type="fig" rid="fig1">Fig 1a</xref>). Axis can be changed by simply clicking on the axis label. Only the views and datasets selected in the side bar are displayed. When gates are drawn they are displayed and updated on all views simultaneously. This makes it easy to, for example, show 2 positive and 2 negative controls, and adjust the gating region on all of them simultaneously. The currently displayed views can be exported as PNG files; either as one big image, or split by dataset/view, or as all individual files.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1.</label>
<caption><p><bold>(A)</bold> Visualization of all views. A grid of plots is made from the current selection of views and datasets. All plots are updated in parallel as gates as drawn or edited. For multiple datasets the gating is done in the background on multiple CPU cores <bold>(B)</bold> Statistical summary table, of the selected datasets and gates, as well as additional intensity measurements <bold>(C)</bold> Display of length patterns of <italic>C. elegans</italic> nematodes as captured on a COPAS Biosorter. A region has been selected from which the integral is provided as a new virtual channel.</p></caption>
<graphic xlink:href="201897_fig1.tif"/>
</fig>
<p>After selecting gate regions all the gating statistics can be found on the statistics pane (<xref ref-type="fig" rid="fig1">Fig 1b</xref>). A table is generated from the selected datasets and selected gates, with options for showing the fraction of cells from the parent gate, and the total population. Further measurements can be added to each gated population, such as the mean intensity of certain channels. Once all measurements have been set, the table can be copied to the clipboard or exported to CSV.</p>
<p>For data from the COPAS Biosorter, we have added a third pane, which allows the analysis and visualization of length profiles (<xref ref-type="fig" rid="fig1">Fig 1c</xref>). The detector of the COPAS Biosorter allows recording of profiles of long objects, for example, the green fluorescent gene expression pattern along the length of the body of <italic>C</italic>. <italic>elegans</italic> larvae. This has previously been used to record chronograms, i.e., the time-evolution of expression patterns of genes along the larvae, and the same automatic alignment algorithm is automatically applied (<xref ref-type="bibr" rid="c1">Dupuy et al., 2007</xref>). The length profile pane allows one to manually browse individual objects from the chosen gate, or it can display an ensemble of them. The length profiles can be shown as-is or normalized by length, each channel with an individual scale bar. For interesting regions the user can set a window in which the intensity is measured. This will then appear as a new channel which can be used for gating and statistics as usual.</p>
<p>To allow users to interactively work with large datasets, as well as make full use of modern multi-core CPUs, FACSanadu makes extensive use of threading and background computation. Multiple datasets are always gated in parallel.</p></sec>
<sec id="s3">
<label>3.</label>
<title>CONCLUSIONS</title>
<p>FACSanadu fills a gap in the flow cytometry analysis toolbox by providing a quick and simple tool for working with flow cytometry data. While we have made an effort to provide the essential functions the user expects from an interactive flow cytometry package, the availability of the source code makes it possible to extend the functions for the needs of particular laboratories. Together with Bioconductor, there is now a complete suite of open source tools for FACS analysis.</p>
</sec>
</body>
<back>
<ack>
<title>ACKNOWLEDGEMENTS</title>
<p>The authors thank Natalia Kunowska, Valentina Proserpio and Kedar Natarajan for early beta testing of the software as well as suggestions for new features.</p>
</ack>
<sec id="s4">
<title>Funding</title>
<p>This research was supported by the Swedish Research Council (Vetenskapsr&#x00E5;det).</p>
</sec>
<sec id="s5" sec-type="COI-statement">
<title>Conflict of interest</title>
<p>None declared</p>
</sec>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Dupuy</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Bertin</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Hidalgo</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Venkatesan</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Tu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>D.</given-names></string-name>, &#x2026; <string-name><surname>Vidal</surname>, <given-names>M.</given-names></string-name> (<year>2007</year>). <article-title>Genome-scale analysis of in vivo spatiotemporal promoter activity in Caenorhabditis elegans</article-title>. <source>Nature Biotechnology</source>, <volume>25</volume>(<issue>6</issue>), <fpage>663</fpage>&#x2013;<lpage>8</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt1305">https://doi.org/10.1038/nbt1305</ext-link></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Hahne</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>LeMeur</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Brinkman</surname>, <given-names>R. R.</given-names></string-name>, <string-name><surname>Ellis</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Haaland</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Sarkar</surname>, <given-names>D.</given-names></string-name>, &#x2026; <string-name><surname>Gentleman</surname>, <given-names>R.</given-names></string-name> (<year>2009</year>). <article-title>flowCore: a Bioconductor package for high throughput flow cytometry</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>(<issue>1</issue>), <fpage>106</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-10-106">https://doi.org/10.1186/1471-2105-10-106</ext-link></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Shimko</surname>, <given-names>T. C.</given-names></string-name>, &#x0026; <string-name><surname>Andersen</surname>, <given-names>E. C.</given-names></string-name> (<year>2014</year>). <article-title>COPASutils: An R Package for Reading, Processing, and Visualizing Data from COPAS Large-Particle Flow Cytometers</article-title>. <source>PLoS ONE</source>, <volume>9</volume>(<issue>10</issue>), <fpage>e111090</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0111090">https://doi.org/10.1371/journal.pone.0111090</ext-link></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Spidlen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Moore</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Parks</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Goldberg</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bray</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Bierre</surname>, <given-names>P.</given-names></string-name>, &#x2026; <string-name><surname>Brinkman</surname>, <given-names>R. R.</given-names></string-name> (<year>2010</year>). <article-title>Data File Standard for Flow Cytometry, version FCS 3.1</article-title>. <source>Cytometry. Part A: The Journal of the International Society for Analytical Cytology</source>, <volume>77</volume>(<issue>1</issue>), <fpage>97</fpage>&#x2013;<lpage>100</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/cyto.a.20825">https://doi.org/10.1002/cyto.a.20825</ext-link></mixed-citation></ref>
</ref-list>
</back>
</article>