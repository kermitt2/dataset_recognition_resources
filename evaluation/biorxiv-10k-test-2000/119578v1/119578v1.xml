<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/119578</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Distinguishing among modes of convergent adaptation using population genomic data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Lee</surname>
<given-names>Kristin M.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Coop</surname>
<given-names>Graham</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Center for Population Biology, University of California</institution>, Davis.</aff>
<aff id="a2"><label>2</label><institution>Department of Evolution and Ecology, University of California</institution>, Davis</aff>
</contrib-group>
<author-notes>
<corresp id="cor1">To whom correspondence should be addressed: <email>krmlee@ucdavis.edu</email>, <email>gmcoop@ucdavis.edu</email>
</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>119578</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>3</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="119578.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Geographically separated populations can convergently adapt to the same selection pressure. Convergent evolution at the level of a gene may arise via three distinct modes. The selected alleles can (1) have multiple independent mutational origins, (2) be shared due to shared ancestral standing variation, or (3) spread throughout subpopulations via gene flow. We present a model-based, statistical approach that utilizes genomic data to detect cases of convergent adaptation at the genetic level, identify the loci involved and distinguish among these modes. To understand the impact of convergent positive selection on neutral diversity at linked loci, we make use of the fact that hitchhiking can be modeled as an increase in the variance in neutral allele frequencies around a selected site within a population. We build on coalescent theory to show how shared hitchhiking events between subpopulations act to increase covariance in allele frequencies between subpopulations at loci near the selected site, and extend this theory under different models of migration and selection on the same standing variation. We incorporate this hitchhiking effect into a multivariate normal model of allele frequencies that also accounts for population structure. Based on this theory, we present a composite likelihood-based approach that utilizes genomic data to identify loci involved in convergence, and distinguishes among alternate modes of convergent adaptation. We illustrate our method on genome-wide polymorphism data from two distinct cases of convergent adaptation. First, we investigate the adaptation for copper toxicity tolerance in two populations of the common yellow monkeyflower, <italic>Mimulus guttatus</italic>. We show that selection has occurred on an allele that has been standing in these populations prior to the onset of copper mining in this region. Lastly, we apply our method to data from four populations of the killifish, <italic>Fundulus heteroclitus</italic>, that show very rapid convergent adaptation for tolerance to industrial pollutants. Here, we identify a single locus at which both independent mutation events and selection on very young standing variation play a role in adaptation across the species&#x2019; range.</p>
</abstract>
<counts>
<page-count count="48"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Convergent adaptive evolution, where selection independently drives the evolution of the same trait, demonstrates the impressive ability of natural selection to repeatedly shape phenotypic diversity (<xref ref-type="bibr" rid="c34">Losos, 2011</xref>). Many studies have revealed cases of repeated adaptation resulting from changes in the same molecular mechanisms across distinct lineages (<xref ref-type="bibr" rid="c57">Stern, 2013</xref>; <xref ref-type="bibr" rid="c65">Wood et al., 2005</xref>). Here, we use the term convergence to define all cases of repeated evolution of similar traits across independent lineages, and do not distinguish between convergent and parallel evolution (<xref ref-type="bibr" rid="c1">Arendt and Reznick, 2008</xref>). In some cases, these convergent adaptive changes are identical at the level of the same orthologous gene or nucleotide (<xref ref-type="bibr" rid="c36">Martin and Orgogozo, 2013</xref>), suggesting adaptation may be more predictable and constrained than previously appreciated. Studying repeated evolution has long played a key role in evolutionary biology as a set of replicated natural experiments to help build comparative arguments for traits as adaptations, and to identify and understand the ecological and molecular basis of adaptive traits (<xref ref-type="bibr" rid="c17">Harvey and Pagel, 1991</xref>).</p>
<p>While we often think of convergent evolution among long-separated species, populations of the same (or closely-related) species often repeatedly evolve similar traits in response to similar selective pressures (<xref ref-type="bibr" rid="c1">Arendt and Reznick, 2008</xref>). Convergent adaptation at the genetic level among closely related populations may arise via multiple, distinct modes (see <xref ref-type="bibr" rid="c57">Stern, 2013</xref>, for a recent review). Selected alleles present at the same loci in multiple populations can have multiple independent mutational origins (e.g. <xref ref-type="bibr" rid="c44">Pearce et al., 2009</xref>; <xref ref-type="bibr" rid="c7">Chan et al., 2010</xref>; <xref ref-type="bibr" rid="c59">Tishkoff et al., 2007</xref>). Alternatively, adaptation in different populations could proceed by means of selection on the standing variation present in their ancestor (e.g. <xref ref-type="bibr" rid="c10">Colosimo et al., 2005</xref>; <xref ref-type="bibr" rid="c51">Roesti et al., 2014</xref>), or a single allele spread throughout the populations via gene flow (e.g. <xref ref-type="bibr" rid="c19">Heliconius Genome Consortium, 2012</xref>; <xref ref-type="bibr" rid="c56">Song et al., 2011</xref>). Understanding the source of convergent adaptation can aid in our understanding of fundamental questions about adaptation. Distinguishing among these modes may provide evidence for how restricted the paths adaptation can take are to pleiotropic constraints and if adaptation is limited by mutational input (Orr <xref ref-type="bibr" rid="c43">2005</xref>, for review). Additionally, we can improve our understanding of the role of standing variation and gene flow in adaptation (<xref ref-type="bibr" rid="c2">Barrett and Schluter, 2008</xref>; <xref ref-type="bibr" rid="c18">Hedrick, 2013</xref>; <xref ref-type="bibr" rid="c63">Welch and Jiggins, 2014</xref>).</p>
<p>With the advent of population genomic data, it is now possible to detect genomic regions putatively underlying recent convergent adaptations. A growing number of studies are sequencing population genomic data from closely related populations, in which some have potentially converged on an adaptive phenotype (e.g. <xref ref-type="bibr" rid="c60">Turner et al., 2010</xref>; <xref ref-type="bibr" rid="c23">Jones et al., 2012</xref>). Population genomic studies of convergent evolution often take a paired population design, sampling multiple pairs of populations that independently differ in the key phenotype or environment are sequenced. These studies are usually predicated on finding large effect loci which have rapidly increased from low frequency to identify the population genomic signal of selective sweeps shared across populations that independently share a selective pressure. Regions underlying convergent adaptations can potentially be identified by looking for genomic regions where multiple pairs of populations are strongly differentiated (e.g. using <italic>F<sub>ST</sub></italic>) compared to the genomic background. Another broad set of approaches identify convergent loci by looking for genomic regions where the populations that share an environment cluster together phylogenetically in a way unpredicted by genome-wide patterns or geography (<xref ref-type="bibr" rid="c45">Pease et al., 2016</xref>; <xref ref-type="bibr" rid="c23">Jones et al., 2012</xref>). While these methods have proven useful in identifying loci involved in convergent adaptation, currently there are few model-based ways to identify the signal of convergence in population genomic data or to distinguish the different modes of convergent adaptation. In the case where an allele is shared due to adaptation from standing variation or migration, chunks of the haplotype on which the selected allele arose and swept on will also be shared among the populations (<xref ref-type="bibr" rid="c55">Slatkin and Wiehe, 1998</xref>; <xref ref-type="bibr" rid="c6">Bierne, 2010</xref>; <xref ref-type="bibr" rid="c27">Kim and Maruki, 2011</xref>; <xref ref-type="bibr" rid="c51">Roesti et al., 2014</xref>), providing a useful heuristic for these modes to be distinguished from convergent sweeps from independent mutations. We also note there are a variety of approaches to detect introgression (see <xref ref-type="bibr" rid="c18">Hedrick, 2013</xref>; <xref ref-type="bibr" rid="c49">Racimo et al., 2015</xref>; <xref ref-type="bibr" rid="c52">Rosenzweig et al., 2016</xref>, for recent reviews). However, these methods are not usually focused on detecting sweeps in both populations, but rather look for signatures of unusual amounts of shared ancestry between populations. Here, we present coalescent theory that leverages these signatures selection has on linked neutral variation in a model-based approach. We extend this to a statistical method that utilizes genomic data to identify loci involved in and distinguish between modes of genotypic convergence.</p>
<p>Positive selection impacts neutral diversity at linked loci due to hitchhiking (<xref ref-type="bibr" rid="c38">Maynard Smith and Haigh, 1974</xref>; <xref ref-type="bibr" rid="c25">Kaplan et al., 1989</xref>) and can be modeled as an increase in the variance in neutral allele frequencies around their ancestral frequencies. We develop coalescent theory to show how shared hitchhiking events between subpopulations act to increase covariance in allele frequencies around their ancestral frequencies at loci near the selected site, and extend this theory under different models of migration and selection on the same standing variation. We incorporate this hitchhiking effect into a multivariate normal model of allele frequencies that also accounts for population structure, allowing for the application to data from many populations with arbitrary relationships. Based on this theory we present a composite likelihood-based approach (<xref ref-type="bibr" rid="c29">Kim and Stephan, 2002</xref>; <xref ref-type="bibr" rid="c42">Nielsen et al., 2005</xref>; <xref ref-type="bibr" rid="c9">Chen et al., 2010</xref>; <xref ref-type="bibr" rid="c48">Racimo, 2016</xref>) that utilizes genomic single-nucleotide polymorphism (SNP) data to identify loci involved in convergence, and distinguishes among alternate modes of convergent adaptation. As these models are also specified by relevant parameters, it is possible to obtain estimates for parameters of interest such as the strength of selection, the minimum age and frequency of a standing variant, and the source population of the beneficial allele in cases of migration.</p>
<p>This method should be of wide use with the increase in population genomic samples from across the geographic range of a species. Here, we illustrate the utility of our inference method by applying it to genome-wide polymorphism data from two distinct cases of convergent adaptation. First, we investigate the basis of the convergent adaptation observed across populations of the annual wildflower <italic>Mimulus guttatus</italic> to copper contaminated soils from two populations sampled near Copperopolis, California (<xref ref-type="bibr" rid="c66">Wright et al., 2015</xref>). We find selection has been acting on standing variation shared between these populations for a tolerance allele present prior to the onset of copper mining in this region. To further exemplify the flexibility of our method, we study a more complex population scenario: the rapid adaptation of four populations of killifish (<italic>Fundulus heteroclitus</italic>) to high levels of pollution, sampled across the Eastern seaboard of the United States (<xref ref-type="bibr" rid="c50">Reid et al., 2016</xref>). We find that even at the level of a single gene, both selection on very young shared standing variation and convergent mutation have played a role in adaptation in this species.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Models</title>
<p>In the following section, we present models for the three modes of genotypic convergent adaptation: (1) multiple independent mutations at the same locus, (2) selection on shared ancestral standing variation, and (3) migration between populations spreading a beneficial allele. Throughout this section, we compare our derived expectations to coalescent simulations using mssel, a modified version of ms (<xref ref-type="bibr" rid="c21">Hudson, 2002</xref>) that allows for the incorporation of selection at a single site. This simulation program takes as input the frequency trajectory of the selected allele for each population. We specify stochastic trajectories of the selected allele in populations following our three modes of convergence (see <xref ref-type="sec" rid="app1b">Appendix A.2</xref> for simulation details). We focus on a set of four populations as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> where populations 2 and 3 are adapted to a shared novel selection pressure and populations 1 and 4 are in the ancestral environment. The average coancestry coefficient values across simulations, estimated as described in <xref ref-type="sec" rid="app1a">Appendix A.1</xref>, are plotted for 100 bins of recombination distance away from the selected site, which occurs at distance 0. The results for all three models are shown in dashed lines in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Present day population allele frequencies at a given neutral locus (<italic>x</italic><sub>1</sub>&#x2212;<italic>x</italic><sub>4</sub> for populations 1&#x2212;4, respectively) are derived from ancestral allele frequency <italic>&#x03F5;</italic>. Each population has a coancestry coefficient proportional to the amount of drift experienced since the split from the ancestral population. <italic>f</italic><sub>11</sub> is shown for population 1. Here, populations 1 and 2, and 3 and 4 share drift relative to the ancestral population and have nonzero coancestry coefficients <italic>f</italic><sub>12</sub> and <italic>f</italic><sub>34</sub>, respectively. Blue diamonds represent the novel selective environment and red circles the ancestral environment.</p>
</caption>
<graphic xlink:href="119578_fig1.tif"/>
</fig>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Trajectories of the beneficial allele (red) for the three modes of convergent adaptation. Populations <italic>i</italic> and <italic>j</italic> are under selection with present-day allele frequencies <italic>x<sub>i</sub></italic> and <italic>x<sub>j</sub></italic> at a neutral locus, derived from an ancestral population with allele frequency <italic>&#x03F5;</italic>. The populations share some amount of drift proportional to <italic>f<sub>ij</sub></italic> before reaching the ancestral population. (2a) Beneficial mutations, indicated by the orange triangles, occur independently in the selected populations after they have become isolated. Selection begins, indicated by the blue triangles, once the beneficial allele is present in the population. The beneficial allele sweep to fixation in <italic>t<sub>s</sub></italic> generations. (2b) The beneficial allele is standing at frequency <italic>g</italic> in the ancestral population. After the selected populations split, it is still standing at frequency <italic>g</italic> for <italic>t</italic> generations prior to the onset of selection. (2c) The beneficial allele arises in population <italic>i</italic> and begins sweeping in population <italic>i</italic>. Meanwhile, there is a continuous low level of migration from population <italic>i</italic> into population <italic>j</italic>. The beneficial allele establishes in <italic>j</italic> after <italic>&#x03B4;</italic> generations, where it is swept to fixation in <italic>t<sub>s</sub></italic> generations.</p>
</caption>
<graphic xlink:href="119578_fig2.tif"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption>
<p>We calculated the average coancestry coefficient values across 1000 runs of simulations for each of 100 bins of distance away from the selected site to compare our simulation results (dashed lines) to our theoretical expectations (solid lines). (3a) Average coancestry coefficients under the independent mutations model (<italic>N<sub>e</sub></italic> &#x003D; 100, 000) within a selected population (population 2) with varying <italic>s</italic>. Also shown is the coancestry coefficient between selected populations which in this case is 0, the neutral expectation. (3b.) Coancestry coefficients under the standing variation model between selected populations with varying amount of time beneficial allele has been independently standing in populations (<italic>t</italic>). The coancestry coefficient within a single population is also shown for <italic>t</italic> &#x003D; 50. For all, <italic>N<sub>e</sub></italic> &#x003D; 10, 000, <italic>g</italic> &#x003D; 0.001, <italic>s</italic> &#x003D; 0.01. (3c) Coancestry coefficients under the migration model, within both selected populations (source population 2 and recipient population 3) as well as between source and recipient (2,3) and between recipient and a non-selected population (1,3). Here we are showing one set of parameters (<italic>s</italic> &#x003D; 0.01, <italic>m</italic> &#x003D; 0.001, <italic>N<sub>e</sub></italic> &#x003D; 10, 000) as estimates do not vary dramatically with changing <italic>m</italic> (see <xref ref-type="fig" rid="figS2">Figure S2</xref>).</p>
</caption>
<graphic xlink:href="119578_fig3.tif"/>
</fig>
<sec id="s2a">
<label>2.1</label>
<title>Null Model</title>
<p>We aim to model the variances and covariances of the neutral allele frequencies within and between populations due to convergent sweeps. First, we must specify a null model that accounts for population structure. Populations will have some level of shared deviations away from an ancestral allele frequency, <italic>&#x03F5;</italic>, due to shared genetic drift. Let <italic>x<sub>i</sub></italic> represent the present day allele frequency in population <italic>i</italic> (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We denote the deviation of this frequency from the ancestral frequency by &#x0394;<italic>x<sub>i</sub></italic> &#x003D; <italic>x<sub>i</sub></italic> &#x2212; <italic>&#x03F5;</italic>. Genetic drift, in expectation across loci, does not change the population allele frequencies (i.e. <inline-formula><alternatives><inline-graphic xlink:href="119578_inline1.gif"/></alternatives></inline-formula>) as an allele increases or decreases in frequency with equal probability. Drift however does act to increase the variance in this deviation across loci, with this variance increasing as more time is allowed for drift. The variance in the change of neutral allele frequencies in population <italic>i</italic> is
<disp-formula id="eqn1"><alternatives><graphic xlink:href="119578_eqn1.gif"/></alternatives></disp-formula> where <italic>f<sub>ii</sub></italic> can be thought of as the genetic drift branch length leading from the ancestral population to population <italic>i</italic> (<xref ref-type="bibr" rid="c41">Nicholson et al., 2002</xref>), specifying how much allele frequencies in population <italic>i</italic> deviate from their ancestral values (<xref ref-type="fig" rid="fig1">Figure 1</xref>). By rearranging <xref ref-type="disp-formula" rid="eqn1">Equation 1</xref>, <italic>f<sub>ii</sub></italic> can be interpreted as the population-specific <italic>F<sub>ST</sub></italic> for population <italic>i</italic> relative to the total population, here represented by the ancestral population (<xref ref-type="bibr" rid="c67">Wright, 1943</xref>, <xref ref-type="bibr" rid="c68">1951</xref>; <xref ref-type="bibr" rid="c62">Weir and Hill, 2002</xref>; <xref ref-type="bibr" rid="c41">Nicholson et al., 2002</xref>).</p>
<p>Populations covary in their deviations from <italic>&#x03F5;</italic> as some populations are more closely related due to shared genetic drift resulting from shared population history or gene flow. The covariance in this deviation between populations <italic>i</italic> and <italic>j</italic> is
<disp-formula id="eqn2"><alternatives><graphic xlink:href="119578_eqn2.gif"/></alternatives></disp-formula> where <italic>f<sub>ij</sub></italic> is interpreted as the coancestry coefficient between populations <italic>i</italic> and <italic>j</italic>, and can be thought of as the shared branch length connecting <italic>i</italic> and <italic>j</italic> to the ancestral population (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p>
<p>Other natural interpretations of <italic>f<sub>ii</sub></italic> and <italic>f<sub>ij</sub></italic> follow from these definitions. Specifically, these values are probabilities of a pair of lineages being identical by descent relative to the ancestral population, i.e. the probability two sampled lineages coalesce before reaching the ancestral population (see <xref ref-type="bibr" rid="c58">Thompson, 2013</xref>, for a recent review). We briefly review this coalescent interpretation in <xref ref-type="sec" rid="app1a">Appendix A.1</xref>. For <italic>f<sub>ii</sub></italic> these two lineages are sampled both from population <italic>i</italic>. For <italic>f<sub>ij</sub></italic>, one lineage is sampled from population <italic>i</italic> and the other from population <italic>j</italic>. We note that in practice we do not get to observe the ancestral frequency, nor may the history of our populations be well represented by a tree-like structure. However, for the sake of clarity, we proceed with these assumptions and deal with these complications in the implementation of the method.</p>
<p>We define a matrix, <bold>F</bold>, for <italic>K</italic> populations as a <italic>K</italic> &#x00D7; <italic>K</italic> matrix of coancestry coefficients. For example, for the four populations shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, this matrix takes the following form:
<disp-formula><alternatives><graphic xlink:href="119578_ueqn1.gif"/></alternatives></disp-formula></p>
<p>Populations <italic>i</italic> and <italic>j</italic> that split after the ancestral population and share no additional drift (e.g. populations 1 and 3) have <italic>f<sub>ij</sub></italic> &#x003D; 0 by definition.</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Incorporating selection</title>
<p>Positive selection impacts neutral diversity at linked loci due to hitchhiking. As the beneficial allele increases rapidly in frequency, so does the haplotype on which it arose. Neutral alleles further from the selected site may recombine off the selected background during the sweep, whose duration depends on the strength of selection. The effect of hitchhiking on the changes of linked neutral allele frequencies is similar to that of genetic drift. Hitchhiking does not alter the expected frequency change of linked neutral alleles across loci (i.e. <inline-formula><alternatives><inline-graphic xlink:href="119578_inline2.gif"/></alternatives></inline-formula>) because the selected mutation arises on a random haplotypic background. Moreover, Hitchhiking increases the variance in the deviation in neutral allele frequencies away from their ancestral values (Var[&#x0394;<italic>x<sub>i</sub></italic>]) at linked sites (<xref ref-type="bibr" rid="c15">Gillespie, 2000</xref>). Shared hitchhiking events between subpopulations will act to increase covariance in allele frequency deviations between subpopulations (Cov[&#x0394;<italic>x<sub>i</sub></italic>, <italic>&#x0394;x<sub>j</sub></italic>]) at loci near the selected site. This effect of hitchhiking on linked diversity,within and among populations gives us a way to distinguish among alternate modes of convergent adaptation.</p>
<p>We define new matrices of coancestry coefficients that incorporate selection in addition to drift as <bold>F</bold><sup>(<italic>S</italic>)</sup>. In the following section, we use a coalescent approach to derive coancestry coefficients within and between populations, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline3.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline4.gif"/></alternatives></inline-formula>, for the three modes of genotypic convergent adaptation (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In <xref ref-type="sec" rid="app1e">Appendix A.5</xref> we derive some of the same results forwards in time to help guide the reader&#x2019;s intuition. Note that all our models of selection are phrased in terms of distortions to the neutral matrix <bold>F</bold>; therefore, the precise source of the neutral population structure (e.g. whether its due to shared population history or migration) is relatively unimportant to our approach. A deeper knowledge of the basis of this structure does add to the interpretation of the results, as we explain in the discussion.</p>
<sec id="s2b1">
<label>2.2.1</label>
<title>Independent mutation model</title>
<p>We first consider the case when a beneficial allele arises independently via <italic>de novo</italic> mutations at the same locus, or tightly linked loci, in both of the selected populations. We expect hitchhiking to increase the variance in neutral allele frequency deviations around the selected site in both populations. However, as the sweeps are independent and there is no gene flow between populations during or after the sweep, we expect no covariance in the neutral allele frequency deviations between these populations, beyond that expected under neutrality due to shared population history prior to the introduction of the beneficial allele.</p>
<p>Moving backward in time, sampled neutral lineages linked to the selected site will be forced to coalesce if both lineages do not recombine off the sweep. We define the probability that a single neutral allele fails to recombine off the background of the beneficial allele during the sweep phase as <italic>y</italic>, which we can approximate as
<disp-formula id="eqn3"><alternatives><graphic xlink:href="119578_eqn3.gif"/></alternatives></disp-formula> where <italic>r</italic> is the recombination rate between the neutral locus and selected site, and <italic>t<sub>s</sub></italic> is the amount of time the sweep phase takes (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). When the beneficial allele arises from a new mutation and selection is additive, <italic>t<sub>s</sub></italic> &#x2248; 2<italic>log</italic>(4<italic>N<sub>e</sub>s</italic>)/<italic>s</italic>, where s is the selection coefficient for the heterozygote, such that heterozygotes experience a selective advantage of s and homozygotes 2s (<xref ref-type="bibr" rid="c15">Gillespie, 2000</xref>; <xref ref-type="bibr" rid="c3">Barton, 1998</xref>). The factor of 4<italic>N<sub>e</sub>s</italic> is due to the fact that our new mutation, if it is to establish in the population, rapidly reaches frequency 1/(4<italic>N<sub>e</sub>s</italic>) in the population and then increases deterministically from that frequency (<xref ref-type="bibr" rid="c37">Maynard Smith, 1971</xref>; <xref ref-type="bibr" rid="c3">Barton, 1998</xref>; <xref ref-type="bibr" rid="c28">Kim and Nielsen, 2004</xref>).</p>
<p>The coancestry coefficient in population <italic>i</italic> that experiences a sweep, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline5.gif"/></alternatives></inline-formula>, is defined as the probability that two lineages sampled from population <italic>i</italic> coalesce either due to the sweep phase or neutrally before reaching the ancestral population. With probability <italic>y</italic><sup>2</sup>, both lineages fail to recombine off the beneficial background during the sweep, and they will be forced to coalesce. If one or both lineages recombines off the sweep (with probability 1 &#x2212; <italic>y</italic><sup>2</sup>), they can coalesce before reaching the ancestral population with probability <italic>f<sub>ii</sub></italic>. Combining these we find
<disp-formula id="eqn4"><alternatives><graphic xlink:href="119578_eqn4.gif"/></alternatives></disp-formula></p>
<p>For the coancestry coefficient between two selected populations <italic>i</italic> and <italic>j</italic>, we can calculate the probability two lineages, one sampled from population <italic>i</italic> and the other from population <italic>j</italic>, coalesce. When the sweeps are independent, the lineages can only coalesce with probability <italic>f<sub>ij</sub></italic> before reaching the ancestral population, as they have no probability of coalescing during the sweep phases which have independent origins. Thus,
<disp-formula id="eqn5"><alternatives><graphic xlink:href="119578_eqn5.gif"/></alternatives></disp-formula></p>
<sec id="s2b1a">
<title>Comparison to simulated data</title>
<p>In <xref ref-type="fig" rid="fig3">Figure 3a</xref> we show the case of convergence due to independent origins of the beneficial allele. As we predicted there is no additional coancestry between the selected populations. Additionally, we show how the coancestry within a selected population decays with distance from the selected site for a range of values for the strength of selection. These coancestry values decay to the neutral expectation at other regions of the genome. With larger <italic>s</italic>, this decay is slower as the sweep occurs more rapidly and there are fewer chances for recombination to occur during this time.</p>
</sec>
</sec>
</sec>
<sec id="s2c">
<label>2.2.2</label>
<title>Standing variant model</title>
<p>We turn now to the case of a sweep shared between populations <italic>i</italic> and <italic>j</italic> due to selection acting on shared ancestral variation (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Our model is appropriate for cases where the standing variation from which the sweep arises was previously neutral or was maintained in the population at some low frequency by balancing selection. Let the beneficial allele be standing at frequency <italic>g</italic> in the ancestral population. We assume that the beneficial allele frequency does not deviate much from that of the ancestral population such that it is still <italic>g</italic> in the daughter populations prior to selection. Selection favoring the beneficial alleles begins <italic>t</italic> generations after the populations split and the beneficial allele reaches fixation in both populations after <italic>t<sub>s</sub></italic> generations (see <xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p>
<p>We first consider the coalescent process of two lineages within a single selected population. Again, <italic>y</italic> is the probability that a neutral lineage fails to recombine off the background of the beneficial allele during the sweep phase. Given that the beneficial allele is increasing from frequency <italic>g, y</italic> takes the same form as <xref ref-type="disp-formula" rid="eqn3">Equation3</xref>, where now <italic>t<sub>s</sub></italic> &#x2248; 2 log(1/<italic>g</italic>)/<italic>s</italic>. If both lineages fail to recombine off the beneficial background during the sweep, there is a probability of coalescing during the standing phase that is higher than the probability of two neutral lineages randomly sampled from the population coalescing. Following from our assumptions during the standing phase, the rate at which two lineages coalesce within a population is 1/(2<italic>N<sub>e</sub>g</italic>) per generation. Alternatively, a lineage can recombine off in the standing phase onto the other background with probability <italic>r</italic>(1 &#x2212; <italic>g</italic>) &#x2248; <italic>r</italic> per generation. As these are two competing exponential processes, the probability two lineages coalesce before either recombines off the beneficial background can be simplified to
<disp-formula id="eqn6"><alternatives><graphic xlink:href="119578_eqn6.gif"/></alternatives></disp-formula> as described by <xref ref-type="bibr" rid="c5">Berg and Coop (2015)</xref>. If either neutral lineage recombines off the beneficial background before they coalesce, the probability of coalescing with the other lineage before reaching the ancestral population can be treated as the coancestry coefficient associated with that particular portion of the population tree.</p>
<p>Taking these approximations into account, we derive a coancestry coefficient for a neutral allele in population <italic>i</italic> that experiences selection from standing variation as
<disp-formula id="eqn7"><alternatives><graphic xlink:href="119578_eqn7.gif"/></alternatives></disp-formula></p>
<p>The first term corresponds to both lineages failing to recombine off the beneficial background during the sweep phase, which puts them both on the same background as the beneficial allele in the standing phase. Now, the two lineages can either coalesce in the standing phase or recombine off of the background of the beneficial allele where they can coalesce neutrally before they reach the ancestral population. Alternatively, one or both lineages can recombine off during the sweep phase and again they can coalesce neutrally.</p>
<p>Populations that share a sweep due to shared standing ancestral variation will have increased covariance in the deviations of neutral allele frequencies around their ancestral means around the selected site since they will have a shared segment of the swept haplotype. From a coalescent perspective, this occurs because two lineages sampled from each population have a higher probability of coalescing if they stay on the beneficial background during the sweep and standing phases than two lineages sampled randomly between the populations.</p>
<p>The probability that a single lineage does not recombine off onto the non-beneficial background during the standing phase for <italic>t</italic> generations can be approximated as
<disp-formula id="eqn8"><alternatives><graphic xlink:href="119578_eqn8.gif"/></alternatives></disp-formula></p>
<p>The coancestry coefficient between populations <italic>i</italic> and <italic>j</italic> is now
<disp-formula id="eqn9"><alternatives><graphic xlink:href="119578_eqn9.gif"/></alternatives></disp-formula></p>
<p>This derivation follows from that of <inline-formula><alternatives><inline-graphic xlink:href="119578_inline6.gif"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn7">Equation 7</xref>, but now incorporates the additional probability <inline-formula><alternatives><inline-graphic xlink:href="119578_inline7.gif"/></alternatives></inline-formula> of both lineages failing to recombine off the beneficial background during their independent standing phases for time <italic>t</italic>.</p>
<p>These results hold when we have a simple tree as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. However, for more complex models, it is necessary to incorporate a model that has the standing allele spreading by migration from some source population to recipient populations <italic>t</italic> generations in the past. See <xref ref-type="sec" rid="app1c">A.3</xref> for details. This model differs from the migration model presented in the next section in which we assume a continuous rate of migration throughout the duration of the sweep and that the variants sweep as soon as they are established in the population. In this standing case with a source of the standing variant, moving backwards in time we assume that the allele is standing for <italic>t</italic> generations in a population after the sweep and before the beneficial lineage migrates back instantly into a specified source population (see <xref ref-type="fig" rid="fig11">Figure 11</xref>). This is done to formally specify the changes in coancestries between selected and non-selected populations as well as between selected populations when there are multiple pairs to generate self-consistent covariance matrices. Biologically, it naturally captures the case where the allele is shared between the populations due to migration but is standing for sometime before it sweeps.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Maximum composite likelihood <bold>parameter estimates</bold> calculated under <bold>model used for simulation</bold>. We vary the true value of the parameter used for simulations along the x-axis and show the MCLE for each of 100 simulations (points). Crossbars indicate first and third quartiles with second quartiles (medians) as the horizontal line. The true values of the parameters are marked with dashed, black lines.</p>
</caption>
<graphic xlink:href="119578_fig4.tif"/>
</fig>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption>
<p>Composite log-likelihood surface of the <bold>strength of selection</bold> (<italic>s</italic>) and the <bold>frequency of standing variant</bold> (<italic>g</italic>) for three simulations (with <italic>N<sub>e</sub></italic> &#x003D; 10,000, <italic>t</italic> &#x003D; 500, <italic>g</italic> &#x003D; 0.001, <italic>s</italic> &#x003D; 0.01) to exemplify confounding of <italic>s</italic> and <italic>g</italic> under the <bold>standing variant model</bold>. Blue diamond pluses represent the true location of the parameters used for simulation. Blue circles represent MCLE.</p>
</caption>
<graphic xlink:href="119578_fig5.tif"/>
</fig>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Histograms of the <bold>differences in maximum composite log-likelihoods</bold> calculated under a given model relative to the true model used for 100 simulations. Parameter values used to simulate are noted, varying along the vertical dimension. Values less than zero, marked with solid line, indicate the true model has a higher maximum composite likelihood than alternative model. Conversely, values greater than zero indicate the alternative, incorrect model of convergence has a higher composite log-likelihood than the true model. For (6b) <italic>N<sub>e</sub></italic> &#x003D; 100, 000, (6c) <italic>N<sub>e</sub></italic> &#x003D; 10, 000, <italic>s</italic> &#x003D; 0.01, <italic>g</italic> &#x003D; 0.001, (6d) <italic>N<sub>e</sub></italic> &#x003D; 10, 000, <italic>s</italic> &#x003D; 0.01.</p>
</caption>
<graphic xlink:href="119578_fig6.tif"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Histograms of MCLE for parameters estimated under <bold>incorrect models</bold>.</p>
</caption>
<graphic xlink:href="119578_fig7.tif"/>
</fig>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><p>Inference results for <italic>Mimulus guttatus</italic> copper tolerance adaptation on Scaffold8. (a) Composite log-likelihood ratio of given model relative to neutral model of no selection as a function of the proposed selected site. (b, c) MCLE of parameters in standing variation model with position 308503 as selected site. (b) Profile composite log-likelihood surface for minimum age of standing variant, maximizing over other parameters, with peak at 430 generations (c) Composite log-likelihood surface for strength of selection versus frequency of standing variant. Blue circles represents point estimate of joint MCLE (<italic>&#x015D;</italic> &#x003D; 0.024, <italic>&#x011D;</italic> &#x003D; 10<sup>&#x2212;4</sup>). <italic>t</italic> is held constant at MCLE of 430 generations.</p>
</caption>
<graphic xlink:href="119578_fig8.tif"/>
</fig>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><p>Inference results for <italic>Fundulus heteroclitus</italic> pollutant tolerance adaptation on Scaffold9893</p>
</caption>
<graphic xlink:href="119578_fig9.tif"/>
</fig>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10:</label>
<caption><p>The composite likelihood surfaces for the parameters for <italic>Fundulus heteroclitus</italic> convergent data in combined standing variation and independent sweep model with position 1961198 on Scaffold9893 as selected site and population T3 as source.</p>
</caption>
<graphic xlink:href="119578_fig10.tif"/>
</fig>
<fig id="fig11" position="float" fig-type="figure">
<label>Figure 11:</label>
<caption><p>Trajectories of the beneficial allele (red) for the standing variant model with a source population. Populations <italic>l</italic> and <italic>i</italic> are under selection with present-day allele frequencies <italic>x<sub>l</sub></italic> and <italic>x<sub>i</sub></italic> at a neutral locus, derived from an ancestral population with allele frequency <italic>&#x03F5;</italic>. The populations share some amount of drift proportional to <italic>f<sub>il</sub></italic> before reaching the ancestral population. The beneficial allele is standing at frequency <italic>g</italic> in the source population, <italic>l</italic>. It migrates into population <italic>i</italic> from <italic>l</italic>, where it is standing at frequency <italic>g</italic> for <italic>t</italic> generations prior to the onset of selection, indicated by the blue triangles.</p>
</caption>
<graphic xlink:href="119578_fig11.tif"/>
</fig>
<sec id="s2c1">
<title>Comparison to simulated data</title>
<p>In <xref ref-type="fig" rid="fig3">Figure 3b</xref> we show comparisons of simulations to show the fit of our predictions to simulations with adaptation from standing variation. As the duration of the independent standing phases, <italic>t</italic>, increases, the coancestry at linked neutral alleles between selected populations decreases. Forward in time, this has the interpretation that the longer the beneficial allele is standing in the populations, the shorter the shared haplotype between the populations will be due to independent recombination events before selection begins. In the case that the beneficial allele has been standing for a very long time (<italic>t</italic> &#x2192; &#x221E;) before selection occurs, this additional covariance will reduce to zero as in the independent sweeps case (<xref ref-type="disp-formula" rid="eqn5">Equation 5</xref>). Conversely, if the standing variant is very young (<italic>t</italic> &#x2192; 0), the decay in covariance between populations takes the form of the variance within populations (<xref ref-type="disp-formula" rid="eqn7">Equation 7</xref>) which, as we will see in the next section, looks similar to the pattern generated under the migration model.</p>
</sec>
</sec>
<sec id="s2d">
<label>2.2.3</label>
<title>Migration model</title>
<p>We now consider the case where the selected allele is spread across sub-populations by migration. This scenario has been studied by a number of authors (<xref ref-type="bibr" rid="c55">Slatkin and Wiehe, 1998</xref>; <xref ref-type="bibr" rid="c54">Santiago and Caballero, 2005</xref>; <xref ref-type="bibr" rid="c27">Kim and Maruki, 2011</xref>), and our approach here follows similar lines to that of <xref ref-type="bibr" rid="c27">Kim and Maruki (2011)</xref>. Let there be a single origin of the beneficial allele, which occurs in population <italic>i</italic>. We assume a low, continuous level of migration during the sweep, with a proportion <italic>m</italic> of individuals in population <italic>j</italic> coming from population <italic>i</italic> each generation. We say the sweep began in population <italic>j</italic> at time <italic>t<sub>s</sub></italic> generations in the past and at time <italic>t<sub>s</sub></italic> &#x002B; <italic>&#x03B4;</italic> for population <italic>i</italic> (<xref ref-type="fig" rid="fig2">Figure 2c)</xref>. <xref ref-type="bibr" rid="c27">Kim and Maruki (2011)</xref> found that the mean delay time, <italic>&#x03B4;</italic>, between the two sweeps can be approximated by
<disp-formula id="eqn10"><alternatives><graphic xlink:href="119578_eqn10.gif"/></alternatives></disp-formula></p>
<p>The coancestry coefficient of the source population, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline8.gif"/></alternatives></inline-formula>, follows that of a population experiencing an independent sweep from new mutation (<xref ref-type="disp-formula" rid="eqn4">Equation 4</xref>). To derive the coancestry coefficient of the recipient population, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline9.gif"/></alternatives></inline-formula>, we first need to consider the fate of two lineages sampled in population <italic>j</italic> at the selected site. Two events can occur if we trace the lineages of two beneficial alleles back in time: either the two lineages coalesce in population <italic>j</italic> and a single lineage migrates back into population <italic>i</italic> or the two lineages independently migrate back into the source population and coalesce there. We define the probability of these two events as <italic>Q</italic> and 1 &#x2212; <italic>Q</italic>, respectively. We use the approximation
<disp-formula id="eqn11"><alternatives><graphic xlink:href="119578_eqn11.gif"/></alternatives></disp-formula></p>
<p>(see <xref ref-type="bibr" rid="c46">Pennings and Hermisson, 2006</xref>). Assuming <italic>m</italic> is small, such that a beneficial allele sampled at present day in population <italic>j</italic> migrates back into population <italic>i</italic> approximately <italic>t<sub>s</sub></italic> generations in the past, the probability of a linked neutral allele recombining off during the sweep phase in population <italic>j</italic> can be approximated by <italic>y</italic>. If the lineage migrates back into population <italic>i</italic> before it recombines off the beneficial background, there is an additional time <italic>&#x03B4;</italic> in population <italic>i</italic> for recombination to happen. So, there is an additional probability, <italic>e</italic><sup>&#x2212;r&#x03B4;</sup>, of recombination of our linked neutral allele off the beneficial background.</p>
<p>Thus, the coancestry coefficient for the recipient population is now
<disp-formula id="eqn12"><alternatives><graphic xlink:href="119578_eqn12.gif"/></alternatives></disp-formula></p>
<p>The terms in this approximation correspond to the following coalescent scenarios: First, if two lineages sampled in population <italic>j</italic> coalesce before migrating (with probability <italic>Q</italic>), then linked neutral alleles can coalesce either during the sweep if neither lineage recombines off the beneficial background or neutrally if either lineage recombines off. Alternatively, if the two lineages fail to coalesce before one or both migrates (w.p. 1 &#x2212; <italic>Q</italic>), there are four ways linked neutral alleles can coalesce:
<list list-type="order">
<list-item><p>Both lineages fail to recombine off the beneficial background during the sweep and are forced to coalesce during the sweep in population <italic>i</italic>. The factor <italic>e<sup>&#x2212;2r<italic>&#x03B4;</italic></sup></italic> represents the additional opportunity for recombination when both lineages have migrated back into population <italic>i</italic>.</p></list-item>
<list-item><p>Both lineages stay on the beneficial background in population <italic>j</italic> (w.p. <italic>y</italic><sup>2</sup>) but one or both lineages recombines off in population <italic>i</italic> (w.p. 1 &#x2212; <italic>e<sup>&#x2212;2r<italic>&#x03B4;</italic></sup></italic>) and they coalesce neutrally in the source population with probability <italic>f<sub>ii</sub></italic> before reaching the ancestral population.</p></list-item>
<list-item><p>Either lineage recombines off the beneficial background while it is still in population <italic>j</italic> and the two lineages coalesce neutrally in the shared drift phase of populations <italic>i</italic> and <italic>j</italic>, with probability <italic>f<sub>ij</sub></italic> before reaching the ancestral population.</p></list-item>
<list-item><p>Both lineages recombine off during the sweep phase while they are still in population <italic>j</italic> and they coalesce neutrally with probability <italic>f<sub>ij</sub></italic>.</p></list-item>
</list></p>
<p>When a beneficial allele is shared between populations <italic>i</italic> and <italic>j</italic> via migration, there will be additional covariance in the deviations of linked neutral allele frequencies from their ancestral means. In this case, there are three ways a lineage sampled from population <italic>i</italic> and a lineage sampled from population <italic>j</italic> can coalesce. They are forced to coalesce during the sweep if both lineages fail to recombine off the background of the sweep, which occurs with probability <italic>y</italic><sup>2</sup><italic>e<sup>&#x2212;r<italic>&#x03B4;</italic></sup></italic>. Alternatively, the lineage sampled in population <italic>j</italic> can recombine off the beneficial background before it migrates back to source population <italic>i</italic>, in which case the lineages can coalesce neutrally before reaching the ancestral population in their shared drift phase, with probability <italic>f<sub>ij</sub></italic>. Lastly, if the lineage sampled in population <italic>j</italic> migrates back into population <italic>i</italic> then the two sampled neutral lineages can coalesce neutrally in population <italic>i</italic> with probability <italic>f<sub>ii</sub></italic> if the lineages don&#x2019;t coalesce due to the sweep (i.e. either recombines off in time <italic>t<sub>S</sub></italic> or <italic>&#x03B4;</italic>). Thus, in the case of continuous migration the coancestry coefficient between the source and recipient population is
<disp-formula id="eqn13"><alternatives><graphic xlink:href="119578_eqn13.gif"/></alternatives></disp-formula></p>
<p>To fully specify the coancestry matrix with selection, we need to take into account the effect migration has on non-selected populations. Specifically, the coancestry coefficients between recipient and non-selected populations are impacted since there is some probability linked neutral lineages will migrate from the recipient population into the source population backwards in time. Let population <italic>k</italic> be a non-selected population. Now, the coancestry coefficient between populations <italic>j</italic> and <italic>k</italic> can be expressed as
<disp-formula id="eqn14"><alternatives><graphic xlink:href="119578_eqn14.gif"/></alternatives></disp-formula></p>
<p>This is informative about the direction of migration. First, there is no impact of selection on the relationship between the source and non-selected populations. Additionally, the sweep shared via migration will induce additional coancestry between <italic>j</italic> and <italic>k</italic> if <italic>k</italic> is more closely related to our source population (e.g. population 1 in <xref ref-type="fig" rid="fig1">Figure 1</xref> if population 2 is the source). The opposite is true if <italic>k</italic> is more closely related to our recipient population (e.g. population 4). Now, there is a deficit in the background level of coancestry between populations <italic>j</italic> and <italic>k</italic> near the selected site.</p>
<sec id="s2d1">
<title>Comparison to simulated data</title>
<p>In <xref ref-type="fig" rid="fig3">Figure 3c</xref> we show our results above compared to simulations with migration, for a single set of parameters (<italic>s</italic> &#x003D; 0.01, <italic>m</italic> &#x003D; 0.001). Here, we have migration occurring from population 2 into population 3. We show the four relevant coancestries as a function of distance from the selected site: the covariance within source <inline-formula><alternatives><inline-graphic xlink:href="119578_inline10.gif"/></alternatives></inline-formula>, within recipient <inline-formula><alternatives><inline-graphic xlink:href="119578_inline11.gif"/></alternatives></inline-formula>, between source and recipient <inline-formula><alternatives><inline-graphic xlink:href="119578_inline12.gif"/></alternatives></inline-formula>, within recipient and a non-selected population <inline-formula><alternatives><inline-graphic xlink:href="119578_inline13.gif"/></alternatives></inline-formula>. We see the coancestry within the recipient population decays more rapidly than coancestry within the source population. This fits our expectations as there is some probability a lineage will, backwards in time, migrate back to the source population, decreasing the probability of coalescing before reaching the ancestral population when <italic>m</italic> is small. As <italic>m</italic> increases, this relationship changes (<xref ref-type="fig" rid="figS2">Figure S2</xref>). We also see increased coancestry near the selected site between the selected populations. The pattern of decay varies from that observed in our standing variation model, except for when <italic>t</italic> is small. Additionally, we see increased coancestry between the recipient population and a non-selected population that decays with recombinational distance to their neutral expectation. Note, the reverse, coancestry recovering to the neutral expectation with recombinational distance is observed for populations that initially are more related to the recipient population (i.e. population 4), is also seen (<xref ref-type="fig" rid="figS3">Figure S3a</xref>). The coancestries between the source population and non-selected populations are unaffected (<xref ref-type="fig" rid="figS3">Figure S3b</xref>). Together, these observations using information from non-selected populations help distinguish possible source populations.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Inference</title>
<p>We have described how selection at linked loci affects the matrix of coancestry coefficients, allowing us to parameterize the variance and covariance in neutral allele frequency deviations within and between populations. To estimate the likelihood of our data under convergent adaptation models, we need a probability model for how allele frequencies depend on these variances and covariances. Neutral allele frequencies across <italic>K</italic> populations can approximately be modeled jointly as a multi-variate normal distribution around the ancestral allele frequency, <italic>&#x03F5;</italic>, with covariance proportional to the coancestry coefficients (<xref ref-type="bibr" rid="c41">Nicholson et al., 2002</xref>; <xref ref-type="bibr" rid="c62">Weir and Hill, 2002</xref>; <xref ref-type="bibr" rid="c11">Coop et al., 2010</xref>; <xref ref-type="bibr" rid="c53">Samanta et al., 2009</xref>). Specifically,
<disp-formula id="eqn15"><alternatives><graphic xlink:href="119578_eqn15.gif"/></alternatives></disp-formula> where <inline-formula><alternatives><inline-graphic xlink:href="119578_inline14.gif"/></alternatives></inline-formula> is a vector of population frequencies and <bold>F</bold> is the <italic>K</italic> by <italic>K</italic> matrix of coancestry coefficients without selection.</p>
<p>Above we demonstrated that we can generate coancestry matrices <bold>F</bold><sup>(<italic>S</italic>)</sup> to explain the coancestry between multiple populations due to neutral processes and various modes of convergent adaptation. <bold>F</bold><sup>(<italic>S</italic>)</sup> is a function of the neutral coancestry, (<bold>F</bold>) the model of convergence (<italic>M</italic>) and its parameters (&#x0398;<sub><italic>M</italic></sub>), and the recombination distance a neutral site is away from a selected site (<italic>r<sub>l</sub></italic>). Thus, modeling neutral allele frequencies as multivariate normal with covariance proportional to this new coancestry matrix, we can calculate the likelihood of observed data a given distance away from the selected site under a specific model of convergence as
<disp-formula id="eqn16"><alternatives><graphic xlink:href="119578_eqn16.gif"/></alternatives></disp-formula></p>
<p>In practice, we do not know the true ancestral mean at a given locus, <italic>&#x03F5;<sub>l</sub></italic>, so we use the mean of the present day population allele frequencies and calculate likelihoods of mean-centered allele frequencies and coancestry matrices (we account for this mean centering in <xref ref-type="sec" rid="app1b6">appendix A.2.6</xref>). We also do not know the true neutral coancestry matrix, <bold>F</bold>, but estimate it from deviations of allele frequencies from sample means across the entire genome. We also incorporate the effects of sampling into this variance-covariance matrix. See <xref ref-type="sec" rid="app1a">appendix A.1</xref> for details.</p>
<sec id="s3a">
<label>3.1</label>
<title>Composite likelihood framework</title>
<p>We calculate the likelihood of all data (<italic>D<sub>&#x2113;</sub></italic>) in a large window around the selected site (<italic>&#x2113;</italic>) under a given model of convergent adaptation (<italic>M</italic>), with its associated parameters (&#x0398;<sub><italic>M</italic></sub>), as the product of the marginal likelihoods for sites all distances away from the selected site. This composite likelihood is used as an approximation to the total likelihood of all sites, but is not a proper likelihood as neighboring sites are correlated due to shared histories. Moving L<sub>left</sub> sites to the left of the proposed selected site and L<sub>right</sub> sites to the right,
<disp-formula id="eqn17"><alternatives><graphic xlink:href="119578_eqn17.gif"/></alternatives></disp-formula> where <italic>r<sub>j</sub></italic> is the genetic distance from site <italic>i</italic> to <italic>&#x2113;</italic> and similarly for <italic>r<sub>j</sub></italic>. We can also obtain a composite likelihood of our data under a neutral model (<italic>N</italic>), <inline-formula><alternatives><inline-graphic xlink:href="119578_inline15.gif"/></alternatives></inline-formula>, which is only parameterized by <bold>F</bold>. This framework enables us to:
<list list-type="order">
<list-item><p>Identify the maximum likelihood location of the selected locus in a region by varying the location of the proposed selected site. For a given region and model of convergent adaptation we vary the location of the selected site, taking the maximum composite likelihood over a grid of parameters. We take as our best estimate of the location under a given model of convergence, the maximum composite likelihood location of the selected site <inline-formula><alternatives><inline-graphic xlink:href="119578_inline16.gif"/></alternatives></inline-formula>.</p></list-item>
<list-item><p>Determine the parameter(s) which maximize our composite likelihood estimates under a given model at a given location of the selected site (<italic>&#x2113;</italic>). We obtain these maximum composite likelihood estimate (MCLE) parameters by evaluating the composite likelihood across a grid of parameters for a given location of the selected site <inline-formula><alternatives><inline-graphic xlink:href="119578_inline17.gif"/></alternatives></inline-formula>.</p></list-item>
<list-item><p>Distinguish between modes of convergence, and neutrality, in a genomic region by comparing the maximum likelihood under various models of convergent evolution. At a given location of the selected site (<italic>&#x2113;</italic>) we compare the maximum composite likelihood of each model to the neutral model <inline-formula><alternatives><inline-graphic xlink:href="119578_inline18.gif"/></alternatives></inline-formula>.</p></list-item>
</list></p>
<p>This composite likelihood ignores the correlation in allele frequencies (linkage disequilibrium) between neutral sites so the composite likelihood surface will be too peaked. A number of authors have taken composite likelihood approaches to inferring a range of population genetic parameters (e.g. <xref ref-type="bibr" rid="c20">Hudson (2001)</xref>; see <xref ref-type="bibr" rid="c31">Larribe and Fearnhead (2011)</xref>; <xref ref-type="bibr" rid="c61">Varin et al. (2011)</xref> for a broader statistical views on composite likelihood). In the setting of inferring genome-wide parameters, e.g. parameters of neutral demographic models, the maximum composite likelihood parameter estimates are known to be consistent in the limit of many unlinked genomic regions (<xref ref-type="bibr" rid="c64">Wiuf, 2006</xref>). While in general composite likelihood methods perform well, in all of these settings typical measures of uncertainty of parameters (confidence intervals) and model choice methods (e.g. AIC) are undermined due to the over peakiness of the likelihood.</p>
<p>Composite likelihood approaches have also been used in the context of selective sweeps, starting with <xref ref-type="bibr" rid="c29">Kim and Stephan (2002)</xref> who take a composite likelihood formed like <xref ref-type="disp-formula" rid="eqn17">Equation 17</xref> of the product of marginal probabilities of allele frequencies within a single population moving away from a proposed selected site (an approach expanded on by <xref ref-type="bibr" rid="c28">Kim and Nielsen, 2004</xref>; <xref ref-type="bibr" rid="c42">Nielsen et al., 2005</xref>; <xref ref-type="bibr" rid="c9">Chen et al., 2010</xref>; <xref ref-type="bibr" rid="c12">DeGiorgio et al., 2014</xref>; <xref ref-type="bibr" rid="c48">Racimo, 2016</xref>). Our method is most closely related to that of <xref ref-type="bibr" rid="c9">Chen et al. (2010)</xref> and <xref ref-type="bibr" rid="c48">Racimo (2016)</xref> who look at allele frequencies across two or three populations respectively, and look for the signal of a sweep in one of the populations (or in the case of <xref ref-type="bibr" rid="c48">Racimo, 2016</xref>, in the ancestor of a pair of populations). We note that we have a further layer of abstraction over these previous composite likelihood methods. Extending <xref ref-type="bibr" rid="c29">Kim and Stephan (2002)</xref>, previous methods have calculated the likelihood of the sample frequency considering a binomial draw from some underlying population frequency, which is naturally modeled as being bounded between 0 and 1. We, however, use a multivariate normal likelihood to model our sample frequencies, which does not bound allele frequencies between 0 and 1. This further abstraction is justified by the fact that by using the multivariate normal approach we are able to handle arbitrarily large number of populations with arbitrary population structure and to flexibly model different forms of selection into an easily extendable form to the covariance matrix. Future work could potentially concentrate on hybrid approaches, combining the flexibility of our approach with the realism of previous approaches.</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Inference method on simulated data</title>
<p>To test our method, we utilized the datasets generated using mssel (as discussed above with details in <xref ref-type="sec" rid="app1b">Appendix A.2</xref>) to see if we could recover the parameters and convergent mode used for simulation. The neutral coancestry matrix <bold>F</bold> was estimated using data from 1000 runs with no selection (as described in <xref ref-type="sec" rid="app1a">Appendix A.1</xref>). We assume that the model parameters <italic>N<sub>e</sub></italic> and <italic>r</italic> are known and we set these at the values used to generate the simulations. We calculated the composite log-likelihoods for each of the simulated datasets under the following four models: neutral (no selection), independent sweep model, standing variation model, and migration model with the beneficial allele originating in population 2. We calculate the likelihoods under a dense grid of selection coefficients (<italic>s</italic>), migration rates (<italic>m</italic>), and standing times (<italic>t</italic>). In the standing variation model, the standing frequency (<italic>g</italic>) is held at 0.001. See <xref ref-type="sec" rid="app1b4">Appendices A.2.4</xref> and <xref ref-type="sec" rid="app1b5">A.2.5</xref> for details. We repeat this procedure for each of 100 runs of all simulated datasets. To compare between models, we calculate the composite log-likelihood differences between the true model and all other models including the neutral model, at the maximum composite likelihood parameter estimate (MCLE) obtained under each model.</p>
<sec id="s3b1">
<label>3.2.1</label>
<title>Parameter estimation</title>
<sec id="s3b1a">
<title>Location of selected site</title>
<p>To explore our method&#x2019;s ability to localize the selected site, we vary the true location of the selected site simulating under the independent mutation model. We estimate the maximum composite likelihood location under the independent sweep model over a fine grid of locations and selection coefficients. The method is able to correctly identify the location of selection (<xref ref-type="fig" rid="fig4">Figure 4a)</xref>, with higher accuracy when the true location of the site is in the middle of the window. The method does show an edge effect when the true location of the selected site is at the edge of the region of interest perhaps because we do not get to see the decay of coancestry on both sides of the selected site. Additionally, we are able to correctly estimate the strength of selection while allowing the location of the selected site to vary (<xref ref-type="fig" rid="figS1">Figure S1a</xref>) and there is no correlation between these joint parameter MLCEs (<xref ref-type="fig" rid="figS1">Figure S1b</xref>).</p>
</sec>
<sec id="s3b1b">
<title>Independent mutations model</title>
<p>To verify our ability to recover the selection coefficient, we simulated under the independent mutation model for a range of values for s, holding the location of the selected site at its true value. We are able to recover the parameters used for simulation (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). The ability to correctly estimate s breaks down for large enough s, given a fixed window-size around the selected site and <italic>r<sub>BP</sub></italic>, since we will not observe the full decay in coancestry.</p>
</sec>
<sec id="s3b1c">
<title>Standing variant model</title>
<p>To explore our inference using the standing variant model, we hold the location of the selected site at its true location and take as our estimate of <italic>s</italic> and <italic>t</italic> their values at the joint maximum composite likelihood. Under the standing variant model, we are again able to accurately estimate <italic>s</italic> (<xref ref-type="fig" rid="figS6">Figure S6</xref>). The inference of <italic>s</italic> and <italic>g</italic> simultaneously is somewhat more confounded (<xref ref-type="fig" rid="fig5">Figure 5</xref>). How the signal of the sweep within populations decays, as we move away from the selected site, is primarily determined by <italic>s</italic> and <italic>g</italic> (see <xref ref-type="disp-formula" rid="eqn7">Equation 7</xref>). While a higher frequency of the standing variant (<italic>g</italic>) can lead to a quicker decay, this can be partially compensated for the strength of the sweep being stronger (higher <italic>s</italic>, lower <italic>t<sub>s</sub></italic>). This explains the <italic>J</italic>-shaped ridge in the likelihood surfaces for <italic>s</italic> and <italic>g</italic>, seen in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Therefore, in practice we can often infer a lower bound <italic>s</italic> and an upper bound for <italic>g</italic>, but not find the precise values of each when inference is performed under the standing variation model. We are able to accurately estimate the time the beneficial allele has been standing in the independent populations prior to selection, <italic>t</italic>, as shown in <xref ref-type="fig" rid="fig4">Figure 4c</xref>. Our inference of <italic>t</italic> is relatively free of confounding with <italic>s</italic> and <italic>g</italic>, as <italic>t</italic> primarily governs the decays in coancestry between populations, making it separable from the scale of the sweep within populations.</p>
</sec>
<sec id="s3b1d">
<title>Migration model</title>
<p>We explored our inference under the migration model of parameters <italic>m</italic> and <italic>s</italic>, again fixing the location of the selected site and taking the joint maximum composite likelihood estimate. We are able to correctly estimate <italic>s</italic> (<xref ref-type="fig" rid="figS4">Figure S4b</xref>). However, we obtain poor estimates of the rate of migration, <italic>m</italic> (<xref ref-type="fig" rid="figS4">Figure S4a</xref>). This is perhaps unsurprising as the coancestry coefficients under the migration model depend only weakly on <italic>m</italic>. We obtain fairly bimodal estimates of <italic>m</italic> that are usually either very low (10<sup>&#x2212;5</sup> to 10<sup>&#x2212;3</sup>) or high (1). As the true value of <italic>m</italic> increases, we see fewer estimates of small <italic>m</italic> and more estimates of <italic>m</italic> &#x003D; 1. These estimates of <italic>m</italic> seem to be a true reflection of the patterns in the simulated datasets. Specifically, this effect is mostly observed in the variance within the recipient population as <xref ref-type="disp-formula" rid="eqn12">Equation 12</xref> depends on <italic>m</italic> in both <italic>Q</italic> and <italic>&#x03B4;</italic>. High <italic>m</italic> estimates correspond to datasets with lower empirical levels of coancestry within the recipient than datasets where low estimates of <italic>m</italic> were obtained (<xref ref-type="fig" rid="figS5">Figure S5</xref>). We believe that the bimodality results from stochasicity in how many lineages ancestral to the sample migrate before they recombine off the sweep in the recipient population. While our estimates of <italic>m</italic> are noisy, the migration model does capture key features of the spread of adaptive alleles by migration, allowing it potentially to be distinguished from other modes of convergence. We now turn to the performance of the method in distinguishing modes of convergence.</p>
</sec>
</sec>
</sec>
<sec id="s3b2">
<label>3.2.2</label>
<title>Model comparison</title>
<p>To test the ability of our method to distinguish between modes of convergence, we calculated the maximum composite log-likelihood of 100 simulations for each dataset generated under both the true model and all other models with a fixed, fine grid of parameter values. The location of the selected site is fixed at its true location. The results are summarized in <xref ref-type="fig" rid="fig6">Figure 6</xref>, which shows histograms of the difference in maximum composite log-likelihoods calculated under a given model relative to the true model used for simulation. For example, in evaluating the independent mutations model, we present the difference in the composite log-likelihoods calculated for data simulated under the independent mutations model for all other models and the composite log-likelihood calculated for the true independent mutations model. Thus, values less than zero indicate that the correct model has a higher maximum composite log-likelihood than the true model. Conversely, values greater than zero indicate the incorrect model of convergence has a higher composite log-likelihood than the true model. For inference under the migration model, we fix the source to be the true source of the selected allele when simulating under the migration model, and to an arbitrary one of the two selected populations when performing inference on simulations under other models.</p>
<sec id="s3b2a">
<title>Neutral model</title>
<p>We first compare the composite likelihoods calculated for data generated with no selection. For the selection models, we fix the location of the selected site. The distributions of the resulting composite log-likelihood ratios are shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref>. As expected for a composite likelihood, the composite log-likelihood ratio between a convergent selection model and the neutral model with no selection are inflated compared to those expected under the usual asymptotic &#x03C7;<sup>2</sup> distribution. However, these likelihood ratio differences are relatively small compared to those we observed when simulating under alternative models. This is because when <italic>s</italic> &#x2192; 0 in all models with selection, the coancestries converge to our neutral expectations. Indeed when we look at the MCLE for the strength of selection (<italic>&#x015D;</italic>) under the incorrect models with selection, we see that for all nearly simulations <italic>s</italic> is close to zero 0 (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). Overall, this suggests that our null model is reasonably well calibrated, given the limitations of composite likelihood schemes.</p>
</sec>
<sec id="s3b2b">
<title>Independent mutations model</title>
<p>As shown in <xref ref-type="fig" rid="fig6">Figure 6b</xref>, we are able to correctly distinguish between a neutral model of no selection and the true independent mutation model by at least 160 composite log-likelihood units even for relatively weak selection (<italic>s</italic> &#x003D; 0.005). This difference increases as the true value of <italic>s</italic> increases. This same relationship is true when comparing the migration model to the true independent mutation model. Therefore, we have good ability to distinguish the independent sweeps model from neutral and migration model over a range of selection coefficients.</p>
<p>Our ability to distinguish between the standing variation model and the true independent mutation model is less clear. When the true <italic>s</italic> is small, the two models have comparable composite log-likelihoods, with differences ranging from -3 to 20. This difference decreases, with higher likelihood for the true independent mutation model more frequently, as <italic>s</italic> increases. This result makes sense when we look into the maximum likelihood estimate of the parameter <italic>t</italic> (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). We obtain estimates of <italic>t</italic> approaching our highest value on the grid (10<sup>6</sup>). Thus, we may not be able to distinguish between the cases where the origins of the beneficial allele are truly independent or whether selection has been on a single variant that has been standing independently for a long time as these two models converge for large <italic>t</italic>.</p>
</sec>
<sec id="s3b2c">
<title>Standing variant model</title>
<p>Simulating under the standing variation model, the picture is more complicated. Like the other models, we can exclude the neutral model, although note that this would become challenging when the allele has been standing at high frequencies, <italic>g</italic> &#x226B; 0 (<xref ref-type="bibr" rid="c5">Berg and Coop, 2015</xref>). When the independent standing time, <italic>t</italic>, is small, we see little difference in the composite log-likelihoods between the true standing model and the migration model. As <italic>t</italic> increases, we see a larger difference between these two models. However, as <italic>t</italic> increases, the composite log-likelihood difference between the independent mutation model and standing variation model tightens around 0. These results fit our expectations as we know the models look similar in the extreme values of <italic>t</italic>, the migration model when the standing time is small and independent mutation model when the standing time is large, respectively.</p>
</sec>
<sec id="s3b2d">
<title>Migration model</title>
<p>We are able to distinguish the migration model from the neutral and independent sweeps model. However, the standing variation and true migration model are again somewhat confounded. The values of the composite log-likelihood differences range from -44 to 123 when <italic>m</italic> &#x003D; 10<sup>&#x2212;4</sup> and this range narrows closer to 0 as <italic>m</italic> increases. These results fit our understanding when we again look at the MCLEs of <italic>t</italic> in the standing model. Now, the estimates are at <italic>t</italic> &#x003D; 0 (<xref ref-type="fig" rid="fig7">Figure 7c</xref>) indicating it is hard to distinguish between convergence that is due to migration or selection on a shared standing variant that has only been standing for a very short time, as they result in similar patterns in decay of coancestries.</p>
</sec>
<sec id="s3b2e">
<title>Summary</title>
<p>We can clearly distinguish the outcomes of the migration and independent sweeps models from each other. Both models are hard to distinguish from the standing variation case, but in very different regimes of the standing variation model. The estimated time the variant has been standing (<italic>t</italic>) for is a helpful indicator of the mode of convergence, with very low estimates meaning that the standing model is indistinguishable from the migration model, while very high estimates mean that the standing model is indistinguishable from the independent sweeps model. When data is simulated under the standing model with intermediate values of <italic>t</italic>, we can distinguish this from both independent sweeps and recent migration models. This is because an intermediate value of <italic>t</italic> generates a covariance pattern not well explained by either other model. Therefore, while comparing the maximum composite likelihoods between models is useful, the estimated value of <italic>t</italic> is useful in judging the different models.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Applications</title>
<sec id="s4a">
<label>4.1</label>
<title>Copper tolerance in <italic>Mimulus guttatus</italic></title>
<p>The study of adaptation to toxic mine tailings is a classic case of rapid local adaptation to human altered environments (<xref ref-type="bibr" rid="c35">MacNair et al., 1993</xref>). We apply our inference method to investigate the basis of the convergent adaptation seen between populations of the annual wildflower <italic>Mimulus guttatus</italic> to copper contaminated soils near Copperopolis, CA. <xref ref-type="bibr" rid="c66">Wright et al. (2015)</xref> sequenced pooled samples from 20-31 individuals from two mine and two off-mine populations from two distinct copper mines in close geographic proximity (all populations within 15 km of each other) to 34-72X genome-wide coverage for each population. They observed elevated genome-wide estimates of genetic differentiation between mine and off-mine populations (<italic>F<sub>ST</sub></italic> M/OM&#x003D; 0.07 and 0.14), with similar levels of differentiation between the mine populations (<italic>F<sub>ST</sub></italic> MM&#x003D; 0.13). Only a small number of regions had high levels of differentiation. Here, we focus on the region with the strongest signature of differentiation between the two mine/off-mine pairs found on Scaffold8 by <xref ref-type="bibr" rid="c66">Wright et al. (2015</xref>). They observed low genetic diversity within each mine population in this region compared to off-mine populations. When the mine populations are compared to each other, they have elevated differentiation in this region, except for in the center where they share a nearly identical core haplotype. This pattern suggests the sweeps may not have been independent within each mine population, and that the sweep is possibly shared either due to migration or selection of shared standing variation.</p>
<p>We estimate the <bold>F</bold> matrix using SNPs from twelve scaffolds that showed no strong signals of selection (shown in <xref ref-type="table" rid="tblS6">Table S6</xref>). Using all SNPs in the 169.3 kb Scaffold8, we apply our inference framework to both identify the locus under selection and distinguish between modes of convergence between the two mine populations. We move the proposed selected site along this scaffold and calculate the composite likelihood under our three modes of convergent adaptation: (1) both mine populations have had independent mutations at the same locus, (2) the beneficial allele was standing in the ancestor of the two mine populations and selection occurred independently once the mine populations were isolated, and (3) the beneficial allele arose in one of the mine populations and spread to the other via migration. We estimate the maximum composite likelihood over a dense grid of parameters used to specify these models (<xref ref-type="table" rid="tblS7">Table S7</xref>). For the migration model, we allow both adapted populations to be possible sources. We use an <italic>N<sub>e</sub></italic> &#x003D; 7.5 &#x00D7; 10<sup>5</sup>, calculated from the observed pairwise diversity <italic>&#x03C0;</italic> &#x003D; 4<italic>N<sub>e</sub>&#x03BC;</italic> using a mutation rate of <italic>&#x03BC;</italic> &#x003D; 1.5 &#x00D7; 10<sup>&#x2212;8</sup> and <italic>r<sub>BP</sub></italic> &#x003D; 4.72 &#x00D7; 10<sup>&#x2212;8</sup> (<xref ref-type="bibr" rid="c32">Lee, 2009</xref>).</p>
<p>In <xref ref-type="fig" rid="fig8">Figure 8a</xref>, we summarize the results, showing the difference in maximum composite log-likelihoods between a given model of convergence and the neutral model of no selection as a function of the proposed selected sites along the scaffold. We see the three likelihoods peaking when the selected site is approximately at position 302665-308504 and that the model with the highest likelihood is selection on shared ancestral standing variation. Focusing on this model at the most likely selected site, we can obtain parameter estimates for the strength of selection (<italic>s</italic>), standing frequency of the beneficial allele (<italic>g</italic>), and the amount of time that the beneficial allele has been standing in both mine populations after they have been isolated but prior to selection (<italic>t</italic>). This time also has the interpretation of the minimum age of the standing variant as it has been standing for at least this amount of time and potentially longer in the ancestral population. We see the maximum composite log-likelihood is obtained when this time is approximately 430 generations (<xref ref-type="fig" rid="fig8">Figure 8b</xref>). As copper mining started in 1861 in this region (Aubury 1908), this suggests the tolerance allele was present prior to the onset of mining. The strength of selection and starting frequency of the allele are confounded (<xref ref-type="fig" rid="fig8">Figure 8c</xref>) as expected. Our maximum composite log-likelihood parameter estimates suggest selection was relatively strong (&#x003E;0.02) and the allele was not standing at very high frequencies (&#x003C; 10<sup>&#x2212;3</sup>) when selection began.</p>
<p>We also ran the standing variation model with one of the two copper-mines as the source (as detailed in <xref ref-type="sec" rid="app1c">Appendix A.3</xref>). The standing variant likelihood surfaces, over selected sites, using either copper population were identical to the case of the standing variant model with no source (see <xref ref-type="fig" rid="figS7">Figure S7a</xref>). Therefore, there is little information about the source of the standing variant. This is perhaps unsurprising as there is relatively little hierarchical structure among the populations. The composite maximum likelihood estimate of <italic>t</italic> is higher for the models of standing variation with a source, than the simple model of standing variation (see <xref ref-type="fig" rid="figS7">Figure S7b</xref>). This is likely because making one of the populations a source of the standing variant increases the covariance around the selected site among the selected populations, as described in <xref ref-type="sec" rid="app1c">Appendix A.3</xref>, and so the model compensates by increasing the rate of decay of this covariance.</p>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Industrial pollutant tolerance in <italic>Fundulus heteroclitus</italic></title>
<p>We demonstrate how our method can be extended to more complex population scenarios. Populations of the Atlantic killifish, <italic>Fundulus heteroclitus</italic>, have repeatedly adapted to typically lethal levels of industrial pollutants (<xref ref-type="bibr" rid="c39">Nacci et al., 1999</xref>, <xref ref-type="bibr" rid="c40">2010</xref>). <xref ref-type="bibr" rid="c50">Reid et al. (2016)</xref> have sequenced 43-50 individuals from four pairs of pollutant-tolerant and sensitive populations along the U.S. Atlantic coast (see <xref ref-type="fig" rid="fig9">Figure 9a</xref>), sequencing each individual to 0.6-7X depth. The southern pair of populations form a distinct clade relative to the northern populations, consistent with a phylogeographic break centered on New Jersey (<xref ref-type="bibr" rid="c13">Duvernell et al., 2008</xref>).</p>
<p><xref ref-type="bibr" rid="c50">Reid et al. (2016)</xref> found that a number of the strongest signals of recent selection are shared between all tolerant populations, suggesting genotypic convergent adaptation. We focus our method on their strongest signal of selection, Scaffold9893 (GPS_009145616.1, the scaffold containing the AIP gene), where all four pairs of tolerant/sensitive populations sampled show high levels of differentiation. Here, we test the hypotheses that all four tolerant populations show convergent adaptation due to our three previous modes of independent mutation, migration, or selection on shared ancestral variation. For our standing variation model, we specified the source of the standing variant (as described in <xref ref-type="sec" rid="app1c">Appendix A.3</xref>). We also test the hypotheses that there is an independent mutation in the southern tolerant population while the three northern populations are sharing a sweep at this locus, either due to migration between populations or selection on variation present in the ancestor of the Northern populations. This latter set of hypotheses is consistent with the fact that <xref ref-type="bibr" rid="c50">Reid et al. (2016)</xref> detect a shared haplotype in the three northern tolerant populations while a different haplotype appears to have swept in the southern tolerant population. We estimated the <bold>F</bold> matrix from four scaffolds that show no strong signal of selection, and it is shown in <xref ref-type="table" rid="tblS8">Table S8</xref>. We use <italic>N<sub>e</sub></italic> &#x003D; 8.3 &#x00D7; 10<sup>6</sup> and <italic>r<sub>BP</sub></italic> &#x003D; 2.17 &#x00D7; 10<sup>&#x2212;8</sup> (N. Reid personal communication).</p>
<p>The results are summarized in 9b. For the models where all four tolerant populations share the selected allele by either migration or standing variation, we plot the maximum composite log-ikelihood for the most likely source at each location of the selected site (to reduce the number of lines plotted, see <xref ref-type="fig" rid="figS8">Figure S8</xref> for the full figure). We see the model with the highest composite log-likelihood is when convergence is due to selection on shared standing variation in the North and an independent mutation in the southern tolerant population. This occurs when the selected site is at approximately position 1960000 on the scaffold. This model has the highest composite log-likelihood when the source population of the standing variant is T3, southernmost population sampled in the North (composite log-likelihood &#x003D; 547060), but this model may not be distinguishable from that where the source is T2 (545580). Under this model, we obtain the maximum composite log-likelihood estimate of the minimum age of the standing variant, t, of eight generations (<xref ref-type="fig" rid="fig10">Figure 10a</xref>). This implies the beneficial allele has been standing for a negligible time independently in the northern populations prior to selection or that migration is assisting the spread of this allele as both scenarios lead to similar decays in shared coancestry as we move away from the selected site. Lastly, again, we see partial confounding of the strength of selection and the frequency of the standing variant (<xref ref-type="fig" rid="fig10">Figure 10b</xref>) but our results indicate selection has been very strong (&#x003E;0.3) and the allele was initially at a very low frequency (&#x003C; 10<sup>&#x2212;6</sup>).</p>
</sec>
</sec>
<sec id="s5">
<label>5</label>
<title>Discussion</title>
<p>In this paper we have presented a novel approach to identify the loci involved in convergent adaptation and to distinguish among the three ways genotypic convergence can arise: selection on (1) independent mutations, (2) standing variation present in the ancestor of the selected populations, and (3) beneficial alleles introduced via migration. We leverage the effects selection has on linked neutral sites via a coalescent-based model approach that captures many of the heuristics that have been used in previous studies. This approach also allow us to potentially distinguish between more subtle models, such as the origin and the direction of gene flow of a beneficial allele, since they are explicitly modeled in our framework. Our approach takes advantage of information among all of the population samples simultaneously while accounting for population structure. Therefore, it naturally accommodates information from across multiple samples, rather than just pairs of populations, and thus offers a number of advantages in identifying the mode of convergence over other approaches. We provide the relevant R code for our approach in <ext-link ext-link-type="uri" xlink:href="https://github.com/kristinmlee/dmc">https://github.com/kristinmlee/dmc</ext-link>.</p>
</sec>
<sec id="s5a">
<title>Distinguishing among models</title>
<p>We have demonstrated that our method is able to accurately distinguish among modes of convergent adaptation, across a relatively wide parameter space, in simulated data. However, we do see some confounding of models in particular regions of parameter space. In particular, we see the patterns generated from a model of selection on ancestral standing variation can look like our expectations for the other two modes of convergent adaptation for extreme values of the parameter <italic>t</italic>, the time the beneficial allele has been standing time independent in the selected populations. When <italic>t</italic> is small, we see confounding between the standing model and a model of convergence due to gene flow. The two models are very similar since in our standing variation model, as <italic>t</italic> &#x2192; 0, the covariance in the deviations of a neutral allele between selected populations approaches the variance within a selected population (the strong overlap in models is especially true when we have a source for the standing variant). Intuitively this indicates that the beneficial allele is on a haplotype that is mostly shared among the selected populations. This can be due to a very young standing variant shared amongst very closely-related populations from an ancestral population, a standing variant that was shared by gene flow before selection, or by the selected haplotype quickly moving across populations by gene flow after selection began (which are all closely related models, see <xref ref-type="bibr" rid="c63">Welch and Jiggins, 2014</xref>, for additional discussion).</p>
<p>To illustrate distinguishing between these possibilities we now revisit our applications. The Northern tolerant killifish populations, under a standing variation model, have a very low estimate of <italic>t</italic>. We can likely rule out the sweep occurring in an ancestor of the tolerant Northern populations, as both T1 and T2 are sister populations to different sensitive populations. We note that in cases where two populations that are sister share a sweep, we can extend our models to test if the sweep is ancestral or truly convergent. Furthermore, given the very low estimate of <italic>t</italic> the allele cannot have been standing since the common ancestral population of T1, T2, T3. Therefore, the allele must be shared by gene flow among the three populations and it seems likely that the migration of the allele occurred either after selection began in one of the populations or very shortly before. Interestedly, however, they find no other signals of admixture from migration elsewhere in the genome between Northern tolerant populations. The case for adaptation from ancestral standing variation is clearer for the <italic>Mimulus</italic> copper tolerance example. Here, the estimate of <italic>t</italic> is much greater than zero and indeed older than the putative selection pressure. Additionally, the standing variant model considerably outperforms the migration model (<xref ref-type="fig" rid="fig8">Figure 8a</xref>). That said, given that the level of neutral differentiation of the mine populations very likely reflects much more than 430 generations of drift, it seems likely that this allele is shared between the mine populations by gene flow but that the allele was standing in both populations for some time before selection began (as described by the standing model with a source model, see <xref ref-type="sec" rid="app1c">Appendix A.3</xref> and <xref ref-type="fig" rid="figS7">Figure S7a</xref>). Thus, distinguishing among these models is possible in some cases, but may require extra knowledge of population history.</p>
<p>Conversely, when <italic>t</italic> is large, we see a collapse of our standing model onto a model of convergence due to independent mutations in our selected populations. This intuition holds forwards in time since as <italic>t</italic> &#x2192; &#x221E; generations, recombination in our isolated populations independently breaks down the similarity of the haplotypes carrying the beneficial mutation. Thus, when selection for the standing variant begins, even tightly-linked, hitchhiking neutral alleles will not be shared between populations more than expected by chance. This is also the case when beneficial alleles arise multiple times independently. For example, in the case of the killifish, it is formally possible that the signal of independent selection in the Southern tolerant population is actually due to a very old standing variant shared with the Northern populations where there is almost no overlap between the Southern and Northern tolerant populations in the haplotype the selected allele is present on, even close to the selected site. As the precise functional variant(s) in this swept region are currently unknown (<xref ref-type="bibr" rid="c50">Reid et al., 2016</xref>) it is hard to totally rule out this very old standing variant hypothesis. In other cases it may be possible to rule out the standing variant hypothesis with very large parameter estimates of <italic>t</italic> if we know more about the population histories (i.e. our selected populations split more recently than the standing time). Additionally, it may be possible to totally rule out the standing variant hypothesis in cases where if the functional variants can be tracked down to clearly independent genetic changes (e.g. <xref ref-type="bibr" rid="c59">Tishkoff et al., 2007</xref>). However that degree of certainty may be difficult to achieve in many cases.</p>
</sec>
<sec id="s5b">
<title>Extendibility and flexibility of our approach</title>
<p>We show the applicability of our method on two empirical examples of convergent adaptation: the evolution of copper tolerance in <italic>Mimulus guttatus</italic> and of pollutant tolerance in <italic>Fundulus heteroclitus</italic>. The latter exemplifies the extendibility and flexibility of our approach. As the number of selected populations increase, our potential number of hypotheses grows since any grouping of two or more populations could share selection due to migration or standing variation. Additionally, with more populations, we have more potential sources of the beneficial allele in the migration model. Our model could also be extended to have selection occurring in some of the adapted populations and the neutral model in others, to identify genomic regions that are not experiencing convergent adaptation among all populations sharing the selected environment. These models are all relatively easy to implement into our framework; however, the sheer number of possible hypotheses as the number of populations grows will likely call for some more systematic way of implementing these models and exploring their relationships.</p>
</sec>
<sec id="s5c">
<title>Caveats and possible extensions</title>
<p>Studying repeated evolution has long played a key role in evolutionary biology as a tool to help identify the ecological and molecular basis of adaptation. It is worth noting with this approach, we are able to identify sweeps in the same region and whether they appear to be shared or independent. However, in the scale of an entire genome, it may be possible for two, unrelated sweeps to overlap. In the case of adaptation via independent mutations across multiple populations, it is especially hard to determine whether selection at the same site was acting on the same phenotype. It is potentially more plausible to claim that the phenotype and selection pressure are shared among populations in cases where the swept haplotype is shared. Ultimately, in demonstrating convergence, we will have to rely on a range of evidence. Shared sweeps can offer one substantial piece of evidence, particularly when we are studying recent adaptation to a strong selective pressure that is distinct to the adapted populations.</p>
<p>We assume a single selected change underlies the sweep within a population, and that recombination is free to break down associations between neutral alleles and this selected variant. If, for instance, selection acts on an epistatic, haplotypic combination of allele that sweeps, a long haplotype could be shared between populations not due to recent migration but because selection acts against recombinants breaking up the haplotype (<xref ref-type="bibr" rid="c26">Kelly and Wade, 2000</xref>). Convergent adaptations due to shared inversions also violate the assumptions of our method. Inversions can repress recombination across the entire inversion (see <xref ref-type="bibr" rid="c30">Kirkpatrick, 2010</xref>, for a recent review). Inversions significantly alter both neutral and selective model expectations (e.g. <xref ref-type="bibr" rid="c16">Guerrero et al., 2012</xref>) and could lead to long shared haplotypes among populations even if the shared inversion is old. It may be possible to use our approach to model the decay in coancestries outside of the inverted region, but this requires knowledge of the inversion and its break points <italic>a priori</italic> and a detailed knowledge of recombination rates surrounding the inversion.</p>
<p>Additionally, our framework could be extended in various ways to both leverage more information and model more biologically relevant or interesting scenarios. There is more information to be gained from haplotypes and associations between sites that we fail to include in our composite likelihood when we sum across information from individual sites. Additionally, models of migration that include selection against maladaptive migrants (<xref ref-type="bibr" rid="c4">Barton and Bengtsson, 1986</xref>; <xref ref-type="bibr" rid="c8">Charlesworth et al., 1997</xref>; <xref ref-type="bibr" rid="c51">Roesti et al., 2014</xref>) will be important to consider.</p>
<p>Finally, here we use this approach to analyze genomic regions that we <italic>a priori</italic> assume to be under convergent selection. We are currently working on ways to efficiently extend this approach to the application of genome-wide data to scan for genomic regions exhibiting convergence.</p>
</sec>
<sec id="s5d">
<title>Final thoughts</title>
<p>With the falling cost of population genomic sequencing, it is increasingly easier to obtain genome-wide polymorphism data from across many populations showing an adaptation to the same selective pressure. We hope that with the advent of these data in a wide range of systems and methods like those outlined here, we can gain insights into fundamental questions regarding the nature of adaptation and convergence.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We wish to thank members of the Coop lab for helpful discussion and feedback on earlier drafts. We&#x2019;d also like to gratefully acknowledge Noah Reid, Andrew Whitehead, John Willis, and Kevin Wright sharing their data and thoughtful comments. This work was supported by the NSF GRFP awarded to K. Lee (1148897) and by grants from the National Science Foundation under Grant No. 1353380 to John Willis and G. Coop and the National Institute of General Medical Sciences of the National Institutes of Health under award numbers NIH R01 GM108779 awarded to G. Coop.</p>
</ack>
<app-group>
<app id="app1">
<label>A</label>
<title>Appendix</title>
<sec id="app1a">
<label>A.1</label>
<title>Coalescent intepretation of covariances and F-matrix estimation</title>
<p>Let <italic>x<sub>il</sub></italic> be the allele frequency of allele 1 in population <italic>i</italic> at locus <italic>l</italic>, and that the frequency of this allele in the ancestral population is <italic>&#x03F5;<sub>l</sub></italic>. Consider the covariance Cov(&#x0394;<italic>x<sub>il</sub></italic>, &#x0394;<italic>x<sub>jl</sub></italic>) over replicates of the drift processes at locus <italic>l</italic>. We can write
<disp-formula id="eqnA1"><alternatives><graphic xlink:href="119578_eqnA1.gif"/></alternatives></disp-formula>
<disp-formula id="eqnA2"><alternatives><graphic xlink:href="119578_eqnA2.gif"/></alternatives></disp-formula> which follows from the fact that <inline-formula><alternatives><inline-graphic xlink:href="119578_inline19.gif"/></alternatives></inline-formula>. We can interpret <inline-formula><alternatives><inline-graphic xlink:href="119578_inline20.gif"/></alternatives></inline-formula> as the probability that we sample a single allele in <italic>i</italic> and an allele in <italic>j</italic> and that they both are of type 1. Taking that interpretation, assuming that there is no mutation, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline21.gif"/></alternatives></inline-formula> is the probability that, tracing back a coalescent lineage from <italic>i</italic> and a lineage from <italic>j</italic>, both lineages trace back to type 1 alleles in the ancestral population. Let our pair of lineages drawn from <italic>i</italic> and <italic>j</italic> coalesce with probability <italic>f<sub>ij</sub></italic>. If our lineages coalesce before reaching the ancestral population then they will be identical by descent, and share the ancestral choice of allele. Therefore, we can write
<disp-formula id="eqnA3"><alternatives><graphic xlink:href="119578_eqnA3.gif"/></alternatives></disp-formula></p>
<p>Then we can rewrite the covariance
<disp-formula id="eqnA4"><alternatives><graphic xlink:href="119578_eqnA4.gif"/></alternatives></disp-formula> and for the variance we set <italic>i</italic> &#x003D; <italic>j</italic>. Thus, under a model of genetic drift alone, we can intepret the entries of our covariance matrix as expressions of the underlying coalescent probabilities.</p>
<sec id="app1a1">
<title>Estimating F</title>
<p>In the main text we assume that we have estimates of our neutral coancestry matrix <bold>F</bold>. We now describe how we obtain these. From above, <xref ref-type="disp-formula" rid="eqnA3">Equation A.3</xref>, the expectation of <italic>x<sub>il</sub>x<sub>jl</sub></italic> across loci is
<disp-formula id="eqnA5"><alternatives><graphic xlink:href="119578_eqnA5.gif"/></alternatives></disp-formula></p>
<p>Therefore we can write estimate <italic>f<sub>ij</sub></italic> as
<disp-formula id="eqnA6"><alternatives><graphic xlink:href="119578_eqnA6.gif"/></alternatives></disp-formula></p>
<p>We can obtain an unbiased estimate of <inline-formula><alternatives><inline-graphic xlink:href="119578_inline22.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline23.gif"/></alternatives></inline-formula> using the sample allele frequencies from two populations on either side of the root of the population phylogeny (see Supplement of <xref ref-type="bibr" rid="c33">Lipson et al., 2013</xref>). Let <italic>i&#x2032;</italic> and <italic>j&#x2032;</italic> be a pair of populations that span the root of the population tree, then we can use the estimate
<disp-formula id="eqnA7"><alternatives><graphic xlink:href="119578_eqnA7.gif"/></alternatives></disp-formula></p>
<p>Likewise, we use the estimate
<disp-formula id="eqnA8"><alternatives><graphic xlink:href="119578_eqnA8.gif"/></alternatives></disp-formula></p>
<p>An estimate of the term <inline-formula><alternatives><inline-graphic xlink:href="119578_inline24.gif"/></alternatives></inline-formula> can be obtained by using the sample frequency of allele 1 in populations <italic>i</italic> and <italic>j</italic>. However, as we only have a sample from the population frequency we need to account for the finite sampling bias within populations (<italic>i</italic> &#x003D; <italic>j</italic>). Let <italic>n</italic> be the sample size in population <italic>i</italic>, then
<disp-formula id="eqnA9"><alternatives><graphic xlink:href="119578_eqnA9.gif"/></alternatives></disp-formula> where our <italic>x</italic> are now sample frequencies. There is no finite-sample size correction for <italic>f<sub>ij</sub>, i</italic> &#x2260; <italic>j</italic> and <xref ref-type="disp-formula" rid="eqnA6">Equation A.6</xref> can be used directly.</p>
<p>In our simulations to show the effect of selection on the coancestry coefficients (<xref ref-type="fig" rid="fig3">Figure 3</xref>), we estimate <italic>f<sub>ij</sub></italic> in bins of fixed genetic size moving away from the selected site. We do this by approximating the expectations in the numerator and denominators in <xref ref-type="disp-formula" rid="eqnA6">Equations A.6</xref> and <xref ref-type="disp-formula" rid="eqnA9">A.9</xref> by the average of the expression over all of the SNPs that fall in a given genetic distance bin over all of the relevant simulations. To account for biases induced by defining the allele of interest, we randomize the reference allele at each SNP.</p>
</sec>
</sec>
<sec id="app1b">
<label>A.2</label>
<title>Simulation implementation details</title>
<p>We perform coalescent simulations using mssel, a modified version of ms (<xref ref-type="bibr" rid="c21">Hudson, 2002</xref>) that allows for the incorporation of selection at single site (the code for this is provided in <ext-link ext-link-type="uri" xlink:href="https://github.com/kristinmlee/dmc">https://github.com/kristinmlee/dmc</ext-link>). The program allows the user to specify the frequency trajectory of the selected allele through time across populations, this trajectory is then used to simulate genetic data under the coalescent model conditioning on this trajectory (using the sub-divided coalescent model <xref ref-type="bibr" rid="c22">Hudson and Kaplan (1988)</xref>; <xref ref-type="bibr" rid="c24">Kaplan et al. (1991)</xref>). We generate stochastic trajectories for the selected allele across populations and describe the simulation process below. We simulate multiple instances of the stochastic trajectories and average our results across datasets generated for these trajectories. We focus on a set of four populations with relationships as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Populations 2 and 3 are adapted to a shared novel selection pressure and populations 1 and 4 are in the ancestral environment.</p>
<p>The original implementation of <monospace>mssel</monospace> assumes only a single origin of the selected allele, which occurs moving backward in time when the frequency of the derived allele goes to zero in the final population it segregates in. We modified the mssel source code directly to accommodate multiple origins of the selected allele as is necessary in the independent sweep model. We do so by allowing an independent origin of the selected allele in any population where the frequency of the derived selected allele goes to zero, if that population currently has a migration rate of zero to any other population containing the selected allele.</p>
<sec id="app1b1">
<label>A.2.1</label>
<title>Generating stochastic trajectories for the selected allele</title>
<p>We generate stochastic trajectories for the selected allele to be used as input for mssel to generate sequence data for given convergent adaptation scenarios. We simulate the allele frequency trajectory for the selected allele forward in time using a normal deviate approximation to the simulation the Wright-Fisher diffusion. Specifically, given the frequency of the beneficial allele at time <italic>t, X</italic>(<italic>t</italic>), we simulate its frequency at time <italic>t</italic> &#x002B; &#x0394;<italic>t</italic> according to
<disp-formula id="eqnA10"><alternatives><graphic xlink:href="119578_eqnA10.gif"/></alternatives></disp-formula> where <italic>&#x03BC;<sub>S</sub></italic>() and <italic>&#x03C3;</italic><sup>2</sup>() are the infinitesimal mean and variance of the Wright-Fisher diffusion. We set &#x0394;<italic>t</italic> &#x003D; 1/(2<italic>N</italic>), representing one Wright-Fisher generation on the diffusion time-scale (2<italic>N</italic> generations). We set <italic>X</italic>(0) &#x003D; <italic>g</italic>, the initial frequency of the beneficial allele. When selection starts from a new mutation, <italic>g</italic> &#x003D; 1/(2<italic>N</italic>).</p>
<p>For all our models, the infinitesimal variance is
<disp-formula id="eqnA11"><alternatives><graphic xlink:href="119578_eqnA11.gif"/></alternatives></disp-formula> representing the effect of genetic drift.</p>
<p>For populations not impacted by migration, we condition our trajectory on the beneficial allele going to fixation forward in time. To do this we use the conditional infinitesimal mean
<disp-formula id="eqnA12"><alternatives><graphic xlink:href="119578_eqnA12.gif"/></alternatives></disp-formula> (see <xref ref-type="bibr" rid="c47">Przeworski et al., 2005</xref>; <xref ref-type="bibr" rid="c5">Berg and Coop, 2015</xref>, for previous applications). We simulate this process forward in time till fixation is reached.</p>
<sec id="app1b1a">
<title>Migration model</title>
<p>In the case of our migration model, there is one way migration from population <italic>i</italic> into <italic>j</italic>. The trajectory of <italic>X<sub>i</sub></italic> is simulated first forwards in time, conditioning on fixation, using the above approach. We then simulate the frequency in population <italic>j</italic> starting from <italic>X<sub>j</sub></italic>(0) &#x003D; 0, with the infinitesimal mean
<disp-formula id="eqnA13"><alternatives><graphic xlink:href="119578_eqnA13.gif"/></alternatives></disp-formula> (expanded from <xref ref-type="bibr" rid="c14">Ewens, 2004</xref>). We simulate the process forward in time until the selected allele reaches fixation in both populations. The first population to reach fixation is held at frequency 1 until the other population fixes for the beneficial allele.</p>
</sec>
<sec id="app1b1b">
<title>Standing variation model</title>
<p>We define the standing variation trajectory as having three phases, the neutral phase, the standing phase, and the selected phase. To specify a trajectory in which the beneficial allele has been standing at frequency <italic>g</italic> for time <italic>t</italic>, we simply hold the allele frequency constant for this amount of time. We simulate a stochastic neutral trajectory of our beneficial allele from frequency <italic>g</italic> to 0 backwards in time according to
<disp-formula id="eqnA14"><alternatives><graphic xlink:href="119578_eqnA14.gif"/></alternatives></disp-formula> using the infinitismal mean conditional of the neutral allele going to loss
<disp-formula id="eqnA15"><alternatives><graphic xlink:href="119578_eqnA15.gif"/></alternatives></disp-formula> (see <xref ref-type="bibr" rid="c47">Przeworski et al., 2005</xref>; <xref ref-type="bibr" rid="c5">Berg and Coop, 2015</xref>, for previous applications). We simulate the selection phase forward in time for 2 log(1/<italic>g</italic>)/<italic>s</italic> generations. If the beneficial allele has reached fixation before this time, it is held constant at frequency 1 for the remaining time. If not, the trajectory is simply stopped at this time. This allows for the interpretation of the standing time and the time of the onset of selection to be the same throughout simulations. For the whole trajectory of a beneficial allele, we paste together these three components: neutral increase of allele from frequency 0 to <italic>g</italic>, the standing phase at frequency <italic>g</italic> for time <italic>t</italic> generations, and the selective phase. For populations not experiencing selection, the beneficial allele is kept at frequency <italic>g</italic> for the entire length of the trajectory.</p>
</sec>
</sec>
</sec>
<sec id="app1b2">
<label>A.2.2</label>
<title>Details of coalescent simulations</title>
<p>In this section we give the details of the coalescent simulations, including the mssel command lines. The mssel input can be interpreted as follows,
<preformat preformat-type="dialog">
./mssel nsam_tot nreps nsam_anc nsam_der trajFile locSelSite -t <italic>&#x03B8;</italic> -r <italic>&#x03C1;</italic> nsites
        -I npops nAnc_pop1 nDerv_pop1 &#x2026; nAnc_popi nDerv_popi
</preformat></p>
<p>For all of the simulations we generate neutral allele frequency data for 10 samples from each of 4 populations. The populations are related to each other as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Note, we did 1000 replications of the simulations for parameters used to generate comparisons of average simulations coancestry coefficients compared to theoretical expectations. 100 replications were done for simulations used for parameter estimates and model comparisons. For simulations used for both, the first 100 runs were used.</p>
<sec id="app1b2a">
<title>Independent sweep model</title>
<p>We generated beneficial allele frequency trajectories under four different selection coefficients: <italic>s</italic> &#x003D; [0.005, 0.01, 0.05, 0.1] under the independent sweep model with <italic>N<sub>e</sub></italic> &#x003D; 100, 000. We set <italic>r</italic>, the per generation probability of cross-over between ends of the simulated locus, to 0.005. The neutral mutation rate, <italic>&#x03BC;</italic>, for the entire locus is the same as <italic>r</italic>. mssel input for all independent sweep model is of the following form with different trajectory files for each <italic>s</italic>,
<preformat preformat-type="dialog">
./mssel 40 1000 20 20 ind_sel0.1_stochastic.traj 0 -t 2000 -r 2000 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.05 3 4 -ej 0.05 2 1 -ej 0.07 4 1
</preformat></p>
<p>We also simulate the same population structure with no selection to generate data to estimate the neutral coancestry matrix, <bold>F</bold>, using ms as follows
<preformat preformat-type="dialog">
./ms 40 1000 -t 200 -r 2000 1000 -I 4 10 10 10 10 -ej 0.05 3 4 -ej 0.05 2 1 -ej 0.07 4 1
</preformat></p>
</sec>
<sec id="app1b2b">
<title>Standing variation model</title>
<p>With <italic>s</italic> &#x003D; 0.01 and <italic>g</italic> &#x003D; 0.001, we generated beneficial allele frequency trajectories for standing times <italic>t</italic> &#x003D; [50, 250, 500, 1000, 5000] generations under the standing variation model with <italic>N<sub>e</sub></italic> &#x003D; 10, 000. Our <italic>t</italic> references the time that the populations have been independent. Therefore, we adjusted the split times to ensure that the <italic>t</italic> of interest corresponded to the duration of time that the selected populations had the standing variant prior the populations joining in the ancestral population. The population split times were determined to ensure selection started after the populations were completely isolated and to maintain a similar ratio of time for 4 independent populations to 2 ancestral populations. We again set <italic>r</italic> &#x003D; <italic>&#x03BC;</italic> &#x003D; 0.005. The ms input was as follows,
<preformat preformat-type="dialog">
./mssel 40 1000 20 20 sv_sel0.01_g0.001_t50_stochastic.traj 0 -t 200 -r 120 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.0346 2 1 -ej 0.0346 3 4 -ej 0.03575 4 1
./mssel 40 100 20 20 sv_sel0.01_g0.001_t250_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.039 3 4 -ej 0.039 2 1 -ej 0.0408 4 1
./mssel 40 1000 20 20 sv_sel0.01_g0.001_t500_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.04 2 1 -ej 0.04 3 4 -ej 0.047 4 1
./mssel 40 100 20 20 sv_sel0.01_g0.001_t1000_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.04 3 4 -ej 0.04 2 1 -ej 0.0595 4 1
./mssel 40 1000 20 20 sv_sel0.01_g0.001_t5000_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.135 2 1 -ej 0.135 3 4 -ej 0.1595 4 1
</preformat></p>
<p>We also simulated under two additional selection coefficients, <italic>s</italic> &#x003D; [0.001, 0.05], keeping <italic>t</italic> &#x003D; 500 and <italic>g</italic> &#x003D; 0.001.
<preformat preformat-type="dialog">
./mssel 40 100 20 20 sv_sel0.001_g0.0 01_t500_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.3455 3 4 -ej 0.3455 2 1 -ej 0.3578 4 1
./mssel 40 100 20 20 sv_sel0.05_g0.001_t500_Ne1000 0_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.00695 3 4 -ej 0.00695 2 1 -ej 0.01935 4 1
</preformat></p>
<p>Again, neutral regions were simulated in ms using the same population structure (i.e. each parameter set had its own neutral data generated).</p>
</sec>
<sec id="app1b2c">
<title>Migration model</title>
<p>Lastly, we simulated under the migration model with <italic>m</italic> &#x003D; [0.0001, 0.001, 0.01, 0.1], holding <italic>s</italic> &#x003D; 0.01 for <italic>N<sub>e</sub></italic> &#x003D; 10, 000. Again, we simulated 10 samples from 4 populations related to each other as specified in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Now, in mssel, we specify migration to start just prior to origin of the beneficial allele in the source population. We set population 2 to be the source and have 4<italic>N<sub>e</sub>m</italic> migrants from population 2 into population 3 each generation. We again set <italic>r</italic> &#x003D; <italic>&#x03BC;</italic> &#x003D; 0.005. Thus,
<preformat preformat-type="dialog">
./mssel 40 1000 20 20 mig_sel0.01_mig1e-04_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.07 2 1 -ej 0.07 3 4 -ej 0.1 4 1
        -em 0.059 3 2 0 -em 0 3 2 4
./mssel 40 1000 20 20 mig_sel0.01_mig0.001_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.07 2 1 -ej 0.07 3 4 -ej 0.1 4 1
        -em 0.059 3 2 0 -em 0 3 2 40
./mssel 40 1000 20 20 mig_sel0.01_mig0.01_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.07 2 1 -ej 0.07 3 4 -ej 0.1 4 1
        -em 0.059 3 2 0 -em 0 3 2 400
./mssel 40 1000 20 20 mig_sel0.01_mig0.1_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.07 2 1 -ej 0.07 3 4 -ej 0.1 4 1
        -em 0.059 3 2 0 -em 0 3 2 4000
</preformat></p>
<p>We also simulated under two additional selection coefficients, <italic>s</italic> &#x003D; [0.005, 0.05], keeping <italic>m</italic> &#x003D; 0.001.
<preformat preformat-type="dialog">
./mssel 40 100 20 20 mig_sel0.05_mig0.001_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.021 2 1 -ej 0.021 3 4 -ej 0.03 4 1
        -em 0.014 3 2 0 -em 0 3 2 40
./mssel 40 100 20 20 mig_sel0.005_mig0.001_stochastic.traj 0 -t 200 -r 200 10000
        -I 4 10 0 0 10 0 10 10 0 -ej 0.12 2 1 -ej 0.12 3 4 -ej 0.17 4 1
        -em 0.11 3 2 0 -em 0 3 2 40
</preformat></p>
<p>Neutral regions were again simulated using ms. Each set of parameters has its own neutral data generated as the migration rate impacts neutral coancestry as well.</p>
</sec>
</sec>
<sec id="app1b3">
<label>A.2.3</label>
<title>Interpretating mssel output</title>
<p>The output from mssel and ms is in the form of haplotypes for each of the sampled chromosomes at polymorphic sites in addition to their positions on a scale of (0, 1). We use this to calculate sample allele frequencies at each site for each population. Prior to performing further estimations or analyses with these neutral allele frequencies, we randomize the reference allele so that there is no bias resulting from which allele was called ancestral or derived. We exclude sites where the average allele frequencies across populations are less than 5&#x0025; or greater than 95&#x0025;.</p>
</sec>
<sec id="app1b4">
<label>A.2.4</label>
<title>Composite likelihoods of simulated data under all models details</title>
<p>We calculated the composite log-likelihoods of each the simulated datasets under all models, including the neutral model, with the same parameter space shown in <xref ref-type="table" rid="tblS1">Table S1</xref>.</p>
</sec>
<sec id="app1b5">
<label>A.2.5</label>
<title>Maximum likelihood estimate of parameters from simulated data under correct model</title>
<p>We also calculated the composite log-likelihoods of each the simulated datasets under the correct model used to generate the data now with a more dense grid of parameters to obtain better estimates of the MCLE of each parameter. We allowed <italic>g</italic> to vary in the calculations of the MCLEs under the standing variation model. See <xref ref-type="table" rid="tblS2">Table S2</xref>, <xref ref-type="table" rid="tblS4">Table S4</xref>, <xref ref-type="table" rid="tblS5">Table S5</xref>.</p>
</sec>
<sec id="app1b6">
<label>A.2.6</label>
<title>Inference details: mean-centering allele frequencies and covariances, sample size correction, and speed-ups</title>
<p>Given that we do not know the true ancestral mean at locus <italic>l, &#x03F5;<sub>l</sub></italic>, we use the mean of the present-day sample allele frequencies at this locus, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline25.gif"/></alternatives></inline-formula>. When mean-centering, we lose a degree of freedom so in calculating the likelihood it is necessary to drop information from one population. Since the information from the dropped population is incorporated in the mean, the choice of the dropped population is arbitrary. In matrix form, the mean-centered allele frequencies with one dropped population can be expressed as
<disp-formula id="eqnA16"><alternatives><graphic xlink:href="119578_eqnA16.gif"/></alternatives></disp-formula> where <bold>T</bold> is an <italic>K</italic> &#x2212; 1 by <italic>K</italic> matrix with <inline-formula><alternatives><inline-graphic xlink:href="119578_inline26.gif"/></alternatives></inline-formula> on the main diagonal and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline27.gif"/></alternatives></inline-formula> elsewhere. Prior to mean-centering, we randomize the reference allele at each SNP to account for biases induced by defining the allele of interest.</p>
<p>Now, we model the mean-centered allele frequencies as multivariate normal around mean zero with covariance proportional to a mean-centered parameterized covariance matrix (<bold>F</bold><sup>(<italic>S</italic>)&#x2032;</sup>) as
<disp-formula id="eqnA17"><alternatives><graphic xlink:href="119578_eqnA17.gif"/></alternatives></disp-formula> where we use the average present day allele frequency across populations at the locus, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline28.gif"/></alternatives></inline-formula>, as an estimate of <italic>&#x03F5;<sub>l</sub></italic> in the site-specific term in the covariance. We note that <inline-formula><alternatives><inline-graphic xlink:href="119578_inline29.gif"/></alternatives></inline-formula> is a slightly downwardly biased estimate of <italic>&#x03F5;</italic>(1 &#x2212; <italic>&#x03F5;</italic>), but for our purposes it seems sufficient to include this term as a locus-specific adjustment to the expected covariance.</p>
<p>To obtain the corresponding mean-centered covariance matrix, dropping the same population, we can apply the following matrix operations,
<disp-formula id="eqnA18"><alternatives><graphic xlink:href="119578_eqnA18.gif"/></alternatives></disp-formula> this new matrix is <italic>K</italic> &#x2212; 1 by <italic>K</italic> &#x2212; 1 and full rank.</p>
<p>Before mean-centering, <bold>F</bold><sup>(<italic>S</italic>)</sup>, we apply a sample size correction to correct for the finite sampling bias. We add 1/<italic>n<sub>i</sub></italic> to the diagonal where <italic>n<sub>i</sub></italic> is the sample size in population <italic>i</italic>. We take twice the number of diploid individuals sampled in population <italic>i</italic> as <italic>n<sub>i</sub></italic> for data applications. In simulations, we use the number of chromosomes sampled in population <italic>i</italic> as <italic>n<sub>i</sub></italic>. Note that both this mean-centering and sample size correction is also preformed on the neutral matrix, <bold>F</bold> before likelihood calculations under a neutral model with no selection.</p>
<p>To decrease some of the computational time involved in our likelihood calculations, we precompute the mean-centered covariance matrices with selection, <bold>F</bold><sup>(<italic>S</italic>)&#x2032;</sup>, for given bins of distance away from a putative selected site. We first divide our distances in our window into 1000 bins and take the midpoint of the distances in these bins to calculate <bold>F</bold><sup>(<italic>S</italic>)&#x2032;</sup> as this matrix is a function of distance. To avoid the costly step of recomputing the corresponding inverses and determinants needed for likelihood calculations, we do this step first and use these values for all SNPs in a given bin, and store them and reuse them over all locations of the selected site.</p>
<p>Thus, we calculate the likelihood of mean-centered allele frequencies, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline30.gif"/></alternatives></inline-formula>, given our model <italic>M</italic> and its parameters &#x0398;<sub><italic>M</italic></sub>, a given locus <italic>l</italic> as
<disp-formula id="eqnA19"><alternatives><graphic xlink:href="119578_eqnA19.gif"/></alternatives></disp-formula> where <italic>k</italic> &#x003D; <italic>K</italic> &#x2212; 1, the rank of matrix <bold>F</bold><sup>(<italic>S</italic>)&#x2032;</sup>.</p>
</sec>
<sec id="app1c">
<label>A.3</label>
<title>Standing variant model with a source population</title>
<p>When there are multiple selected populations and they do not follow a bifurcating tree structure, it is necessary to incorporate a model that has a source population for the standing variant to have self-consistent mean-centered covariance matrices.</p>
<p>Let population <italic>l</italic> be a selected population and the source of the beneficial allele. In all other populations, the beneficial allele is standing for time <italic>t</italic> generations at frequency <italic>g</italic> before the lineage returns to the source population where it still standing at frequency <italic>g</italic> (see <xref ref-type="fig" rid="fig11">Figure 11</xref>). We can define pairwise coancestry coefficients for all pairs of populations under this model. Let populations <italic>i</italic> and <italic>j</italic> represent populations that experience selection and population <italic>k</italic> be any unselected population.</p>
<p>Since population <italic>l</italic> is the source, its variance follows the same form as <xref ref-type="disp-formula" rid="eqn7">Equation 7</xref>.
<disp-formula id="eqnA20"><alternatives><graphic xlink:href="119578_eqnA20.gif"/></alternatives></disp-formula></p>
<p>All other selected populations have a modified variance since lineages that fail to recombine off the beneficial background during the sweep and fail to coalesce or recombine during the standing phase return to the source population. Thus,
<disp-formula id="eqnA21"><alternatives><graphic xlink:href="119578_eqnA21.gif"/></alternatives></disp-formula></p>
<p>There is additional coancestry between pairs of selected populations. This takes a different form than <xref ref-type="disp-formula" rid="eqn9">Equation 9</xref> as there since if either lineage fails to recombines off the beneficial background during the sweep or standing phase, the lineage will be in population <italic>l</italic>. For selected populations <italic>i</italic> and <italic>j</italic>, now
<disp-formula id="eqnA22"><alternatives><graphic xlink:href="119578_eqnA22.gif"/></alternatives></disp-formula></p>
<p>If either population is the source, <italic>l</italic> this reduces to
<disp-formula id="eqnA23"><alternatives><graphic xlink:href="119578_eqnA23.gif"/></alternatives></disp-formula> since if the lineage fails to recombines off the beneficial background in population <italic>i</italic>, it is back in population <italic>l</italic>. If the lineage in <italic>l</italic> is still on the beneficial background after the sweep and the initial <italic>t</italic> generations of standing, they can coalesce during the standing phase in population <italic>l</italic>. Else, the lineages will coalesce neutrally in population <italic>l</italic>. However, if the lineage sampled in population <italic>i</italic> does not return to the source population (i.e. it recombines during the sweep or standing phase of <italic>t</italic> generations), the lineages can coalesce with neutral probability <italic>f<sub>il</sub></italic>.</p>
<p>Lastly, we must incorporate the impact linked selection has on the coancestry between lineages sampled from any pair of non-source selected population <italic>i</italic> and non-selected population <italic>k</italic>.
<disp-formula id="eqnA24"><alternatives><graphic xlink:href="119578_eqnA24.gif"/></alternatives></disp-formula> Since lineages that do not recombine off the beneficial background in population <italic>i</italic> go back into the source population <italic>l</italic>, non-selected populations may now have more or less coancestry with population <italic>i</italic> depending on whether <italic>l</italic> is neutrally has more or less coancestry with population <italic>l</italic>, respectively.</p>
</sec>
<sec id="app1d">
<label>A.4</label>
<title>Migration model extensions</title>
<sec id="app1d1">
<label>A.4.1</label>
<title>Single pulses of migration</title>
<p>We also considered models of a single pulse of migration. We solve for <inline-formula><alternatives><inline-graphic xlink:href="119578_inline31.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline32.gif"/></alternatives></inline-formula> for the bounds on the time during which the beneficial allele could migrate: (1) &#x201C;instantly&#x201D; after the beneficial allele arises in population <italic>i</italic> and (2) after the beneficial allele reaches fixation in the population <italic>i</italic>.</p>
<sec id="app1d1a">
<title>Beneficial allele migrates instantly after it arises in population <italic>i</italic></title>
<p>In this case, we are specifying the pulse of migration from population <italic>i</italic> into population <italic>j</italic> occurs sufficiently soon enough after the sweep began such that the entire haplotype the beneficial mutation arises on in population <italic>i</italic> migrates to population <italic>j</italic> (i.e. there is no time for recombination to occur). This case gives us results for an extreme of a single pulse of migration may not be particularly relevant as the spread of the beneficial allele into population <italic>j</italic> will likely only occur after it has reached a sufficiently high frequency in population <italic>i</italic> as it may be lost due to drift. However, these results aid in our intuition of this model.</p>
<p>As the beneficial allele originates in population <italic>i</italic>, again,
<disp-formula id="eqnA25"><alternatives><graphic xlink:href="119578_eqnA25.gif"/></alternatives></disp-formula></p>
<p>The probability of two lineages in the recipient population, <italic>j</italic>, coalescing before reaching the ancestral population is now
<disp-formula id="eqnA26"><alternatives><graphic xlink:href="119578_eqnA26.gif"/></alternatives></disp-formula> Here, both lineages can not recombine off the sweep (w.p. <italic>y</italic><sup>2</sup>) and therefore coalesce with probability 1. Exactly one lineage can recombine off the sweep (w.p. 2<italic>y</italic>(1 &#x2212; <italic>y</italic>)) and therefore the two lineages can only coalesce in the shared drift phase (w.p. <italic>f<sub>ij</sub></italic>) as the lineage that does not recombine off the sweep migrates into population <italic>i</italic>. Both lineages can recombine off the sweep (w.p. (1 &#x2212; <italic>y</italic>)<sup>2</sup>) and then can coalesce in population <italic>j</italic> before they reach the ancestral population.</p>
<p>The probability of two lineages drawn from each population coalescing before reaching the ancestral population is
<disp-formula id="eqnA27"><alternatives><graphic xlink:href="119578_eqnA27.gif"/></alternatives></disp-formula> In this case, if the lineage in population <italic>j</italic> recombines off the sweep (w.p. 1 &#x2212; <italic>y</italic>), the two lineages can only coalesce in the shared drift phase (w.p. <italic>f</italic><sub><italic>ij</italic></sub>) before reaching the ancestral population. If the lineage in population <italic>j</italic> fails to recombine off the sweep (w.p. <italic>y</italic>), it migrates back to population <italic>i</italic> and will be forced to coalesce with the lineage in population <italic>i</italic> if it also failed to recombine, else they will coalesce neutrally in population <italic>i</italic>.</p>
</sec>
<sec id="app1d1b">
<title>Beneficial allele migrates after it reaches fixation in population <italic>i</italic></title>
<p>For the coancestry coefficient for population <italic>j</italic>, the logic follows from that of when the pulse of migration happens instantly. However in deriving the coancestry coefficient between populations <italic>i</italic> and <italic>j</italic>, in the case where the lineage sampled from population <italic>j</italic> fails to recombine off the sweep and migrates back to population <italic>i</italic>, which happens with probability <italic>y</italic>, it is like we have two lineages sampled in population <italic>i</italic>. Now, both could either fail to recombine off the sweep and coalesce with probability 1 or one or both could recombine off the sweep and coalesce neutrally in population <italic>i</italic>. This can be written as
<disp-formula id="eqnA28"><alternatives><graphic xlink:href="119578_eqnA28.gif"/></alternatives></disp-formula></p>
<p>Together, these results characterize the other end point of a single pulse of migration spreading the beneficial allele to the recipient population.</p>
</sec>
</sec>
</sec>
<sec id="app1e">
<label>A.5</label>
<title>Forward in time derivation examples</title>
<p>For the forward in time results we utilize <xref ref-type="bibr" rid="c15">Gillespie&#x2019;s (2000)</xref> psuedohittchiking approximation with the incorporation of recombination to model the variance in the change in neutral allele frequencies due to a selective sweep (&#x0394;<italic><sub>S</sub>x<sub>i</sub></italic> for population <italic>i</italic>). A new beneficial mutation will arise on the same background as a neutral allele with probability equal to its frequency in the population, <italic>x</italic>. In the case no crossing over occurs and the new mutation sweeps to fixation, the neutral allele frequency after the hitchhiking event, <italic>x</italic>&#x2032;, will either be 1 with probability <italic>x</italic> or 0 with probability 1 &#x2212; <italic>x</italic>. Therefore,
<disp-formula id="eqnA29"><alternatives><graphic xlink:href="119578_eqnA29.gif"/></alternatives></disp-formula> thus <inline-formula><alternatives><inline-graphic xlink:href="119578_inline33.gif"/></alternatives></inline-formula> and Var[&#x0394;<italic><sub>S</sub>x</italic>] &#x003D; <italic>x</italic>(1 &#x2212; <italic>x</italic>).</p>
<p>Recombination can be incorporated into this model, allowing the neutral allele stop hitchhiking before it reaches fixation. The frequency of the haplotype on which the favorable mutation arises will increase to <italic>y</italic> and all other alleles will have their frequencies reduced by 1 &#x2212; <italic>y</italic>. So, if the favorable allele appears on the same background of our neutral allele, which happens with probability <italic>x, x</italic>&#x2032; &#x003D; (1 &#x2212; <italic>y</italic>)<italic>x</italic> &#x002B; <italic>y</italic>. Else, with probability 1 &#x2212; <italic>x, x</italic>&#x2032; &#x003D; (1 &#x2212; <italic>y</italic>)<italic>x</italic>. Therefore,
<disp-formula id="eqnA30"><alternatives><graphic xlink:href="119578_eqnA30.gif"/></alternatives></disp-formula> thus with recombination, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline34.gif"/></alternatives></inline-formula> and Var[&#x0394;<italic><sub>S</sub>x</italic>] &#x003D; <italic>y</italic><sup>2</sup><italic>x</italic>(1 &#x2212; <italic>x</italic>).</p>
<p>We can break down the changes in allele frequencies in the two populations from the ancestral allele frequency <italic>&#x03F5;</italic> into three components if we assume the independent drift in each population after the sweep is negligible: the change due to (1) shared drift between populations <italic>i</italic> and <italic>j</italic> before they split (&#x0394;<italic><sub>N</sub>x<sub>ij</sub></italic>), (2) independent drift in each population before the sweep (&#x0394;<italic><sub>N</sub>x<sub>i</sub></italic> and &#x0394;<italic><sub>N</sub>x<sub>j</sub></italic>), and (3) the selective sweep occurring in each population (<italic><sub>S</sub>x<sub>i</sub></italic> and <italic><sub>S</sub>x<sub>j</sub></italic>).</p>
<p>Define <inline-formula><alternatives><inline-graphic xlink:href="119578_inline35.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline36.gif"/></alternatives></inline-formula> for population <italic>i</italic>. The total amount of variance in a neutral allele frequency for the ith population is defined as <italic>&#x03F5;</italic>(1 &#x2212; <italic>&#x03F5;</italic>)<italic>f<sub>ii</sub></italic> which we approximate as <italic>&#x03F5;</italic>(1 &#x2212; <italic>&#x03F5;</italic>)(<italic>f<sub>ij</sub> &#x002B; f<sub>i</sub></italic>). This only holds if we assume the time intervals are short relative to drift so that these terms act additively. If this is not the case, the <inline-formula><alternatives><inline-graphic xlink:href="119578_inline37.gif"/></alternatives></inline-formula> is no longer the probability that two alleles drawn from population <italic>i</italic> before the sweep begins are identical by descent with reference to the ancestral population with neutral allele frequency <italic>&#x03F5;</italic>, but rather with reference to the population before the split into populations <italic>i</italic> and <italic>j</italic> with neutral allele frequency <italic>x<sub>ij</sub></italic>. A more careful treatment of these parameters could be done to relax this assumption, and follows naturally in a coalescent setting.</p>
<p>From a forward in time perspective, we can solve for Var[&#x0394;<italic>x<sub>i</sub></italic>], Var[&#x0394;<italic>x<sub>j</sub></italic>], and Cov[&#x0394;<italic>x<sub>i</sub></italic>, &#x0394;<italic>x<sub>j</sub></italic>] with &#x0394;<italic>x<sub>i</sub></italic> &#x003D; &#x0394;<italic><sub>N</sub>x<sub>ij</sub></italic> &#x002B; &#x0394;<italic><sub>N</sub>x<sub>i</sub></italic> &#x002B; &#x0394;<italic><sub>S</sub>x<sub>i</sub></italic>. Assuming drift terms are independent of each other, we are left with the following expressions
<disp-formula id="eqnA31"><alternatives><graphic xlink:href="119578_eqnA31.gif"/></alternatives></disp-formula> and
<disp-formula id="eqnA32"><alternatives><graphic xlink:href="119578_eqnA32.gif"/></alternatives></disp-formula></p>
<sec id="app1e1">
<title>Independent sweep model</title>
<p>In the case of independent sweeps where there is no gene flow between populations, many terms in <xref ref-type="disp-formula" rid="eqnA31">Equations A.31</xref> and <xref ref-type="disp-formula" rid="eqnA32">A.32</xref> equal zero since the sweeps are independent. For the variances, we are left with
<disp-formula id="eqnA33"><alternatives><graphic xlink:href="119578_eqnA33.gif"/></alternatives></disp-formula></p>
<p>The covariance in allele frequencies between populations <italic>i</italic> and <italic>j</italic>, is simply what we would expect under neutrality.
<disp-formula id="eqnA34"><alternatives><graphic xlink:href="119578_eqnA34.gif"/></alternatives></disp-formula></p>
</sec>
<sec id="app1e2">
<label>A.5.2</label>
<title>Shared sweeps via migration</title>
<p>The migration models better exemplifies these forward in time calculations. We demonstrate the calculations of Var[&#x0394;<italic>x<sub>j</sub></italic>] and Cov[&#x0394;<italic>x<sub>i</sub></italic>, &#x0394;<italic>x<sub>j</sub></italic>] for pulse of migration models specified in <xref ref-type="sec" rid="app1d">A.4</xref>.</p>
<sec id="app1e2a">
<title>Beneficial allele migrates instantly after it arises in population <italic>i</italic></title>
<p>The background on which the beneficial mutation arises depends on the neutral allele frequency in population <italic>i</italic> before the sweep, <italic>x<sub>i</sub></italic>. We are specifying the pulse of migration from population <italic>i</italic> into population <italic>j</italic> occurs sufficiently soon enough after the sweep began such that the entire haplotype the beneficial mutation arises on in population <italic>i</italic> migrates to population <italic>j</italic> (i.e. there is no time for recombination to occur). Now &#x0394;<italic><sub>S</sub>x<sub>j</sub></italic> depends on the neutral allele frequency in population <italic>i</italic> before the sweep.
<disp-formula id="eqnA35"><alternatives><graphic xlink:href="119578_eqnA35.gif"/></alternatives></disp-formula></p>
<p>As the beneficial allele originates in population <italic>i</italic>, again,
<disp-formula id="eqnA36"><alternatives><graphic xlink:href="119578_eqnA36.gif"/></alternatives></disp-formula></p>
<p>Now &#x0394;<italic><sub>S</sub>x<sub>j</sub></italic> depends on <italic>x<sub>i</sub></italic>, <inline-formula><alternatives><inline-graphic xlink:href="119578_inline38.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="119578_inline39.gif"/></alternatives></inline-formula> are no longer zero. So,
<disp-formula id="eqnA37"><alternatives><graphic xlink:href="119578_eqnA37.gif"/></alternatives></disp-formula> and
<disp-formula id="eqnA38"><alternatives><graphic xlink:href="119578_eqnA38.gif"/></alternatives></disp-formula></p>
<p>This result is the same as <xref ref-type="disp-formula" rid="eqnA27">Equation A.27</xref> if the assumption about drift being additive holds such that <italic>f<sub>ii</sub></italic> &#x003D; <italic>f<sub>i</sub></italic> &#x002B; <italic>f<sub>ij</sub></italic>.</p>
</sec>
<sec id="app1e2b">
<title>Beneficial allele migrates after it reaches fixation in population <italic>i</italic></title>
<p>Now, the frequency of a neutral allele in population <italic>i</italic> after the sweep has occurred is
<disp-formula><alternatives><graphic xlink:href="119578_ueqn2.gif"/></alternatives></disp-formula></p>
<p>Fixing that the migration from population <italic>i</italic> into <italic>j</italic> occurs after the sweep has finished in population <italic>i</italic>,
<disp-formula id="eqnA39"><alternatives><graphic xlink:href="119578_eqnA39.gif"/></alternatives></disp-formula></p>
<p>This can also be written as
<disp-formula id="eqnA40"><alternatives><graphic xlink:href="119578_eqnA40.gif"/></alternatives></disp-formula></p>
<p>Here, the first case is that the beneficial allele arises on the same background as our neutral allele in population <italic>i</italic> and then is the haplotype that migrates into population <italic>j</italic>. The probability of the haplotype migrating is equal to its frequency in the population. The third case also includes the beneficial allele arising on the same background as our neutral allele, but the other haplotype migrates. The second and fourth cases are when the beneficial mutation arises on the other background as our neutral allele. In the second case, the haplotype containing our neutral allele migrates after the sweep and in the fourth, the other haplotype migrates.</p>
<p>The variance within population <italic>i</italic> and population <italic>j</italic> are the same as in the case of the beneficial allele migrating instantly. The only term changed by specifying that the pulse of migration happens after the sweep is <inline-formula><alternatives><inline-graphic xlink:href="119578_inline40.gif"/></alternatives></inline-formula> which is now <italic>&#x03F5;</italic>(1 &#x2212; <italic>&#x03F5;</italic>)<italic>y</italic><sup>3</sup>(1 &#x2212; <italic>f<sub>jj</sub></italic>). So,
<disp-formula id="eqnA41"><alternatives><graphic xlink:href="119578_eqnA41.gif"/></alternatives></disp-formula></p>
</sec>
</sec>
</sec>
</app>
</app-group>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Arendt</surname>, <given-names>J.</given-names></string-name> and <string-name><given-names>D.</given-names> <surname>Reznick</surname></string-name> (<year>2008</year>). <article-title>Convergence and parallelism reconsidered: what have we learned about the genetics of adaptation</article-title>? <source>Trends in Ecology and Evolution</source> <volume>23</volume> (<issue>1</issue>), <fpage>26</fpage> &#x2013; <lpage>32</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Barrett</surname>, <given-names>R. D.</given-names></string-name> and <string-name><given-names>D.</given-names> <surname>Schluter</surname></string-name> (<year>2008</year>). <article-title>Adaptation from standing genetic variation</article-title>. <source>Trends in ecology &#x0026; evolution</source> <volume>23</volume> (<issue>1</issue>), <fpage>38</fpage>&#x2013;<lpage>44</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Barton</surname>, <given-names>N.</given-names></string-name> (<year>1998</year>). <article-title>The effect of hitch-hiking on neutral genealogies</article-title>. <source>Genet. Res</source>. <volume>72</volume>, <fpage>123</fpage>&#x2013;<lpage>133</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Barton</surname>, <given-names>N.</given-names></string-name> and <string-name><given-names>B. O.</given-names> <surname>Bengtsson</surname></string-name> (<year>1986</year>, Dec). <article-title>The barrier to genetic exchange between hybridising populations</article-title>. <source>Heredity</source> <volume>57</volume> (<issue>3</issue>), <fpage>357</fpage>&#x2013;<lpage>376</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Berg</surname>, <given-names>J. J.</given-names></string-name> and <string-name><given-names>G.</given-names> <surname>Coop</surname></string-name> (<year>2015</year>). <article-title>A coalescent model for a sweep of a unique standing variant</article-title>. <source>Genetics</source> <volume>201</volume> (<issue>2</issue>), <fpage>707</fpage>&#x2013;<lpage>725</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Bierne</surname>, <given-names>N.</given-names></string-name> (<year>2010</year>). <article-title>The distinctive footprints of local hitch-hiking in a varied environment and global hitchhiking in a subdivided population</article-title>. <source>Evolution</source> <volume>64</volume> (<issue>11</issue>), <fpage>3254</fpage>&#x2013;<lpage>3272</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Chan</surname>, <given-names>Y. F.</given-names></string-name>, <string-name><given-names>M. E.</given-names> <surname>Marks</surname></string-name>, <string-name><given-names>F. C.</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Villarreal</surname></string-name>, <string-name><given-names>M. D.</given-names> <surname>Shapiro</surname></string-name>, <string-name><given-names>S. D.</given-names> <surname>Brady</surname></string-name>, <string-name><given-names>A. M.</given-names> <surname>Southwick</surname></string-name>, <string-name><given-names>D. M.</given-names> <surname>Absher</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Grimwood</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Schmutz</surname></string-name>, <etal>et al.</etal> (<year>2010</year>). <article-title>Adaptive evolution of pelvic reduction in sticklebacks by recurrent deletion of a pitx1 enhancer</article-title>. <source>science</source> <volume>327</volume> (<issue>5963</issue>), <fpage>302</fpage>&#x2013;<lpage>305</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Charlesworth</surname>, <given-names>B.</given-names></string-name>, <string-name><given-names>M.</given-names> <surname>Nordborg</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Charlesworth</surname></string-name> (<year>1997</year>, Oct). <article-title>The effects of local selection, balanced polymorphism and background selection on equilibrium patterns of genetic diversity in subdivided populations</article-title>. <source>GenetRes</source> <volume>70</volume> (<issue>2</issue>), <fpage>155</fpage>&#x2013;<lpage>174</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>H.</given-names></string-name>, <string-name><given-names>N.</given-names> <surname>Patterson</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Reich</surname></string-name> (<year>2010</year>). <article-title>Population differentiation as a test for selective sweeps</article-title>. <source>Genome research</source> <volume>20</volume> (<issue>3</issue>), <fpage>393</fpage>&#x2013;<lpage>402</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Colosimo</surname>, <given-names>P. F.</given-names></string-name>, <string-name><given-names>K. E.</given-names> <surname>Hosemann</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Balabhadra</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Villarreal</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Dickson</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Grimwood</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Schmutz</surname></string-name>, <string-name><given-names>R. M.</given-names> <surname>Myers</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Schluter</surname></string-name>, and <string-name><given-names>D. M.</given-names> <surname>Kingsley</surname></string-name> (<year>2005</year>). <article-title>Widespread parallel evolution in sticklebacks by repeated fixation of ectodysplasin alleles</article-title>. <source>science</source> <volume>307</volume> (<issue>5717</issue>), <fpage>1928</fpage>&#x2013;<lpage>1933</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Coop</surname>, <given-names>G.</given-names></string-name>, <string-name><given-names>D.</given-names> <surname>Witonsky</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Di Rienzo</surname></string-name>, and <string-name><given-names>J. K.</given-names> <surname>Pritchard</surname></string-name> (<year>2010</year>). <article-title>Using environmental correlations to identify loci underlying local adaptation</article-title>. <source>Genetics</source> <volume>185</volume> (<issue>4</issue>), <fpage>1411</fpage>&#x2013;<lpage>1423</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>DeGiorgio</surname>, <given-names>M.</given-names></string-name>, <string-name><given-names>K. E.</given-names> <surname>Lohmueller</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Nielsen</surname></string-name> (<year>2014</year>). <article-title>A model-based approach for identifying signatures of ancient balancing selection in genetic data</article-title>. <source>PLoS Genet</source> <volume>10</volume> (<issue>8</issue>), <fpage>e1004561</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Duvernell</surname>, <given-names>D. D.</given-names></string-name>, <string-name><given-names>J. B.</given-names> <surname>Lindmeier</surname></string-name>, <string-name><given-names>K. E.</given-names> <surname>Faust</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Whitehead</surname></string-name> (<year>2008</year>). <article-title>Relative influences of historical and contemporary forces shaping the distribution of genetic variation in the atlantic killifish, fundulus heteroclitus</article-title>. <source>Molecular Ecology</source> <volume>17</volume> (<issue>5</issue>), <fpage>1344</fpage>&#x2013;<lpage>1360</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="book"><string-name><surname>Ewens</surname>, <given-names>W.</given-names></string-name> (<year>2004</year>). <source>Mathematical Population Genetics 1: Theoretical Introduction</source>. <publisher-name>Interdisciplinary Applied Mathematics</publisher-name>. <publisher-loc>Springer New York</publisher-loc>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname>, <given-names>J. H.</given-names></string-name> (<year>2000</year>). <article-title>Genetic drift in an infinite population</article-title>. <source>The pseudohitchhiking model. Genetics</source> <volume>155</volume>, <fpage>909</fpage>&#x2013;<lpage>919</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Guerrero</surname>, <given-names>R. F.</given-names></string-name>, <string-name><given-names>F.</given-names> <surname>Rousset</surname></string-name>, and <string-name><given-names>M.</given-names> <surname>Kirkpatrick</surname></string-name> (<year>2012</year>). <article-title>Coalescent patterns for chromosomal inversions in divergent populations</article-title>. <source>Phil. Trans. R. Soc. B</source> <volume>367</volume>(<issue>1587</issue>), <fpage>430</fpage>&#x2013;<lpage>438</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="book"><string-name><surname>Harvey</surname>, <given-names>P. H.</given-names></string-name> and <string-name><given-names>M. D.</given-names> <surname>Pagel</surname></string-name> (<year>1991</year>). <source>The comparative method in evolutionary biology</source>, Volume <volume>239</volume>. <publisher-name>Oxford university press Oxford</publisher-name>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Hedrick</surname>, <given-names>P. W.</given-names></string-name> (<year>2013</year>). <article-title>Adaptive introgression in animals: examples and comparison to new mutation and standing variation as sources of adaptive variation</article-title>. <source>Molecular ecology</source> <volume>22</volume> (<issue>18</issue>), <fpage>4606</fpage>&#x2013;<lpage>4618</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><collab>Heliconius Genome Consortium</collab> (<year>2012</year>). <article-title>Butterfly genome reveals promiscuous exchange of mimicry adaptations among species</article-title>. <source>Nature</source> <volume>487</volume> (<issue>7405</issue>), <fpage>94</fpage>&#x2013;<lpage>98</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Hudson</surname>, <given-names>R. R.</given-names></string-name> (<year>2001</year>). <article-title>Two-locus sampling distributions and their application</article-title>. <source>Genetics</source> <volume>159</volume> (<issue>4</issue>), <fpage>1805</fpage>&#x2013;<lpage>1817</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Hudson</surname>, <given-names>R. R.</given-names></string-name> (<year>2002</year>). <article-title>Generating samples under a Wright&#x2013;Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source> <volume>18</volume>, <fpage>337</fpage>&#x2013;<lpage>338</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Hudson</surname>, <given-names>R. R.</given-names></string-name> and <string-name><given-names>N. L.</given-names> <surname>Kaplan</surname></string-name> (<year>1988</year>). <article-title>The coalescent process in models with selection and recombination</article-title>. <source>Genetics</source> <volume>120</volume> (<issue>3</issue>), <fpage>831</fpage>&#x2013;<lpage>840</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Jones</surname>, <given-names>F. C.</given-names></string-name>, <string-name><given-names>M. G.</given-names> <surname>Grabherr</surname></string-name>, <string-name><given-names>Y. F.</given-names> <surname>Chan</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Russell</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Mauceli</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Johnson</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Swofford</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Pirun</surname></string-name>, <string-name><given-names>M. C.</given-names> <surname>Zody</surname></string-name>, <string-name><given-names>S.</given-names> <surname>White</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Birney</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Searle</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Schmutz</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Grimwood</surname></string-name>, <string-name><given-names>M. C.</given-names> <surname>Dickson</surname></string-name>, <string-name><given-names>R. M.</given-names> <surname>Myers</surname></string-name>, <string-name><given-names>C. T.</given-names> <surname>Miller</surname></string-name>, <string-name><given-names>B. R.</given-names> <surname>Summers</surname></string-name>, <string-name><given-names>A. K.</given-names> <surname>Knecht</surname></string-name>, <string-name><given-names>S. D.</given-names> <surname>Brady</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>A. A.</given-names> <surname>Pollen</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Howes</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Amemiya</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Baldwin</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Bloom</surname></string-name>, <string-name><given-names>D. B.</given-names> <surname>Jaffe</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Nicol</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Wilkinson</surname></string-name>, <string-name><given-names>E. S.</given-names> <surname>Lander</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Di Palma</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Lindblad-Toh</surname></string-name>, and <string-name><given-names>D. M.</given-names> <surname>Kingsley</surname></string-name> (<year>2012</year>, Apr). <article-title>The genomic basis of adaptive evolution in threespine sticklebacks</article-title>. <source>Nature</source> <volume>484</volume> (<issue>7392</issue>), <fpage>55</fpage>&#x2013;<lpage>61</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Kaplan</surname>, <given-names>N.</given-names></string-name>, <string-name><given-names>R. R.</given-names> <surname>Hudson</surname></string-name>, and <string-name><given-names>M.</given-names> <surname>Iizuka</surname></string-name> (<year>1991</year>). <article-title>The coalescent process in models with selection, recombination and geographic subdivision</article-title>. <source>Genetical research</source> <volume>57</volume> (<issue>01</issue>), <fpage>83</fpage>&#x2013;<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Kaplan</surname>, <given-names>N. L.</given-names></string-name>, <string-name><given-names>R. R.</given-names> <surname>Hudson</surname></string-name>, and <string-name><given-names>C. H.</given-names> <surname>Langley</surname></string-name> (<year>1989</year>, December). <article-title>The &#x201C;hitchhiking effect&#x201D; revisited</article-title>. <source>Genetics</source> <volume>123</volume>, <fpage>887</fpage>&#x2013;<lpage>899</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Kelly</surname>, <given-names>J. K.</given-names></string-name> and <string-name><given-names>M. J.</given-names> <surname>Wade</surname></string-name> (<year>2000</year>). <article-title>Molecular evolution near a two-locus balanced polymorphism</article-title>. <source>Journal of Theoretical Biology</source> <volume>204</volume> (<issue>1</issue>), <fpage>83</fpage> &#x2013; <lpage>101</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>Y.</given-names></string-name> and <string-name><given-names>T.</given-names> <surname>Maruki</surname></string-name> (<year>2011</year>). <article-title>Hitchhiking effect of a beneficial mutation spreading in a subdivided population</article-title>. <source>Genetics</source> <volume>189</volume> (<issue>1</issue>), <fpage>213</fpage>&#x2013;<lpage>226</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>Y.</given-names></string-name> and <string-name><given-names>R.</given-names> <surname>Nielsen</surname></string-name> (<year>2004</year>). <article-title>Linkage disequilibrium as a signature of selective sweeps</article-title>. <source>Genetics</source> <volume>167</volume> (<issue>3</issue>), <fpage>1513</fpage>&#x2013;<lpage>1524</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>Y.</given-names></string-name> and <string-name><given-names>W.</given-names> <surname>Stephan</surname></string-name> (<year>2002</year>). <article-title>Detecting a local signature of genetic hitchhiking along a recombining chromosome</article-title>. <source>Genetics</source> <volume>160</volume>, <fpage>765</fpage>&#x2013;<lpage>777</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Kirkpatrick</surname>, <given-names>M.</given-names></string-name> (<year>2010</year>). <article-title>How and why chromosome inversions evolve</article-title>. <source>PLoS Biol</source> <volume>8</volume> (<issue>9</issue>), <fpage>e1000501</fpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="other"><string-name><surname>Larribe</surname>, <given-names>F.</given-names></string-name> and <string-name><given-names>P.</given-names> <surname>Fearnhead</surname></string-name> (<year>2011</year>). <article-title>On composite likelihoods in statistical genetics</article-title>. <source>Statistica Sinica</source>, <fpage>43</fpage>&#x2013;<lpage>69</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="thesis"><string-name><surname>Lee</surname>, <given-names>Y. W.</given-names></string-name> (<year>2009</year>). <source>Genetics Analysis of Standing Variation for Floral Morphology and Fitness Components</source>. Ph. D. thesis, Duke University.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Lipson</surname>, <given-names>M.</given-names></string-name>, <string-name><given-names>P.-R.</given-names> <surname>Loh</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Levin</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Reich</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Patterson</surname></string-name>, and <string-name><given-names>B.</given-names> <surname>Berger</surname></string-name> (<year>2013</year>, May). <article-title>Efficient moment-based inference of admixture parameters and sources of gene flow</article-title>. <source>Mol Biol Evol</source> <volume>30</volume> (<issue>8</issue>), <fpage>1788</fpage>&#x2013;<lpage>1802</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Losos</surname>, <given-names>J. B.</given-names></string-name> (<year>2011</year>). <article-title>Convergence, adaptation, and constraint</article-title>. <source>Evolution</source> <volume>65</volume> (<issue>7</issue>), <fpage>1827</fpage>&#x2013;<lpage>1840</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>MacNair</surname>, <given-names>M. R.</given-names></string-name>, <string-name><given-names>S. E.</given-names> <surname>Smith</surname></string-name>, and <string-name><given-names>Q. J.</given-names> <surname>Cumbes</surname></string-name> (<year>1993</year>, 11). <article-title>Heritability and distribution of variation in degree of copper tolerance in mimulus guttatus at copperopolis, california</article-title>. <source>Heredity</source> <volume>71</volume> (<issue>5</issue>), <fpage>445</fpage>&#x2013;<lpage>455</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Martin</surname>, <given-names>A.</given-names></string-name> and <string-name><given-names>V.</given-names> <surname>Orgogozo</surname></string-name> (<year>2013</year>). <article-title>The loci of repeated evolution: a catalog of genetic hotspots of phenotypic variation</article-title>. <source>Evolution</source> <volume>67</volume> (<issue>5</issue>), <fpage>1235</fpage>&#x2013;<lpage>1250</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Maynard Smith</surname>, <given-names>J.</given-names></string-name> (<year>1971</year>). <article-title>What use is sex?</article-title> <source>Journal of Theoretical Biology</source> <volume>30</volume> (<issue>2</issue>), <fpage>319</fpage> &#x2013; <lpage>335</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Maynard Smith</surname>, <given-names>J.</given-names></string-name> and <string-name><given-names>J.</given-names> <surname>Haigh</surname></string-name> (<year>1974</year>, February). <article-title>The hitch-hiking effect of a favourable gene</article-title>. <source>Genet Res</source> <volume>23</volume> (<issue>1</issue>), <fpage>23</fpage>&#x2013;<lpage>35</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Nacci</surname>, <given-names>D.</given-names></string-name>, <string-name><given-names>L.</given-names> <surname>Coiro</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Champlin</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Jayaraman</surname></string-name>, <string-name><given-names>R.</given-names> <surname>McKinney</surname></string-name>, <string-name><given-names>T. R.</given-names> <surname>Gleason</surname></string-name>, <string-name><given-names>W. R.</given-names> <surname>Munns</surname> <suffix>Jr.</suffix></string-name>, <string-name><given-names>J. L.</given-names> <surname>Specker</surname></string-name>, and <string-name><given-names>K. R.</given-names> <surname>Cooper</surname></string-name> (<year>1999</year>). <article-title>Adaptations of wild populations of the estuarine fish fundulus hetero-clitus to persistent environmental contaminants</article-title>. <source>Marine Biology</source> <volume>134</volume> (<issue>1</issue>), <fpage>9</fpage>&#x2013;<lpage>17</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Nacci</surname>, <given-names>D. E.</given-names></string-name>, <string-name><given-names>D.</given-names> <surname>Champlin</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Jayaraman</surname></string-name> (<year>2010</year>). <article-title>Adaptation of the estuarine fish fundulus heteroclitus (atlantic killifish) to polychlorinated biphenyls (pcbs)</article-title>. <source>Estuaries and Coasts</source> <volume>33</volume> (<issue>4</issue>), <fpage>853</fpage>&#x2013;<lpage>864</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Nicholson</surname>, <given-names>G.</given-names></string-name>, <string-name><given-names>A. V.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>F.</given-names> <surname>J&#x00F3;nsson</surname></string-name>, <string-name><given-names>&#x00D3;.</given-names> <surname>G&#x00FA;stafsson</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Stef&#x00E1;nsson</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Donnelly</surname></string-name> (<year>2002</year>). <article-title>Assessing population differentiation and isolation from single-nucleotide polymorphism data</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source> <volume>64</volume> (<issue>4</issue>), <fpage>695</fpage>&#x2013;<lpage>715</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Nielsen</surname>, <given-names>R.</given-names></string-name>, <string-name><given-names>S.</given-names> <surname>Williamson</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hubisz</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Clark</surname></string-name>, and <string-name><given-names>C.</given-names> <surname>Bustamante</surname></string-name> (<year>2005</year>). <article-title>Genomic scans for selective sweeps using SNP data</article-title>. <source>Genome Res</source>. <volume>15</volume>, <fpage>1566</fpage>&#x2013;<lpage>1575</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Orr</surname>, <given-names>H. A.</given-names></string-name> (<year>2005</year>, January). <article-title>The probability of parallel evolution</article-title>. <source>Evolution</source> <volume>59</volume> (<issue>1</issue>), <fpage>216</fpage>&#x2013;<lpage>220</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Pearce</surname>, <given-names>R. J.</given-names></string-name>, <string-name><given-names>H.</given-names> <surname>Pota</surname></string-name>, <string-name><given-names>M.-S. B.</given-names> <surname>Evehe</surname></string-name>, <string-name><given-names>E.-H.</given-names> <surname>B&#x00E2;</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Mombo-Ngoma</surname></string-name>, <string-name><given-names>A. L.</given-names> <surname>Malisa</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Ord</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Inojosa</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Matondo</surname></string-name>, <string-name><given-names>D. A.</given-names> <surname>Diallo</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Mbacham</surname></string-name>, <string-name><given-names>I. V.</given-names> <surname>van den Broek</surname></string-name>, <string-name><given-names>T. D.</given-names> <surname>Swarthout</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Getachew</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Dejene</surname></string-name>, <string-name><given-names>M. P.</given-names> <surname>Grobusch</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Njie</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Dunyo</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Kweku</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Owusu-Agyei</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Chandramohan</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Bonnet</surname></string-name>, <string-name><given-names>J.-P.</given-names> <surname>Guthmann</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Clarke</surname></string-name>, <string-name><given-names>K. I.</given-names> <surname>Barnes</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Streat</surname></string-name>, <string-name><given-names>S. T.</given-names> <surname>Katokele</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Uusiku</surname></string-name>, <string-name><given-names>C. O.</given-names> <surname>Agboghoroma</surname></string-name>, <string-name><given-names>O. Y.</given-names> <surname>Elegba</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Ciss&#x00E9;</surname></string-name>, <string-name><given-names>I. E.</given-names> <surname>A-Elbasit</surname></string-name>, <string-name><given-names>H. A.</given-names> <surname>Giha</surname></string-name>, <string-name><given-names>S. P.</given-names> <surname>Kachur</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Lynch</surname></string-name>, <string-name><given-names>J. B.</given-names> <surname>Rwakimari</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Chanda</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hawela</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Sharp</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Naidoo</surname></string-name>, and <string-name><given-names>C.</given-names> <surname>Roper</surname></string-name> (<year>2009</year>, 04). <article-title>Multiple origins and regional dispersal of resistant dhps in African Plasmodium falciparum malaria</article-title>. <source>PLoS Med</source> <volume>6</volume> (<issue>4</issue>), <fpage>e1000055</fpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Pease</surname>, <given-names>J. B.</given-names></string-name>, <string-name><given-names>D. C.</given-names> <surname>Haak</surname></string-name>, <string-name><given-names>M. W.</given-names> <surname>Hahn</surname></string-name>, and <string-name><given-names>L. C.</given-names> <surname>Moyle</surname></string-name> (<year>2016</year>). <article-title>Phylogenomics reveals three sources of adaptive variation during a rapid radiation</article-title>. <source>PLoS Biol</source> <volume>14</volume> (<issue>2</issue>), <fpage>e1002379</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Pennings</surname>, <given-names>P. S.</given-names></string-name> and <string-name><given-names>J.</given-names> <surname>Hermisson</surname></string-name> (<year>2006</year>, May). <article-title>Soft sweeps ii&#x2014;molecular population genetics of adaptation from recurrent mutation or migration</article-title>. <source>Mol Biol Evol</source> <volume>23</volume> (<issue>5</issue>), <fpage>1076</fpage>&#x2013;<lpage>1084</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Przeworski</surname>, <given-names>M.</given-names></string-name>, <string-name><given-names>G.</given-names> <surname>Coop</surname></string-name>, and <string-name><given-names>J. D.</given-names> <surname>Wall</surname></string-name> (<year>2005</year>). <article-title>The signature of positive selection on standing genetic variation</article-title>. <source>Evolution</source> <volume>59</volume> (<issue>11</issue>), <fpage>2312</fpage>&#x2013;<lpage>2323</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Racimo</surname>, <given-names>F.</given-names></string-name> (<year>2016</year>). <article-title>Testing for ancient selection using cross-population allele frequency differentiation</article-title>. <source>Genetics</source> <volume>202</volume> (<issue>2</issue>), <fpage>733</fpage>&#x2013;<lpage>750</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Racimo</surname>, <given-names>F.</given-names></string-name>, <string-name><given-names>S.</given-names> <surname>Sankararaman</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Nielsen</surname></string-name>, and <string-name><given-names>E.</given-names> <surname>Huerta-S&#x00E1;nchez</surname></string-name> (<year>2015</year>). <article-title>Evidence for archaic adaptive introgression in humans</article-title>. <source>Nature Reviews Genetics</source> <volume>16</volume> (<issue>6</issue>), <fpage>359</fpage>&#x2013;<lpage>371</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Reid</surname>, <given-names>N. M.</given-names></string-name>, <string-name><given-names>D. A.</given-names> <surname>Proestou</surname></string-name>, <string-name><given-names>B. W.</given-names> <surname>Clark</surname></string-name>, <string-name><given-names>W. C.</given-names> <surname>Warren</surname></string-name>, <string-name><given-names>J. K.</given-names> <surname>Colbourne</surname></string-name>, <string-name><given-names>J. R.</given-names> <surname>Shaw</surname></string-name>, <string-name><given-names>S. I.</given-names> <surname>Karchner</surname></string-name>, <string-name><given-names>M. E.</given-names> <surname>Hahn</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Nacci</surname></string-name>, <string-name><given-names>M. F.</given-names> <surname>Oleksiak</surname></string-name>, <string-name><given-names>D. L.</given-names> <surname>Crawford</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Whitehead</surname></string-name> (<year>2016</year>). <article-title>The genomic landscape of rapid repeated evolutionary adaptation to toxic pollution in wild fish</article-title>. <source>Science</source> <volume>354</volume> (<issue>6317</issue>), <fpage>1305</fpage>&#x2013;<lpage>1308</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Roesti</surname>, <given-names>M.</given-names></string-name>, <string-name><given-names>S.</given-names> <surname>Gavrilets</surname></string-name>, <string-name><given-names>A. P.</given-names> <surname>Hendry</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Salzburger</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Berner</surname></string-name> (<year>2014</year>). <article-title>The genomic signature of parallel adaptation from shared genetic variation</article-title>. <source>Molecular ecology</source> <volume>23</volume> (<issue>16</issue>), <fpage>3944</fpage>&#x2013;<lpage>3956</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Rosenzweig</surname>, <given-names>B. K.</given-names></string-name>, <string-name><given-names>J. B.</given-names> <surname>Pease</surname></string-name>, <string-name><given-names>N. J.</given-names> <surname>Besansky</surname></string-name>, and <string-name><given-names>M. W.</given-names> <surname>Hahn</surname></string-name> (<year>2016</year>). <article-title>Powerful methods for detecting introgressed regions from population genomic data</article-title>. <source>Molecular Ecology</source> <volume>25</volume> (<issue>11</issue>), <fpage>2387</fpage>&#x2013;<lpage>2397</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Samanta</surname>, <given-names>S.</given-names></string-name>, <string-name><given-names>Y.-J.</given-names> <surname>Li</surname></string-name>, and <string-name><given-names>B. S.</given-names> <surname>Weir</surname></string-name> (<year>2009</year>). <article-title>Drawing inferences about the coancestry coefficient</article-title>. <source>Theoretical Population Biology</source> <volume>75</volume> (<issue>4</issue>), <fpage>312</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Santiago</surname>, <given-names>E.</given-names></string-name> and <string-name><given-names>A.</given-names> <surname>Caballero</surname></string-name> (<year>2005</year>). <article-title>Variation after a selective sweep in a subdivided population</article-title>. <source>Genetics</source> <volume>169</volume>, <fpage>475</fpage>&#x2013;<lpage>483</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Slatkin</surname>, <given-names>M.</given-names></string-name> and <string-name><given-names>T.</given-names> <surname>Wiehe</surname></string-name> (<year>1998</year>). <article-title>Genetic hitch-hiking in a subdivided population</article-title>. <source>Genetical research</source> <volume>71</volume> (<issue>02</issue>), <fpage>155</fpage>&#x2013;<lpage>160</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Song</surname>, <given-names>Y.</given-names></string-name>, <string-name><given-names>S.</given-names> <surname>Endepols</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Klemann</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Richter</surname></string-name>, <string-name><given-names>F.-R.</given-names> <surname>Matuschka</surname></string-name>, <string-name><given-names>C.-H.</given-names> <surname>Shih</surname></string-name>, <string-name><given-names>M. W.</given-names> <surname>Nachman</surname></string-name>, and <string-name><given-names>M. H.</given-names> <surname>Kohn</surname></string-name> (<year>2011</year>). <article-title>Adaptive introgression of anticoagulant rodent poison resistance by hybridization between old world mice</article-title>. <source>Current Biology</source> <volume>21</volume> (<issue>15</issue>), <fpage>1296</fpage>&#x2013;<lpage>1301</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Stern</surname>, <given-names>D. L.</given-names></string-name> (<year>2013</year>, 11). <article-title>The genetic causes of convergent evolution</article-title>. <source>Nat Rev Genet</source> <volume>14</volume> (<issue>11</issue>), <fpage>751</fpage>&#x2013;<lpage>764</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Thompson</surname>, <given-names>E. A.</given-names></string-name> (<year>2013</year>). <article-title>Identity by descent: Variation in meiosis, across genomes, and in populations</article-title>. <source>Genetics</source> <volume>194</volume> (<issue>2</issue>), <fpage>301</fpage>&#x2013;<lpage>326</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Tishkoff</surname>, <given-names>S. A.</given-names></string-name>, <string-name><given-names>F. A.</given-names> <surname>Reed</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Ranciaro</surname></string-name>, <string-name><given-names>B. F.</given-names> <surname>Voight</surname></string-name>, <string-name><given-names>C. C.</given-names> <surname>Babbitt</surname></string-name>, <string-name><given-names>J. S.</given-names> <surname>Silverman</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Powell</surname></string-name>, <string-name><given-names>H. M.</given-names> <surname>Mortensen</surname></string-name>, <string-name><given-names>J. B.</given-names> <surname>Hirbo</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Osman</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Ibrahim</surname></string-name>, <string-name><given-names>S. A.</given-names> <surname>Omar</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Lema</surname></string-name>, <string-name><given-names>T. B.</given-names> <surname>Nyambo</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Ghori</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Bump-stead</surname></string-name>, <string-name><given-names>J. K.</given-names> <surname>Pritchard</surname></string-name>, <string-name><given-names>G. A.</given-names> <surname>Wray</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Deloukas</surname></string-name> (<year>2007</year>, Jan). <article-title>Convergent adaptation of human lactase persistence in Africa and Europe</article-title>. <source>Nat Genet</source> <volume>39</volume> (<issue>1</issue>), <fpage>31</fpage>&#x2013;<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Turner</surname>, <given-names>T.</given-names></string-name>, <string-name><given-names>E.</given-names> <surname>Bourne</surname></string-name>, <string-name><given-names>E. V.</given-names> <surname>Wettberg</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Hu</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Nuzhdin</surname></string-name> (<year>2010</year>, January). <article-title>Population resequencing reveals local adaptation of Arabidopsis lyrata to serpentine soils</article-title>. <source>Nat. Genet</source>. <volume>42</volume> (<issue>3</issue>), <fpage>260</fpage>&#x2013;<lpage>3</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="other"><string-name><surname>Varin</surname>, <given-names>C.</given-names></string-name>, <string-name><given-names>N.</given-names> <surname>Reid</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Firth</surname></string-name> (<year>2011</year>). <article-title>An overview of composite likelihood methods</article-title>. <source>Statistica Sinica</source>, <fpage>5</fpage>&#x2013;<lpage>42</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Weir</surname>, <given-names>B. S.</given-names></string-name> and <string-name><given-names>W. G.</given-names> <surname>Hill</surname></string-name> (<year>2002</year>). <article-title>Estimating F-statistics</article-title>. <source>Annual Review of Genetics</source> <volume>36</volume>, <fpage>721</fpage>&#x2013;<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Welch</surname>, <given-names>J. J.</given-names></string-name> and <string-name><given-names>C. D.</given-names> <surname>Jiggins</surname></string-name> (<year>2014</year>). <article-title>Standing and flowing: the complex origins of adaptive variation</article-title>. <source>Molecular Ecology</source> <volume>23</volume> (<issue>16</issue>), <fpage>3935</fpage>&#x2013;<lpage>3937</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Wiuf</surname>, <given-names>C.</given-names></string-name> (<year>2006</year>). <article-title>Consistency of estimators of population scaled parameters using composite likelihood</article-title>. <source>Journal of mathematical biology</source> <volume>53</volume> (<issue>5</issue>), <fpage>821</fpage>&#x2013;<lpage>841</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Wood</surname>, <given-names>T. E.</given-names></string-name>, <string-name><given-names>J. M.</given-names> <surname>Burke</surname></string-name>, and <string-name><given-names>L. H.</given-names> <surname>Rieseberg</surname></string-name> (<year>2005</year>, 02). <article-title>Parallel genotypic adaptation: when evolution repeats itself</article-title>. <source>Genetica</source> <volume>123</volume> (<issue>1-2</issue>), <fpage>157</fpage>&#x2013;<lpage>170</lpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="other"><string-name><surname>Wright</surname>, <given-names>K. M.</given-names></string-name>, <string-name><given-names>U.</given-names> <surname>Hellsten</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Xu</surname></string-name>, <string-name><given-names>A. L.</given-names> <surname>Jeong</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Sreedasyam</surname></string-name>, <string-name><given-names>J. A.</given-names> <surname>Chapman</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Schmutz</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Coop</surname></string-name>, <string-name><given-names>D. S.</given-names> <surname>Rokhsar</surname></string-name>, and <string-name><given-names>J. H.</given-names> <surname>Willis</surname></string-name> (<year>2015</year>). <article-title>Adaptation to heavy-metal contaminated environments proceeds via selection on pre-existing genetic variation</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Wright</surname>, <given-names>S.</given-names></string-name> (<year>1943</year>). <article-title>Isolation by distance</article-title>. <source>Genetics</source> <volume>28</volume> (<issue>2</issue>), <fpage>114</fpage>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><surname>Wright</surname>, <given-names>S.</given-names></string-name> (<year>1951</year>, March). <article-title>The genetical structure of populations</article-title>. <source>Annals of Eugenics</source> <volume>15</volume> (<issue>4</issue>), <fpage>323</fpage>&#x2013;<lpage>354</lpage>.</mixed-citation></ref>
</ref-list>
<sec>
<title>S1 Supplemental tables and figures</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Figure S1:</label>
<caption><p>MCLE of <bold>parameters</bold> for <bold>independent mutation</bold> simulations <bold>allowing selected site to vary</bold>.</p>
</caption>
<graphic xlink:href="119578_figS1.tif"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Figure S2:</label>
<caption><p>Average coancestry coefficient values for migration simulations with various <italic>m</italic>, across 100 runs of simulations for each of 100 bins of distance away from the selected site, showing the migration rate parameter does not have a large effect on both expectations (solid lines) and simulation results (dashed lines). For all simulations, <italic>s</italic> &#x003D; 0.01, <italic><italic>N<sub>e</sub></italic></italic> &#x003D; 10, 000, and the source of the beneficial allele is population 2.</p>
</caption>
<graphic xlink:href="119578_figS2.tif"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Figure S3:</label>
<caption><p>Average coancestry coefficient values for migration simulations across 100 runs of simulations for each of 100 bins of distance away from the selected site, between source and recipient populations and non-selected populations (s &#x003D; 0.01, <italic>m</italic> &#x003D; 0.001, <italic>N<sub>e</sub></italic> &#x003D; 10,000).</p>
</caption>
<graphic xlink:href="119578_figS3.tif"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Figure S4:</label>
<caption>
<p>MCLE of <bold>parameters</bold> for <bold>migration model</bold> simulations. We vary the true value of the parameter used for simulations along the x-axis and show the MCLE for each of 100 simulations (points). Crossbars indicate first and third quartiles with second quartiles (medians) as the horizontal line. The true values of the parameters are marked with dashed, black lines.</p>
</caption>
<graphic xlink:href="119578_figS4.tif"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Figure S5:</label>
<caption><p>Coancestry coefficient for the recipient population as a function of recombination distance from the selected site, partitioned into simulations with MCLE for <italic>m</italic> &#x003D;1 and <italic>m</italic> &#x003C; 1 (s &#x003D; 0.01, <italic>m</italic> &#x003D; 0.001, <italic>N<sub>e</sub></italic> &#x003D; 10,000).</p>
</caption>
<graphic xlink:href="119578_figS5.tif"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Figure S6:</label>
<caption><p>MCLE of selection coefficients for 100 simulations under standing variant model (10 chromosomes per population, <italic>N<sub>e</sub></italic> &#x003D; 10,000, <italic>t</italic> &#x003D; 500, <italic>g</italic> &#x003D; 0.001). We vary the true value of the parameter used for simulations along the x-axis and show the MCLE for each of 100 simulations (points). Crossbars indicate first and third quartiles with second quartiles (medians) as the horizontal line. The true values of the parameters are marked with dashed, black lines.</p>
</caption>
<graphic xlink:href="119578_figS6.tif"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Figure S7:</label>
<caption>
<p>Inference results for standing variant model applied to <italic>Mimulus</italic> data using both original standing variant model and more complex model where a source population is specified. In this case, the composite log-likelihoods do not change, but the parameter estimates do. We obtain higher MCLE for <italic>t</italic> when a source is specified (646 generations) compared to the original no source model (434 generations). This fits our expectation as <italic>t</italic> has slightly different interpretations under the two models.</p>
</caption>
<graphic xlink:href="119578_figS7.tif"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Figure S8:</label>
<caption><p>Composite log-likelihood for <italic>Fundulus heteroclitus</italic> pollutant tolerance adaptation on Scaf-fold9893, showing all possible sources for models with migration and standing variant model, as a function of the proposed selected site.</p>
</caption>
<graphic xlink:href="119578_figS8.tif"/>
</fig>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for simulated datasets</p>
</caption>
<graphic xlink:href="119578_tblS1.tif"/>
</table-wrap>
<table-wrap id="tblS2" orientation="portrait" position="float">
<label>Table S2:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for independent sweep model simulations</p>
</caption>
<graphic xlink:href="119578_tblS2.tif"/>
</table-wrap>
<table-wrap id="tblS3" orientation="portrait" position="float">
<label>Table S3:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for independent sweep model simulations when position of selected site varies</p>
</caption>
<graphic xlink:href="119578_tblS3.tif"/>
</table-wrap>
<table-wrap id="tblS4" orientation="portrait" position="float">
<label>Table S4:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for migration model simulations</p>
</caption>
<graphic xlink:href="119578_tblS4.tif"/>
</table-wrap>
<table-wrap id="tblS5" orientation="portrait" position="float">
<label>Table S5:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for standing variation model simulations</p>
</caption>
<graphic xlink:href="119578_tblS5.tif"/>
</table-wrap>
<table-wrap id="tblS6" orientation="portrait" position="float">
<label>Table S6:</label>
<caption>
<p>Neutral <bold>F</bold> matrix from 12 scaffolds with no strong signatures of selection in <italic>Mimulus guttatus</italic> populations (Scaffold7 and regions adjacent to scaffolds 1, 4, 8, 47, 80, 84, 106, 115, 129, 148, 198). Populations 1 and 3 are copper tolerant.</p>
</caption>
<graphic xlink:href="119578_tblS6.tif"/>
</table-wrap>
<table-wrap id="tblS7" orientation="portrait" position="float">
<label>Table S7:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for <italic>Mimulus</italic></p>
</caption>
<graphic xlink:href="119578_tblS7.tif"/>
</table-wrap>
<table-wrap id="tblS8" orientation="portrait" position="float">
<label>Table S8:</label>
<caption>
<p>Neutral F matrix from four scaffolds with no strong signatures of selection in <italic>Fundulus heteroclitus</italic> populations (Scaffold0, Scaffold1, Scaffold2, Scaffold3)</p>
</caption>
<graphic xlink:href="119578_tblS8.tif"/>
</table-wrap>
<table-wrap id="tblS9" orientation="portrait" position="float">
<label>Table S9:</label>
<caption>
<p>Parameter spaces for composite likelihood calculations for <italic>Fundulus</italic></p>
</caption>
<graphic xlink:href="119578_tblS9.tif"/>
</table-wrap>
</sec>
</back>
</article>