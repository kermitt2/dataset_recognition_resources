<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/019588</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Pseudotime estimation: deconfounding single cell time series</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Reid</surname>
<given-names>John</given-names>
</name>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wernisch</surname>
<given-names>Lorenz</given-names>
</name>
</contrib>
</contrib-group>
<pub-date pub-type="epub">
<year>2015</year>
</pub-date>
<elocation-id>019588</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
</license>
</permissions>
<self-uri xlink:href="019588.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Cross-sectional time series single cell data confound several sources of variation, with contributions from measurement noise, stochastic cell to cell variation and cell progression at different rates. Time series from single cell assays are particularly susceptible to confounding as the measurements are not averaged over populations of cells. When several genes are assayed in parallel these effects can be estimated and corrected for under certain smoothness assumptions on cell progression. We present a principled probabilistic model with a Bayesian inference scheme to analyse such data. We demonstrate our method&#x2019;s utility on public microarray, nCounter and RNA-seq data sets from three organisms. Our method almost perfectly recovers withheld capture times in an <italic>Arabidopsis</italic> data set, it accurately estimates cell cycle peak times in a human prostate cancer cell line and it correctly identifies two precocious cells in a study of paracrine signalling in mouse dendritic cells. Furthermore, our method compares favourably with Monocle, a state-of-the-art technique. We also show using held out data that uncertainty in the temporal dimension is a common confounder and should be accounted for in analyses of cross-sectional time series.</p>
</abstract>
<counts>
<page-count count="20"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<sec id="s1a">
<label>1.1</label>
<title>Cross-sectional time series</title>
<p>Many biological systems involve transitions between cellular states characterised by gene expression signatures. These systems are typically studied by assaying gene expression over a time course to investigate which genes regulate the transitions. An ideal study of such a system would track individual cells through the transitions between states. Studies of this form are termed <italic>longitudinal</italic>. However current medium and high-throughput assays used to measure gene expression destroy cells as part of the protocol. This results in <italic>cross-sectional</italic> data wherein each sample is taken from a different cell.</p>
<p>This study analyses the problem of variation in the temporal dimension: cells do not necessarily transition at a common rate between states. Even if several cells about to undergo a transition are synchronised by an external signal, when samples are taken at a later time point each cell may have reached a different point in the transition. This suggests a notion of pseudotime to model these systems. Pseudotime is a latent (unobserved) dimension which measures the cells&#x2019; progress through the transition. Pseudotime is related to but not necessarily the same as laboratory capture time.</p>
<p>Variation in the temporal dimension is a particular problem in cross-sectional studies as each sample must be assigned a pseudotime individually. In longitudinal studies information can be shared across measurements from the same cell at different times.</p>
<p>Inconsistency in the experimental protocol is another source of variation in the temporal dimension. It may not be physically possible to assay several cells at precisely the same time point. This leads naturally to the idea that the cells should be ordered by the pseudotime they were assayed.</p>
</sec>
<sec id="s1b">
<label>1.2</label>
<title>Single cell assays</title>
<p>The exploration of cell-to-cell heterogeneity of expression levels has recently been made possible by single cell assays. Many authors have investigated various biological systems using medium throughput technologies such as qPCR [<xref rid="c1" ref-type="bibr">1</xref>&#x2013;<xref rid="c4" ref-type="bibr">4</xref>] and nCounter [<xref rid="c5" ref-type="bibr">5</xref>, <xref rid="c6" ref-type="bibr">6</xref>] or high throughput technologies such as RNA-seq [<xref rid="c7" ref-type="bibr">7</xref>&#x2013;<xref rid="c14" ref-type="bibr">14</xref>]. These studies have shown that cellular heterogeneity is prevalent in many organisms and regulatory systems. The variation in gene expression underlying this cellular heterogeneity has been attributed to several causes both technical and biological [<xref rid="c3" ref-type="bibr">3</xref>, <xref rid="c8" ref-type="bibr">8</xref>&#x2013;<xref rid="c10" ref-type="bibr">10</xref>]. Whilst accounting for variation in expression levels, none of these studies investigated how much is attributable to uncertainty in the temporal dimension. Conversely, methods such as Monocle and Wanderlust (described below) have attempted to place cells in a pseudotemporal ordering but do not explicitly model variation in the data.</p>
</sec>
<sec id="s1c">
<label>1.3</label>
<title>Dimension reduction</title>
<p>Analyses of medium and high-throughput expression assays often use dimension reduction techniques. Anywhere between forty and several tens of thousands of gene expression levels may have been measured in each sample. This high-dimensional data can often be better analysed after projection into a low (two or three) dimensional latent space. Often this projection results in a natural clustering of cells from different time points or of different cell types which can then be related to the biology of the system. Such clusterings may suggest hypotheses about likely transitions between clusters and their relationship in time.</p>
<p>Dimension reduction has a large literature and there are many available methods, here we give a few examples of some that have been used in single cell expression analyses.</p>
<p>Principal components analysis (PCA) is prevalent in analyses of expression data [<xref rid="c7" ref-type="bibr">7</xref>, <xref rid="c8" ref-type="bibr">8</xref>, <xref rid="c11" ref-type="bibr">11</xref>, <xref rid="c14" ref-type="bibr">14</xref>]. PCA finds linear transformations of the data that preserve as much of the variance as possible. In one example typical of single cell transcriptomics, Guo et al. studied the development of the mouse blastocyst from the one cell stage to the 64 cell stage [<xref rid="c1" ref-type="bibr">1</xref>]. They projected their 48-dimensional qPCR data into two dimensions using PCA. Projection into these two dimensions clearly separated the three cell types present in the 64 cell stage.</p>
<p>Multi-dimensional scaling (MDS) is another popular dimension reduction technique. MDS aims to place each sample in a lower dimensional space such that distances between samples are conserved as much as possible. Kouno et al. used MDS to study the differentiation of THP-1 human myeloid monocytic leukemia cells into macrophages after stimulation with PMA [<xref rid="c3" ref-type="bibr">3</xref>]. Their primary MDS axis explained the temporal progression through the differentiation, their secondary MDS axis explained the early-response of the cells to the stimulation they had undergone.</p>
<p>Independent components analysis (ICA) projects high dimensional data into a latent space that maximises the statistical independence of the projected axes. Trapnell et al. used ICA to investigate the differentiation of primary human myoblasts [<xref rid="c12" ref-type="bibr">12</xref>]. The latent space serves as a first stage in their pseudotime estimation algorithm Monocle (see below).</p>
<p>Gaussian process latent variable models (GPLVMs) are a dimension reduction technique related to PCA. They can be seen as a non-linear extension [<xref rid="c15" ref-type="bibr">15</xref>] to a probabilistic interpretation of PCA [<xref rid="c16" ref-type="bibr">16</xref>]. Buettner et al. used GPLVMs to study the differentiation of cells in the mouse blastocyst [<xref rid="c17" ref-type="bibr">17</xref>, <xref rid="c18" ref-type="bibr">18</xref>]. They used qPCR data from Guo et al. who had analysed the expression of 48 genes in cells spanning the 1- to 64-cell stages of blastocyst development [<xref rid="c1" ref-type="bibr">1</xref>]. Buettner et al. were able to uncover subpopulations of cells at the 16-cell stage, one stage earlier than Guo et al. had identified using PCA.</p>
<p>The latent space in all of the methods above is unstructured: there is no direct physical or biological interpretation of the space and the methods do not directly relate experimental covariates such as cell type or capture time to the space. The samples are placed in the space only to maximise some relevant statistic, although the analysis often reveals some additional structure. For example, one axis may coincide with the temporal dimension of the data, or cell types may be clearly separated. In these cases the structure has been inferred in an unsupervised manner. However there is no guarantee that the methods above will uncover any specific structure of interest, for example, a pseudotime ordering.</p>
<p>Here we propose to impose an a priori structure on the latent space. In the model presented in this paper the latent space is one-dimensional and the structure we impose on the space relates it to the temporal information of the cell capture times. That is the latent space represents the pseudotime.</p>
</sec>
<sec id="s1d">
<label>1.4</label>
<title>Pseudotime estimation</title>
<p>A number of methods have been proposed to estimate pseudotimes in gene expression time series. &#x00C4;ij&#x00F6; et al. proposed a temporal scaling method DyNB to estimate pseudotimes [<xref rid="c19" ref-type="bibr">19</xref>]. DyNB shifts the observed time by a multiplicative factor representing speed of transition through the process. It is applicable to longitudinal rather than cross-sectional time series. &#x00C4;ij&#x00F6; et al. modelled RNA-seq count data from human Th17 cell differentiation using a negative binomial distribution with a time-varying mean. The time-varying mean was fit using a Gaussian process over the scaled pseudotime space. They compared this pseudotime based model favourably with a similar model that only used the capture time points.</p>
<p>Trapnell et al. have developed the Monocle pseudotime estimation algorithm [<xref rid="c12" ref-type="bibr">12</xref>]. Monocle is a two-stage procedure: first it uses the ICA dimension reduction algorithm to map gene expression data into a low-dimensional space; second it finds the minimal spanning tree over the samples&#x2019; locations in this space. This spanning tree is used to assign a pseudotime to each cell. Trapnell et al. show how Monocle can be used to identify pseudotemporal ordering, switch-like changes in expression, novel regulatory factors and sequential waves of gene regulation.</p>
<p>Wanderlust is a graph-based pseudotime estimation algorithm developed by Bendall et al. [<xref rid="c20" ref-type="bibr">20</xref>]. Wanderlust arranges the high-dimensional input data into a nearest neighbour graph wherein cells that have similar expression profiles are connected. Wanderlust then applies a repetitive randomised shortest path algorithm to assign an average pseudotime to each cell. Bendall et al. used Wanderlust to analyse human B cell lymphopoiesis.</p>
<p>Both of the Monocle and Wanderlust algorithms do not explicitly make a connection between the cell capture times and the estimated pseudotime. This has two effects: first in the inference of the pseudotime, nonsensical results are possible such as pseudotimes whose order is far from the capture times; second the estimated pseudotimes are not on the same scale as the capture times, they are quantified in arbitrary temporal units.</p>
</sec>
<sec id="s1e">
<label>1.5</label>
<title>Gaussian processes</title>
<p>Gaussian processes (GPs) are Bayesian models that are well suited to model expression profiles and capture the uncertainty inherent in noisy data. Bayesian inference in GPs can be performed analytically and provides posterior mean estimates with a full covariance structure. A GP is parameterised by a mean and a covariance function. For more details, Rasmussen and Williams have published a comprehensive review [<xref rid="c21" ref-type="bibr">21</xref>].</p>
<p>GPs have been used extensively to model time series and other phenomena in biological systems: Stegle et al. designed a two-sample test for differential expression between time series using GPs [<xref rid="c22" ref-type="bibr">22</xref>]; Honkela et al. used GPs to model expression profiles of transcription factors in an ODE based model of gene regulation [<xref rid="c23" ref-type="bibr">23</xref>]; &#x00C4;ij&#x00F6; et al. used GP models of regulatory functions to infer gene networks [<xref rid="c24" ref-type="bibr">24</xref>]; and Kirk et al. used GPs to model time series in a multiple dataset integration method [<xref rid="c25" ref-type="bibr">25</xref>].</p>
</sec>
</sec>
<sec id="s2">
<label>2</label>
<title>Methods</title>
<sec id="s2a">
<label>2.1</label>
<title>Data</title>
<p>Our method has been designed to analyse single cell data but there is no technical reason why each sample must be from a cell. The model itself and notion of pseudotime would suit many cross-sectional data sets. Indeed one of the data sets used in our results section is from whole leaf microarray assays. However for consistency of explanation we refer to each sample as a cell in this paper.</p>
<p>Our method works on data with a simple structure. First, it expects gene expression data on a logarithmic scale, such as Ct values from qPCR experiments or log transformed counts from RNA-seq experiments. Second, it requires a <italic>capture time</italic> for each cell. This specifies at which time point that cell was sampled.</p>
<p>Our notation for the data is: <italic>G</italic> is the number of genes assayed; <italic>C</italic> is the number of cells sampled; <italic>x</italic><sub><italic>g,c</italic></sub> is the expression level of gene <italic>g</italic> in cell <italic>c</italic> where 1 <italic>&#x2264; g &#x2264; G</italic> and 1 <italic>&#x2264; c &#x2264; C</italic>; the capture time of cell <italic>c</italic> is <italic>k</italic><sub><italic>c</italic></sub> where <italic>k</italic><sub><italic>c</italic></sub> <italic>&#x2208;</italic> {<italic>&#x03BA;</italic><sub>1</sub>, <italic>&#x03BA;</italic><sub>2</sub>,&#x2026;, <italic>&#x03BA;</italic><sub><italic>T</italic></sub>}; and <italic>T</italic> is the number of distinct capture times.</p>
<sec id="s2a1">
<label>2.1.1</label>
<title>Cell size adjustment</title>
<p>Single cell expression measurements can often contain per-cell biases that present as differences in basal levels of transcription. These can be caused by biological effects such as cell size or technical effects such as lysis efficiency or sequencing depth. We use a technique based on the method proposed by Anders and Huber to account for these effects [<xref rid="c26" ref-type="bibr">26</xref>].</p>
<p>Given a subset of the genes &#x1D4A2; &#x2286; {1, <italic>&#x2026;, G</italic>} and a subset of the cells &#x1D49E; &#x2286; {1, <italic>&#x2026;, C</italic>} we define the cell size for cell c &#x2208; &#x1D49E; as
<disp-formula id="eqn1">
<alternatives>
<graphic xlink:href="019588_eqn1.gif"/>
</alternatives>
</disp-formula></p>
<p>The median is used as it provides a robust estimate of the differences across genes. We estimate the cell sizes separately for the cells grouped by capture time,
<disp-formula id="ueqn1">
<alternatives>
<graphic xlink:href="019588_ueqn1.gif"/>
</alternatives>
</disp-formula>
only using those genes that are expressed in at least half of the cells,
<disp-formula id="ueqn2">
<alternatives>
<graphic xlink:href="019588_ueqn2.gif"/>
</alternatives>
</disp-formula>
and apply the cell size as a correction to the raw data
<disp-formula id="eqn2">
<alternatives>
<graphic xlink:href="019588_eqn2.gif"/>
</alternatives>
</disp-formula>
where <italic>t</italic> is such that <italic>k</italic><sub><italic>c</italic></sub> = <italic>&#x03BA;</italic><sub><italic>t</italic></sub>. In all that follows we use <inline-formula><alternatives><inline-graphic xlink:href="019588_inline1.gif"/></alternatives></inline-formula> rather than <italic>x</italic><sub><italic>g,c</italic></sub> as our expression data.</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Model</title>
<p>The primary latent variables in our model are the pseudotimes. The model assigns a pseudotime to each cell such that the induced gene expression profiles over the latent pseudotime space have low noise levels and are smooth.</p>
<p>Our model captures several aspects of the data: first, the data are noisy which we model in a gene-specific fashion; second, we expect the expression profiles to be smooth; third, we expect the pseudotime of each cell not to stray too far from its capture time.</p>
<p>The model can be split into several parts: one part represents the gene expression profiles; another part represents the pseudotimes associated with each cell; and another part links the expression data to the profiles.</p>
<sec id="s2b1">
<label>2.2.1</label>
<title>Gene expression profiles</title>
<p>The expression profiles are modelled using Gaussian processes. The expression profile <italic>y</italic><sub><italic>g</italic></sub> of gene <italic>g</italic> is a draw from a Gaussian process
<disp-formula id="eqn3">
<alternatives>
<graphic xlink:href="019588_eqn3.gif"/>
</alternatives>
</disp-formula>
where <italic>&#x03D5;</italic><sub><italic>g</italic></sub> is a (constant) gene-specific mean function estimated from the data and &#x03A3;<sub><italic>g</italic></sub> is a gene-specific covariance function. The expression profiles are functions of pseudotime and as such the covariance function relates two pseudotimes.
<disp-formula id="eqn4">
<alternatives>
<graphic xlink:href="019588_eqn4.gif"/>
</alternatives>
</disp-formula></p>
<p>Here &#x03A3;<sub><italic>&#x03C4;</italic></sub> is a covariance function that defines the covariance structure over the pseudotimes. &#x03A3;<sub><italic>&#x03C4;</italic></sub> imposes the smoothness constraints that are shared across genes; <italic>&#x03C8;</italic><sub><italic>g</italic></sub> parameterises the amount of temporal variation this gene profile has; and <italic>&#x03C9;</italic><sub><italic>g</italic></sub> models the noise levels for this gene. Log-normal priors for the <italic>&#x03C8;</italic><sub><italic>g</italic></sub> and <italic>&#x03C9;</italic><sub><italic>g</italic></sub> are parameterised as
<disp-formula id="eqn5">
<alternatives>
<graphic xlink:href="019588_eqn5.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn6">
<alternatives>
<graphic xlink:href="019588_eqn6.gif"/>
</alternatives>
</disp-formula></p>
</sec>
<sec id="s2b2">
<label>2.2.2</label>
<title>Pseudotimes</title>
<p>The pseudotime <italic>&#x03C4;</italic><sub><italic>c</italic></sub> for cell <italic>c</italic> is given a prior centred on the time the cell was captured.
<disp-formula id="eqn7">
<alternatives>
<graphic xlink:href="019588_eqn7.gif"/>
</alternatives>
</disp-formula></p>
<p>Each <italic>&#x03C4;</italic><sub><italic>c</italic></sub> is used in the calculation of the covariance structure over pseudotimes &#x03A3;<sub><italic>&#x03C4;</italic></sub>. &#x03A3;<sub><italic>&#x03C4;</italic></sub> is taken to be a Matern<sub>3/2</sub> covariance function. Our experience shows that this function captures our smoothness constraints well although any reasonable covariance function could be used.
<disp-formula id="eqn8">
<alternatives>
<graphic xlink:href="019588_eqn8.gif"/>
</alternatives>
</disp-formula>
where <italic>l</italic> is a length-scale hyperparameter shared across the genes.</p>
<p>For cyclic data such as from the cell cycle or circadian rhythms we expect the expression profiles to be periodic. We can model this explicitly by a transformation of <italic>r</italic> in <xref rid="eqn8" ref-type="disp-formula">Equation (8)</xref>. We replace <italic>r</italic> by <italic>r</italic><sub>&#x2126;</sub>
<disp-formula id="eqn9">
<alternatives>
<graphic xlink:href="019588_eqn9.gif"/>
</alternatives>
</disp-formula></p>
<p>This has the effect of restricting the GP prior to periodic functions with period &#x2126;.</p>
</sec>
<sec id="s2b3">
<label>2.2.3</label>
<title>Expression data</title>
<p>The model links the expression data to the expression profiles by evaluating the profiles at the pseudotimes.
<disp-formula id="eqn10">
<alternatives>
<graphic xlink:href="019588_eqn10.gif"/>
</alternatives>
</disp-formula></p>
</sec>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Relationship to other models</title>
<p>Briefly, our model can be interpreted as a one-dimensional GPLVM with a prior structure on the latent pseudotime space. The GPLVM model is a non-linear version of probabilistic PCA. In probabilistic PCA, the locations of the data in the latent space are given a Gaussian prior with zero mean and unit covariance. In our model the analogous latent variables are the pseudotimes. Our model gives the pseudotimes a structured prior rather than a standard normal: that is we relate the latent pseudotimes to the capture times of the cells using a Gaussian prior.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Hyperparameter estimation</title>
<p>All of the hyperparameters <italic>&#x03BC;</italic><sub><italic>&#x03C8;</italic></sub>, <italic>&#x03C3;</italic><sub><italic>&#x03C8;</italic></sub>, <italic>&#x03BC;</italic><sub><italic>&#x03C9;</italic></sub>, <italic>&#x03C3;</italic><sub><italic>&#x03C9;</italic></sub> are estimated by an empirical Bayes procedure described below. The hyperparameters <italic>l, &#x03C3;<sub>&#x03C4;</sub></italic> are supplied directly by the user of our method.</p>
<p>As with many hierarchical models, the parameters can have several posterior modes. For instance, much of the variation in typical single cell assay data could be explained by smooth expression profiles with high noise levels. Alternatively the same data could also be explained by rough expression profiles with low noise levels. Our model aims to balance these conflicting explanations and find parameters to fit the data with reasonable noise levels and expression profiles that are neither too smooth nor too rough. Selecting suitable hyperparameters for the parameter priors is important to avoid unrealistic regions of parameter space. We have found an empirical Bayes approach useful in this regard.</p>
<p>We need to estimate how much of the variation in the data is due to noise and how much is due to temporal variation in the underlying expression profiles. We use a simple approach that might slightly overestimate both sources of variation but works well enough in our experience. First we group the expression measurements by gene and capture time to calculate means and variances.
<disp-formula id="eqn11">
<alternatives>
<graphic xlink:href="019588_eqn11.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn12">
<alternatives>
<graphic xlink:href="019588_eqn12.gif"/>
</alternatives>
</disp-formula></p>
<p>We estimate the gene-specific noise levels by assuming that all the within-time variation in the data is due to noise
<disp-formula id="eqn13">
<alternatives>
<graphic xlink:href="019588_eqn13.gif"/>
</alternatives>
</disp-formula>
for each gene <italic>g</italic>. This ignores any effect the temporal variation may have had on the observed variance in the data and should overestimate the <italic>&#x03C9;</italic><sub><italic>g</italic></sub>.</p>
<p>To estimate the temporal variation, we examine the between time variation in the data. However we need to account for the effect of the covariance function &#x03A3;<sub><italic>&#x03C4;</italic></sub>, which models the variation over time. We evaluate &#x03A3;<sub><italic>&#x03C4;</italic></sub> at the observed capture times to estimate the covariance of samples from the capture times. This gives a covariance matrix <inline-formula><alternatives><inline-graphic xlink:href="019588_inline2.gif"/></alternatives></inline-formula> where
<disp-formula id="eqn14">
<alternatives>
<graphic xlink:href="019588_eqn14.gif"/>
</alternatives>
</disp-formula></p>
<p>It can be shown (see Appendix 5.1) that a sample from a zero mean Gaussian with covariance matrix &#x03A3; is expected to have a variance of
<disp-formula id="eqn15">
<alternatives>
<graphic xlink:href="019588_eqn15.gif"/>
</alternatives>
</disp-formula></p>
<p>Using the linearity of this result the expected variance of samples from expression profile <italic>y</italic><sub><italic>g</italic></sub> at the capture times <italic>&#x03BA;</italic><sub>1</sub>,&#x2026;,<italic>&#x03BA;</italic><sub><italic>T</italic></sub> are expected to have variance equal to
<disp-formula id="eqn16">
<alternatives>
<graphic xlink:href="019588_eqn16.gif"/>
</alternatives>
</disp-formula></p>
<p>We slightly overestimate <italic>&#x03C8;</italic><sub><italic>g</italic></sub> by setting
<disp-formula id="eqn17">
<alternatives>
<graphic xlink:href="019588_eqn17.gif"/>
</alternatives>
</disp-formula>
where the overestimation is caused by ignoring the effect of <italic>&#x03C9;</italic><sub><italic>g</italic></sub> on the expected variance. This should be a small effect as we average over multiple cells per capture time.</p>
<p>Using these estimates for <italic>&#x03C8;</italic><sub><italic>g</italic></sub> and <italic>&#x03C9;</italic><sub><italic>g</italic></sub> we empirically set the hyperparameters of the model as
<disp-formula id="eqn18">
<alternatives>
<graphic xlink:href="019588_eqn18.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn19">
<alternatives>
<graphic xlink:href="019588_eqn19.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn20">
<alternatives>
<graphic xlink:href="019588_eqn20.gif"/>
</alternatives>
</disp-formula>
<disp-formula id="eqn21">
<alternatives>
<graphic xlink:href="019588_eqn21.gif"/>
</alternatives>
</disp-formula></p>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>Inference</title>
<p>Our model is coded using the Stan probabilistic modelling language [<xref rid="c27" ref-type="bibr">27</xref>]. The Stan package provides various inference algorithms. In this work we have used the No-U-Turn Hamiltonian Markov chain Monte Carlo sampler (NUTS) [<xref rid="c28" ref-type="bibr">28</xref>]. In theory using a MCMC sampler gives us samples from the full posterior of the model. However the model is multimodal with respect to the pseudotime assignments and this makes it sometimes difficult for the sampler to mix samples from the full posterior. The multimodality occurs as there may be many pseudotemporal orderings of the cells that give smooth expression profiles. Moving between these modes is difficult for the sampler since in order to change the order of cells they must pass each other in pseudotime. If the cells&#x2019; expression profiles are sufficiently different the likelihood of the sampler passing this configuration can be very low. In these cases the sampler may only visit a few modes of the posterior. This difficulty in mixing is not unique to our model. Many other models such as K-means clustering exhibit similar behaviour. In these models it is common practice to use a single sample as a point estimate of the latent variables. Typically the sample with the highest probability under the model is selected. The Stan NUTS sampler provides <italic>&#x0158;</italic> statistics that give confidence in the mixing over pseudotime [<xref rid="c29" ref-type="bibr">29</xref>]. These statistics can be evaluated on a dataset-by-dataset basis and a point estimate or the full posterior can be used for further analysis.</p>
<p>In order to further mitigate the pseudotime mixing problem we use a naive heuristic to initialise our MCMC chains. We sample many (by default, 6000) sets of pseudotimes from the prior and evaluate their likelihood (in combination with empirical Bayes estimates of the other parameters). We initialise our chains with the pseudotimes with highest likelihoods. This naive approach could almost certainly be improved upon but it is superior to using random samples from the prior to initialise the chains (data not shown).</p>
</sec>
<sec id="s2f">
<label>2.6</label>
<title>Validation</title>
<p>In the results section we analyse specific data sets and validate the inferences from our model in several biological contexts. However we also wished to validate our model technically. We base this technical validation on the smoothness of expression profiles induced on held out genes. The held out genes are not used during model fitting and are only used in the validation stage. To evaluate the smoothness we developed a basic statistic to capture this concept. Given expression values <inline-formula><alternatives><inline-graphic xlink:href="019588_inline3.gif"/></alternatives></inline-formula> for a held out gene <italic>g</italic> over cells 1 &#x2264; <italic>c</italic> &#x2264; <italic>C</italic>, pseudotimes <italic>&#x03C4;</italic><sub>1</sub>,&#x2026;, <italic>&#x03C4;</italic><sub><italic>C</italic></sub> and an ordering <italic>z</italic><sub>1</sub>,&#x2026;,<italic>z</italic><sub><italic>C</italic></sub> such that
<disp-formula id="ueqn3">
<alternatives>
<graphic xlink:href="019588_ueqn3.gif"/>
</alternatives>
</disp-formula>
we define the roughness of the gene in terms of the differences of consecutive expression measurements under the ordering given by the pseudotimes
<disp-formula id="eqn22">
<alternatives>
<graphic xlink:href="019588_eqn22.gif"/>
</alternatives>
</disp-formula>
where <italic>&#x03C3;</italic><sub><italic>g</italic></sub> is the standard deviation of the expression measurements. Clearly low <italic>R</italic><sub><italic>g</italic></sub> values should correlate with smooth profiles and high <italic>R</italic><sub><italic>g</italic></sub> values should correlate with rough profiles.</p>
<p>One benefit of defining <italic>R</italic><sub><italic>g</italic></sub> in terms of the pseudotime ordering rather than the pseudotime itself is that it is easy to generate random orderings under a suitable null hypothesis. The null hypothesis we use is that the cells are ordered by capture time but within a capture time are equally likely to have any order. That is, we generate random orderings that respect the capture times. We use a one-sided t-test to determine if the mean of the roughness of the pseudotime orderings is less than the mean of the roughness of orderings drawn under the null hypothesis. Defining <italic>R</italic><sub><italic>g</italic></sub> in terms of the ordering rather than the actual pseudotime also allows us to use it to compare the roughness of orderings from other methods such as Monocle.</p>
</sec>
<sec id="s2g">
<label>2.7</label>
<title>Availability</title>
<p>The model described in this paper is available as an R package on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/JohnReid/DeLorean/">https://github.com/JohnReid/DeLorean/</ext-link>). The code is open source and is available under a liberal MIT license. Code to replicate the results in this paper is available as vignettes in the package and the necessary data is also provided with the package.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<p>We used our model to analyse three sets of data from three different organisms assayed using three different technologies: whole leaf <italic>Arabidopsis thaliana</italic> microarrays [<xref rid="c30" ref-type="bibr">30</xref>]; nCounter single cell profiling of a human prostate cancer cell line [<xref rid="c6" ref-type="bibr">6</xref>]; and single cell RNA-seq of mouse dendritic cells [<xref rid="c11" ref-type="bibr">11</xref>].</p>
<sec id="s3a">
<label>3.1</label>
<title>The response of <italic>Arabidopsis</italic> to infection</title>
<p>Windram et al. examined the response of <italic>Arabidopsis thaliana</italic> to infection by the necrotrophic fungal pathogen <italic>Botrytis cinerea</italic> [<xref rid="c30" ref-type="bibr">30</xref>]. They generated highresolution time series over 48 hours for an infected condition and a control condition. We investigated if our model could estimate the correct order for the samples if their exact capture times were withheld.</p>
<sec id="s3a1">
<label>3.1.1</label>
<title>The model correctly estimates withheld sample times</title>
<p>Windram et al. measured expression levels every two hours resulting in 24 distinct capture time points. We grouped these 24 time points into four lowresolution groups, each consisting of six consecutive time points. We then asked our model to estimate the pseudotimes associated with each sample but only provided it with the low-resolution group labels. Our model is not suitable for fitting thousands of genes simultaneously so we fit 150 of the genes mentioned in the text of Windram et al.&#x2019;s publication [<xref rid="c30" ref-type="bibr">30</xref>].</p>
<p>Our model estimated pseudotimes for each sample in the infected condition (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). In general the mixing of the posterior was good as quantified by the <inline-formula><alternatives><inline-graphic xlink:href="019588_inline4.gif"/></alternatives></inline-formula> statistics (all but two of the <italic>&#x03C4;</italic><sub><italic>c</italic></sub> <inline-formula><alternatives><inline-graphic xlink:href="019588_inline5.gif"/></alternatives></inline-formula> statistics were less than 1.15). The profiles induced by the inferred pseudotimes were smooth (see <xref ref-type="fig" rid="fig2">Figure 2</xref>).</p>
<fig id="fig1" orientation="portrait" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Pseudotime estimates for the samples from Windram et al.&#x2019;s <italic>Arabidopsis</italic> data. <italic>Left</italic>: Boxplots of the full pseudotime posteriors. The estimated pseudotimes are in good agreement with the true capture times. The model tends to spread the samples out around the 20 hour mark in pseudotime. Presumably the expression profiles vary the most at this point. Also the samples are spread out more broadly in pseudotime (between &#x2212;20 and 60 hours) compared to the true capture times. <italic>Right</italic>: The pseudotimes estimated by the best sample from the posterior plotted against the true capture times.</p></caption>
<graphic xlink:href="019588_fig1.tif"/>
</fig>
<p>The Spearman correlation between estimated pseudotimes from the posterior and the true capture times was high (posterior mean <italic>&#x03C1;</italic> = .993) (see <xref ref-type="fig" rid="fig3">Figure 3</xref> top left). The correlation for the best posterior sample had Spearman correlation <italic>&#x03C1;</italic> = .997.</p>
<fig id="fig2" orientation="portrait" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Expression profiles of selected genes over pseudotime. The expression data <inline-formula><alternatives><inline-graphic xlink:href="019588_inline6.gif"/></alternatives></inline-formula> are shown as points coloured by their obfuscated capture time. The expected posterior mean of each profile is shown as a grey line and the shaded grey area in each profile represents the posterior uncertainty up to two standard deviations away from the mean.</p></caption>
<graphic xlink:href="019588_fig2.tif"/>
</fig>
</sec>
<sec id="s3a2">
<label>3.1.2</label>
<title>Our model fits the data better than Monocle</title>
<p>We also used the Monocle algorithm [<xref rid="c12" ref-type="bibr">12</xref>] to predict pseudotimes for the same 150 genes. Monocle was unable to recover the capture times for cells from the first low resolution group (see <xref ref-type="fig" rid="fig3">Figure 3</xref>). The Spearman correlation between Monocle&#x2019;s estimated pseudotimes and the true capture times was not as high (<italic>&#x03C1;</italic> = 0.927) as that for our estimates. Monocle&#x2019;s difficulty in resolving the correct ordering can be explained by its inability to use prior information that could resolve the first two groups of cells.</p>
<fig id="fig3" orientation="portrait" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p><italic>Left</italic>: Pseudotimes predicted by the Monocle algorithm (<italic>&#x03C1;</italic> = 0.927). <italic>Right</italic>: Posterior of the Spearman correlation between estimated pseudotimes from our model and true capture times. The Spearman correlation of the Monocle pseudotimes with the true capture times is shown as a red dashed line. The Spearman correlation of the best sample with the true capture times is shown as a blue dashed line.</p></caption>
<graphic xlink:href="019588_fig3.tif"/>
</fig>
</sec>
<sec id="s3a3">
<label>3.1.3</label>
<title>The pseudotimes induce smooth profiles on held out genes</title>
<p>We calculated roughness statistics <italic>R</italic><sub><italic>g</italic></sub> (see <xref ref-type="sec" rid="s2f">Section 2.6</xref>) for the 50 genes that we had not used to fit the model and averaged over genes. We did the same for 1000 pseudotime orderings sampled under the null hypothesis. The posterior mean of the <italic>R</italic><sub><italic>g</italic></sub> of the pseudotimes estimated by our model were significantly smaller than those from the null hypothesis (<italic>p &#x003C;</italic> 10<sup>&#x2212;15</sup> one-sided t-test) (see <xref ref-type="fig" rid="fig4">Figure 4</xref>).</p>
</sec>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>The effect of cell cycle on single cell gene expression</title>
<p>McDavid et al. were interested in the effect of the cell cycle on the single cell gene expression [<xref rid="c6" ref-type="bibr">6</xref>]. They assessed this effect by assaying the expression levels of 333 genes in 930 cells across three human cell lines using nCounter single cell profiling [<xref rid="c31" ref-type="bibr">31</xref>]. Based on these data they concluded that cell cycle explains just 5&#x0025; to 17&#x0025; of expression variability.</p>
<fig id="fig4" orientation="portrait" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Roughnesses of samples from the posterior of our model (pink) and from draws from the null hypothesis (cyan). The roughness of the best sample from our posterior is shown as a dotted blue line.</p></caption>
<graphic xlink:href="019588_fig4.tif"/>
</fig>
<p>CycleBase [<xref rid="c32" ref-type="bibr">32</xref>] is a database of cell cycle related genes and time series expression data. It contains metadata including the time in the cell cycle at which expression peaks for cell cycle related genes. To evaluate our model, we assessed how closely the peaks in the expression profiles estimated by our model from McDavid et al.&#x2019;s data matched the CycleBase peak times. Additionally as a baseline, we compared peaks estimated from the raw expression data by a naive algorithm to the Cyclebase peak times.</p>
<sec id="s3b1">
<label>3.2.1</label>
<title>The model recovers cell cycle peak times</title>
<p>To fit our model we selected 37 cells at random from the PC3 human prostate cancer cell line and chose the top 56 differentially expressed genes according to McDavid et al.&#x2019;s differential expression test. We mapped cells identified by McDavid et al. as G0/G1, S, and G2/M to capture times of 1, 2 and 3 respectively. We used a length scale of 5 and set <inline-formula><alternatives><inline-graphic xlink:href="019588_inline7.gif"/></alternatives></inline-formula>. To model the cyclic nature of the cell cycle, we used a periodic covariance function with period &#x2126; = 3. This ensured the expression profiles were periodic and transitions between all the cell cycle phases were consistent. Our model did not mix well with many <inline-formula><alternatives><inline-graphic xlink:href="019588_inline8.gif"/></alternatives></inline-formula> hence for further analysis we used the sample with highest log probability. We show expression profiles from this sample in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p>
<p>In order to test the fit of our model we estimated peak times from the expression profiles fit by the model and compared these to peak times as defined by the CycleBase database. To quantify this fit we calculated the root mean squared error (RMSE) between the CycleBase defined peak times and our estimates (RMSE=16.7).</p>
<p>We wished to understand how well our model estimated peak times compared to naive estimates. We made naive estimates from the raw expression data as follows. Each cell in McDavid et al.&#x2019;s data had been labelled with one of the cell cycle phases. We identified the cell with maximal raw expression value for each gene. The middle of the cell cycle phase with which this cell was labelled was used as the naive estimate of the gene&#x2019;s peak time. These estimated peak times had a RMSE of 21.3 which is 28&#x0025; larger than the RMSE of our estimated peak times. This demonstrates that the our model&#x2019;s expression profiles capture information present in the data at a higher temporal resolution than the raw labels.</p>
<fig id="fig5" orientation="portrait" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Expression profiles over pseudotime from the McDavid et al. cell cycle data. The pseudotimes are those from the best sample. Note the circular <italic>x</italic> axis: the first and last labels are both for the G2/M stage. The genes were selected based on high ratios of temporal variance to noise. Each point represents the expression of the given gene in a cell. The points are coloured by the cell cycle stage with which the cell was labelled by McDavid et al. The dark grey line represents the posterior mean of the expression profile for the gene and the shaded grey ribbon represents two standard deviations either side of this mean. The vertical dotted lines are the peak times as defined by the CycleBase database.</p></caption>
<graphic xlink:href="019588_fig5.tif"/>
</fig>
</sec>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>Paracrine signalling in mouse dendritic cells</title>
<p>Shalek et al. generated cross-sectional time courses of the response of primary mouse bone-marrow-derived dendritic cells in three separate conditions using single-cell RNA-seq [<xref rid="c11" ref-type="bibr">11</xref>]. We analysed the data on the lipopolysaccharide stimulated (LPS) condition using our model.</p>
<sec id="s3c1">
<label>3.3.1</label>
<title>The model identifies precocious cells</title>
<p>Shalek et al. identified a core antiviral module of genes that are expressed in conditions such as LPS after two to four hours. They also identified two cells captured at one hour that had this module switched on precociously. Other cells captured at one hour did not express the genes in this module. This concept that some cells can progress through pseudotime faster than others is exactly the concept that our model is designed to capture. We were interested to establish if our model could place these cells at later pseudotimes than other cells captured at one hour.</p>
<p>To fit our model we sampled 37 cells from the LPS condition including the two precocious cells captured at one hour. Shalek et al. defined several gene modules in their publication that show different temporal patterns of expression across the LPS time course. We selected the 74 genes from the clusters Id, IIIb, IIIc, IIId with the highest temporal variance relative to their noise levels. We set <italic>&#x03C3;</italic><sub><italic>&#x03C4;</italic></sub> = 1 and used a length scale of 5. The model mixed well with all but four of the cells&#x2019; pseudotimes having a <inline-formula><alternatives><inline-graphic xlink:href="019588_inline9.gif"/></alternatives></inline-formula> of less than 1.2.</p>
<p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows the module scores of the core antiviral genes (as defined by Shalek et al.) over pseudotime. The two precocious cells have been fit with a pseudotime in the middle of the two hour capture cells.</p>
<fig id="fig6" orientation="portrait" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>The module score (as defined by Shalek et al.) of core antiviral genes over pseudotime. The two precocious cells captured at one hour are plotted as triangles. These two cells have been placed at a later pseudotime than the other cells captured at one hour. A Loess curve has also been plotted through the data.</p></caption>
<graphic xlink:href="019588_fig6.tif"/>
</fig>
</sec>
<sec id="s3c2">
<label>3.3.2</label>
<title>The model identifies smooth expression profiles</title>
<p>We calculated roughness statistics <italic>R</italic><sub><italic>g</italic></sub> (see <xref ref-type="sec" rid="s2f">Section 2.6</xref>) for 100 genes that we had not used to fit the model and averaged over genes. We did the same for 1000 pseudotime orderings sampled under the null hypothesis. The posterior mean of the <italic>R</italic><sub><italic>g</italic></sub> of the pseudotimes estimated by our model were significantly smaller than those from the null hypothesis (<italic>p &#x003C;</italic> 10<sup>&#x2212;15</sup> one-sided t-test) (see <xref ref-type="fig" rid="fig7">Figure 7</xref>).</p>
<fig id="fig7" orientation="portrait" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Roughnesses of samples from the posterior of our model (pink) and from draws from the null hypothesis (cyan). The roughness of the best sample from our posterior is shown as a dotted blue line.</p></caption>
<graphic xlink:href="019588_fig7.tif"/>
</fig>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Conclusions</title>
<p>We have presented a principled probabilistic model that accounts for uncertainty in the capture times of cross-sectional time series. We have fit our model to three separate data sets each using a different biological assay (microarrays, single cell nCounter and single cell RNA-seq) in three organisms (human, mouse and <italic>Arabidopsis</italic>). Our model provided plausible estimates of pseudotimes on all the data sets. We validated these estimates technically by evaluating the smoothness of the expression profiles of held out genes in two of the data sets. These profiles are significantly smoother than expected under the null model. In addition we validated the estimates biologically using obfuscated capture times (in the <italic>Arabidopsis</italic> data set), data from separate experiments (cell cycle peak times) and independent analyses (identification of precocious cells). Overall these results demonstrate that uncertainty in the temporal dimension should not be ignored in cross-sectional time series of single cell data and that our method captures and corrects for these effects.</p>
<p>Our method has a number of attractive attributes. It explicitly estimates pseudotimes in contrast to methods such as Monocle and Wanderlust which estimate orderings of cells. The pseudotimes are on the same scale as the experimental capture times. The orderings estimated by Monocle and Wanderlust have no scale. Additionally, the orderings estimated by Monocle and Wanderlust do not quantify the differences in expression between consecutive cells. Consecutive cells in the ordering could have similar or diverse expression profiles. In our model, consecutive cells that have diverse expression profiles are placed further apart in pseudotime than similar cells. Thus our pseudotime estimates quantify the rate of change of the system. For example, in the <italic>Arabidopsis</italic> example we analysed, the cells are spread out in pseudotime around the 20 hour mark (<xref ref-type="fig" rid="fig1">Figure 1</xref>) suggesting changes in expression levels in response to the infection are greatest at this time point.</p>
<p>Our method uses Gaussian processes which are a natural framework to model noisy expression profiles. Gaussian processes are well established probabilistic models for time series. They provide more than just point estimates of the profiles, they also provide a measure of posterior uncertainty. This is useful in downstream analyses such as regulatory network inference. A Gaussian process model is characterised by its covariance function and associated parameters and the covariance functions in our model have interpretable parameters: gene-specific temporal variation and noise. We have also demonstrated how a Gaussian process framework is suitable for modelling periodic expression profiles such as cell cycle expression profiles. The primary limitation of Gaussian processes for our model is that inference complexity scales cubically in the number of samples. For this reason our method is not applicable to data from many hundreds or thousands of cells like Monocle and Wanderlust.</p>
<p>Inference in our model is performed using Markov chain Monte Carlo. This technique provides a full posterior distribution over the model parameters. However mixing over the pseudotime parameters in our model can be difficult and we found that our model did not mix well when fit to the cell cycle data set. In this case, we analysed expression profiles from the sample with highest log probability and found they estimated cell cycle peak times well.</p>
<p>Single cell assays give us an exciting opportunity to explore heterogeneity in populations of cells. As the technology develops and the cost of undertaking such assays drops, they are destined to become commonplace. Also high throughput longitudinal studies remain impractical and for the foreseeable future the majority of such time series will be cross-sectional in nature. Until this changes there will be challenges associated with estimating uncertainty in the capture times and variation in the rate of progress of individual cells through a system. Our method explicitly models these effects and is a practical tool for analysis of such cross-sectional time series. Furthermore in contrast to Wanderlust our method only depends on open source software and is available under a liberal open source license.</p>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><given-names>Guoji</given-names> <surname>Guo</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Resolution of Cell Fate Decisions Revealed by Single-Cell Gene Expression Analysis from Zygote to Blastocyst</article-title>&#x201D;. In: <source>Developmental Cell</source> <volume>18.4</volume> (Apr. 20, <year>2010</year>), pp. <fpage>675</fpage>&#x2013;<lpage>685</lpage>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><given-names>Yosef</given-names> <surname>Buganim</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single-Cell Expression Analyses during Cellular Reprogramming Reveal an Early Stochastic and a Late Hierarchic Phase</article-title>&#x201D;. In: <source>Cell</source> <volume>150.6</volume> (Sept. <year>2012</year>), pp. <fpage>1209</fpage>&#x2013;<lpage>1222</lpage>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><given-names>Tsukasa</given-names> <surname>Kouno</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Temporal dynamics and transcriptional control using single-cell gene expression analysis</article-title>&#x201D;. In: <source>Genome Biology</source> <volume>14.10</volume> (Oct. 24, <year>2013</year>), <fpage>R118</fpage>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><given-names>Kyung-Min</given-names> <surname>Chung</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single Cell Analysis Reveals the Stochastic Phase of Reprogramming to Pluripotency Is an Ordered Probabilistic Process</article-title>&#x201D;. In: <source>PLoS ONE</source> <volume>9.4</volume> (Apr. 17, <year>2014</year>), <fpage>e95304</fpage>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><given-names>Nir</given-names> <surname>Yosef</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Dynamic regulatory network controlling TH17 cell differentiation</article-title>&#x201D;. In: <source>Nature</source> <volume>496.7446</volume> (Apr. 25, <year>2013</year>), pp. <fpage>461</fpage>&#x2013;<lpage>468</lpage>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>Andrew</given-names> <surname>McDavid</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Modeling Bi-modality Improves Characterization of Cell Cycle on Gene Expression in Single Cells</article-title>&#x201D;. In: <source>PLoS Computational Biology</source> <volume>10.7</volume> (July 17, <year>2014</year>).</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><given-names>Fuchou</given-names> <surname>Tang</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Tracing the Derivation of Embryonic Stem Cells from the Inner Cell Mass by Single-Cell RNA-Seq Analysis</article-title>&#x201D;. In: <source>Cell Stem Cell</source> <volume>6.5</volume> (May 7, <year>2010</year>), pp. <fpage>468</fpage>&#x2013;<lpage>478</lpage>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>Saiful</given-names> <surname>Islam</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Characterization of the single-cell transcriptional landscape by highly multiplex RNA-seq</article-title>&#x201D;. In: <source>Genome Research</source> <volume>21.7</volume> (Jan. 7, <year>2011</year>), pp. <fpage>1160</fpage>&#x2013;<lpage>1167</lpage>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><given-names>Alex K.</given-names> <surname>Shalek</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>&#x201D;. In: <source>Nature advance online publication</source> (May 19, <year>2013</year>).</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><given-names>Philip</given-names> <surname>Brennecke</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>&#x201D;. In: <source>Nature Methods</source> <volume>10.11</volume> (Nov. <year>2013</year>), pp. <fpage>1093</fpage>&#x2013;<lpage>1095</lpage>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><given-names>Alex K.</given-names> <surname>Shalek</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>&#x201D;. In: <source>Nature</source> <volume>510.7505</volume> (June 19, <year>2014</year>), pp. <fpage>363</fpage>&#x2013;<lpage>369</lpage>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><given-names>Cole</given-names> <surname>Trapnell</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>&#x201D;. In: <source>Nature Biotechnology</source> <volume>32.4</volume> (Apr. 2014), pp. <fpage>381</fpage>&#x2013;<lpage>386</lpage>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><given-names>Barbara</given-names> <surname>Treutlein</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>&#x201D;. In: <source>Nature</source> <volume>509.7500</volume> (Apr. 13, <year>2014</year>), pp. <fpage>371</fpage>&#x2013;<lpage>375</lpage>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><given-names>Alex A</given-names> <surname>Pollen</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>&#x201D;. In: <source>Nature Biotechnology</source> (Aug. 3, <year>2014</year>).</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><given-names>Neil</given-names> <surname>Lawrence</surname></string-name>. &#x201C;<article-title>Probabilistic non-linear principal component analysis with Gaussian process latent variable models</article-title>&#x201D;. In: <source>The Journal of Machine Learning Research</source> <volume>6</volume> (<year>2005</year>), pp. <fpage>1783</fpage>&#x2013;<lpage>1816</lpage>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>Michael E.</given-names> <surname>Tipping</surname></string-name> and <string-name><given-names>Christopher M.</given-names> <surname>Bishop</surname></string-name>. &#x201C;<article-title>Probabilistic Principal Component Analysis</article-title>&#x201D;. In: <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source> <volume>61.3</volume> (Jan. 1, <year>1999</year>), pp. <fpage>611</fpage>&#x2013;<lpage>622</lpage>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><given-names>Florian</given-names> <surname>Buettner</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Probabilistic PCA of censored data: accounting for uncertainties in the visualization of high-throughput single-cell qPCR data</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>30.13</volume> (Jan. 7, <year>2014</year>), pp. <fpage>1867</fpage>&#x2013;<lpage>1875</lpage>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><given-names>Florian</given-names> <surname>Buettner</surname></string-name> and <string-name><given-names>Fabian J.</given-names> <surname>Theis</surname></string-name>. &#x201C;<article-title>A novel approach for resolving differences in single-cell gene expression patterns from zygote to blasto-cyst</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>28.18</volume> (Sept. 15, <year>2012</year>), pp. <fpage>i626</fpage>&#x2013;<lpage>i632</lpage>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Tarmo</surname> <given-names>&#x00C4;ij&#x00F6;</given-names></string-name> <etal>et al.</etal> &#x201C;<article-title>Methods for time series analysis of RNA-seq data with application to human Th17 cell differentiation</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>30.12</volume> (June 15, <year>2014</year>), pp. <fpage>i113</fpage>&#x2013;<lpage>i120</lpage>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><given-names>Sean C.</given-names> <surname>Bendall</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single-Cell Trajectory Detection Uncovers Progression and Regulatory Coordination in Human B Cell Development</article-title>&#x201D;. In: <source>Cell</source> <volume>157.3</volume> (Apr. 2014), pp. <fpage>714</fpage>&#x2013;<lpage>725</lpage>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="book"><string-name><given-names>Carl Edward</given-names> <surname>Rasmussen</surname></string-name> and <string-name><given-names>Christopher K. I</given-names> <surname>Williams</surname></string-name>. <source>Gaussian processes for machine learning</source>. <publisher-name>Cambridge, Mass.: MIT Press</publisher-name>, <year>2006</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><given-names>Oliver</given-names> <surname>Stegle</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>A Robust Bayesian Two-Sample Test for Detecting Intervals of Differential Gene Expression in Microarray Time Series</article-title>&#x201D;. In: <source>Journal of Computational Biology</source> <volume>17.3</volume> (Mar. <year>2010</year>), pp. <fpage>355</fpage>&#x2013;<lpage>367</lpage>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><given-names>Antti</given-names> <surname>Honkela</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Model-based method for transcription factor target identification with limited data</article-title>&#x201D;. In: <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>107.17</volume> (Apr. 27, <year>2010</year>), pp. <fpage>7793</fpage>&#x2013;<lpage>7798</lpage>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Tarmo</surname> <given-names>&#x00C4;ij&#x00F6;</given-names></string-name> and <string-name><surname>Harri</surname> <given-names>L&#x00E4;hdesm&#x00E4;ki</given-names></string-name>. &#x201C;<article-title>Learning gene regulatory networks from gene expression measurements using non-parametric molecular kinetics</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>25.22</volume> (Nov. 15, <year>2009</year>), pp. <fpage>2937</fpage>&#x2013;<lpage>2944</lpage>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><given-names>Paul</given-names> <surname>Kirk</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Bayesian correlated clustering to integrate multiple datasets</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>28.24</volume> (Jan. 12, <year>2012</year>), pp. <fpage>3290</fpage>&#x2013;<lpage>3297</lpage>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><given-names>Simon</given-names> <surname>Anders</surname></string-name> and <string-name><given-names>Wolfgang</given-names> <surname>Huber</surname></string-name>. &#x201C;<article-title>Differential expression analysis for sequence count data</article-title>&#x201D;. In: <source>Genome Biology</source> <volume>11.10</volume> (Oct. 27, <year>2010</year>), <fpage>R106</fpage>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="other"><collab>Stan Development Team</collab>. <source>Stan Modeling Language (2.4.0)</source>. <year>2014</year>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><given-names>Matthew D.</given-names> <surname>Hoffman</surname></string-name> and <string-name><given-names>Andrew</given-names> <surname>Gelman</surname></string-name>. &#x201C;<article-title>The No-U-Turn Sampler: Adaptively Setting Path Lengths in Hamiltonian Monte Carlo</article-title>&#x201D;. In: <source>Journal of Machine Learning Research</source> <volume>15</volume> (Apr <year>2014</year>), pp. <fpage>1593</fpage>&#x2013;<lpage>1623</lpage>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><given-names>Stephen P.</given-names> <surname>Brooks</surname></string-name> and <string-name><given-names>Andrew</given-names> <surname>Gelman</surname></string-name>. &#x201C;<article-title>General methods for monitoring convergence of iterative simulations</article-title>&#x201D;. In: <source>Journal of computational and graphical statistics</source> <volume>7.4</volume> (<year>1998</year>), pp. <fpage>434</fpage>&#x2013;<lpage>455</lpage>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><given-names>Oliver</given-names> <surname>Windram</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Arabidopsis Defense against Botrytis cinerea: Chronology and Regulation Deciphered by High-Resolution Temporal Transcriptomic Analysis</article-title>&#x201D;. In: <source>The Plant Cell Online</source> <volume>24.9</volume> (Sept. 1, <year>2012</year>), pp. <fpage>3530</fpage>&#x2013;<lpage>3557</lpage>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><given-names>Gary K</given-names> <surname>Geiss</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Direct multiplexed measurement of gene expression with color-coded probe pairs</article-title>&#x201D;. In: <source>Nature Biotechnology</source> <volume>26.3</volume> (Mar. <year>2008</year>), pp. <fpage>317</fpage>&#x2013;<lpage>325</lpage>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><given-names>Alberto</given-names> <surname>Santos</surname></string-name>, <string-name><given-names>Rasmus</given-names> <surname>Wernersson</surname></string-name>, and <string-name><given-names>Lars Juhl</given-names> <surname>Jensen</surname></string-name>. &#x201C;<article-title>Cyclebase 3.0: a multi-organism database on cell-cycle regulation and phenotypes</article-title>&#x201D;. In: <source>Nucleic Acids Research</source> <volume>43</volume> (D1 Jan. 28, <year>2015</year>), pp. <fpage>D1140</fpage>&#x2013;<lpage>D1144</lpage>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<label>5</label>
<title>Appendix</title>
<sec>
<label>5.1</label>
<title>Variance of draw from multivariate Gaussian</title>
<p>Suppose we have a zero-mean Gaussian
<disp-formula id="ueqn4">
<alternatives>
<graphic xlink:href="019588_ueqn4.gif"/>
</alternatives>
</disp-formula>
we wish to estimate the expected sample variance
<disp-formula id="ueqn5">
<alternatives>
<graphic xlink:href="019588_ueqn5.gif"/>
</alternatives>
</disp-formula>
and all sums are from 1 to <italic>D</italic>. Setting <inline-formula><alternatives><inline-graphic xlink:href="019588_inline10.gif"/></alternatives></inline-formula> we have
<disp-formula id="ueqn6">
<alternatives>
<graphic xlink:href="019588_ueqn6.gif"/>
</alternatives>
</disp-formula>
and
<disp-formula id="ueqn7">
<alternatives>
<graphic xlink:href="019588_ueqn7.gif"/>
</alternatives>
</disp-formula>
but
<disp-formula id="ueqn8">
<alternatives>
<graphic xlink:href="019588_ueqn8.gif"/>
</alternatives>
</disp-formula>
where a dot represents summation over that index, so
<disp-formula id="ueqn9">
<alternatives>
<graphic xlink:href="019588_ueqn9.gif"/>
</alternatives>
</disp-formula></p>
</sec>
</app>
</app-group>
</back>
</article>
