<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/023606</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part II: Perturbation analyses</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Ezawa</surname><given-names>Kiyoshi</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Graur</surname><given-names>Dan</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Landan</surname><given-names>Giddy</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n2">3</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biology and Biochemistry, University of Houston</institution>, Houston, TX 77204-5001, <country>USA</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding Author (E-mail: <email>kezawa@bio.kyutech.ac.jp</email>, <email>kezawa.ezawa3@gmail.com</email>)</corresp>
<fn id="n1" fn-type="present-address"><label>2</label><p>Present address: Department of Bioscience and Bioinformatics, Kyushu Institute of Technology, Iizuka 820-8502, JAPAN</p></fn>
<fn id="n2" fn-type="present-address"><label>3</label><p>Present address: Institute of Genomic Microbiology, Heinrich-Heine University D&#x00FC;sseldorf, Universit&#x00E4;tsstr. 1, 40225 D&#x00FC;sseldorf, GERMANY</p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2015</year>
</pub-date>
<elocation-id>023606</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>7</month>
<year>2015</year>
</date>
</history>
<permissions><copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="023606.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<sec><title>Background</title>
<p>Insertions and deletions (indels) account for more nucleotide differences between two related DNA sequences than substitutions do, and thus it is imperative to develop a stochastic evolutionary model that enables us to reliably calculate the probability of the sequence evolution through indel processes. In a separate paper (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), we established a theoretical basis of our <italic>ab initio</italic> perturbative formulation of a <italic>genuine</italic> evolutionary model, more specifically, a continuous-time Markov model of the evolution of an <italic>entire</italic> sequence via insertions and deletions. And we showed that, under some conditions, the <italic>ab initio</italic> probability of an alignment can be factorized into the product of an overall factor and contributions from regions (or local alignments) separated by gapless columns.</p>
</sec>
<sec><title>Results</title>
<p>This paper describes how our <italic>ab initio</italic> perturbative formulation can be concretely used to approximately calculate the probabilities of all types of local pairwise alignments (PWAs) and some typical types of local multiple sequence alignments (MSAs). For each local alignment type, we calculated the fewest-indel contribution and the next-fewest-indel contribution to its probability, and we compared them under various conditions. We also derived a system of integral equations that can be numerically solved to give &#x201C;exact solutions&#x201D; for some common types of local PWAs. And we compared the obtained &#x201C;exact solutions&#x201D; with the fewest-indel contributions. The results indicated that even the fewest-indel terms alone can quite accurately approximate the probabilities of local alignments, as long as the segments and the branches in the tree are of modest lengths. Moreover, in the light of our formulation, we examined parameter regions where other indel models can safely approximate the correct evolutionary probabilities. The analyses also suggested some modifications necessary for these models to improve the accuracy of their probability estimations.</p>
</sec>
<sec><title>Conclusions</title>
<p>At least under modest conditions, our <italic>ab initio</italic> perturbative formulation can quite accurately calculate alignment probabilities under biologically realistic indel models. It also provides a sound reference point that other indel models can be compared to. [This paper and three other papers (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>,b,c) describe a series of our efforts to develop, apply, and extend the <italic>ab initio</italic> perturbative formulation of a general continuous-time Markov model of indels.]</p>
</sec>
</abstract>
<kwd-group kwd-group-type="author"><title>Keywords</title>
<kwd>Insertions/deletions (indels)</kwd>
<kwd>pairwise sequence alignment (PWA)</kwd>
<kwd>multiple sequence alignment (MSA)</kwd>
<kwd>probability</kwd>
<kwd>likelihood</kwd>
<kwd>continuous-time Markov model</kwd>
<kwd>perturbation theory</kwd>
<kwd>power-law length distribution</kwd>
<kwd>exact solution</kwd>
</kwd-group>
<counts>
<page-count count="69"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>Introduction</title>
<p>The evolution of DNA, RNA, and protein sequences is driven by mutations such as base substitutions, insertions and deletions (indels), recombination, and other genomic rearrangements (<italic>e.g.</italic>, <xref ref-type="bibr" rid="c20">Graur and Li 2000</xref>; Gascuel 2005; <xref ref-type="bibr" rid="c27">Lynch 2007</xref>). Thus far, analyses on substitutions have predominated in the field of molecular evolutionary study, in particular using the probabilistic (or likelihood) theory of substitutions that is now widely accepted (e.g., <xref ref-type="bibr" rid="c16">Felsenstein 1981</xref>, <xref ref-type="bibr" rid="c17">2004</xref>; <xref ref-type="bibr" rid="c40">Yang 2006</xref>). However, some recent comparative genomic analyses have revealed that indels account for more base differences between the genomes of closely related species than substitutions (<italic>e.g</italic>., <xref ref-type="bibr" rid="c4">Britten 2002</xref>; <xref ref-type="bibr" rid="c5">Britten et al. 2003</xref>; <xref ref-type="bibr" rid="c22">Kent <italic>et al</italic>. 2003</xref>; The International Chimpanzee Chromosome 22 Consortium 2004; <xref ref-type="bibr" rid="c35">The Chimpanzee Sequencing and Analysis Consortium 2005</xref>). It is therefore imperative to develop a stochastic model that enables us to reliably calculate the probability of sequence evolution via mutations including insertions and deletions.</p>
<p>Since the groundbreaking works by <xref ref-type="bibr" rid="c2">Bishop and Thompson (1986)</xref> and by <xref ref-type="bibr" rid="c37">Thorne, Kishino and Felsenstein (1991)</xref>, many studies have been done to develop and apply methods to calculate the probabilities of pairwise alignments (PWAs) and multiple sequence alignments (MSAs) under the probabilistic models aiming to incorporate the effects of indels, and such methods have greatly improved in terms of the computational efficiency and the scope of application. See excellent reviews for details on this topic (e.g., <xref ref-type="bibr" rid="c34">Rivas 2005</xref>; <xref ref-type="bibr" rid="c3">Bradley and Holmes 2007</xref>; <xref ref-type="bibr" rid="c32">Mikl&#x00F3;s et al. 2009</xref>). A majority of these studies are based on hidden Markov models (HMMs) or transducer theories. Both of them calculate the indel component of an alignment probability as a product of inter-column transition probabilities or of block-wise contributions. Unfortunately, they have two fundamental problems, one regarding the theoretical grounds and the other regarding the biological realism. Regarding the theoretical grounds, it is unclear whether or not a HMM or a transducer is related with any <italic>genuine</italic> evolutionary model, which describes the evolution of an <italic>entire</italic> sequence via indels along the time axis. Regarding the biological realism, the standard HMMs or transducers can at best handle geometric distributions of indel lengths, whereas many empirical studies showed that the real indel lengths are distributed according to the power-law <italic>e.g</italic>., <xref ref-type="bibr" rid="c19">Gonnet et al. 1992</xref>; <xref ref-type="bibr" rid="c1">Benner et al. 1993</xref>; <xref ref-type="bibr" rid="c21">Gu and Li 1995</xref>; <xref ref-type="bibr" rid="c22">Kent et al. 2003</xref>; <xref ref-type="bibr" rid="c41">Zhang and Gerstein 2003</xref>; <xref ref-type="bibr" rid="c8">Chang and Benner 2004</xref>; The international Chimpanzee Chromosome 22 Consortium 2004; <xref ref-type="bibr" rid="c39">Yamane et al. 2006</xref>; <xref ref-type="bibr" rid="c15">Fan et al. 2007</xref>). Besides, it is very hard for the previous methods to incorporate the indel rate variation across regions, which were often observed empirically (<italic>e.g</italic>., Gu et al. 2008). See the &#x201C;background&#x201D; section in part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>) for more details on these problems.</p>
<p>In part I of this series of study (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), we established an <italic>ab initio</italic> formulation of a <italic>genuine</italic> stochastic evolutionary model, that is, a general continuous-time Markov model of sequence evolution via indels. Our evolutionary model allows any indel rate parameters including length distributions, but it does not impose any unnatural restrictions on indels. Thus, the model is naturally devoid of the aforementioned two problems. Aided by some techniques of the perturbation theory in physics (<xref ref-type="bibr" rid="c10">Dirac 1958</xref>; <xref ref-type="bibr" rid="c29">Messiah 1961a</xref>,b), we formally expanded the probability of an alignment into a series of terms with different numbers of indels. This expansion theoretically underpinned the stochastic evolutionary simulation method of <xref ref-type="bibr" rid="c18">Gillespie (1977)</xref>. And we also showed that, if the indel model parameters satisfy a certain set of conditions, the <italic>ab initio</italic> probability of an alignment is indeed factorable into the product of an overall factor and contributions from local alignments delimited by preserved ancestral sites (PASs). This result reconfirmed and generalized the conjecture that <xref ref-type="bibr" rid="c31">Mikl&#x00F3;s et al. (2004)</xref> made under their spatially and temporally homogeneous indel model.</p>
<p>In this paper, we turn our attention to more concrete problems. In other words, we focus on how to concretely calculate the contribution from each local alignment, assuming that the indel model satisfies the conditions for the factorability of alignment probabilities.</p>
<p>In Section 1 of Results &#x0026; Discussion, we demonstrate how our <italic>ab initio</italic> perturbative formulation can be concretely used to approximately calculate the contributions to the alignment probabilities from regions separated by gapless columns (<italic>i.e</italic>., local alignments). We examine all types of local pairwise alignments (PWAs) and some typical types of local multiple sequence alignments (MSAs). For each local alignment type, we calculate the fewest-indel contribution and the next-fewest-indel contribution to its probability. In this section, we also derive a system of integral equations that can be numerically solved to give &#x201C;exact solutions&#x201D; for some common types of local PWAs. Then, by comparing the fewest-indel contribution with the next-fewest-indel contribution, or with the &#x201C;exact&#x201D; solution, we examine the parameter region in which the fewest-indel contribution can approximate the alignment probability quite accurately. In Section 2 of Results &#x0026; Discussion, we examine some representative models that were used in the past studies, including the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, in the light of our <italic>ab initio</italic> perturbative formulation. We attempt to delimit parameter regions where these models can safely approximate the <italic>ab initio</italic> probabilities under the <italic>genuine</italic> evolutionary model. The analyses will also suggest some modifications to these models that would enhance their reliability. And Appendix describes details on some perturbation calculations.</p>
<p>This paper is part II of a series of our papers that documents our efforts to develop, apply, and extend the <italic>ab initio</italic> perturbative formulation of the general continuous-time Markov model of sequence evolution via indels. Part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>) gives the theoretical basis of this entire study. Part II (this paper) describes concrete perturbation calculations and examines the applicable ranges of other probabilistic models of indels. Part III (<xref ref-type="bibr" rid="c13">Ezawa, Graur and Landan 2015b</xref>) describes our algorithm to calculate the first approximation of the probability of a given MSA and simulation analyses to validate the algorithm. Finally, part IV (<xref ref-type="bibr" rid="c14">Ezawa, Graur and Landan 2015c</xref>) discusses how our formulation can incorporate substitutions and other mutations, such as duplications and inversions.</p>
<p>This paper basically uses the same conventions as used in part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>). Briefly, a sequence state <italic>s</italic> (&#x220A; <italic>S</italic>) is represented as an array of sites, each of which is either blank or equipped with some specific attributes. And each indel event is represented as an operator acting on the bra-vector, &#x2329;<italic>s</italic> &#x007C;, representing a sequence state. More specifically, the operator <inline-formula><alternatives><inline-graphic xlink:href="023606_inline1.gif"/></alternatives></inline-formula> denotes the insertion of <italic>l</italic> sites between the <italic>x</italic> th and (<italic>x</italic> &#x002B;1) th sites, and the operator <inline-formula><alternatives><inline-graphic xlink:href="023606_inline2.gif"/></alternatives></inline-formula> denotes the deletion of a sub-array between (and including) the <italic>x</italic><sub><italic>B</italic></sub> th and the <italic>x</italic><sub><italic>E</italic></sub> th sites. See Section 2 of part I for more details.</p>
<p>And, also as in part I, the following terminology is used. The term &#x201C;an indel process&#x201D; means a series of successive indel events with both the order and the specific timings specified, and the term &#x201C;an indel history&#x201D; means a series of successive indel events with only the order specified. And, throughout this paper, the union symbol, such as in <italic>A</italic> &#x22C3; <italic>B</italic> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline3.gif"/></alternatives></inline-formula>, should be regarded as the union of <italic>mutually disjoint</italic> sets (<italic>i.e.,</italic> those satisfying <italic>A</italic> &#x2229; <italic>B</italic> &#x2205; and <italic>A</italic><sub><italic>i</italic></sub> &#x2229; <italic>A</italic><sub><italic>j</italic></sub> &#x2205; for <italic>i</italic> &#x2260; <italic>j</italic> (&#x220A; {1,&#x2026;, <italic>I</italic>}), respectively, where is an empty set), unless otherwise stated.</p>
</sec>
<sec id="s2"><title>Results &#x0026; Discussion</title>
<sec id="s2a">
<label>1.</label><title>Perturbation approximations of probabilities</title>
<sec id="s2a1">
<label>1.1</label><title>Perturbation expansion of multiplication factor contributed from local indel histories</title>
<p>In Section 4 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), we showed that the alignment probability can be factorized into the product of an overall factor and contributions from regions separated by gapless columns (as in Eqs.(4.1.8a,b) of part I for a PWA and Eqs.(4.2.9a,b,c) of part I for a MSA), if the following conditions are satisfied.</p>
<p>Condition (i): The indel rate parameters are independent of the portion of the sequence state outside of the region in question.</p>
<p>Condition (ii): The increment of the exit rate due to an indel event is independent of the portion of the sequence state outside of the region in question.</p>
<p>Condition (iii) (necessary only for MSAs): The probability of the root sequence state is factorable into the product of an overall factor and regional contributions. (This condition is represented as Eq.(4.2.8) of part I.)</p>
<p>Each regional contribution of the probability was symbolically represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline4.gif"/></alternatives></inline-formula> (in Eq.(4.1.8b) of part I) for a PWA and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline5.gif"/></alternatives></inline-formula> (in Eq.(4.2.9c) of part I) for a MSA. (See below for the definitions of the symbols for the arguments.) Thus, as long as we can concretely calculate these regional contributions, we can obtain the specific value of the probability of a given alignment. However, because each of these factors is in general a summation of contributions from an infinite number of local indel histories, we usually need to approximate it by a summation over a finite number of histories. In this section, we will do this, again based on the perturbation expansion as unfolded in Section 3 of part I.</p>
<p>For a PWA, &#x03B1; (<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>), we decompose <inline-formula><alternatives><inline-graphic xlink:href="023606_inline6.gif"/></alternatives></inline-formula>, the set of local indel histories consistent with the local PWA confined in the region &#x03B3;<sub><italic>&#x03BA;</italic></sub>, as: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline7.gif"/></alternatives></inline-formula>. Here <italic>&#x2227;</italic><sup>ID</sup> [<italic>N</italic><sub><italic>k</italic></sub>; &#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)] is the subset of PWA-consistent histories in &#x03B3;<sub><italic>k</italic></sub>, each of which consists of <italic>N</italic><sub><italic>k</italic></sub> indels, and <italic>N</italic><sub>min</sub> [&#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)] is the minimum number of indels required to give rise to the local PWA of &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>) within &#x03B3;<sub><italic>k</italic></sub>. Then, the &#x201C;perturbation expansion&#x201D; of the multiplication factor, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline8.gif"/></alternatives></inline-formula>, for the local PWA probability produced during time interval [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>], is given by:
<disp-formula id="eqn1"><alternatives><graphic xlink:href="023606_eqn1.gif"/></alternatives></disp-formula></p>
<p>Here
<disp-formula id="eqn2"><alternatives><graphic xlink:href="023606_eqn2.gif"/></alternatives></disp-formula>
is the multiplication factor contributed from all PWA-consistent <italic>N</italic><sub>k</sub>-event local indel histories.</p>
<p>For a MSA, &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>,&#x2026;, <italic>s</italic><sub><italic>N</italic></sub><italic>X</italic>], we decompose <inline-formula><alternatives><inline-graphic xlink:href="023606_inline9.gif"/></alternatives></inline-formula>, the set of local indel histories along the tree (<italic>T</italic>) consistent with the local MSA confined in the region <italic>C</italic><sub>k</sub>, as: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline10.gif"/></alternatives></inline-formula>.</p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline11.gif"/></alternatives></inline-formula> is the subset consisting of all MSA-consistent <italic>N</italic><sub>k</sub>-event local indel histories along the tree, and <italic>N</italic><sub>min</sub> <italic>C</italic><sub>k</sub>; &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>,&#x2026;, <italic>s</italic><sub><italic>N</italic></sub><italic>x</italic>]; <italic>T]</italic> is the minimum possible number of indels that can produce the sub-MSA within <italic>C</italic><sub>k</sub>. Using this, the &#x201C;perturbation expansion&#x201D; of the multiplication factor,</p>
<p><inline-formula><alternatives><inline-graphic xlink:href="023606_inline12.gif"/></alternatives></inline-formula>, is given by:
<disp-formula id="eqn3"><alternatives><graphic xlink:href="023606_eqn3.gif"/></alternatives></disp-formula></p>
<p>Here
<disp-formula id="eqn4"><alternatives><graphic xlink:href="023606_eqn4.gif"/></alternatives></disp-formula>
is the multiplication factor contributed from all local histories in <inline-formula><alternatives><inline-graphic xlink:href="023606_inline13.gif"/></alternatives></inline-formula>.</p>
<p>Thus, the problems were reduced to those of how to enumerate the local indel histories in the subset, &#x2227;<sup><italic>ID</italic></sup> [<italic>N</italic><sub><italic>k</italic></sub> &#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)] (for a PWA) or <inline-formula><alternatives><inline-graphic xlink:href="023606_inline14.gif"/></alternatives></inline-formula> (for a MSA), up to a particular number of events, <italic>N</italic><sub>k</sub>or <italic>N</italic><sub>k</sub>, that was chosen to achieve a desired level of accuracy. Once the relevant local histories are enumerated, then, we can calculate the contribution from each of them according to the general formula. (The general formulas are in Eq.(4.1.1b) of part I accompanied by Eq.(3.1.8b) of part I for a local PWA, and in Eq.(4.2.6b) of part I accompanied by Eq.(4.2.4b) of part I for a local MSA.) In Subsections 1.2 and 1.3, we explicitly calculate the portions of the multiplication factors, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline15.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline16.gif"/></alternatives></inline-formula>, for some typical gap-configurations of the local PWAs and MSAs, respectively, that are contributed from the parsimonious local indel histories. Then we compare them with the portions contributed from the next-parsimonious local indel histories. Moreover, for a few simplest but commonest types of local PWAs, we also derive integral equation systems that give the &#x201C;exact solutions&#x201D; for the total multiplication factors, Eq.(1.1.1a). Then, we see how well the contributions from parsimonious indel histories alone can approximate the actual occurrence frequencies of the gap-configurations of local MSAs.</p>
<p>In this section, we assume that we are working with a model whose alignment probabilities are factorable, and that we are focusing on calculating the multiplication factor that comes from a single local alignment flanked by a pair of gapless columns (<italic>i.e</italic>., a pair of PASs). We will mainly work in the state space <italic>S</italic> = <italic>S</italic><sup><italic>II</italic></sup> (see Section 2 of part I for the definition of the space). This means that we will focus on calculating the probability of the <italic>homology structure</italic> of each local alignment (see, <italic>e.g</italic>., <xref ref-type="bibr" rid="c26">Lunter et al. 2005</xref>). Let &#x220A;<italic>L</italic>(<italic>s</italic>) be the number of sites that a sequence <italic>s</italic> &#x220A; <italic>S</italic><sup><italic>II</italic></sup> has between the pair of PASs. We will re-assign the site numbers so that the left-and right-flanking PASs are numbered 1 and &#x220A;<italic>L</italic>(<italic>s</italic>) &#x220A; 2, respectively, and the sites in between them are numbered 2,&#x2026;, &#x220A;<italic>L</italic>(<italic>s</italic>) &#x220A;1. This will make it easy to apply the theory formulated thus far to the current situation. We will re-assign the ancestries <italic>v</italic>(1) <italic>L</italic> and <italic>v</italic>(&#x220A;<italic>L</italic>(<italic>s</italic>) &#x220A; 2) ? <italic>R</italic> to the left-and right-flanking PASs, respectively. And we will usually re-assign the ancestries <italic>v</italic>(<italic>x</italic>) <italic>x</italic> &#x2212; 1 to the sites, <italic>x</italic> = 2,&#x2026;, &#x220A;<italic>L</italic>(<italic>s</italic>) &#x220A;1, of the ancestral sequence <italic>s</italic> ? <italic>s</italic><sup><italic>A</italic></sup> (or the root sequence <italic>s</italic> ? <italic>s</italic><sup><italic>Root</italic></sup> for a MSA) in between the PASs (see <xref rid="fig1" ref-type="fig">Figure 1</xref> as an illustration).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Typical situation and notation considered in Section 1 of Results.</title>
<p><bold>A</bold> As an illustration, we use the local MSA confined in the region <italic>C</italic><sub>4</sub> of the MSA in the Figure 11 B of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), and re-assign the ancestries as shown in panel <bold>B</bold>. The ancestries in between the PASs (with the re-assigned ancestries <italic>L</italic> and <italic>R</italic>) are just an example and not always assigned in this way. <bold>C.</bold> Sequences extracted from the MSA. Shown above each site is the site number (<italic>i.e</italic>., spatial coordinate) assigned to it. And shown on the right of each sequence is the count of sites in between the PASs. In panels A and B, as in <xref rid="fig5" ref-type="fig">Figure 5</xref> of part I, the boldface characters in the leftmost columns stand for the sequence IDs. (More precisely, the number &#x2018; <italic>i</italic>&#x2019; stands for the sequence <italic>s</italic><sub><italic>i</italic></sub>, and the &#x2018; <italic>R</italic>&#x2019; stands for the root sequence (<italic>s</italic><sup><italic>Root</italic></sup>).)</p></caption>
<graphic xlink:href="023606_fig1.tif"/>
</fig>
<p>In the following subsections, we will omit the symbol &#x201C; []<sub><italic>LHS</italic></sub> &#x201C; that denoted a local history set (LHS) in part I. Because we will consider a PWA or MSA region that accommodates only one local history, the resulting LHS equivalence classes are trivial classes, each of which consists only of a single history. We will also omit the appended &#x201C; [<italic>C</italic><sub>k</sub>] &#x201C; to indicate the MSA region when it is obvious.</p>
</sec>
<sec id="s2a2">
<label>1.2.</label><title>Perturbation analyses on local PWA</title>
<p>In a PWA, &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>), a gap-configuration flanked by a pair of PASs corresponds to the portion of &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>) confined in &#x03B3;<sub><italic>k</italic></sub>. If we are interested only in the homology relationships among sites (<italic>i.e</italic>., homology structures (<xref ref-type="bibr" rid="c26">Lunter et al. 2005</xref>)), there are four broad types of gap-configurations (see <xref rid="fig2" ref-type="fig">Figure 2</xref>; see also Subsection 3.3 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>) for complexities concerning this issue). (i) Neither the ancestral nor the descendant sequence has even a single site in between the pair of PASs (panel A of <xref rid="fig2" ref-type="fig">Figure 2</xref>). (ii) The ancestor has one or more site(s) but the descendant has no site in between the PASs (panel B). (iii) The ancestor has no site but the descendant has one or more sites in between (panel C). And (iv) both the ancestor and the descendant have one or more site(s) in between, but no ancestral site is related to any of the descendant sites (panel D). We will consider these cases in turn.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Examples of four types of local gap configurations in PWA between ancestral and descendant sequences.</title>
<p><bold>A.</bold> Case (i). <bold>B.</bold> Case (ii) with &#x0394;<italic>L</italic><sup><italic>A</italic></sup> = 3. <bold>C.</bold> Case (iii) with &#x0394;<italic>L</italic><sup><italic>D</italic></sup> = 2. <bold>D</bold>. Case (iv) with &#x0394;<italic>L</italic><sup><italic>A</italic></sup> = 3 and &#x0394;<italic>L</italic><sup><italic>D</italic></sup> = 2. In each PWA, each site (a cell) is assigned an ancestry. In the leftmost column of each PWA, the boldface italic &#x2018;A&#x2019; and &#x2018;D&#x2019; stand for an ancestor (<italic>s</italic><sup><italic>A</italic></sup>) and a descendant (<italic>s</italic><sup><italic>D</italic></sup>), respectively. The magenta boxes and the cyan boxes represent unpreserved ancestral sites and inserted descendant sites, respectively. In panel D, the PWA on the right (in parentheses) is equivalent to the PWA on the left, as far as the homology structure alone is concerned.</p></caption>
<graphic xlink:href="023606_fig2.tif"/>
</fig>
<p>In case (i), the sequence states could be represented as <italic>s</italic><sup><italic>A</italic></sup> = <italic>s</italic><sup><italic>D</italic></sup> = [<italic>L</italic>, <italic>R</italic>]. In this case, <italic>N</italic><sub>min</sub> [&#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)] = 0, and thus there is only one fewest-indel history, [], where no indel event takes place. Therefore, in this case, the portion of the multiplication factor contributed by the fewest-indel history is:
<disp-formula id="eqn5"><alternatives><graphic xlink:href="023606_eqn5.gif"/></alternatives></disp-formula></p>
<p>In this case, there is no history consisting only of one indel event. And each next-fewest-indel history should be a two-event history of the form, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline17.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, <italic>L</italic><sup><italic>CO</italic></sup>, where <inline-formula><alternatives><inline-graphic xlink:href="023606_inline18.gif"/></alternatives></inline-formula>. Thus, the portion contributed by the next-fewest-indel histories is:
<disp-formula id="eqn6"><alternatives><graphic xlink:href="023606_eqn6.gif"/></alternatives></disp-formula></p>
<p>Let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline19.gif"/></alternatives></inline-formula> be the state resulting from the action of an insertion of <italic>l</italic> sites on <italic>s</italic><sup><italic>A</italic></sup>. Then, using Eq.(4.1.1b) and Eq.(3.1.8b) of part I, each summand is calculated as:
<disp-formula id="eqn7a"><alternatives><graphic xlink:href="023606_eqn7a.gif"/></alternatives></disp-formula></p>
<p>Here, as in Subsection 4.1 of part I, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline20.gif"/></alternatives></inline-formula> is the increment of the exit rate, which in turn is given by Eq.(2.4.1b&#x2019;) of part I. The second equation of Eq.(1.2.2b) follows from <inline-formula><alternatives><inline-graphic xlink:href="023606_inline21.gif"/></alternatives></inline-formula>. We could at least numerically calculate Eq.(1.2.2b) once the specific functional forms of the indel rates and the exit rates are given. For example, in a space-time-homogeneous model, like Dawg&#x2019;s indel model (<xref ref-type="bibr" rid="c6">Cartwright 2005</xref>), Eqs.(2.4.4a,b) of part I, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline22.gif"/></alternatives></inline-formula>, and Eq.(1.2.2b) is calculated as:
<disp-formula id="eqn7"><alternatives><graphic xlink:href="023606_eqn7.gif"/></alternatives></disp-formula></p>
<p>(Exactly the same expression can be obtained also from the &#x201C;long indel&#x201D; model, Eqs.(2.4.5a,b) of part I, if we notice the correspondence, Eqs.(2.4.7a,b,c,d) of part I.) Eq.(1.2.2b&#x2019;) (or Eq.(1.2.2b) itself) indicates that <inline-formula><alternatives><inline-graphic xlink:href="023606_inline23.gif"/></alternatives></inline-formula> for each <italic>l</italic> ? 1,&#x2026;, <italic>L</italic><sup><italic>CO</italic></sup>. Applying this inequality to Eq.(1.2.2a) and using another inequality, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline24.gif"/></alternatives></inline-formula>, we have:
<disp-formula id="eqn8"><alternatives><graphic xlink:href="023606_eqn8.gif"/></alternatives></disp-formula></p>
<p>Empirically, the rate of indels (&#x03BB;<sub><italic>I</italic></sub> &#x220A; &#x03BB;<sub><italic>D</italic></sub>) is estimated to be at most on the order of 1/10 of the substitution rate (<xref ref-type="bibr" rid="c25">Lunter 2007</xref>; <xref ref-type="bibr" rid="c7">Cartwright 2009</xref>). Eq.(1.2.3) indicates that, in case (i), even if the elapsed time (<italic>t</italic><sub><italic>F</italic></sub> ? <italic>t</italic><sub><italic>I</italic></sub>) is such that the substitution process is nearly saturated, e.g., &#x03BB;<sub><italic>S</italic></sub> (<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>) &#x02DC; 4, where &#x03BB;<sub><italic>S</italic></sub> is the total substitution rate per site, the total contribution from the next-fewest-indel histories, Eq.(1.2.2a), is at most on the order of 1/10 of the contribution by the fewest-indel history, Eq.(1.2.1). Thus, we expect that the fewest-indel contribution should approximate the entire multiplication factor (Eq.(4.1.8b) in part I) very well in case (i).</p>
<p>Incidentally, taking advantage of the result for case (i), we can calculate the multiplication factor for a gapless PWA segment consisting of <italic>L</italic><sup><italic>P</italic></sup> (&#x003E; 2) PASs. For clarity, let us consider an indel model as discussed in Subsection V-1. Then, in each of the <italic>L</italic><sup><italic>P</italic></sup> &#x2212; 1 inter-PAS positions this segment contains, a null indel history could occur independently of those in other positions. Let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline25.gif"/></alternatives></inline-formula> be the ancestries assigned to the <italic>L</italic><sup><italic>P</italic></sup> PASs in this segment (in spatial order). Focusing on the segment, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline26.gif"/></alternatives></inline-formula>. Then, excluding the contributions from both ends, the total multiplication factor for this segment is expressed as:
<disp-formula id="ueqn1"><alternatives><graphic xlink:href="023606_ueqn1.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023606_inline27.gif"/></alternatives></inline-formula> is the total multiplication factor for case (i) with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline28.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline29.gif"/></alternatives></inline-formula>. Under a space-homogeneous model, we can further simplify the above product as: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline30.gif"/></alternatives></inline-formula>. Here we used the uniform multiplication factor,.
<disp-formula id="ueqn2"><alternatives><graphic xlink:href="023606_ueqn2.gif"/></alternatives></disp-formula></p>
<p>In case (ii), we assume that the ancestral state has &#x220A;<italic>L</italic><sup><italic>A</italic></sup> sites in between the flanking PASs. Thus, the ancestral and descendant states could be represented as [<italic>s</italic><sup><italic>A</italic></sup> &#x0394;<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>, <italic>R</italic>] and <italic>s</italic><sup><italic>D</italic></sup> = [<italic>L</italic>, <italic>R</italic>], respectively. As long as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline31.gif"/></alternatives></inline-formula>, <italic>N</italic><sub>min</sub> [&#x03B3;<sub>k</sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)]= 1, and there is only one fewest-indel history, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline32.gif"/></alternatives></inline-formula> which consists of a single event that deletes the ancestral sites in between the PASs. Therefore, the contribution by the fewest-indel history is:
<disp-formula id="eqn9"><alternatives><graphic xlink:href="023606_eqn9.gif"/></alternatives></disp-formula></p>
<p>Each next-fewest indel history is composed of two indel events. There are two types. (a) Two successive deletions, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline33.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, &#x220A;<italic>L</italic><sup><italic>A</italic></sup> &#x2212; 1 and <italic>x</italic> = 2,&#x2026;, &#x220A;<italic>L</italic><sup><italic>A</italic></sup> &#x2212; <italic>l</italic> &#x220A; 2. And (b) an insertion followed by a deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline34.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline35.gif"/></alternatives></inline-formula> and <italic>x</italic> = 1,&#x2026;,&#x220A; <italic>L</italic><sup><italic>A</italic></sup> &#x220A;1. Thus, in this case, the total contribution by the next-fewest indel histories is given by:
<disp-formula id="eqn10"><alternatives><graphic xlink:href="023606_eqn10.gif"/></alternatives></disp-formula></p>
<p>Here,
<disp-formula id="eqn11"><alternatives><graphic xlink:href="023606_eqn11.gif"/></alternatives></disp-formula>
is the sum of contributions from the histories of type (a). And
<disp-formula id="eqn12"><alternatives><graphic xlink:href="023606_eqn12.gif"/></alternatives></disp-formula>
is the sum of contributions from the histories of type (b). Let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline36.gif"/></alternatives></inline-formula> be the intermediate state in each type (a) history. Then, the history&#x2019;s contribution is calculated as:
<disp-formula id="eqn13"><alternatives><graphic xlink:href="023606_eqn13.gif"/></alternatives></disp-formula></p>
<p>Similarly, let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline37.gif"/></alternatives></inline-formula> be the intermediate state in each type (b) history. Then, the history&#x2019;s contribution is calculated as:
<disp-formula id="eqn14"><alternatives><graphic xlink:href="023606_eqn14.gif"/></alternatives></disp-formula></p>
<p>Eq.(1.2.4) and Eqs.(1.2.5a-e) can indeed be calculated at least numerically once the specific functional forms of the indel rates and the exit rates are given. For example, under Dawg&#x2019;s indel model (Eqs.(2.4.4a,b) in part I) or the &#x201C;long indel&#x201D; model as noted in case (i), we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline38.gif"/></alternatives></inline-formula>, and Eq.(1.2.4) becomes:
<disp-formula id="eqn15"><alternatives><graphic xlink:href="023606_eqn15.gif"/></alternatives></disp-formula></p>
<p>Similarly, using <inline-formula><alternatives><inline-graphic xlink:href="023606_inline39.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline40.gif"/></alternatives></inline-formula> in Dawg&#x2019;s model (and also in the &#x201C;long indel&#x201D; model) are calculated, respectively, as:
<disp-formula id="eqn16"><alternatives><graphic xlink:href="023606_eqn16.gif"/></alternatives></disp-formula>
<disp-formula id="eqn17"><alternatives><graphic xlink:href="023606_eqn17.gif"/></alternatives></disp-formula></p>
<p>Substituting Eqs.(1.2.5d&#x2019;,e&#x2019;) into Eqs.(1.2.5a,b,c), we can concretely calculate the total contribution of the next-fewest-indel histories. <xref rid="fig3" ref-type="fig">Figure 3</xref> A shows the ratio of the total next-fewest-indel contribution, Eq.(1.2.5a), to the fewest-indel contribution, Eq.(1.2.4), as a function of the number of deleted ancestral sites (&#x220A;<italic>L</italic><sup><italic>A</italic></sup>) and the expected number of indels per site ((&#x03BB;<sub><italic>I</italic></sub> &#x220A; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>)). For the figure, we used the following parameters: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline41.gif"/></alternatives></inline-formula>, and &#x03BB;<sub>I</sub>/&#x03BB;<sub>D</sub> = 1. The power-law behavior of the indel length distributions broadly conforms to the past empirical observations <italic>e.g</italic>., <xref ref-type="bibr" rid="c19">Gonnet et al. 1992</xref>; <xref ref-type="bibr" rid="c1">Benner et al. 1993</xref>; <xref ref-type="bibr" rid="c21">Gu and Li 1995</xref>; <xref ref-type="bibr" rid="c22">Kent et al. 2003</xref>; <xref ref-type="bibr" rid="c41">Zhang and Gerstein 2003</xref>; <xref ref-type="bibr" rid="c8">Chang and Benner 2004</xref>; <xref ref-type="bibr" rid="c39">Yamane et al. 2006</xref>; <xref ref-type="bibr" rid="c15">Fan et al. 2007</xref>). Here, the exact overall indel rate (&#x03BB;<sub><italic>I</italic></sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>) does not matter, because the probabilities are invariant under the simultaneous rescaling of the rate and the time interval (<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>) that keeps the expected number of indels per site (<italic>i.e.</italic>, (&#x03BB;<sub><italic>I</italic></sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>)) unchanged. Moreover, we confirmed that the results remain almost the same even if we use <inline-formula><alternatives><inline-graphic xlink:href="023606_inline42.gif"/></alternatives></inline-formula>. Now, as indicated by <xref rid="fig3" ref-type="fig">Figure 3A</xref>, each curve for a fixed (&#x03BB;<sub><italic>I</italic></sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x002B;<italic>t</italic><sub><italic>I</italic></sub>) reaches an asymptotic value slightly above 1 when &#x0394;<italic>L</italic><sup><italic>A</italic></sup> is sufficiently large. Thus, to define a threshold within which the fewest-indel histories alone are likely to give a decent approximation of the probability, using the point at which the ratio is 1 (unity) is risky. Here, we tentatively define the threshold as the value of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> at which the ratio is 0.5. With this definition, the tentative threshold, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline43.gif"/></alternatives></inline-formula>, is around 128, 31, 12, 6 and 3 when (&#x03BB;<sub>I</sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>) is 0.01, 0.04, 0.1, 0.2 and 0.4, respectively (<xref ref-type="table" rid="tbl1">Table 1</xref>). Hence, we have a rough inversely proportional relationship: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline44.gif"/></alternatives></inline-formula>, under the parameter setting used here.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Various &#x201C;threshold gap lengths&#x201D; in case (ii) of local PWAs</title></caption>
<graphic xlink:href="023606_tbl1.tif"/>
</table-wrap>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Perturbation analyses on local PWA probabilities.</title>
<p>The results shown in all panels of this figure apply to both case (ii) and case (iii) local PWAs. In all panels, the abscissa is &#x0394;<italic>L</italic><sup><italic>A</italic></sup> in case (ii) and &#x0394;<italic>L</italic><sup><italic>D</italic></sup> in case (iii). Panel <bold>A</bold> shows the ratio of the total probability of the next-fewest-indel histories to that of the fewest-indel history. The blue, magenta, cyan, purple and green curves show the ratios when the expected numbers of indels per site, <italic>i.e</italic>., the values of (<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>), are 0.01, 0.04, 0.1, 0.2 and 0.4, respectively. Panels <bold>B</bold> and <bold>C</bold> show the ratios of the multiplication factors calculated <italic>via</italic> the iteration formulas (either Eq.(1.2.8) or Eq.(A1.3.3) in Appendix A1), including histories with up to <italic>N</italic><sub><italic>ID</italic></sub> = 1 (blue), 2 (magenta), 5 (green), 10 (purple), and 20 (cyan) indels, to the factor including histories with up to <italic>N</italic><sub><italic>ID</italic></sub> = 50 indels. Panel B is for (<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>) = 0.04 indels per site, and panel C is for (<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>) = 0.2 indels per site. The following parameters were used for all panels: <italic>f</italic><sub><italic>l</italic></sub>(<italic>l</italic>) = <italic>f</italic><sub><italic>D</italic></sub>(<italic>l</italic>) &#x221D; <italic>l</italic><sup>&#x2212;1.6</sup>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline45.gif"/></alternatives></inline-formula> and <italic>&#x03BB;</italic><sub><italic>I</italic></sub>/<italic>&#x03BB;</italic><sub><italic>D</italic></sub> = 1. For panels B and C, we also set the following parameters: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline46.gif"/></alternatives></inline-formula> and (<italic>&#x03BB;</italic><sub><italic>I</italic></sub> = <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>)/<italic>N</italic><sub><italic>P</italic></sub> = 0.002.</p></caption>
<graphic xlink:href="023606_fig3.tif"/>
</fig>
<p>In case (iii), we assume that the descendant state has &#x0394;<italic>L</italic><sup><italic>D</italic></sup> sites in between the flanking PASs. Thus, the ancestral and descendant states could be represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline47.gif"/></alternatives></inline-formula>, respectively. The ancestries satisfy <inline-formula><alternatives><inline-graphic xlink:href="023606_inline48.gif"/></alternatives></inline-formula> for every <italic>i</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline49.gif"/></alternatives></inline-formula> for every pair (<italic>i</italic>, <italic>j</italic>) with <italic>i</italic> &#x2260; <italic>j</italic>, and their details depend on the responsible indel history. (Actually, such details don&#x2019;t matter in the state space <italic>S</italic><sup><italic>II</italic></sup>, as explained in Subsection 2.1 of part I.) As long as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline50.gif"/></alternatives></inline-formula>, and there is only one fewest-indel history, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline51.gif"/></alternatives></inline-formula>. The history consists of a single event that inserts the descendant sites in between the PASs. As in case (ii), each next-fewest indel history is composed of two indel events, and classified into two types. (c) Two successive insertions, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline52.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2212; 1 and <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2212; <italic>l</italic> &#x220A;1. And (d) an insertion followed by a deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline53.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline54.gif"/></alternatives></inline-formula> and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; 2. The sum of contributions by the fewest-indel histories and that by the next-fewest-indel histories can be calculated as in case (ii). And their calculations are detailed in Appendix A1.1. If calculated under the same setting as used for <xref rid="fig3" ref-type="fig">Figure 3</xref> A and with the same value of (&#x03BB;<sub><italic>I</italic></sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>), their ratio with <italic>L</italic><sup><italic>D</italic></sup> = <italic>L</italic> is identical to that in case (ii) with &#x0394;<italic>L</italic><sup><italic>A</italic></sup> = <italic>L</italic>, because of the symmetry of the probabilities under the time reversal. Thus, the same conclusions can be drawn from <xref rid="fig3" ref-type="fig">Figure 3</xref> A also on this case.</p>
<p>In case (iv), we assume that the ancestral and the descendant states have &#x0394;<italic>L</italic><sup><italic>A</italic></sup> and [<italic>L</italic><sup><italic>D</italic></sup> sites, respectively, in between the flanking PASs. Thus, the ancestral and descendant states could be represented as <italic>s</italic><sup><italic>A</italic></sup> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>, <italic>R]</italic> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline55.gif"/></alternatives></inline-formula>, respectively. Here, the descendant ancestries satisfy <inline-formula><alternatives><inline-graphic xlink:href="023606_inline56.gif"/></alternatives></inline-formula> for every <italic>i</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline57.gif"/></alternatives></inline-formula>for every pair (<italic>i</italic>, <italic>j</italic>) with <italic>i</italic> &#x2260; <italic>j</italic>, and their details depend on the responsible indel history. (Again, the details don&#x2019;t matter in the space <italic>S</italic><sup><italic>II</italic></sup>.) As long as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline58.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline59.gif"/></alternatives></inline-formula>, <italic>N</italic><sub>min</sub> &#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>) 2. As indicated by Eqs.(A1.3c&#x2019;,d&#x2019;) in Appendix A1 of part I, there are three types of fewest-indel histories. (e) The deletion of the ancestral sites followed by an insertion of &#x0394;<italic>L</italic><sup><italic>D</italic></sup> sites, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline60.gif"/></alternatives></inline-formula>. (f) An insertion immediately on the right of the ancestral sites to be deleted, followed by the deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline61.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline62.gif"/></alternatives></inline-formula>. And (g) an insertion immediately on the left of the ancestral sites to be deleted, followed by the deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline63.gif"/></alternatives></inline-formula> also with <italic>l</italic> = 0,&#x2026;, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline64.gif"/></alternatives></inline-formula>. In this case, each next-fewest-indel history is composed of three indel events, and classified into one of 6 broad types: (h) two successive deletions followed by an insertion; (i) a deletion, followed by an insertion, followed by a deletion; (j) an insertion followed by two successive deletions; (k) a deletion followed by two successive insertions; (l) an insertion, followed by a deletion, followed by an insertion; and (m) two successive insertions followed by a deletion.</p>
<p>And these six broad types can be further sub-classified into 24 sub-types, as described in Appendix A1.2. The calculations of the sum of contributions from the fewest-indel local histories and that from the next-fewest-indel local histories are also detailed in Appendix A1.2. <xref ref-type="table" rid="tbl2">Table 2</xref> shows their ratios calculated for some typical configurations under the same setting as for <xref rid="fig3" ref-type="fig">Figure 3</xref> A. As the table indicates, the approximation by the fewest-indel histories alone is likely to be decent as long as the expected number of indels (<italic>i.e</italic>., (&#x03BB;<sub><italic>I</italic></sub> &#x002B; &#x03BB;<sub><italic>D</italic></sub>)(<italic>t</italic><sub><italic>F</italic></sub> &#x2212; <italic>t</italic><sub><italic>I</italic></sub>)) and the gap lengths (i.e., &#x0394;<italic>L</italic><sup><italic>A</italic></sup> and &#x0394;<italic>L</italic><sup><italic>D</italic></sup>) are at most moderate.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Perturbation analysis on local PWA probabilities in case (iv)</title></caption>
<graphic xlink:href="023606_tbl2.tif"/>
</table-wrap>
<p>It is difficult to calculate the summed contributions from local histories involving more indels, especially in case (iv). We could calculate the contribution from a single local history involving any number of indels if we use the algorithm for a &#x201C;trajectory likelihood&#x201D; given by <xref ref-type="bibr" rid="c31">Mikl&#x00F3;s et al. (2004)</xref>. As we exemplified in Appendix A1.2, however, it is already quite hard to enumerate all possible local indel histories even up to the next-to-minimum number of involved indels. Nevertheless, if we consider only cases (i), (ii), and (iii) under a (locally) spatially homogeneous model, we can work out systems of &#x201C;exact&#x201D; integral equations that could in principle provide the numerical solutions for the total sum of contributions to a multiplication factor up to a desired level of accuracy (at some time and memory expenses). In the following, we derive a system of integral equations to give multiplication factors for cases (i) and (ii). Another system of integral equations, which gives multiplication factors for cases (i) and (iii), is derived in Appendix A1.3.</p>
<p>Here, we assume that the indel rates are locally homogeneous, which means that the rates do not depend on the exact positions that the indels hit, <italic>as long as</italic> they are confined in the region that accommodates the local history. Thus, we assume that the indel rate is <italic>locally</italic> homogeneous and the exit rate is <italic>locally</italic> an affine function of the (local) sequence length, but that they may be non-homogeneous <italic>globally</italic>. (In terms of equations, we <italic>locally</italic> assume Eqs.(5.1.1a,b) of part I for the indel rates and Eq.(5.2.4) of part I for the <italic>local</italic> exit rate, but we assume something like Eqs.(5.3.2a,b,c) of part I for the <italic>global</italic> exit rate.) We are now considering only cases (i) and (ii), in which (local) ancestral and descendant states should be <italic>s</italic><sup><italic>A</italic></sup> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>, <italic>R]</italic> and <italic>s</italic><sup><italic>D</italic></sup> = [<italic>L</italic>, <italic>R</italic>], respectively, with &#x0394;<italic>L</italic><sup><italic>A</italic></sup> = 0,1, 2,&#x2026;. Because ofthe local homogeneity, Eqs.(V-1.1a,b), the exit rate <inline-formula><alternatives><inline-graphic xlink:href="023606_inline65.gif"/></alternatives></inline-formula> of a state <italic>s</italic> (&#x220A; <italic>S</italic>) in this context depends only on the (local) sequence length, <italic>L</italic>(<italic>s</italic>) = 2 &#x220A; &#x0394;<italic>L</italic>(<italic>s</italic>). Thus, &#x220A;<italic>L</italic>(<italic>s</italic>) adequately represents the local sequence state <italic>s</italic>, and we let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline66.gif"/></alternatives></inline-formula> denote its (local) exit rate. The starting point of the equation system is the fundamental integral equation (Eq.(3.1.4) of part I) for the stochastic indel evolution operator <inline-formula><alternatives><inline-graphic xlink:href="023606_inline67.gif"/></alternatives></inline-formula>. <italic>P</italic>We sandwich the fundamental integral equation with &#x2329; <italic>s</italic><sup><italic>A</italic></sup> &#x007C; and <italic>s</italic><sup><italic>D</italic></sup> &#x232A;, and expand the instantaneous mutation operator <inline-formula><alternatives><inline-graphic xlink:href="023606_inline68.gif"/></alternatives></inline-formula> using its definition (<italic>i.e</italic>., Eq.(3.1.1c) of part I supplemented by Eqs.(2.4.2b&#x2019;,c&#x2019;) of part I). Because we know that the flanking PASs, which are assigned the ancestries <italic>L</italic> and <italic>R</italic>, have never been struck by any indels, we can ignore the effects of indels that hit the PASs. And, because we are now focusing on the local alignment, we will also ignore the indels completely outside of the region delimited by the PASs. Thus, we have:
<disp-formula id="eqn18"><alternatives><graphic xlink:href="023606_eqn18.gif"/></alternatives></disp-formula></p>
<p>In the present setting, the number of sites between the PASs, &#x220A;<italic>L</italic>(<italic>s</italic>), uniquely determines the local sequence state <italic>s</italic>. Thus, we let the local states denoted as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline69.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline70.gif"/></alternatives></inline-formula>. We also introduce the notation, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline71.gif"/></alternatives></inline-formula>, for the probability that the local state with &#x0394;<italic>L</italic> sites in between the PASs at time <italic>t</italic> became a state with &#x0394;<italic>L</italic>&#x2032; sites in between at time <italic>t</italic>&#x2035;. Then, taking advantage of the independence of the indel rates, exit rates and <italic>P</italic><sup><italic>ID</italic></sup> (&#x220A;<italic>L</italic> &#x21A6; &#x0394;<italic>L</italic>&#x2035;); [<italic>t</italic>, <italic>t</italic>&#x2035;] on the position of each indel (<italic>x</italic>), we have:
<disp-formula id="eqn19"><alternatives><graphic xlink:href="023606_eqn19.gif"/></alternatives></disp-formula></p>
<p>Here &#x03B4;(&#x0394;<italic>L</italic>, &#x0394;<italic>L</italic>&#x2035;) is Kronecker&#x2019;s delta, which equals 1 if &#x0394;<italic>L</italic> &#x2035;&#x0394;<italic>L</italic>&#x2035;, and 0 if &#x0394;<italic>L</italic> = <italic>L</italic>&#x2035;&#x220A;. Eq.(1.2.7) gives the desired system of integral equations for the &#x201C;exact&#x201D; probabilities, <italic>P</italic><sup><italic>ID</italic></sup> ?&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x21A6; 0; [<italic>t</italic>, <italic>t</italic>]&#x2035;, with non-negative integers &#x0394;<italic>L</italic><sup><italic>A</italic></sup> 0,1, 2,&#x2026;. This equation holds for every non-negative integer ?<italic>L</italic><sup><italic>A</italic></sup> and even if we replace the initial time <italic>t</italic> with any time in the closed interval [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>]. Thus, the equations can be solved iteratively, starting with the &#x201C;zero-event approximation&#x201D; of the probability, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline72.gif"/></alternatives></inline-formula>, and calculating the approximation at the <italic>n</italic><sub><italic>S</italic></sub> th step, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline73.gif"/></alternatives></inline-formula>, from the approximation at the previous step via the recursion relation:
<disp-formula id="eqn20"><alternatives><graphic xlink:href="023606_eqn20.gif"/></alternatives></disp-formula></p>
<p>If <italic>N</italic><sub><italic>ID</italic></sub> iteration steps are performed, the resulting probability, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline74.gif"/></alternatives></inline-formula>, is the summation of the probabilities over all possibly responsible local histories consisting of up to (and including) <italic>N</italic><sub><italic>ID</italic></sub> indel events. After the iteration is finished, the multiplication factor will be obtained by following its definition (<italic>i.e</italic>., Eq.(4.1.1b) in part I). We have:
<disp-formula id="eqn21"><alternatives><graphic xlink:href="023606_eqn21.gif"/></alternatives></disp-formula></p>
<p>The accuracy of the numerical solutions will depend on how finely we partition the time interval [<italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic></sub>]. If the interval is partitioned into <italic>N</italic><sub><italic>P</italic></sub> equal-sized sub-intervals, we could in principle achieve an accuracy of <italic>O</italic> ((<italic>N</italic><sub><italic>P</italic></sub>)<sup>4</sup>) under Simpson&#x2019;s rule (<italic>e.g</italic>., <xref ref-type="bibr" rid="c33">Press et al. 1992</xref>). However, as the number of sub-intervals increases, it would take longer to complete the calculation. A na&#x00EF;ve implementation of the aforementioned numerical iteration would have the time complexity of <italic>O</italic> (<italic>N</italic> (<italic>L</italic><sup><italic>CO</italic></sup>)<sup>2</sup> (<italic>N</italic>)<sup>2</sup>) and the space complexity of <italic>O</italic> (<italic>L</italic><sup><italic>CO</italic></sup> <italic>N</italic>), when we want to obtain the total probabilities of local histories composed of up to <italic>N</italic><sub><italic>ID</italic></sub> indels each, with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline75.gif"/></alternatives></inline-formula>. Here we set <inline-formula><alternatives><inline-graphic xlink:href="023606_inline76.gif"/></alternatives></inline-formula>. This becomes impractically slow when either <italic>L</italic><sup><italic>CO</italic></sup> or <italic>N</italic><sub><italic>P</italic></sub> is large, <italic>e.g</italic>., around 1000 or greater. It is likely that <italic>N</italic><sub><italic>P</italic></sub> does not have to be this large, as it would be usually enough to set <italic>N</italic> around 100 or smaller. However, <italic>L</italic><sup><italic>CO</italic></sup> will often be around 1000 or greater, indeed making the na&#x00EF;ve algorithm too slow to be practical. Fortunately, we can avoid this problem by rewriting the recursion equation, Eq.(1.2.7&#x2019;), as:
<disp-formula id="eqn22"><alternatives><graphic xlink:href="023606_eqn22.gif"/></alternatives></disp-formula></p>
<p>Here, the &#x201C;auxiliary function,&#x201D; <inline-formula><alternatives><inline-graphic xlink:href="023606_inline77.gif"/></alternatives></inline-formula> is given by:
<disp-formula id="eqn23"><alternatives><graphic xlink:href="023606_eqn23.gif"/></alternatives></disp-formula></p>
<p>Consider the following &#x201C;two-sub-step&#x201D; algorithm. In the first sub-step (in each iteration step), it calculates <inline-formula><alternatives><inline-graphic xlink:href="023606_inline78.gif"/></alternatives></inline-formula>&#x2019;s via Eq.(1.2.9b) and stores them for all &#x0394;<italic>L</italic><sup><italic>A</italic></sup> ? 0,1, 2,&#x2026;, <italic>L</italic><sup><italic>CO</italic></sup> at all time points, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline79.gif"/></alternatives></inline-formula> with <italic>i</italic> = 0,1,&#x2026;, <italic>N</italic><sub><italic>P</italic></sub>. And, in the second sub-step, it uses them to calculate the probabilities <inline-formula><alternatives><inline-graphic xlink:href="023606_inline80.gif"/></alternatives></inline-formula> via Eq.(1.2.9a) for the same values of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> and <italic>t</italic>. This algorithm can reduce the time-complexity to <italic>O</italic> (<italic>N L</italic><sup><italic>CO</italic></sup> (<italic>L</italic><sup><italic>CO</italic></sup> &#x220A; <italic>N</italic>)<italic>N</italic>) while keeping the space complexity to be <italic>O</italic> (<italic>L</italic><sup><italic>CO</italic></sup> <italic>N</italic>). This algorithm does finish in a practical amount of time (typically on the order of an hour or shorter when implemented in Perl). But it may still be too slow to perform each time we evaluate the probability of the gap configuration of a local MSA. Good news is that a single run of the iteration algorithm <italic>inevitably</italic> calculates the probabilities for all <inline-formula><alternatives><inline-graphic xlink:href="023606_inline81.gif"/></alternatives></inline-formula> at all temporal partitioning points, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline82.gif"/></alternatives></inline-formula>, as well as at <italic>t</italic> = <italic>t</italic><sub><italic>I</italic></sub> and <italic>t</italic> = <italic>t</italic><sub><italic>F</italic></sub>. Thus, once we calculate the probabilities with a fixed set of model parameters, we could use them to calculate the probabilities of various alignments (under various phylogenetic trees), as long as the model parameters remain unchanged. In any case, the time and space complexities might be further reduced without considerably compromising the accuracy by a clever beforehand discarding of terms that are unlikely to make significant contributions to the final probabilities. Panels B and C of <xref rid="fig3" ref-type="fig">Figure 3</xref> show the ratios of the multiplication factors, Eq.(1.2.8) at <italic>N</italic><sub><italic>ID</italic></sub> ? 1, 2, 5, 10, 20 iteration steps, to that at <italic>N</italic><sub><italic>ID</italic></sub> ? 50 steps. They were calculated with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline83.gif"/></alternatives></inline-formula>, and under the same setting as that used for <xref rid="fig3" ref-type="fig">Figure 3</xref> A. (We confirmed that results remain almost the same even if <italic>L</italic><sup><italic>CO</italic></sup> is greater than 1000, instead of <italic>L</italic><sup><italic>CO</italic></sup> ? 500 used for the figure.) When <italic>N</italic><sub><italic>ID</italic></sub> = 2, we actually started from <italic>N</italic><sub><italic>ID</italic></sub> = 2, at which the probabilities were calculated using Eqs.(1.2.2a,b&#x2019;), Eq.(1.2.4&#x2019;) and Eqs.(1.2.5a,b,c,d&#x2019;,e&#x2019;), in stead of from <italic>N</italic><sub><italic>ID</italic></sub> ? 0 as mentioned above, in order to enhance the accuracy of the approximation. As indicated by the panels B and C, the accuracy of the probabilities improves in a step-wise manner as the number of iterations increases. Now that the &#x201C;exact&#x201D; probabilities are available in cases (i) and (ii), we can use them to define more precise threshold values of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> within which the approximate probabilities are expected to be quite accurate. For example, let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline84.gif"/></alternatives></inline-formula>be the value of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> at which the approximation by the 1-event local indel history alone accounts for 50&#x0025; of the total probability of the local PWA. As shown in <xref ref-type="table" rid="tbl1">Table 1</xref>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline85.gif"/></alternatives></inline-formula> is slightly larger than the aforementioned &#x201C;tentative threshold,&#x201D; <inline-formula><alternatives><inline-graphic xlink:href="023606_inline86.gif"/></alternatives></inline-formula>. Indeed, we can observe a rough inversely proportional relationship, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline87.gif"/></alternatives></inline-formula>. Thus, we expect that the tentative threshold <inline-formula><alternatives><inline-graphic xlink:href="023606_inline88.gif"/></alternatives></inline-formula> should work as a slightly conservative criterion for the decency of the approximation by the fewest-indel histories alone. We could also define the threshold, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline89.gif"/></alternatives></inline-formula>, at which the probability calculated up to (and including) <italic>N</italic><sub><italic>ID</italic></sub> iterations, <italic>i.e</italic>., <inline-formula><alternatives><inline-graphic xlink:href="023606_inline90.gif"/></alternatives></inline-formula>, is 1/2 (=0.5) of the &#x201C;exact solution.&#x201D; As indicated by <xref ref-type="table" rid="tbl1">Table 1</xref>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline91.gif"/></alternatives></inline-formula>is over <italic>N</italic> times as large as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline92.gif"/></alternatives></inline-formula>. This implies that, even when the fewest-indel histories alone give a poor approximation of the probability, taking account of the next-fewest-indel histories, or of the histories involving yet more indels, will considerably expand the range of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> where the approximate probability is quite accurate.</p>
<p>Following the similar procedures, this time starting from the integral equation, Eq.(III-1.2), we can also derive a system of integral equations for the multiplication factors for cases (i) and (iii), as described in Appendix A1.3. Thanks to the symmetry of the probabilities under the time reversal, panels B and C of <xref rid="fig3" ref-type="fig">Figure 3</xref> can also be interpreted as the results of numerical calculations of this equation system, under the same setting as above except that <inline-formula><alternatives><inline-graphic xlink:href="023606_inline93.gif"/></alternatives></inline-formula> is replaced by <inline-formula><alternatives><inline-graphic xlink:href="023606_inline94.gif"/></alternatives></inline-formula>.</p>
</sec>
<sec id="s2a3">
<label>1.3.</label><title>Perturbation analyses on local MSA</title>
<p>Compared to contributions to local PWAs, those to local MSAs are much more complex. In this subsection, we consider some simple but common patterns, under a tree <italic>T</italic> with three OTUs, corresponding to the external nodes, <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub> and <italic>n</italic><sub>3</sub>. Here, we regard its single internal node as the root node <italic>n</italic><sup><italic>Root</italic></sup> for simplicity (panel A of <xref rid="fig4" ref-type="fig">Figure 4</xref>). Let <italic>b</italic><sub><italic>m</italic></sub>(<italic>m</italic> ? 1, 2, 3) be the branch that connects the nodes <italic>n</italic><sup><italic>Root</italic></sup> and <italic>n</italic>. Let <italic>s</italic><sub><italic>m</italic></sub> &#x220A; <italic>S</italic> (<italic>m</italic> = 1, 2, 3) be the (local) sequence state at node <italic>n</italic><sub><italic>m</italic></sub>. Then, we consider the gap-configurations of the MSAs of the three sequences, &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>], as well as the consistent sequence states <italic>s</italic><sup><italic>Root</italic></sup> &#x220A; <italic>S</italic> at the root node <italic>n</italic><sup><italic>Root</italic></sup>. As in the previous subsections, we focus on the portion of MSAs delimited by a pair of PASs, whose ancestries are denoted as <italic>L</italic> and <italic>R</italic>. Here we consider four typical situations (see <xref rid="fig4" ref-type="fig">Figure 4</xref>; see also Subsection 3.4 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>) for complexities concerning this issue). (I) None of ?<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic>3? have any site in between the PASs (<xref rid="fig4" ref-type="fig">Figure 4</xref>, panel B). (II) <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> share the identical set of sites in between the PASs, but <italic>s</italic><sub>3</sub> has no site in between (panel C). (III) <italic>s</italic><sub>1</sub> has a set of sites in between the PASs, but neither <italic>s</italic><sub>2</sub> nor <italic>s</italic><sub>3</sub> has even a single site in between (panel D). And (IV) <italic>s</italic><sub>1</sub> has a set of sites in between the PASs, but <italic>s</italic><sub>3</sub> has no site in between, and <italic>s</italic><sub>2</sub> lacks a run of some, but not all, of contiguous sites of <italic>s</italic><sub>1</sub> in between the PASs (panel E).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Typical local gap configurations in MSAs considered for perturbation analyses in Subsection 1.3 of Results.</title>
<p><bold>A.</bold> The 3-OTU tree used in the perturbation analyses and the notation. A node (open circle) is labeled <italic>n</italic><sub><italic>i</italic></sub> (external) or <italic>n</italic><sup><italic>Root</italic></sup> (root). A branch is labeled <italic>b</italic><sub><italic>i</italic></sub>. <bold>B.</bold> Local gap configuration in case (I). <bold>C.</bold> Case (II) with &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup> = 5. <bold>D.</bold> Case (III) with &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> = 5. <bold>E.</bold> Case (IV) with &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> = 5, <italic>i</italic> = 2 and <italic>j</italic> = 5. In this figure, none of the sites are colored, to take account of the possibilities of their preservations, insertions and deletions.</p></caption>
<graphic xlink:href="023606_fig4.tif"/>
</fig>
<p>These situations are not restricted to the 3-OTU trees but widely applicable to each portion surrounding a trivalent node of any tree topology, although they never exhaust all gap configurations. The time at <italic>n</italic><sup><italic>Root</italic></sup> will be represented as <italic>t</italic>, and the time at node <italic>n</italic><sub><italic>m</italic></sub> will be represented as <italic>t</italic><sub><italic>F</italic></sub><sub>:</sub><sub><italic>m</italic></sub>. The indel parameters along branch <italic>b</italic><sub><italic>m</italic></sub> will be indicated by the subscript &#x201C;:<italic>m</italic>.&#x201D;</p>
<p>Case (I) is represented by the external sequence states <italic>s</italic><sub>1</sub> = <italic>s</italic><sub>2</sub> = <italic>s</italic><sub>3</sub> = [<italic>L</italic>, <italic>R</italic>]. In this case, we have <italic>N</italic><sub>min</sub> [<italic>C</italic><sub>k</sub>; &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic>3]; <italic>T</italic>] = 0. And the set of fewest-indel local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline95.gif"/></alternatives></inline-formula>, is composed only of a no-indel history:
<disp-formula id="eqn24"><alternatives><graphic xlink:href="023606_eqn24.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline96.gif"/></alternatives></inline-formula>. Thus, according to Eq.(1.1.2b), supplemented by Eqs.(4.2.4b,6b,8) of part I, the portion of the multiplication factor contributed by the fewest-indel local history is:
<disp-formula id="eqn25"><alternatives><graphic xlink:href="023606_eqn25.gif"/></alternatives></disp-formula></p>
<p>Here we used <inline-formula><alternatives><inline-graphic xlink:href="023606_inline97.gif"/></alternatives></inline-formula>. No single-event local history can result in the gap configuration in this case. Each next-fewest-indel history consists of two indels, and it can be represented as:
<disp-formula id="eqn26"><alternatives><graphic xlink:href="023606_eqn26.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline98.gif"/></alternatives></inline-formula>, and with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline99.gif"/></alternatives></inline-formula> again. Thus, the total contribution to the multiplication factor by the next-fewest-indel histories can be calculated similarly to Eqs.(1.2.2a,b). We have:
<disp-formula id="eqn27"><alternatives><graphic xlink:href="023606_eqn27.gif"/></alternatives></disp-formula></p>
<p>Each summand can be calculated from Eq.(1.2.2b), by replacing <italic>s</italic><sup><italic>A</italic></sup> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline100.gif"/></alternatives></inline-formula> and also replacing the time and rate parameters with those assigned to each branch. Especially, under Dawg&#x2019;s model, each summand is calculated as:
<disp-formula id="eqn28"><alternatives><graphic xlink:href="023606_eqn28.gif"/></alternatives></disp-formula></p>
<p>---Eq.(1.3.4b)</p>
<p>If the three branches share the same time interval and the indel rate parameters, the summed contribution from the next-fewest-indel histories, Eq.(1.3.4a), is exactly three times Eq.(1.2.2a) for a PWA. Indeed, this total contribution on a general tree can be calculated by summing Eq.(1.2.2a) (with appropriate parameters) over all branches of the tree. Following the same line of reasoning as around Eq.(1.2.3), this total contribution is roughly proportional to the summation of the squared branch lengths over all branches. This means that a richer sampling of the homologous sequences will not significantly increase, or might rather slightly decrease, this total contribution, as long as the maximum evolutionary distance remains at a similar level. Incidentally, any root sequence state of the type <italic>s</italic><sup><italic>Root</italic></sup> ?? &#x0394;<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>Root</italic></sup>, <italic>R]</italic> is also consistent with &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>] in this case. Such a state, however, would require at least three indels, in order to delete the extra sites, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>Root</italic></sup>, independently along the three branches. Thus, the contributions from the local indel histories with such root states would be smaller in general.</p>
<p>Case (II) is represented by the external sequence states <italic>s</italic> = <italic>s</italic> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup>, <italic>R</italic>] and <italic>s</italic>3 = [<italic>L</italic>, <italic>R</italic>]. In this case, the &#x201C;phylogenetic correctness"condition (see, <italic>e.g</italic>., <xref ref-type="bibr" rid="c9">Chindelevitch et al. 2006</xref>; Section 3.4 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>)) dictates that the root state <italic>s</italic><sup><italic>Root</italic></sup> must have all the sites with ancestries 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup>. In this case, we have <italic>N</italic><sub>min</sub><italic>C</italic> <sub>k</sub>; &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>]; <italic>T</italic> = = 1. And the set of fewest-indel local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline101.gif"/></alternatives></inline-formula>, consists of a single element:
<disp-formula id="eqn29"><alternatives><graphic xlink:href="023606_eqn29.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline102.gif"/></alternatives></inline-formula>. Again, according to Eq.(1.1.2b), supplemented by Eqs.(4.2.4b,6b,8) of part I, the contribution by the fewest-indel local history turns out to be exactly the same as Eq.(1.2.4) for case (ii) of PWAs, with the parameters replaced with those assigned to the branch <italic>b</italic>3, and with &#x0394;<italic>L</italic><sup><sup><italic>A</italic></sup></sup> replaced with &#x220A;<italic>L.D</italic>12 Especially, under Dawg&#x2019;s model, we have:
<disp-formula id="eqn30"><alternatives><graphic xlink:href="023606_eqn30.gif"/></alternatives></disp-formula></p>
<p>As in case (ii) of PWAs, each next-fewest-indel history is composed of two indel events, andthere are two types of such histories. One is based on type (a) in case (ii):
<disp-formula id="eqn31"><alternatives><graphic xlink:href="023606_eqn31.gif"/></alternatives></disp-formula>
with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup>)1, <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup>) <italic>l</italic> &#x220A; 2, and also with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline103.gif"/></alternatives></inline-formula>. And the other is based on type (b) in case (ii):
<disp-formula id="eqn32"><alternatives><graphic xlink:href="023606_eqn32.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline104.gif"/></alternatives></inline-formula>, <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup> &#x220A;1, and also with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline105.gif"/></alternatives></inline-formula> again. Thus the summed contributions over the next-fewest-indel histories is given by:
<disp-formula id="eqn33"><alternatives><graphic xlink:href="023606_eqn33.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023606_inline106.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline107.gif"/></alternatives></inline-formula> are given by exactly the same equations as Eqs.(1.2.5b,d) and Eqs.(1.2.5c,e), respectively, with the parameters replaced by those assigned to branch <italic>b</italic>3, and with &#x0394;<italic>L</italic> replaced by &#x0394;<italic>L</italic>. Especially, under Dawg&#x2019;s model, the contributions by the individual next-fewest-indel histories are given by Eqs.(1.2.5d&#x2019;,e&#x2019;) with an appropriate replacement of the parameters and the ancestral state. Thus, panel A of <xref rid="fig3" ref-type="fig">Figure 3</xref> can also be interpreted exactly as the comparison between the fewest-indel history&#x2019;s contribution and the next-fewest-indel histories&#x2019; total contribution in the current case. Incidentally, root sequences with some additional ancestral sites in between the PASs of<inline-formula><alternatives><inline-graphic xlink:href="023606_inline108.gif"/></alternatives></inline-formula> are also consistent with &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>] in this case. However, such root sequence states require at least three indels each to give rise to &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>]. This is because the additional ancestral sites need to be deleted independently along <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>2</sub>, even if they are deleted simultaneously with the sites with the ancestries 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>12</sup> along <italic>b</italic>. Thus, in general, the indel histories consistent with such root states are expected to contribute much less to the multiplication factor.</p>
<p>Case (III) is represented by the external sequence states <italic>s</italic> = [<italic>L</italic>, 1,&#x2026;, [<italic>L</italic><sup><italic>D</italic>1</sup>, <italic>R</italic>] and <italic>s</italic><sub>2</sub> = <italic>s</italic><sub>3</sub> = [<italic>L</italic>, <italic>R</italic>]. In this case, the phylogenetic correctness condition does not require the root state to have any site in between the PASs. Thus we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline109.gif"/></alternatives></inline-formula>. As in case (II), we have <italic>N</italic><sub>min</sub> <italic>C</italic><sub>k</sub>; &#x03B1;[<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>s</italic><sub>3</sub>]; <italic>T</italic> = = 1. And the set of fewest-indel local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline110.gif"/></alternatives></inline-formula>, consists of a single element:
<disp-formula id="eqn34"><alternatives><graphic xlink:href="023606_eqn34.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline111.gif"/></alternatives></inline-formula>. Again, as in case (II), the contribution by this local history turns out to be exactly the same as Eq.(A1.1.1) (in Appendix A1.1) for case (iii) of PWAs, with the parameters replaced with those assigned to the branch <italic>b</italic>, and with &#x0394;<italic>L</italic><sup><italic>D</italic></sup> replaced with &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>. Especially, under Dawg&#x2019;s model, we have:
<disp-formula id="eqn35"><alternatives><graphic xlink:href="023606_eqn35.gif"/></alternatives></disp-formula></p>
<p>As in case (iii) of PWAs, each next-fewest-indel history is composed of two indel events. Unlike case (iii) of PWAs, however, there are three types of such histories; two of them are similar to those in case (iii), but the other one is totally new. Specifically, the first one is based on type (c) in case (iii):
<disp-formula id="eqn36"><alternatives><graphic xlink:href="023606_eqn36.gif"/></alternatives></disp-formula>
with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>)1, <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>) <italic>l</italic> &#x220A;1, and also with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline112.gif"/></alternatives></inline-formula>. The second one is based on type (d) in case (iii):
<disp-formula id="eqn37"><alternatives><graphic xlink:href="023606_eqn37.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline113.gif"/></alternatives></inline-formula>, <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x220A; 2, and also with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline114.gif"/></alternatives></inline-formula>again. The third one involves events along <italic>b</italic><sub>2</sub> and <italic>b</italic><sub>3</sub>, instead of along <italic>b</italic><sub>1</sub>:
<disp-formula id="eqn38"><alternatives><graphic xlink:href="023606_eqn38.gif"/></alternatives></disp-formula></p>
<p>It is consistent with the root state <italic>s</italic><sup><italic>Root</italic></sup> = <italic>s</italic><sub>1</sub> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>,<italic>R</italic>] instead of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline115.gif"/></alternatives></inline-formula>. It should be noted that there is only one local history of the third type. In this case, therefore, the summed contribution of the next-fewest-indel local histories is given by:
<disp-formula id="eqn39"><alternatives><graphic xlink:href="023606_eqn39.gif"/></alternatives></disp-formula></p>
<p>Here,<inline-formula><alternatives><inline-graphic xlink:href="023606_inline116.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline117.gif"/></alternatives></inline-formula> are the summed contributions of the type (c)-based and type (d)-based histories, respectively. They are given by exactly the same equations as Eqs.(A1.1.2b,d) and Eqs.(A1.1.2c,e), respectively, with the parameters replaced by those assigned to branch <italic>b</italic><sub>1</sub>, and with &#x0394;<italic>L</italic> replaced by &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>. Under Dawg&#x2019;s model, these two terms are given by summations of Eqs.(A1.1.2d&#x2019;,e&#x2019;) with an appropriate replacement of the parameters and the descendant states. Thus, panel A of <xref rid="fig3" ref-type="fig">Figure 3</xref> can also be interpreted as the comparison between the total contribution of these two types of next-fewest-indel histories and the fewest-indel history&#x2019;s contribution.</p>
<p>Meanwhile,<inline-formula><alternatives><inline-graphic xlink:href="023606_inline118.gif"/></alternatives></inline-formula> is the contribution from the unique next-fewest-indel history of the 3rd type, Eq.(1.3.11c). According to the definition, Eq.(1.1.2b) supplemented by Eqs.(1.2.4b,6b,8), it is expressed as:
<disp-formula id="eqn40"><alternatives><graphic xlink:href="023606_eqn40.gif"/></alternatives></disp-formula></p>
<p>Under Dawg&#x2019;s model, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline119.gif"/></alternatives></inline-formula> for <italic>m</italic> = 1,2,3, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline120.gif"/></alternatives></inline-formula>. Moreover, if we assume the uniform distribution of the root sequence length, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline121.gif"/></alternatives></inline-formula> Thus, Eq.(1.3.13) is reduced to:
<disp-formula id="eqn41"><alternatives><graphic xlink:href="023606_eqn41.gif"/></alternatives></disp-formula></p>
<p><xref rid="fig5" ref-type="fig">Figure 5</xref> shows the ratio of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline122.gif"/></alternatives></inline-formula> to the fewest-indel history&#x2019;s contribution, Eq.(1.3.10), when all three branches have the same length and are assigned the same indel model as that used for <xref rid="fig3" ref-type="fig">Figure 3</xref>. Because the ratio compares the multiplication factors concerning the indel events along different branches, its value actually depends on several factors. It would be convenient to keep in mind that the ratio could be approximated by <inline-formula><alternatives><inline-graphic xlink:href="023606_inline123.gif"/></alternatives></inline-formula> When (<italic>&#x03BB;</italic><sub><italic>I</italic>:<italic>m</italic></sub>&#x002B; <italic>&#x03BB; D</italic>:<italic>m</italic>)&#x0394;<italic>L</italic><sup><italic>D</italic></sup>(<italic>t</italic> <sub><italic>F</italic>:<italic>m</italic></sub><italic>t</italic><sub><italic>I</italic></sub>)&#x2019;s are sufficiently smaller than 1 for all <italic>m</italic> = 1, 2, 3. In general, as &#x0394;<italic>L</italic><sup><italic>D1</italic></sup> gets larger, the ratio is expected to decrease, because the relative frequencies of long indels (<italic>f</italic><sub><italic>I</italic>:<italic>m</italic></sub> (&#x0394;<italic>L</italic><sub><italic>D</italic>1</sub>) and (<italic>f</italic><sub><italic>D</italic>:<italic>m</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>)) are small in general. The ratio is expected to be much smaller than 1 in general. However, it may become quite large when the relative frequency of deletions compared to insertions (<italic>i.e</italic>., the ratio <italic>&#x03BB;</italic><sup><italic>D</italic>:<italic>m</italic></sup> <italic>&#x03BB;</italic><sub><italic>I</italic>:<italic>m</italic></sub>) is considerably larger than 1, or when the lengths of <italic>b</italic><sub>2</sub> and <italic>b</italic><sub>3</sub> are much larger than that of <italic>b</italic><sub>1</sub> (<italic>i.e.</italic>, <italic>t</italic><sub><italic>F</italic>:2</sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>, <italic>t</italic><sub><italic>F</italic>:3</sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub> &#x2013;s <italic>t</italic><sub><italic>F</italic>:1</sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>). Such situations are similar to those causing the &#x201C;Felsenstein zone&#x201D; regarding a substitution model, where a non-parsimonious substitution history at a site is most likely to occur along a tree (see, <italic>e.g</italic>., Chapter 9 of <xref ref-type="bibr" rid="c17">Felsenstein 2004</xref>). Under the conditions used to draw <xref rid="fig5" ref-type="fig">Figure 5</xref>, an indel history of the 3rd type has a probability much smaller than that of the fewest-indel history. The former is less than 5&#x0025; of the latter even when as much as 0.4 indels per site are expected to occur. This is probably because the history of the 3rd type requires an exquisite spatial coordination of deletions along different branches. And the result implies that the &#x201C;Felsenstein zone&#x201D; of indels should generally be quite narrow, consisting of the cases where a node is connected with branches with extremely unequal lengths.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Perturbation analysis on local MSA probabilities in case (III).</title>
<p>The graph shows the ratio of the probability of the history with two deletions giving rise to a case (III) local MSA (Eq.(1.3.13&#x2019;)) to that of the single-insertion history (Eq.(1.3.10)). The ratio is shown as a function of the length of the gapped segment (&#x0394;<italic>L</italic><sub><italic>D</italic>1</sub>) and the expected number of indels per site along each branch ((<italic>&#x03BB;</italic><sub><italic>I:m</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D:m</italic></sub>)(<italic>t</italic><sub><italic>F:m</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>), identical for all <italic>m</italic> = 1, 2, 3). The blue, magenta, cyan, purple, and green curves show the ratios when the values of (<italic>&#x03BB;</italic><sub><italic>I:m</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D:m</italic></sub>)(<italic>t</italic><sub><italic>F:m</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub>) are 0.01, 0.04, 0.1, 0.2 and 0.4 indels/site, respectively. We used a 3-OTU tree whose three branches are equally long. For each branch, we used the same parameters as those used for <xref rid="fig3" ref-type="fig">Figure 3</xref>.</p></caption>
<graphic xlink:href="023606_fig5.tif"/>
</fig>
<p>Case (IV) is represented by the external sequence states, <italic>s</italic><sub>1</sub> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup>, <italic>R</italic>], <italic>s</italic><sub>2</sub> = [<italic>L</italic>, 1,&#x2026;,, <italic>i</italic>, <italic>j</italic>,&#x2026;, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup>, <italic>R</italic>], and <italic>s</italic><sub>3</sub> = [<italic>L</italic>, <italic>R</italic>], with 1 &#x2264; <italic>i</italic> &#x002B; 1 &#x003C; <italic>j</italic> &#x2264; &#x0394;<italic>L</italic><sup><italic>DI</italic></sup> &#x002B; 1 but (<italic>i</italic>, <italic>j</italic>) &#x2260;(0, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup> &#x002B;1) (Here &#x201C;1,&#x2026;, 0&#x201D; and &#x201C; &#x0394;<italic>L</italic><sup><italic>DI</italic></sup> &#x002B;1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup>&#x201D; should be considered to be empty.)In this case, the phylogenetic correctness condition requires the root state to have sites with ancestries 1,&#x2026;, <italic>i</italic> and <italic>j</italic>,&#x2026;, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup>, on top of the PASs. Thus, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline124.gif"/></alternatives></inline-formula>. Here, the minimum number of indels is <inline-formula><alternatives><inline-graphic xlink:href="023606_inline125.gif"/></alternatives></inline-formula>. And the set of fewest indel local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline126.gif"/></alternatives></inline-formula> consists of <italic>two</italic> histories. One starts with the root state <inline-formula><alternatives><inline-graphic xlink:href="023606_inline127.gif"/></alternatives></inline-formula>, and is represented as:
<disp-formula id="eqn42"><alternatives><graphic xlink:href="023606_eqn42.gif"/></alternatives></disp-formula></p>
<p>The other starts with the root state <italic>S</italic><sup><italic>Root</italic></sup> = <italic>s</italic>1 =[<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>DI</italic></sup>, <italic>R</italic>] which differs from <inline-formula><alternatives><inline-graphic xlink:href="023606_inline128.gif"/></alternatives></inline-formula> It is represented as:
<disp-formula id="eqn43"><alternatives><graphic xlink:href="023606_eqn43.gif"/></alternatives></disp-formula></p>
<p>The portion of the multiplication factor contributed from these two fewest-indel local histories, and that contributed from the next-fewest-indel local histories, are calculated in Appendix A2. <xref ref-type="table" rid="tbl3">Table 3</xref> shows the ratio of the total contribution of the next-fewest-indel local histories to that of the fewest-indel local histories for typical configurations in this case. The table indicates that the fewest-indel local histories give a decent approximation of the local MSA probability, as long as the number of descendant sites and the expected number of indels per site are at most moderate.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>Perturbation analysis on local MSA probabilities in case (IV)</title></caption>
<graphic xlink:href="023606_tbl3.tif"/>
</table-wrap>
</sec>
</sec>
</sec>
<sec id="s3">
<label>2.</label><title>Goodness of approximation by past indel models</title>
<p>In part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), as well as in Section 1 of this series of paper, we established a theoretical formulation that can calculate the probabilities of given alignments (PWAs or MSAs) under a general continuous-time Markov model, which is a <italic>genuine</italic> evolutionary model describing the stochastic sequence evolution along the time axis via insertions and deletions. The Markov model we dealt with can accommodate quite biologically realistic settings, such as overlapping indels, power-law indel length distributions, and indel rate variation across regions. As shown in Subsection 3.1.1 of part I, the probabilities calculated via our theoretical formulation also fulfill, up to a desired order of the perturbation expansion, the Chapman-Kolmogorov (CK) equation, which is a crucial consistency condition for a <italic>genuine</italic> evolutionary model. To the best of our knowledge, the CK equation has never been satisfied by any previous probabilistic theories allowing for indels of multiple residues. Moreover, the results in Section 5 of part I indicated that even the lowest-order approximation based on the fewest-indel histories alone can approximate the probabilities of the local gap configurations of the alignments considerably well, as long as the indel lengths and the branch lengths are at most moderate. Given these ideal properties, the <italic>ab initio</italic> perturbation theory that we formulated in this series of study can be used as a sound &#x201C;reference point.&#x201D; More precisely, other probabilistic models can be compared to it in order to examine how well they can approximate the biologically realistic probabilities of the alignments, and the conditions under which they can. In this section we will examine the &#x201C;goodness of approximation&#x201D; by some representative models of indels in the light of our <italic>ab initio</italic> formulation.</p>
<sec id="s3a">
<label>2.1</label><title>Geometric indel length distributions</title>
<p>As mentioned in Introduction, a majority of indel probabilistic models that have been used thus far are based on HMMs or transducer theories that calculates the indel component of the probability of an alignment as a product of column-to-column transition probabilities. Such models can only accommodate geometric indel length distributions, or at most linear combinations of two or more geometric distributions. However, empirical analyses revealed that the lengths of inserted/deleted sequences are distributed according to power-laws <italic>e.g</italic>., <xref ref-type="bibr" rid="c19">Gonnet et al. 1992</xref>; <xref ref-type="bibr" rid="c1">Benner et al. 1993</xref>; <xref ref-type="bibr" rid="c21">Gu and Li 1995</xref>; <xref ref-type="bibr" rid="c22">Kent et al. 2003</xref>; <xref ref-type="bibr" rid="c41">Zhang and Gerstein 2003</xref>; <xref ref-type="bibr" rid="c8">Chang and Benner 2004</xref>; The international Chimpanzee Chromosome 22 Consortium 2004; <xref ref-type="bibr" rid="c39">Yamane et al. 2006</xref>; <xref ref-type="bibr" rid="c15">Fan et al. 2007</xref>). Therefore, a question naturally arises as to up to what length a geometric distribution can decently approximate a biologically realistic power-law distribution. Here we address this question. As a reference distribution, we used a power-law distribution:
<disp-formula id="eqn44"><alternatives><graphic xlink:href="023606_eqn44.gif"/></alternatives></disp-formula>
with an empirically typical exponent of <italic>a</italic> = 1.6 (panel A of <xref rid="fig6" ref-type="fig">Figure 6</xref>). Then we fitted a scaled geometric distribution:
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Power-law indel length distribution and its approximation by geometric distributions.</title>
<p><bold>A.</bold> Visual comparison of the distributions. The continuous line is the power-law distribution, Eq.(2.1.1) with <italic>a</italic> = 1.6. The dashed line is the scaled geometric distribution that fits the power-law the best according to the least-square criterion (<italic>i.e</italic>., Eq.(2.1.2) with <italic>A</italic> = <italic>A</italic><sub><italic>LS</italic></sub> (1.6) &#x2261; 0.7125 and <italic>q</italic> = <italic>q</italic><sub><italic>LS</italic></sub> (1.6) &#x2261; 0.3957). The dotted line is the scaled geometric distribution that well approximates the behavior of the power-law around 100 residues (<italic>i.e.</italic>, Eq.(2.1.2) with <italic>A</italic> = 0.09538 and <italic>q</italic> = 0.9822). Note the logarithmic scale for the ordinate. <bold>B.</bold> The ratio of the best-fit scaled geometric distribution (SG) to the power-law distribution (PL).</p></caption>
<graphic xlink:href="023606_fig6.tif"/>
</fig>
<disp-formula id="eqn45"><alternatives><graphic xlink:href="023606_eqn45.gif"/></alternatives></disp-formula>
to the reference, Eq.(2.1.1), via a least-square fitting across the lengths <italic>l</italic> = 1, 2,&#x2026;, 100.</p>
<p>We found that the best-fitting parameters are <italic>A</italic> = <italic>A</italic><sub><italic>LS</italic></sub> (1.6) &#x2261; 0.7125 and <italic>q</italic> = <italic>q</italic><sub><italic>LS</italic></sub> (1.6) &#x2261; 0.3957. (The distribution is drawn in the dashed line in panel A.) Then, we calculated the ratios:
<disp-formula id="eqn46"><alternatives><graphic xlink:href="023606_eqn46.gif"/></alternatives></disp-formula>
for <italic>l</italic> = 1, 2,&#x2026;, 25 (panel B of <xref rid="fig6" ref-type="fig">Figure 6</xref>). As shown in the figure, <italic>R</italic><sub><italic>LS</italic></sub> (<italic>l</italic>; 1.6) is less than 1/3 at <italic>l</italic> = 5, less than 1/10 at <italic>l</italic> = 7, and less than 1/1000 at <italic>l</italic> = 13. This indicates that the probabilistic model of indels based on the geometric distribution is somewhat reliable for indels that are at most 4 bases long, which account for 70.5&#x0025; of all indels if we assume this power-law distribution for all indel lengths. In other words, the geometric distribution substantially underestimates the probabilities of 30&#x0025; of indels that actually occurred. Although a larger value of <italic>q</italic> could prevent a rapid damping of the estimated frequency, this then causes the mis-estimation of relative frequencies among commonly occurring indels with, <italic>e.g</italic>., <italic>l</italic> = 1, 2, 3 (the dotted line in panel A of <xref rid="fig6" ref-type="fig">Figure 6</xref>). Hence, this simple analysis clearly demonstrates how important it is to incorporate biologically realistic indel length distributions into the evolutionary model.</p>
</sec>
<sec id="s3b">
<label>2.2</label><title>Models pursuing biological realism</title>
<p>Some existing probabilistic models of indels, such as the &#x201C;long indel&#x201D; model (<xref ref-type="bibr" rid="c31">Mikl&#x00F3;s et al. 2004</xref>) and the model of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, aim to pursue more biological realism by accommodating indel length distributions that are biologically more realistic than geometric distributions. As noted in Subsection 5.1 of part I (and proved in Appendix A6 of part I), as far as each LHS equivalence class is concerned, the probability given by the recipe of <xref ref-type="bibr" rid="c31">Mikl&#x00F3;s et al. (2004)</xref> equals the probability calculated by our formulation under the space-and time-homogeneous model parameters (given in Eqs.(2.4.5a,b) of part I). Thus, regarding the probability of a PWA, the two methods should give the identical sum of contributions from the fewest-indel histories. And, <italic>provided that</italic> both methods can correctly enumerate all possible local histories of any given number of indels consistent with each local gap configuration, they will also give the identical sum of contributions from the histories with up to a desired number of indels. Fulfilling this last condition, however, will be an important task left for future studies. (At present, we cannot tell whether or not the algorithm of <xref ref-type="bibr" rid="c31">Mikl&#x00F3;s et al. (2004)</xref> can correctly enumerate indel histories, because their paper has no explicit description on this topic. So, we will not discuss their method further in this section.)</p>
<p>Here, we specifically examine the model of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> in the light of our theoretical formulation. Their model is a block-wise HMM, and calculates the probability of a PWA between the ancestral and descendant sequences along a branch as a product of block-wise probabilities. In their HMM, a block is either a column of a PAS, a run of gaps in the ancestor aligned with a run of residues in the descendant, or a run of gaps in the descendant aligned with a run of residues in the ancestor. Each PWA is actually a part of a MSA of given sequences at the external nodes and one of alternative sets of sequences at internal nodes. Ancestral gaps aligned with descendant gaps are removed before evaluating the probability of a PWA. Because their purpose is to find a most likely indel history and a resulting set of consistent ancestral sequence states at internal nodes, they are not interested in an indel event that begins and/or ends in the middle of a block. Thus, they only consider those events that insert/delete the entire blocks in single steps.</p>
<p>We now calculate the probabilities of the local PWAs that were considered in the cases (i)-(iv) in Subsection 1.2, via the model of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>. And we compare the results to those via our theoretical formulation under Dawg&#x2019;s parameters (Eqs.(2.4.4a,b) of part I). In the following, the probabilities via <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> will be calculated according to Eq.(2) and <xref rid="fig1" ref-type="fig">Figure 1C</xref> of their paper, and the probabilities via our formulation will be calculated according to the prescriptions in Subsection 1.2 (and in Appendix A1). We set <italic>t</italic><sub><italic>F</italic></sub> &#x2013; <italic>t</italic><sub><italic>I</italic></sub> = &#x007C; <italic>b</italic> &#x007C; in the following calculations. (Here &#x007C; <italic>b</italic> &#x007C; denotes the length of branch <italic>b</italic>). Via the model of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, the PWA probability in case (i) is calculated as:
<disp-formula id="eqn47"><alternatives><graphic xlink:href="023606_eqn47.gif"/></alternatives></disp-formula></p>
<p>Where <italic>p</italic><sub><italic>I</italic></sub> and <italic>p</italic><sub><italic>D</italic></sub> are the &#x201C;transition probabilities of the &#x2018;Insertion&#x2019; and &#x2018;Begin deletion&#x2019; states,&#x201D; respectively. Via our formulation, the PWA probability is:
<disp-formula id="eqn48"><alternatives><graphic xlink:href="023606_eqn48.gif"/></alternatives></disp-formula></p>
<p>Here, &#x0394;<sup><italic>Dawg</italic></sup> is the abbreviation of the &#x201C;universal&#x201D; factor for the indel exit rate (<italic>i.e</italic>., &#x0394;<sup><italic>Dawg</italic></sup>[<italic>&#x03BB;</italic><sub><italic>I</italic></sub><italic>, &#x03BB;</italic><sub><italic>D</italic></sub>, <italic>f</italic><sub><italic>D</italic></sub> (.)] in Eq.(2.4.4c) of part I). And <inline-formula><alternatives><inline-graphic xlink:href="023606_inline129.gif"/></alternatives></inline-formula> is short for <inline-formula><alternatives><inline-graphic xlink:href="023606_inline130.gif"/></alternatives></inline-formula>, <italic>i.e.,</italic> the summed contribution from the <italic>n</italic> -event local histories to the multiplication factor in case (i). Especially,<inline-formula><alternatives><inline-graphic xlink:href="023606_inline131.gif"/></alternatives></inline-formula>[<italic>case</italic>(<italic>i</italic>)] is concretely expressed in Eq.(1.2.2a). Now, assuming that (<italic>&#x03BB;</italic><sub><italic>i</italic></sub>&#x002B;<italic>&#x03BB;</italic> <sub><italic>D</italic></sub>)&#x007C; <italic>b</italic> &#x007C; is sufficiently small, we expand the expression in the square brackets into the power series in <italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x007C; <italic>b</italic> &#x007C; and <italic>&#x03BB;</italic><sub><italic>D</italic></sub> &#x007C; <italic>b</italic> &#x007C;, which will collectively be denoted as <italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C; when considering the order of magnitude. From Eqs.(1.2.2a,b&#x2019;), we get <inline-formula><alternatives><inline-graphic xlink:href="023606_inline132.gif"/></alternatives></inline-formula> Moreover, the expansion of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline133.gif"/></alternatives></inline-formula> generally starts with <italic>O</italic> (<italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;)<sup><italic>n</italic></sup> terms. Thus, we have:
<disp-formula id="eqn49"><alternatives><graphic xlink:href="023606_eqn49.gif"/></alternatives></disp-formula></p>
<p>This and Eq.(2.2.1) will provide the baseline when examining the probabilities in Kim and Sinha&#x2019;s model in other cases.</p>
<p>In case (ii), the PWA probability under the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> is calculated as:
<disp-formula id="eqn50"><alternatives><graphic xlink:href="023606_eqn50.gif"/></alternatives></disp-formula></p>
<p>Here Pr<sub><italic>D</italic></sub> (<italic>l</italic>) is the &#x201C;probability distribution on the deletion length (<italic>l</italic>),&#x201D; which is assumed as shared among different branches. To facilitate the comparison, we consider the ratio of the probability in case (ii) to that in case (i), which yields:
<disp-formula id="eqn51"><alternatives><graphic xlink:href="023606_eqn51.gif"/></alternatives></disp-formula></p>
<p>Meanwhile, the probability via our formulation is:
<disp-formula id="eqn52"><alternatives><graphic xlink:href="023606_eqn52.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline134.gif"/></alternatives></inline-formula> is given by Eq.(1.2.4&#x2019;), and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline135.gif"/></alternatives></inline-formula> is given by Eq.(1.2.5a) supplemented with Eqs.(1.2.5b,c,d&#x2019;e&#x2019;). The ratio of Eq.(2.2.5) to Eq.(2.2.2) is:
<disp-formula id="eqn53"><alternatives><graphic xlink:href="023606_eqn53.gif"/></alternatives></disp-formula></p>
<p>Expanding this expression into the power series in <italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;, we have:
<disp-formula id="eqn54"><alternatives><graphic xlink:href="023606_eqn54.gif"/></alternatives></disp-formula></p>
<p>Here <italic>G</italic> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) is defined as:
<disp-formula id="eqn55"><alternatives><graphic xlink:href="023606_eqn55.gif"/></alternatives></disp-formula></p>
<p><xref rid="fig7" ref-type="fig">Figure 7</xref> shows the ratio <italic>G</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>)/<italic>f</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) as a function of &#x0394;<italic>L</italic><sup><italic>A</italic></sup>.</p>
<p>Similarly, according the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, the ratio of the PWA probability in case (iii) to that in case (i) is expressed as:
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Coefficient of 2nd-order term of PWA probability in cases (ii) and (iii).</title>
<p>The curve shows the ratio <italic>G</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>)/<italic>f</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) as a function of the number of sites in between the PASs (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) in a local PWA belonging to case (ii). Here <italic>G</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) is the coefficient of the 2nd-order term in the expected number of indels (<italic>&#x03BB;</italic> &#x007C;<italic>b</italic>&#x007C;) given in Eq.(2.2.6&#x2019;b) in Results. And <italic>f</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) is the coefficient of the 1st-order term (see Eq.(2.2.6&#x2019;a)). The ratio was calculated with the following parameters: <italic>&#x03BB;</italic><sub><italic>I</italic></sub> = <italic>&#x03BB;</italic><sub><italic>D</italic></sub> = 0.1, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline136.gif"/></alternatives></inline-formula>. Under the same parameter setting, this graph also gives the ratio for a case (iii) local PWA as a function of &#x0394;<italic>L</italic><sup><italic>D</italic></sup> (<italic>G</italic><sub>1</sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>)/<italic>f</italic><sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>). See Eqs.(2.2.8a,b)). The value, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline137.gif"/></alternatives></inline-formula>, gives a rough estimate of the &#x201C;threshold&#x201D; value of (<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)&#x007C;<italic>b</italic>&#x007C; beyond which the violation of the Chapman-Kolmogorov equation (Eq.(3.1.1.1) in part I) may severely undermine the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>.</p></caption>
<graphic xlink:href="023606_fig7.tif"/>
</fig>
<disp-formula id="eqn56"><alternatives><graphic xlink:href="023606_eqn56.gif"/></alternatives></disp-formula></p>
<p>Here Pr<sub><italic>I</italic></sub> (<italic>l</italic>) is the &#x201C;probability distribution on the insertion length (<italic>l</italic>),&#x201D; which also is assumed as shared among different branches. The ratio via our formulation is obtained by the power-series expansion in <italic>&#x03BB;</italic> &#x007C;<italic>b</italic>&#x007C; of Eq.(A1.1.1&#x2019;) and Eq.(A1.1.2a) supplemented with Eqs.(A1.1.2b,c,d&#x2019;,e&#x2019;) (all in Appendix). The result is:
<disp-formula id="eqn57"><alternatives><graphic xlink:href="023606_eqn57.gif"/></alternatives></disp-formula></p>
<p>Here <italic>G</italic> (&#x0394;<italic>L</italic><sup><italic>DI</italic></sup>) is defined as:
<disp-formula id="eqn58"><alternatives><graphic xlink:href="023606_eqn58.gif"/></alternatives></disp-formula></p>
<p>Thanks to the symmetry of the probabilities under the time reversal, <xref rid="fig7" ref-type="fig">Figure 7</xref> also gives the ratio <italic>G</italic><sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>)/<italic>f</italic><sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) as a function of &#x0394;<italic>L</italic><sup><italic>D</italic></sup>, when calculated under same setting.</p>
<p>Now we compare the results, Eq.(2.2.4) and Eq.(2.2.7), under Kim and Sinha&#x2019;s model with the corresponding results, Eq.(2.2.6&#x2019;a) and Eq.(2.2.8a), obtained via our formulation. In the method of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, the substitutions <italic>p</italic><sub><italic>I</italic></sub> = <italic>c</italic><sub><italic>I</italic></sub> &#x007C;<italic>b</italic>&#x007C; and <italic>p</italic><sub><italic>D</italic></sub> = <italic>c</italic><sub><italic>D</italic></sub> &#x007C;<italic>b</italic>&#x007C; are made first. Then <italic>c</italic><sub><italic>I</italic></sub> and <italic>c</italic><sub><italic>D</italic></sub> are estimated from the total frequencies of insertions and deletions, respectively, along the external branches observed from the input MSA. Similarly, Pr<sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) and Pr<sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) are estimated from the observed length histograms for insertions and deletions, respectively. Let {<italic>b</italic>}<sub><italic>PE</italic></sub> be the set of branches used for parameter estimations. Then, using the summations of the &#x201C;reference&#x201D; results, Eq.(2.2.6&#x2019;a) and Eq.(2.2.8a), both over {<italic>b</italic>}<sub><italic>PE</italic></sub>, we expect to have:
<disp-formula id="eqn59"><alternatives><graphic xlink:href="023606_eqn59.gif"/></alternatives></disp-formula>
<disp-formula id="eqn60"><alternatives><graphic xlink:href="023606_eqn60.gif"/></alternatives></disp-formula>
<disp-formula id="eqn61"><alternatives><graphic xlink:href="023606_eqn61.gif"/></alternatives></disp-formula>
<disp-formula id="eqn62"><alternatives><graphic xlink:href="023606_eqn62.gif"/></alternatives></disp-formula></p>
<p>Here <italic>E</italic> [<italic>X</italic>] denotes the expected value of the estimated parameter <italic>X</italic>, which is the average of estimated <italic>X</italic> over all indel processes under the given set of conditions (the tree and model parameters). And we also used the notation, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline138.gif"/></alternatives></inline-formula> [NOTE: The actual values of <italic>c</italic><sub><italic>I</italic></sub> and <italic>c</italic><sub><italic>D</italic></sub> estimated by the method of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> may be slightly smaller than Eqs.(2.2.9b,c), because the denominator in their method is the total number of MSA columns, instead of the average numbers of possible indel positions in ancestral sequences.] Usually, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline139.gif"/></alternatives></inline-formula>is quite small, at most <italic>O</italic> (10<sup>&#x2212;1</sup>) and typically <italic>O</italic> (10<sup>&#x2212;2</sup>). Thus, as long as the actual parameters, <italic>&#x03BB;</italic><sub><italic>I</italic></sub>, <italic>&#x03BB;</italic><sub><italic>D</italic></sub>, <italic>f</italic><sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>), and <italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>), do not considerably vary across branches, and provided that the MSA is sufficiently long and accurate, the estimated values of <italic>c</italic><sub><italic>I</italic></sub> and <italic>c</italic><sub><italic>D</italic></sub>, respectively, should approximate <italic>&#x03BB;</italic><sub><italic>I</italic></sub> and <italic>&#x03BB;</italic><sub><italic>D</italic></sub> fairly well. Also, under the same situation, the estimated values of Pr<sub><italic>I</italic></sub>(<italic>l</italic>) and Pr<sub><italic>D</italic></sub>(<italic>l</italic>), respectively, should approximate <italic>f</italic><sub><italic>I</italic></sub>(<italic>l</italic>) and <italic>f</italic><sub><italic>D</italic></sub> (<italic>l</italic>) fairly well, as long as the ratios <italic>G</italic><sub><italic>I</italic></sub>(<italic>l</italic>)/<italic>f</italic><sub><italic>I</italic></sub>(<italic>l</italic>) and <italic>G</italic><sub><italic>D</italic></sub>(<italic>l</italic>)/<italic>f</italic><sub><italic>D</italic></sub> (<italic>l</italic>) are sufficiently less than <inline-formula><alternatives><inline-graphic xlink:href="023606_inline140.gif"/></alternatives></inline-formula>. However, it does not actually matter so much whether or not the estimated Kim-Sinha parameters (<italic>c</italic><sub><italic>I</italic></sub>, <italic>c</italic><sub><italic>D</italic></sub>, Pr<sub><italic>I</italic></sub>(<italic>l</italic>) and Pr<sub><italic>D</italic></sub>(<italic>l</italic>)) approximate Dawg&#x2019;s indel parameters (<italic>&#x03BB;</italic><sub><italic>I</italic></sub>, <italic>&#x03BB;</italic><sub><italic>D</italic></sub>, <italic>f</italic><sub><italic>I</italic></sub>(<italic>l</italic>) and <italic>f</italic><sub><italic>D</italic></sub> (<italic>l</italic>)) fairly well. What actually matters is how accurately Eq.(2.2.4) and Eq.(2.2.7) approximate Eq.(2.2.6&#x2019;a) and Eq.(2.2.8a), respectively, using the estimated parameters. In an extreme case where all branches have the same branch length, the approximation should be nearly perfect. This is because, in this case, &#x007C;<italic>b</italic>&#x007C; &#x2248; &#x27E8;&#x007C; <italic>b</italic> &#x007C;&#x27E9; <sub>&#x007C;<italic>b</italic>&#x007C;</sub> for all branches, and thus because we can use Eqs.(2.2.9a-d) without any significant modifications to estimate the probabilities (not involving case (iv)). [It should be noted here that Eq.(2.2.4) and Eq.(2.2.7), respectively, contain extra multiplication factors, (1&#x2212; <italic>p</italic><sub><italic>I</italic></sub>) and (1&#x2212; <italic>p</italic><sub><italic>I</italic></sub>)<sup>&#x2212;1</sup>, compared to the corresponding Eq.(2.2.6&#x2019;a) and Eq.(2.2.8a). However, these factors should remain close to 1, because <italic>p</italic><sub><italic>I</italic></sub> = <italic>c</italic><sub><italic>I</italic></sub> &#x007C; <italic>b</italic> &#x007C; should normally be at most <italic>O</italic> (10<sup>&#x2212;1</sup>).] In contrast, the approximations by Eq.(2.2.4) and Eq.(2.2.7) could considerably deteriorate, <italic>e.g</italic>., when (&#x007C;<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)(&#x007C; <italic>b</italic> &#x007C; &#x2212; &#x2329;&#x007C; <italic>b</italic> &#x007C;&#x232A; <sub>&#x007C;<italic>b</italic>&#x007C;</sub>&#x007C;) times the ratios, <italic>G</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>)/<italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) and <italic>G</italic><sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>)/ <italic>f</italic><sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>), respectively, become comparable to or greater than 1 (unity). Because <italic>G</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) and <italic>G</italic><sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) are mostly contributed from next-fewest-indel local histories containing overlapping indels, we can interpret the result as follows. &#x201C;Overlapping indels start to make Kim and Sinha&#x2019;s method poorly approximate the alignment probabilities when the involved gap is long and the branch lengths show a large variation.&#x201D; If there is a good reason to believe that the Dawg indel parameters (<italic>&#x03BB;</italic><sub><italic>I</italic></sub>, <italic>&#x03BB;</italic><sub><italic>D</italic></sub>, <italic>f</italic><sub><italic>I</italic></sub> (<italic>l</italic>) and <italic>f</italic><sub><italic>D</italic></sub> (<italic>l</italic>)) are shared among all branches, one way to mitigate the aforementioned effects of overlapping indels may be to set:
<disp-formula id="eqn63"><alternatives><graphic xlink:href="023606_eqn63.gif"/></alternatives></disp-formula>
<disp-formula id="eqn64"><alternatives><graphic xlink:href="023606_eqn64.gif"/></alternatives></disp-formula>
and to fit <italic>&#x03BB;</italic><sub><italic>I</italic></sub>, <italic>&#x03BB;</italic><sub><italic>D</italic></sub>, <italic>f</italic><sub><italic>I</italic></sub>(<italic>l</italic>) and <italic>f</italic><sub><italic>D</italic></sub>(<italic>l</italic>) according to these equations supplemented with Eqs.(2.2.6&#x2019;b,8b). Now, as indicated by <xref rid="fig7" ref-type="fig">Figure 7</xref>, under the power-law indel length distributions, the ratios <italic>G</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>)/<italic>f</italic><sub><italic>D</italic></sub>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) and <italic>G</italic><sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>)/<italic>f</italic><sub><italic>I</italic></sub>(&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) are less than 4 in absolute value when the gap is 300 residues long or shorter. Therefore, the 2nd-order factors should remain close substantially influence the results when <inline-formula><alternatives><inline-graphic xlink:href="023606_inline141.gif"/></alternatives></inline-formula>is larger than, say, 0.1. Such a situation will be quite rare in practical sequence analyses. Even if we encounter such a rare case, then local histories with more than 2 indels will begin to account for a substantial fraction of the probability. Considering this way, we expect that the method of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> will pretty well approximate the probabilities of local PWAs belonging to cases (ii) and (iii) at least within the threshold <inline-formula><alternatives><inline-graphic xlink:href="023606_inline142.gif"/></alternatives></inline-formula> defined in Subsection 1.2.</p>
<p>Finally, we consider case (iv). Indel histories giving rise to the local sequence states in this category are shown, <italic>e.g</italic>., in <xref rid="fig5" ref-type="fig">Figure 5</xref>, panels F and G of <xref rid="fig3" ref-type="fig">Figure 3</xref>, and panel A of <xref rid="fig6" ref-type="fig">Figure 6</xref> (all of them are in part I). In such a situation, an aligner will reconstruct a MSA that is like either panel B or C of <xref rid="fig5" ref-type="fig">Figure 5</xref> of part I (if the reconstruction is correct), and Kim-Sinha&#x2019;s method assigns a probability according to the reconstructed MSA. Whether it is like panel B or panel C, the assigned probability is the same, and its ratio to the probability of case (i) is:
<disp-formula id="eqn65"><alternatives><graphic xlink:href="023606_eqn65.gif"/></alternatives></disp-formula></p>
<p>Via our formulation, how to calculate the probability in this case was briefly described in the middle of Subsection 1.2, and detailed in Appendix A1.2. In this case, each fewest-indel history consists of two indels, and each next-fewest-indel history consists of three indels. Because there are as many as 24 types of next-fewest-indel histories, here we only consider the fewest-indel histories. Then, the lowest-order contribution of the multiplication factor, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline143.gif"/></alternatives></inline-formula>, is given by Eq.(A1.2.1a), supplemented with Eqs.(A1.2.1b,c,d,e&#x2019;,f&#x2019;,g&#x2019;). Expanding each term into a power series in <italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;, we get the following expression for the ratio:
<disp-formula id="eqn66"><alternatives><graphic xlink:href="023606_eqn66.gif"/></alternatives></disp-formula></p>
<p>In case (iv), as opposed to in cases (ii) and (iii), the PWA probabilities via the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> differ considerably from that via our formulation <italic>even when</italic> &#x27E8;&#x007C; <italic>b</italic> &#x007C;&#x27E9; <sub>&#x007C;<italic>b</italic>&#x007C;</sub> &#x226A; 1 and &#x007C; <italic>b</italic> &#x007C; &#x226A; 1. Under these conditions, <italic>p</italic><sub><italic>I</italic></sub> Pr<sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) and <italic>p</italic><sub><italic>D</italic></sub> Pr<sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) quite accurately approximate <italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x007C; <italic>b</italic> &#x007C; <italic>f</italic><sub><italic>I</italic></sub> (&#x0394;<italic>L</italic><sup><italic>D</italic></sup>) and <italic>&#x03BB;</italic><sub><italic>D</italic></sub> &#x007C; <italic>b</italic> &#x007C; <italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>), respectively (see Eqs.(1.2.9c,d)), and the <italic>O</italic> ((<italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;)<sup>3</sup>) terms in Eq.(2.2.12) can be neglected. Thus, we have:
<disp-formula id="eqn67"><alternatives><graphic xlink:href="023606_eqn67.gif"/></alternatives></disp-formula></p>
<p><xref ref-type="table" rid="tbl4">Table 4</xref> shows this ratio for typical cases. The second term on the right hand side of Eq.(2.2.13) is the effect of overlapping indels. When &#x0394;<italic>L</italic><sup><italic>A</italic></sup> = &#x0394;<italic>L</italic><sup><italic>D</italic></sup> = 1, this term is expected to be quite small; for example, it is about 0.167 if <italic>f</italic><sub><italic>I</italic></sub>(<italic>l</italic>) = <italic>f</italic><sub><italic>D</italic></sub>(<italic>l</italic>) &#x221E; <italic>l</italic><sup>&#x2212;1.6</sup>. And it gets more and more influential when &#x0394;<italic>L</italic><sup><italic>A</italic></sup> and/or &#x0394;<italic>L</italic><sup><italic>D</italic></sup> gets larger, and it substantially exceeds 1 (unity) in some cases (<xref ref-type="table" rid="tbl4">Table 4</xref>). Actually, a similar effect was incorporated in the HMM of <xref ref-type="bibr" rid="c24">Knudsen and Miyamoto (2003)</xref>. Their HMM could only accommodate geometric indel length distributions, and consequently the relevant term was independent of &#x0394;<italic>L</italic><sup><italic>A</italic></sup> and &#x0394;<italic>L</italic><sup><italic>D</italic></sup>. Coming back to Eq.(2.2.13), the first term on the right hand side, 3/2, differs from 1 (unity) because the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> does not correctly take account of the non-overlapping indel histories, either. This error is actually shared by most of the standard, or nearly standard, HMMs and transducers used thus far as probabilistic models of indels (see Background of part I). Taking these results into consideration, another possible improvement on the model of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> would be to modify the HMM structure so that the probability of an insertion and an immediately adjacent deletion (or that of the opposite configuration) will be given by Eq.(2.2.12), or by its extension to include the terms of higher-orders in <italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4.</label>
<caption><title>Comparison of Kim-Sinha&#x2019;s probabilities of case (iv) local PWAs with reference probabilities</title></caption>
<graphic xlink:href="023606_tbl4.tif"/>
</table-wrap>
</sec>
<sec id="s3c">
<label>2.3</label><title>Violation of Chapman-Kolmogorov equation</title>
<p>The Chapman-Kolmogorov (CK) equation (Eq.(3.1.1.1) in part I),
<disp-formula id="ueqn3"><alternatives><graphic xlink:href="023606_ueqn3.gif"/></alternatives></disp-formula>
is a crucial condition that must be satisfied by <italic>genuine</italic> evolutionary models based on any continuous-time Markov models. Thus far, the CK equation was violated by most HMMs and transducer theories, except those directly derived from evolutionary models, <italic>e.g</italic>., the TKF91 model (<xref ref-type="bibr" rid="c37">Thorne et al. 1991</xref>). As formally shown in Appendix A3 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), our theoretical formulation could satisfy the CK equation up to any desired order of the perturbation expansion. Therefore, our formulation enables us to analytically examine the effects of the violation of the CK equation. Here, we will only consider a simplest yet non-trivial example, <italic>i.e</italic>., case (ii) in Subsection 1.2. And we will examine the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref> because of its generality; most HMMs could be obtained from their HMM by slightly modifying the parameters and by fixing the indel length distributions to geometric ones, possibly with time-dependent gap-extension probabilities.</p>
<p>Via the HMM of <xref ref-type="bibr" rid="c23">Kim and Sinha (2007)</xref>, the PWA probability in case (ii) was given by Eq.(VII-2.3), with the substitutions <italic>p</italic><sub><italic>I</italic></sub> = <italic>c</italic><sub><italic>I</italic></sub> &#x007C; <italic>b</italic> &#x007C; and <italic>p</italic><sub><italic>D</italic></sub> = <italic>c</italic><sub><italic>D</italic></sub> &#x007C; <italic>b</italic> &#x007C;:
<disp-formula id="eqn68"><alternatives><graphic xlink:href="023606_eqn68.gif"/></alternatives></disp-formula></p>
<p>In contrast, the probability in the same case via our formulation was given by Eq.(2.2.5), which can be partially expanded into the power-series in <italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C; as:
<disp-formula id="eqn69"><alternatives><graphic xlink:href="023606_eqn69.gif"/></alternatives></disp-formula></p>
<p>Here <italic>G</italic><sup><italic>D</italic></sup> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) was given in Eq.(2.2.6&#x2019;b). And exp{-&#x0394;<sup><italic>Dawg</italic></sup> &#x007C; <italic>b</italic> &#x007C;} is a &#x201C;universal factor&#x201D; that occur in the probability of any indel processes on the entire sequence (along branch <italic>b</italic>). Eq.(2.3.2) satisfies the CK equation up to (and including) <italic>O</italic> ((<italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;)<sup>2</sup>). Now, compare Eq.(2.3.1) with Eq.(2.3.2), aside from the universal factor. First, if we set <italic>c</italic><sup><italic>I</italic></sup> = <italic>&#x03BB;</italic><sup><italic>I</italic></sup> and <italic>c</italic><sup><italic>D</italic></sup> = <italic>&#x03BB;</italic><sup><italic>D</italic></sup>, (1&#x2212; <italic>c</italic><sup><italic>I</italic></sup> &#x007C; <italic>b</italic> &#x007C;)<sup>2</sup> (1 &#x2212; <italic>c</italic><sup><italic>D</italic></sup> &#x007C; <italic>b</italic> &#x007C;)<sup>2</sup> should approximate exp{&#x2212;2(<italic>&#x03BB;</italic><sub><italic>I</italic></sub> &#x002B; <italic>&#x03BB;</italic><sub><italic>D</italic></sub>)&#x007C; <italic>b</italic> &#x007C;} quite well, because <italic>&#x03BB;</italic><sup><italic>I</italic></sup> &#x007C; <italic>b</italic> &#x007C; and <italic>&#x03BB;</italic><sub><italic>D</italic></sub> &#x007C; <italic>b</italic> &#x007C; should usually be at most <italic>O</italic>(10<sup>&#x2212;1</sup>). Thus, it is sufficient to compare (1&#x2212; <italic>c</italic><sup><italic>I</italic></sup>&#x007C; <italic>b</italic> &#x007C;)<italic>c</italic><sub><italic>D</italic></sub> &#x007C; <italic>b</italic> &#x007C; Pr<sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) with the expression in the square brackets on the right hand side of Eq.(2.3.2). If Pr<sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) is considered as independent of &#x007C; <italic>b</italic> &#x007C;, it should be equal to <italic>f</italic><sup><italic>D</italic></sup> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>). Then, whether or not Eq.(2.3.1) approximately satisfies the CK equation depends on whether or not the absolute value of the difference, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline144.gif"/></alternatives></inline-formula> is negligible compared to <italic>&#x03BB;</italic><sup><italic>D</italic></sup> &#x007C; <italic>b</italic> &#x007C; <italic>f</italic><sup><italic>D</italic></sup> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>). As <xref rid="fig7" ref-type="fig">Figure 7</xref> indicates, this condition will hold if &#x0394;<italic>L</italic><sup><italic>A</italic></sup> is within a &#x201C;critical value,&#x201D; which decreases as (<italic>&#x03BB;</italic><sup><italic>I</italic></sup> &#x002B; <italic>&#x03BB;</italic><sup><italic>D</italic></sup>)&#x007C; <italic>b</italic> &#x007C; increases. Once &#x0394;<italic>L</italic><sup><italic>A</italic></sup> exceeds the critical value, the violation of the CK equation will considerably impact on the probability estimation, and therefore on the data analyses. Under the parameter setting used for <xref rid="fig7" ref-type="fig">Figure 7</xref>, the critical value is <inline-formula><alternatives><inline-graphic xlink:href="023606_inline145.gif"/></alternatives></inline-formula> 300 when (<italic>&#x03BB;</italic><sup><italic>I</italic></sup>&#x002B;&#x03BB;<sub><italic>D</italic></sub>)&#x007C; <italic>b</italic> &#x007C; &#x2248; 0.6. This means that, <italic>as far as case (ii) local gap-configurations are concerned</italic>, Kim and Sinha&#x2019;s HMM practically satisfies the CK equation at least up to <italic>O</italic> ((<italic>&#x03BB;</italic> &#x007C; <italic>b</italic> &#x007C;)<sup>2</sup>).</p>
<p>However, we expect that their HMM will severely violate the CK equation when it is applied to case (iii) local PWAs, in view of the results in Subsection 2.2.</p>
<p>Some past simulation analyses (<italic>e.g</italic>., <xref ref-type="bibr" rid="c38">Thorne et al. 1992</xref>; <xref ref-type="bibr" rid="c24">Knudsen and Miyamoto 2003</xref>; <xref ref-type="bibr" rid="c28">Metzler 2003</xref>) seem to have concluded that the violation of the CK equation, or its cause, <italic>i.e</italic>., the failure to accommodate overlapping indels, did not seriously impact on the results of data analyses. These results might be because they used geometric distributions of indel lengths. To see if this is indeed the case, let&#x2019;s assume <italic>f</italic><sup><italic>I</italic></sup>(<italic>l</italic>) = <italic>f</italic><sup><italic>D</italic></sup>(<italic>l</italic>) = (1&#x2212; <italic>q</italic>)<italic>q</italic><sup><italic>l</italic>&#x2212;1</sup>. Substituting them into Eq.(2.2.6&#x2019;b), we have:
<disp-formula id="eqn70"><alternatives><graphic xlink:href="023606_eqn70.gif"/></alternatives></disp-formula></p>
<p>Here we used <inline-formula><alternatives><inline-graphic xlink:href="023606_inline146.gif"/></alternatives></inline-formula> to obtain the approximation. Now, with the approximations <italic>c</italic><sub><italic>I</italic></sub>&#x2248; <italic>&#x03BB;</italic><sub><italic>I</italic></sub>, <italic>c</italic><sub><italic>D</italic></sub> &#x2248; <italic>&#x03BB;</italic><sub><italic>D</italic></sub> and Pr<sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) &#x2248; <italic>f</italic><sub>D</sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>), we calculate the ratio:
<disp-formula id="eqn71"><alternatives><graphic xlink:href="023606_eqn71.gif"/></alternatives></disp-formula></p>
<p>If &#x0394;<italic>L</italic><sup><italic>A</italic></sup> is quite large, <italic>e.g</italic>., 10 or greater, the middle term on the right hand side will predominate, and the ratio could be roughly approximated as</p>
<p><italic>&#x03BB;</italic><sub><italic>D</italic></sub> &#x007C;<italic>b</italic>&#x007C; (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>)<sup>2</sup> (1&#x2212; <italic>q</italic>) (4<italic>q</italic>). Thus, the &#x201C;critical value&#x201D; is roughly given by <inline-formula><alternatives><inline-graphic xlink:href="023606_inline147.gif"/></alternatives></inline-formula>. If we set, <italic>e.g</italic>., <italic>&#x03BB;</italic><sub>D</sub>= 0.1 and <italic>q</italic> = <italic>q</italic><sub><italic>LS</italic></sub>(1.6) = 0.3957 as given above Eq.(2.1.3), the critical value would be:<inline-formula><alternatives><inline-graphic xlink:href="023606_inline148.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline149.gif"/></alternatives></inline-formula>. At these critical values, geometric deletion length frequencies are already pretty small; we have <italic>f</italic>(&#x0394;<italic>L</italic><sup>4</sup>-8)&#x2248;9.2&#x00D7;10<sup>&#x2212;4</sup>and <italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> = 26) &#x2248; 5.2 &#x00D7;10<sup>&#x2212;11</sup> when <italic>q</italic> = <italic>q</italic><sub><italic>LS</italic></sub> (1.6) = 0.3957. Therefore, as long as the geometric indel length distributions are used for simulations, it would be very rare to encounter indels whose lengths exceed the critical value. Moreover, as shown in Subsection 2.1, when the indels are longer than these critical values, models with geometric indel length distributions severely underestimate their frequencies, to the extent that they are deemed almost useless. With these circumstances compounded together, it would come as no surprise that the past studies did not detect significant impacts of the violation of the CK equation on their results. [NOTE: Precisely speaking, (nearly) standard HMMs and transducers can take account of <italic>a part</italic> of contributions from multiple deletions. For example, the total contribution of two-deletion histories that they can capture is (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2212;1)(<italic>&#x03BB;<sub>D</sub></italic> &#x007C; <italic>b</italic> &#x007C;)<sup>2</sup> (1&#x2212; <italic>q</italic>) <italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>). Here (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2212;1) comes from the number of ways in which a run of gaps can be split into two segments. Thus, its ratio to the first-order term, <italic>&#x03BB;<sub>D</sub></italic> &#x007C; <italic>b</italic> &#x007C; <italic>f</italic><sub><italic>D</italic></sub> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>), is</p>
<p>(&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2212;1)(<italic>&#x03BB;<sub>D</sub></italic> &#x007C; <italic>b</italic> &#x007C;)(1&#x2212; <italic>q</italic>). This is roughly 4<italic>q</italic> &#x0394;<italic>L</italic><sup><italic>A</italic></sup> times as large as the dominant term in Eq.(2.3.6). This ratio is much smaller than 1 (unity) when &#x0394;<italic>L</italic><sup><italic>A</italic></sup> is around or greater than the above critical values. Therefore, such histories with two contiguous deletions have only negligible effects on the present argument.]</p>
<p>In contrast, if we incorporate biologically realistic indel length distributions into indel probabilistic models that are <italic>not genuine</italic> evolutionary models, such effects may become remarkable when dealing with long indels and/or long branches. The effects, however, might be somewhat alleviated by fitting indel rate parameters and length distributions that depend on the branch length as in Eqs.(2.2.10a,b).</p>
</sec>
</sec>
<sec id="s4"><title>Conclusions</title>
<p>In a previous paper (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), we approached the fundamental problems on the probability of indels in an absolutely orthodox manner. More specifically, we established the theoretical basis of an <italic>ab initio</italic> perturbative formulation of a general continuous-time Markov model, which is a <italic>genuine</italic> stochastic model describing the evolution of an <italic>entire</italic> sequence via indels along the time axis. Using the formulation, we proved that, if the indel model parameters satisfy a certain set of conditions, the probability of an alignment is indeed factorable into the product of an overall factor and contributions from local alignments delimited by preserved ancestral sites (PASs).</p>
<p>In this paper, we concretely calculated the probability contributions from individual local alignments using perturbation analyses. The results indicated that even the fewest-indel terms alone can approximate the probabilities pretty well as long as the branch lengths and the indel lengths are at most moderate. And we also clarified the parameter regions where the alignment probabilities are safely approximated by the hidden Markov models (HMMs) of indels (and by association the transducer theories) that were often used in the past. We showed that the approximation by the geometric indel length distributions grossly deteriorates as soon as the indels become longer than 4 sites. We also showed that these HMMs violate the Chapman-Kolmogorov (CK) equation because they lack most of the non-fewest-indel terms in the perturbation expansion. This finding enables to predict the regions where the violation of the CK equation starts to compromise the reliability of these models. The analyses also suggested possible modifications to these models in order to improve their accuracy.</p>
<p>To summarize, by depending purely on the first principle, our <italic>ab initio</italic> perturbation formulation provides a sound reference point to which other indel models can be compared in order to see when and how well they can approximate the true alignment probabilities.</p>
</sec>
<sec id="s5"><title>Methods</title>
<sec id="s5a"><title>Implementation of the formulas</title>
<p>Most of the formulas used for the perturbation analyses were implemented in Perl. They are available as a part of the package named LOLIPOG (log-likelihood for the pattern of gaps in MSA), which in turn is available at the FTP repository of the Bioinformatics Organization (<xref ref-type="bibr" rid="c11">Ezawa 2013</xref>).</p>
</sec>
</sec>
<sec id="s6"><title>Authors&#x2019; contributions</title>
<p>KE conceived of and mathematically formulated the theoretical framework in this paper, implemented the key algorithms, participated in designing the study, performed all the mathematical analyses, and drafted the manuscript. DG and GL participated in designing the study, helped with the interpretation of the data, and helped with the drafting of the manuscript.</p>
</sec>
</body>
<back>
<ack><title>Acknowledgements</title>
<p>This study is dedicated to the late Dr. Keiji Kikkawa, who was a renowned theoretical physicist, one of the key pioneers of the string field theory of the elementary particle physics, and the best ever mentor of K.E. We are grateful to Dr. R. A. Cartwright at Arizona State University for his useful information and discussions that inspired this study. We appreciate the logistic support and the feedback of Dr. Tetsushi Yada at the Kyushu Institute of Technology. We would also like to thank the three anonymous referees of the predecessor manuscript entitled: &#x201C;Framework that enables approximate lilelihood analysis of insertions/deletions on multiple sequence alignment.&#x201D; Their comments helped drastically improve the study itself, not to mention the manuscript. This work was a part of the project, &#x201C;Error Correction in Multiple Sequence Alignments,&#x201D; which was funded by US National Library of Medicine [grant number LM010009-01 to Dan Graur and Giddy Landan at the University of Houston]. The later stage of this work was also supported by Grants-in-Aid No. 221S0002, which was awarded to Tetsushi Yada by the Ministry of Education, Culture, Sports, Science and Technology of Japan.</p>
</ack>
<glossary><title>List of abbreviations</title>
<def-list>
<def-item><term>CK,</term>
<def><p>Chapman-Kolmogorov;</p></def>
</def-item>
<def-item><term>CHMM,</term>
<def><p>hidden Markov model;</p></def>
</def-item>
<def-item><term>indel,</term>
<def><p>insertion/deletion;</p></def>
</def-item>
<def-item><term>LHS,</term>
<def><p>local history set;</p></def>
</def-item>
<def-item><term>MSA,</term>
<def><p>multiple sequence alignment;</p></def>
</def-item>
<def-item><term>PAS,</term>
<def><p>preserved ancestral site;</p></def>
</def-item>
<def-item><term>PWA,</term>
<def><p>pairwise alignment.</p></def>
</def-item>
</def-list>
</glossary>
<app-group>
<app id="app1"><title>Appendix</title>
<sec>
<p><bold>A1. Perturbation calculation of multiplication factors for PWAs between ancestral and descendant sequences</bold></p>
<sec>
<p>A1.1. For case (iii) local PWAs</p>
<p>Here we detail the calculation of the sum of contributions from the fewest-indel events as well as that from the next-fewest-indel events in case (iii) considered in Section 1.2 of Results, that is, the case where the ancestor has no site but the descendant has one or more sites in between a pair of preserved ancestral sites (PASs) (<xref rid="fig2" ref-type="fig">Figure 2</xref> C).</p>
<p>In case (iii), we assume that the descendant state has &#x0394;<italic>L</italic><sup><italic>D</italic></sup> sites in between the flanking PASs. Thus, the ancestral and descendant states could be represented as <italic>s</italic><sup><italic>A</italic></sup>=[<italic>L, R</italic>] and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline150.gif"/></alternatives></inline-formula>, respectively. The ancestries satisfy <inline-formula><alternatives><inline-graphic xlink:href="023606_inline151.gif"/></alternatives></inline-formula> for <italic>i</italic> &#x2260; <italic>j</italic>, and their details depend on the responsible indel history. As long as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline152.gif"/></alternatives></inline-formula>, and there is only one fewest-indel history, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline153.gif"/></alternatives></inline-formula>, which consists of a single event that inserts the descendant sites in between the PASs. Therefore, the sum of contributions from the fewest-indel history is:
<disp-formula id="eqn72"><alternatives><graphic xlink:href="023606_eqn72.gif"/></alternatives></disp-formula></p>
<p>As in case (ii), each next-fewest indel history is composed of two indel events, and classified into two types: (c) two successive insertions, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline154.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2212;1 and <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup>D</sup> &#x2212; <italic>l</italic> &#x002B;1; and (d) an insertion followed by a deletion,<inline-formula><alternatives><inline-graphic xlink:href="023606_inline155.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline156.gif"/></alternatives></inline-formula>and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; 2. Thus, in this case, the portion contributed by the next-fewest indel histories is given by:
<disp-formula id="eqn73"><alternatives><graphic xlink:href="023606_eqn73.gif"/></alternatives></disp-formula></p>
<p>Here,
<disp-formula id="eqn74"><alternatives><graphic xlink:href="023606_eqn74.gif"/></alternatives></disp-formula>
is the sum of contributions from the histories of type (c), and
<disp-formula id="eqn75"><alternatives><graphic xlink:href="023606_eqn75.gif"/></alternatives></disp-formula>
is the sum of contributions from the histories of type (d). As in case (i), let &#x3008;[&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x2212;<italic>l</italic>]&#x007C;&#x2261;&#x3008;<italic>s</italic><sup><italic>A</italic></sup>&#x007C;<italic>M</italic><sup><italic>I</italic></sup>(1,&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x2212;<italic>l</italic>) be the intermediate state in each type (c) history. Then, the history&#x2019;s contribution is calculated as:
<disp-formula id="eqn76"><alternatives><graphic xlink:href="023606_eqn76.gif"/></alternatives></disp-formula></p>
<p>Similarly, each type (d) history&#x2019;s contribution is calculated as:
<disp-formula id="eqn77"><alternatives><graphic xlink:href="023606_eqn77.gif"/></alternatives></disp-formula></p>
<p>Let us now calculate Eqs.(A1.1.1,2a-e) under Dawg&#x2019;s indel model or the &#x201C;long indel&#x201D; model, as in the previous cases in Section 1.2 of Results. In this model, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline157.gif"/></alternatives></inline-formula> and Eq.(A1.1.1) becomes:
<disp-formula id="eqn78"><alternatives><graphic xlink:href="023606_eqn78.gif"/></alternatives></disp-formula></p>
<p>Similarly, using <inline-formula><alternatives><inline-graphic xlink:href="023606_inline158.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline159.gif"/></alternatives></inline-formula> Eqs.(A1.1.2d,e) are calculated, respectively, as:
<disp-formula id="eqn79"><alternatives><graphic xlink:href="023606_eqn79.gif"/></alternatives></disp-formula>
<disp-formula id="eqn80"><alternatives><graphic xlink:href="023606_eqn80.gif"/></alternatives></disp-formula></p>
<p>Substituting Eqs.(A1.1.2d&#x2019;,e&#x2019;) into Eqs.(A1.1.2a,b,c), we can concretely calculate the total contribution from next-fewest-indels.</p>
</sec>
<sec>
<p>A1.2. For case (iv) local PWAs</p>
<p>Here we detail the calculation of the sum of contributions from the fewest-indel events as well as that from the next-fewest-indel events in case (iv) considered in Section 1.2 of Results, that is, the case where both the ancestor and the descendant have one or more site(s) in between a pair of PASs, but no ancestral site is related to any of the descendant sites (<xref rid="fig2" ref-type="fig">Figure 2</xref> D).</p>
<p>In case (iv), we assume that the ancestral and the descendant states have &#x0394;<italic>L</italic>, <sup><italic>A</italic></sup> and &#x0394;<italic>L</italic><sup><italic>D</italic></sup> sites, respectively, in between the flanking PASs. Thus, the ancestral and descendant states could be represented as <italic>s</italic><sup><italic>A</italic></sup> =;[<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>, <italic>R</italic>]and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline160.gif"/></alternatives></inline-formula> respectively. Here, the descendant ancestries satisfy <inline-formula><alternatives><inline-graphic xlink:href="023606_inline161.gif"/></alternatives></inline-formula> for all <italic>i</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline162.gif"/></alternatives></inline-formula> for all <italic>i &#x2260; j</italic>, and their details depend on the responsible indel history. As long as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline163.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline164.gif"/></alternatives></inline-formula>, <italic>N</italic> <sub><italic>min</italic></sub> [&#x03B3;<sub><italic>k</italic></sub>; &#x03B1;(<italic>s</italic><sup><italic>A</italic></sup>, <italic>s</italic><sup><italic>D</italic></sup>)]=2As indicated by Eqs.(A1.3c&#x2019;,d&#x2019;) in Appendix A1 of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), there are three types of fewest-indel histories: (e) the deletion of the ancestral sites followed by an insertion of &#x0394;<italic>L</italic><sup>D</sup> sites, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline165.gif"/></alternatives></inline-formula> (f)an insertion immediately on the right of the ancestral sites to be deleted, followed by the deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline166.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline167.gif"/></alternatives></inline-formula>; and (g) an insertion immediately on the left of the ancestral sites to be deleted, followed by the deletion, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline168.gif"/></alternatives></inline-formula>also with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline169.gif"/></alternatives></inline-formula> Thus, the sum of contributions by the fewest-indel histories is expressed as:
<disp-formula id="eqn81"><alternatives><graphic xlink:href="023606_eqn81.gif"/></alternatives></disp-formula></p>
<p>Here,
<disp-formula id="eqn82"><alternatives><graphic xlink:href="023606_eqn82.gif"/></alternatives></disp-formula>
is the contribution from the single history of type (e),
<disp-formula id="eqn83"><alternatives><graphic xlink:href="023606_eqn83.gif"/></alternatives></disp-formula>
is the sum of contributions from the type (f) histories, and
<disp-formula id="eqn84"><alternatives><graphic xlink:href="023606_eqn84.gif"/></alternatives></disp-formula>
is the sum of contributions from the type (g) histories. To calculate the contribution from each of these histories, let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline170.gif"/></alternatives></inline-formula> intermediate state of the type (e) history. And, as in case (ii), let <inline-formula><alternatives><inline-graphic xlink:href="023606_inline171.gif"/></alternatives></inline-formula> be the state type including the intermediate states of the histories of types (f) and (g). Then, the type (e) history&#x2019;s contribution is:
<disp-formula id="eqn85"><alternatives><graphic xlink:href="023606_eqn85.gif"/></alternatives></disp-formula>
the contribution from each history of type (f) is:
<disp-formula id="eqn86"><alternatives><graphic xlink:href="023606_eqn86.gif"/></alternatives></disp-formula>
and each type (g) history&#x2019;s contribution is:
<disp-formula id="eqn87"><alternatives><graphic xlink:href="023606_eqn87.gif"/></alternatives></disp-formula></p>
<p>Under Dawg&#x2019;s indel model (or, similarly, under the &#x201C;long indel&#x201D; model), we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline172.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline173.gif"/></alternatives></inline-formula> Using them, Eqs.(A1.2.1e,f,g) are calculated as:
<disp-formula id="eqn88"><alternatives><graphic xlink:href="023606_eqn88.gif"/></alternatives></disp-formula>
<disp-formula id="eqn89"><alternatives><graphic xlink:href="023606_eqn89.gif"/></alternatives></disp-formula></p>
<p>Here, we defined the function <italic>F</italic><sub><italic>e</italic></sub>&#x2212; (<italic>x</italic>, <italic>t</italic>) as:
<disp-formula id="eqn90"><alternatives><graphic xlink:href="023606_eqn90.gif"/></alternatives></disp-formula></p>
<p>Meanwhile, each next-fewest-indel history is composed of three indel events, and classified into one of 6 broad types: (h) two successive deletions followed by an insertion; (i) a deletion, followed by an insertion, followed by a deletion; (j) an insertion followed by two successive deletions; (k) a deletion followed by two successive insertions; (l) an insertion, followed by a deletion, followed by an insertion; and (m) two successive insertions followed by a deletion. And these 6 broad types can be further sub-classified into 24 sub-types, as explained in the following. Type (h) does not need to be sub-classified, and each history belonging to this type can be expressed as: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline174.gif"/></alternatives></inline-formula> with <italic>L</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2212;1 and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2212; <italic>L</italic> &#x002B; 2. Type (i) is sub-classified into three sub-types: (i-1) the case where the insertion is immediately on the right of the sites to be deleted, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline175.gif"/></alternatives></inline-formula> with <italic>l</italic>=1,&#x2026;&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;1, <italic>x</italic>=2,&#x2026;,&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;<italic>l</italic>&#x002B;2, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline176.gif"/></alternatives></inline-formula> nd (i-2) the case where the insertion is immediately on the left of the sites to be deleted, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline177.gif"/></alternatives></inline-formula> also with <italic>l</italic>=1,&#x2026;&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;1, <italic>x</italic>=2,&#x2026;,&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;<italic>l</italic>&#x002B;2, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline178.gif"/></alternatives></inline-formula> and (i-3) the case where the first event deletes all unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline179.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline180.gif"/></alternatives></inline-formula> and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; 2. Type (j) is sub-classified into eight sub-types: (j-1) the case where the two deletions were on the right of the inserted sites that ended up in the descendant, represented as<inline-formula><alternatives><inline-graphic xlink:href="023606_inline181.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline182.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline183.gif"/></alternatives></inline-formula>, and <italic>x</italic>=2,&#x2026;&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x002B;<italic>l</italic>&#x2212;<italic>l&#x2032;</italic>&#x002B;<italic>l</italic>;(j-2) the case where the two deletions were on the left of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline184.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline185.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline186.gif"/></alternatives></inline-formula><italic>x</italic> = &#x0394;<italic>L</italic> <sup><italic>D</italic></sup> &#x002B; 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x002B; &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; <italic>L</italic> &#x2212; <italic>L</italic>&#x2032;&#x002B; 2; (j-3) the case where the first and the second deletions were on the left and in the middle, respectively, of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline187.gif"/></alternatives></inline-formula>with<inline-formula><alternatives><inline-graphic xlink:href="023606_inline188.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline189.gif"/></alternatives></inline-formula>, and <italic>x</italic>=3,&#x2026;&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x002B;1&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x2265;2 must always hold); (j-4) the case where the first and the second deletions were in the middle and on the left, respectively, of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline190.gif"/></alternatives></inline-formula>with<inline-formula><alternatives><inline-graphic xlink:href="023606_inline191.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline192.gif"/></alternatives></inline-formula> and <italic>x</italic>=&#x0394;<italic>L</italic><sup><italic>A</italic></sup><italic>l</italic>&#x2032;&#x002B;3,&#x2026;,&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x002B;&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x002B;<italic>l</italic>&#x2032;&#x002B;1 (&#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2265; 2 must always hold); (j-5) the case where the first and the second deletions were on the right and in the middle, respectively, of the inserted sites that ended up in the descendant, represented as<inline-formula><alternatives><inline-graphic xlink:href="023606_inline193.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline194.gif"/></alternatives></inline-formula> and <italic>x</italic>=3,&#x2026;&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x002B;1 (&#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2265;2 must always hold); (j-6) the case where the first and second deletions were in the middle and on the right, respectively, of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline195.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline196.gif"/></alternatives></inline-formula>, and <italic>x</italic>=3,&#x2026;&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x002B;1 (&#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x2265;2 must always hold); (j-7) the case the first and the second deletions were on the right and on the left, respectively, of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline197.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline198.gif"/></alternatives></inline-formula>, and <italic>x</italic> = max{0, <italic>L</italic>&#x2033;},&#x2026;, min{<italic>L</italic> &#x002B; <italic>L</italic>&#x2033;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>}; and (j-8) the case where the first and the second deletions were on the left and on the right, respectively, of the inserted sites that ended up in the descendant, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline199.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline200.gif"/></alternatives></inline-formula>and <italic>x</italic>= max{0,<italic>l</italic>&#x2033;},&#x2026;,min{<italic>l</italic>&#x002B;<italic>l</italic>&#x2033;&#x0394;<italic>L</italic><sup><italic>A</italic></sup>}Type (k) does not need be sub-classified, and each history belonging to this type can be represented as: <inline-formula><alternatives><inline-graphic xlink:href="023606_inline201.gif"/></alternatives></inline-formula> with <italic>l</italic>=1,&#x2026;,<italic>l</italic>&#x002B;1. Type (l) is sub-classified into three sub-types: (l-1) the case where the first insertion was on the immediate right of the left-flanking PAS, and at least a site inserted by the event survived, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline202.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline203.gif"/></alternatives></inline-formula>, and <italic>x</italic>=1,&#x2026;,&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;<italic>l</italic>&#x2032;&#x002B;1;(l-2) the case where the first insertion was on the immediate left of the right-flanking PAS, and at least a site inserted by the event survived, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline204.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline205.gif"/></alternatives></inline-formula>, and <italic>x</italic>=1,&#x2026;,&#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x2212;<italic>l</italic>&#x2032;&#x002B;1; and and (l-3) the case where all sites inserted by the first event were deleted along with the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline206.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline207.gif"/></alternatives></inline-formula> and <italic>x</italic>=1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>&#x002B;1. Finally, type (m) is sub-classified into eight sub-types: (m-1) the case where the two insertions are on the left of the unpreserved ancestral sites, represented as:<inline-formula><alternatives><inline-graphic xlink:href="023606_inline208.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline209.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline210.gif"/></alternatives></inline-formula> and <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>LD</italic> &#x002B; <italic>L</italic> &#x2212; <italic>L</italic>&#x2032;&#x002B;1; (m-2) the case where the two insertions are on the right of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline211.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline212.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline213.gif"/></alternatives></inline-formula>. and <italic>x</italic> = &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x002B;1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x002B; &#x0394;<italic>L<sup>D</sup></italic> &#x002B; <italic>L</italic> &#x2212; <italic>L</italic>&#x2032;&#x002B;1; (m-3) the case where the first and the second insertions are in the middle and on the left, respectively, of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline214.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline215.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline216.gif"/></alternatives></inline-formula> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2265; 2 must always hold); (m-4) the case where the first and the second insertions are in the middle and on the left and in the middle, respectively, of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline217.gif"/></alternatives></inline-formula>with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline218.gif"/></alternatives></inline-formula>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline219.gif"/></alternatives></inline-formula>, and <italic>x</italic> = &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; <italic>L</italic>&#x2032;&#x002B; 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x002B; &#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; <italic>L</italic>&#x2032; (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2265; 2 must always hold); (m-5) the case where first and the second insertions are in the middle and on the right, respectively, of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline220.gif"/></alternatives></inline-formula> with <italic>x</italic>=2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline221.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline222.gif"/></alternatives></inline-formula> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2265; 2 must always hold); (m-6) the case where the first and the second insertions are on the right and in the middle, respectively, of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline223.gif"/></alternatives></inline-formula> with <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>A</italic></sup>, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline224.gif"/></alternatives></inline-formula>, and<inline-formula><alternatives><inline-graphic xlink:href="023606_inline225.gif"/></alternatives></inline-formula> (&#x0394;<italic>L</italic><sup><italic>A</italic></sup> &#x2265; 2 must always hold); (m-7) the case where the first and the second insertions are on the left and on the right, respectively, of the unpreserved ancestral sites, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline226.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline227.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline228.gif"/></alternatives></inline-formula>, and <italic>x</italic> = max{0, <italic>l</italic>&#x2033;},&#x2026;, min{<italic>l</italic> &#x002B; <italic>l<italic>&#x2033;, &#x0394;<italic>L</italic><sup>D</sup></italic>}; and (m-8) the case where the first and the second insertions are on the right and on the left, respectively, of the unpreserved ancestral sites, represented as<inline-formula><alternatives><inline-graphic xlink:href="023606_inline229.gif"/></alternatives></inline-formula> with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline230.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline231.gif"/></alternatives></inline-formula>, and <italic>x</italic> = max{0, <italic>l</italic>&#x2033;},&#x2026;, min{<italic>l</italic> &#x002B; <italic>l</italic>&#x2033;, &#x0394;<italic>L</italic><sup>D</sup></italic>}.</p>
<p>Using this classification of the next-fewest-indel histories in case (iv), the sum of their contributions can be expressed as:
<disp-formula id="eqn91"><alternatives><graphic xlink:href="023606_eqn91.gif"/></alternatives></disp-formula></p>
<p>Here, each of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline232.gif"/></alternatives></inline-formula> is the sum of contributions from the histories belonging to one of the 24 sub-types explained above. Each of them can be calculated by calculating the contribution from each constituent history according to the definition, Eq.(4.1.1b) of part I supplemented by Eq.(3.1.8b) of part I, and by summing the contributions over possible values of the length variables <italic>l</italic> and <italic>l</italic>&#x2032; (or <italic>l</italic>&#x2033;) and over possible positions <italic>x</italic> when necessary, all specified above. Under a space-and time-homogeneous model, the indel rates become independent of the positions of the indels and of the exact state before the event, and the exit rate depends only on the sequence length (and possibly on the functional form of the deletion length distribution). This simplifies the calculation considerably. Especially, because each term is independent of the exact position of indels, a summation over the positions <italic>x</italic> is reduced to a simple multiplication by the number of possible positions. In addition, considerations on spatial symmetry reveal that some different sub-types actually give identical contributions to each other (detailed below). Moreover, under Dawg&#x2019;s indel model or the &#x201C;long indel&#x201D; model, the increment of the exit rate is proportional to the difference in the sequence lengths, which further simplifies the calculation. Here, we give the results of contributions by individual histories under Dawg&#x2019;s indel model.</p>
<p>But the results apply immediately to, <italic>e.g</italic>., the &#x201C;long indel&#x201D; model as well. We first give the general formula for the contribution of a three-event local history, and then we apply the formula to the histories of different sub-types.</p>
<p>First we consider a general three-event history, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline233.gif"/></alternatives></inline-formula>, on the ancestral state S<sup>A</sup>[<italic>L</italic>, 1,&#x2026;?<italic>L</italic><sup>A</sup>] that resulted in the descendant state <inline-formula><alternatives><inline-graphic xlink:href="023606_inline234.gif"/></alternatives></inline-formula> Here <inline-formula><alternatives><inline-graphic xlink:href="023606_inline235.gif"/></alternatives></inline-formula> (with &#x03BD; = 1, 2, 3) is either an insertion <inline-formula><alternatives><inline-graphic xlink:href="023606_inline236.gif"/></alternatives></inline-formula> or a deletion <inline-formula><alternatives><inline-graphic xlink:href="023606_inline237.gif"/></alternatives></inline-formula>. Let <italic>&#x03B4;l<sub>v</sub></italic> (with &#x03BD; = 1, 2, 3) be the sequence length change caused by the event <inline-formula><alternatives><inline-graphic xlink:href="023606_inline238.gif"/></alternatives></inline-formula>; <italic>&#x03B4;l<sub>v</sub></italic> is positive if <inline-formula><alternatives><inline-graphic xlink:href="023606_inline239.gif"/></alternatives></inline-formula> is an insertion and negative if <inline-formula><alternatives><inline-graphic xlink:href="023606_inline240.gif"/></alternatives></inline-formula> is a deletion. They satisfy: <italic>&#x03B4;l</italic>1 &#x002B; <italic>&#x03B4;l</italic>2 &#x002B; <italic>&#x03B4;l</italic>3 = &#x0394;<italic>L</italic><sub>D</sub> &#x2212; &#x0394;<italic>L</italic><sub>A</sub>. And let <italic>r</italic>(<italic>&#x03B4;l</italic>) be the space-and time-homogeneous rate of the indel event that changes the sequence length by <italic>&#x03B4;l</italic>. Under Dawg&#x2019;s indel model, we have:
<disp-formula id="eqn92"><alternatives><graphic xlink:href="023606_eqn92.gif"/></alternatives></disp-formula></p>
<p>Then, according to Eq.(4.1.1b) of part I supplemented by Eq.(3.1.8b) of part I, the contribution from this three-event local history is expressed as:
<disp-formula id="eqn93"><alternatives><graphic xlink:href="023606_eqn93.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline241.gif"/></alternatives></inline-formula>is a triple-time integral:
<disp-formula id="eqn94"><alternatives><graphic xlink:href="023606_eqn94.gif"/></alternatives></disp-formula></p>
<p>When <italic>&#x03B4;l</italic>2 &#x002B; <italic>&#x03B4;l</italic>3 &#x2260; 0, it is calculated as:
<disp-formula id="eqn95"><alternatives><graphic xlink:href="023606_eqn95.gif"/></alternatives></disp-formula></p>
<p>Here the function <italic>F</italic><sub><italic>e</italic></sub>&#x2212; (<italic>x</italic>, <italic>t</italic>) was already defined in Eq.(SR-8B.2). When <italic>&#x03B4;l</italic>2 &#x002B; <italic>&#x03B4;l</italic>3 = 0, the triple-time integral is calculated as:
<disp-formula id="eqn96"><alternatives><graphic xlink:href="023606_eqn96.gif"/></alternatives></disp-formula></p>
<p>When <inline-formula><alternatives><inline-graphic xlink:href="023606_inline242.gif"/></alternatives></inline-formula> does not overlap <inline-formula><alternatives><inline-graphic xlink:href="023606_inline243.gif"/></alternatives></inline-formula>, there should be a corresponding pair of events, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline244.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline245.gif"/></alternatives></inline-formula> that satisfy <inline-formula><alternatives><inline-graphic xlink:href="023606_inline246.gif"/></alternatives></inline-formula> as one of the binary equivalence relations (Eqs.(2.3.3a-d) of part I). Under Dawg&#x2019;s model, the effects of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline247.gif"/></alternatives></inline-formula>and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline248.gif"/></alternatives></inline-formula> are <italic>partially</italic> factorable if we consider the joint contribution from the two local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline249.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline250.gif"/></alternatives></inline-formula>. We will express this joint contribution as:
<disp-formula id="eqn97"><alternatives><graphic xlink:href="023606_eqn97.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline251.gif"/></alternatives></inline-formula>is a triple-time integral:
<disp-formula id="eqn98"><alternatives><graphic xlink:href="023606_eqn98.gif"/></alternatives></disp-formula></p>
<p>It is calculated as:
<disp-formula id="eqn99"><alternatives><graphic xlink:href="023606_eqn99.gif"/></alternatives></disp-formula></p>
<p>Similarly, when <inline-formula><alternatives><inline-graphic xlink:href="023606_inline252.gif"/></alternatives></inline-formula> does not overlap <inline-formula><alternatives><inline-graphic xlink:href="023606_inline253.gif"/></alternatives></inline-formula>, there should be a corresponding pair of events, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline254.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline255.gif"/></alternatives></inline-formula>, that satisfy the binary equivalence, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline256.gif"/></alternatives></inline-formula> (as one of Eqs.(2.3.3a-d) of part I). When considering the joint contribution from the two local histories, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline257.gif"/></alternatives></inline-formula>and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline258.gif"/></alternatives></inline-formula>, the effects of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline259.gif"/></alternatives></inline-formula>and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline260.gif"/></alternatives></inline-formula>are <italic>partially</italic> factorable under Dawg&#x2019;s model. We will express the joint effect as:
<disp-formula id="eqn100"><alternatives><graphic xlink:href="023606_eqn100.gif"/></alternatives></disp-formula></p>
<p>Here, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline261.gif"/></alternatives></inline-formula> is a triple-time integral:
<disp-formula id="eqn101"><alternatives><graphic xlink:href="023606_eqn101.gif"/></alternatives></disp-formula></p>
<p>It could be calculated by taking advantage of the following relationship:
<disp-formula id="eqn102"><alternatives><graphic xlink:href="023606_eqn102.gif"/></alternatives></disp-formula></p>
<p>Now we can apply the general formulas, Eqs(A1.2.5a,b&#x201D;), Eqs.(A1.2.6a,b&#x2019;), and Eqs.(A1.2.7a,b&#x2019;), to specific cases. First, the contribution from a type (h) history is:
<disp-formula id="eqn103"><alternatives><graphic xlink:href="023606_eqn103.gif"/></alternatives></disp-formula></p>
<p>Second, by spatial symmetry, the contribution from a type (i-1) history is identical to that from the corresponding type (i-2) history. They are given by:
<disp-formula id="eqn104"><alternatives><graphic xlink:href="023606_eqn104.gif"/></alternatives></disp-formula></p>
<p>Third, the contribution from a type (i-3) history is:
<disp-formula id="eqn105"><alternatives><graphic xlink:href="023606_eqn105.gif"/></alternatives></disp-formula></p>
<p>Fourth, by spatial symmetry, the contribution from a type (j-1) history is identical to that from the corresponding type (j-2) history. They are given by:
<disp-formula id="eqn106"><alternatives><graphic xlink:href="023606_eqn106.gif"/></alternatives></disp-formula></p>
<p>Fifth, we consider the joint contribution from a type (j-3) history and the corresponding type (j-4) history. By spatial symmetry, it is identical to the joint contribution from the corresponding type (j-5) and type (j-6) histories. They are given by:
<disp-formula id="eqn107"><alternatives><graphic xlink:href="023606_eqn107.gif"/></alternatives></disp-formula></p>
<p>Sixth, consider the joint contribution from a type (j-7) history and the corresponding type (j-8) history. It is given by:
<disp-formula id="eqn108"><alternatives><graphic xlink:href="023606_eqn108.gif"/></alternatives></disp-formula></p>
<p>Seventh, the contribution from a type (k) history is:
<disp-formula id="eqn109"><alternatives><graphic xlink:href="023606_eqn109.gif"/></alternatives></disp-formula></p>
<p>Eighth, by spatial symmetry, the contribution from a type (l-1) history is identical to that from the corresponding type (l-2) history. They are given by:
<disp-formula id="eqn110"><alternatives><graphic xlink:href="023606_eqn110.gif"/></alternatives></disp-formula></p>
<p>Ninth, the contribution from a type (l-3) history is:
<disp-formula id="eqn111"><alternatives><graphic xlink:href="023606_eqn111.gif"/></alternatives></disp-formula></p>
<p>Tenth, by spatial symmetry, the contribution from a type (m-1) history is identical to that from the corresponding type (m-2) history. They are given by:
<disp-formula id="eqn112"><alternatives><graphic xlink:href="023606_eqn112.gif"/></alternatives></disp-formula></p>
<p>Eleventh, consider the joint contribution from a type (m-3) history and the corresponding type (m-4) history. By spatial symmetry, it is equal to the joint contribution from the corresponding type (m-5) and type (m-6) histories. They are given by:
<disp-formula id="eqn113"><alternatives><graphic xlink:href="023606_eqn113.gif"/></alternatives></disp-formula></p>
<p>And, finally, twelfth, consider the joint contribution from a type (m-7) history and the corresponding type (m-8) history. It is given by:
<disp-formula id="eqn114"><alternatives><graphic xlink:href="023606_eqn114.gif"/></alternatives></disp-formula></p>
<p>These equations, Eqs.(A1.2.8a-r), supplemented with the general formulas, Eqs.(A1.2.5,6,7), provide the elementary contributions from the individual next-fewest-indel local histories. By summing them up over the appropriate lengths and positions given above the general formulas, Eqs.(A1.2.5,6,7), we get the total contribution of the next-fewest-indel local histories.</p>
</sec>
<sec>
<p>A1.3. System of integral equations providing &#x201C;exact&#x201D; multiplication factors for case-(i) &#x0026; (iii) local PWAs</p>
<p>In Section 1.2 of Results, we derived Eq.(1.2.7), which, supplemented with Eq.(1.2.8), gives a system of integral equations that can in principle provide &#x201C;exact&#x201D; multiplication factors for cases (i) and (ii), where there are a non-negative integer (&#x0394;<italic>L</italic><sup><italic>A</italic></sup>) of ancestral sites but zero descendant sites in between a pair of PASs. Here, following a similar line of procedures, we will derive a system of integral equations that can in principle provide &#x201C;exact&#x201D; multiplication factors <italic>for cases (i) and (iii)</italic>, where there are zero ancestral sites but a non-negative integer (&#x0394;<italic>L</italic><sup>D</sup>) of descendant sites in between a pair of PASs. For this purpose, we assume a setting very similar to that made above Eq.(1.2.6) for cases (i) and (ii). The only notable difference is that the ancestral and the descendant states here are <italic>s</italic><sup><italic>A</italic></sup> = [<italic>L</italic>, <italic>R</italic>] and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline262.gif"/></alternatives></inline-formula> respectively, which will be denoted as <italic>s</italic><sup><italic>A</italic></sup> = &#x3008;0&#x007C; and <italic>s</italic><sup><italic>D</italic></sup>&#x007C; = &#x3008;&#x0394;<italic>L</italic><sup><italic>D</italic></sup>&#x007C; under the setting of (local) spatial homogeneity.</p>
<p>The starting point here is the fundamental integral equation, Eq.(3.1.2) of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), for the stochastic evolution operator <inline-formula><alternatives><inline-graphic xlink:href="023606_inline263.gif"/></alternatives></inline-formula>, instead of Eq.(3.1.4) of part I for cases (i) and (ii). Similarly to above Eq.(1.2.6), we sandwich Eq.(3.1.2) of part I with &#x3008;<italic>s</italic><sup><italic>A</italic></sup>&#x007C; and &#x007C;<italic>s</italic><sup><italic>D</italic></sup> &#x3009;, expand <inline-formula><alternatives><inline-graphic xlink:href="023606_inline264.gif"/></alternatives></inline-formula>using its definition (<italic>i.e</italic>., Eq.(3.1.1c) of part I supplemented with Eqs.(2.4.2b&#x2019;,c&#x2019;) of part I), and ignore the effects of indels that are irrelevant to the cases under consideration. Then, we get:
<disp-formula id="eqn115"><alternatives><graphic xlink:href="023606_eqn115.gif"/></alternatives></disp-formula></p>
<p>Here, when considering the domains of the summations, we used the fact that the ketvectors <inline-formula><alternatives><inline-graphic xlink:href="023606_inline265.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline266.gif"/></alternatives></inline-formula> correspond uniquely to the states &#x3008;&#x0394;<italic>l</italic><sup><italic>D</italic></sup> &#x2212; <italic>l</italic>&#x007C; and &#x3008;&#x0394;<italic>L</italic><sup><italic>D</italic></sup> &#x002B; <italic>l</italic>&#x007C;, respectively. Next, we take advantage of this fact again, take account of the local homogeneity, and use the notation, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline267.gif"/></alternatives></inline-formula>, introduced above Eq.(1.2.7). Then, we can rewrite Eq.(A1.3.1) as:
<disp-formula id="eqn116"><alternatives><graphic xlink:href="023606_eqn116.gif"/></alternatives></disp-formula></p>
<p>This gives the system of integral equations for the &#x201C;exact&#x201D; probabilities, <italic>P</italic><sup><italic>ID</italic></sup> (0 &#x21A6;&#x0394;<italic>L</italic><sup>D</sup>; [<italic>t</italic>, <italic>t</italic>]), with non-negative integers &#x0394;<italic>L</italic><sup>D</sup> = 0,1, 2,&#x2026;. This system of equations can be solved iteratively, again starting with the &#x201C;zero-event approximation,&#x201D; <inline-formula><alternatives><inline-graphic xlink:href="023606_inline268.gif"/></alternatives></inline-formula> After a desired number (say, <italic>N</italic><sub><italic>ID</italic></sub>) of iteration steps, the multiplication factor will be obtained similarly, and we have:
<disp-formula id="eqn117"><alternatives><graphic xlink:href="023606_eqn117.gif"/></alternatives></disp-formula></p>
<p>It should be noted that the exponent on the right-most hand side is the time integral of the exit rate of the ancestral state but not that of the descendant state. This is just due to the definition of the multiplication factor (Eq.(4.1.1b) of part I). The consideration of the time-and space-complexities of a na&#x00EF;ve implementation of the iteration algorithm goes just as below Eq.(1.2.8) of Results. Just as Eq.(1.2.7), Eq.(A1.3.2) could also be numerically solved via a system of &#x201C;two-sub-step&#x201D; recursion relations:
<disp-formula id="eqn118"><alternatives><graphic xlink:href="023606_eqn118.gif"/></alternatives></disp-formula>
and
<disp-formula id="eqn119"><alternatives><graphic xlink:href="023606_eqn119.gif"/></alternatives></disp-formula></p>
<p>Similarly to Eqs.(1.2.9a,b), the algorithm to numerically solve this system of recursion relations also has the time-complexity of <italic>O</italic> (<italic>N</italic><sup><italic>ID</italic></sup> <italic>L</italic><sup><italic>CO</italic></sup> (<italic>L</italic><sup><italic>CO</italic></sup> &#x002B; <italic>N</italic><sub><italic>P</italic></sub>)<italic>N</italic><sub><italic>P</italic></sub>) and the space-complexity of <italic>O</italic> (<italic>L</italic><sup><italic>CO</italic></sup> <italic>N</italic><sub><italic>P</italic></sub>), and a single run of the algorithm (with <italic>N</italic><sub><italic>ID</italic></sub> steps) outputs <inline-formula><alternatives><inline-graphic xlink:href="023606_inline269.gif"/></alternatives></inline-formula> for all <inline-formula><alternatives><inline-graphic xlink:href="023606_inline270.gif"/></alternatives></inline-formula> and at all time-points, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline271.gif"/></alternatives></inline-formula></p>
</sec>
<sec>
<p><bold>A2. Perturbation calculation of multiplication factors for MSAs: case (IV) in Section 1.3</bold></p>
<p>Here we detail the calculation of the portion of the multiplication factor contributed by the fewest-indel events as well as that contributed by the next-fewest-indel events in case (IV). This case was considered in Section 1.3 of Results, and its situation is illustrated in <xref rid="fig4" ref-type="fig">Figure 4</xref> E. In this case, the external sequence states were represented as: <italic>S</italic><sub>1</sub>=[<italic>L</italic>,1,&#x2026;,&#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>], <italic>S</italic><sub>2</sub>=[<italic>L</italic>, 1,&#x2026;,,<italic>i</italic>,<italic>j</italic>,&#x2026;,&#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>, R], and S<sub>3</sub>=[<italic>L</italic>, <italic>R</italic>]with 1&#x2264;<italic>i</italic>&#x002B;1&#x003C;<italic>j</italic>&#x2264;&#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>&#x002B;1 but (<italic>i</italic>, <italic>j</italic>)&#x2260;(0, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>&#x002B;1)Also in this case,</p>
<p><italic>N</italic><sub>min</sub>[<italic>C</italic><sub><italic>k</italic></sub>;&#x03B1;[<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, <italic>S</italic><sub>3</sub>]; <italic>T</italic>] and there were two fewest-indel local histories. One, which we call type (E) here, starts with the root state <inline-formula><alternatives><inline-graphic xlink:href="023606_inline272.gif"/></alternatives></inline-formula> It is represented by Eq.(1.3.14a), <italic>i.e</italic>.,
<disp-formula id="eqn120a"><alternatives><graphic xlink:href="023606_eqn120a.gif"/></alternatives></disp-formula>
and the other, which we call type (F) here, starts with the root state
<italic>s</italic><sup>Root</sup> = <italic>s</italic><sub>1</sub> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>, <italic>R</italic>], instead of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline273.gif"/></alternatives></inline-formula>. It is represented by Eq.(1.3.14b), <italic>i.e.</italic>,
<disp-formula id="eqn120"><alternatives><graphic xlink:href="023606_eqn120.gif"/></alternatives></disp-formula></p>
<p>Thus the portion of the multiplication factor due to the fewest-indel histories can be written as:
<disp-formula id="eqn121"><alternatives><graphic xlink:href="023606_eqn121.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023606_inline274.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline275.gif"/></alternatives></inline-formula> are the contributions from the local histories of type (E) and type (F), respectively. These contributions can be calculated according to the definition, Eq.(1.1.2b) supplemented by Eqs.(4.2.4b,6b,8) of part I (<xref ref-type="bibr" rid="c12">Ezawa, Graur and Landan 2015a</xref>), similarly to the calculation of <inline-formula><alternatives><inline-graphic xlink:href="023606_inline276.gif"/></alternatives></inline-formula> in case (III). First, the contribution from the type (E) history is:
<disp-formula id="eqn122"><alternatives><graphic xlink:href="023606_eqn122.gif"/></alternatives></disp-formula></p>
<p>And the contribution from the type (F) history is:
<disp-formula id="eqn123"><alternatives><graphic xlink:href="023606_eqn123.gif"/></alternatives></disp-formula></p>
<p>Assuming a uniform distribution of the ancestral sequence length, we have <inline-formula><alternatives><inline-graphic xlink:href="023606_inline277.gif"/></alternatives></inline-formula> no matter what the root state (<italic>s</italic><sup><italic>Root</italic></sup>) is. Then, under Dawg&#x2019;s model, Eqs.(SR-9.2b,c) can be calculated as:
<disp-formula id="eqn124"><alternatives><graphic xlink:href="023606_eqn124.gif"/></alternatives></disp-formula>
and
<disp-formula id="eqn125"><alternatives><graphic xlink:href="023606_eqn125.gif"/></alternatives></disp-formula></p>
<p>The next-fewest-indel local histories consist of three indels each, and can be broadly classified into four types according to the root sequence state: (G) the histories with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline278.gif"/></alternatives></inline-formula> (H) those with <italic>s</italic><sup>Root</sup> = <italic>s</italic><sub>1</sub> = [<italic>L</italic>, 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>, <italic>R</italic>]; (I) the histories having the root states made from <italic>s</italic><sub>1</sub> by removing a single connected fraction out of the run of sites missing in <italic>s</italic><sub>2</sub>, <italic>i.e</italic>., <italic>s</italic><sup><italic>Root</italic></sup> = [<italic>L</italic>, 1,&#x2026;, <italic>i</italic>&#x2032;, <italic>j</italic>&#x2032;,&#x2026;., &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>, <italic>R</italic>](with <italic>i</italic>&#x2032; &#x2265; <italic>i</italic>, <italic>i</italic>&#x2032;&#x002B;2 &#x2264; <italic>j</italic>&#x2032; &#x2264; <italic>j</italic>, but (<italic>i</italic>&#x2032;, <italic>j</italic>&#x2032;) &#x2260; (<italic>i</italic>, <italic>j</italic>)); and (J) the histories having the root states made by adding some extra sites to <italic>s</italic><sub>1</sub>, <italic>i.e</italic>., <inline-formula><alternatives><inline-graphic xlink:href="023606_inline279.gif"/></alternatives></inline-formula> with <italic>k</italic> = <italic>i</italic>,&#x2026;, <italic>j</italic> &#x2212;1, <inline-formula><alternatives><inline-graphic xlink:href="023606_inline280.gif"/></alternatives></inline-formula> <inline-formula><alternatives><inline-graphic xlink:href="023606_inline281.gif"/></alternatives></inline-formula> for <sup>&#x2200;</sup>a &#x2208;{1,&#x2026;, <italic>l</italic>}, and <inline-formula><alternatives><inline-graphic xlink:href="023606_inline282.gif"/></alternatives></inline-formula> for <sup>&#x2200;</sup><italic>a</italic>&#x2260;<italic>b</italic>(&#x220A; {1,&#x2026;, <italic>l</italic>}). These four broad types are further sub-classified into 10 sub-types in total.</p>
<p>First, type (G) local histories are sub-classified into four sub-types: (G-1) the case where two successive insertions occur along <italic>b</italic><sub>1</sub>, represented as <inline-formula><alternatives><inline-graphic xlink:href="023606_inline283.gif"/></alternatives></inline-formula> with <italic>l</italic> = 1,&#x2026;, <italic>j</italic>&#x2212;<italic>i</italic>&#x2212;2 and <italic>x</italic> = <italic>i</italic>&#x002B;1,&#x2026;, <italic>i</italic>&#x002B;<italic>l</italic>&#x002B;1(<italic>j</italic>&#x2212;<italic>i</italic> &#x2265; 3 must hold); (G-2) the case where a &#x201C;long&#x201D; insertion and a subsequent deletion occur along <italic>b</italic><sub>1</sub>, represented as
<disp-formula id="ueqn4"><alternatives><graphic xlink:href="023606_ueqn4.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline284.gif"/></alternatives></inline-formula> and <italic>x</italic> = <italic>i</italic>&#x002B;2,&#x2026;, <italic>j</italic>&#x002B;1; (G-3) the case where two successive deletions occur along <italic>b</italic><sub>3</sub>, represented as
<disp-formula id="ueqn5"><alternatives><graphic xlink:href="023606_ueqn5.gif"/></alternatives></disp-formula>
with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x2212; <italic>j</italic> &#x002B; <italic>i</italic> and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x2212; <italic>j</italic> &#x002B; <italic>i</italic> &#x2212; l &#x002B; 3 (&#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x2212; <italic>j</italic> &#x002B; <italic>i</italic> &#x2265; 1 must hold)and (G-4) the case where an insertion and a subsequent &#x201C;long&#x201D; deletion occur along <italic>b</italic><sub>3</sub>, represented as
<disp-formula id="ueqn6"><alternatives><graphic xlink:href="023606_ueqn6.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline285.gif"/></alternatives></inline-formula> and <italic>x</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x2212; <italic>j</italic>&#x002B;<italic>i</italic>&#x002B;2.</p>
<p>Second, type (H) local histories are also sub-classified into four sub-types: (H-1) the case where two successive deletions occur along <italic>b</italic><sub>2</sub>, represented as
<disp-formula id="ueqn7"><alternatives><graphic xlink:href="023606_ueqn7.gif"/></alternatives></disp-formula>
with <italic>l</italic> = 1,&#x2026;, <italic>j</italic>&#x2212;<italic>i</italic>&#x2212;2 and <italic>x</italic> = <italic>i</italic>&#x002B;2,&#x2026;, <italic>j</italic>&#x2212;<italic>l</italic>&#x002B;1 (<italic>j</italic>&#x2212;<italic>i</italic>&#x2265;3 must hold); (H-2) the case where an insertion and a subsequent &#x201C;long&#x201D; deletion occur along <italic>b</italic><sub>2</sub>, represented as
<disp-formula id="ueqn8"><alternatives><graphic xlink:href="023606_ueqn8.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline286.gif"/></alternatives></inline-formula> and <italic>x</italic> = <italic>i</italic>&#x002B;1,&#x2026;, <italic>j</italic>; (H-3) the case where two successive deletions occur along <italic>b</italic><sub>3</sub>, represented as
<disp-formula id="ueqn9"><alternatives><graphic xlink:href="023606_ueqn9.gif"/></alternatives></disp-formula>
with <italic>l</italic> = 1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>&#x2212;1 and <italic>x</italic> = 2,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup> &#x2212; <italic>l</italic>&#x002B;2; and (H-4) the case where an insertion and a subsequent &#x201C;long&#x201D; deletion occur along <italic>b</italic><sub>3</sub>, represented as
<disp-formula id="ueqn10"><alternatives><graphic xlink:href="023606_ueqn10.gif"/></alternatives></disp-formula>
with <inline-formula><alternatives><inline-graphic xlink:href="023606_inline287.gif"/></alternatives></inline-formula> and <italic>x</italic>=1,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>&#x002B;1.</p>
<p>Third, type (I) does not need be sub-classified, and each history of this type can be represented as:
<disp-formula id="ueqn11"><alternatives><graphic xlink:href="023606_ueqn11.gif"/></alternatives></disp-formula>
which is determined uniquely from the root state (<italic>s</italic><sup><italic>Root</italic></sup> = [<italic>L</italic>, 1,&#x2026;, <italic>i</italic>&#x2032;, <italic>j</italic>&#x2032;,&#x2026;, &#x0394;<italic>L</italic><sup><italic>D</italic>1</sup>, <italic>R</italic>] with <italic>i</italic>&#x2032;&#x2265;<italic>i</italic>, <italic>i</italic>&#x2032;&#x002B;2 &#x2264; <italic>j</italic>&#x2032; &#x2264; <italic>j</italic>, but also with (<italic>i</italic>&#x2032;, <italic>j</italic>&#x2032;) &#x2260; (<italic>i</italic>, <italic>j</italic>)). Fourth, type (J) does not need be sub-classified, either, and each history of this type can be represented as:
<disp-formula id="ueqn12"><alternatives><graphic xlink:href="023606_ueqn12.gif"/></alternatives></disp-formula>
which, again, is determined uniquely from the root state <inline-formula><alternatives><inline-graphic xlink:href="023606_inline288.gif"/></alternatives></inline-formula>.</p>
<p>Thus, the summed contributions from the next-fewest-indel local histories in case (IV) can be expressed as:
<disp-formula id="eqn126"><alternatives><graphic xlink:href="023606_eqn126.gif"/></alternatives></disp-formula></p>
<p>Here <inline-formula><alternatives><inline-graphic xlink:href="023606_inline289.gif"/></alternatives></inline-formula> (with <italic>X</italic> = <italic>G</italic>&#x2212;1,&#x2026;, <italic>J</italic>) represents the summed contribution from the histories over one of the aforementioned 10 sub-types. Each such term can be calculated by summing the contributions from individual local histories belonging to each sub-type over the possible lengths and possible positions, if necessary. Under a space-homogeneous model, the summation over possible positions will be reduced to the multiplication by the number of possible positions (for each fixed set of lengths). And the contributions from individual local histories can be calculated according to the definition, Eq.(1.1.2b) supplemented by Eqs.(4.2.4b,6b,8) of part I, and taking advantage of, or by slightly modifying, Eqs.(1.2.4,5d,5e) and Eqs.(A1.1.1,2d,2e) for contributions from single-event and two-event local histories for PWAs. In the following, we will give the expressions for the contributions from individual local histories of respective sub-types under Dawg&#x2019;s indel model.</p>
<p>Type (G-1):
<disp-formula id="eqn127"><alternatives><graphic xlink:href="023606_eqn127.gif"/></alternatives></disp-formula></p>
<p>Type (G-2):
<disp-formula id="eqn128"><alternatives><graphic xlink:href="023606_eqn128.gif"/></alternatives></disp-formula></p>
<p>Type (G-3):
<disp-formula id="eqn129"><alternatives><graphic xlink:href="023606_eqn129.gif"/></alternatives></disp-formula></p>
<p>Type (G-4):
<disp-formula id="eqn130"><alternatives><graphic xlink:href="023606_eqn130.gif"/></alternatives></disp-formula></p>
<p>Type (H-1):
<disp-formula id="eqn131"><alternatives><graphic xlink:href="023606_eqn131.gif"/></alternatives></disp-formula></p>
<p>Type (H-2):
<disp-formula id="eqn132"><alternatives><graphic xlink:href="023606_eqn132.gif"/></alternatives></disp-formula></p>
<p>Type (H-3):
<disp-formula id="eqn133"><alternatives><graphic xlink:href="023606_eqn133.gif"/></alternatives></disp-formula></p>
<p>Type (H-4):
<disp-formula id="eqn134"><alternatives><graphic xlink:href="023606_eqn134.gif"/></alternatives></disp-formula></p>
<p>Type (I):
<disp-formula id="eqn135"><alternatives><graphic xlink:href="023606_eqn135.gif"/></alternatives></disp-formula></p>
<p>It should be noted that the right hand side of this equation depends on <italic>i</italic>&#x2032; and <italic>j</italic>&#x2032; only through <italic>l</italic>&#x2032; &#x2261; &#x2212; <italic>j</italic>&#x2032;&#x2212;<italic>i</italic>&#x2032;&#x2212;1. Thus, it follows that there are <italic>j</italic>&#x2212;<italic>i</italic>&#x2212;<italic>l</italic>&#x2032; histories with the same <italic>l</italic>&#x2032; (and therefore the same probability) but with different <italic>i</italic>&#x2032;&#x2019;s (namely, <italic>i</italic>&#x2032; = <italic>i</italic>,&#x2026;, <italic>j</italic>&#x2212;1&#x2212;<italic>l</italic>&#x2032;).
Type (J):
<disp-formula id="eqn136"><alternatives><graphic xlink:href="023606_eqn136.gif"/></alternatives></disp-formula></p>
<p>It should be noted that the right hand side of this equation does not depend on <italic>k</italic> whereas it does depend on <italic>l</italic>. Thus, it follows that there are <italic>j</italic>&#x2212;<italic>i</italic> histories with the same <italic>l</italic> (and therefore the same probability) but with different <italic>k</italic>&#x2019;s (namely, <italic>k</italic> = <italic>i</italic>,&#x2026;, <italic>j</italic>&#x2212;1).</p>
<p>Summing each of Eqs.(A2.4a-j) over the lengths and positions specified above Eq.(A2.3), we obtain <inline-formula><alternatives><inline-graphic xlink:href="023606_inline290.gif"/></alternatives></inline-formula> with <italic>X</italic> = <italic>G</italic>&#x2212;1,&#x2026;, <italic>J</italic>, the summation of which (according to Eq.(A2.3)) gives the total contribution from the next-fewest-indel local histories.</p>
</sec>
</sec>
</app>
</app-group>
<ref-list><title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Benner</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Cohen</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Connet</surname> <given-names>GH</given-names></string-name>. <year>1993</year>. <article-title><bold>Empirical and structural models for insertions/deletions as the major path to genomic divergence.</bold></article-title> <source>J Mol Biol.</source> <volume>229</volume>:<fpage>1065</fpage>&#x2013;<lpage>1082</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bishop</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>EA</given-names></string-name>. <year>1986</year>. <article-title><bold>Maximum likelihood alignment of DNA sequences.</bold></article-title> <source>J. Mol Biol.</source> <volume>190</volume>:<fpage>159</fpage>&#x2013;<lpage>165</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bradley</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>I.</given-names></string-name> <year>2007</year>. <article-title><bold>Transducers: an emerging probabilistic framework for modeling indels on trees.</bold></article-title> <source>Bioinformatics</source> <volume>23</volume>:<fpage>3258</fpage>&#x2013;<lpage>3262</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Britten</surname> <given-names>RJ</given-names></string-name>. <year>2002</year>. <article-title><bold>Divergence between samples of chimpanzee and human DNA sequences is 5&#x0025;, counting indels.</bold></article-title> <source>Proc. Natl. Acad. Sci. USA</source> <volume>99</volume>:<fpage>13633</fpage>&#x2013;<lpage>13635</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Britten</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Rowen</surname> <given-names>L</given-names></string-name>, <string-name><surname>Willians</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cameron</surname> <given-names>RA</given-names></string-name>. <year>2003</year>. <article-title><bold>Majority of divergence between closely related DNA samples is due to indels.</bold></article-title> <source>Proc. Natl. Acad. Sci. USA</source> <volume>100</volume>:<fpage>4661</fpage>&#x2013;<lpage>4665</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Cartwright</surname> <given-names>RA</given-names></string-name>. <year>2005</year>. <article-title><bold>DNA assembly with gap (Dawg): simulating sequence evolution.</bold></article-title> <source>Bioinformatics</source> <volume>21</volume>:<fpage>iii31</fpage>&#x2013;<lpage>iii38</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Cartwright</surname> <given-names>RA</given-names></string-name>. <year>2009</year>. <article-title><bold>Problems and solutions for estimating indel rates and length distribution.</bold></article-title> <source>Mol Biol Evol.</source> <volume>26</volume>:<fpage>473</fpage>&#x2013;<lpage>480</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Chang</surname> <given-names>MSS</given-names></string-name>, <string-name><surname>Benner</surname> <given-names>SA</given-names></string-name>. <year>2004</year>. <article-title><bold>Empirical analysis of protein insertions and deletions determining parameters for the correct placement of gaps in protein sequence alignments.</bold></article-title> <source>J Mol Biol.</source> <volume>341</volume>:<fpage>617</fpage>&#x2013;<lpage>631</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Chindelevitch</surname> <given-names>L.</given-names></string-name> <string-name><surname>Li</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Blais</surname> <given-names>E</given-names></string-name>, <string-name><surname>Blanchette</surname> <given-names>M.</given-names></string-name> <year>2006</year>. <article-title><bold>On the inference of parsimonious evolutionary scenarios.</bold></article-title> <source>J Bioinform Comput Biol.</source> <volume>4</volume>:<fpage>721</fpage>&#x2013;<lpage>744</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="book"><string-name><surname>Dirac</surname> <given-names>PAM</given-names></string-name>. <year>1958</year>. <source>The Principles of Quantum Mechanics, 4th edition</source>. <publisher-loc>London</publisher-loc>, <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="website"><string-name><surname>Ezawa</surname> <given-names>K.</given-names></string-name> <year>2013</year>. <source>LOLIPOG: Log-likelihood for the pattern of gaps in MSA. [</source><ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.org/ftp/pub/lolipog/">http://www.bioinformatics.org/ftp/pub/lolipog/</ext-link>]</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="other"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015a</year>. <source><bold>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part I: Theoretical basis.</bold> (unpublished, to be posted on bioRxiv.</source>)</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="other"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015b</year>. <source><bold>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part III: Algorithm for first approximation.</bold> (unpublished, to be posted on bioRxiv.</source>)</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><surname>Ezawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Landan</surname> <given-names>G.</given-names></string-name> <year>2015c</year>. <source><bold>Perturbative formulation of general continuous-time Markov model of sequence evolution via insertions/deletions, Part IV: Incorporation of substitutions and other mutations.</bold> (unpublished, to be posted on bioRxiv.</source>)</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Fan</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Ma</surname> <given-names>G</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Shi</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Tao</surname> <given-names>S.</given-names></string-name> <year>2007</year>. <article-title><bold>Patterns of insertion and deletion in mammalian genomes.</bold></article-title> <source>Curr Genomics</source> <volume>8</volume>:<fpage>370</fpage>&#x2013;<lpage>378</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1981</year>. <article-title><bold>Evolutionary trees from DNA sequences: a maximum likelihood approach.</bold></article-title> <source>J Mol Evol.</source> <volume>17</volume>:<fpage>368</fpage>&#x2013;<lpage>376</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="book"><string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>2004</year>. <chapter-title><italic>Inferring Phylogenies.</italic> Sunderland (MA), Sinauer Associates</chapter-title>. <person-group person-group-type="editor"><string-name><surname>Gascuel</surname> <given-names>O</given-names></string-name></person-group> (editor). 2005. <source>Mathematics of Evolution and Phylogeny.</source> <publisher-loc>New York</publisher-loc>, <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname> <given-names>DT</given-names></string-name>. <year>1977</year>. <article-title><bold>Exact stochastic simulation of coupled chemical reactions.</bold></article-title> <source>J Phys Chem.</source> <volume>81</volume>:<fpage>2340</fpage>&#x2013;<lpage>2361</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Gonnet</surname> <given-names>GH</given-names></string-name>, <string-name><surname>Cohen</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Benner</surname> <given-names>SA</given-names></string-name>. <year>1992</year>. <article-title><bold>Exhaustive matching of the entire protein sequence database.</bold></article-title> <source>Science</source> <volume>256</volume>:<fpage>1443</fpage>&#x2013;<lpage>1445</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Graur</surname> <given-names>D</given-names></string-name>, <string-name><surname>Li</surname> <given-names>WH</given-names></string-name>. <year>2000</year>. <article-title>Fundamentals of Molecular Evolution</article-title>, <edition>2nd ed</edition>. <source>Sunderland (MA), Sinauer Associates</source>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Gu</surname> <given-names>X</given-names></string-name>, <string-name><surname>Li</surname> <given-names>WH</given-names></string-name>. <year>1995</year>. <article-title><bold>The size distribution of insertions and deletions in human and rodent pseudogenes suggests the logarithmic gap penalty for sequence alignment.</bold></article-title> <source>J Mol Evol.</source> <volume>40</volume>:<fpage>464</fpage>&#x2013;<lpage>473</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Kent</surname> <given-names>WJ</given-names></string-name>, <string-name><surname>Baertsch</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hinrichs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>W</given-names></string-name>, and <string-name><surname>Haussler</surname> <given-names>D.</given-names></string-name> <year>2003</year>. <article-title><bold>Evolution&#x2019;s cauldron: duplication, deletion, and rearrangement in the mouse and human genomes.</bold></article-title> <source>Proc Natl Acad Sci USA</source> <volume>100</volume>:<fpage>11484</fpage>&#x2013;<lpage>11489</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sinha</surname> <given-names>S.</given-names></string-name> <year>2007</year>. <article-title><bold>Indelign: a probabilistic framework for annotation of insertions and deletions in a multiple alignment.</bold></article-title> <source>Bioinformatics</source> <volume>23</volume>:<fpage>289</fpage>&#x2013;<lpage>297</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Knudsen</surname> <given-names>B</given-names></string-name>, <string-name><surname>Miyamoto</surname> <given-names>MM</given-names></string-name>. <year>2003</year>. <article-title><bold>Sequence alignments and pair hidden Markov models using evolutionary history.</bold></article-title> <source>J Mol Biol.</source> <volume>333</volume>:<fpage>453</fpage>&#x2013;<lpage>460</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Lunter</surname> <given-names>G.</given-names></string-name> <year>2007</year>. <article-title><bold>Probabilistic whole-genome alignments reveal high indel rates in the human and mouse genomes.</bold></article-title> <source>Bioinformatics</source> <volume>23</volume>:<fpage>i289</fpage>&#x2013;<lpage>i296</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Lunter</surname> <given-names>GA</given-names></string-name>, <string-name><surname>Mikl&#x00F3;s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Drummond</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jensen</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Hein</surname> <given-names>J.</given-names></string-name> <year>2005</year>. <article-title><bold>Bayesian coestimation of phylogeny and sequence alignment.</bold></article-title> <source>BMC Bioinformatics</source> <volume>6</volume>:<fpage>83</fpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Lynch</surname> <given-names>M.</given-names></string-name> <year>2007</year>. <source>The Origins of Genome Architecture. Sunderland (MA), Sinauer Associates.</source></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Metzler</surname> <given-names>D.</given-names></string-name> <year>2003</year>. <article-title><bold>Statistical alignment based on fragment insertion and deletion models.</bold></article-title> <source>Bioinformatics</source> <volume>19</volume>:<fpage>490</fpage>&#x2013;<lpage>499</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Messiah</surname> <given-names>A.</given-names></string-name> <year>1961a</year>. <source>Quantum Mechanics, Volume 1. (Translated from French to English by Temmer GM). Amsterdam, North-Holland.</source></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Messiah</surname> <given-names>A.</given-names></string-name> <article-title>1961b</article-title>. <source>Quantum Mechanics, Volume II. (Translated from French to English by Potter J). Amsterdam, North-Holland.</source></mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Mikl&#x00F3;s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Lunter</surname> <given-names>GA</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>I.</given-names></string-name> <year>2004</year>. <article-title><bold>A &#x201C;long indel&#x201D; model for evolutionary sequence alignment.</bold></article-title> <source>Mol Biol Evol.</source> <volume>21</volume>:<fpage>529</fpage>&#x2013;<lpage>540</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Mikl&#x00F3;s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Nov&#x00E1;k</surname> <given-names>&#x00C1;</given-names></string-name>, <string-name><surname>Satija</surname> <given-names>R</given-names></string-name>, <string-name><surname>Lyngs&#x00F8;</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hein</surname> <given-names>J.</given-names></string-name> <year>2009</year>. <article-title><bold>Stochastic models of sequence evolution including insertion-deletion events.</bold></article-title> <source>Stat Methods Med Res.</source> <volume>18</volume>:<fpage>453</fpage>&#x2013;<lpage>485</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="book"><string-name><surname>Press</surname> <given-names>WH</given-names></string-name>, <string-name><surname>Teukolsky</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Vetterling</surname> <given-names>WT</given-names></string-name>, <string-name><surname>Flannery</surname> <given-names>BP</given-names></string-name>. <year>1992</year>. <source>Numerical Recipes in C: The Art of Scientific Computing, 2nd edition.</source> <publisher-loc>Cambridge (UK</publisher-loc>), <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Rivas</surname> <given-names>E.</given-names></string-name> <year>2005</year>. <article-title><bold>Evolutionary models for insertions and deletions in a probabilistic modeling framework.</bold></article-title> <source>BMC Bioinformatics</source> <volume>6</volume>:<fpage>63</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><collab>The Chimpanzee Sequencing and Analysis Consortium</collab>. <year>2005</year>. <article-title><bold>Initial sequence of the chimpanzee genome and comparison with the human genome.</bold></article-title> <source>Nature</source> <volume>437</volume>:<fpage>69</fpage>&#x2013;<lpage>87</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><collab>The International Chimpanzee Chromosome 22 Consotrium</collab>. <year>2004</year>. <article-title><bold>DNA sequence and comparative analysis of chimpanzee chromosome 22</bold></article-title>. <source>Nature</source> <volume>429</volume>:<fpage>382</fpage>&#x2013;<lpage>388</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Thorne</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Kishino</surname> <given-names>H</given-names></string-name>, <string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1991</year>. <article-title><bold>An evolutionary model for maximum likelihood alignment of DNA sequences.</bold></article-title> <source>J Mol Evol.</source> <volume>33</volume>:<fpage>114</fpage>&#x2013;<lpage>124</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Thorne</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Kishino</surname> <given-names>H</given-names></string-name>, <string-name><surname>Felsenstein</surname> <given-names>J.</given-names></string-name> <year>1992</year>. <article-title><bold>Inching toward reality: an improved likelihood model of sequence evolution.</bold></article-title> <source>J Mol Evol.</source> <volume>34</volume>:<fpage>3</fpage>&#x2013;<lpage>16</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Yamane</surname> <given-names>K</given-names></string-name>, <string-name><surname>Yano</surname> <given-names>K</given-names></string-name>, <string-name><surname>Kawahara</surname> <given-names>T.</given-names></string-name> <year>2006</year>. <article-title><bold>Pattern and rate of indel evolution inferred from whole chloroplast intergenic regions in sugarcane, maize and rice.</bold></article-title> <source>DNA Res.</source> <volume>13</volume>:<fpage>197</fpage>&#x2013;<lpage>204</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="book"><string-name><surname>Yang</surname> <given-names>Z.</given-names></string-name> <year>2006</year>. <source>Computational Molecular Evolution.</source> <publisher-loc>New York (NY)</publisher-loc>, <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname> <given-names>ZL</given-names></string-name>, <string-name><surname>Gerstein</surname> <given-names>M.</given-names></string-name> <year>2003</year>. <article-title><bold>Patterns of nucleotide substitution, insertion and deletion in the human genome inferred from pseudogenes.</bold></article-title> <source>Nucleic Acids Res.</source> <volume>31</volume>:<fpage>5338</fpage>&#x2013;<lpage>5348</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
