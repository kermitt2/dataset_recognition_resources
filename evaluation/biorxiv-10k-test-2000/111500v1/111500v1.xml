<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/111500</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Epidemiology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>PHESANT: a tool for performing automated phenome scans in UK Biobank</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Millard</surname><given-names>Louise A C</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">a</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Davies</surname><given-names>Neil M</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Gaunt</surname><given-names>Tom R</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Davey Smith</surname><given-names>George</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Tilling</surname><given-names>Kate</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>MRC Integrative Epidemiology Unit (IEU), School of Social and Community Medicine, University of Bristol</institution>, <country>Bristol</country></aff>
<aff id="a2"><label>2</label><institution>Intelligent Systems Laboratory, Department of Computer Science, University of Bristol</institution>, <country>UK</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="other"><label>a</label><p>Email: <email>louise.millard@bristol.ac.uk</email></p></fn>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>111500</elocation-id>
<history>
<date date-type="received"><day>26</day><month>2</month><year>2017</year></date>
<date date-type="accepted"><day>26</day><month>2</month><year>2017</year></date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="111500.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<sec>
<title>Motivation</title>
<p>Epidemiological cohorts typically contain a diverse set of phenotypes such that automation of phenome scans is non-trivial, because they require highly heterogeneous models. For this reason, phenome scans have to date tended to use a smaller homogeneous set of phenotypes that can be analysed in a consistent fashion. We present PHESANT (PHEnome Scan ANalysis Tool), a software package for performing comprehensive phenome scans in UK Biobank.</p>
</sec>
<sec>
<title>General features</title>
<p>PHESANT tests the association of a specified trait with all continuous, integer and categorical variables in UK Biobank, or a specified subset. PHESANT uses a novel rule-based algorithm to determine how to appropriately test each trait, then performs the analyses and produces plots and summary tables.</p>
</sec>
<sec>
<title>Implementation</title>
<p>The PHESANT phenome scan is implemented in R. PHESANT includes a novel Javascript D3.js visualization, and accompanying Java code that converts the phenome scan results to the required JavaScript Object Notation (JSON) format.</p>
</sec>
<sec>
<title>AVAILABILITY</title>
<p>PHESANT is available on GitHub at [<ext-link ext-link-type="uri" xlink:href="https://github.com/MRCIEU/PHESANT">https://github.com/MRCIEU/PHESANT</ext-link>]. Git tag v0.2 corresponds to the version presented here.</p>
</sec>
</abstract>
<counts>
<page-count count="19"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>INTRODUCTION</title>
<p>Phenome scans test the association of a trait of interest with a comprehensive array of phenotypes (the &#x201C;phenome&#x201D;). Types of phenome scans include phenome-wide association studies (pheWAS) (<xref ref-type="bibr" rid="c1">1</xref>), Mendelian randomization-pheWAS (MR-pheWAS) (<xref ref-type="bibr" rid="c2">2</xref>) and environment-wide association studies (EnWAS) (<xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref>). PheWAS seek to investigate the association of a genetic variant with a set of phenotypic traits (<xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c5">5</xref>). A recent extension to pheWAS, MR-pheWAS, uses Mendelian randomization (MR) in a pheWAS framework in order to search for the causal effects of a particular exposure (<xref ref-type="bibr" rid="c2">2</xref>). EnWAS seek to test the associations of a trait of interest with a set of other phenotypes (<xref ref-type="bibr" rid="c3">3</xref>).</p>
<p>Epidemiological cohorts usually contain a large number of diverse phenotypes, such that testing the association of these phenotypes with another trait in an automated way is nontrivial. For this reason, researchers wishing to perform a phenome scan will typically specify a homogeneous subset of traits, in order to automate the tests of association across these traits in a consistent way. For instance, pheWAS initially started using international classification of disease (ICD) codes from electronic health records, where each disease code could be treated as a binary variable and a consistent test performed (<xref ref-type="bibr" rid="c5">5</xref>). However, restricting the set of phenotypes provides only a partial view of associations with a trait of interest, and reduces the potential to identify novel associations.</p>
<p>In this paper we present PHESANT (PHEnome Scan ANalysis Tool), a parallelizable tool for phenome scans in UK Biobank, a prospective cohort of over 500 000 men and women in the UK aged between 37&#x2013;73 years (<xref ref-type="bibr" rid="c6">6</xref>). This cohort includes genetic data, and a large and diverse range of data from blood, urine and saliva samples analyses, clinical assessments, record linkage and health and lifestyle questionnaires. The diversity of traits available coupled with the large sample size provides an opportunity to identify novel associations with phenome scans.</p>
</sec>
<sec id="s2">
<title>IMPLEMENTATION</title>
<p>PHESANT is implemented in R and requires the following R packages: optparse, MASS, lmtest, nnet and forestplot (see GitHub repository for package versions). PHESANT takes one data file as input containing the set of phenotypes and the trait of interest, which may be a SNP, a genetic score or a phenotypic trait depending on whether a pheWAS, MR-pheWAS or EnWAS is being performed (the trait of interest can alternatively be provided as a separate file if this is preferred). PHESANT also makes use of two data files that contain information about the variables in the UK Biobank cohort: 1) a data coding information file, and 2) a variable information file. These files have been set up for the example we describe in the usage section, but can be changed as needed for each particular phenome scan. For more information on the PHESANT data and information files see the documentation in the GitHub repository. In the rest of this section we describe the variable processing flow used in PHESANT.</p>
<sec id="s2a">
<title>Automated processing flow to determine variable coding</title>
<p>In order to test the association of the trait of interest with the diverse range of phenotypes in UK Biobank in an automated manner, we developed a rule-based system to determine the appropriate coding of each variable and hence test of association to use. These rules are shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> and described in full in the Supplementary section S1. The decision rules start with the variable <italic>field</italic> type (as specified by UK Biobank at [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/list.cg">http://biobank.ctsu.ox.ac.uk/showcase/list.cgi</ext-link>]), either continuous, integer, categorical (single) or categorical (multiple), and categorise each variable as one of four <italic>data</italic> types: continuous, ordered categorical, unordered categorical and binary. The categorical <italic>(single)</italic> field type refers to categorical fields (including binary) where each participant can only have one value. For example, by questionnaire participants were asked &#x201C;How would you describe your usual walking pace?&#x201D; with options including &#x201C;slow&#x201D;, &#x201C;average&#x201D; and &#x201C;brisk&#x201D; (field ID&#x003D;924; see Supplementary figure 1). In contrast, categorical <italic>(multiple)</italic> fields can have multiple values per participant. For example, by questionnaire participants were asked what types of bread they ate the previous day (field ID&#x003D;20091; see Supplementary figure 2) and could, for instance, select both white and wholemeal options. Where a field is measured at several time points we use the first occurrence only (see Supplementary section S2 for details). Continuous and integer variables may have more than one measurement at this first measured time point (typically to improve the estimate of a measurement). For instance, spirometry was measured two or three times a few moments apart (see for example field 3062 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=3062">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=3062</ext-link>]). When this is the case we take the mean to create a single value per participant (see Supplementary section S2 for details).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Variable processing flow diagram showing logic from defined field type specified by UK Biobank to test of association</title>
<p>Pink triangular nodes at top of figure are field types defined by UK Biobank. Blue rectangular nodes show processing logic used to determine the data type assignment (yellow, oval) &#x2013; either: continuous, ordered categorical, unordered categorical and binary, and hence finally, the type of test used: linear, ordinal logistic, multinomial logistic and logistic regression, respectively. Grey rectangular nodes show points where variables may be removed.</p></caption><graphic xlink:href="111500_fig1.tif"/></fig>
<p>Variables with the continuous field type are usually assigned to the continuous data type. In this case, the variable is transformed to a normal distribution using an inverse normal rank transformation. In a minority of cases, continuous fields are assigned to the ordered categorical data type (or binary if there are only two distinct values). For example, field 100022 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=100022">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=100022</ext-link>] contains the estimated alcohol intake based on responses to the &#x201C;diet by 24-hour recall&#x201D; questionnaire. A large proportion of the participants have a zero value for this field, because they consumed no alcohol. It is not possible to inverse normal rank transform this variable because where a large number of participants have the same value the rank assigned in this transformation is random among these, and this would add noise to the data. Instead, we transform this variable into three categories with roughly the same number of participants in each (placing split points between distinct values), and treat it as an ordered categorical variable (see algorithm in Supplementary section S3). Variables with the integer field type are usually treated exactly the same as the continuous variables. In a minority of cases, where there are 20 or fewer distinct values we treat this variable as ordered categorical (or binary if there are only two distinct values).</p>
<p>Categorical (single) variables may be assigned to the binary, ordered categorical or unordered categorical data types. UK Biobank consistently assigns negative values to categories denoting missingness (such as &#x201C;Preferred not to answer&#x201D; and &#x201C;Do not know&#x201D;), and so we recode negative values to NA. UK Biobank defines &#x2018;data codes&#x2019; to which one or more fields are assigned, and these define the set of categorical values for these fields and their corresponding numeric values. The PHESANT data-coding information file specifies whether a data code of a categorical (single) field defines an ordered or unordered category structure, and we use this information to assign each non-binary categorical (single) field as either an ordered or unordered categorical data type.</p>
<p>Each categorical (multiple) variable is converted to a set of binary variables, each denoting whether a participant has a given value of this variable. For example, for the variable describing the bread eaten yesterday (field ID&#x003D;20091; Supplementary figure 2), with values &#x2018;white&#x2019;, &#x2018;mixed&#x2019;, &#x2018;wholemeal&#x2019;, &#x2018;seeded&#x2019; and &#x2018;other&#x2019;, we generate 5 binary variables, white&#x003D;&#x007B;true,false&#x007D;, wholemeal&#x003D;&#x007B;true,false&#x007D; and so forth. Categorical (multiple) fields have an added complexity because when a person has no value in this field this may be because: 1) the field values are <italic>incomplete</italic> &#x2013; they do not contain all possible values (e.g. a participant who does not eat bread cannot choose any option above) or 2) because the data is missing (e.g. because a participant did not answer this particular question). This affects who we assign as, for instance, &#x2018;white&#x003D;false&#x2019;, either 1) all people who selected a value other than &#x2018;white&#x2019;, 2) all people who responded to this questionnaire and did not select &#x2018;white&#x2019; or 3) all people who did not select &#x2018;white&#x2019; including those who did not respond to the questionnaire (see Supplementary figure 3 for illustration). In this case the second option might be preferred such that we are comparing those who ate white bread with those who responded to the questionnaire but did not eat white bread. This decision is variable specific, and can be specified in the PHESANT variable information file (the variable information file we used for the example described in the next section is available in the GitHub repository). For more details see Supplementary material section S1.</p>
<p>Some categorical multiple fields include negative numeric values for particular categories denoting missingness (such as &#x201C;Do not know&#x201D;). We exclude all participants with a missing value from the <italic>false</italic> value of the generated binary variable, because we cannot know if they do or do not pertain to the <italic>true</italic> value of this binary variable. For example, consider field 41228 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=41228">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=41228</ext-link>] describing the type of medical professional who conducted the delivery of a participant&#x2019;s child, and a participant who has given birth twice and has values &#x201C;midwife&#x201D; and &#x201C;not known&#x201D; in this field. The generated binary variable for midwife includes this participant in the set of participants corresponding to <italic>midwife&#x003D;true</italic> because we know that on at least one occasion a midwife conducted the delivery. However, we cannot be certain that a hospital doctor did not conduct a delivery for this participant because the &#x201C;not known&#x201D; value could refer to a &#x201C;hospital doctor&#x201D;. Hence, the generated &#x201C;hospital doctor&#x201D; binary variable would not include this participant in the set of participants corresponding to <italic>hospital_doctor&#x003D;false,</italic> because this is not known.</p>
</sec>
<sec id="s2b">
<title>Tests of association with trait of interest</title>
<p>The association of each phenotype, having been appropriately coded and assigned one of the four data types (continuous, ordered categorical, unordered categorical and binary), is tested with the trait of interest as follows. The phenotype and the trait of interest are the dependent and independent variables of the regression, respectively. All regressions are adjusted for age at recruitment and sex (and also genotype chip when the trait of interest is genetic, derived from the genotype measurement batch). We test the association with the transformed variables of the continuous data type using linear regression (lm R function). Ordered categorical, unordered categorical and binary variables are tested using ordered logistic regression (polr R function), multinomial logistic regression (multinom R function) and binomial regression (glm R function with family parameter as binomial), respectively. We do not test phenotypes where the sample size is fewer than 500, which typically occurs for a minority of fields such as follow up questions on a subsample (e.g. field 22148 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=22148">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=22148</ext-link>]). We do not test unordered categorical variables with more than 1000 categories (above the default maximum of the multinom function), which occurs once in our usage example (for field 132 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132</ext-link>]).</p>
</sec>
<sec id="s2c">
<title>Customising a phenome scan with PHESANT</title>
<p>PHESANT allows researchers to easily customise the phenome scan by changing settings in the data coding and variable information files. This includes:
<list list-type="bullet">
<list-item>
<p>Changing the numeric values underlying a variable (such as recoding a value to missing) or the ordering of values for ordered categorical variables.</p>
</list-item>
<list-item>
<p>Assigning a default value to categorical (single) variables where this is not explicitly coded in the variable (see Supplementary section S1).</p>
</list-item>
<list-item>
<p>Changing fields from the categorical (single) to the categorical (multiple) field type, as this may be more appropriate for a small number of fields.</p>
</list-item>
<list-item>
<p>Specifying which variables should be excluded a priori from the phenome scan.</p>
</list-item>
<list-item>
<p>Specifying which fields in the phenome dataset are essentially the same phenotype as the trait of interest (e.g. weight and body mass index (BMI)), such that, after the phenome scan is run, the results of association between these fields and the trait of interest are used for validation only, rather than being included in the results and adding to the multiple testing burden.</p>
</list-item>
</list></p>
</sec>
<sec id="s2d">
<title>PHESANT-viz: a web-based visualization for phenome scans</title>
<p>Reviewing the results from phenome scans can be challenging due to the number and complexity of phenotypes. As part of PHESANT we have also developed PHESANT-viz, a D3 Javascript visualization that displays phenome scan results as an interactive graph, using the hierarchical field category structure defined by UK Biobank (available at [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/label.cgi">http://biobank.ctsu.ox.ac.uk/showcase/label.cgi</ext-link>]). PHESANT includes a Java program to convert the phenome scan results to the JavaScript Object Notation (JSON) format required for PHESANT-viz. We provide the PHESANT-viz of our usage example below.</p>
</sec>
</sec>
<sec id="s3">
<title>USAGE</title>
<p>To demonstrate PHESANT we have performed a MR-pheWAS, to search for the causal effects of BMI in UK Biobank (previously performed in a smaller cohort with continuous phenotypes only (2)). Such an analysis is predicated on the Mendelian randomization principle that genetic variants can be used as instrumental variables to estimate causal effects of the phenotype they proxy for on downstream outcomes (<xref ref-type="bibr" rid="c7">7</xref>). In the current context this would be a screening exercise to identify associations for detailed follow-up. This analysis is preliminary and for example only, having been run on a non-random subsample of 114 963 participants (containing the UK BILEVE samples selected on smoking status; see Supplementary section S4 for details) for which genetic data is currently available in UK Biobank (a final analysis will be subsequently published upon release of the full 500 000 sample with genetic data).</p>
<p>We created an allele score from 96 genetic variants previously found to be associated with BMI, in a recent genome-wide association study (GWAS) meta-analysis (<xref ref-type="bibr" rid="c8">8</xref>). The score was calculated as a sum of the number of BMI-increasing alleles, weighted by the effect size as reported in (<xref ref-type="bibr" rid="c8">8</xref>) (see Supplementary table 1). Hence, a higher genetic score corresponds to a tendency towards higher BMI (F-statistic&#x003D;1979). We used PHESANT to test the association of the BMI genetic score with the 290 integer, 1030 continuous, 658 categorical (single) and 99 categorical (multiple) fields available in UK Biobank at the current time (excluding 66 fields a priori, see Supplementary table 2). Supplementary figure 4 shows the number of variables reaching each stage of our variable processing flow.</p>
<p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows the QQ plot of our MR-pheWAS results (see full results ranking in Supplementary data table, and forest plots in Supplementary figure 5). Of the 12 819 tests performed (excluding 87 phenotypes tested but specified a priori as being aspects of the same essential phenotype as BMI), 86 were associated at a Bonferroni corrected P value threshold of 3.90&#x00D7;10<sup>-6</sup> (0.05/12819). We detected several known effects of BMI, for example with hypertension (<xref ref-type="bibr" rid="c9">9</xref>) (fields 41204 value I10, and 4079), diabetes (<xref ref-type="bibr" rid="c10">10</xref>) (field 2443) and age at puberty in both sexes (<xref ref-type="bibr" rid="c11">11</xref>) (fields 2714, 2375 and 2385). For instance, a 1 standard deviation (SD) increase in BMI allele score was associated with a 1.09-fold [95&#x0025; confidence interval (CI): 1.06, 1.11] higher odds of being diagnosed with hypertension in hospital (field 41204 value I10), and a 0.015 SD [95&#x0025; CI: 0.010, 0.021] higher diastolic blood pressure (field 4079). We also detected a number of potentially causal associations that were previously unknown. For example, participants with a genetic propensity to higher BMI were less likely to perceive themselves as a nervous person (field 1970) or to call themselves tense or &#x2018;highly strung&#x2019; (field 1990).</p>
<p>The PHESANT-viz of these preliminary results can be found at [datamining.org.uk/PHESANT/] or within the PHESANT package. When this analysis is performed using the full 500 000 sample the power to detect associations will increase, and it is also likely that the number of tests will increase as fewer variables will be filtered out in the variable processing steps (due to a small sample size). This preliminary analysis took approximately 81 hours (using a 1 core Intel E5-2670).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>QQ plot of preliminary MR-pheWAS analysis seeking to identify the causal effects of BMI</title>
<p>Green dashed line: Bonferroni corrected threshold p&#x003D; 3.90 x 10<sup>-6</sup> (p&#x003D;0.05 corrected for 12 819 tests). Blue dotted line: actual &#x003D; expected.</p></caption><graphic xlink:href="111500_fig2.tif"/></fig>
</sec>
<sec id="s4">
<title>DISCUSSION</title>
<p>PHESANT enables researchers to perform a comprehensive phenome scan in UK Biobank, including a pheWAS, MR-pheWAS or EnWAS. While GWAS have been highly successful at identifying novel associations, we are currently only just beginning to explore the phenome in a hypothesis-free manner (<xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c12">12</xref>). In contrast to hypothesis-driven analyses, phenome scans allow exploration across hypotheses without strong priors, and should help to avoid publication bias as analyses are pre-specified and all results, not just the most &#x2018;statistically significant&#x2019;, are published together.</p>
<p>When undertaking a phenome scan there are several important considerations. First, phenome scans are a screening exercise to identify potentially interesting associations that should then be analysed more rigorously - and as such the effect estimates should be interpreted with caution. The strength of the strongest associations identified may be inflated due to the winners curse. Second, it is important to consider the number of tests performed when examining the strength of identified associations. In our usage example we used a conservative Bonferroni corrected threshold to identify potentially interesting associations, which, while reducing the type I error rate is likely to increase the type II error rate. Third, interpretation of potentially hundreds of results is challenging because the correlated structure of phenotypes means that associations between the trait of interest and each phenotype are not independent. The strongest associations should not be viewed in isolation but alongside the results of related variables for which an association may not have been identified, and to do this we provide a novel visualization approach, PHESANT-viz.</p>
<p>We note the following limitations and areas of future work. It is possible that in some cases our automated rule-based method may deal with variables inappropriately. For example, field 132 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132</ext-link>], which describes participant&#x2019;s jobs, is treated as an unordered categorical variable but was removed from our phenome scan because it has more than 1000 categories. In this case, it may be preferable to use the hierarchical structure defined by UK Biobank to combine categories of related jobs.</p>
<p>PHESANT uses the first time point of a field where multiple time points are available. In future work we will investigate how to automate the analysis including data from multiple time points and the potential gains that this would give (<xref ref-type="bibr" rid="c13">13</xref>). Currently, when continuous variables are converted to the ordered categorical data type we arbitrarily chose to generate three categories, and in future work with will investigate whether a larger number of categories are beneficial, and whether the optimal number of categories can be calculated from the distribution of the variable. PHESANT is specifically designed for use in UK Biobank, but a cohort-independent tool for phenome scans would be highly valuable. Hence, in the future we will aim to adapt PHESANT for use in a general setting. Finally, we intend to integrate PHESANT with MR-base (<xref ref-type="bibr" rid="c14">14</xref>), to enable automated construction of genetic instrumental variables to use in MR-pheWAS.</p>
<p>The large number of participants combined with the extensive range of phenotypes available in UK Biobank provides a great opportunity to comprehensively search for novel (potentially causal) associations in a hypothesis-free manner. We are aware of only one very small phenome scan that has been performed in UK Biobank to date (<xref ref-type="bibr" rid="c15">15</xref>), and a recent novel Bayesian approach of self-reported diagnoses and hospital episodes (<xref ref-type="bibr" rid="c16">16</xref>). To our knowledge, PHESANT is the first open source package to automate phenome scans across diverse sets of phenotypes.</p>
</sec>
</body>
<back>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Denny</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bastarache</surname> <given-names>L</given-names></string-name>, <string-name><surname>Roden</surname> <given-names>DM</given-names></string-name>. <article-title>Phenome-Wide Association Studies as a Tool to Advance Precision Medicine</article-title>. <source>Annu Rev Genomics Hum Genet</source>. <year>2016</year>;<volume>17</volume>:<fpage>353</fpage>&#x2013;<lpage>73</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="book"><string-name><surname>Millard</surname> <given-names>LAC</given-names></string-name>, <string-name><surname>Davies</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Timpson</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Tilling</surname> <given-names>K</given-names></string-name>, <string-name><surname>Flach</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Davey Smith</surname> <given-names>G.</given-names></string-name> <chapter-title>MR-PheWAS: hypothesis prioritization among potential causal effects of body mass index on many outcomes, using Mendelian randomization</chapter-title>. <source>Sci Rep</source>. <publisher-name>Nature Publishing Group</publisher-name>; <year>2015</year> Jan 16;<volume>5</volume>:<fpage>16645</fpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Tzoulaki</surname> <given-names>I</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>C</given-names></string-name>, <string-name><surname>Okamura</surname> <given-names>T</given-names></string-name>, <string-name><surname>Chan</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>I</given-names></string-name>, <string-name><surname>Miura</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <article-title>A nutrient-wide association study on blood pressure</article-title>. <source>Circulation</source>. <year>2012</year>;<volume>126</volume>(<issue>21</issue>):<fpage>2456</fpage>&#x2013;<lpage>64</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="book"><string-name><surname>Patel</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Bhattacharya</surname> <given-names>J</given-names></string-name>, <string-name><surname>Butte</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Schwartz</surname> <given-names>D</given-names></string-name>, <string-name><surname>Collins</surname> <given-names>F</given-names></string-name>, <string-name><surname>Hirschhorn</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <chapter-title>An Environment-Wide Association Study (EWAS) on Type 2 Diabetes Mellitus</chapter-title>. <person-group person-group-type="editor"><string-name><surname>Zhang</surname> <given-names>B</given-names></string-name></person-group>, editor. <source>PLoS One</source>. <publisher-name>Public Library of Science</publisher-name>; <year>2010</year> May 20;<volume>5</volume>(<issue>5</issue>):<fpage>e10746</fpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Denny</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ritchie</surname> <given-names>M</given-names></string-name>, <string-name><surname>Basford</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pulley</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bastarache</surname> <given-names>L</given-names></string-name>, <string-name><surname>Brown-Gentry</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <article-title>PheWAS: demonstrating the feasibility of a phenome-wide scan to discover gene-disease associations</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>9</issue>):<fpage>1205</fpage>&#x2013;<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Allen</surname> <given-names>N</given-names></string-name>, <string-name><surname>Sudlow</surname> <given-names>C</given-names></string-name>, <string-name><surname>Downey</surname> <given-names>P</given-names></string-name>, <string-name><surname>Peakman</surname> <given-names>T</given-names></string-name>, <string-name><surname>Danesh</surname> <given-names>J</given-names></string-name>, <string-name><surname>Elliott</surname> <given-names>P</given-names></string-name>, <etal>et al.</etal> <article-title>UK Biobank: Current status and what it means for epidemiology</article-title>. <source>Heal Policy Technol</source>. <year>2012</year>; <volume>1</volume>(<issue>3</issue>): <fpage>123</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Davey Smith</surname> <given-names>G</given-names></string-name>, <string-name><surname>Ebrahim</surname> <given-names>S.</given-names></string-name> <article-title>&#x201C;Mendelian randomization&#x201D;: can genetic epidemiology contribute to understanding environmental determinants of disease?</article-title> <source>Int J Epidemiol</source>. <year>2003</year> Feb;<volume>32</volume>(<issue>1</issue>):<fpage>1</fpage>&#x2013;<lpage>22</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Locke</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kahali</surname> <given-names>B</given-names></string-name>, <string-name><surname>Berndt</surname> <given-names>S</given-names></string-name>, <string-name><surname>Justice</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pers</surname> <given-names>TH</given-names></string-name>, <string-name><surname>Day</surname> <given-names>FR</given-names></string-name>, <etal>et al.</etal> <article-title>Genetic studies of body mass index yield new insights for obesity biology</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7538</issue>):<fpage>197</fpage>&#x2013;<lpage>206</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Timpson</surname> <given-names>N</given-names></string-name>, <string-name><surname>Harbord</surname> <given-names>R</given-names></string-name>, <string-name><surname>Davey Smith</surname> <given-names>G</given-names></string-name>, <string-name><surname>Zacho</surname> <given-names>J</given-names></string-name>, <string-name><surname>Tybj&#x00E6;rg-Hansen</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nordestgaard</surname> <given-names>BG</given-names></string-name>. <article-title>Does greater adiposity increase blood pressure and hypertension risk? Mendelian randomization using the FTO/MC4R genotype</article-title>. <source>Hypertension</source>. <year>2009</year>;<volume>54</volume>(<issue>1</issue>):<fpage>84</fpage>&#x2013;<lpage>90</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Holmes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lange</surname> <given-names>L</given-names></string-name>, <string-name><surname>Palmer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lanktree</surname> <given-names>M</given-names></string-name>, <string-name><surname>North</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Almoguera</surname> <given-names>B</given-names></string-name>, <etal>et al.</etal> <article-title>Causal effects of body mass index on cardiometabolic traits and events: a Mendelian randomization analysis</article-title>. <source>Am J Hum Genet</source>. <year>2014</year>;<volume>94</volume>(<issue>2</issue>):<fpage>198</fpage>&#x2013;<lpage>208</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Mumby</surname> <given-names>H</given-names></string-name>, <string-name><surname>Elks</surname> <given-names>C</given-names></string-name>, <string-name><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sharp</surname> <given-names>S</given-names></string-name>, <string-name><surname>Khaw</surname> <given-names>K-T</given-names></string-name>, <string-name><surname>Luben</surname> <given-names>RN</given-names></string-name>, <etal>et al.</etal> <article-title>Mendelian randomisation study of childhood BMI and early menarche</article-title>. <source>J Obes</source>. <year>2011</year>;<fpage>2011</fpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>VanderWeele</surname> <given-names>T</given-names></string-name>. <article-title>Outcome-wide Epidemiology</article-title>. <source>Epidemiology</source>. <year>2017</year>;</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Cao</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Rajan</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>P</given-names></string-name>. <article-title>Mendelian randomization analysis of a time-varying exposure for binary disease outcomes using functional data analysis methods</article-title>. <source>Genet Epidemiol</source>. <year>2016</year> Dec;<volume>40</volume>(<issue>8</issue>):<fpage>744</fpage>&#x2013;<lpage>55</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Hemani</surname> <given-names>G</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wade</surname> <given-names>KH</given-names></string-name>, <string-name><surname>Laurin</surname> <given-names>C</given-names></string-name>, <string-name><surname>Elsworth</surname> <given-names>B</given-names></string-name>, <string-name><surname>Burgess</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>MR-Base: a platform for systematic causal inference across the phenome using billions of genetic associations</article-title>. <source>bioRxiv</source>. <year>2016</year>;</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Emdin</surname> <given-names>C</given-names></string-name>, <string-name><surname>Khera</surname> <given-names>A</given-names></string-name>, <string-name><surname>Natarajan</surname> <given-names>P</given-names></string-name>, <string-name><surname>Klarin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Won</surname> <given-names>H-H</given-names></string-name>, <string-name><surname>Peloso</surname> <given-names>GM</given-names></string-name>, <etal>et al.</etal> <article-title>Phenotypic characterization of genetically lowered human lipoprotein (a) levels</article-title>. <source>J Am Coll Cardiol</source>. <year>2016</year>;<volume>68</volume>(<issue>25</issue>):<fpage>2761</fpage>&#x2013;<lpage>72</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Cortes</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dendrou</surname> <given-names>C</given-names></string-name>, <string-name><surname>Motyer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jostins</surname> <given-names>L</given-names></string-name>, <string-name><surname>Vukcevic</surname> <given-names>D</given-names></string-name>, <string-name><surname>Dilthey</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Bayesian analysis of genetic association across tree-structured routine healthcare data in the UK Biobank</article-title>. <source>bioRxiv</source>. <year>2017</year>;</mixed-citation></ref>
</ref-list>
<sec>
<title>Funding</title>
<p>This work was supported by the University of Bristol and UK Medical Research Council [grant numbers MC_UU_12013/1, MC_UU_12013/8 and MC_UU_12013/9].</p>
</sec>
</back>
</article>