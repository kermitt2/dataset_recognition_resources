<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/232835</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Pathway enrichment analysis of -<italic>omics</italic> data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Reimand</surname><given-names>J&#x00FC;ri</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Isserlin</surname><given-names>Ruth</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Voisin</surname><given-names>Veronique</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kucera</surname><given-names>Mike</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tannus-Lopes</surname><given-names>Christian</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rostamianfar</surname><given-names>Asha</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wadi</surname><given-names>Lina</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Meyer</surname><given-names>Mona</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wong</surname><given-names>Jeff</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Xu</surname><given-names>Changjiang</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Merico</surname><given-names>Daniele</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Bader</surname><given-names>Gary D.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a7">7</xref>
<xref ref-type="corresp" rid="cor1">&#x002B;</xref>
</contrib>
<aff id="a1"><label>1</label>Computational Biology Program, <institution>Ontario Institute for Cancer Research</institution>, Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a2"><label>2</label><institution>Department of Medical Biophysics, University of Toronto</institution>, Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a3"><label>3</label>The Donnelly Centre, <institution>University of Toronto</institution>, Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a4"><label>4</label>Deep Genomics Inc., Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a5"><label>5</label>The Centre for Applied Genomics (TCAG), The Hospital for Sick Children, Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a6"><label>6</label><institution>Department of Molecular Genetics, University of Toronto</institution>, Toronto, Ontario, <country>Canada</country>
</aff>
<aff id="a7"><label>7</label><institution>Department of Computer Science, University of Toronto</institution>, Toronto, Ontario, <country>Canada</country>
</aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>&#x002A;</label>
<p>These authors contributed equally to the work</p>
</fn>
<corresp id="cor1"><label>&#x002B;</label>correspondence: <email>gary.bader@utoronto.ca</email>
</corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>232835</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>11</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>12</month>
<year>2017</year>
</date>
</history><permissions><copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="232835.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<p>Pathway enrichment analysis helps gain mechanistic insight into large gene lists typically resulting from genome scale (&#x2013;<italic>omics</italic>) experiments. It identifies biological pathways that are enriched in the gene list more than expected by chance. We explain pathway enrichment analysis and present a practical step-by-step guide to help interpret gene lists resulting from RNA-seq and genome sequencing experiments. The protocol comprises three major steps: define a gene list from genome scale data, determine statistically enriched pathways, and visualize and interpret the results. We focus on differentially expressed genes and mutated cancer genes, however the described principles can be applied to diverse &#x2013;<italic>omics</italic> data. The protocol is designed for biologists with no prior bioinformatics training and uses freely available software including g:Profiler, GSEA, Cytoscape and Enrichment Map.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>bioinformatics</kwd>
<kwd>genomics</kwd>
<kwd>pathway enrichment analysis</kwd>
<kwd>functional analysis</kwd>
<kwd>network analysis</kwd>
<kwd>Cytoscape</kwd>
<kwd>Enrichment Map</kwd>
<kwd>g:Profiler</kwd>
<kwd>GSEA</kwd>
</kwd-group>
<counts>
<page-count count="85"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>INTRODUCTION</title>
<p>Comprehensive surveys of DNA, RNA and proteins in biological samples are now routine. The resulting data are growing exponentially and their analysis helps discover novel biological functions, genotype-phenotype relationships and disease mechanisms. However, analysis and interpretation of these data is a major challenge for many researchers. Analyses often result in long lists of genes that require an impractically large amount of manual literature searching to interpret. A standard approach to addressing this problem is pathway enrichment analysis, which summarizes the large gene list as a smaller list of more easily interpretable pathways. Pathways are statistically tested for over-representation in the experimental gene list above what is expected by chance. For instance, experimental data containing 40&#x0025; cell cycle genes is surprisingly enriched given that only 8&#x0025; of human protein-coding genes are involved in this process.</p>
<p>In a recent example, we used pathway enrichment analysis to help identify histone and DNA methylation by the Polycomb repressive complex (PRC2) as the first rational therapeutic target for ependymoma, one of the most prevalent childhood brain cancers<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. This pathway is targetable by available drugs, such as 5-azacytidine, which was used on a compassionate basis in a terminally ill patient and stopped rapid metastatic tumour growth. In another example, we analysed rare copy number variants (CNVs) in autism and identified several significant pathways affected by gene deletions, whereas only few significant hits were identified with case-control association tests of single genes or loci<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c3">3</xref></sup>. These examples illustrate the useful insights into biological mechanisms that can be achieved using pathway enrichment analysis.</p>
<p>This protocol covers pathway enrichment analysis of large gene lists typically derived from genome scale (&#x201C;&#x2013;<italic>omics</italic>&#x201D;) technology. The protocol is intended for experimental biologists who are interested in interpreting their &#x2013;<italic>omics</italic> data. It requires only an ability to learn and use &#x201C;point-and-click&#x201D; computer software, although advanced users can benefit from automatic analysis scripts we provide. We analyse human gene expression and somatic mutation data as examples, however our conceptual framework is applicable to analysis of lists of genes or biomolecules from any organism derived from large-scale data, including proteomics, genomics, epigenomics and gene regulation studies. The protocol uses free, easy to use, updated and well documented software (g:Profiler<sup><xref ref-type="bibr" rid="c4">4</xref></sup>, GSEA<sup><xref ref-type="bibr" rid="c5">5</xref></sup>, Cytoscape<sup><xref ref-type="bibr" rid="c6">6</xref></sup>, Enrichment Map<sup><xref ref-type="bibr" rid="c7">7</xref></sup>). We next present the major steps of pathway enrichment analysis, describe each in detail and then provide a detailed step-by-step protocol.</p>
</sec>
<sec id="s2">
<title>Protocol overview</title>
<p>Pathway enrichment analysis involves three major steps (<bold><xref ref-type="fig" rid="fig1">Figure 1</xref>; See <xref ref-type="boxed-text" rid="box1">Box 1</xref> for basic definitions).</bold>
<list list-type="order">
<list-item>
<p><bold>Define a gene list of interest using</bold> &#x2013;<italic>omics</italic> <bold>data.</bold> An &#x2013;<italic>omics</italic> experiment comprehensively measures the activity of genes in an experimental context. The raw data generally require computational processing, such as normalization and scoring to identify genes of interest, considering the experimental design. For example, a list of genes differentially expressed between two groups of samples can be derived from RNA-seq data.</p>
</list-item>
<list-item>
<p><bold>Perform pathway enrichment analysis.</bold> A statistical method is used to identify pathways enriched in the gene list from step 1, relative to what is expected by chance. All pathways in a given database are tested for enrichment in the gene list. Several established pathway enrichment analysis methods are available and the choice of which to use depends on the type of gene list.</p>
</list-item>
<list-item>
<p><bold>Visualize and interpret pathway enrichment analysis results.</bold> Many enriched pathways may be identified in step 2, often including related versions of the same pathway. Visualization can help identify the main biological themes and their relationships in this list for in-depth study.</p>
</list-item>
</list>
</p>
<fig id="fig1" position="float"><label>Figure 1</label>
<caption><title>Protocol overview</title>
<p>Gene lists derived from diverse &#x2018;omics data undergo pathway enrichment analysis, using g:Profiler or GSEA, to identify pathways that are enriched in the experiment. Pathway enrichment analysis results are visualized to aid interpretation (using Cytoscape and associated apps Enrichment Map, AutoAnnotate, Word Cloud and clusterMaker2). Protocol overview is shown on the left, starting from gene list input, and example outputs at each stage are shown on the right.</p>
</caption>
<graphic xlink:href="232835_fig1.tif"/></fig>
<sec id="s2a">
<title>Step 1: Define a gene list of interest using -omics data</title>
<p>Genome-scale experiments generate raw data that must be processed to obtain gene-level information suitable for pathway enrichment analysis. The specific processing steps are particular to the &#x2013;<italic>omics</italic> experiment type and may be standard or complex. Standard processing methods are available for established &#x2013;<italic>omics</italic> technologies that are most conveniently performed by the core facility that generates the data. Standard protocols are available, for example for RNA-seq<sup><xref ref-type="bibr" rid="c8">8</xref></sup>, microarrays<sup><xref ref-type="bibr" rid="c9">9</xref></sup>, protein expression<sup><xref ref-type="bibr" rid="c10">10</xref></sup>, genomic variant annotation<sup><xref ref-type="bibr" rid="c11">11</xref></sup>, and DNA methylation<sup><xref ref-type="bibr" rid="c12">12</xref></sup>.</p>
<p>There are two major ways to define a gene list from &#x2013;<italic>omics</italic> data: list or ranked list. Certain &#x2013;<italic>omics</italic> data naturally produce a gene list, such as all somatically mutated genes in a tumor from exome sequencing, or all proteins that interact with a bait in a proteomics experiment. Such a list is suitable for direct input into pathway enrichment analysis using g:Profiler protocol 1A. Other &#x2013;<italic>omics</italic> data naturally produce ranked lists. For example, a list of genes can be ranked by differential gene expression score or sensitivity in a genome wide CRISPR screen. Early pathway enrichment analysis approaches involved applying a threshold to a ranked gene list (e.g. FDR-adjusted p-value below 0.05 and fold-change above 2); however, this is often arbitrary and thus not recommended, especially when meaningful ranks are available for all or most of the genes in the genome. Modern approaches, like GSEA, are designed to analyze ranked lists of all available genes and do not require a threshold. A ranked list is suitable for input into pathway enrichment analysis using GSEA protocol 1B. Alternatively, a partial ranked gene list can be analysed using g:Profiler.</p>
<p>As an example, we describe analysis of raw RNA-seq data to define a ranked gene list. DNA sequence reads are quality filtered (e.g. by trimming to remove low quality bases) and mapped to a genome-wide reference set of transcripts to enable counting reads per transcript. Read counts are aggregated at the gene level (counts per gene). Typically, RNA-seq data for multiple biological replicates (three or more) for each of multiple experimental conditions (two or more, e.g. treatment vs. control) are available (<bold><xref ref-type="boxed-text" rid="box2">Box 2</xref> &#x2013; experimental design</bold>). Read counts per gene are normalized across all samples to remove unwanted technical variation between samples, for example, due to differences in sequencing lane or total read number per sequencing run<sup><xref ref-type="bibr" rid="c13">13</xref>-<xref ref-type="bibr" rid="c15">15</xref></sup>. Next, read counts per gene are tested for differential expression across sample groups (e.g. treatment vs. control) (<bold>Supplementary Protocol 1</bold>). Software packages such as edgeR<sup><xref ref-type="bibr" rid="c16">16</xref></sup>, DESeq<sup><xref ref-type="bibr" rid="c17">17</xref></sup>, limma<sup><xref ref-type="bibr" rid="c18">18</xref></sup>, and Cufflinks<sup><xref ref-type="bibr" rid="c19">19</xref></sup> implement procedures for RNA-seq data normalization and differential expression analysis. Differential gene expression analysis results include: 1) the p-value of the significance of differential expression; 2) the related q-value (a.k.a adjusted p-value) that has been corrected for multiple testing across all genes (e.g. using the Benjamini-Hochberg False Discovery Rate (FDR) procedure<sup><xref ref-type="bibr" rid="c20">20</xref></sup>); 3) effect size and direction of expression change (expressed as fold-change or log-transformed fold-change) so that up-regulated genes are positive and at the top of the list and down-regulated genes are negative and at the bottom of the list. The list of all genes is then ranked by one or more of these values (e.g. &#x2212;log10 p-value multiplied by the sign of log-transformed fold-change). This ranked list is provided as input to pathway enrichment analysis (ranked gene list, no threshold needed, <bold>pathway enrichment analysis using GSEA protocol 1B</bold>).</p>
</sec>
<sec id="s2b">
<title>Step 2A: Pathway enrichment analysis of a gene list using g:Profiler</title>
<p>The default analysis implemented in g:Profiler and similar web-based tools <italic>(e.g.,</italic> Panther<sup><xref ref-type="bibr" rid="c21">21</xref></sup>, ToppGene<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, Enrichr<sup><xref ref-type="bibr" rid="c23">23</xref></sup>, DAVID<sup><xref ref-type="bibr" rid="c24">24</xref></sup>) searches for pathways whose genes are significantly enriched (i.e. over-represented) in the fixed list of genes of interest, compared to all genes in the genome. The p-value of the enrichment is computed using a Fisher&#x2019;s exact test and multiple test correction is applied (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>).</p>
<p>The g:Profiler tool also includes an ordered enrichment test, which is suitable for lists of up to a few thousand genes that are ordered by a score, while the rest of the genes in the genome lack meaningful signal for ranking. For example, significantly mutated genes may be ranked by a score from a cancer driver prediction method<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. This analysis repeats a modified Fisher&#x2019;s exact test on incrementally larger sub-lists of the input genes and reports the sub-list with the strongest enrichment p-value for every pathway<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. g:Profiler searches a set of pathway, network, regulatory motif, and phenotype gene sets. Major gene set categories can be selected to customize the search.</p>
<p>Pathway enrichment methods that use the Fisher&#x2019;s exact test, or related overrepresentation tests, require the definition of a set of background genes for comparison. All annotated protein-coding genes are often used as default. This leads to inappropriate inflation of p-values and false positive results if the experiment can directly measure only a subset of all genes. For example, setting a custom background is important in analysing data from targeted sequencing or phosphoproteomics experiments. The appropriate custom background would include all genes in the sequencing panel or all known phosphoproteins, respectively.</p>
</sec>
<sec id="s2c">
<title>Step 2B: Pathway enrichment analysis of a ranked gene list using GSEA</title>
<p>Pathway enrichment analysis of a ranked gene list is implemented in the GSEA algorithm<sup><xref ref-type="bibr" rid="c5">5</xref></sup>. GSEA is a threshold-free method that analyzes all genes based on their differential expression rank, or other score, without prior gene filtering. GSEA is particularly suitable and recommended when ranks are available for all or most of the genes in the genome (e.g. for RNA-seq data), however it is limited or inapplicable when only a small portion of genes have ranks available.</p>
<p>The GSEA method searches for pathways whose genes are enriched at the top or bottom of the ranked gene list, more so than expected by chance alone. For instance, if the top most differentially expressed genes are involved in the cell cycle, this suggests that the cell cycle pathway is regulated in the experiment. In contrast, the cell cycle pathway is likely not significantly regulated if the cell cycle genes appear randomly scattered through the whole ranked list. To calculate an enrichment score (ES) for a pathway, GSEA progressively examines genes from the top to the bottom of the ranked list, increasing the enrichment score if a gene is part of the pathway and decreasing the score otherwise. These running sum values are weighted, so that enrichment in the very top-(and bottom-) ranking genes is amplified, whereas enrichment in genes with more moderate ranks are not amplified. The ES score is calculated as the maximum value of the running sum and normalized relative to pathway size, resulting in a normalized enrichment score (NES) that reflects the enrichment of the pathway in the list. Positive and negative NES values represent enrichment at the top and bottom of the list, respectively. Finally, a permutation-based p-value is computed and corrected for multiple testing to produce a permutation-based FDR <italic>q</italic>-value that ranges from zero (highly significant) to one (not significant) (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>). The same analysis is performed starting from the bottom of the ranked gene list to identify pathways enriched in the bottom of the list. Resulting pathways are selected using the FDR <italic>q</italic>-value threshold (e.g. <italic>q</italic>&#x003C;0.05), and ranked using NES. It is also useful to inspect the &#x201C;leading edge&#x201D; genes that contribute to the increase of the enrichment score before it peaks.</p>
<p>GSEA has two methods to determine the statistical significance of the enrichment score and compute a p-value: gene set permutation and phenotype permutation. For gene set permutation, input is a ranked list and GSEA compares the observed pathway enrichment score to a distribution of scores obtained by repeating the analysis with randomly sampled gene sets of matching sizes (e.g. 1,000 times). In the phenotype permutation mode, input is expression data for all samples along with a definition of sample groups (called &#x2018;phenotypes&#x2019; - e.g. cases vs. controls, tumor vs. normal) to be compared against each other. The observed pathway enrichment score is compared to a distribution of scores obtained by randomly shuffling the samples among phenotype categories and repeating the analysis (e.g. 1,000 times), including computation of the ranked gene list and resulting pathway enrichment score. The gene set permutation mode is recommended for studies with limited variability and biological replicates (i.e. 2 to 5 per condition). In this case, differential gene expression analysis should be computed using methods that include variance stabilization, outside of GSEA. If more replicates are available (above 6 to 10 per condition), the phenotype permutation should be used, offering as a main advantage that it models gene correlations in the gene expression matrix, unlike the gene set permutation approach. This protocol only covers gene set permutation because it can be accomplished using easy to use GSEA software, whereas phenotype permutation for RNA-seq data requires computing the enrichment score and differential expression statistics on thousands of phenotype randomizations, which currently requires custom programming outside of GSEA.</p>
<p>By default, the GSEA desktop software searches the MSigDB gene set database that includes pathways, published gene signatures, microRNA target genes and other gene set types (<bold><xref ref-type="boxed-text" rid="box4">Box 4</xref></bold>). The user can also provide a custom database as a text-based &#x2018;Gene Matrix Transposed&#x2019; (GMT) file where each line defines a pathway, with its name, identifier and a list of gene identifiers that match the input gene list.</p>
</sec>
<sec id="s2d">
<title>General recommendations for pathway enrichment analysis</title>
<p>We recommend searching enrichment only of pathway gene sets at first, as these capture familiar normal cellular processes that are easy to interpret. Gene Ontology (GO)<sup><xref ref-type="bibr" rid="c27">27</xref></sup> biological process terms and manually curated molecular pathways from Reactome<sup><xref ref-type="bibr" rid="c28">28</xref></sup>, Panther<sup><xref ref-type="bibr" rid="c21">21</xref></sup>, HumanCyc <sup><xref ref-type="bibr" rid="c29">29</xref></sup>, and NetPath<sup><xref ref-type="bibr" rid="c30">30</xref></sup> are good resources for human pathways (<bold><xref ref-type="boxed-text" rid="box4">Box 4</xref></bold>). GO biological process annotations include a mix of manually curated and electronically inferred sources. We recommend excluding those with the lower quality &#x2018;inferred from electronic annotation&#x2019; (IEA) evidence code, unless no enriched pathways are found. Pathway definitions change rapidly and it is essential to use updated databases of gene annotations as outdated databases can lead to missed discoveries<sup><xref ref-type="bibr" rid="c31">31</xref></sup>.</p>
<p>Different types of gene sets help answer a variety of questions. For instance, gene sets corresponding to microRNA and transcription factor targets can be used to discover important regulators<sup><xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref></sup>. The use of additional sets must be carefully considered, as simultaneously analyzing all available gene sets increases the number of statistical tests and leads to more conservative p-values following multiple test correction (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>).</p>
<p>Gene set size is important to consider. Small pathways (e.g. less than ten or fifteen genes) should be excluded because these are often numerous, negatively affecting multiple test correction, and redundant with larger pathways. For human gene expression analysis, large pathways (e.g. over 300 genes) should also be excluded as these are overly general (e.g. &#x2018;metabolism&#x2019;) and don&#x2019;t contribute to interpretability of results. However, for other gene set types and organisms, larger pathways and gene sets may need to be included (e.g. up to 1000 genes).</p>
<p>A pathway enrichment analysis resulting in few or no enriched pathways may be caused by suboptimal statistical processing used to define the gene list. If the gene list ranks are too noisy (interfering with the signal of having the most important genes at the top of the list), all or no genes are highly significant, then enriched pathways are unlikely to be found. If the gene list has been correctly defined, increasing the number of pathways and gene sets searched or setting more liberal filters may improve results. Finally, pathway enrichment analysis results can change based on the parameters used (e.g. minimum and maximum pathway size or selected pathway databases), thus the robustness of conclusions should be tested by varying these parameters.</p>
</sec>
<sec id="s2e">
<title>Step 3: Visualising and interpreting pathway enrichment analysis results</title>
<p>Pathway information is inherently redundant, as genes often participate in multiple pathways, and some pathway databases organize pathways hierarchically by including general and specific pathways with many shared genes (e.g. &#x2018;cell cycle&#x2019; and &#x2018;M-phase of cell cycle&#x2019;). Pathway enrichment analysis often highlights several versions of the same pathway as a result. Collapsing redundant pathways into a single biological theme simplifies interpretation. We recommend addressing such redundancy with the Enrichment Map visualization method<sup><xref ref-type="bibr" rid="c7">7</xref></sup> or similar<sup><xref ref-type="bibr" rid="c34">34</xref></sup>. An enrichment map is a network representing overlaps among enriched pathways. Pathways are represented as circles (nodes) that are colored by enrichment score and are connected with lines (edges) sized based on the number of genes shared by the connected pathways. Network layout and clustering algorithms are used to automatically display and group similar pathways as major biological themes (<bold><xref ref-type="fig" rid="fig1">Figure 1</xref></bold>). The Enrichment Map software takes as input a text file containing pathway enrichment analysis results and another text file containing the pathway gene sets used in the original enrichment analysis. Interactive exploration of pathway enrichment score (filtering nodes) and connections between pathways (filtering edges) is possible (see <bold>visualize enrichment results with Enrichment Map, protocol 2</bold>). Multiple enrichment analysis results can be simultaneously visualized in a single enrichment map, in which case different colors are used on the nodes for each enrichment. If the gene expression data are optionally loaded, clicking on a pathway node will display a gene expression heat map of all genes in the pathway.</p>
<p>An enrichment map helps identify interesting pathways and themes. First, expected themes should be identified to help validate the pathway enrichment analysis results (positive controls). For instance, growth related pathways are expected to be identified in cancer samples relative to controls. Second, pathways not previously associated with the experimental context are evaluated more carefully as potential discoveries. Pathways and themes with the strongest enrichment scores should be studied first, followed by progressively weaker signals (see <bold>navigating and interpreting the Enrichment Map, protocol 3</bold>). Third, interesting pathways are examined in more detail, examining genes within the pathways (e.g. expression heat maps and the GSEA leading edge genes). Further, gene expression values can be overlaid on a pathway diagram, if available, from databases such as Pathway Commons<sup><xref ref-type="bibr" rid="c35">35</xref></sup>, Reactome<sup><xref ref-type="bibr" rid="c28">28</xref></sup>, KEGG<sup><xref ref-type="bibr" rid="c36">36</xref></sup> or WikiPathways<sup><xref ref-type="bibr" rid="c37">37</xref></sup> using tools such as PathVisio<sup><xref ref-type="bibr" rid="c38">38</xref></sup>. If a diagram is not available, tools such as STRING<sup><xref ref-type="bibr" rid="c39">39</xref></sup> or GeneMANIA<sup><xref ref-type="bibr" rid="c40">40</xref></sup> can be used with Cytoscape<sup><xref ref-type="bibr" rid="c6">6</xref></sup> to define an interaction network among pathway genes for expression overlay. This helps visually identify pathway components (e.g. branches or single elements) that are most altered (e.g., differentially expressed) in the experiment. Additionally, master regulators for enriched pathways can be searched for by integrating miRNA<sup><xref ref-type="bibr" rid="c32">32</xref></sup> or transcription factor<sup><xref ref-type="bibr" rid="c33">33</xref></sup> target gene sets using the Enrichment Map post-analysis tool. Finally, pathway enrichment analysis results can be published to support a scientific conclusion (e.g. functional differences of two cancer subtypes), used for hypothesis generation or planning experiments to support the identification of novel pathways.</p>
</sec>
<sec id="s2f">
<title>Caveats of pathway enrichment analysis</title>
<p>The following caveats are important to consider when interpreting pathway enrichment analysis results.
<list list-type="bullet">
<list-item>
<p>Pathway enrichment analysis assumes that a strong experimental signal of pathways reflects the biology addressed by the experiment. For instance, in a transcriptomics experiment, we assume that evolution has optimized a cell to express a pathway only when needed and these can be identified. Pathway activity not controlled by gene expression (e.g. post-translational regulation) will not be observed.</p></list-item>
<list-item>
<p>Unexpected biological themes may indicate problems with experimental design, data generation or analysis. For example, enrichment of the apoptosis pathway may indicate a problem with the experimental protocol that led to increased cell death during sample preparation. In these cases, the experimental design and data generation should be carefully reviewed prior to pathway analysis.</p>
</list-item>
<list-item>
<p>Pathway databases, and therefore enrichment results are biased towards well known pathways.</p>
</list-item>
<list-item>
<p>Multi-functional genes that are highly ranked in the gene list may lead to enrichment of many different pathways, some of which are not relevant to the experiment. Repeating the analysis after excluding such genes may reveal pathways whose enrichment is overly-dependent on their presence or confirm the robustness of pathway enrichment.</p>
</list-item>
<list-item>
<p>Pathway enrichment analysis ignores genes with no pathway annotations, sometimes called &#x201C;dark matter of the genome&#x201D;, and these genes should be studied separately.</p>
</list-item>
<list-item>
<p>Most enrichment analysis methods make unrealistic assumptions of statistical independence among genes as well as pathways. Some genes may be always co-expressed (e.g. genes within a protein complex) and some pathways have genes in common. Thus, standard false discovery rates, which assume statistical independence between tests, are often either more or less conservative than ideal. Nonetheless, they should still be used to adjust for multiple testing and rank enriched pathways for exploratory analysis and hypothesis generation. Custom permutation tests may lead to better estimates of false discovery (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>).</p>
</list-item>
<list-item>
<p>By representing pathways as gene sets, many biological details such as proteinprotein interactions, biochemical reactions, post-translational modifications, protein complexes, and activation and inhibition relationships are ignored. These issues are addressed by advanced methods that consider mechanistic pathway details, however this is still an active area of research (<bold><xref ref-type="boxed-text" rid="box5">Box 5</xref></bold>).</p>
</list-item>
</list>
</p>
</sec>
<sec id="s2g">
<title>Working with diverse &#x2013;<italic>omics</italic> data</title>
<p>Pathway enrichment analysis is generally applicable to any experiment that can generate a list of genes, though experiment specific issues must be considered:
<list list-type="bullet">
<list-item>
<p>Genes are associated with many, diverse database identifiers (IDs). We recommend using unambiguous, unique and stable IDs, as some IDs become obsolete over time. For human genes, we recommend using the Entrez Gene database IDs (e.g. <italic>4193</italic> corresponds to <italic>MDM2,</italic> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/gene/4193">http://www.ncbi.nlm.nih.gov/gene/4193</ext-link>) or gene symbols <italic>(MDM2</italic> is the official symbol recommended by the HUGO Gene Nomenclature Committee). As gene symbols change over time, we recommend maintaining both gene symbols and Entrez Gene IDs. We recommend UniProt accession numbers for proteins (e.g. <italic>Q00987</italic> for MDM2, <ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org/uniprot/Q00987">http://www.uniprot.org/uniprot/Q00987</ext-link>) and Human Metabolome Database (HMDB) IDs for metabolites (e.g. ATP is denoted as <italic>HMDB00538,</italic> <ext-link ext-link-type="uri" xlink:href="http://www.hmdb.ca/metabolites/HMDB00538">http://www.hmdb.ca/metabolites/HMDB00538</ext-link>). The g:Profiler and related g:Convert tool support automatic conversion of multiple ID types to standard IDs.</p>
</list-item>
<list-item>
<p>Pathway enrichment analysis of short non-coding genomic regions such as transcription factor binding sites from ChIP-seq experiments need additional consideration. Genomic regions must be mapped to protein-coding genes and corrected for biases such as increased signal in longer genes. Tools such as GREAT<sup><xref ref-type="bibr" rid="c41">41</xref></sup> automatically perform both tasks.</p>
</list-item>
<list-item>
<p>Large genomic intervals that span multiple genes (e.g. from genome-wide associations, copy number variation and differentially methylated regions) require specialized tests such as the PLINK CNV gene set burden test<sup><xref ref-type="bibr" rid="c42">42</xref></sup> or INRICH<sup><xref ref-type="bibr" rid="c43">43</xref></sup>. Standard enrichment tests often reveal genes clustered in the genome that are strongly statistically inflated due to incorrectly counting each gene as an independent signal. These include olfactory receptors, histones, major histocompatibility complex (MHC) members and homeobox transcription factors. A simple solution involves selecting only one representative gene of each functionally homogeneous genomic cluster prior to enrichment analysis.</p>
</list-item>
<list-item>
<p>For rare genetic variants, case-control pathway &#x201C;burden&#x201D; tests are the most appropriate pathway enrichment analysis method (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>).</p>
</list-item>
</list>
</p>
</sec>
<sec id="s2h">
<title>Future perspectives</title>
<p>Current pathway enrichment analysis methods provide a useful high-level overview of the pathways active in a genomics experiment. However, these methods consider a simplified pathway view (gene sets). Next generation pathway analysis methods will integrate more biological pathway details, build pathway models based on multiple types of genomics data measured across many samples, and consider positive and negative regulatory relationships in the data (<bold><xref ref-type="boxed-text" rid="box5">Box 5</xref></bold>). For instance, qualitative mathematical modeling parameterized with single cell RNA-seq data may enable accurate predictions of drug combinations capable of treating a given disease under study.</p>
</sec>
</sec>
<sec id="s3">
<title>PROTOCOL</title>
<sec id="s3a">
<title>INTRODUCTION</title>
<p>This step-by-step protocol explains how to complete pathway enrichment analysis using g:Profiler (gene list) and GSEA (ranked gene list), followed by visualization and interpretation using Enrichment Map, as explained above in the text. The example data provided for the g:Profiler analysis is a list of genes with frequent somatic single nucleotide variants (SNVs) identified in The Cancer Genome Atlas (TCGA) exome sequencing data of 3,200 tumors of 12 types<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. The example data provided for the GSEA analysis is a list of differentially expressed genes in two types of ovarian cancer defined by TCGA.</p>
</sec>
</sec>
<sec id="s4">
<title>MATERIALS</title>
<sec id="s4a">
<title>Equipment</title>
<p>Hardware requirements:
<list list-type="bullet">
<list-item><p>A recent personal computer with Internet access and at least 8GB of RAM. Note: 1GB of RAM is sufficient to run GSEA analysis but Cytoscape requires at least 8GB.</p></list-item>
</list>
</p>
<p>Software requirements:
<list list-type="bullet">
<list-item>
<p>Assume that consumers (<italic>C</italic>(<italic>t</italic>), population of predators) are close to a chemical stimulus that is frequented by a population of bacteria that is predated <italic>C</italic>(<italic>t</italic>). In our example, the stimuli growths proportional to the time.</p>
</list-item>
<list-item>
<p>A contemporary web browser (e.g. Chrome) for pathway enrichment analysis with g:Profiler (Protocol 1A).</p>
</list-item>
<list-item>
<p>Java Standard Edition. Java is required to run GSEA and Cytoscape. It is available at <ext-link ext-link-type="uri" xlink:href="http://java.oracle.com">http://java.oracle.com</ext-link> Version 8 or higher is required.</p>
</list-item>
<list-item>
<p>GSEA desktop application for pathway enrichment analysis protocol 1B. Download the latest version of GSEA from <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/gsea/downloads.jsp">http://www.broadinstitute.org/gsea/downloads.jsp</ext-link>. We recommend the javaGSEA desktop application. Free registration is required.</p>
</list-item>
<list-item>
<p>Cytoscape desktop application is required for enrichment map visualization. The latest version of Cytoscape can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://www.cytoscape.org">http://www.cytoscape.org</ext-link> - Cytoscape version 3.5.1 or higher.</p>
</list-item>
<list-item>
<p>The following Cytoscape apps must be installed within Cytoscape for enrichment map visualization. Go to <bold>Apps App&#x2192; manager</bold> (i.e., open the Apps menu and select the item &#x201C;App manager&#x201D;).
<list list-type="bullet">
<list-item>
<p>Enrichment Map, version 3.0 or higher,</p>
</list-item>
<list-item>
<p>Clustermaker2, version 0.9.5 or higher,</p>
</list-item>
<list-item>
<p>WordCloud, version 3.1.0 or higher,</p>
</list-item>
<list-item>
<p>AutoAnnotate, version 1.2.0 or higher.</p>
</list-item>
</list></p>
</list-item>
</list></p>
<p>Data requirements:
<list list-type="bullet">
<list-item>
<p>We provide example files that are listed following the protocol. We recommend saving all files in a personal project folder before starting.</p>
</list-item>
<list-item>
<p>A gene list or ranked gene list of interest.
<list list-type="bullet">
<list-item>
<p><bold>Protocol 1A</bold> with g:Profiler requires a list of genes, one per line in a text file or spreadsheet, ready to copy and paste into a web page.
<list list-type="bullet">
<list-item>
<p>Example data for <bold>Protocol 1A</bold>: Genes with frequent somatic single nucleotide variants (SNVs) identified in The Cancer Genome Atlas (TCGA) exome sequencing data of 3,200 tumors of 12 types<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. The authors used their MuSiC software to find 127 cancer driver genes that displayed higher than expected mutation frequencies (Ref<sup><xref ref-type="bibr" rid="c25">25</xref></sup> Supplementary Table 4, column B) (<bold>Supplementary&#x005F;Table&#x005F;1&#x005F;Cancer drivers.txt</bold>). Genes are ranked in decreasing order of significance (FDR <italic>q</italic>-value) and mutation frequency (not shown).</p>
</list-item>
</list>
</p>
</list-item>
</list>
</p>
</list-item>
</list>
</p>
<list list-type="bullet">
<list-item>
<p><list list-type="bullet">
<list-item>
<p><bold>Protocol 1B</bold> with GSEA requires a RNK file with gene scores.</p>
<list list-type="bullet">
<list-item>
<p>A RNK file is a two-column text file with gene IDs in the first column and gene scores in the second column. All (or most) genes in the genome need to have a score and the gene IDs need to match those used in the GMT file.</p>
</list-item>
<list-item>
<p>Example data for <bold>Protocol 1B</bold>: A list of differentially expressed genes in ovarian cancer from TCGA (<bold>Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rn k</bold>). This cohort was previously stratified into four molecular subtypes based on gene expression data, defined as differentiated, immunoreactive, mesenchymal and proliferative<sup><xref ref-type="bibr" rid="c44">44</xref>,<xref ref-type="bibr" rid="c45">45</xref></sup>. We compared the immunoreactive and mesenchymal subtypes to demonstrate the protocol. <bold>Supplementary Protocol 1</bold> shows how this file was created.</p>
</list-item>
</list>
</list-item>
</list>
<list list-type="bullet">
<list-item>
<p>Pathway gene set database</p>
<list list-type="bullet">
<list-item>
<p>In <bold>Protocol 1A</bold>, g:Profiler maintains an up-to-date set of pathway gene sets from multiple sources and no further input from the user is required.</p>
</list-item>
<list-item>
<p>A database of pathway gene sets is required for <bold>Protocol 1B</bold> (GSEA). Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO&#x005F;iea&#x005F;July&#x005F;01&#x005F;2017&#x005F;symbol.gmt (<bold>Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO&#x005F;iea&#x005F;J uly&#x005F;01&#x005F;2017&#x005F;symbol.gmt</bold>) contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format, downloaded from <ext-link ext-link-type="uri" xlink:href="http://baderlab.org/GeneSets">http://baderlab.org/GeneSets</ext-link>. This file contains pathways downloaded on July 1, 2017 from seven original pathway gene sets data sources: Gene Ontology<sup><xref ref-type="bibr" rid="c27">27</xref></sup>, Reactome<sup><xref ref-type="bibr" rid="c28">28</xref></sup>, Panther<sup><xref ref-type="bibr" rid="c21">21</xref></sup>, NetPath<sup><xref ref-type="bibr" rid="c30">30</xref></sup>, NCI<sup><xref ref-type="bibr" rid="c46">46</xref></sup>, MSigdb<sup><xref ref-type="bibr" rid="c47">47</xref></sup>, and HumanCyc<sup><xref ref-type="bibr" rid="c29">29</xref></sup>. The latest version of this file can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://baderlab.org/GeneSets">http://baderlab.org/GeneSets</ext-link>.</p>
</list-item>
<list-item>
<p>A GMT file is a text file where every line represents a gene set of a single pathway. Each line includes a pathway ID, name and the list of associated genes in a tab-separated format.</p>
</list-item>
</list>
</list-item></list>
</p></list-item></list></sec>
<sec id="s4b">
<title>Equipment setup</title>
<list list-type="bullet">
<list-item>
<p><bold>Protocol 1A</bold> uses web-based software and just requires a web browser.</p></list-item>
<list-item>
<p><bold>Protocols 1B, 2 and 3</bold> require installation of software on a local computer (see Equipment section, above).</p>
</list-item>
</list>
</sec>
</sec>
<sec id="s5">
<title>PROCEDURE</title>
<sec id="s5a">
<title>Part 1A - Pathway enrichment analysis of a gene list using g:Profiler</title>
<list list-type="simple">
<list-item><label>1</label><p>Open the g:Profiler website at <ext-link ext-link-type="uri" xlink:href="http://biit.cs.ut.ee/gprofiler/">http://biit.cs.ut.ee/gprofiler/</ext-link> (<bold><xref ref-type="fig" rid="fig2">Figure 2</xref></bold>).</p></list-item>
<list-item><label>2</label><p>Paste the gene list (copy list from <bold>Supplementary&#x005F;Table&#x005F;1&#x005F;Cancer drivers.txt</bold>) into the &#x201C;Query&#x201D; field in top-left corner of the screen. The gene list can be space-separated or one per line. The organism for the analysis, <italic>Homo sapiens,</italic> is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, while ambiguous symbols can be refined in an interactive dialogue after submitting the query.</p></list-item>
<list-item><label>3</label><p>Check the box next to "Ordered query". This option treats the input as an ordered gene list and prioritizes genes with higher mutation enrichment scores at the beginning of the list.</p></list-item>
<list-item><label>4</label><p>Check the box next to "No electronic GO annotations". This option will discard less reliable Gene Ontology (GO) annotations (IEA - inferred from electronic annotation) that are not manually reviewed.</p></list-item>
<list-item><label>5</label><p>Set filters on gene annotation data using the legend on the right. We recommend that the first pathway enrichment analysis only includes biological processes (BP) of GO and molecular pathways of Reactome. Keep the two checkboxes checked and uncheck all other boxes in the legend.</p></list-item>
<list-item><label>6</label><p>Click on "Show Advanced Options" to set additional parameters.</p></list-item>
<list-item><label>7</label><p>Set the dropdown values of "Size of functional category" to 5 (&#x2018;min&#x2019;) and 350 (&#x2018;max&#x2019;). Large pathways are of limited interpretative value, while numerous small pathways decrease the statistical power because of excessive multiple testing.</p></list-item>
<list-item><label>8</label><p>Set the dropdown "Size of query/term intersection" to 3. The analysis will only consider more reliable pathways that have three or more genes in the input gene list.</p></list-item>
<list-item><label>9</label><p>Click "g:Profile&#x0021;" to run the analysis. A graphical image will be shown with detected pathways from top to bottom and associated genes of the input list left to right. Resulting pathways are organized hierarchically into related groups. g:Profiler uses graphical output by default and switches to textual output when a large number of pathways is found. g:Profiler returns only statistically significant pathways with p-values adjusted for multiple testing correction using a custom pathway-focused procedure. By default, results with corrected q-value below 0.05 are reported.</p></list-item>
<list-item><label>10</label><p>Use the dropdown menu "Output type" and select the option "Generic Enrichment Map (TAB)". This file is required for visualizing pathway results with Cytoscape and Enrichment Map.</p></list-item>
<list-item><label>11</label><p>Click "g:Profile&#x0021;" again to run the analysis with the updated parameters. The required link "Download data in Generic Enrichment Map (GEM) format" will appear under the g:Profiler interface. Download the file from the link and save it on your computer in your project folder. Example results are contained in <bold>Supplementary&#x005F;Table4&#x005F;gprofiler&#x005F;results.txt.</bold></p></list-item>
<list-item><label>12</label><p>Download the required GMT file by clicking on the link "name" at the bottom of the Advanced Options form. The GMT file is a compressed ZIP archive that contains all gene sets used by g:Profiler (e.g., gprofiler&#x005F;hsapiens.NAME.gmt.zip). The gene set files are divided by data source. Download and uncompress the ZIP archive to your project folder. All required gene sets for this analysis will be in the file hsapiens.pathways.Name.gmt (<bold>Supplementary&#x005F;Table5&#x005F;hsapiens.pathways.NAME.gmt</bold>).</p></list-item>
<list-item><label>13</label><p>Proceed to <bold>Protocol 2.</bold></p></list-item>
</list>
<fig id="fig2" position="float"><label>Figure 2</label>
<caption><title>Screenshot of g:Profiler user interface</title>
<p>Steps in the protocol and associated g:Profiler interface components. Purple boxes indicate relate to files that need to be downloaded. The remaining boxes indicate parameters for the analysis.</p>
</caption>
<graphic xlink:href="232835_fig2.tif"/></fig>
<sec id="s5a1">
<title>TIMING</title> <p>&#x223C;3 minutes to run g:Profiler using Chrome on Windows7.</p>
</sec>
</sec>
<sec id="s5b">
<title>Part 1B - Pathway enrichment analysis of a ranked gene list using GSEA</title>
<list list-type="simple">
<list-item><label>14</label><p>Launch GSEA by double clicking on the downloaded GSEA file (gsea.jnlp) (<bold>Tips and Troubleshooting &#x2013; &#x0023;1 (TT1)) (<xref ref-type="fig" rid="fig3">Figure 3</xref></bold>).</p></list-item>
<list-item><label>15</label><p>Load the required data files into GSEA:
<list list-type="roman-lower">
<list-item>
<p>Click on &#x201C;Load Data&#x201D; in the top left corner in the &#x201C;Steps in GSEA Analysis&#x201D; section.</p></list-item>
<list-item>
<p>In the &#x201C;Load Data&#x201D; tab, click on &#x201C;Browse for files &#x2026;&#x201D;</p></list-item>
<list-item>
<p>Find your project folder and select the file Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rnk.</p></list-item>
<list-item>
<p>Also select the pathway gene set definition (GMT) file using a multiple select method such as shift-click (<bold>Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO&#x005F;iea&#x005F;J uly&#x005F;01&#x005F;2017&#x005F;symbol.gmt (TT2, TT3</bold>)). Then click the &#x2018;Choose&#x2019; button to continue.</p></list-item>
</list></p></list-item></list>
<fig id="fig3" position="float"><label>Figure 3</label>
<caption><title>Screenshot of GSEA user interface</title>
<p>Steps in the protocol and associated GSEA interface components (version 3.0), highlighted with squares and with indication of the step number.</p>
</caption>
<graphic xlink:href="232835_fig3.tif"/></fig>
<list list-type="simple">
<list-item><label>16</label><p>Click on &#x201C;Run GSEAPreranked&#x201D; in the side bar under &#x201C;Tools&#x201D;. The tab &#x201C;Run GSEA on a Pre-Ranked gene list&#x201D; will appear.</p></list-item>
<list-item><label>17</label><p>Specify the following parameters:
<list list-type="roman-lower">
<list-item>
<p><bold>Gene sets database</bold> &#x2013; click on the button (&#x2026;) located to the right and wait for the gene set selection window to appear. Go to the &#x201C;Gene matrix (local GMX/GMT)&#x201D; tab using the top right arrow. Click on the downloaded local GMT file <bold>Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO&#x005F;iea&#x005F;Ju ly&#x005F;01&#x005F;2017&#x005F;symbol.gmt</bold> and click on OK at the bottom of the window.</p></list-item>
<list-item>
<p><bold>Number of permutations</bold> &#x2013; number of times that the gene sets will be randomized to create the null distribution to calculate the p-value and FDR <italic>q</italic>-value (<bold>TT4</bold>). Use the default value of 1000 permutations.</p></list-item>
<list-item>
<p><bold>Ranked List</bold> &#x2013; select the ranked gene list by clicking on the right-most arrow and highlighting the rank file (<bold>Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rnk</bold>).</p></list-item>
<list-item>
<p>Click on &#x201C;Show&#x201D; button next to &#x201C;Basic Fields&#x201D; to display extra options.</p></list-item>
<list-item>
<p><bold>Analysis name</bold> &#x2013; change default &#x201C;my&#x005F;analysis&#x201D; to a specific name, for example &#x201C;Mesen&#x005F;vs&#x005F;Immuno&#x201D;.</p></list-item>
<list-item>
<p><bold>Save results in this folder</bold> &#x2013; navigate to the folder where GSEA should save the results. By default, GSEA will use gsea&#x005F;home/output/[date] in your home directory.</p></list-item>
<list-item>
<p><bold>Max size: exclude larger sets</bold> &#x2013; By default GSEA sets the upper limit to 500. Set this to 200 to remove the larger sets from the analysis.</p></list-item>
</list></p></list-item>
<list-item><label>18</label><p>Run GSEA - click on the &#x201C;Run&#x201D; button located at the bottom right corner of the window. Expand the window if the button is not visible. The &#x201C;GSEA reports&#x201D; panel at the bottom left of the window will show the status &#x201C;Running&#x201D;. It will be updated to &#x201C;Success&#x201D; upon completion (<bold>TT5, TT6</bold>).</p></list-item>
<list-item><label>19</label><p>Examine GSEA results - once the GSEA analysis is complete, a green notification &#x201C;Success&#x201D; will appear in the bottom left section of the screen. All output files are available in the folder specified in the GSEA interface. Click on &#x201C;Success&#x201D; to open the results in your web browser. Pathways enriched in top-ranking genes (i.e. up-regulated) are shown in the first set (na&#x005F;pos; &#x2018;mesenchymal&#x2019; in this protocol) and pathways enriched in bottom-ranked genes (i.e. down-regulated) in the second set (na&#x005F;neg; &#x2018;immunoreactive&#x2019;) (<bold>TT7, TT8</bold>) (<bold><xref ref-type="fig" rid="fig4">Figure 4A</xref></bold>).</p></list-item>
</list>
<fig id="fig4" position="float"><label>Figure 4</label>
<caption><title>GSEA output</title>
<p>(A) GSEA output overview-Web page summary of GSEA results showing pathways enriched in the top or bottom of the ranked list, with &#x201C;na&#x005F;pos&#x201D; and &#x201C;na&#x005F;neg&#x201D; phenotype corresponding to enrichment in up-regulated and down-regulated genes. Clicking on snapshots under either of the phenotypes will show the top 20 enrichment plots for that phenotype. (B) Class/phenotype specific GSEA output in: the web page summary shows in purple how many gene sets were found enriched in up-regulated genes regardless of significance (purple), the total number of gene sets used after size filtering (cyan), the phenotype name (red), the number of gene sets that pass different thresholds (orange).</p>
</caption>
<graphic xlink:href="232835_fig4.tif"/></fig>
<list list-type="simple">
<list-item><label>20</label><p>In the web browser results summary, click on the &#x201C;Snapshot&#x201D; link under the results to get an overview of the top 20 findings. The most significant pathways for the first phenotype (&#x2018;na&#x005F;pos&#x2019;) should clearly display enrichment in top-ranking (i.e. up-regulated) genes. Conversely, the most significant pathways for the second phenotype (&#x2018;na&#x005F;neg&#x2019;) should clearly display enrichment in bottom-ranked genes (i.e. down-regulated) (<bold>TT9</bold>) (<bold><xref ref-type="fig" rid="fig4">Figure 4A</xref></bold>).</p></list-item>
<list-item><label>21</label><p>Check the number of gene sets that have q-values below 0.05 to determine appropriate thresholds for the enrichment map in the next protocol. If no pathways are reported at <italic>q</italic>&#x003C;0.05, more lenient thresholds such as <italic>q</italic>&#x003C;0.1 or <italic>q</italic>&#x003C;0.25 could be used (<bold><xref ref-type="fig" rid="fig4">Figure 4B</xref></bold>). The threshold <italic>q</italic>&#x003C;0.25 provides very lenient filtering and it is not uncommon to find thousands of enriched pathways at this level. Robust analyses should use a cutoff of <italic>q</italic>&#x003C;0.05 or lower. Filtering only by uncorrected p-values is not recommended.</p></list-item>
</list>
<sec id="s5b1">
<title>TIMING</title>
<p>&#x223C;20 minutes to run GSEA using Windows7 with 1GB of RAM and Java 8 (TT4, TT5).</p>
</sec>
</sec>
<sec id="s5b2">
<title>Protocol 2 - Visualize enrichment results with Enrichment Map</title>
<list list-type="simple">
<list-item><label>22</label><p>Launch the Cytoscape software. Cytoscape introductory tutorials can be found at <ext-link ext-link-type="uri" xlink:href="http://tutorials.cytoscape.org">http://tutorials.cytoscape.org</ext-link></p></list-item>
<list-item><label>23</label><p>In the menu, click Apps<bold>&#x2192;</bold>Enrichment Map.</p></list-item>
<list-item><label>24</label><p>A "Create Enrichment Map Panel" will appear (<bold><xref ref-type="fig" rid="fig5">Figure 5</xref></bold>). Creating enrichment maps with g:Profiler and GSEA requires slightly different input files.</p></list-item>
</list>
<fig id="fig5" position="float"><label>Figure 5</label>
<caption><title>Screenshot of Enrichment Map user interface</title>
<p>Input fields in the Enrichment Map interface for (A) g:Profiler and (B) GSEA results. Other than the specific input files, the parameters are the same for both analysis types. Attributes surrounded by a dashed box should be filled out automatically if the user selects a folder for enrichment map to find all analyses in. If the file names are missing, then EM was unable to find the specified file, possibly because the original file was moved or deleted. Orange boxes indicate optional files. For the examples presented in the protocol, optional files are used for the GSEA analysis but not for the g:Profiler analysis to demonstrate the two distinct use cases.</p>
</caption>
<graphic xlink:href="232835_fig5.tif"/></fig>
<list list-type="simple">
<list-item><label>25</label><p>For g:Profiler results, files generated in <bold>Protocol 1A</bold> (<bold><xref ref-type="fig" rid="fig5">Figure 5A</xref></bold>):</p>
<list list-type="roman-lower">
<list-item>
<p>Click on folder icon to navigate to the g:Profiler results</p></list-item>
<list-item>
<p>Click on g:Profiler folder created in Protocol 1A. Click on Open. (<bold>TT10</bold>)</p></list-item>
<list-item>
<p>In the right hand panel g:Profiler output files will be auto populated into their specified fields. (Alternately, users can click on the &#x201C;&#x002B;&#x201D; to specify each of the required files manually).
<list list-type="bullet">
<list-item>
<p>If desired, modify the &#x2018;dataset&#x2019; name. By default, EM will use the name of the g:Profiler enrichment results file name (e.g. gprofiler&#x005F;cancer&#x005F;drivers).</p></list-item>
<list-item>
<p>Verify the Analysis type is set to &#x201C;Generic/gProfiler&#x201D;.</p></list-item>
<list-item>
<p>Verify the Enrichments results file is the results file downloaded in Protocol 1A step 11 (or alternately manually specify <bold>Supplementary&#x005F;Table4&#x005F;gprofiler&#x005F;results.txt</bold>)</p></list-item>
<list-item>
<p>Verify the GMT specified is the file retrieved from the g:Profiler website in Protocol 1A &#x2013; step 12. Use the file hsapiens.pathways.NAME.gmt (or alternately manually specify <bold>Supplementary&#x005F;Table5&#x005F;hsapiens.pathways.NAME.gmt</bold>) that contains gene sets corresponding to GO biological processes and Reactome pathways.</p></list-item>
</list></p></list-item>
<list-item>
<p>Specify additional files:
<list list-type="bullet">
<list-item>
<p><bold>Expression</bold> - (Optional) Upload an expression matrix for the genes analyzed in g:Profiler or alternatively an expression data set of all genes. If the expression data set contains additional genes not used for the g:Profiler search, their expression values will still appear in the heat map of the enrichment map (for example file see <bold>Supplementary&#x005F;Table6&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;expression.txt</bold>).</p></list-item>
<list-item>
<p><bold>Ranks</bold> &#x2013; (Optional) Ranks for gene list or for the expression data can also be specified (for example file see <bold>Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rnk</bold></p></list-item>
<list-item>
<p><bold>Classes</bold> &#x2013; (Optional) GSEA cls file defining the phenotype (i.e. biological conditions) of each sample in the expression file, for example file see <bold>Supplementary&#x005F;Table9&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;classes.cls.</bold> Generally, this file is only required when performing phenotype randomization in GSEA, but if it is supplied to enrichment map it is used to identify and label the columns of the expression file in the Enrichment Map heat map by phenotype.</p></list-item>
<list-item>
<p><bold>Phenotypes</bold> &#x2013; (Optional) If there are two different phenotypes in the expression data, update the phenotype labels so that &#x2018;positive&#x2019; represents the phenotype associated with positive values (Mesenchymal in this example) and &#x2018;negative&#x2019; with negative values (Immunoreactive in this example) (<bold>TT11</bold>).</p></list-item>
</list></p>
<p>Tune parameters in the &#x201C;Parameters&#x201D; box:
<list list-type="bullet">
<list-item>
<p>g:Profiler automatically retrieves only statistically significant results (<italic>q</italic>&#x003C;0.05), so the q-value and P-value cutoff parameters can be set in the Enrichment Map Input panel to 1, unless more stringent filtering is desired. For this analysis set FDR <italic>q</italic>-value to 0.01.</p></list-item>
<list-item>
<p>Keep the connectivity slider in the center. If the network is too cluttered because it has too many connections (edges), move the slider to the left to make the network sparser. Alternatively, if the network is too sparse (i.e. there are too many disconnected pathways), move the slider to the right to obtain a more densely connected network (<bold>TT12</bold>).</p></list-item>
<list-item>
<p>Click the &#x201C;Build&#x201D; button at the bottom of the Enrichment Map Input panel.</p></list-item>
</list></p></list-item></list></list-item>
<list-item><label>26</label><p>For GSEA results generated in <bold>Protocol 1B (<xref ref-type="fig" rid="fig5">Figure 5</xref>)</bold>:
<list list-type="roman-lower">
<list-item><p>Click on folder icon to navigate to the GSEA results</p></list-item>
<list-item><p>Click on GSEA folder created in Protocol 1B. Click on Open. (<bold>TT13</bold>)</p></list-item>
<list-item><p>In the right-hand panel, GSEA output files will be auto populated into their specified fields. Alternately the &#x201C;&#x002B;&#x201D; can be clicked to specify each of the required files manually. Equivalent supplementary files that users can specify manually are indicated in brackets.
<list list-type="bullet">
<list-item><p>If desired, modify the &#x2018;dataset&#x2019; name. By default, EM will use the name of the GSEA results folder prior to the first &#x2018;.&#x2019; as the &#x2018;dataset&#x2019; name.</p></list-item>
<list-item><p>Verify the Analysis type is set to &#x201C;GSEA&#x201D;.</p></list-item>
<list-item><p><bold>GMT</bold> &#x2013; Verify that the file is set to [data-directory]/<bold>Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathway s&#x005F;no&#x005F;GO&#x005F;iea&#x005F;July&#x005F;01&#x005F;2017&#x005F;symbol.gmt</bold> (or alternately navigate to the following file: <bold>Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO &#x005F;iea&#x005F;July&#x005F;01&#x005F;2017&#x005F;symbol.gmt)(TT14, TT15</bold>)</p></list-item>
<list-item><p><bold>Enrichments 1</bold> &#x2013; Verify that the file is set to [path&#x005F;to&#x005F;gsea&#x005F;dir]/Mesen&#x005F;vs&#x005F;Immuno.GseaPreranked. [unique number]/gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;pos&#x005F;[unique number].xls where [unique number] is a number generated by GSEA (see TT14) and path&#x005F;to&#x005F;gsea&#x005F;dir is the full path to the directory selected in step 26ii, above, or alternately navigate to the following file: <bold>Supplementary&#x005F;Table7&#x005F;gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;pos.xls</bold></p></list-item>
<list-item><p><bold>Enrichments 2</bold> &#x2013; Verify that the file is set to [path&#x005F;to&#x005F;gsea&#x005F;dir]/Mesen&#x005F;vs&#x005F;Immuno.GseaPreranked. [unique number]/gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;neg&#x005F;[unique number].xls where path&#x005F;to&#x005F;gsea&#x005F;dir is the full path to the directory selected in step 26ii, above, or alternately navigate to the file: <bold>Supplementary&#x005F;Table8&#x005F;gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;neg.xls (TT14)</bold></p></list-item>
<list-item><p><bold>Ranks</bold> &#x2013; Verify that the file is set to [path&#x005F;to&#x005F;gsea&#x005F;dir]/Mesen&#x005F;vs&#x005F;Immuno.GseaPreranked.[unique number]/ranked&#x005F;gene&#x005F;list&#x005F;na&#x005F;pos&#x005F;versus&#x005F;na&#x005F;neg&#x005F;[unique number].xls where path&#x005F;to&#x005F;gsea&#x005F;dir is the full path to the directory selected in step 26ii, above, or alternately navigate to the file: <bold>Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rnk</bold></p></list-item>
</list></p></list-item>
<list-item><p>Specify additional files:
<list list-type="bullet">
<list-item><p><bold>Expression</bold> &#x2013; (Optional) Supplementary&#x005F;Table6&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;expression.txt</p></list-item>
<list-item><p><bold>Classes</bold> &#x2013; (Optional) Supplementary&#x005F;Table9&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;classes.cls</p></list-item>
<list-item><p><bold>Phenotypes</bold> &#x2013; (Optional) In the text boxes replace &#x2018;na&#x005F;pos&#x2019; with "Mesenchymal" and &#x2018;na&#x005F;neg&#x2019; with Immunoreactive. Mesenchymal will be associated with red nodes as it corresponds to the positive phenotype while Immunoreactive will be labeled blue (<bold>TT16, TT17</bold>).</p></list-item>
</list></p></list-item>
<list-item><p>Tune parameters in the &#x201C;Parameters&#x201D; box:
<list list-type="bullet">
<list-item><p>Set FDR q-value cutoff to 0.01 (<bold>TT18</bold>).</p></list-item>
<list-item><p>Keep the connectivity slider in the center. For networks with fewer edges, a sparser network, move the slider to the left. Alternatively, for networks with more edges, a denser network, move the slider to the right (<bold>TT12</bold>).</p></list-item>
</list></p></list-item>
<list-item><p>Click the &#x201C;Build&#x201D; button at the bottom of the Enrichment Map Input panel (<bold>TT6</bold>).</p></list-item>
</list></p></list-item>
<list-item><label>27</label><p><bold><xref ref-type="fig" rid="fig6">Figure 6</xref></bold> shows the resulting enrichment maps from the above g:Profiler and GSEA protocols.</p></list-item>
</list>
<fig id="fig6" position="float"><label>Figure 6</label>
<caption><title>Resulting Enrichment Maps (no manual formatting)</title>
<p>Unformatted enrichment maps generated from Protocols 1A and 1B. Each node (circle) represents a distinct pathway and edges (blue lines) represent the number of genes overlapping between two pathways determined using the similarity coefficient. (A) Enrichment map of significantly mutated cancer driver genes generated using the g:Profiler analysis in Protocol 1A. (B) Enrichment map of pathways enriched in up regulated genes in Mesenchymal (red) and Immunoreactive (blue) ovarian cancer samples using the GSEA analysis in Protocol 1B.</p>
</caption>
<graphic xlink:href="232835_fig6.tif"/></fig>
</sec>
<sec id="s5b3">
<title>TIMING</title>
<p>&#x223C;5 minutes to create Enrichment Map in Cytoscape using Windows7 with 8GB of RAM and Java 8.</p>
</sec>
<sec id="s5c">
<title>Protocol 3 - Navigating and interpreting the Enrichment Map</title>
<p>An enrichment map must be interpreted to discover novel information about a set of data and must be refined to create a publication quality figure.
<list list-type="simple">
<list-item><label>28</label><p>To explore the enrichment map, select the network of interest in the control panel located at the left side of the Cytoscape window and navigate it (zoom and pan) using Cytoscape controls (<bold><xref ref-type="fig" rid="fig7">Figure7A</xref></bold>). Pathways with many common genes often represent similar biological processes and group together as &#x2018;themes&#x2019; in the network. Click on a node to display the corresponding genes in the table below the network view (<bold><xref ref-type="fig" rid="fig7">Figure 7B</xref></bold>).</p></list-item>
</list></p>
<fig id="fig7" position="float"><label>Figure 7:</label>
<caption><title>Overview of Cytoscape panels</title>
<p>(A) Cytoscape control panel that contains networks, styles and select panels as well as the Enrichment Map main panel. (B) The table panel contains tables with node, edge and network attributes. An Enrichment map heat map panel displaying expression for genes associated with selected nodes and edges is available in this panel. (C) Cytoscape search bar. (D) Node table containing values for all variables associated with each node in the network.</p>
</caption>
<graphic xlink:href="232835_fig7.tif"/></fig>
<list list-type="simple">
<list-item><label>29</label><p>To find a gene or pathway of interest, type its name in the search bar located in the top right corner (<bold><xref ref-type="fig" rid="fig7">Figure 7C</xref></bold>). All pathways containing that gene will be highlighted. For example, <italic>TP53</italic> and <italic>BGN</italic> are the top genes in g:Profiler and GSEA analyses, respectively (<bold>TT19</bold>).</p></list-item>
<list-item><label>30</label><p>To find the most enriched pathways, find the column named &#x201C;EM1&#x005F;fdr&#x005F;qvalue&#x201D; (for g:Profiler) or EM1&#x005F;NES&#x201D; (for GSEA) in the &#x2018;Node&#x2019; tab in the table panel (<bold><xref ref-type="fig" rid="fig7">Figure 7C and 7D</xref></bold>). For GSEA, we specifically recommend using the NES (normalized enrichment score) to sort pathways by enrichment strength, whereas we recommend using the enrichment <italic>p</italic>-value for other enrichment methods (<bold>TT21</bold>). Click on the column name to sort the table according to that attribute. Click the greatest value to show the pathway most enriched in the data. To highlight a subset of the pathways in the network, select pathways of interest, right-click on any selected row in the table and select &#x201C;Select nodes from selected rows&#x201D;.</p></list-item>
<list-item><label>31</label><p>When a gene expression matrix is provided as input to enrichment map (<bold>TT21</bold>), we can study the enriched pathway gene expression patterns. Click on an individual node to generate a gene expression heat map in the table panel (<bold><xref ref-type="fig" rid="fig8">Figure 8</xref></bold>). If the analysis is based on GSEA results and a rank file is supplied, the leading-edge genes are highlighted in yellow for individual node selections (<bold>TT22</bold>). To improve the heat map visualization, in the table panel, &#x201C;Heat Map&#x201D; tab, change:
<list list-type="roman-lower">
<list-item><p>Adjust the Sorting options (<bold><xref ref-type="fig" rid="fig8">Figure 8A</xref></bold>) - by default the heat map is sorted by ranks if a rank file is supplied. In the absence of a rank file no sort is applied. Sorting options include hierarchical clustering, ranks, or no sorting (<bold><xref ref-type="fig" rid="fig8">Figure 8F</xref></bold>). Additional rank files can be uploaded through the settings menu in the heat map panel for comparison. Clicking on any of the column names will change the sorting to the selected column. Clicking on the arrow next to the currently sorted column will invert the order of sorting (<bold>TT23</bold>).</p></list-item>
<list-item><p>Define genes you wish to include in the heat map (<bold><xref ref-type="fig" rid="fig8">Figure 8B</xref></bold>) &#x2013; data can be viewed for all genes contained in the selected nodes or just for the genes common to all selected nodes. By default all genes are shown.</p></list-item>
<list-item><p>Change expression value visualization depending on your data type (<bold><xref ref-type="fig" rid="fig8">Figure 8C</xref></bold>) &#x2013; data can be viewed as it was loaded (&#x201C;Values&#x201D;), or row normalized where the row mean is subtracted from every value and then divided by the row&#x2019;s standard deviation (&#x201C;Row Norm&#x201D;), or log transformed (&#x201C;log&#x201D;).</p></list-item>
<list-item><p>Change Expression viewing options (<bold><xref ref-type="fig" rid="fig8">Figure 8D</xref></bold>) &#x2013; By default, all expression values are visible in the heat map for expression sets with 49 or fewer samples. Above that, EM will automatically compress the values to their median value. Other options include no compression (&#x201C;-None-&#x201D;), minimum values (&#x201C;Min&#x201D;), or maximum value (&#x201C;Max&#x201D;).</p></list-item>
<list-item><p>To see the individual expression values, select &#x201C;show values&#x201D; (<bold><xref ref-type="fig" rid="fig8">Figure 8E</xref></bold>).</p></list-item>
<list-item><p>Additional fine tuning of the heat map can be done through the settings panel that includes functionality to add new rank files, export the heat map data as a tab delimited text file or PDF image, change the distance metric for hierarchical clustering, or turn on heat map autofocus (<bold><xref ref-type="fig" rid="fig8">Figure 8F</xref></bold>).</p></list-item>
</list></p>
<p>The resulting heat map can be seen in <bold><xref ref-type="fig" rid="fig8">Figure 8</xref></bold>. Columns headings are colored according to sample phenotype. Red color refers to the first phenotype (Mesenchymal), and blue to the second phenotype (Immunoreactive) (TT24). The heat map can be exported to a text file for further analysis.
<list list-type="bullet">
<list-item><p>Click on &#x201C;Export to txt&#x201D; in heat map settings (<bold><xref ref-type="fig" rid="fig8">Figure 8F</xref></bold>)</p></list-item>
<list-item><p>Specify the name and location of the saved file</p></list-item>
<list-item><p>If only an individual node is selected, a dialog will offer to save the leading edge only. If &#x201C;Yes&#x201D;, only the highlighted genes will be exported, and the entire set is exported otherwise (<bold>TT25</bold>)</p></list-item></list></p>
</list-item>
</list>
<fig id="fig8" position="float"><label>Figure 8:</label>
<caption><title>Example Enrichment Map heat map.</title>
<p>Heat map created by selecting the Immunoreactive pathway interferon alpha beta signaling pathway from Reactome. This heat map is for GSEA results, thus the leading edge genes are highlighted in yellow. Additional controls in the heat map panel include: (A) sorting options, (B) genes to include, (C) expression data visualization options, (D) data compression options, (E) to show values, and (F) adjust settings.</p>
</caption>
<graphic xlink:href="232835_fig8.tif"/></fig>
<list list-type="simple">
<list-item><label>32</label><p>Organize and de-clutter the network
<list list-type="roman-lower">
<list-item><p>If the network has too many nodes, increasing the Node cutoff <italic>q</italic>-value will remove less significant nodes (<bold><xref ref-type="fig" rid="fig7">Figure 7E</xref></bold>).</p></list-item>
<list-item><p>If the network is too interconnected, increasing the edge cutoff (similarity) threshold will remove less pronounced edges between nodes (<bold><xref ref-type="fig" rid="fig7">Figure 7F</xref></bold>).</p></list-item>
<list-item><p>The network layout may be applied again after adjusting the cutoffs (see the Layout menu in Cytoscape). The default layout algorithm is the unweighted prefuse force-directed layout. We also recommend the yFiles organic layout or weighted prefuse force-directed layouts. (<bold>TT26</bold>)</p></list-item>
<list-item><p>To restore nodes or edges, adjust threshold sliders to their original positions.</p></list-item>
<list-item><p>It can be helpful to separate the two different phenotypes (i.e. place all the red nodes to one side and all blue nodes to the other). To do this:
<list list-type="bullet">
<list-item><p>Click on the select tab in the control panel (<bold><xref ref-type="fig" rid="fig7">Figure 7A</xref></bold>)</p></list-item>
<list-item><p>Click on the &#x201C;&#x002B;&#x201D; and select &#x201C;Column filter&#x201D;</p></list-item>
<list-item><p>Click on &#x201C;Choose column.&#x201D; and select &#x201C;EM1&#x005F;NES (Mesem&#x005F;vs&#x005F;Immuno)&#x201D;</p></list-item>
<list-item><p>Click on the box next to &#x201C;between&#x201D; and change the value to zero. Click &#x201C;Enter&#x201D;</p></list-item>
<list-item><p>All red nodes should now be selected. Click and hold on any selected node and drag selection to the left until it does not overlap any blue nodes</p></list-item>
<list-item><p>Click on Layouts menu. Select &#x201C;Prefuse Force Directed Layout&#x201D; --&#x003E; &#x201C;Selected Node Only&#x201D;<bold>&#x2192;</bold>&#x201C;(none)&#x201D; (<bold>TT26</bold>)</p></list-item>
<list-item><p>In the Select tab, adjust slider to select all negative values. Click on &#x201C;Apply&#x201D; at the bottom of the Select tab</p></list-item>
<list-item><p>All blue nodes should now be selected. Click and hold on any selected node and drag selection to the right until it does not overlap any red nodes</p></list-item>
<list-item><p>Click on Layouts menu. Select &#x201C;Prefuse Force Directed Layout&#x201D; --&#x003E; &#x201C;Selected Node Only&#x201D;<bold>&#x2192;</bold>&#x201C;(none)&#x201D; (<bold>TT26</bold>)</p></list-item>
</list>
</p></list-item>
</list>
</p></list-item>
<list-item><label>33</label><p>Define major themes. Enrichment maps typically include clusters of similar pathways representing major biological themes. Clusters can be automatically defined and summarized using the AutoAnnotate Cytoscape app. AutoAnnotate first clusters the network using the clusterMaker app and then summarizes each cluster based on word frequency within the pathway names via the WordCloud app (<bold>TT27, TT28</bold>).
<list list-type="roman-lower">
<list-item><p>Launch AutoAnnotate by selecting Apps<bold>&#x2192;</bold>AutoAnnotate<bold>&#x2192;</bold>New Annotation Set. in the Cytoscape menu bar. The &#x201C;AutoAnnotate&#x201D; tab will appear in the Cytoscape control panel.</p></list-item>
<list-item><p>Click on &#x201C;&#x002B;&#x201D; in the AutoAnnotate panel.</p></list-item>
<list-item><p>The &#x201C;AutoAnnotate: create Annotation Set&#x201D; panel will appear.</p></list-item>
<list-item><p>In the &#x201C;Quick Start&#x201D; tab click on &#x201C;Create Annotations&#x201D; (<bold>TT29</bold>).</p></list-item>
<list-item><p>Each cluster in the network will have a circle annotation drawn around it and will be associated with a set of words (by default three) that appear most in the node description fields. Moving individual nodes within a cluster will automatically resize the surrounding circle annotation and moving an entire cluster will redraw the annotations in the new cluster location (<bold>TT30</bold>).</p></list-item>
<list-item><p>Manually arrange clusters to clean up the figure. Move nodes to reduce node and label overlap. <bold><xref ref-type="fig" rid="fig9">Figure 9</xref></bold> shows the results of this process.</p></list-item>
</list></p></list-item></list>
<fig id="fig9" position="float"><label>Figure 9</label>
<caption><title>Resulting Publication Ready Enrichment Map</title>
<p>Publication-ready annotated enrichment map (created with parameters FDR <italic>q</italic>-value &#x003C; 0. 01, and combined coefficient &#x003E;0.375 with combined constant &#x003D; 0.5). Red and blue nodes represent mesenchymal and immunoreactive phenotype pathways, respectively, and were manually separated to form a clearer picture. Clusters of nodes were labelled using the AutoAnnotate Cytoscape app. Individual node labels were removed for clarity using the publication ready button in Enrichment Map and exported to PNG and PDF files. The figure was resized using illustration software but no additional modifications were made to the network.</p>
</caption>
<graphic xlink:href="232835_fig9.tif"/></fig>
<list list-type="simple">
<list-item><label>34</label><p>Create a simplified network view (<bold><xref ref-type="fig" rid="fig10">Figure 10</xref></bold>). This creates a single group node for every cluster with a summarized name and provides an overview of the enrichment result themes that is useful for enrichment maps containing many nodes.</p>
<list list-type="order">
<list-item><p>In the Cytoscape Control Panel select the &#x201C;AutoAnnotate&#x201D; Tab.</p></list-item>
<list-item><p>Click on the Menu icon in the upper right hand corner.</p></list-item>
<list-item><p>Select &#x201C;Collapse All&#x201D; (<bold>TT31, TT32, TT33</bold>).</p></list-item>
<list-item><p>Scale collapsed network for better viewing:
<list list-type="roman-lower">
<list-item><p>In the Cytoscape menu bar, select: View &#x2192; Show Tool Panel.</p></list-item>
<list-item><p>Go to Tool Panel located at the bottom of the Control Panel.</p></list-item>
<list-item><p>Click on the &#x201C;Scale&#x201D; Tab.</p></list-item>
<list-item><p>Move slider left to tighten the node spacing.</p></list-item>
</list>
</p></list-item></list></list-item></list>
<fig id="fig10" position="float"><label>Figure 10</label>
<caption><title>Collapsed Enrichment Map</title>
<p>The network was further summarized by collapsing node clusters using the AutoAnnotate app. The network was scaled for better node distribution and manually adjusted to reduce node and label overlap. The enrichment map was exported to PNG and PDF. No additional modifications were made to the network in any illustration software tools.</p>
</caption>
<graphic xlink:href="232835_fig10.tif"/></fig>
<list list-type="simple">
<list-item><label>35</label><p>Manually arranging the network nodes and custom labeling the major themes is required for the clearest network view and for a publication quality figure.
<list list-type="roman-lower">
<list-item><p>For instance, it is useful to bring together similar themes, such as signaling or metabolic pathways, even if they are not connected in the map.</p></list-item>
<list-item><p>If the focus of the figure is only on a subset of the network, it can be easier to work with just the subset. To create this, select the nodes of interest, then in the Cytoscape menu bar Select File<bold>&#x2192;</bold>New<bold>&#x2192;</bold>Network<bold>&#x2192;</bold>From selected nodes, all edges.</p></list-item>
<list-item><p>When the purpose of the figure is to show a large network highlight only the main themes, clicking on &#x201C;Publication ready&#x201D; in the enrichment map panel will remove node labels. To revert to the original network, click on the &#x201C;Publication ready&#x201D; button again.</p></list-item>
</list></p></list-item>
<list-item><label>36</label><p>Create a sub network that highlights a specific theme or data &#x2013; often enrichment maps generated from platforms that measure signals from a large percentage of the genome are large and complicated. When generating a figure, it is important to highlight specific themes or pathways relevant to the analysis in question. For example, we will select the top mesenchymal and immunoreactive pathways and create a sub network containing them.
<list list-type="roman-lower">
<list-item><p>Click on the select tab in the control panel (<bold><xref ref-type="fig" rid="fig7">Figure 7A</xref></bold>).</p></list-item>
<list-item><p>Click on the &#x201C;&#x002B;&#x201D; and select &#x201C;Column filter&#x201D;.</p></list-item>
<list-item><p>Click on &#x201C;Choose column.&#x201D; and select &#x201C;EM1&#x005F;NES (Mesem&#x005F;vs&#x005F;Immuno)&#x201D;.</p></list-item>
<list-item><p>Click on the box next to &#x201C;between&#x201D; and change the value to 2.5. Click &#x201C;Enter&#x201D;.</p></list-item>
<list-item><p>Click on the &#x201C;&#x002B;&#x201D; and select &#x201C;Column filter&#x201D;.</p></list-item>
<list-item><p>Click on &#x201C;Choose column.&#x201D; and select &#x201C;EM1&#x005F;NES (Mesem&#x005F;vs&#x005F;Immuno)&#x201D;.</p></list-item>
<list-item><p>Click on the box next to &#x201C;inclusive&#x201D; and change the value to &#x002D;2.5. Click &#x201C;Enter&#x201D;.</p></list-item>
<list-item><p>Above the two column filters you just added, change the drop down from &#x201C;Match all (AND)&#x201D; to &#x201C;Match any (OR)&#x201D;.</p></list-item>
<list-item><p>Click on Apply. Under the apply button, it should say &#x201C;Selected 32 nodes and 0 edges in Xms&#x201D;. The exact number of seconds specified will depend on your computer speed.</p></list-item>
<list-item><p>Select File<bold>&#x2192;</bold>New<bold>&#x2192;</bold>Network<bold>&#x2192;</bold>From selected nodes, all edges.</p></list-item>
<list-item><p>A new smaller network should appear. Manually move nodes around for optimal layout.</p></list-item>
<list-item><p>Annotate network as described in step 6 (<xref ref-type="fig" rid="fig11">Figure 11</xref>).</p></list-item>
</list></p></list-item></list>
<fig id="fig11" position="float"><label>Figure 11</label>
<caption><title>Subnetwork Example</title>
<p>Sub network of the main Enrichment Map figure (<xref ref-type="fig" rid="fig9">Figure 9</xref>) manually created by selecting pathways with the top NES values and creating a new network from the selection. Red and blue nodes are mesenchymal and immunoreactive phenotypes, respectively. Clusters of nodes were automatically labelled using the AutoAnnotate Cytoscape app. Annotations in the subnetwork may differ slightly from the main network as word counts were normalized on a network basis.</p>
</caption>
<graphic xlink:href="232835_fig11.tif"/></fig>
<list list-type="simple">
<list-item><label>37</label><p>Export the image (<bold>TT34</bold>)
<list list-type="roman-lower">
<list-item><p>In the Cytoscape menu bar, select File &#x2192; Export as Image&#x2026;</p></list-item>
<list-item><p>Set &#x201C;Select the export file format&#x201D; to PDF (<bold>TT35</bold>).</p></list-item>
<list-item><p>Click on &#x201C;Browse.&#x201D; to specify file name and location.</p></list-item>
<list-item><p>Click on &#x201C;Save&#x201D; to close the browser window and then on &#x201C;OK&#x201D;.</p></list-item>
<list-item><p>A window &#x201C;Export Network&#x201D; will appear, click on the &#x201C;OK&#x201D; button.</p></list-item>
</list></p></list-item>
<list-item><label>38</label><p>Get network creation parameters. In the previous step we exported the network as an image but there is information that either needs to be included in the text legend or as a pictograph within the image itself so the network can be easily interpreted. It is important to include the thresholds used when creating the map.
<list list-type="roman-lower">
<list-item><p>In the Enrichment Map Input panel click on the cog (settings) icon in the top right hand corner.</p></list-item>
<list-item><p>Click on show legend.</p></list-item>
<list-item><p>In the EnrichmentMap Legend panel click on the &#x201C;Creation Parameters&#x2026;&#x201D;</p></list-item>
<list-item><p>In the displayed panel you will find the thresholds to be added to the figure legend. Add FDR <italic>q</italic>-value, similarity metric and threshold to text legend of figure. For example: &#x201C;Enrichment map was created with parameters <italic>q</italic> &#x003C; 0.01, and combined coefficient &#x003E;0.375 with combined constant &#x003D; 0.5 (<bold>TT36</bold>)&#x201D;.</p></list-item>
</list></p></list-item>
<list-item><label>39</label><p>Create a legend - there are many different node and edge attributes used in the enrichment map to represent different aspects of the data. It is important to add their meaning in the text legend or as a pictograph in the figure. Although Cytoscape has the ability to export a legend of the current style, it is not easily transferrable as a legend for the resulting figure. <bold><xref ref-type="fig" rid="fig12">Figure 12</xref></bold> shows the basic legend components (available as SVG and PDF images at <ext-link ext-link-type="uri" xlink:href="http://baderlab.org/Software/EnrichmentMap#Legends">http://baderlab.org/Software/EnrichmentMap#Legends)</ext-link>) that can be used for an enrichment map figure. Only include components relevant to the given analysis. See bottom of <bold><xref ref-type="fig" rid="fig9">Figure 9</xref></bold> for components used for current analysis.</p></list-item>
</list>
<fig id="fig12" position="float"><label>Figure 12</label>
<caption><title>Generic enrichment map legend</title>
<p>Enrichment map attributes that can be copied for use in a figure legend. Only include components relevant to the analysis depicted in the figure. Post analysis &#x2018;Signature set&#x2019; nodes are included in the generic legend even though they are not covered in this protocol. Post analysis nodes are used to highlight pathways in the enrichment map that contain genes of interest such as drug or microRNA targets.</p>
</caption>
<graphic xlink:href="232835_fig12.tif"/></fig>
<fig id="fig13" position="float">
<graphic xlink:href="232835_fig13.tif"/></fig>
<list list-type="simple">
<list-item><label>40</label><p>Save Cytoscape session (<bold>TT37</bold>). File<bold>&#x2192;</bold>Save as. Navigate to the directory you wish to save the session and specify the desired file name.</p></list-item>
</list>
<sec id="s5c1">
<title>TIMING</title>
<p>&#x223C;4 hours to analyze and annotate Enrichment Map using Cytoscape on Windows7 with 8GB of RAM and Java 8 (<bold>TT38</bold>).</p>
</sec>
</sec></sec>
<sec id="s6">
<title>TROUBLESHOOTING</title>
<p><bold>TT1.</bold> On launching GSEA on macOS for the first time, you may get the error &#x201C;&#x2018;gsea.jnlp&#x2019; can&#x2019;t be opened because it is from an unidentified developer&#x201D;. Click on &#x201C;Ok&#x201D;. Instead of double clicking on the gsea.jnlp icon/file, right click and select &#x201C;open&#x201D;. The same error &#x201C;&#x2019;gsea.jnlp&#x2019; can&#x2019;t be opened because it is from an unidentified developer&#x201D; will appear but this time it will give you the option to &#x201C;Open&#x201D; or &#x201C;Cancel&#x201D;. Click on &#x201C;Open&#x201D;. After this initial opening, subsequent double clicks on gsea.jnlp will launch GSEA without any errors or warnings. If GSEA still fails to launch through the Java Web Start downloaded from the GSEA website, GSEA can be alternatively be launched from the command line. Go to the GSEA download site and download javaGSEA JAR file (the second option on the download site). Open a command line terminal. On macOS, the terminal can be found in Applications -&#x003E; Utilities -&#x003E; Terminal. On Windows type &#x201C;cmd&#x201D; in the windows program files search bar. Then navigate to the directory where the file javaGSEA.jar was downloaded using the command cd. For example, on macOS run &#x201C;cd &#x223C;/Downloads&#x201D; if you downloaded the GSEA jar to your downloads folder. Run the command java -Xmx4G - jar gsea-3.o.jar where -Xmx specifies how much memory is given to GSEA.</p>
<p><bold>TT2.</bold> It may take 5-10 seconds for GSEA to load input files. The files are loaded successfully once a message appears on the screen &#x201C;Files loaded successfully: 2/2. There were no errors&#x201D;.</p>
<p><bold>TT3.</bold> GSEA also supplies its own gene set files that are accessible directly through the GSEA interface from the MSigDB resource<sup><xref ref-type="bibr" rid="c47">47</xref>,<xref ref-type="bibr" rid="c48">48</xref></sup>. These files do not need to be imported into GSEA. When you define the GMT file, the MSigDB gene set files can be found in the first tab &#x201C;Gene Matrix (from website)&#x201D; of the &#x201C;Select one or more genesets&#x201D; dialog. The latest versions of the MSigDB gene set files are in bold but previous versions can also be accessed. To select multiple gene set files, use multi-file select by simultaneously clicking on the desired files and holding the control key on Windows or command on macOS.</p>
<p><bold>TT4.</bold> The higher the number of permutations the longer the analysis will take. To calculate the FDR <italic>q</italic>-value for each gene set, the data is randomized by permuting the genes in each gene set and recalculating the p-values for the randomized set. This parameter specifies how many times this randomization is done. The more randomizations are performed, the more precise the FDR q-value estimation will be (to a limit, as eventually the FDR q-value will stabilize at the actual value). On a Windows machine with 16G of RAM and i7 3.4 GHz processor, an analysis with 10,100, 500, or 1000 randomizations on our example set with above defined parameters takes 155, 224, 544, and 1012 seconds, respectively.</p>
<p><bold>TT5.</bold> GSEA has no progress bar to indicate estimated time to completion. A run can take a few minutes or hours depending on your data size and computer speed. Click on the &#x201C;&#x002B;&#x201D; in the bottom left corner of the screen to see messages such as &#x201C;shuffleGeneSet for GeneSet 4661/4715 nperm: 1000&#x201D; (circled in red at the bottom of <xref ref-type="fig" rid="fig2">Figure 2</xref>). This message indicates that GSEA is shuffling 4,715 gene sets 1,000 times each, 4,661 of which are complete. Once the permutations are complete, GSEA generates the report.</p>
<p><bold>TT6.</bold> The error message &#x201C;Java Heap space&#x201D; indicates that the software has run out of memory. Another version of GSEA is needed in case you are running the Web Start application. There are multiple options available for download from the GSEA website. You can download a webstart application that launches GSEA with 1, 2, 4, or 8GB. Upgrade to a webstart that launches with more memory. If you are already using the webstart that launches with 8GB then you require GSEA JAVA jar file which can be executed from the command line with increased memory (see TT1 for details).</p>
<p><bold>TT7.</bold> If the GSEA software is closed, you can still see the results by opening the working folder and opening the &#x2018;index.html&#x2019; file. Alternatively, you can re-launch GSEA, and click on &#x201C;Analysis history&#x201D;, then &#x201C;History&#x201D; and then navigate to date of your analysis. Although all analyses, regardless of where the results files were saved, are listed under history, it is organized by date the analysis was run. If you can&#x2019;t remember when you ran a specific analysis, then you may have to manually search through a few directories to find the desired analysis.</p>
<p><bold>TT8.</bold> When running GSEA with expression data as input (instead of a pre-calculated rank file), a phenotype label (i.e. biological condition or sample class) is provided as input for each sample and specified in the GSEA &#x2018;cls&#x2019; file. When running GSEA, the two phenotypes to compare for differential gene expression analysis are specified and these phenotypes are used in the pathway enrichment result files. In contrast, in a GSEA preranked analysis (i.e. when a ranked gene list is provided by the user), GSEA automatically labels one phenotype &#x201C;na&#x005F;pos&#x201D; (corresponding to enrichment in the genes at the top of the ranked list, where &#x2018;na&#x2019; means the phenotype label &#x2018;not available&#x2019;) and the other &#x201C;na&#x005F;neg&#x201D; (corresponding to enrichment in the genes at the bottom of the ranked list). This convention is also used by the Enrichment Map software, designating the first phenotype as &#x201C;positive&#x201D; and the second phenotype as &#x201C;negative&#x201D;.</p>
<p><bold>TT9.</bold> Check the number of gene sets that were analyzed. If the number is low (e.g. low hundreds), it could indicate gene ID mapping problems.</p>
<p><bold>TT10.</bold> To simplify loading g:Profiler results into Enrichment Map and populating the correct fields in the EM interface, place the g:Profiler results file and gene set file (i.e. Supplementary&#x005F;Table4&#x005F;gprofiler&#x005F;results.txt and Supplementary&#x005F;Table5&#x005F;hsapiens.pathways.NAME.gmt) into a directory together.</p>
<p><bold>TT11.</bold> Although an individual g:Profiler analysis only has one phenotype, it is possible to modify a single results file to contain two analyses. This is relevant when the phenotypes are mutually exclusive. For the analysis you want to associate with the additional phenotype (which would correspond to down-regulated genes in GSEA PreRanked, thus encoded as &#x201C;negative&#x201D;) open the g:Profiler results file (preferably in a spreadsheet so you can easily modify a single column). The fifth column specifies the phenotype. Update the column to have the value of &#x201C;-1&#x201D; for each result in the file. Open the second analysis file. Copy all the results from the second file and paste them into the updated negative g:Profiler file. Save the file and use it as the g:Profiler enrichment results file in the EM interface instead of the original results files. Pathways corresponding to two phenotypes will be colored red and blue in the resulting enrichment map. One limitation with this approach is that a pathway cannot be included in both positive and negative sets.</p>
<p><bold>TT12.</bold> Moving the slider to the left (or right) will adjust the underlying similarity statistic threshold to make the resulting network sparser (denser). The slider is set with predefined defaults but users can fine-tune the similarity metric by selecting &#x2018;Show advanced options&#x2019; at the bottom of the &#x2018;Create Enrichment Map&#x2019; panel. Predefined values appear as tick marks on the slider and include Jaccard &#x003E; 0.35, Jaccard &#x003E; 0.25, combined &#x003E; 0.375, overlap &#x003E; 0.5, overlap &#x003E; 0.25.</p>
<p><bold>TT13.</bold> If you specify a directory that contains multiple GSEA results rather than an individual GSEA results folder, EM will treat every GSEA results folder as its own data set. This enables easy multi-data set analyses. If you only wanted one data set but inadvertently selected the directory containing multiple GSEA results instead of selecting an individual folder, simply select the data sets you do not want to use and click on the trash can at the top of the EM input panel.</p>
<p><bold>TT14.</bold> Every GSEA analysis generates a random number that is appended to the names of the files and directories. The number will be different for every new analysis.</p>
<p><bold>TT15.</bold> If Enrichment Map cannot find the original GMT file used in the GSEA analysis, it will use a filtered GMT file found in the GSEA &#x2018;edb&#x2019; results directory. Enrichment map will not be able to find your original GMT file if you have moved it since running GSEA analysis. Although it is a GMT file, it has been filtered to contain only genes found in the expression file. If you use this filtered file, you will get different pathway connectivity depending on the expression data being used. We recommend using original GMT file used for the GSEA analysis and not the filtered one in the results directory.</p>
<p><bold>TT16.</bold> To annotate the phenotypes in the Enrichment Map heat map, the specified phenotype labels need to exactly match the GSEA CLS file.</p>
<p><bold>TT17.</bold> If you load the CLS file prior to specifying the phenotypes, EM will automatically guess the phenotypes from the class file. If your class file specifies more than two phenotypes, EM will choose the first two phenotypes defined in the file.</p>
<p><bold>TT18.</bold> To set the threshold to a small number, select &#x2018;Scientific Notation&#x2019; and set a q-value cutoff such as 1E-04.</p>
<p><bold>TT19.</bold> Multiple genes separated by spaces can be entered into the search bar. Any pathway that contains the gene will be selected and highlighted in the network. Adding keywords &#x201C;AND&#x201D; into the search bar will show only pathways that contain all genes in the search query. If the analysis was not done using gene symbols then you will not be able to search by gene symbols. Instead use the identifier the analysis was based on, for example Entrez gene ID or Ensembl gene ID.</p>
<p><bold>TT20.</bold> If there are very few records in the node table make sure that no nodes are selected in the network. Click on the gear icon and change the setting from &#x201C;Auto&#x201D; to &#x201C;Show all&#x201D;.</p>
<p><bold>TT21</bold>. If no expression file is given to Enrichment Map it will automatically create a dummy expression file where any gene found in the enrichment file will be given a placeholder expression value of 0.25, and any gene found in a pathway but not found in the enrichment results file be assigned a placeholder expression value of NA. Therefore clicking on any node in the enrichment map will show the genes used for the analysis as well as genes in the pathway but not part of the query set.</p>
<p><bold>TT22.</bold> The leading edge can be displayed only if the rank file is provided when the network is built. The rank file supplied needs to be identical to the one used for the GSEA analysis for the leading edge calculation to be accurate.</p>
<p><bold>TT23.</bold> In case of multiple conditions or conditions with variable expression profiles (e.g. cancer patient samples), hierarchical clustering tends to generate a more informative visualization.</p>
<p><bold>TT24.</bold> If the heat map columns are not colored for a GSEA analysis, make sure the phenotype names specified in the Enrichment Map input panel match the class names specified in the class file (MesenchymalvsImmunoreactive&#x005F;RNA-Seq&#x005F;classes.cls)</p>
<p><bold>TT25.</bold> Leading edge is only available for GSEA analyses. The option will only appear if the Enrichment map was built with GSEA results and a rank file was specified.</p>
<p><bold>TT26.</bold> There are many different layout algorithms available in Cytoscape that can be used for Enrichment Map. We recommend using an edge weighted layout, which considers the overlap score between pathways. Most layouts offer the ability to organize just the selected nodes (except for yFiles layouts). Experiment with different layouts to see which works best with your data. If you do not like layout results simply press command-Z on macOS or ctrl-Z on Windows or click on Edit --&#x003E; Undo to revert to the previous view.</p>
<p><bold>TT27.</bold> If particular non-informative words keep appearing in the labels generated by AutoAnnotate, try adjusting the WordCloud normalization factor. The significance of each word is calculated based on the number of occurrences in the given cluster of pathways. This causes frequent words such as &#x201C;pathway&#x201D; or &#x201C;regulation&#x201D; to be prominent. By increasing the normalization factor, we reduce the priority of such recurrent words in cluster labels. If that doesn&#x2019;t help you can add the non-informative words to the WordCloud word exclusion list.</p>
<p><bold>TT28.</bold> If a specific character is used to separate words besides space (for example &#x201C;-&#x201C; or &#x201C;|&#x201D;), it should be added as a delimiter in the WordCloud app. Launch the WordCloud App (Apps<bold>&#x2192;</bold>WordCloud). In the WordCloud input panel expand Advanced options. Click on &#x201C;Delimiters.&#x201D;. Add your delimiters. Click on OK. In the AutoAnnotate input panel click on the menu button. Select &#x201C;Recalculate Labels.&#x201D; for this change to take effect.</p>
<p><bold>TT29.</bold> The default parameters are likely to work well with Enrichment Map, however there are many parameters within the AutoAnnotate app that can fine-tune the results. See the AutoAnnotate user manual at <ext-link ext-link-type="uri" xlink:href="http://www.baderlab.org/Software/AutoAnnotate/UserManual">http://www.baderlab.org/Software/AutoAnnotate/UserManual</ext-link>.</p>
<p><bold>TT30.</bold> The number of nodes in a cluster determines label size by default. Thus, the cluster size may related to pathway popularity instead of importance in the experiment. Annotation labels can all be set to the same size by unchecking the option &#x201C;Scale font by cluster size&#x201D; in the AutoAnnotate results panel.</p>
<p><bold>TT31.</bold> Once you click on &#x201C;Collapse All&#x201D; a pop-up window will show the message &#x201C;Before collapsing clusters please go to the menu Edit-&#x003E;Preferences-&#x003E;Group preferences and select &#x201C;Enable attribute aggregation&#x201D;. There is no need to adjust this parameter repeatedly. Click on &#x201C;Don&#x2019;t ask me again&#x201D; and &#x201C;OK&#x201D; if you have set this parameter previously.</p>
<p><bold>TT32.</bold> For large networks, collapsing and expanding may take time. For a quick view of the collapsed network you can create a summary network by selecting the &#x201C;Create summary Network&#x2026;&#x201D;. There are two options for the summary network: &#x201C;clusters only&#x201D; which creates a summary network with just the circled clusters, or &#x201C;clusters and unclustered nodes&#x201D; which creates a summary network that also includes the singleton nodes not part of any cluster.</p>
<p><bold>TT33.</bold> If the nodes in the resulting collapsed network are grey then you forgot to enable attribute aggregation. Expand clusters and refer to <bold>TT31</bold> before collapsing again.</p>
<p><bold>TT34.</bold> In image export, only the visible part of the map will be exported. Make sure that the entire network is visible on your screen before exporting.</p>
<p><bold>TT35.</bold> Vector-based PDF and SVG formats are recommended for publication quality figures because they can zoom without losing quality. Either file type can be edited using software packages such as Adobe Illustrator or Inkscape. The PNG file format is recommended for high-quality online images while the JPG format is not recommended because it may lead to visual artefacts due to compression.</p>
<p><bold>TT36.</bold> The creation parameters panel only shows the parameters that were used at network creation. If you modified the network using filters or the EM slider bars you will have to update the changed thresholds accordingly.</p>
<p><bold>TT37.</bold> If a session is saved that contains a collapsed Enrichment Map, it will automatically be expanded before it is saved. Depending on the size of the network this might take a few minutes. Enrichment Map will not automatically collapse nodes that were previously collapsed when reopening the session. To keep them collapsed, recollapse them using the AutoAnnotate app as done previously.</p>
<p><bold>TT38.</bold> The time required for this protocol depends on the amount of manual curation and visual organization spent on the enrichment map. Smaller networks are generally easier to organize. Before spending the time laying out the final network, it is worth revisiting the enrichment analysis, exploring the network fully and selecting the parts to emphasize in a final publication quality figure.</p>
</sec>
</body>
<back>
<sec id="s7">
<title>Author contributions</title>
<p>J.R., R.I., V.V., A.R., D.M., G.D.B. wrote the manuscript. R.I created the step-by-step protocols, figures, R scripts and R notebooks, except for g:Profiler (J.R.). M.K, C.T.L. developed Enrichment Map 3.0, and AutoAnnotate Cytoscape apps. L.W., M.M., J.W., C.X., V.V. tested the protocol. All authors read and approved the final manuscript.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>The authors are grateful to Jill Mesirov for comments on the manuscript. This project was supported by an Investigator Award to JR from the Ontario Institute for Cancer Research through funding provided by the Government of Ontario. This work was supported by U.S. National Institutes of Health grants P41 GM103504, R01 GM070743, U41 HG006623, R01 CA121941 to GDB.</p>
</ack>
<sec id="s8">
<boxed-text id="box1" position="float">
<sec>
<title>BOX 1 - Definitions</title>
<p><bold>Pathway</bold> &#x2013; genes that work together to carry out a biological process.</p>
<p><bold>Gene set</bold> &#x2013; A set of related genes. A &#x2018;pathway gene set&#x2019; includes all genes in a pathway. Gene sets can be based on various relationships between genes, such as cellular localization (e.g., nuclear genes) or enzymatic function (e.g., protein kinases). Details such as protein interactions are not included.</p>
<p><bold>Gene list of interest</bold> &#x2013; the list of genes derived from an &#x2013;<italic>omics</italic> experiment that is input to pathway enrichment analysis.</p>
<p><bold>Ranked gene list</bold> &#x2013; In many &#x2013;<italic>omics</italic> data (e.g. RNA-seq for gene expression) genes can be ranked according to some score (e.g. level of differential expression) to provide more information for pathway enrichment analysis. Pathways enriched in genes clustered at the top of a ranked list would score higher than if the pathway genes are randomly scattered across the ranked list.</p>
<p><bold>Pathway enrichment analysis</bold> &#x2013; a statistical technique to identify pathways that are significantly represented in a gene list or ranked gene list of interest.</p>
<p><bold>Multiple testing correction</bold> &#x2013; Thousands of pathways may be individually tested for enrichment and this could lead to significant enrichment p-values appearing by chance alone. Multiple testing correction is a statistical technique to correct the p-values from individual enrichment tests to address this problem and reduce the chance of false positive enrichment (<bold><xref ref-type="boxed-text" rid="box3">Box 3</xref></bold>).</p>
</sec>
</boxed-text>
<boxed-text id="box2" position="float">
<sec>
<title>BOX 2 - Experimental design and data quality</title>
<p>Pathway enrichment analysis benefits greatly from careful experimental design. Otherwise the analysis may reveal apparently meaningful results caused by experimental biases or other confounders.</p>
<p><bold>Experimental conditions.</bold> The experimental conditions must be well defined such that the major variations observed are responses which the experimenter would like to monitor, related to the biological question of interest <italic>(e.g.,</italic> tumour <italic>vs.</italic> normal, treated <italic>vs.</italic> untreated, comparison of four disease subtypes, time series).</p>
<p><bold>Number of replicates.</bold> Biological replicates are independently processed samples obtained from distinct organisms or cell lines that are required for measuring variability across samples and to compute statistics <italic>(e.g.,</italic> p-values). Lack of replication (i.e. one sample per group) will not permit robust estimation of the significance of the signal. Insufficient replication may result in lack of signal in the data (e.g. no significant differentially expressed genes). The larger the variation in the set of samples, the more biological replicates are needed to accurately measure signal. For systems with lower variability (i.e. model organisms with the same genetic background in controlled laboratory conditions, or stable cell lines derived from the same clone), at least 3-4 biological replicates are recommended per condition for differential analysis with variance stabilization normalization. Variance stabilization uses a global statistical model to &#x201C;stabilize&#x201D; gene-wise variance estimates to reduce inaccuracies resulting from few replicates. For experiments with higher variability (e.g. tumor samples), more replicates are required; ideally, a pilot experiment followed by formal power calculations should be used to determine the minimal number of replicates required to identify signal of differentially expressed genes or enriched pathways. Technical replicates comprising repeated experiments of the same samples are usually not needed for well-established experimental techniques that have low technical variability, like RNA-seq, but can be helpful for novel techniques.</p>
<p><bold>Confounding factors.</bold> Differences in factors not related to the experimental question should be avoided or at least balanced across conditions so that statistical techniques such as generalized linear models can correct for each factor. Common factors include sequencing batch, nucleic acid extraction protocol, subject age and many others. Otherwise it may be impossible to accurately separate the experimental signals coming from the experimental response and confounding factors. Knowing important factors in advance supports correct experimental design. Statistical exploratory analyses such as clustering or principal component analysis (PCA) can help identify unknown factors. For example, cases and controls are expected to cluster separately and not by processing batch.</p>
<p><bold>Outliers.</bold> Outlier samples may considerably differ from others because of major experimental or technical problems, such as contamination or sample mix-up. Alternatively, they may present extreme biological features, such as tumour samples with exceptionally aggressive phenotypes. Unbiased identification of outlier samples is possible using statistical techniques such as PCA or clustering. Pathway enrichment analysis should be performed with and without outliers to ensure robust results. Systematic removal of outliers may be justified to reduce variability in the experiment.</p>
<p><bold>Experimental sensitivity.</bold> Some experimental methods can be tuned to be more or less sensitive. For instance, the number of reads in RNA-seq experiments influences downstream analysis. For quantifying gene expression in a biological system with modest variability and testing differential expression with variance stabilization, at least three to five replicates and ten million mapped reads are required<sup><xref ref-type="bibr" rid="c49">49</xref></sup>. Substantially greater sequencing depth, such as 50-100 million mapped reads, is required to investigate splice isoforms, to detect low-expressed genes or for samples with complex cellular mixtures such as surgical resection specimens.</p>
</sec>
</boxed-text>
<boxed-text id="box3" position="float">
<sec>
<title>BOX 3 - Statistical Tests used in Pathway Enrichment Analysis</title>
<p>A common statistical test used for pathway enrichment analysis of a gene list is a Fisher&#x2019;s exact test, based on the hypergeometric distribution. It determines whether the fraction of genes of interest in the pathway is higher compared to the fraction of genes outside the pathway (i.e. background set). Since this test was first introduced<sup><xref ref-type="bibr" rid="c50">50</xref></sup>, many improved tests have been developed<sup><xref ref-type="bibr" rid="c51">51</xref></sup> that take advantage of continuous experimental scores and avoid applying arbitrary thresholds. We categorize types of statistical enrichment tests as follows:</p>
<p>1. <bold>Ranked vs. non-ranked tests.</bold> Ranked tests take as input a ranked gene list, while non-ranked tests such as Fisher&#x2019;s exact test take as input a gene list of interest. Ranked tests are preferable for experiments that produce meaningful ranks such as differential gene expression, because arbitrary thresholds can be avoided. Non-ranked tests are preferable for experiments that naturally generate a gene list of interest (e.g., somatic mutations in cancer, proteins that interact with a bait protein). Examples of ranked tests include the modified Fisher&#x2019;s exact test implemented in the g:Profiler &#x2018;ordered query&#x2019; option, and the modified Kolmogorov-Smirnov test implemented in GSEA.</p>
<p>2. <bold>Exact vs. permutation-based tests.</bold> Exact tests employ a mathematical model (e.g. a distribution) to directly compute an exact p-value. Permutation-based tests utilize data resampling to estimate an empirical p-value, typically expressed as number of permutations with results as good as or better than the ones observed for real data, divided by the number of permutations. For example, in a case-control study, we can randomize the case and control labels 1,000 times, each time repeating the pathway enrichment analysis to see how frequently we observe an equal or stronger pathway enrichment signal. Permutation tests can be customized to consider specific data properties and biases. Exact tests, if applicable, are preferable as these can quickly compute accurate p-values.</p>
<p>3. <bold>Competitive vs. self-contained tests.</bold> Competitive tests determine whether the gene list of interest is enriched in pathways relative to all genes in the background set. Thus, each pathway &#x201C;competes&#x201D; for enrichment in the gene list against genes of the background set. In contrast, self-contained tests calculate statistics uniquely at the pathway level, ignoring genes of the background set. For instance, a self-contained test can evaluate whether the gene expression within a given pathway is different in case samples compared to control samples<sup><xref ref-type="bibr" rid="c51">51</xref></sup>. Competitive pathway enrichment analysis is most popular and is usually appropriate for gene expression data. However, self-contained tests must be used if single gene differences are not significant and need to be pooled at the pathway gene set level to identify signal, for example when analysing rare gene mutations or other data with low per-gene counts<sup><xref ref-type="bibr" rid="c52">52</xref></sup>. Hybrid approaches may be preferable to self-contained tests in specific circumstances. For instance, for rare copy number variation (CNV) data, correcting a self-contained test for global CNV burden leads to more specific biological results<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Finally, competitive enrichment tests such as Fisher&#x2019;s exact test ignore correlation among genes while modified competitive tests such as Camera<sup><xref ref-type="bibr" rid="c53">53</xref></sup> consider these and thus typically produce more rigorous results. Self-contained tests do not present this issue.</p>
<p>In summary, if genes in your data can be ranked, a ranked test should be used. Fisher&#x2019;s exact test is generally chosen for non-ranked gene lists. A competitive test is adequate in most cases, unless the signal at the gene-level is weak.</p>
<p><bold>Multiple test correction.</bold> Repeated statistical testing used in a typical pathway enrichment analysis will result in some apparently significant p-values by chance alone. To correct this, multiple testing correction methods systematically reduce the significance of each p-value derived from a series of tests. The most commonly used method is the Benjamini-Hochberg False Discovery Rate (BH-FDR, or often simply FDR)<sup><xref ref-type="bibr" rid="c20">20</xref></sup>. It is based on a step-down procedure that estimates the fraction of falsely enriched pathways over enriched pathways, using the uncorrected p-value threshold and the number of tests. For instance, given that 100 pathways have enrichment p-value &#x0003C; 0.05 having a FDR of 5&#x0025; at p-value &#x003C; 0.05 means that five of those pathways are expected to be falsely enriched. As an alternative, the classical Bonferroni multiple testing correction adjusts the significance threshold by dividing it by the number of tests. Practically, the method multiplies each uncorrected p-value by the number of conducted tests and applies a significance cut-off <italic>(e.g.,</italic> a p-value of 0.001 will become an insignificant q-value 0.1 if 100 pathways have been tested). This technique ensures that the probability of selecting <italic>at least one</italic> falsely enriched pathway is below the corrected p-value threshold. Bonferroni correction is typically considered overly conservative for differential gene expression and pathway enrichment analysis because some fraction of false positive findings can be tolerated. Importantly, both Bonferroni and BH-FDR assume tests are independent, while pathways are typically not independent because of overlapping genes and cross-talk. Therefore, BH-FDR estimates for pathway analysis can be inaccurate, although practically they are still useful for filtering and hypothesis generation and thus are routinely used.</p>
</sec>
</boxed-text>
<boxed-text id="box4" position="float">
<sec>
<title>BOX 4 - Pathway Enrichment Analysis Resources</title>
<p><bold>Pathway databases</bold></p>
<p>We describe a selection of large, open-access and conveniently accessible pathway databases that offer the maximal value for pathway enrichment analysis. Hundreds of pathway databases are available for many purposes<sup><xref ref-type="bibr" rid="c54">54</xref></sup>.</p>
<p><bold>Databases of gene sets</bold>
<list list-type="bullet">
<list-item><p>Gene Ontology (GO)<sup><xref ref-type="bibr" rid="c27">27</xref></sup> - GO provides a hierarchically organized set of thousands of standardized terms for biological processes, molecular functions and cellular components as well as curated and predicted gene annotations based on these terms for multiple species. Biological process annotations are the most commonly used resource for pathway enrichment analysis.</p></list-item>
<list-item><p>Molecular Signatures Database (MSigDB)<sup><xref ref-type="bibr" rid="c47">47</xref>,<xref ref-type="bibr" rid="c48">48</xref></sup> -MSigDB is a collection of gene sets based on GO, pathways, curation, individual &#x2013;<italic>omics</italic> studies, sequence motifs, chromosomal position, oncogenic and immunological expression signatures, and various computational analyses. Aggregate &#x2018;hallmark&#x2019; gene sets are available as a relatively non-redundant collection (<ext-link ext-link-type="uri" xlink:href="http://www.msigdb.org">http://www.msigdb.org</ext-link>). It is created by the team that makes GSEA, but can be used with any pathway enrichment method.</p></list-item>
</list>
</p>
<p><bold>Detailed biochemical pathway databases.</bold> These databases are maintained by human curators who manually collect detailed pathway information, including biochemical reactions, gene regulatory events and other gene interactions. The information can be exported or converted to gene set format.
<list list-type="bullet">
<list-item><p>Reactome<sup><xref ref-type="bibr" rid="c28">28</xref></sup> - the most actively updated public database of human pathways (<ext-link ext-link-type="uri" xlink:href="http://www.reactome.org">http://www.reactome.org</ext-link>)</p></list-item>
<list-item><p>Panther<sup><xref ref-type="bibr" rid="c21">21</xref></sup> - human signalling pathways (<ext-link ext-link-type="uri" xlink:href="http://pantherdb.org/pathway">http://pantherdb.org/pathway</ext-link>)</p></list-item>
<list-item><p>NetPath<sup><xref ref-type="bibr" rid="c30">30</xref></sup> - human signaling pathways with a focus on cancer and immunology (<ext-link ext-link-type="uri" xlink:href="http://www.netpath.org/">http://www.netpath.org/</ext-link>)</p></list-item>
<list-item><p>HumanCyc<sup><xref ref-type="bibr" rid="c29">29</xref></sup> - human metabolic pathways (<ext-link ext-link-type="uri" xlink:href="http://humancyc.org/">http://humancyc.org/</ext-link>)</p></list-item>
<list-item><p>NCI PID - human cancer related signaling pathways. No longer updated.</p></list-item>
<list-item><p>KEGG<sup><xref ref-type="bibr" rid="c55">55</xref></sup> - most useful for its intuitive pathway diagrams. Contains multiple types of pathways, some of which are not normal pathways, but are rather disease associated gene sets, such as &#x201C;pathways in cancer&#x201D; (<ext-link ext-link-type="uri" xlink:href="http://www.genome.jp/kegg/">http://www.genome.jp/kegg/</ext-link>)</p></list-item>
</list>
</p>
<p><bold>Pathway meta-databases.</bold> These databases collect detailed pathway descriptions from multiple originating pathway databases.<list list-type="bullet">
<list-item><p>Pathway Commons<sup><xref ref-type="bibr" rid="c35">35</xref></sup> - collects information from other pathway databases and provides it in a standardized format (<ext-link ext-link-type="uri" xlink:href="http://www.pathwaycommons.org">http://www.pathwaycommons.org</ext-link>).</p></list-item>
<list-item><p>WikiPathways<sup><xref ref-type="bibr" rid="c37">37</xref></sup> - a community-driven collection of pathways that also includes pathways exported from other databases (<ext-link ext-link-type="uri" xlink:href="http://www.wikipathways.org/">http://www.wikipathways.org/</ext-link>).</p>
<p><bold>Pathway Enrichment Analysis Tools</bold></p>
<p>Hundreds of pathway enrichment analysis tools exist, although many of them rely on out-of-date pathway databases or do not present any unique feature compared to the most commonly used tools. The following are free pathway enrichment analysis software tools that we recommend based on their ease of use or unique features:
<list list-type="bullet">
<list-item><p>g:Profiler<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup> &#x2013; analyzes gene lists using Fisher&#x2019;s exact test and ordered gene lists using a modified Fisher&#x2019;s test. It provides a graphical web interface and access via R and python programming languages. The software is frequently updated and the gene set database can be downloaded as a GMT file (<ext-link ext-link-type="uri" xlink:href="http://biit.cs.ut.ee/gprofiler">http://biit.cs.ut.ee/gprofiler</ext-link>).</p></list-item>
<list-item><p>Gene Set Enrichment Analysis (GSEA)<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c56">56</xref></sup> &#x2013; analyzes ranked gene lists using a permutation-based test. The software runs as a desktop application (<ext-link ext-link-type="uri" xlink:href="http://software.broadinstitute.org/gsea">http://software.broadinstitute.org/gsea</ext-link>).</p></list-item>
<list-item><p>Genomic Regions Enrichment of Annotations Tool (GREAT)<sup><xref ref-type="bibr" rid="c41">41</xref></sup> &#x2013; analyzes genomic regions, such as DNA binding sites, and links them to nearby genes (<ext-link ext-link-type="uri" xlink:href="http://bejerano.stanford.edu/great/public/html/">http://bejerano.stanford.edu/great/public/html/</ext-link>)</p></list-item>
<list-item><p>Camera<sup><xref ref-type="bibr" rid="c53">53</xref></sup> - analyzes gene lists and corrects for inter-gene correlations such as gene co-expression; available as part of the limma package in Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/limma.html">https://bioconductor.org/packages/release/bioc/html/limma.html</ext-link>).</p></list-item>
<list-item><p>GOseq<sup><xref ref-type="bibr" rid="c57">57</xref></sup> (Advanced tool, requires programming) &#x2013; this R Bioconductor package analyzes gene lists from RNA-seq experiments by correcting for user-selected covariates such as gene length (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/goseq.html">https://bioconductor.org/packages/release/bioc/html/goseq.html</ext-link>).</p></list-item>
</list>
</p></list-item></list></p>
<p><bold>Visualisation tools</bold>
<list list-type="bullet">
<list-item><p>Enrichment Map<sup><xref ref-type="bibr" rid="c7">7</xref></sup> &#x2013; this Cytoscape<sup><xref ref-type="bibr" rid="c6">6</xref></sup> app visualizes the results from pathway enrichment analysis, eases interpretation by displaying pathways as a network where overlapping pathways are clustered together to identify major biological themes in the results (<ext-link ext-link-type="uri" xlink:href="http://apps.cytoscape.org/apps/enrichmentmap">http://apps.cytoscape.org/apps/enrichmentmap</ext-link>).</p></list-item>
<list-item><p>ClueGO<sup><xref ref-type="bibr" rid="c34">34</xref></sup> &#x2013; This Cytoscape app is conceptually similar to Enrichment Map. It includes a GO-based pathway enrichment analysis feature using Fisher&#x2019;s exact test.</p></list-item>
<list-item><p>PathVisio<sup><xref ref-type="bibr" rid="c38">38</xref></sup> &#x2013; this desktop application displays genomic data on a pathway diagram (<ext-link ext-link-type="uri" xlink:href="https://www.pathvisio.org">https://www.pathvisio.org</ext-link>).</p></list-item>
</list>
</p>
</sec>
</boxed-text>
<boxed-text id="box5" position="float">
<sec>
<title>BOX 5 - Topology-Aware Pathway Enrichment Analysis Methods</title>
<p>Most pathway enrichment analysis methods treat all genes in a pathway uniformly and ignore gene interactions. In contrast, topology-aware methods explicitly model the interactions between genes. CePa<sup><xref ref-type="bibr" rid="c58">58</xref></sup>, GANPA<sup><xref ref-type="bibr" rid="c59">59</xref></sup>, and THINK-Back<sup><xref ref-type="bibr" rid="c60">60</xref></sup> use physical gene interactions or co-expression networks to assign a weight to each gene in each pathway. Weights can be derived from measures of the gene importance in the network such as degree, the number of gene connections, and betweenness centrality, and can be integrated into a traditional pathway enrichment analysis method such as GSEA. Methods like SPIA<sup><xref ref-type="bibr" rid="c61">61</xref></sup>, Pathway-Express<sup><xref ref-type="bibr" rid="c62">62</xref></sup>, and EnrichNet<sup><xref ref-type="bibr" rid="c63">63</xref></sup> generate an enrichment score for the entire pathway that considers pathway regulatory interactions, such as activation and inhibition. While useful and potentially more accurate, regulatory gene interactions are available for fewer genes compared to physical interactions networks and co-expression.</p>
</sec>
</boxed-text>
</sec>
<sec id="s9" sec-type="supplementary-material">
<title>Supplementary Materials</title>
<p>1. Supplementary&#x005F;Table&#x005F;1&#x005F;Cancer&#x005F;drivers.txt</p>
<p>2. Supplementary&#x005F;Table2&#x005F;MesenvsImmuno&#x005F;RNASeq&#x005F;ranks.rnk</p>
<p>3. Supplementary&#x005F;Table3&#x005F;Human&#x005F;GOBP&#x005F;AllPathways&#x005F;no&#x005F;GO&#x005F;iea&#x005F;July&#x005F;01&#x005F;2017&#x005F;symbolgmt</p>
<p>3. Supplementary&#x005F;Table4&#x005F;gprofiler&#x005F;results.txt</p>
<p>4. Supplementary&#x005F;Table5&#x005F;hsapiens.pathways.NAME.gmt</p>
<p>5. Supplementary&#x005F;Table6&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;expression.txt</p>
<p>6. Supplementary&#x005F;Table7&#x005F;gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;pos.xls</p>
<p>7. Supplementary&#x005F;Table8&#x005F;gsea&#x005F;report&#x005F;for&#x005F;na&#x005F;neg.xls</p>
<p>8. Supplementary&#x005F;Table9&#x005F;TCGA&#x005F;OV&#x005F;RNAseq&#x005F;classes.cls Files for supplementary protocols:</p>
<p>9. Supplementary&#x005F;Table10&#x005F;TCGA&#x005F;Microarray&#x005F;rmanormalized.txt</p>
<p>10. Supplementary&#x005F;Table11&#x005F;Microarray&#x005F;classdefinitions.txt</p>
<p>11. Supplementary&#x005F;T able12&#x005F;TCGA&#x005F;RNASeq&#x005F;rawcounts.txt</p>
<p>12. Supplementary&#x005F;Table13&#x005F;RNASeq&#x005F;classdefinitions.txt</p>
</sec>
<sec id="s10">
<title>Supplementary Protocols</title>
<p>This protocol processes RNA-seq data using the R programming environment and specialized packages from Bioconductor to create genes lists. The scripts are available for download and novice users can copy and paste commands into the R console. To create gene expression data for <bold>Protocol 1B</bold>, we downloaded gene expression data from the Ovarian Serous Cystadenocarcinoma project of The Cancer Genome Atlas (TCGA)<sup><xref ref-type="bibr" rid="c64">64</xref></sup>, <ext-link ext-link-type="uri" xlink:href="http://cancergenome.nih.gov">http://cancergenome.nih.gov</ext-link> via the Genomic Data Commons (GDC) portal<sup><xref ref-type="bibr" rid="c65">65</xref></sup> on 201706-14 using TCGABiolinks R package<sup><xref ref-type="bibr" rid="c66">66</xref></sup>. The data includes 544 samples available as RMA-normalized microarray data (Affymetrix HG-U133A), and 309 samples available as RNA-seq data, with reads mapped to a reference genome using MapSplice<sup><xref ref-type="bibr" rid="c67">67</xref></sup> and read counts per transcript determined using the RSEM method<sup><xref ref-type="bibr" rid="c68">68</xref></sup>. RNA-seq data are labeled as &#x2018;RNA-Seq V2&#x2019;, see details at: <ext-link ext-link-type="uri" xlink:href="https://wiki.nci.nih.gov/display/TCGA/RNASeq&#x002B;Version&#x002B;2">https://wiki.nci.nih.gov/display/TCGA/RNASeq&#x002B;Version&#x002B;2</ext-link>). The RNA-SeqV2 data consists of raw counts similar to regular RNA-seq but RSEM (RNA-Seq by Expectation Maximization) data can be used with the edgeR method.</p>
<sec id="s10a">
<title>Equipment</title>
<sec id="s10a1">
<title>Hardware requirements</title>
<list list-type="bullet">
<list-item><p>A recent personal computer with at least 8 gigabytes of memory (RAM).</p></list-item>
</list>
</sec>
<sec id="s10a2">
<title>Software requirements</title>
<list list-type="bullet">
<list-item><p>The R statistical computing environment (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.r-project.org/</ext-link>). We suggest using the integrated development environment RStudio (<ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/">https://www.rstudio.com/</ext-link>).</p></list-item>
<list-item><p>Required R packages: Biobase, Limma and GSA are available from Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/">https://www.bioconductor.org/</ext-link>)</p></list-item>
</list>
</sec>
<sec id="s10a3">
<title>Data requirements</title>
<list list-type="bullet">
<list-item><p>Supplementary&#x005F;Table10&#x005F;TCGA&#x005F;Microarray&#x005F;rmanormalized.txt corresponds to the RMA normalized Affymetrix mRNA transcript expression data for serous ovarian cancer samples as downloaded from the GDC portal<sup><xref ref-type="bibr" rid="c65">65</xref></sup>. Normalization is required to compute differential gene expression values across subtypes, as performed in <bold>Supplementary Protocol 1A</bold>.</p></list-item>
<list-item><p>Supplementary&#x005F;Table12&#x005F;TCGA&#x005F;RNASeq&#x005F;rawcounts.txt corresponds to read counts per mRNA transcript determined using the RSEM method. These counts can be used to compare gene expression between subtypes using the edgeR analysis tool, as performed in <bold>Supplementary Protocol 1B</bold>. The counts are not pre-normalized and the normalization step using edgeR is part of the protocol.</p></list-item>
<list-item><p>Supplementary&#x005F;Table11&#x005F;Microarray&#x005F;classdefinitions.txt and Supplementary&#x005F;Table13&#x005F;RNASeq&#x005F;classdefinitions.txt define the subtype classification of ovarian cancer samples (immunoreactive, mesenchymal, differentiated, proliferative) (Verhaak et al.<sup><xref ref-type="bibr" rid="c44">44</xref></sup> supplementary table 1, column 3). This information is used to extract two subgroups of interest, mesenchymal and immunoreactive.</p></list-item>
</list>
</sec>
</sec>
<sec id="s10b">
<title>Equipment Setup</title>
<list list-type="bullet">
<list-item><p>Download and install R from <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/">http://cran.r-project.org/</ext-link></p></list-item>
<list-item><p>Download and install RStudio from <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/">https://www.rstudio.com/</ext-link> (optional, but recommended)</p></list-item>
<list-item><p>Launch R or RStudio</p></list-item>
<list-item><p>Install required Bioconductor packages. Enter the following commands in the R command line (also see <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/install/">https://www.bioconductor.org/install/</ext-link>):
<list list-type="bullet">
<list-item><p>source("<ext-link ext-link-type="uri" xlink:href="http://www.Bioconductor.org/biocLite.R">http://www.Bioconductor.org/biocLite.R</ext-link>")</p></list-item>
<list-item><p>biocLite("BiocUpgrade")</p></list-item>
<list-item><p>biocLite(c("Biobase","limma",&#x201D;edgeR&#x201D;,&#x201D;GSA&#x201D;,&#x201D;locfit&#x201D;))</p></list-item>
<list-item><p>install.packages(c(&#x201C;pheatmap&#x201D;, &#x201C;RColorBrewer&#x201D;, &#x201C;gProfileR&#x201D;, &#x201C;RJSONIO&#x201D;, &#x201C;httr&#x201D;))</p></list-item>
</list></p></list-item>
<list-item><p>If the required packages are already installed you may receive a prompt to update these. The prompt window will ask you about updating the packages:
<list list-type="bullet">
<list-item><p>Update all/some/none? [a/s/n]</p></list-item>
<list-item><p>Type &#x2018;a&#x2019; without quotes and hit enter.</p></list-item>
<list-item><p>Load libraries into the R session using the example below. Loading of libraries is required every time R is re-opened.
<fig id="ufig1" position="float">
<graphic xlink:href="232835_ufig1.tif"/></fig>
</p></list-item>
<list-item><p>All R files are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BaderLab/EM-tutorials-docker/tree/master/Rscripts">https://github.com/BaderLab/EM-tutorials-docker/tree/master/Rscripts</ext-link></p></list-item>
<list-item><p>Alternately, R notebooks (use R markdown and creates a notebook similar to Jupyter notebooks) of this protocol are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BaderLab/Cytoscape_workflows/tree/master/EnrichmentMapPipeline">https://github.com/BaderLab/Cytoscape_workflows/tree/master/EnrichmentMapPipeline</ext-link></p></list-item>
</list></p></list-item></list></sec>
<sec id="s10c">
<title>Data setup</title>
<list list-type="bullet">
<list-item><p>Download <bold>Supplementary Tables 10</bold>-<bold>13</bold> to a dedicated folder of your computer. The first step of your R script will change the working directory of R to this folder.</p></list-item>
<list-item><p>As text editors sometimes add invisible characters to text copied from PDF files, copying and pasting from this document is not recommended. The R scripts or the R notebook available in the above URLs should be used instead.</p></list-item>
<list-item><p>Setting the current directory and loading packages (libraries) are the required first and second steps of each protocol. These are needed each time a new session is opened in R.</p></list-item>
</list>
</sec>
<sec id="s10d">
<title>Supplementary Protocol 1 &#x2013; create a gene list by analyzing gene expression data from RNA-seq using edgeR</title>
<p>This part of the supplementary protocol demonstrates filtering and scoring RNA-seq data using normalized RNA-seq count data with the edgeR R package. The protocol can be used to produce input data for pathway enrichment methods like g:Profiler, GSEA and others. This RNA-seq analysis protocol follows conceptually similar steps to microarray analysis shown above.</p>
<p>1. Load required Bioconductor packages into R.</p>
<fig id="ufig2" position="float">
<graphic xlink:href="232835_ufig2.tif"/></fig>
<p>2. Load the expression data of 300 tumours, with 79 classified as Immunoreactive, 72 classified as Mesenchymal, 69 classified as Differentiated, and 80 classified as Proliferative samples. The TCGA counts data was retrieved from the Genomic Data Commons (GDC)<sup><xref ref-type="bibr" rid="c65">65</xref></sup> database and contained counts per mRNA transcript determined using the RSEM method for 19947 transcripts and 300 samples.</p>
<fig id="ufig3" position="float">
<graphic xlink:href="232835_ufig3.tif"/></fig>
<p>3. Load subtype classification of samples. To calculate differential expression, we need to define at least two sample classes. A common experimental design involves cases and controls but any two classes can be used. The current set of samples is divided into mesenchymal and immunoreactive classes (class definitions were obtained from Verhaak et al.<sup><xref ref-type="bibr" rid="c44">44</xref></sup> Supplementary Table 1, third column). After loading the matrix, check that the column names of the expression matrix and class definitions are equal.</p>
<fig id="ufig4" position="float">
<graphic xlink:href="232835_ufig4.tif"/></fig>
<p>4. Filter RNA-seq reads. RNA-seq data are processed following the edgeR protocol<sup><xref ref-type="bibr" rid="c16">16</xref></sup> that filters reads based on the counts per million (CPM) statistic. RNA-seq read counts are converted to CPM values and genes with CPM &#x003E; 1 in at least 50 of the samples are retained for further study (50 is the minimal sample size in the classes). This step removes genes with very low read counts that are likely not expressed in the majority of samples and cause noise in the data. Note, CPM filtering is used to remove low counts while differential gene expression analysis is based on normalized read counts which are generated below (step 6).</p>
<fig id="ufig5" position="float">
<graphic xlink:href="232835_ufig5.tif"/></fig>
<p>5. Data normalization, dispersion analysis is performed on the entire data.</p>
<fig id="ufig6" position="float">
<graphic xlink:href="232835_ufig6.tif"/></fig>
<p>6. (Optional) Exclude genes with missing symbols or uncharacterized genes. In this example gene entries in the data containing &#x2018;?&#x2019; or starting with LOC are excluded as they represent non-annotated genes or other loci that are not present in pathway databases. The frequency of these and other non-protein coding entries in the input data will depend on the database used to align the RNA-seq data.</p>
<fig id="ufig7" position="float">
<graphic xlink:href="232835_ufig7.tif"/></fig>
<p>7. Differential expression analysis is performed with a simple design as described in the edgeR protocol<sup><xref ref-type="bibr" rid="c16">16</xref></sup>.</p>
<fig id="ufig8" position="float">
<graphic xlink:href="232835_ufig8.tif"/></fig>
<p>8a. Create the gene list for use in g:Profiler or another thresholded enrichment tool. The list may comprise all genes that have a significant <italic>q</italic>-value (code shown below), all significant and FDR-corrected up-regulated genes and all down-regulated genes separately, or some other combination of thresholds. Also see analogous step in the microarray protocol (Supplementary Protocol 2).</p>
<fig id="ufig9" position="float">
<graphic xlink:href="232835_ufig9.tif"/></fig>
<p>8b. Create a two-column rank (.RNK) file of all gene IDs and corresponding scores for input to GSEA pre-ranked analysis. One option is to rank genes by t-statistic of differential gene expression. GSEA will look for enrichment in the set of most differentially expressed genes at the top of the list as well as those at the bottom of the list. Genes at the top of the list are more highly expressed in class A of samples (e.g., mesenchymal) while genes at the bottom are highly expressed in class B (e.g., immunoreactive). An alternative score that we use here is computed by multiplying direction (sign) of fold change and logarithm of p-value for each gene.</p>
<fig id="ufig10" position="float">
<graphic xlink:href="232835_ufig10.tif"/></fig>
<p>9a. Create an expression file for the enrichment map and save it to a file in the working folder. The optional expression file is similar to the expression matrix except for an additional column on the left edge of the matrix. The field often includes gene description however any text value can be added.</p>
<fig id="ufig11" position="float">
<graphic xlink:href="232835_ufig11.tif"/></fig>
<p>9b. Examine gene expression data using heat maps. Clustered heat maps can easily show the separation between sample classes, labeled by colors in the heat map header. By limiting to the most significantly differentially expressed list of genes (FDR <italic>q</italic>&#x003C;0.05) we can verify whether the scoring accurately separates class A from class B.</p>
<fig id="ufig12" position="float">
<graphic xlink:href="232835_ufig12.tif"/></fig>
</sec>
<sec id="s10e">
<title>Supplementary Protocol 2 &#x2013; create a gene list by analyzing gene expression data from Affymetrix microarrays with Limma</title>
<p>This protocol demonstrates the generation of gene lists for pathway enrichment analysis using RMA-normalized gene expression data from Affymetrix microarrays for downstream pathway enrichment analysis with g:Profiler, GSEA and other similar tools. g:Profiler requires a ranked list of differentially expressed genes that are filtered according to a significance cut-off. GSEA requires a two-column tab-separated RNK file with a ranked list of all genes in the genome. In the RNK file, the first column specifies the gene name and the second column specifies a numeric score representing the level of differential expression. For both methods, the first step involves calculating a statistic for each gene that represents the difference in its expression levels between the two groups. This step is performed using the limma R package.</p>
<p>9. Load required Bioconductor packages into R</p>
<fig id="ufig13" position="float">
<graphic xlink:href="232835_ufig13.tif"/></fig>
<p>10. Set the working directory to the location of <bold>Supplemental Tables 10-13</bold>. The function getwd() shows the working directory and dir() shows its files.</p>
<fig id="ufig14" position="float">
<graphic xlink:href="232835_ufig14.tif"/></fig>
<p>11. Load expression data into R. Minimally the expression set requires a gene name for each row and typically at least six expression values (three values in each compared class). Our data consists of 499 patients with 108 immunoreactive, 112 mesenchymal, 138 differentiated and 141 proliferative samples. After loading, use the command head(expressionMatrix) to verify that the matrix loaded correctly.</p>
<fig id="ufig15" position="float">
<graphic xlink:href="232835_ufig15.tif"/></fig>
<p>12. Load subtype classification of samples. To calculate differential expression, we need to define at least two classes of samples. A common experimental design involves cases and controls but any two classes may be used. The current data is divided into mesenchymal and immunoreactive classes (<bold>Supplementary Table 11</bold>, third column). After loading the matrix, check that the column names of the expression matrix and class definitions are equivalent.</p>
<fig id="ufig16" position="float">
<graphic xlink:href="232835_ufig16.tif"/></fig>
<p>13. Format data and class definitions for limma. The expression data needs to be converted to an object of type ExpressionSet. The ExpressionSet must include a data matrix where rows are genes, columns are samples and each cell contains an expression value. Classes need to be defined as factors.</p>
<fig id="ufig17" position="float">
<graphic xlink:href="232835_ufig17.tif"/></fig>
<p>14. Create a model matrix with the defined classes.</p>
<fig id="ufig18" position="float">
<graphic xlink:href="232835_ufig18.tif"/></fig>
<p>15. Fit the model to the expression matrix.</p>
<fig id="ufig19" position="float">
<graphic xlink:href="232835_ufig19.tif"/></fig>
<p>16. Create the contrast matrix. By specifying Mesenchymal first and Immunoreactive second, positive logFC and t-values refer to higher expression levels (up-regulation) in the Mesenchymal versus Immunoreactive samples</p>
<fig id="ufig20" position="float">
<graphic xlink:href="232835_ufig20.tif"/></fig>
<p>17. Model contrasts of gene expression. The following command models gene expression differences of each gene between the two groups of samples using linear regression and computes coefficients and standard errors.</p>
<fig id="ufig21" position="float">
<graphic xlink:href="232835_ufig21.tif"/></fig>
<p>18. Compute differential expression statistics. Given a fitted linear regression model, the command generates a table containing the log fold change, average expression, t-statistic, <italic>p</italic>-value, adjusted <italic>p</italic>-value (<italic>q</italic>-value) and B statistic for each entity in the expression matrix using empirical Bayes statistics. The B-statistic represents the log-odds that the gene is differentially expressed, but it is based on a prior assumption of how many genes are differentially expressed in the data. Because of its reliance on this prior assumption, the adjusted p-value is preferentially used as an indicator of significant differential expression.</p>
<fig id="ufig22" position="float">
<graphic xlink:href="232835_ufig22.tif"/></fig>
<p>19. Generate a table with differentially expressed genes and adjust for multiple hypothesis testing using Benjamini-Hochberg False Discovery Rate. The table contains all genes ranked by p-value and shown with log fold change, average expression, t-statistic, p-value, adjusted p-value (<italic>q</italic>-value) and B-statistic.</p>
<fig id="ufig23" position="float">
<graphic xlink:href="232835_ufig23.tif"/></fig>
<p>20a. Create the gene list for use in g:Profiler or another threshold-requiring enrichment tool. The list may comprise all genes that have a significant FDR <italic>q</italic>-value, all up-regulated genes with a significant FDR <italic>q</italic>-value, all down-regulated genes with a significant q-value, or some other combination of thresholds.</p>
<list list-type="bullet">
<list-item><p>To get all significant genes:</p></list-item></list>
<fig id="ufig24" position="float">
<graphic xlink:href="232835_ufig24.tif"/></fig>
<list list-type="bullet">
<list-item><p>Significantly up-regulated genes in mesenchymal samples have positive logFC and t-values.</p></list-item></list>
<fig id="ufig25" position="float">
<graphic xlink:href="232835_ufig25.tif"/></fig>
<list list-type="bullet">
<list-item><p>Significantly up-regulated genes in immunoreactive samples have negative logFC and t-values.</p></list-item></list>
<fig id="ufig26" position="float">
<graphic xlink:href="232835_ufig26.tif"/></fig>
<p>20b. Create a rank file for GSEA. To run GSEA in pre-anked mode, you need a two column RNK file with gene/protein/probe name (column 1) and the associated score (column 2). The first column should contain the same type of gene IDs used in the pathway gene set (GMT) file. GSEA looks for enrichment in the top and bottom parts of the list by ranking the file using the t-statistic. The t-statistic indicates the strength of differential expression and is used in the p-value calculation. Other scores indicating the strength of differential expression may be used as well. GSEA ranks the most up-regulated genes at the top of the list and the most down-regulated at the bottom of the list. Genes at the top of the list are more highly expressed in class A compared to class B, while genes at the bottom of the list are higher in class B. In this workflow, a positive t-value means a higher gene expression in the Mesenchymal samples compared to the Immunoreactive samples (variable <monospace>constrastnm</monospace>). The following commands create a data frame with gene IDs and t-statistics, remove lines with missing gene IDs, and store the result as a RNK file. An additional step is usually required in analysis of Affymetrix microarray data as genes are represented with multiple probe sets. The most significant probe set or average probe set score may be considered for every gene.</p>
<fig id="ufig27" position="float">
<graphic xlink:href="232835_ufig27.tif"/></fig>
<p>21. Create an expression file for the enrichment map and save files to the home folder of the analysis. The expression file contains the gene IDs as the first column, gene description as the second column, and the expression values for each sample as the additional columns. Gene IDs should correspond to the first column of the rank file. (Optional: biomart can be used to collect the proper names of all the genes in the expression file.) The text files will be saved on your computer in the directory specified at the beginning of the script using setwd(). The .rnk, .cls and .txt files are all tab delimited files that can be viewed in spreadsheet or in a text editor.</p>
<fig id="ufig28" position="float">
<graphic xlink:href="232835_ufig28.tif"/></fig>
</sec>
<sec id="s10f">
<title>Supplementary Protocol 3 &#x2013; Pathway Enrichment Analysis in R using Roast and Camera</title>
<p>This protocol will demonstrate the use of R packages Roast and Camera to automate pathway enrichment analysis. Each method requires an expressionSet that minimally contains a matrix of expression values for a set of genes and conditions. The expression matrix generated in supplementary protocol part 1 or 2 is suitable for the analysis.</p>
<p>22. Load required Bioconductor packages into R and set working folder to the location of <bold>Supplementary Files 1-4.</bold></p>
<fig id="ufig29" position="float">
<graphic xlink:href="232835_ufig29.tif"/></fig>
<p>23. Load in the gene sets from a GMT file - download the latest pathway definition file automatically through R or manually through the website. Only the databases of pathway gene sets for human, mouse and rat genes are currently available on the baderlab.org downloads site. If you are working with rat or mouse data change the value of gmt&#x005F;url below to specify the correct species. Consult <ext-link ext-link-type="uri" xlink:href="http://download.baderlab.org/EMGenesets/current_release/">http://download.baderlab.org/EMGenesets/current_release/</ext-link> to see all available species.</p>
<fig id="ufig30" position="float">
<graphic xlink:href="232835_ufig30.tif"/></fig>
<p>24. Camera and Roast expect the pathway gene sets to be a list of vectors where the slot name of each vector corresponds to the pathway gene set identifier, i.e. the name of the pathway, however the GSA.read.gmt() method loads the GMT file as an object with a list of pathway names and a list of pathway gene sets. Add the pathway names to the pathway gene sets vector to create a list of vectors required by Roast and Camera.</p>
<fig id="ufig31" position="float">
<graphic xlink:href="232835_ufig31.tif"/></fig>
<p>25. Specify the expression data to be used for the analysis. You can use the DGEList variable d from <bold>Supplementary Protocol 1 (Follow steps 1-6 in Supplementary Protocol 1 to regenerate</bold>) or MinimalSet from <bold>Supplementary Protocol 2 (Follow steps 9-13 in Supplementary Protocol 2 to regenerate</bold>) or. For our RNA-seq data, each row of the expression set is annotated with gene symbol and EntrezGene ID separated by &#x201C;|&#x201D;. To match the gene set file we need to remove the EntrezGene IDs from the row names. We choose to use gene symbols to simplify interpretation of enriched pathways and associated genes.</p>
<fig id="ufig32" position="float">
<graphic xlink:href="232835_ufig32.tif"/></fig>
<p>26. Camera and Roast require that the pathway gene sets are filtered such that all genes in each set have expression values in the data. Use the ids2indices() function in limma to convert gene identifiers in the gene set to indices in the data.</p>
<fig id="ufig33" position="float">
<graphic xlink:href="232835_ufig33.tif"/></fig>
<p>27. Filter the pathway gene sets according to their size, following the previous step of filtering by availability of expression data. Here we only include sets with more than or equal to 15 and less than 200 genes.</p>
<fig id="ufig34" position="float">
<graphic xlink:href="232835_ufig34.tif"/></fig>
<p>28. Create the design matrix and contrast we want to test for. In this example, we are looking for differential pathways between the Mesenchymal and Immunoreactive subtypes.</p>
<fig id="ufig35" position="float">
<graphic xlink:href="232835_ufig35.tif"/></fig>
<p>29. Run enrichment analysis and format the results to the &#x2018;generic&#x2019; file format of Enrichment Map. This is a tab-delimited file that includes a pathway gene set name, pathway description, p-value, FDR <italic>g</italic>-value, phenotype and a comma-separated list of associated genes for every detected pathway. Depending on your data size and computer speed, this command could take from a few minutes to an hour to run. If you receive the warning &#x201C;<monospace>In dnbinom(q, size &#x003D; size, mu &#x003D; mu, log &#x003D; TRUE): non-integer x</monospace>&#x201D;, the software has encountered unexpected non-integer values of gene expression, often indicating problems with upstream analysis such as suboptimal pre-processing or normalization procedures. Simply rounding the gene expression values may fix the error, however it should be investigated further to ensure no errors with the workflow.</p>
<fig id="ufig36" position="float">
<graphic xlink:href="232835_ufig36.tif"/></fig>
<p>The following commands will derive results from Roast.</p>
<fig id="ufig37" position="float">
<graphic xlink:href="232835_ufig37.tif"/></fig>
<p>30. Inspect the results returned from Roast. The column "Direction" shows whether the gene set is enriched for up- or down-regulated genes. To ensure compatibility with Enrichment Map, convert these values such that 1 represents up-regulated and &#x002D;1 represents down-regulated.</p>
<fig id="ufig38" position="float">
<graphic xlink:href="232835_ufig38.tif"/></fig>
<p>31. Run pathway enrichment analysis with the Camera R package. The analysis starts with the same files as Roast (see first four steps of <bold>Supplementary Protocol 3</bold>).</p>
<fig id="ufig39" position="float">
<graphic xlink:href="232835_ufig39.tif"/></fig>
<p>32. The results from Camera or ROAST can be input to Enrichment Map, following the protocols in the main text.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><string-name><surname>Mack</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal> <article-title>Epigenomic alterations define lethal CIMP-positive ependymomas of infancy</article-title>. <source>Nature</source> <volume>506</volume>, <fpage>445</fpage>&#x2013;<lpage>450</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature13108</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><string-name><surname>Pinto</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Functional impact of global rare copy number variation in autism spectrum disorders</article-title>. <source>Nature</source> <volume>466</volume>, <fpage>368</fpage>&#x2013;<lpage>372</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature09146</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><string-name><surname>Pinto</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Convergence of genes and cellular pathways dysregulated in autism spectrum disorders</article-title>. <source>Am J Hum Genet</source> <volume>94</volume>, <fpage>677</fpage>&#x2013;<lpage>694</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.ajhg.2014.03.018</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><string-name><surname>Reimand</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>g:Profiler-a web server for functional interpretation of gene lists (2016 update)</article-title>. <source>Nucleic Acids Res</source> <volume>44</volume>, <fpage>W83</fpage>&#x2013;<lpage>89</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkw199</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><string-name><surname>Subramanian</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U SA</source> <volume>102</volume>, <fpage>15545</fpage>&#x2013;<lpage>15550</lpage>, doi:<pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id> (<year>2005</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><string-name><surname>Shannon</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>. <source>Genome Res</source> <volume>13</volume>, <fpage>2498</fpage>&#x2013;<lpage>2504</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id> (<year>2003</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><string-name><surname>Merico</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Isserlin</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Stueker</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Emili</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Bader</surname>, <given-names>G. D.</given-names></string-name> <article-title>Enrichment map: a network-based method for gene-set enrichment visualization and interpretation</article-title>. <source>PLoS One</source> <volume>5</volume>, <elocation-id>e13984</elocation-id>, doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0013984</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><string-name><surname>Anders</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Count-based differential expression analysis of RNA sequencing data using R and Bioconductor</article-title>. <source>Nat Protoc</source> <volume>8</volume>, <fpage>1765</fpage>&#x2013;<lpage>1786</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nprot.2013.099</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><string-name><surname>Ritchie</surname>, <given-names>M. E.</given-names></string-name> <etal>et al.</etal> <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source> <volume>43</volume>, <elocation-id>e47</elocation-id>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><string-name><surname>Silva</surname>, <given-names>T. S.</given-names></string-name> &#x0026; <string-name><surname>Richard</surname>, <given-names>N.</given-names></string-name> <article-title>Visualization and Differential Analysis of Protein Expression Data Using R</article-title>. <source>Methods Mol Biol</source> <volume>1362</volume>, <fpage>105</fpage>&#x2013;<lpage>118</lpage>, doi:<pub-id pub-id-type="doi">10.1007/978-1-4939-3106-4&#x005F;6</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>H.</given-names></string-name> &#x0026; <string-name><surname>Wang</surname>, <given-names>K.</given-names></string-name> <article-title>Genomic variant annotation and prioritization with ANNOVAR and wANNOVAR</article-title>. <source>Nat Protoc</source> <volume>10</volume>, <fpage>1556</fpage>&#x2013;<lpage>1566</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nprot.2015.105</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><string-name><surname>Assenov</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Comprehensive analysis of DNA methylation data with RnBeads</article-title>. <source>Nat Methods</source> <volume>11</volume>, <fpage>1138</fpage>&#x2013;<lpage>1140</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.3115</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><string-name><surname>Rapaport</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Comprehensive evaluation of differential gene expression analysis methods for RNA-seq data</article-title>. <source>Genome Biol</source> <volume>14</volume>, <fpage>R95</fpage>, doi:<pub-id pub-id-type="doi">10.1186/gb-2013-14-9-r95</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><string-name><surname>Conesa</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>A survey of best practices for RNA-seq data analysis</article-title>. <source>Genome Biol</source> <volume>17</volume>, <fpage>13</fpage>, doi:<pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><string-name><surname>Bullard</surname>, <given-names>J. H.</given-names></string-name>, <string-name><surname>Purdom</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Hansen</surname>, <given-names>K. D.</given-names></string-name> &#x0026; <string-name><surname>Dudoit</surname>, <given-names>S.</given-names></string-name> <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>, <fpage>94</fpage>, doi:<pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><string-name><surname>Robinson</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>McCarthy</surname>, <given-names>D. J.</given-names></string-name> &#x0026; <string-name><surname>Smyth</surname>, <given-names>G. K.</given-names></string-name> <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source> <volume>26</volume>, <fpage>139</fpage>&#x2013;<lpage>140</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><string-name><surname>Anders</surname>, <given-names>S.</given-names></string-name> &#x0026; <string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name> <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source> <volume>11</volume>, <fpage>R106</fpage>, doi:<pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><string-name><surname>Smyth</surname>, <given-names>G. K.</given-names></string-name> <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Stat Appl Genet Mol Biol</source> <volume>3</volume>, Article3, doi:<pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id> (<year>2004</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source> <volume>28</volume>, <fpage>511</fpage>&#x2013;<lpage>515</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><string-name><surname>Hochberg</surname>, <given-names>Y.</given-names></string-name> &#x0026; <string-name><surname>Benjamini</surname>, <given-names>Y.</given-names></string-name> <article-title>More powerful procedures for multiple significance testing</article-title>. <source>Stat Med</source> <volume>9</volume>, <fpage>811</fpage>&#x2013;<lpage>818</lpage> (<year>1990</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><string-name><surname>Mi</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Muruganujan</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Thomas</surname>, <given-names>P. D.</given-names></string-name> <article-title>PANTHER in 2013: modeling the evolution of gene function, and other gene attributes, in the context of phylogenetic trees</article-title>. <source>Nucleic Acids Res</source> <volume>41</volume>, <fpage>D377</fpage>&#x2013;<lpage>386</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gks1118</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bardes</surname>, <given-names>E. E.</given-names></string-name>, <string-name><surname>Aronow</surname>, <given-names>B. J.</given-names></string-name> &#x0026; <string-name><surname>Jegga</surname>, <given-names>A. G.</given-names></string-name> <article-title>ToppGene Suite for gene list enrichment analysis and candidate gene prioritization</article-title>. <source>Nucleic Acids Res</source> <volume>37</volume>, <fpage>W305</fpage>&#x2013;<lpage>311</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkp427</pub-id> (<year>2009</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><string-name><surname>Kuleshov</surname>, <given-names>M. V.</given-names></string-name> <etal>et al.</etal> <article-title>Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</article-title>. <source>Nucleic Acids Res</source> <volume>44</volume>, <fpage>W90</fpage>&#x2013;<lpage>97</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkw377</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><string-name><surname>Huang da</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Sherman</surname>, <given-names>B. T.</given-names></string-name> &#x0026; <string-name><surname>Lempicki</surname>, <given-names>R. A.</given-names></string-name> <article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>. <source>Nat Protoc</source> <volume>4</volume>, <fpage>44</fpage>&#x2013;<lpage>57</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nprot.2008.211</pub-id> (<year>2009</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><string-name><surname>Kandoth</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>Mutational landscape and significance across 12 major cancer types</article-title>. <source>Nature</source> <volume>502</volume>, <fpage>333</fpage>&#x2013;<lpage>339</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature12634</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><string-name><surname>Reimand</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kull</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Peterson</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Hansen</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>Vilo</surname>, <given-names>J.</given-names></string-name> <article-title>g:Profiler--a web-based toolset for functional profiling of gene lists from large-scale experiments</article-title>. <source>Nucleic Acids Res</source> <volume>35</volume>, <fpage>W193</fpage>&#x2013;<lpage>200</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkm226</pub-id> (<year>2007</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><string-name><surname>Ashburner</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>. <source>Nat Genet</source> <volume>25</volume>, <fpage>25</fpage>&#x2013;<lpage>29</lpage>, doi:<pub-id pub-id-type="doi">10.1038/75556</pub-id> (<year>2000</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><string-name><surname>Fabregat</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>The Reactome pathway Knowledgebase</article-title>. <source>Nucleic Acids Res</source> <volume>44</volume>, <fpage>D481</fpage>&#x2013;<lpage>487</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkv1351</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><string-name><surname>Caspi</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>. <source>Nucleic Acids Res</source> <volume>44</volume>, <fpage>D471</fpage>&#x2013;<lpage>480</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkv1164</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><string-name><surname>Kandasamy</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>NetPath: a public resource of curated signal transduction pathways</article-title>. <source>Genome Biol</source> <volume>11</volume>, <fpage>R3</fpage>, doi:<pub-id pub-id-type="doi">10.1186/gb-2010-11-1-r3</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><string-name><surname>Wadi</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Meyer</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Weiser</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Stein</surname>, <given-names>L. D.</given-names></string-name> &#x0026; <string-name><surname>Reimand</surname>, <given-names>J.</given-names></string-name> <article-title>Impact of outdated gene annotations on pathway enrichment analysis</article-title>. <source>Nat Methods</source> <volume>13</volume>, <fpage>705</fpage>&#x2013;<lpage>706</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.3963</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><string-name><surname>Lechman</surname>, <given-names>E. R.</given-names></string-name> <etal>et al.</etal> <article-title>Attenuation of miR-126 activity expands HSC in vivo without exhaustion</article-title>. <source>Cell Stem Cell</source> <volume>11</volume>, <fpage>799</fpage>&#x2013;<lpage>811</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.stem.2012.09.001</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c33"><label>33</label><mixed-citation publication-type="journal"><string-name><surname>Jhas</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Metabolic adaptation to chronic inhibition of mitochondrial protein synthesis in acute myeloid leukemia cells</article-title>. <source>PLoS One</source> <volume>8</volume>, <elocation-id>e58367</elocation-id>, doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0058367</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c34"><label>34</label><mixed-citation publication-type="journal"><string-name><surname>Bindea</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title>ClueGO: a Cytoscape plug-in to decipher functionally grouped gene ontology and pathway annotation networks</article-title>. <source>Bioinformatics</source> <volume>25</volume>, <fpage>1091</fpage>&#x2013;<lpage>1093</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp101</pub-id> (<year>2009</year>).</mixed-citation></ref>
<ref id="c35"><label>35</label><mixed-citation publication-type="journal"><string-name><surname>Cerami</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>The cBio cancer genomics portal: an open platform for exploring multidimensional cancer genomics data</article-title>. <source>Cancer Discov</source> <volume>2</volume>, <fpage>401</fpage>&#x2013;<lpage>404</lpage>, doi:<pub-id pub-id-type="doi">10.1158/2159-8290.CD-12-0095</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c36"><label>36</label><mixed-citation publication-type="journal"><string-name><surname>Kanehisa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Goto</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Sato</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Furumichi</surname>, <given-names>M.</given-names></string-name> &#x0026; <string-name><surname>Tanabe</surname>, <given-names>M.</given-names></string-name> <article-title>KEGG for integration and interpretation of large-scale molecular data sets</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>, <fpage>D109</fpage>&#x2013;<lpage>114</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkr988</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c37"><label>37</label><mixed-citation publication-type="journal"><string-name><surname>Kelder</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>WikiPathways: building research communities on biological pathways</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>, <fpage>D1301</fpage>&#x2013;<lpage>1307</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkr1074</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c38"><label>38</label><mixed-citation publication-type="journal"><string-name><surname>Kutmon</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>PathVisio 3: an extendable pathway analysis toolbox</article-title>. <source>PLoS Comput Biol</source> <volume>11</volume>, <elocation-id>e1004085</elocation-id>, doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1004085</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c39"><label>39</label><mixed-citation publication-type="journal"><string-name><surname>Szklarczyk</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>STRING v10: protein-protein interaction networks, integrated over the tree of life</article-title>. <source>Nucleic Acids Res</source> <volume>43</volume>, <fpage>D447</fpage>&#x2013;<lpage>452</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gku1003</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c40"><label>40</label><mixed-citation publication-type="journal"><string-name><surname>Warde-Farley</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>, <fpage>W214</fpage>&#x2013;<lpage>220</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkq537</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c41"><label>41</label><mixed-citation publication-type="journal"><string-name><surname>McLean</surname>, <given-names>C. Y.</given-names></string-name> <etal>et al.</etal> <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nat Biotechnol</source> <volume>28</volume>, <fpage>495</fpage>&#x2013;<lpage>501</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c42"><label>42</label><mixed-citation publication-type="journal"><string-name><surname>Raychaudhuri</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Accurately assessing the risk of schizophrenia conferred by rare copy-number variation affecting genes with brain function</article-title>. <source>PLoS Genet</source> <volume>6</volume>, <elocation-id>e1001097</elocation-id>, doi:<pub-id pub-id-type="doi">10.1371/journal.pgen.1001097</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c43"><label>43</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>P. H.</given-names></string-name>, O'<string-name><surname>Dushlaine</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Thomas</surname>, <given-names>B.</given-names></string-name> &#x0026; <string-name><surname>Purcell</surname>, <given-names>S. M.</given-names></string-name> <article-title>INRICH: interval-based enrichment analysis for genome-wide association studies</article-title>. <source>Bioinformatics</source> <volume>28</volume>, <fpage>1797</fpage>&#x2013;<lpage>1799</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts191</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c44"><label>44</label><mixed-citation publication-type="journal"><string-name><surname>Verhaak</surname>, <given-names>R. G.</given-names></string-name> <etal>et al.</etal> <article-title>Prognostically relevant gene signatures of high-grade serous ovarian carcinoma</article-title>. <source>J Clin Invest</source> <volume>123</volume>, <fpage>517</fpage>&#x2013;<lpage>525</lpage>, doi:<pub-id pub-id-type="doi">10.1172/JCI65833</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c45"><label>45</label><mixed-citation publication-type="journal"><collab>Cancer Genome Atlas Research, N.</collab> <article-title>Integrated genomic analyses of ovarian carcinoma</article-title>. <source>Nature</source> <volume>474</volume>, <fpage>609</fpage>&#x2013;<lpage>615</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature10166</pub-id> (<year>2011</year>).</mixed-citation></ref>
<ref id="c46"><label>46</label><mixed-citation publication-type="journal"><string-name><surname>Schaefer</surname>, <given-names>C. F.</given-names></string-name> <etal>et al.</etal> <article-title>PID: the Pathway Interaction Database</article-title>. <source>Nucleic Acids Res</source> <volume>37</volume>, <fpage>D674</fpage>&#x2013;<lpage>679</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkn653</pub-id> (<year>2009</year>).</mixed-citation></ref>
<ref id="c47"><label>47</label><mixed-citation publication-type="journal"><string-name><surname>Liberzon</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Molecular signatures database (MSigDB) 3.0</article-title>. <source>Bioinformatics</source> <volume>27</volume>, <fpage>1739</fpage>&#x2013;<lpage>1740</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btr260</pub-id> (<year>2011</year>).</mixed-citation></ref>
<ref id="c48"><label>48</label><mixed-citation publication-type="journal"><string-name><surname>Liberzon</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title>. <source>Cell Syst</source> <volume>1</volume>, <fpage>417</fpage>&#x2013;<lpage>425</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c49"><label>49</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>J.</given-names></string-name> &#x0026; <string-name><surname>White</surname>, <given-names>K. P.</given-names></string-name> <article-title>RNA-seq differential expression studies: more sequence or more replication?</article-title> <source>Bioinformatics</source> <volume>30</volume>, <fpage>301</fpage>&#x2013;<lpage>304</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt688</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c50"><label>50</label><mixed-citation publication-type="journal"><string-name><surname>Tavazoie</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hughes</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Campbell</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Cho</surname>, <given-names>R. J.</given-names></string-name> &#x0026; <string-name><surname>Church</surname>, <given-names>G. M.</given-names></string-name> <article-title>Systematic determination of genetic network architecture</article-title>. <source>Nat Genet</source> <volume>22</volume>, <fpage>281</fpage>&#x2013;<lpage>285</lpage>, doi:<pub-id pub-id-type="doi">10.1038/10343</pub-id> (<year>1999</year>).</mixed-citation></ref>
<ref id="c51"><label>51</label><mixed-citation publication-type="journal"><string-name><surname>Goeman</surname>, <given-names>J. J.</given-names></string-name> &#x0026; <string-name><surname>B&#x00FC;hlmann</surname>, <given-names>P.</given-names></string-name> <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source> <volume>23</volume>, <fpage>980</fpage>&#x2013;<lpage>987</lpage> &#x0025;@ 1367&#x2013;<lpage>4803</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c52"><label>52</label><mixed-citation publication-type="journal"><string-name><surname>Bansal</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Libiger</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Torkamani</surname>, <given-names>A.</given-names></string-name> &#x0026; <string-name><surname>Schork</surname>, <given-names>N. J.</given-names></string-name> <article-title>Statistical analysis strategies for association studies involving rare variants</article-title>. <source>Nat Rev Genet</source> <volume>11</volume>, <fpage>773</fpage>&#x2013;<lpage>785</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nrg2867</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c53"><label>53</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>D.</given-names></string-name> &#x0026; <string-name><surname>Smyth</surname>, <given-names>G. K.</given-names></string-name> <article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title>. <source>Nucleic Acids Res</source> <volume>40</volume>, <elocation-id>e133</elocation-id>, doi:<pub-id pub-id-type="doi">10.1093/nar/gks461</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c54"><label>54</label><mixed-citation publication-type="journal"><string-name><surname>Bader</surname>, <given-names>G. D.</given-names></string-name>, <string-name><surname>Cary</surname>, <given-names>M. P.</given-names></string-name> &#x0026; <string-name><surname>Sander</surname>, <given-names>C.</given-names></string-name> <article-title>Pathguide: a pathway resource list</article-title>. <source>Nucleic Acids Res</source> <volume>34</volume>, <fpage>D504</fpage>&#x2013;<lpage>506</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkj126</pub-id> (<year>2006</year>).</mixed-citation></ref>
<ref id="c55"><label>55</label><mixed-citation publication-type="journal"><string-name><surname>Kanehisa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Furumichi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Tanabe</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sato</surname>, <given-names>Y.</given-names></string-name> &#x0026; <string-name><surname>Morishima</surname>, <given-names>K.</given-names></string-name> <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>. <source>Nucleic Acids Res</source> <volume>45</volume>, <fpage>D353</fpage>&#x2013;<lpage>D361</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkw1092</pub-id> (<year>2017</year>).</mixed-citation></ref>
<ref id="c56"><label>56</label><mixed-citation publication-type="journal"><string-name><surname>Mootha</surname>, <given-names>V. K.</given-names></string-name> <etal>et al.</etal> <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>. <source>Nat Genet</source> <volume>34</volume>, <fpage>267</fpage>&#x2013;<lpage>273</lpage>, doi:<pub-id pub-id-type="doi">10.1038/ng1180</pub-id> (<year>2003</year>).</mixed-citation></ref>
<ref id="c57"><label>57</label><mixed-citation publication-type="journal"><string-name><surname>Young</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>Wakefield</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G. K.</given-names></string-name> &#x0026; <string-name><surname>Oshlack</surname>, <given-names>A.</given-names></string-name> <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>. <source>Genome Biol</source> <volume>11</volume>, <fpage>R14</fpage>, doi:<pub-id pub-id-type="doi">10.1186/gb-2010-11-2-r14</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c58"><label>58</label><mixed-citation publication-type="journal"><string-name><surname>Gu</surname>, <given-names>Z.</given-names></string-name> &#x0026; <string-name><surname>Wang</surname>, <given-names>J.</given-names></string-name> <article-title>CePa: an R package for finding significant pathways weighted by multiple network centralities</article-title>. <source>Bioinformatics</source> <volume>29</volume>, <fpage>658</fpage>&#x2013;<lpage>660</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt008</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c59"><label>59</label><mixed-citation publication-type="journal"><string-name><surname>Fang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Tian</surname>, <given-names>W.</given-names></string-name> &#x0026; <string-name><surname>Ji</surname>, <given-names>H.</given-names></string-name> <article-title>A network-based gene-weighting approach for pathway analysis</article-title>. <source>Cell Res</source> <volume>22</volume>, <fpage>565</fpage>&#x2013;<lpage>580</lpage>, doi:<pub-id pub-id-type="doi">10.1038/cr.2011.149</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c60"><label>60</label><mixed-citation publication-type="journal"><string-name><surname>Farfan</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Ma</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Sartor</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Michailidis</surname>, <given-names>G.</given-names></string-name> &#x0026; <string-name><surname>Jagadish</surname>, <given-names>H. V.</given-names></string-name> <article-title>THINK Back: KNowledge-based Interpretation of High Throughput data</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume> <issue>Suppl 2</issue>, <fpage>S4</fpage>, doi:<pub-id pub-id-type="doi">10.1186/1471-2105-13-S2-S4</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c61"><label>61</label><mixed-citation publication-type="journal"><string-name><surname>Tarca</surname>, <given-names>A. L.</given-names></string-name> <etal>et al.</etal> <article-title>A novel signaling pathway impact analysis</article-title>. <source>Bioinformatics</source> <volume>25</volume>, <fpage>75</fpage>&#x2013;<lpage>82</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btn577</pub-id> (<year>2009</year>).</mixed-citation></ref>
<ref id="c62"><label>62</label><mixed-citation publication-type="journal"><string-name><surname>Draghici</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>A systems biology approach for pathway level analysis</article-title>. <source>Genome Res</source> <volume>17</volume>, <fpage>1537</fpage>&#x2013;<lpage>1545</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.6202607</pub-id> (<year>2007</year>).</mixed-citation></ref>
<ref id="c63"><label>63</label><mixed-citation publication-type="journal"><string-name><surname>Glaab</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Baudot</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Krasnogor</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Schneider</surname>, <given-names>R.</given-names></string-name> &#x0026; <string-name><surname>Valencia</surname>, <given-names>A.</given-names></string-name> <article-title>EnrichNet: network-based gene set enrichment analysis</article-title>. <source>Bioinformatics</source> <volume>28</volume>, <fpage>i451</fpage>&#x2013;<lpage>i457</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts389</pub-id> (<year>2012</year>).</mixed-citation></ref>
<ref id="c64"><label>64</label><mixed-citation publication-type="journal"><string-name><surname>International Cancer Genome</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>International network of cancer genome projects</article-title>. <source>Nature</source> <volume>464</volume>, <fpage>993</fpage>&#x2013;<lpage>998</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature08987</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c65"><label>65</label><mixed-citation publication-type="journal"><string-name><surname>Grossman</surname>, <given-names>R. L.</given-names></string-name> <etal>et al.</etal> <article-title>Toward a Shared Vision for Cancer Genomic Data</article-title>. <source>NEngl J Med</source> <volume>375</volume>, <fpage>1109</fpage>&#x2013;<lpage>1112</lpage>, doi:<pub-id pub-id-type="doi">10.1056/NEJMp1607591</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c66"><label>66</label><mixed-citation publication-type="journal"><string-name><surname>Colaprico</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>TCGAbiolinks: an R/Bioconductor package for integrative analysis of TCGA data</article-title>. <source>Nucleic Acids Res</source> <volume>44</volume>, <elocation-id>e71</elocation-id>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkv1507</pub-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c67"><label>67</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>MapSplice: accurate mapping of RNA-seq reads for splice junction discovery</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>, <elocation-id>e178</elocation-id>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkq622</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c68"><label>68</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>B.</given-names></string-name> &#x0026; <string-name><surname>Dewey</surname>, <given-names>C. N.</given-names></string-name> <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>, <fpage>323</fpage>, doi: <pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id> (<year>2011</year>).</mixed-citation></ref>
</ref-list>
</back>
</article>