<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/140889</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Genetics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>An exact and efficient score test for variance components models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Schweiger</surname>
<given-names>Regev</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Weissbrod</surname>
<given-names>Omer</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rahmani</surname>
<given-names>Elior</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>M&#x00FC;ller-Nurasyid</surname>
<given-names>Martina</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Meitinger</surname>
<given-names>Thomas</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kunze</surname>
<given-names>Sonja</given-names>
</name>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gieger</surname>
<given-names>Christian</given-names>
</name>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Waldenberger</surname>
<given-names>Melanie</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rosset</surname>
<given-names>Saharon</given-names>
</name>
<xref ref-type="aff" rid="a10">10</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Halperin</surname>
<given-names>Eran</given-names>
</name>
<xref ref-type="aff" rid="a11">11</xref>
<xref ref-type="aff" rid="a12">12</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Blavatnik School of Computer Science, Tel Aviv University</institution>, Tel Aviv, <country>Israel</country></aff>
<aff id="a2"><label>2</label><institution>Department of Computer Science and Applied Mathematics, Weizmann Institute of Science</institution>, Rehovot 7610001, <country>Israel</country></aff>
<aff id="a3"><label>3</label><institution>Institute of Medical Informatics, Biometry and Epidemiology, Chair of Genetic Epidemiology, Ludwig-Maximilians-Universitat</institution>, 81377 Munich, <country>Germany</country></aff>
<aff id="a4"><label>4</label><institution>Institute of Genetic Epidemiology, Helmholtz Zentrum M&#x00FC;nchen - German Research Center for Environmental Health</institution>, 85764 Neuherberg, <country>Germany</country></aff>
<aff id="a5"><label>5</label><institution>DZHK (German Centre for Cardiovascular Research), partner site Munich Heart Alliance</institution>, Munich, <country>Germany</country></aff>
<aff id="a6"><label>6</label><institution>Institute of Human Genetics, Helmholtz Zentrum M&#x00FC;nchen - German Research Center for Environmental Health</institution>, 85764 Neuherberg, <country>Germany</country></aff>
<aff id="a7"><label>7</label><institution>Institute of Human Genetics, Technische Universit&#x00FC;t M&#x00FC;nchen</institution>, 85748 Munich, <country>Germany</country></aff>
<aff id="a8"><label>8</label><institution>Institute of Epidemiology II, Helmholtz Zentrum M&#x00FC;nchen - German Research Center for Environmental Health</institution>, 85764 Neuherberg, <country>Germany</country></aff>
<aff id="a9"><label>9</label><institution>Research Unit of Molecular Epidemiology, Helmholtz Zentrum M&#x00FC;nchen - German Research Center for Environmental Health</institution>, 85764 Neuherberg, <country>Germany</country></aff>
<aff id="a10"><label>10</label><institution>School of Mathematical Sciences, Department of Statistics, Tel Aviv University</institution>, Tel Aviv, <country>Israel</country></aff>
<aff id="a11"><label>11</label><institution>Department of Computer Science, University of California</institution>, Los Angeles, CA, <country>USA</country></aff>
<aff id="a12"><label>12</label><institution>Department of Anesthesiology and Perioperative Medicine, University of California</institution>, Los Angeles, CA, <country>USA</country></aff>
</contrib-group>
<pub-date pub-type="epub">
<year>2017</year>
</pub-date>
<elocation-id>140889</elocation-id>
<history>
<date date-type="received">
<day>03</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>03</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>03</day>
<month>6</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="140889.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>Testing for the existence of variance components in linear mixed models is a fundamental task in many applicative fields. In statistical genetics, the score test has recently become instrumental in the task of testing an association between a set of genetic markers and a phenotype. With few markers, this amounts to set-based variance component tests, which attempt to increase power in association studies by aggregating weak individual effects. When the entire genome is considered, it allows testing for the heritability of a phenotype, defined as the proportion of phenotypic variance explained by genetics. In the popular score-based Sequence Kernel Association Test (SKAT) method, the assumed distribution of the score test statistic is uncalibrated in small samples, with a correction being computationally expensive. This may cause severe inflation or deflation of p-values, even when the null hypothesis is true. Here, we characterize the conditions under which this discrepancy holds, and show it may occur also in large real datasets, such as a dataset from the Wellcome Trust Case Control Consortium 2 (<italic>n</italic>&#x003D;13,950) study, and in particular when the individuals in the sample are unrelated. In these cases the SKAT approximation tends to be highly over-conservative and therefore underpowered. To address this limitation, we suggest an efficient method to calculate exact p-values for the score test in the case of a single variance component and a continuous response vector, which can speed up the analysis by orders of magnitude. Our results enable fast and accurate application of the score test in heritability and in set-based association tests. Our method is available in <monospace><ext-link ext-link-type="uri" xlink:href="http://github.com/cozygene/RL-SKAT">http://github.com/cozygene/RL-SKAT</ext-link></monospace>.</p>
</abstract>
<counts>
<page-count count="14"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>The variance component model is a well established statistical framework used in many scientific fields. Testing for an association between several explanatory variables and a univariate response produces a variety of useful applications. For example, in metagenomics, an association is tested between a phenotype (e.g, body mass index, blood glucose levels, blood lipid levels, etc.) and the relative abundance counts of the measured species [<xref ref-type="bibr" rid="c1">1</xref>].</p>
<p>In statistical genetics, testing for an association between a set of genetic markers and a phenotype, such as a disease or a trait, is a fundamental task. Since studies to detect genetic signals are often underpowered, even with large datasets becoming available, the common approach to help alleviate this issue is grouping together genetic markers and testing them jointly. Grouping genetic markers is commonly implemented under the framework of variance component models. In addition to association testing, this framework can be used to answer several questions, such as estimation of the underying heritability of a phenotype [<xref ref-type="bibr" rid="c2">2</xref>]; estimating the uncertainty of such estimation [<xref ref-type="bibr" rid="c3">3</xref>&#x2013;<xref ref-type="bibr" rid="c5">5</xref>]; phenotype prediction [<xref ref-type="bibr" rid="c6">6</xref>], and more.</p>
<p>We consider two main scenarios in which such tests are performed: (i) a single phenotype, many sets of markers; (ii) many phenotypes, a single set of markers. Scenario (i) is common in set-testing, where relatively few markers are tested jointly. This is particularly useful in the case of rare variants, which are increasingly available for study using sequencing technologies, and which consistute a large part of human genetic variability. In such studies, a single phenotype is often tested against several sets of markers (for example, all rare variants in a single gene), because single-marker tests are often underpowered. Scenario (ii) occurs when studying heritability, defined as the proportion of phenotypic variance explained by genetics. Here, the tested markers are commonly the entire set of genotyped or sequenced single-nucleotide polymorphism (SNP) variants, or large portions of the genome (defined by, e.g., chromosome or functional annotation), and they are often tested against many (e.g., thousands) of phenotypes. Such phenotypes could be expression profiles of genes [<xref ref-type="bibr" rid="c7">7</xref>&#x2013;<xref ref-type="bibr" rid="c9">9</xref>], methlyation levels across of various methylation sites in the DNA [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref>] or neuroimaging measurements [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c13">13</xref>].</p>
<p>Within the variance components framework, a common approach for association testing is the score test, which is based on calculating the derivative of the likelihood function at the point corresponding to zero association, and testing if it is significantly nonzero. Compared with another popular alternative, the generalized likelihood ratio (LR) test, the score test is often advantegeous as it requires parameter estimation only for the null model, whereas the LR test requires parameter estimation for both the null and the alternative model. Additionally, the score test is the locally most powerful test; see [<xref ref-type="bibr" rid="c14">14</xref>] for a discussion.</p>
<p>The Sequence Kernel Association Test (SKAT) [<xref ref-type="bibr" rid="c15">15</xref>] has become the standard score-based test in statistical genetics and in metagenomics [<xref ref-type="bibr" rid="c1">1</xref>], in large part due to its computational tractability. One of its merits is that it does not rely on the asymptotic distribution of the score test statistic, instead specifying a non-asymptotic distribution for the statistic under the null hypothesis of no association. However, it has been observed that this distribution may be inaccurate. In the SKAT-O extension [<xref ref-type="bibr" rid="c16">16</xref>], a resampling-based moment-matching correction is suggested. An adaptive permutation testing procedure is suggested in [<xref ref-type="bibr" rid="c17">17</xref>]. Chen et al. [<xref ref-type="bibr" rid="c18">18</xref>] provide a method for calculating exact p-values; however, their method may be significantly slower than that of SKAT, as it requires the eigendecomposition of a full rank square matrix, whose computational complexity is typically cubic in the sample size, for each distinct response variable (e.g., phenotype) or each set of explanatory variables (e.g., SNP set). Finally, in these works, it is reported that this discrepancy occurs mainly in studies having a small sample size, and it is currently unclear to which extent the p-values of SKAT are calibrated for large sample sizes.</p>
<p>Here, we undertake a thorough analysis of the null distribution of the score test statistic, and its discrepancy under the SKAT approximation. We suggest a practical way to quantify this discrepancy, and show that such discrepancies may occur even at large sample sizes. We show that a discrepancy is expected when the number of markers is comparable to or larger than the number of individuals, and when the individuals are relatively unrelated. In particular, in addition to such inaccuracies occuring in tests of sets of rare-variants in small samples, we conclude that they may also occur in large scale heritability studies. We further suggest a computational method, Recalibrated Lightweight SKAT (RL-SKAT), that allows exact p-value computation while maintaining computation time as in SKAT; in particular, for multiple phenotypes tested against the same marker set, only a single eigendecomposition is required. Finally, we demonstrate and validate our results on two real datasets, a large dataset from the Wellcome Trust Case Control Consortium 2 [<xref ref-type="bibr" rid="c19">19</xref>] (WTCCC2) study and the Cooperative health research in the Region of Augsburg (KORA) study [<xref ref-type="bibr" rid="c20">20</xref>] dataset.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>The score test under the variance components model</title>
<p>We begin by reviewing the score test, as defined by the SKAT method [<xref ref-type="bibr" rid="c15">15</xref>] (see also the Supplemetary Information of [<xref ref-type="bibr" rid="c14">14</xref>] for an excellent review). We focus here on continuous phenotypes, and on the case of a single variance component; for other cases, see the Discussion.</p>
<sec id="s2a">
<label>2.1</label>
<title>The variance components model</title>
<p>We consider the following standard variance components model (see [<xref ref-type="bibr" rid="c21">21</xref>] for a detailed review). Let <italic>n</italic> be the number of observations and <bold>y</bold> be a <italic>n</italic> &#x00D7; 1 vector of responses. Let <bold>X</bold> be a <italic>n</italic> &#x00D7; <italic>p</italic> design matrix of p covariates, associated with fixed effects (possibly including an intercept vector <bold>1</bold><sub><italic>n</italic></sub> as a first column, as well as other covariates) and let <italic>&#x03B2;</italic> be a <italic>p</italic> &#x00D7; 1 vector of fixed effects. Finally, let <bold>K</bold> be a kernel matrix, which, in a kernel-based method such as SKAT, can be taken to be any symmetric positive-definite matrix that encodes similarity between individuals. Then, <bold>y</bold> is assumed to follow:</p>
<disp-formula id="eqn1"><alternatives>
<graphic xlink:href="140889_eqn1.gif"/></alternatives>
</disp-formula>
<p>The fixed effects &#x03B2; and the coefficients <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline1.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline2.gif"/></alternatives></inline-formula> are the parameters of the model.</p>
<p>In the context of statistical genetics, <bold>y</bold> is a vector of phenotype measurements for each individual and <bold>X</bold> is a matrix of covariates (often including an intercept, sex, age, etc.). Let <bold>Z</bold> be a <italic>n</italic> &#x00D7; <italic>m</italic> standardized (i.e., columns have zero mean and unit variance) genotype matrix containing the <italic>m</italic> SNPs we test. The common choice for <bold>K</bold> is a weighted dot product of the genetic markers [<xref ref-type="bibr" rid="c22">22</xref>]; formally, define <bold>K</bold> &#x003D; <bold>ZWZ</bold><sup>&#x22A4;</sup>, where <bold>W</bold> is a non-negative <bold>m</bold> &#x00D7; <bold>m</bold> diagonal matrix assigning a weight per SNP. A standard choice is the uniform <bold>W</bold><sub><italic>i,i</italic></sub> &#x003D; 1/<italic>m</italic> (see [<xref ref-type="bibr" rid="c15">15</xref>] for a discussion). The narrow-sense heritability due to genotyped common SNPs is defined as the proportion of total variance explained by genetic factors [<xref ref-type="bibr" rid="c23">23</xref>]:</p>
<disp-formula id="eqn2"><alternatives>
<graphic xlink:href="140889_eqn2.gif"/></alternatives>
</disp-formula>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>The score test</title>
<p>Under the above model, evaluating whether the tested covariates influence the response, while adjusting for additional covariates, corresponds to testing the null hypothesis <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline3.gif"/></alternatives></inline-formula>. SKAT tests this hypothesis with a variance component score test in the corresponding mixed model. Specifically, the score statistic in the single-kernel case is obtained from the derivative of the restricted likelihood, discarding terms which are constant with respect to y [<xref ref-type="bibr" rid="c14">14</xref>]:
<disp-formula id="eqn3"><alternatives>
<graphic xlink:href="140889_eqn3.gif"/></alternatives>
</disp-formula>
where <bold>S</bold> &#x003D; <bold>I</bold><sub><italic>n</italic></sub> &#x2212; <bold>X</bold>(<bold>X</bold><sup>&#x22A4;</sup><bold>X</bold>)<sup>&#x2212;1</sup><bold>X</bold><sup>&#x22A4;</sup> is the projection matrix to the subspace orthogonal to the covariates <bold>X</bold>. Note that <bold>S</bold><sup>2</sup> &#x003D; <bold>S</bold> &#x003D; <bold>S</bold><sup>&#x22A4;</sup>. Under the null, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline4.gif"/></alternatives></inline-formula> and thus, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline5.gif"/></alternatives></inline-formula>. Regressing out the covariates, we get <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline6.gif"/></alternatives></inline-formula> and thus <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline7.gif"/></alternatives></inline-formula>. Denote by <bold>U</bold> the matrix whose columns are the eigenvectors of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline8.gif"/></alternatives></inline-formula>, and denote its eigenvalues by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline9.gif"/></alternatives></inline-formula>. Then, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline10.gif"/></alternatives></inline-formula>. The score test statistic <italic>Q</italic> equals <italic>Q</italic> &#x003D; &#x2551;<bold>K</bold><sup>1/2</sup><bold>Sy</bold>&#x2551;<sup>2</sup> &#x003D; &#x2551;<bold>U</bold><sup>&#x22A4;</sup><bold>K</bold><sup>1/2</sup><bold>Sy</bold>&#x2551;<sup>2</sup>, and is therefore distributed
<disp-formula id="eqn4"><alternatives>
<graphic xlink:href="140889_eqn4.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline11.gif"/></alternatives></inline-formula> are i.i.d. random variables distributed chi-square with one degree of freedom. It can be seen that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline12.gif"/></alternatives></inline-formula> are equivalently the eigenvalues of the matrix <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline13.gif"/></alternatives></inline-formula>, using the fact that for every matrix <bold>A</bold>, <bold>AA</bold><sup>&#x22A4;</sup> and <bold>A</bold><sup>&#x22A4;</sup><bold>A</bold> have the same nonzero eigenvalues and that <bold>S</bold> &#x003D; <bold>S</bold><sup>&#x22A4;</sup>. For clarity of presentation, we will divide both the statistic and the eigenvalues by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline14.gif"/></alternatives></inline-formula>; that is, equivalently,
<disp-formula id="eqn5"><alternatives>
<graphic xlink:href="140889_eqn5.gif"/></alternatives>
</disp-formula>
where &#x007B;<italic>&#x03D5;<sub>i</sub></italic>&#x007D; are the eigenvalues of <bold>SKS</bold><sup>&#x22A4;</sup>.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>The exact distribution of the score test statistic</title>
<p>The above derivation is exact whenever <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline15.gif"/></alternatives></inline-formula> is known. However, in practice, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline16.gif"/></alternatives></inline-formula> is not known and needs to be estimated from the data; most often, from the single response vector we are testing. In practice, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline17.gif"/></alternatives></inline-formula> is replaced with its restricted maximum likelihood (REML) estimate. Then, the REML estimate is simply the corrected mean of the squared entries of the phenotype, after regressing out the covariates and using <bold>S</bold><sup>&#x22A4;</sup><bold>S</bold> &#x003D; <bold>S</bold>:</p>
<disp-formula id="eqn6"><alternatives>
<graphic xlink:href="140889_eqn6.gif"/></alternatives>
</disp-formula>
<p>We note that sometimes the ML estimate <bold>y</bold><sup>&#x22A4;</sup><bold>Sy</bold>/<italic>n</italic> is used, or just <bold>y</bold><sup>&#x22A4;</sup><bold>Sy</bold>; as this only introduces a multiplicative constant, we use the unbiased REML estimate for simplicity of presentation later. The statistic <italic>Q</italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline18.gif"/></alternatives></inline-formula>, are in fact dependent random variables. Therefore, the assumed distribution of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline19.gif"/></alternatives></inline-formula> (described in <xref ref-type="disp-formula" rid="eqn5">Equation (5)</xref>) does not hold when substituting <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline20.gif"/></alternatives></inline-formula> with its estimate, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline21.gif"/></alternatives></inline-formula>. In [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c24">24</xref>&#x2013;<xref ref-type="bibr" rid="c26">26</xref>], this subtitution is justified by the claim that the (restricted) ML estimator <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline22.gif"/></alternatives></inline-formula> is consistent, and may therefore be substituted by its true value for a sample size <italic>n</italic> large enough. However, this argument does not take into consideration the dependency between <italic>Q</italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline23.gif"/></alternatives></inline-formula>. Also, as shown below, this distribution might not hold in realistic settings. In Chen et al. [<xref ref-type="bibr" rid="c18">18</xref>], this discrepancy is reported for small samples, and an exact distribution is derived for the statistic <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline24.gif"/></alternatives></inline-formula>, and for any <italic>n</italic>, <bold>K</bold> and <bold>X</bold>, which we review here:</p>
<p><bold>Proposition 1</bold>. <italic>The distribution of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline25.gif"/></alternatives></inline-formula> may be modeled as a ratio of quadratic forms of normal variables. In particular, if</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline26.gif"/></alternatives></inline-formula>, <italic>then</italic></p>
<disp-formula id="eqn7"><alternatives>
<graphic xlink:href="140889_eqn7.gif"/></alternatives>
</disp-formula>
<p><italic>Proof</italic>. Assuming <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline27.gif"/></alternatives></inline-formula>, we get <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline28.gif"/></alternatives></inline-formula>. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline29.gif"/></alternatives></inline-formula>; then <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline30.gif"/></alternatives></inline-formula>. Thus, it follows that</p>
<disp-formula id="eqn8"><alternatives>
<graphic xlink:href="140889_eqn8.gif"/></alternatives>
</disp-formula>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Assessing the discrepancy</title>
<p>While noted in the literature [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c18">18</xref>], the above discrepancy is reported for small samples only. However, as we show now, it may occur also when the number of individuals is large. We give a qualitative measure for when to expect large discrepancies between the asymptotic approximation of a weighted mixture of chi-squares and the exact distribution. We begin by comparing the first two moments of the distributions of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline31.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline32.gif"/></alternatives></inline-formula>:</p>
<p><bold>Proposition 2</bold>. <italic>Demote the eigenvalues of</italic> <bold>SKS</bold> <italic>by &#x03D5;</italic><sub>1</sub>, &#x2026;, <italic>&#x03D5;<sub>n</sub>. Then the expectations of</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline33.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline34.gif"/></alternatives></inline-formula> <italic>are identical:</italic></p>
<disp-formula id="eqn9"><alternatives>
<graphic xlink:href="140889_eqn9.gif"/></alternatives>
</disp-formula>
<p><italic>Their variances are given by</italic>:</p>
<disp-formula id="eqn10"><alternatives>
<graphic xlink:href="140889_eqn10.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn11"><alternatives>
<graphic xlink:href="140889_eqn11.gif"/></alternatives>
</disp-formula>
<p><italic>Proof.</italic> Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline35.gif"/></alternatives></inline-formula>, and recall that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline36.gif"/></alternatives></inline-formula>. Then, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline37.gif"/></alternatives></inline-formula>. The first two moments of the quadratic form <bold>z</bold><sup>&#x22A4;</sup><bold>Az</bold>, for a symmetric, positive semi-definite matrix <bold>A</bold>, are readily given [<xref ref-type="bibr" rid="c27">27</xref>]. For <bold>A</bold> &#x003D; <bold>SKS</bold>, they are tr(<bold>SKS</bold>) and 2 &#x00B7; tr(<bold>SKS</bold> &#x00B7; <bold>SKS</bold>), respectively, from which the expressions for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline38.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline39.gif"/></alternatives></inline-formula> follow.</p>
<p>The first two moments of <bold>z</bold><sup>&#x22A4;</sup><bold>SKSz</bold>/<bold>z</bold><sup>&#x22A4;</sup><bold>Sz</bold> are given in [<xref ref-type="bibr" rid="c28">28</xref>], and are, respectively,</p>
<disp-formula id="eqn12"><alternatives>
<graphic xlink:href="140889_eqn12.gif"/></alternatives>
</disp-formula>
<p>Utilizing <xref ref-type="disp-formula" rid="eqn8">Equation (8)</xref>, the expressions for <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline40.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline41.gif"/></alternatives></inline-formula>.</p>
<p>It follows that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline42.gif"/></alternatives></inline-formula>; therefore, the distributions of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline43.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline44.gif"/></alternatives></inline-formula> have the same means but the latter having a smaller variance. We can further quantify the ratio between the variances as an indicator to the discrepancy between the distributions. First, note that there are at most <italic>n</italic> &#x2212; <italic>p</italic> non-zero eigenvalues <italic>&#x03D5;<sub>i</sub></italic>. Denote the first two sample moments of the eigenvalues by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline45.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline46.gif"/></alternatives></inline-formula>. Denote the empirical variance of the eigenvalues by <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline47.gif"/></alternatives></inline-formula>. Then, we get:</p>
<disp-formula><alternatives>
<graphic xlink:href="140889_ueqn1.gif"/></alternatives>
</disp-formula>
<p>The expression <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline48.gif"/></alternatives></inline-formula> is the (sample) coefficient of variation (CV) of the eigenvalues &#x2013; a unitless, relative measure of their dispersion. Therefore, the ratio becomes larger when the CV is smaller.</p>
<p>Also, as noted above, since the approximation wrongly ignores the dependency between the statistic <italic>Q</italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline49.gif"/></alternatives></inline-formula>, we expect the discrepancy to grow larger as the correlation between <italic>Q</italic> and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline50.gif"/></alternatives></inline-formula> increases. We therefore examine this correlation as an additional measure of this discrepancy.</p>
<p><bold>Proposition 3</bold>. <italic>Denote the eigenvalues of</italic> <bold>SKS</bold> <italic>by &#x03D5;</italic><sub>1</sub>, &#x2026;, <italic>&#x03D5;<sub>n</sub>. Then</italic>,</p>
<disp-formula id="eqn13"><alternatives>
<graphic xlink:href="140889_eqn13.gif"/></alternatives>
</disp-formula>
<p><italic>Proof</italic>. Let <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline51.gif"/></alternatives></inline-formula>, and let <bold>A</bold>, <bold>B</bold> be two symmetric, positive semi-definite matrices. Then (Theorem 3.2d.4 in [<xref ref-type="bibr" rid="c27">27</xref>]),</p>
<disp-formula id="eqn14"><alternatives>
<graphic xlink:href="140889_eqn14.gif"/></alternatives>
</disp-formula>
<p>Recall that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline52.gif"/></alternatives></inline-formula>. Therefore, ignoring constant factors,</p>
<disp-formula><alternatives>
<graphic xlink:href="140889_ueqn2.gif"/></alternatives>
</disp-formula>
<p>The last equality follows from the fact that <bold>S</bold> is a projection matrix to a <italic>n</italic> &#x2212; <italic>p</italic> dimensional subspace, and thus its <italic>n</italic> &#x2212; <italic>p</italic> nonzero eigenvalues are all 1-s, so that tr(<bold>S</bold>) &#x003D; <italic>n</italic> &#x2212; <italic>p</italic>.</p>
<p>An intuitive interpretation of the correlation is as follows.
<disp-formula id="eqn15"><alternatives>
<graphic xlink:href="140889_eqn15.gif"/></alternatives>
</disp-formula>
which again demonstrates that CV affects discrepancy &#x2013; the correlation becomes stronger when the CV is smaller. When <italic>CV</italic> &#x226A; 1, for example when <bold>K</bold> &#x2248; <bold>I</bold><sub><italic>n</italic></sub>, we have <italic>R</italic> &#x226B; 1 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline53.gif"/></alternatives></inline-formula>. Conversely, when <italic>CV</italic> &#x226B; 1, we have <italic>R</italic> &#x2248; 1 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline54.gif"/></alternatives></inline-formula>. This also gives the variance ratio as the function of the correlation as</p>
<disp-formula id="eqn16"><alternatives>
<graphic xlink:href="140889_eqn16.gif"/></alternatives>
</disp-formula>
<p>To summarize, the discrepancy is strong when the eigenvalues are more uniformly dispersed, and is weak when they have large variability.</p>
<p><bold>Examples</bold>. We now employ Propositions 2 and 3 to analyze several interesting examples in a genetic context. For simplicity, in the following, we use <bold>X</bold> &#x003D; 0, so that <italic>p</italic> &#x003D; 0 and <bold>S</bold> &#x003D; <bold>I</bold><sub><italic>n</italic></sub>.
<list list-type="bullet">
<list-item><p><bold>Completely unrelated cohort</bold>. Suppose the cohort contains completely unrelated individuals; then, <bold>K</bold> &#x003D; <bold>I</bold><sub><italic>n</italic></sub>. Thus, <italic>&#x03D5;</italic><sub>1</sub> &#x003D; &#x2026; &#x003D; <italic>&#x03D5;<sub>n</sub></italic> &#x003D; 1, so <italic>R</italic> &#x003D; &#x221E;, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline55.gif"/></alternatives></inline-formula>, and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline56.gif"/></alternatives></inline-formula> is the constant <italic>n</italic>. Compare this to the case where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline57.gif"/></alternatives></inline-formula> is known; then, it can be easily seen that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline58.gif"/></alternatives></inline-formula>. Therefore, the mean is the same but the variance vanishes completely.</p></list-item>
<list-item><p><bold>Rank-one kinship matrix</bold>. Consider the case of a simple burden test [<xref ref-type="bibr" rid="c16">16</xref>]: If we assume the random effects s of all SNPs are identical, the burden test becomes equivalent to the score test with <italic>K</italic> &#x003D; <italic>uu</italic><sup>&#x22A4;</sup>, where <bold>u</bold> &#x003D; <bold>Z1</bold><sub><italic>m</italic></sub>. Alternatively, consider the extreme case, where all the individuals are identical &#x2212; <bold>K</bold> &#x003D; <bold>11</bold><sup>&#x22A4;</sup> (while unlikely in human, this could be approximately true in studies of plants, yeast, etc.). In both these cases, there is a single nonzero eigenvalue: <italic>&#x03D5;</italic><sub>2</sub> &#x003D; &#x2026; &#x003D; <italic>&#x03D5;<sub>n</sub></italic> &#x003D; 0, which gives <italic>R</italic> &#x2248; 1 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline59.gif"/></alternatives></inline-formula>; that is, with large enough sample size, we expect the correlation to be effectively zero, and the SKAT mixture approximation to hold well.</p></list-item>
<list-item><p><bold>A full rank kinship matrix</bold>. Assume the matrix <bold>Z</bold> contains <italic>m</italic> &#x003E; <italic>n</italic> SNPs in linkage equilibrium, where each column was mean-centered and normalized to have unit variance. Choosing the linear kernel <bold>K</bold> &#x003D; <bold>ZZ</bold><sup>&#x22A4;</sup>/<italic>m</italic>, we follow [<xref ref-type="bibr" rid="c29">29</xref>] in modeling <bold>Z</bold> as a matrix of random standard normal variables, from which it follows that <bold>K</bold> is a Wishart matrix. The limit distribution of the density of the eigenvalues of <bold>K</bold> is specified by the Mar&#x010D;henko-Pastur distribution [<xref ref-type="bibr" rid="c30">30</xref>], with its first two moments known to be 1 and 1 &#x002B; <italic>n</italic>/<italic>m</italic>. Under this approximation, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline60.gif"/></alternatives></inline-formula>, <italic>&#x03D5;</italic><sup>2</sup> &#x2248; 1 &#x002B; <italic>n</italic>/<italic>m</italic>, <italic>&#x03C3;</italic><sup>2</sup>(<italic>&#x03D5;</italic>) &#x2248; <italic>n</italic>/<italic>m</italic>, <italic>R</italic> &#x2248; (<italic>n</italic> &#x2212; <italic>p</italic> &#x002B; 2)/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; (1 &#x002B; <italic>n</italic>/<italic>m</italic>)/(<italic>n</italic>/<italic>m</italic>) and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline61.gif"/></alternatives></inline-formula>. When <italic>m</italic> &#x226B; <italic>n</italic>, as is often the case, <italic>R</italic> &#x226B; 1 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline62.gif"/></alternatives></inline-formula>. This shows that for a large class of kinship matrices, we would expect the SKAT mixture approximation to hold poorly.</p></list-item>
<list-item><p><bold>A SNP set</bold>. Now, consider the case of set-testing, where <italic>Z</italic> is a normalized matrix of <italic>m</italic> &#x003C; <italic>n</italic> SNPs in linkage equilibrium. Following the modeling above, we have again <italic>R</italic> &#x2248; (<italic>n</italic> &#x2212; <italic>p</italic> &#x002B; 2)/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; (1 &#x002B; <italic>n</italic>/<italic>m</italic>)/(<italic>n</italic>/<italic>m</italic>) and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline63.gif"/></alternatives></inline-formula>; when <italic>m</italic> &#x226A; <italic>n</italic>, <italic>R</italic> &#x2248; 1 and <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline64.gif"/></alternatives></inline-formula>, and thus expecting a good approximation by the mixture. This perhaps shows why the SKAT mixture approximation was considered good in the context of set-tests, when few variants or a large sample is considered. This also shows why, in small samples, the mixture is expected to be a poor approximation.</p></list-item>
</list></p>
</sec>
<sec id="s4">
<label>4</label>
<title>Calculating p-values</title>
<p>We now describe how to efficiently calculate p-values for the distribution of the statistic <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline65.gif"/></alternatives></inline-formula> calculated from the data; that is, given an observed statistic <italic>r</italic>, what is <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline66.gif"/></alternatives></inline-formula> under the null? We review the result in Chen et al. [<xref ref-type="bibr" rid="c18">18</xref>]:</p>
<p><bold>Proposition 4</bold>. <italic>Let r be the observed value of the statistic. Denote by</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline67.gif"/></alternatives></inline-formula> <italic>the eigenvalues of</italic> <bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold>. <italic>Then</italic>,
<disp-formula id="eqn17"><alternatives>
<graphic xlink:href="140889_eqn17.gif"/></alternatives>
</disp-formula>
<italic>where</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline68.gif"/></alternatives></inline-formula> <italic>are i.i.d. random variables distributed chi-square with one degree of freedom</italic>.</p>
<p><italic>Proof</italic>. The condition <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline69.gif"/></alternatives></inline-formula> is equivalent to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline70.gif"/></alternatives></inline-formula>. Recall that if <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline71.gif"/></alternatives></inline-formula>, then under the null, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline72.gif"/></alternatives></inline-formula>. Denote by <bold>A</bold> the matrix whose columns are eigenvectors of <bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold>. Then, also <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline73.gif"/></alternatives></inline-formula>. Finally, define <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline74.gif"/></alternatives></inline-formula>. <sub>Then</sub>,</p>
<disp-formula><alternatives>
<graphic xlink:href="140889_ueqn3.gif"/></alternatives>
</disp-formula>
<p>However, this condition requires us to calculate the eigenvalues of <bold>SKS</bold>&#x2212;<italic>r</italic>/(<italic>n</italic>&#x2212;<italic>p</italic>)&#x00B7;<bold>S</bold> for each new value <italic>r</italic>, which, naively, has a complexity of <italic>O</italic>(<italic>n</italic><sup>3</sup>). We consider two scenarios where this is problematic. First, in many heritability studies, we wish to test the heritability of many (e.g., thousands) of phenotypes, all relative to the same kernel or kinship matrix (see the Introduction). For each phenotype <bold>y</bold><sub>1</sub>, &#x2026;, <bold>y</bold><sub><italic>N</italic></sub>, we calculate its score test statistic <italic>r<sub>i</sub></italic>. For p-value calculation, we need to compute the eigendecomposition of <bold>SKS</bold> &#x2212; <italic>r<sub>i</sub></italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold> for each observed statistic <italic>r<sub>i</sub></italic>, which is a significant computational burden.</p>
<p>A second problematic scenario is of an association study of a single phenotype with many sets of SNPs, e.g. rare variants. Choosing a weighted linear kernel as in SKAT [<xref ref-type="bibr" rid="c15">15</xref>], we have <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline75.gif"/></alternatives></inline-formula> for each set. As <bold>K</bold><sub><italic>i</italic></sub> changes with each test, in principle, we need to perform a costly <italic>O</italic>(<italic>n</italic><sup>3</sup>) eigendecomposition for each matrix <bold>K</bold><sub><italic>i</italic></sub>. However, a significant computational saving is gained due to the fact that the nonzero eigenvalues of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline76.gif"/></alternatives></inline-formula> are the same as those of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline77.gif"/></alternatives></inline-formula>, which is an <italic>m</italic> &#x00D7; <italic>m</italic> matrix [<xref ref-type="bibr" rid="c14">14</xref>]. As the number of tested SNPs <italic>m</italic> is often small, calculating the eigenvalues of this matrix instead is significantly faster, taking only <italic>O</italic>(<italic>m</italic><sup>3</sup>), with matrix construction taking only <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>) (see [<xref ref-type="bibr" rid="c14">14</xref>]). However, with the exact approach, we need to calculate the eigenvalues of <bold>SK</bold><sub><italic>i</italic></sub><bold>S</bold> &#x2212; <italic>r<sub>i</sub></italic>/(<italic>n</italic>&#x2212;<italic>p</italic>) &#x00B7; <bold>S</bold> instead of <bold>SK</bold><sub><italic>i</italic></sub><bold>S</bold>. Even when <bold>K</bold><sub><italic>i</italic></sub> is low rank, the matrix <bold>SK</bold><sub><italic>i</italic></sub><bold>S</bold> &#x2212; <italic>r<sub>i</sub></italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold> may be close to full rank, so another approach is needed.</p>
<p>Denote the column space of a matrix <bold>A</bold> by col(<bold>A</bold>), its null space by ker(<bold>A</bold>), and denote by &#x2295; the direct sum of subspaces. The following characterizes the eigenvalues of <bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold> given the eigenvalues of <bold>SKS</bold>:</p>
<p><bold>Proposition 5</bold>. <italic>Let r be the observed score test statistic. Denote by &#x03D5;</italic><sub>1</sub>, &#x2026;, <italic>&#x03D5;<sub>n</sub> the eigenvalues of</italic> <bold>SKS</bold>. <italic>Then</italic>,
<disp-formula id="eqn18"><alternatives>
<graphic xlink:href="140889_eqn18.gif"/></alternatives>
</disp-formula>
<italic>where k</italic> &#x003D; rank(<bold>SKS</bold>) <italic>is the number of nonzero eigenvalues &#x03D5;<sub>i</sub></italic>, <italic>q</italic> &#x003D; dim(ker(<bold>SKS</bold>) &#x22C2; col(<bold>S</bold>)), <italic>and</italic> <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline78.gif"/></alternatives></inline-formula> <italic>are i.i.d. random variables distributed chi-square with one degree of freedom, i</italic> &#x003D; 1, &#x2026;, <italic>k</italic> &#x002B; <italic>q</italic>.</p>
<p><italic>Proof</italic>. Recall that, from the fundamental theorem of linear algebra, for every symmetric matrix <bold>A</bold>, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline79.gif"/></alternatives></inline-formula>. As both <bold>SKS</bold> and <bold>S</bold> are symmetric, we can decompose <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline80.gif"/></alternatives></inline-formula>. We will construct a basis for each of these subspaces and characterize the operation of <bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold> on them. Note also that from the spectral theorem, there exists an orthonormal basis of eigenvectors of the symmetric matrix <bold>SKS</bold>. In particular, the set of eigenvectors corresponding to nonzero eigenvalues constitutes an orthonormal basis for col(<bold>SKS</bold>).</p>
<p>First, let <bold>v</bold><sub>1</sub>, &#x2026;, <bold>v</bold><sub><italic>k</italic></sub> be a basis consisting of such eigenvectors for col(<bold>SKS</bold>), where <italic>k</italic> &#x003D; rank(<bold>SKS</bold>). Let <bold>v</bold><sub><italic>i</italic></sub> be an eigenvector of <bold>SKS</bold> corresponding to the eigenvalue <italic>&#x03D5;<sub>i</sub></italic> &#x003E; 0. As <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline81.gif"/></alternatives></inline-formula>, we have that <bold>Sv</bold><sub><italic>i</italic></sub> &#x003D; <bold>v</bold><sub><italic>i</italic></sub>, where we used <bold>S</bold><sup>2</sup> &#x003D; <bold>S</bold>. Then, (<bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold>)<bold>v</bold><sub><italic>i</italic></sub> &#x003D; (<bold>&#x03D5;<sub>i</sub></bold> &#x2013; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>))<bold>v</bold><sub><italic>i</italic></sub>. Second, let <bold>v</bold><sub><italic>k</italic>&#x002B;1</sub>, &#x2026;, <bold>v</bold><sub><italic>k</italic>&#x002B;<italic>q</italic></sub> be a basis for ker(<bold>SKS</bold>) &#x22C2; col(<bold>S</bold>), where <italic>q</italic> &#x003D; dim(ker(<bold>SKS</bold>)&#x22C2; col(<bold>S</bold>)). For each such <bold>v</bold><sub><italic>i</italic></sub>, (<bold>SKS</bold> &#x2212;<italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>)&#x00B7;<bold>S</bold>)<bold>v</bold><sub><italic>i</italic></sub> &#x003D; &#x2212;<italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7;<bold>v</bold><sub><italic>i</italic></sub>. Finally, let <bold>v</bold><sub><italic>k</italic>&#x002B;<italic>q</italic>&#x002B;1</sub>, &#x2026;, <bold>v</bold><sub><italic>n</italic></sub> be a basis for ker(<bold>SKS</bold>) &#x22C2; ker(<bold>S</bold>). Clearly, for each such <bold>v</bold><sub><italic>i</italic></sub>, (<bold>SKS</bold> &#x2212; <italic>r</italic>/(<italic>n</italic> &#x2212; <italic>p</italic>) &#x00B7; <bold>S</bold>)<bold>v</bold><sub><italic>i</italic></sub> &#x003D; <bold>0</bold><sub><italic>n</italic></sub>.</p>
<p>As before, under the null, <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline82.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline83.gif"/></alternatives></inline-formula>. Let <bold>V</bold> be the orthonormal matrix whose columns are <bold>v</bold><sub>1</sub>, &#x2026;, <bold>v</bold><sub><italic>n</italic></sub> above; then also <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline84.gif"/></alternatives></inline-formula>. So,</p>
<disp-formula><alternatives>
<graphic xlink:href="140889_ueqn4.gif"/></alternatives>
</disp-formula>
<p>Defining <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline85.gif"/></alternatives></inline-formula>, the required result follows.</p>
<p>Proposition 5 shows that calculating the p-value amounts to evaluating the cumulative distribution function (cdf) of a certain weighted mixture of chi-square distribution at 0. This can be done rapidly using the Davies method [<xref ref-type="bibr" rid="c31">31</xref>], which is based on the numerical inversion of the characteristic function and runs in <italic>O</italic>(<italic>n</italic>) complexity, or using other methods [<xref ref-type="bibr" rid="c32">32</xref>].</p>
<p>It remains to calculate <italic>k</italic> and <italic>q</italic>. Naively, this can be done in <italic>O</italic>(<italic>n</italic><sup>3</sup>), and when the same kernel is used with many phenotypes, it is a single preprocessing step. However, when the number of SNPs used to construct the kernel and the number of covariates are small, these quantities can be calculated much faster:</p>
<p><bold>Proposition 6</bold>. <italic>Suppose</italic> <bold>K</bold> &#x003D; <bold>ZWZ</bold><sup>&#x22A4;</sup>, <italic>and let k</italic> &#x003D; rank(<bold>SKS</bold>) <italic>and q</italic> &#x003D; dim(ker(<bold>SKS</bold>) &#x22C2;col(<bold>S</bold>)). <italic>Then, k and q can be calculated in complexity O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>).</p>
<p><italic>Proof</italic>. Let <bold>B</bold> be the <italic>n</italic> &#x00D7; (<italic>m</italic>&#x002B;<italic>p</italic>) concatenated matrix <bold>B</bold> &#x003D; [<bold>SZW</bold><sup>1/2</sup>, <bold>X</bold>]. Then, rank(<bold>B</bold>) &#x003D; dim(col(<bold>SKS</bold>)&#x002B; col(<bold>X</bold>)) &#x003D; dim(col(<bold>SKS</bold>) &#x002B; ker(<bold>S</bold>)), since ker(<bold>S</bold>) &#x003D; col(<bold>X</bold>). Also note that ker(<bold>SKS</bold>) &#x22C2; col(<bold>S</bold>) &#x003D; col(<bold>SKS</bold>)&#x22A5; &#x22C2; ker(<bold>S</bold>)&#x22A5; &#x003D; (col(<bold>SKS</bold>) &#x002B; ker(<bold>S</bold>))&#x22A5;, where &#x22A5; denotes an orthogonal subspace. Using the above, we can express <italic>q</italic> as:</p>
<disp-formula><alternatives>
<graphic xlink:href="140889_ueqn5.gif"/></alternatives>
</disp-formula>
<p>To calculate <bold>SZW</bold><sup>1/2</sup>, recall that <bold>S</bold> &#x003D; <bold>I</bold><sub><italic>n</italic></sub> &#x2212; <bold>X</bold>(<bold>X</bold><sup>&#x22A4;</sup><bold>X</bold>)<sup>&#x2212;1</sup><bold>X</bold><sup>&#x22A4;</sup>, so that <bold>SZW</bold><sup>1/2</sup> &#x003D; <bold>ZW</bold><sup>1/2</sup>&#x2212;<bold>X</bold>(<bold>X</bold><sup>&#x22A4;</sup><bold>X</bold>)<sup>&#x2212;1</sup><bold>X</bold><sup>&#x22A4;</sup><bold>ZW</bold><sup>1/2</sup>. Calculating <bold>X</bold>&#x002B; &#x003D; (<bold>X</bold><sup>&#x22A4;</sup><bold>X</bold>)<sup>&#x2212;1</sup><bold>X</bold><sup>&#x22A4;</sup> is done once in preprocessing in complexity <italic>O</italic>(<italic>nm</italic><sup>2</sup> &#x002B; <italic>m</italic><sup>3</sup>). Then, <bold>SZW</bold><sup>1/2</sup> can be calculated by multiplying <italic>n</italic> &#x00D7; <italic>p</italic>, <italic>p</italic> &#x00D7; <italic>p</italic>, <italic>n</italic> &#x00D7; <italic>m</italic>, and <italic>m</italic> &#x00D7; <italic>m</italic> matrices, in complexity <italic>O</italic>(<italic>nm</italic><sup>2</sup> &#x002B; <italic>nmp</italic> &#x002B; <italic>np</italic><sup>2</sup>) &#x003D; <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>). As rank(<bold>SKS</bold>) &#x003D; rank(<bold>SZW</bold><sup>1/2</sup>), it can thus be calculated in <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>). Also, rank(<bold>B</bold>) can be calculated in standard methods (e.g. SVD) in <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>) as well.</p>
<p>Most commonly, <italic>k</italic> &#x003D; min(<italic>m</italic>, <italic>n</italic>) &#x2212; 1. When the number of SNPs <italic>m</italic> and the number of covariates <italic>p</italic> are small, the computational saving is substantial.</p>
<sec id="s4a">
<label>4.1</label>
<title>Performance summary</title>
<p>We summarize the results above in <xref ref-type="table" rid="tbl1">Table 1</xref>. We compare our method, RL-SKAT, with the SKAT formulation and the correction of [<xref ref-type="bibr" rid="c18">18</xref>] using the naive implementation of Proposition 4, as implemented by the MiRKAT software package [<xref ref-type="bibr" rid="c1">1</xref>]. The two scenarios discussed are those of a heritability study (same <bold>K</bold> with many responses <bold>y</bold><sub><italic>i</italic></sub>) and SNP set-testing (many low rank <bold>K</bold><sub><italic>i</italic></sub>). In all methods, a preprocessing step of calculating <bold>X</bold><sup>&#x002B;</sup> and &#x007B;<italic>&#x03D5;<sub>i</sub></italic>&#x007D; is required. In a heritability study, calculating the statistic <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="140889_inline86.gif"/></alternatives></inline-formula> amounts to evaluating two quadratic forms in <italic>O</italic>(<italic>n</italic><sup>2</sup>). Compared to our RL-SKAT, MiRKAT requires a full <italic>O</italic>(<italic>n</italic><sup>3</sup>) eigendecomposition for each <bold>y</bold><sub><italic>i</italic></sub>. For a set-testing study, these quadratic forms can be calculated in <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)) due to the low rank of <bold>K</bold><sub><italic>i</italic></sub>. Again, MiRKAT requires a full <italic>O</italic>(<italic>n</italic><sup>3</sup>) eigendecomposition, compared to the <italic>O</italic>(<italic>n</italic>(<italic>m</italic> &#x002B; <italic>p</italic>)<sup>2</sup>) procedure described in Proposition 6.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><title>Performance summary.</title>
<p>Comparison of the different approaches for p-value calculation discussed. RL-SKAT achieves accuracy while remaining computationally efficient.</p></caption>
<graphic xlink:href="140889_tbl1.tif"/>
</table-wrap>
</sec>
</sec>
<sec id="s5">
<label>5</label>
<title>Real data study: WTCCC2 and KORA</title>
<p>We now demonstrate our results on two datasets: a dataset from the Wellcome Trust Case Control Consortium 2 [<xref ref-type="bibr" rid="c19">19</xref>] (WTCCC2) study and the Cooperative health research in the Region of Augsburg (KORA) study [<xref ref-type="bibr" rid="c20">20</xref>]. A full description of data preprocessing is given in the Appendix.</p>
<sec id="s5a">
<label>5.1</label>
<title>A simulation study using WTCCC2 data</title>
<p>We first analyze data with real genotypes from the WTCCC2 Multiple Sclerosis dataset, and simulated phenotypes. We used the same data processing described in [<xref ref-type="bibr" rid="c33">33</xref>], resulting in <italic>m</italic>&#x003D;360,556 SNPs for <italic>n</italic>&#x003D;13,950 individuals. We constructed the kinship matrix by a standard, uniformly weighted linear kernel. We sought to demonstrate the discrepancy between the true null distribution and the chi-square weighted mixture distribution. Following Proposition 3, we calculated the correlation to be 0.886 and variance ratio to be <italic>R</italic> &#x003D; 4.69, indicating that a large discrepancy is possibly expected. To verify this, we simulated 10,000 random phenotypes, where each phenotype is a vector of i.i.d. standard normal variables. We tested whether the variance component is significantly greater than zero, and calculated their p-values under the assumption of either of the two distributions. In <xref ref-type="fig" rid="fig1">Figure 1</xref>, we show the quantile-quantile plots for the two sets of p-values. As evidenced, using the SKAT mixture distribution results in a severe deflation of small p-values, while using the correct distribution as in <xref ref-type="disp-formula" rid="eqn5">Equation 5</xref> results in an accurate p-value distribution. This shows that even for large sample size (<italic>n</italic>&#x003D;13,950), such a discrepancy is possible.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Statistic distribution.</title>
<p>Results of the WTCCC2 data analysis, presented by quantile-quantile plots of the &#x2013; log<sub>10</sub>(<italic>p</italic>)-values for heritability significance of 10,000 random phenotypes drawn under the null distribution. Significant deviation from the black line indicates an deflation arising from an inaccurate null distribution. Calculation under the assumption of a weighted mixture of chi-square distribution, gives deflated p-values and potentially creating false negatives. Using the correct distribution, as implemented in RL-SKAT, results in calibrated p-values.</p></caption>
<graphic xlink:href="140889_fig1.tif"/>
</fig>
</sec>
<sec id="s5b">
<label>5.2</label>
<title>Testing for heritable methylation sites in the KORA dataset</title>
<p>The longitudinal KORA study consists of whole-blood methylation levels and genotypes of n&#x003D;1,799 individuals. The phenotype is the proportion of methylated samples at a specific site, averaged across DNA samples of an individual. The study consists of independent population-based subjects from the general population living in the region of Augsburg, southern Germany [<xref ref-type="bibr" rid="c20">20</xref>]. Whole-blood samples of the KORA F4 study were used as described elsewhere [<xref ref-type="bibr" rid="c34">34</xref>]. In summary, a total of 431,366 methylation site phenotypes, and 657,103 SNPs, were available for analysis. The correlation as in Proposition 3 is 0.976 and the variance ratio is <italic>R</italic> &#x003D; 22.01, indicating again that a large discrepancy is expected. We performed a heritability study of multiple phenotypes with the same kinship matrix, by testing the heritability of the <italic>N</italic>&#x003D;43,140 methylation sites on chromosome 1. As it is common for a methylation site to be correlated with its surrounding SNPs [<xref ref-type="bibr" rid="c37">37</xref>&#x2013;<xref ref-type="bibr" rid="c39">39</xref>], we avoided such <italic>cis</italic> effects by using a kinship matrix constructed from the <italic>m</italic>&#x003D;604,170 SNPs on all chromosomes other than 1. The kinship matrix is constructed by a standard, uniformly weighted linear kernel. For covariates, we used <bold>X</bold> consisting only of an intercept vector. Again, we calculated p-values under the assumption of the two distributions. We note that it has been shown that some methylation site profiles often display significant heritability, while others do not; thus, both significant and insignificant p-values are expected [<xref ref-type="bibr" rid="c40">40</xref>].</p>
<p>In <xref ref-type="fig" rid="fig2">Figure 2</xref> we show the histograms of the log<sub>10</sub> of the p-value of all the considered phenotypes. The two histograms are indeed very different; p-values calculated using the inaccurate SKAT mixture distribution indicate that the heritability of almost all sites is considered insignificant; for example, using a Bonferroni threshold of 0.05 &#x00B7; 1/43140 &#x2248; 10<sup>&#x2212;6</sup>, only 8/43,140 sites are significant. In light of the results above, it is reasonable to suspect that p-values of many heritable phenotypes are deflated, thus causing false negatives. The p-values distribution has a peak around 0.5, likely an artifact of the inaccurate calculation method. In comparison, p-values calculated by RL-SKAT do not exhibit such a peak. They are significantly smaller, and using the same Bonferroni threshold, we now find 319/43,140 significant sites. Indeed, a simulated power study of both approaches under varying degrees of true underlying heritability validates that the inaccurate approach results in a severe decrease in power (<xref ref-type="fig" rid="fig3">Figure 3</xref>). We conclude that in this dataset, using the SKAT distribution for p-value calculation is highly problematic.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Heritability study.</title>
<p>Histograms of the p-values of the studied phenotypes in the KORA dataset, as calculated by the accurate method (left) and the inaccurate method (right). Histograms are shown in log-scale, and are capped at p &#x003D; 10<sup>&#x2212;8</sup> for clarity of presentation. SKAT tends to severely deflate p-values which are small according to the accurate calculation, leading to a severe loss of power.</p></caption>
<graphic xlink:href="140889_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Power study.</title>
<p>The power of the accurate approach and SKAT is shown for p-value threshold of <italic>p</italic> &#x003D; 0.05, for the KORA dataset, on 10,000 simulated phenotypes with varying degrees of true underlying heritability. SKAT is seen to be severely underpowered.</p></caption>
<graphic xlink:href="140889_fig3.tif"/>
</fig>
</sec>
<sec id="s5c">
<label>5.3</label>
<title>Benchmarks</title>
<p>Finally, we benchmarked the methods discuss here on the KORA dataset under the two above scenarios, on a 64G, 2.2GHz Linux workstation, using our implementation in the Python language, comparable in running time to that of MiRKAT. For the scenario of heritability testing, we calculated the p-values of 1000 phenotypes with the kinship matrix. For the scenario of set testing, we used 1000 sets of 100 SNPs each. The results are summarized in <xref ref-type="table" rid="tbl2">Table 2</xref>; as expected, the computational savings are very significant, achieving a speedup of more than two orders of magnitude. We expect the speedup to be even more significant for larger datasets.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><title>Benchmarks.</title>
<p>Benchmark of the performance of different approaches for p-value calculation, applied to the KORA dataset.</p></caption>
<graphic xlink:href="140889_tbl2.tif"/>
</table-wrap>
</sec>
</sec>
<sec id="s6">
<label>6</label>
<title>Discussion</title>
<p>We have shown that the distribution suggested by SKAT to the score test statistic may be very inaccurate. Unlike previous studies, which have noted this discrepancy only in small sample sizes, we have shown that it might occur in large studies as well. We have proposed a computational method to accurately calculate p-values without compromising computational time. Finally, we demonstrated our findings in two datasets.</p>
<p>The exact calculation of p-values can be applied to other variants of the score test; for example, the SKAT-O [<xref ref-type="bibr" rid="c16">16</xref>] seeks to find an optimal combination of burden tests and non-burden tests, which amounts to the score test with a certain kernel.</p>
<p>In this work, we focused on the case of a single kernel, and on a continuous phenotype. The extension of this work to multiple kernels (e.g., corresponding to several sets of SNPs) or to binary phenotypes (e.g., case/control studies) is nontrivial, as the null distribution cannot be modeled as a ratio of quadratic forms; see, e.g., [<xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref>]. It therefore remains a subject for future work.</p>
</sec>
</body>
<back>
<ack>
<label>7</label>
<title>Acknowledgements</title>
<p>R.S. is supported by the Colton Family Foundation. This study was supported in part by a fellowship from the Edmond J. Safra Center for Bioinformatics at Tel Aviv University to R.S. This study makes use of data generated by the Wellcome Trust Case Control Consortium. A full list of the investigators who contributed to the generation of the data is available from <monospace><ext-link ext-link-type="uri" xlink:href="http://www.wtccc.org.uk">http://www.wtccc.org.uk</ext-link></monospace>. Funding for the project was provided by the Wellcome Trust under award 076113. The KORA study was initiated and financed by the Helmholtz Zentrum M&#x00FC;nchen German Research Center for Environmental Health, which is funded by the German Federal Ministry of Education and Research (BMBF) and by the State of Bavaria. Furthermore, KORA research has been supported within the Munich Center of Health Sciences (MC-Health), Ludwig-Maximilians-Universit&#x00E4;t, as part of LMUinnovativ.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><given-names>Ni</given-names> <surname>Zhao</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Testing in microbiome-profiling studies with MiRKAT, the microbiome regression-based kernel association test</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>96.5</volume>(<issue>2015</issue>), pp. <fpage>797</fpage>&#x2013;<lpage>807</lpage>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><given-names>Hyun Min</given-names> <surname>Kang</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>&#x201D;. In: <source>Nature genetics</source> <volume>42.4</volume>(<issue>2010</issue>), pp. <fpage>348</fpage>&#x2013;<lpage>354</lpage>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><surname>Nicholas</surname> <given-names>A Furlotte</given-names></string-name>, <string-name><given-names>David</given-names> <surname>Heckerman</surname></string-name>, and <string-name><given-names>Christoph</given-names> <surname>Lippert</surname></string-name>. &#x201C;<article-title>Quantifying the uncertainty in heritability</article-title>&#x201D;. In: <source>Journal of human genetics</source> <volume>59.5</volume> (<issue>2014</issue>), pp. <fpage>269</fpage>&#x2013;<lpage>275</lpage>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><given-names>Regev</given-names> <surname>Schweiger</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Fast and accurate construction of confidence intervals for heritability</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>98.6</volume> (<issue>2016</issue>), pp. <fpage>1181</fpage>&#x2013;<lpage>1192</lpage>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="book"><string-name><given-names>Regev</given-names> <surname>Schweiger</surname></string-name> <etal>et al.</etal> &#x201C;<chapter-title>Using Stochastic Approximation Techniques to Efficiently Construct Confidence Intervals for Heritability</chapter-title>&#x201D;. In: <source>International Conference on Research in Computational Molecular Biology</source>. <publisher-name>Springer</publisher-name>. <year>2017</year>, pp. <fpage>241</fpage>&#x2013;<lpage>256</lpage>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>BJ</given-names> <surname>Hayes</surname></string-name>, <string-name><given-names>ME</given-names> <surname>Goddard</surname></string-name>, <etal>et al.</etal> &#x201C;<article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>&#x201D;. In: <source>Genetics</source> <volume>157.4</volume> (<issue>2001</issue>), pp. <fpage>1819</fpage>&#x2013;<lpage>1829</lpage>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><given-names>Alkes L</given-names> <surname>Price</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Single-tissue and cross-tissue heritability of gene expression via identity-by-descent in related or unrelated individuals</article-title>&#x201D;. In: <source>PLoS Genet</source> <volume>7.2</volume> (<issue>2011</issue>), <fpage>e1001317</fpage>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>Fred A</given-names> <surname>Wright</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Heritability and genomics of gene expression in peripheral blood</article-title>&#x201D;. In: <source>Nature genetics</source> <volume>46.5</volume> (<year>2014</year>), pp. <fpage>430</fpage>&#x2013;<lpage>437</lpage>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="other"><string-name><given-names>Luke R</given-names> <surname>Lloyd-Jones</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>The genetic architecture of gene expression in peripheral blood</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> (<year>2017</year>).</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="other"><string-name><given-names>Gerald</given-names> <surname>Quon</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Patterns of methylation heritability in a genome-wide analysis of four brain regions</article-title>&#x201D;. In: <source>Nucleic acids research</source> (<year>2013</year>), <fpage>gks1449</fpage>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><given-names>Jenny</given-names> <surname>Van Dongen</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Genetic and environmental influences interact with age and sex in shaping the human methylome</article-title>&#x201D;. In: <source>Nature communications</source> <volume>7</volume> (<year>2016</year>).</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><given-names>Habib</given-names> <surname>Ganjgahi</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Fast and powerful heritability inference for family-based neuroimaging studies</article-title>&#x201D;. In: <source>NeuroImage</source> <volume>115</volume> (<year>2015</year>), pp. <fpage>256</fpage>&#x2013;<lpage>268</lpage>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><given-names>Tian</given-names> <surname>Ge</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Massively expedited genome-wide heritability analysis (MEGHA)</article-title>&#x201D;. In: <source>Proceedings of the National Academy of Sciences</source> <volume>112.8</volume> (<year>2015</year>), pp. <fpage>2479</fpage>&#x2013;<lpage>2484</lpage>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="other"><string-name><given-names>Christoph</given-names> <surname>Lippert</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Greater power and computational efficiency for kernel-based association testing of sets of genetic variants</article-title>&#x201D;. In: <source>Bioinformatics</source> (<year>2014</year>), <fpage>btu504</fpage>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><given-names>Michael C</given-names> <surname>Wu</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Rare-variant association testing for sequencing data with the sequence kernel association test</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>89.1</volume> (<issue>2011</issue>), pp. <fpage>82</fpage>&#x2013;<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>Seunggeun</given-names> <surname>Lee</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Optimal unified approach for rare-variant association testing with application to small-sample case-control whole-exome sequencing studies</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>91.2</volume> (<issue>2012</issue>), pp. <fpage>224</fpage>&#x2013;<lpage>237</lpage>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><given-names>Takanori</given-names> <surname>Hasegawa</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>AP-SKAT: highly-efficient genome-wide rare variant association test</article-title>&#x201D;. In: <source>BMC genomics</source> <volume>17.1</volume> (<issue>2016</issue>), p. <fpage>745</fpage>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><given-names>Jun</given-names> <surname>Chen</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Small sample kernel association tests for human genetic and microbiome association studies</article-title>&#x201D;. In: <source>Genetic epidemiology</source> <volume>40.1</volume> (<issue>2016</issue>), pp. <fpage>5</fpage>&#x2013;<lpage>19</lpage>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><collab>International Multiple Sclerosis Genetics Consortium, Wellcome Trust Case Control Consortium 2</collab>, <etal>et al.</etal> &#x201C;<article-title>Genetic risk and a primary role for cell-mediated immune mechanisms in multiple sclerosis</article-title>&#x201D;. In: <source>Nature</source> <volume>476.7359</volume> (<issue>2011</issue>), pp. <fpage>214</fpage>&#x2013;<lpage>219</lpage>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><given-names>H-E</given-names> <surname>Wichmann</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>KORA-gen-resource for population genetics, controls and a broad spectrum of disease phenotypes</article-title>&#x201D;. In: <source>Das Gesundheitswesen</source> <volume>67.S 01</volume> (<issue>2005</issue>), pp. <fpage>26</fpage>&#x2013;<lpage>30</lpage>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="book"><string-name><given-names>Shayle R</given-names> <surname>Searle</surname></string-name>, <string-name><given-names>George</given-names> <surname>Casella</surname></string-name>, and <string-name><given-names>Charles E</given-names> <surname>McCulloch</surname></string-name>. <source>Variance components</source>. Vol. <volume>391</volume>. <publisher-name>John Wiley &#x0026; Sons</publisher-name>, <year>2009</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><given-names>Jian</given-names> <surname>Yang</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>.&#x201D; In: <source>Nature Genetics</source> <volume>42.7</volume> (<month>July</month> <year>2010</year>), pp. <fpage>565</fpage>&#x2013;<lpage>9</lpage>. <issn>ISSN: 1546-1718.</issn> DOI: <pub-id pub-id-type="doi">10.1038/ng.608</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><given-names>Peter M</given-names> <surname>Visscher</surname></string-name>, <string-name><given-names>William G</given-names> <surname>Hill</surname></string-name>, and <string-name><given-names>Naomi R</given-names> <surname>Wray</surname></string-name>. &#x201C;<article-title>Heritability in the genomics era &#x2013; concepts and misconceptions</article-title>&#x201D;. In: <source>Nature Reviews Genetics</source> <volume>9.4</volume> (<issue>2008</issue>), pp. <fpage>255</fpage>&#x2013;<lpage>266</lpage>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><given-names>Daowen</given-names> <surname>Zhang</surname></string-name> and <string-name><given-names>Xihong</given-names> <surname>Lin</surname></string-name>. &#x201C;<article-title>Hypothesis testing in semiparametric additive mixed models</article-title>&#x201D;. In: <source>Biostatistics</source> <volume>4.1</volume> (<issue>2003</issue>), pp. <fpage>57</fpage>&#x2013;<lpage>74</lpage>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><given-names>Dawei</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>Xihong</given-names> <surname>Lin</surname></string-name>, and <string-name><given-names>Debashis</given-names> <surname>Ghosh</surname></string-name>. &#x201C;<article-title>Semiparametric Regression of Multidimensional Genetic Pathway Data: Least-Squares Kernel Machines and Linear Mixed Models</article-title>&#x201D;. In: <source>Biometrics</source> <volume>63.4</volume> (<issue>2007</issue>), pp. <fpage>1079</fpage>&#x2013;<lpage>1088</lpage>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><given-names>Dawei</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>Debashis</given-names> <surname>Ghosh</surname></string-name>, and <string-name><given-names>Xihong</given-names> <surname>Lin</surname></string-name>. &#x201C;<article-title>Estimation and testing for the effect of a genetic pathway on a disease outcome using logistic kernel machine regression via logistic mixed models</article-title>&#x201D;. In: <source>BMC bioinformatics</source> <volume>9.1</volume> (<issue>2008</issue>), p. <fpage>292</fpage>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="book"><string-name><given-names>Arakaparampil M</given-names> <surname>Mathai</surname></string-name> and <string-name><given-names>Serge B</given-names> <surname>Provost</surname></string-name>. <source>Quadratic forms in random variables: theory and applications</source>. <publisher-name>M. Dekker</publisher-name> <publisher-loc>New York</publisher-loc>, <year>1992</year>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><given-names>Marc S</given-names> <surname>Paolella</surname></string-name>. &#x201C;<article-title>Computing moments of ratios of quadratic forms in normal variables</article-title>&#x201D;. In: <source>Computational statistics &#x0026; data analysis</source> <volume>42.3</volume> (<issue>2003</issue>), pp. <fpage>313</fpage>&#x2013;<lpage>331</lpage>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><given-names>Nick</given-names> <surname>Patterson</surname></string-name>, <string-name><given-names>Alkes L</given-names> <surname>Price</surname></string-name>, and <string-name><given-names>David</given-names> <surname>Reich</surname></string-name>. &#x201C;<article-title>Population structure and eigenanalysis</article-title>&#x201D;. In: <source>PLoS genet</source> <volume>2.12</volume> (<issue>2006</issue>), <fpage>e190</fpage>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><given-names>Vladimir A</given-names> <surname>Marcenko</surname></string-name> and <string-name><given-names>Leonid Andreevich</given-names> <surname>Pastur</surname></string-name>. &#x201C;<article-title>Distribution of eigenvalues for some sets of random matrices</article-title>&#x201D;. In: <source>Mathematics of the USSR-Sbornik</source> <volume>1.4</volume> (<issue>1967</issue>), p. <fpage>457</fpage>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><given-names>Robert B</given-names> <surname>Davies</surname></string-name>. &#x201C;<article-title>Algorithm AS 155: The distribution of a linear combination of <italic>&#x03C7;</italic><sup>2</sup> random variables</article-title>&#x201D;. In: <source>Journal of the Royal Statistical Society. Series C (Applied Statistics)</source> <volume>29.3</volume> (<year>1980</year>), pp. <fpage>323</fpage>&#x2013;<lpage>333</lpage>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><collab>Pierre Duchesne and Pierre Lafaye De Micheaux</collab>. &#x201C;<article-title>Computing the distribution of quadratic forms: Further comparisons between the Liu&#x2013;Tang&#x2013;Zhang approximation and exact methods</article-title>&#x201D;. In: <source>Computational Statistics &#x0026; Data Analysis</source> <volume>54.4</volume> (<issue>2010</issue>), pp. <fpage>858</fpage>&#x2013;<lpage>862</lpage>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><string-name><given-names>Jian</given-names> <surname>Yang</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Advantages and pitfalls in the application of mixed-model association methods</article-title>&#x201D;. In: <source>Nature genetics</source> <volume>46.2</volume> (<issue>2014</issue>), pp. <fpage>100</fpage>&#x2013;<lpage>106</lpage>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><string-name><given-names>Liliane</given-names> <surname>Pfeifferm</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>DNA methylation of lipid-related genes affects blood lipid levels</article-title>&#x201D;. In: <source>Circulation: Cardiovascular Genetics</source> (<year>2015</year>), CIRCGENETICS&#x2013;114.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><given-names>Andrew E</given-names> <surname>Teschendorff</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>A beta-mixture quantile normalization method for correcting probe design bias in Illumina Infinium 450 k DNA methylation data</article-title>&#x201D;. In: <source>Bioinformatics</source> <volume>29.2</volume> (<issue>2013</issue>), pp. <fpage>189</fpage>&#x2013;<lpage>196</lpage>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><string-name><given-names>Melanie</given-names> <surname>Kolz</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Meta-analysis of 28,141 individuals identifies common variants within five new loci that influence uric acid concentrations</article-title>&#x201D;. In: <source>PLoS Genet</source> <volume>5.6</volume> (<issue>2009</issue>), <fpage>e1000504</fpage>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><string-name><given-names>J Raphael</given-names> <surname>Gibbs</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Abundant quantitative trait loci exist for DNA methylation and gene expression in human brain</article-title>&#x201D;. In: <source>PLoS Genet</source> <volume>6.5</volume> (<issue>2010</issue>), <fpage>e1000952</fpage>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><string-name><given-names>Dandan</given-names> <surname>Zhang</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Genetic control of individual differences in gene-specific methylation in human brain</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>86.3</volume> (<issue>2010</issue>), pp. <fpage>411</fpage>&#x2013;<lpage>419</lpage>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><string-name><given-names>Jordana T</given-names> <surname>Bell</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>DNA methylation patterns associate with genetic and gene expression variation in HapMap cell lines</article-title>&#x201D;. In: <source>Genome biology</source> <volume>12.1</volume> (<issue>2011</issue>), <fpage>R10</fpage>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><string-name><given-names>Elior</given-names> <surname>Rahmani</surname></string-name> <etal>et al.</etal> &#x201C;<article-title>Genome-wide methylation data mirror ancestry information</article-title>&#x201D;. In: <source>Epigenetics &#x0026; Chromatin</source> <volume>10.1</volume> (<issue>2017</issue>), p. <fpage>1</fpage>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><string-name><given-names>Baolin</given-names> <surname>Wu</surname></string-name>, <string-name><given-names>Weihua</given-names> <surname>Guan</surname></string-name>, and <string-name><given-names>James S</given-names> <surname>Pankow</surname></string-name>. &#x201C;<article-title>On Efficient and Accurate Calculation of Significance P-Values for Sequence Kernel Association Testing of Variant Set</article-title>&#x201D;. In: <source>Annals of human genetics</source> <volume>80.2</volume> (<issue>2016</issue>), pp. <fpage>123</fpage>&#x2013;<lpage>135</lpage>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><string-name><given-names>Kai</given-names> <surname>Wang</surname></string-name>. &#x201C;<article-title>Boosting the Power of the Sequence Kernel Association Test by Properly Estimating Its Null Distribution</article-title>&#x201D;. In: <source>The American Journal of Human Genetics</source> <volume>99.1</volume> (<issue>2016</issue>), pp. <fpage>104</fpage>&#x2013;<lpage>114</lpage>.</mixed-citation></ref>
</ref-list>
<sec id="s7">
<label>A</label>
<title>Data preprocessing</title>
<sec id="s7a">
<label>A.1</label>
<title>WTCCC2</title>
<p>UK controls and cases from both UK and non-UK were used. SNPs were removed with &#x003E; 0.5&#x0025; missing data, <italic>p</italic> &#x003C; 0. 01 for allele frequency difference between two control groups, <italic>p</italic> &#x003C; 0. 05 for deviation from Hardy-Weinberg equilibrium, <italic>p</italic> &#x003C; 0.05 for differential missingness between cases and controls, or minor allele frequency &#x003C; 1&#x0025;. In all analyses, SNPs within 5M base pairs of the human leukocyte antigen (HLA) region were excluded, resulting in <italic>m</italic>&#x003D;360,556 SNPs. Finally, from each pair of individuals with relatedness of more than 0.025, one was removed, resulting in <italic>n</italic>&#x003D;13,950 individuals.</p>
</sec>
<sec id="s7b">
<label>A.2</label>
<title>KORA</title>
<p>DNA methylation levels were collected using the Infinium HumanMethylation450K BeadChip array (Illumina). Beta Mixture Quantile (BMIQ) [<xref ref-type="bibr" rid="c35">35</xref>] normalization was applied to the methylation levels. As described elsewhere [<xref ref-type="bibr" rid="c36">36</xref>], genotyping was performed with the Affymetrix 6.0 SNP Array (534,174 SNP markers after quality control), with further imputation using HapMap2 as a reference panel. A total of 657,103 probes remained for the analysis.</p>
</sec>
</sec>
</back>
</article>