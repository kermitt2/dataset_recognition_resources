<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/259325</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Ecology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Effects of Normalization, Transformation, and Rarefaction on Clustering of OTU Abundance</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Molik</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pfrender</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Emrich</surname>
<given-names>Scott</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Biology, University of Notre Dame</institution>, Notre Dame, <country>United States of America</country>, <email>dmolik@nd.edu</email></aff>
<aff id="a2"><label>2</label><institution>Department of Biology, University of Notre Dame</institution>, Notre Dame, <country>United States of America</country>, <email>mpfrende@nd.edu</email></aff>
<aff id="a3"><label>3</label><institution>Department of Electrical Engineering and Computer Science, The University of Tennessee Knoxville</institution>, Knoxville, <country>United States of America</country>, <email>semrich@nd.edu</email></aff>
</contrib-group>
<pub-date pub-type="epub"><year>2018</year></pub-date>
<elocation-id>259325</elocation-id>
<history>
<date date-type="received">
<day>02</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="rev-recd">
<day>02</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>06</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="259325.pdf" content-type="pdf" xlink:role="full-text"/>
<counts>
<page-count count="7"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Metagenomic clustering presents a unique opportunity to associate and understand communities. Working with Operational Taxonomic Units (OTUs), however, often requires a strategy for handling OTUs that may be over or under represented in a given sample, which is thought of as &#x201C;erroneous&#x201D;. PCR amplification, for example, is known to sometimes non-linearly over-represent more common species <italic><xref ref-type="bibr" rid="c4">Gonzalez et al. 2012</xref></italic>. Strategies dealing with this bias include Normalization, Rarefaction, and Log Transformation. Here, we examine how methods to handle potential outlier observations affect <italic>de novo</italic> estimation of groups using both clustering and matrix factorization methods.</p>
<p>While log transformations may affect parametric tests <italic><xref ref-type="bibr" rid="c8">O&#x2019;Hara and Kotze 2010</xref></italic> our primary interest is in clustering, where relative abundances among samples could affect the derived clusters <italic><xref ref-type="bibr" rid="c12">Weiss et al. 2017</xref></italic>. We examine similarity between the adjusted OTU tables and the original ones to determine if relationships are preserved after post-processing.</p>
<p>We consider four methods: Bray-Curtis Similarity, <italic>de novo</italic> determined clusters by K-means and PCA, determining groups using Non-Negative Matrix Factorization (NMF). Our goal is to adjust for potential over or under representation while keeping realtive sample abudnaces as similar as possible, a problem that finds analogy in Single Cell sequencing <italic><xref ref-type="bibr" rid="c10">Vallejos et al. 2017</xref></italic>. We find that Rarefaction and then Transformation have higher mantel statistics, as a matrix correlation <italic><xref ref-type="bibr" rid="c6">Legendre and Legendre 1998</xref></italic>, in relation to an unmodified OTU table than a Normalized OTU table, and this same observation applies also to K-means. Only for NMF does Log Transformation results appear similar to an unedited table.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<p>We estimate a Bray-Curtis distance matrix from each of four OTU tables <italic><xref ref-type="fig" rid="fig1">Fig. 1</xref></italic> and compare these matrices with a mantel statistic <italic><xref ref-type="fig" rid="fig2">Fig. 2</xref></italic> to see if Normalization, Rarefaction, or Log Transformation disrupts groups. Data was chosen that had three distinct sampling locations and three distinct OTU profiles <italic><xref ref-type="bibr" rid="c1">Crits-Christoph et al. 2013</xref></italic>. We used k=3 for K-means and NMF, which is described below.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="259325_ufig1.tif"/>
</fig>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="259325_ufig2.tif"/>
</fig>
<sec id="s2a">
<title>K-means, PCA of Abundance</title>
<p>Using OTU tables we generate <italic>de novo</italic> clusters with K-means and then compare these clusters using a Jaccard-driven similarity <italic><xref ref-type="fig" rid="fig3">Fig. 3</xref></italic>. We test these clusters using a silhouette plot, which shows the distance of each sample to the closest other cluster. The clusters are plotted with a PCA on abundance, using the DC algorithm <italic><xref ref-type="fig" rid="fig4">Fig. 4</xref></italic>. Rand Similarities show the same relationships between OTU tables, and when a Wilcoxon signed-rank test is conducted between all tables, log transform is seen to have the highest statistic to the un-edited OTU table <italic><xref ref-type="bibr" rid="c7">Molik 2017</xref></italic>.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="259325_ufig3.tif"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="259325_ufig4.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Non-negative Matrix Factorization</title>
<p>Using the OTU tables we generate <italic>de novo</italic> clusters in NMF and compare these clusters with Jaccard Similarity <italic><xref ref-type="fig" rid="fig3">Fig. 3</xref></italic>. NMF groups had higher silhouette coefficients than their K-means counterparts <italic><xref ref-type="fig" rid="fig5">Fig. 5</xref></italic>. All groups had an above.8 silhouette coefficient.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="259325_ufig5.tif"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Distance matrices are used in hierarchical clustering. In <xref ref-type="fig" rid="fig2">Figure 2</xref> we can observe that &#x201C;normalized&#x201D; is a fairly distinct distance matrix, and has been shown to cause a substantial difference in OTU composition <italic><xref ref-type="bibr" rid="c12">12</xref></italic>. These differences appear using mantel statistic assessment, as well as in K-means analysis and in NMF clustering. Similarly, the expectation in Rarefaction is that relative abundances will change according to the amount of rarefaction; a presence absence OTU table will have different sample to sample relationships than a slightly scaled down OTU table. We look at the later and, as expected, our rarefied table is shown to be more similar based on a mantel test on distance matrices, as well as in PCA/K-means assessments.</p>
<p>The optimal method for handling outliers and erroneous abundances depends on data and application <italic><xref ref-type="bibr" rid="c12">12</xref></italic>. In clustering and dissimilarity both rarification and log transformation seems to produce results that approximate the original OTU table; however, formatrix factorization only log transformation maintains original OTU table structure.</p>
</sec>
</body>
<back>
<sec id="s4">
<title>Data and Code Availability</title>
<p>Source sequence data came from National Center for Biotechnology Information Sequence Read Archive SRA accession number SRA091062 <italic><xref ref-type="bibr" rid="c1">Crits-Christoph et al. 2013</xref></italic>. Analysis was conducted in R and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/status-five/The-Effects-of-Normalization-Transformation-and-Rarefication-on-Clustering-on-OTU-Abundance">https://github.com/status-five/The-Effects-of-Normalization-Transformation-and-Rarefication-on-Clustering-on-OTU-Abundance</ext-link>, the DOI:10.5281/zenodo.896927 version was used <italic><xref ref-type="bibr" rid="c7">Molik 2017</xref></italic>. We used the R vegan package <italic><xref ref-type="bibr" rid="c2">Dixon 2003</xref></italic> for log transformation, normalization, and rarefaction of the OTU table. The NMF pacage was used for applying NMF <italic><xref ref-type="bibr" rid="c3">Gaujoux and Seoighe 2010</xref></italic>. The Corrplot R pacakge was used for matrices visualization <italic><xref ref-type="bibr" rid="c11">V. Simko 2016</xref></italic>. The fpc R package was used for PCA analysis and visualization <italic><xref ref-type="bibr" rid="c5">Hennig 2015</xref></italic>. The clusteval package was used for determining Jaccard similarities between clusters <italic><xref ref-type="bibr" rid="c9">Ramey 2012</xref></italic>.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Crits-Christoph</surname> <given-names>A</given-names></string-name>, <string-name><surname>Robinson</surname> <given-names>CK</given-names></string-name>, <string-name><surname>Barnum</surname> <given-names>T</given-names></string-name>, <string-name><surname>Fricke</surname> <given-names>W</given-names></string-name>, <string-name><surname>Davila</surname> <given-names>AF</given-names></string-name>, <string-name><surname>Jedynak</surname> <given-names>B</given-names></string-name>, <string-name><surname>McKay</surname> <given-names>CP</given-names></string-name>, <string-name><surname>DiRuggiero</surname> <given-names>J</given-names></string-name> (<year>2013</year>) <article-title>Colonization patterns of soil microbial communities in the Atacama Desert</article-title>. <source>Microbiome</source> <volume>1</volume> (<issue>1</issue>): <fpage>28</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/2049-2618-1-28">https://doi.org/10.1186/2049-2618-1-28</ext-link></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Dixon</surname> <given-names>P</given-names></string-name> (<year>2003</year>) <article-title>VEGAN, a package of R functions for community ecology</article-title>. <source>Journal of Vegetation Science</source> <volume>14</volume> (<issue>6</issue>): <fpage>927</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1658/1100-9233(2003)014[0927:vaporf]2.0.co;2">https://doi.org/10.1658/1100-9233(2003)014[0927:vaporf]2.0.co;2</ext-link></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Gaujoux</surname> <given-names>R</given-names></string-name>, <string-name><surname>Seoighe</surname> <given-names>C</given-names></string-name> (<year>2010</year>) <article-title>A flexible R package for nonnegative matrix factorization</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume> (<issue>1</issue>): <fpage>367</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-11-367">https://doi.org/10.1186/1471-2105-11-367</ext-link></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Gonzalez</surname> <given-names>J</given-names></string-name>, <string-name><surname>Portillo</surname> <given-names>M</given-names></string-name>, <string-name><surname>Belda-Ferre</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mira</surname> <given-names>A</given-names></string-name> (<year>2012</year>) <article-title>Amplification by PCR Artificially Reduces the Proportion of the Rare Biosphere in Microbial Communities</article-title>. <source>PLoS ONE</source> <volume>7</volume> (<issue>1</issue>): <fpage>e29973</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0029973">https://doi.org/10.1371/journal.pone.0029973</ext-link></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="other"><string-name><surname>Hennig</surname> <given-names>C</given-names></string-name> (<year>2015</year>) <article-title>fpc: Flexible Procedures for Clustering. 2.1-10</article-title>. URL: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fpc">https://CRAN.R-project.org/package=fpc</ext-link></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="book"><string-name><surname>Legendre</surname> <given-names>P</given-names></string-name>, <string-name><surname>Legendre</surname> <given-names>L</given-names></string-name> (<year>1998</year>) <source>Numerical ecology</source>. <publisher-name>Elsiver</publisher-name></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="other"><string-name><surname>Molik</surname> <given-names>D</given-names></string-name> (<year>2017</year>) <article-title>Status-Five/The-Effects-Of-Normalization-Transformation-And- Rarefication-On-Clustering-On-Otu-Abundance: Intial Release</article-title>. <source>Zenodo</source> <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/ZENODO.896926">https://doi.org/10.5281/ZENODO.896926</ext-link></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>O&#x2019;Hara</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kotze</surname> <given-names>DJ</given-names></string-name> (<year>2010</year>) <article-title>Do not log-transform count data</article-title>. <source>Methods in Ecology and Evolution</source> <volume>1</volume> (<issue>2</issue>): <fpage>118D122</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2041-210x.2010.00021.x">https://doi.org/10.1111/j.2041-210x.2010.00021.x</ext-link></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="other"><string-name><surname>Ramey</surname> <given-names>J</given-names></string-name> (<year>2012</year>) <article-title>clusteval: Evaluation of Clustering Algorithms. 0.1</article-title>. URL: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=clusteval">https://CRAN.R-project.org/package=clusteval</ext-link></mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Vallejos</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Risso</surname> <given-names>D</given-names></string-name>, <string-name><surname>Scialdone</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dudoit</surname> <given-names>S</given-names></string-name>, <string-name><surname>Marioni</surname> <given-names>JC</given-names></string-name> (<year>2017</year>) <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>. <source>Nature Methods</source> <volume>14</volume> (<issue>6</issue>): <fpage>565</fpage>&#x2013;<lpage>571</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.4292">https://doi.org/10.1038/nmeth.4292</ext-link></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><collab>V. Simko TW</collab> (<year>2016</year>) <article-title>R package &#x2018;corrplot&#x2019;: visualization of a correlation matrix</article-title>,. <source>Matrix R Packag</source> (<issue>77</issue>).</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Weiss</surname> <given-names>S</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>ZZ</given-names></string-name>, <string-name><surname>Peddada</surname> <given-names>S</given-names></string-name>, <string-name><surname>Amir</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bittinger</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gonzalez</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lozupone</surname> <given-names>C</given-names></string-name>, <string-name><surname>Zaneveld</surname> <given-names>J</given-names></string-name>, <string-name><surname>V&#x00E1;zquez-Baeza</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Birmingham</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hyde</surname> <given-names>E</given-names></string-name>, <string-name><surname>Knight</surname> <given-names>R</given-names></string-name> (<year>2017</year>) <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>. <source>Microbiome</source> <volume>5</volume> (<issue>1</issue>): <fpage>1</fpage>&#x2013;<lpage>18</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s40168-017-0237-y">https://doi.org/10.1186/s40168-017-0237-y</ext-link></mixed-citation></ref>
</ref-list>
</back>
</article>