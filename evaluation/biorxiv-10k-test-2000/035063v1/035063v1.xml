<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
<journal-title-group>
<journal-title>bioRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/035063</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="author-type">
<subject>Regular Article</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>New Results</subject>
</subj-group>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Bioinformatics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>State aggregation for fast likelihood computations in phylogenetics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Davydov</surname><given-names>Iakov I.</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Robinson-Rechavi</surname><given-names>Marc</given-names></name>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Salamin</surname><given-names>Nicolas</given-names></name>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><institution>Department of Ecology and Evolution, Biophore, University of Lausanne</institution>, 1015 Lausanne, <country>Switzerland</country></aff>
<aff id="a2"><institution>Swiss Institute of Bioinformatics, Genopode, Quartier Sorge</institution>, 1015 Lausanne, <country>Switzerland</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding author, <email>nicolas.salamin@unil.ch</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2015</year>
</pub-date>
<elocation-id>035063</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>12</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2015</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="035063.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract><title>Abstract</title>
<p>Codon models are widely used to identify the signature of selection at the molecular level and to test for changes in selective pressure during the evolution of genes encoding proteins. The large dimensionality of the Markov processes used to model codon evolution makes it difficult to use these models with large biological datasets. We propose here to use state aggregation to reduce the dimensionality of codon models and, thus, improve the computational performance of likelihood estimation on these models. We show that this heuristic speeds up the computations of the M0 and branch-site models up to 6.8 times. We also show through simulations that state aggregation does not introduce a detectable bias. We analysed a real dataset and show that aggregation provides highly correlated predictions compared to the full likelihood computations. Finally, state aggregation is a very general approach and can be applied to any continuoustime Markov process-based model with large dimensionality, such as amino acid and coevolution models. We therefore discuss different ways to apply state aggregation to Markov models used in phylogenetics.</p>
</abstract>
<counts>
<page-count count="14"/>
</counts>
</article-meta>
</front>
<body>
<sec id="s1"><title>I<sc>ntroduction</sc></title>
<p>Evolutionary models are necessary to study the processes governing the evolution of genes, genomes and organisms. While relatively simple models are often sufficient to provide a good estimation of species or gene trees, inferring the specific processes that govern the evolution of molecular data (e.g. selection or coevolution) requires more complex models. The ability to apply these complex models to large datasets involving many genes and/or species offers the promise to better understand evolution in a more general context. This approach has, however, an important computational cost because of the large numbers of parameters and/or the high dimensionality of the state space involved in these complex models.</p>
<p>The computational performance of phylogenetic methods has always been an important issue in molecular evolution. Likelihood-based methods in phylogenetics would not be possible without the use of Felsenstein&#x2019;s tree pruning algorithm (<xref ref-type="bibr" rid="c6">Felsenstein, 1981</xref>) coupled with the growth of computer performance. However, these methods only became commonly used with the heuristics implemented in software such as PhyML and RaXML (<xref ref-type="bibr" rid="c11">Guindon <italic>et al</italic>., 2010</xref>; <xref ref-type="bibr" rid="c29">Stamatakis, 2014</xref>). Recent years have thus seen tremendous decreases in computing times, to the extent that data sets with thousands of sequences can now be analysed. However, most progress has been made on simple models of DNA or amino-acid evolution. More complex models, such as codon models used to detect selection, are still computationally too costly to be applied on large genomic datasets (e.g. all Ensemble Compara; <xref ref-type="bibr" rid="c35">Vilella <italic>et al</italic>., 2009</xref>).</p>
<p>The complexity of codon models comes from the large state-space that is necessary to represent the 61 codons (excluding the three stop codons). The simplest codon model, which is called M0 (<xref ref-type="bibr" rid="c8">Goldman and Yang, 1994</xref>), assumes a single parameter <italic>&#x03C9;</italic> to model a constant selective pressure occurring on all sites and branches of a phylogenetic tree. The M0 model is probably not realistic enough and more complex models that involve multiple transition matrices have been developed to detect episodic positive selection on a subset of sites and of phylogenetic branches (<xref ref-type="bibr" rid="c38">Zhang <italic>et al</italic>., 2005</xref>; <xref ref-type="bibr" rid="c28">Smith <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c19">Murrell <italic>et al</italic>., 2012</xref>). The most commonly used complex model is probably the branch-site model (<xref ref-type="bibr" rid="c38">Zhang <italic>et al</italic>., 2005</xref>), which assumes three classes of selection (parameters <italic>&#x03C9;</italic><sub>0</sub>, <italic>&#x03C9;</italic><sub>1</sub><italic>, &#x03C9;</italic><sub>2</sub> with <italic>&#x03C9;</italic><sub>2</sub> allowing positive selection) on sites along specific branches of the tree (called foreground branches) and two classes (parameters <italic>&#x03C9;</italic><sub>0</sub> and <italic>&#x03C9;</italic><sub>0</sub>) on the other branches.</p>
<p>Since an accurate phylogenetic tree is critical to evolutionary and comparative studies, most developments to speedup the estimation of evolutionary models have focused first on the optimization of tree topology and branch length search strategies. Examples include the choice of the starting tree topology (<xref ref-type="bibr" rid="c10">Guindon and Gascuel, 2003</xref>; <xref ref-type="bibr" rid="c13">Huelsenbeck <italic>et al</italic>., 2001</xref>; <xref ref-type="bibr" rid="c29">Stamatakis, 2014</xref>; <xref ref-type="bibr" rid="c31">Stamatakis <italic>et al</italic>., 2004</xref>), improved tree rearrangements strategies (<xref ref-type="bibr" rid="c10">Guindon and Gascuel, 2003</xref>; <xref ref-type="bibr" rid="c12">Hordijk and Gascuel, 2005</xref>; <xref ref-type="bibr" rid="c30">Stamatakis <italic>et al</italic>., 2005</xref>; <xref ref-type="bibr" rid="c33">Swofford and Olsen, 1990</xref>), computation economy (<xref ref-type="bibr" rid="c7">Gladstein, 1997</xref>; <xref ref-type="bibr" rid="c9">Goloboff, 1993</xref>; <xref ref-type="bibr" rid="c26">Ronquist, 1998</xref>), and independent branch-length estimation (<xref ref-type="bibr" rid="c10">Guindon and Gascuel, 2003</xref>).</p>
<p>However, an important part of the computational cost is spent calculating the likelihood function itself. Although this part is not the most limiting step for tree searching methods using simple models, it becomes a major bottleneck for the evaluation of more complex evolutionary scenarios such as codon models. In this case the reuse of the eigenvectors and eigenvalues for a set of branches can improve computational performance (<xref ref-type="bibr" rid="c27">Schabauer <italic>et al</italic>., 2012</xref>; <xref ref-type="bibr" rid="c34">Valle <italic>et al</italic>., 2014</xref>). Other optimization techniques that involve, for example, transforming the problem of exponentiating an asymmetric matrix into a symmetric problem, or performing matrix-matrix multiplication rather than matrix-vectors for the estimation of conditional vectors, have also been shown to speedup the calculations of the likelihood (<xref ref-type="bibr" rid="c27">Schabauer <italic>et al</italic>., 2012</xref>). There has also been some progress on Bayesian computation, e.g. using data augmentation (<xref ref-type="bibr" rid="c15">Lartillot, 2006</xref>; <xref ref-type="bibr" rid="c25">Rodrigue <italic>et al</italic>., 2008</xref>; <xref ref-type="bibr" rid="c3">de Koning <italic>et al</italic>., 2012</xref>). Despite these improvements, likelihood calculations still remain computationally intensive.</p>
<p>The size of the state-space of the continuoustime Markov chain directly impacts the most computationally intensive steps of this likelihood computation, since it affects the size of the rate and probability matrices (<italic>Q</italic> and <italic>P</italic>, see below), as well as of the conditional probability vector. A method allowing a reduction of the number of states while affecting minimally the precision of the likelihood estimation is therefore a potentially interesting avenue to further reduce the computational burden of these methods.</p>
<p>We propose here a heuristic method to speedup matrix exponentiation and partial likelihood calculations by reducing the number of states in a continuous-time Markov chain without losing the dimensionality of the model. We use state aggregation techniques to selectively combine states of the instantaneous rate matrix. We illustrate this technique with a simple and a complex codon model, since their state-space is relatively large (61 states). We show using simulations and the analysis of an empirical dataset that aggregation can provide significant speedup for codon models, with a very low cost in terms of accuracy. We further discuss the potential biological applications that could benefit from this approach to illustrate the wide applicability of state aggregation.</p>
<sec id="s1a"><title>Key steps of likelihood computation in phylogenetics</title>
<p>The performance of the likelihood calculations are governed by two computationally intensive steps: matrix exponentiation and matrix-vector multiplication.</p>
<p>Matrix exponentiation is at the heart of models based on continuous-time Markov chains. The rate of change from one state to any other in an infinitesimally small time interval is given by the instantaneous rate matrix <italic>Q</italic>. The probability of changing between the states of the process in a time interval <italic>t</italic> is then given by the probability matrix <italic>P</italic>: <italic>P</italic>(<italic>t</italic>) <italic>&#x003D; e<sup>Qt</sup></italic>. For computational purposes, the rate matrix is first diagonalized such that <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline1.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline2.gif"/></alternatives></inline-formula> is the matrix of eigenvectors and &#x039B; is a matrix whose diagonal elements correspond to the eigenvalues of the instantaneous matrix <italic>Q</italic>. This matrix decomposition allows the probability matrix <italic>P</italic> to be quickly computed for any time interval <italic>t</italic> as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline3.gif"/></alternatives></inline-formula>.</p>
<p>Branches of a phylogenetic tree represent the evolutionary path between an ancestral sequence and its descendants. We therefore need to compute the matrix <italic>P</italic> for every branch of a tree. The instantaneous rate matrix <italic>Q</italic> needs thus to be exponentiated for every branch length. The probabilities of observing the states in the ancestral sequence are then calculated by multiplying the conditional probability vectors for each descendant branch. These probability vectors are obtained by multiplying the <italic>P</italic> matrix for branch <italic>i</italic> with the conditional vector of the corresponding descendant. This procedure, known as Felsenstein&#x2019;s tree pruning algorithm, is repeated for every node of the phylogenetic tree until we reach the root of the tree (<xref ref-type="bibr" rid="c5">Felsenstein, 1973</xref>).</p></sec></sec>
<sec id="s2"><title>N<sc>ew</sc> A<sc>pproaches</sc></title>
<sec id="s2a"><title>State Aggregation</title>
<p>The computational cost of the two steps described above highly depends on the state-space of the continuous-time Markov chain used. Any reduction in the state-space can therefore increase the efficiency of the likelihood calculations. We investigate here the use of state aggregation to combine states of a Markov chain into several groups and therefore reduce the complexity of matrix exponentiation and matrix-vector multiplication.</p>
<p>Let us consider a Markov chain taking values in a finite set <italic>S</italic> &#x003D; &#x007B;<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>,&#x2026;, <italic>A<sub>n</sub></italic>&#x007D; with transition matrix <italic>P</italic> and stationary frequencies <italic>&#x03C0;</italic><sub>1</sub>, <italic>&#x03C0;</italic><sub>2</sub>,&#x2026;, <italic>&#x03C0;<sub>n</sub></italic>. Let <italic>S<sup>c</sup></italic> &#x003D; &#x007B;<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>,&#x2026;, <italic>A<sub>m</sub></italic>&#x007D; be a set of states to be aggregated, where <italic>m</italic> &#x003C; <italic>n</italic>.</p>
<p>The aggregated chain will have a space of <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline4.gif"/></alternatives></inline-formula> where <italic>A<sup>C</sup></italic> is the aggregated state. The new aggregated state <italic>A<sup>C</sup></italic> changes the entries of the probability matrix <italic>P</italic> in the following way:</p>
<p>
<disp-formula><alternatives><graphic xlink:href="035063_ueqn1.gif"/></alternatives></disp-formula>
where <italic>A<sub>i,</sub> A<sub>j</sub> &#x2209;S<sup>C</sup></italic>.</p>
<p>The stationary frequencies are estimated as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline5.gif"/></alternatives></inline-formula>, for <italic>A<sub>i</sub> &#x2209;S<sup>C</sup></italic>. These stationary frequencies are consistent with frequencies of the original Markov chain. The frequencies of the aggregated state is estimated as <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline6.gif"/></alternatives></inline-formula>.</p>
<p>The same method can be applied at the level of the instantaneous rate matrix <italic>Q</italic>. The diagonal elements of the matrix must however be set to <inline-formula><alternatives><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="035063_inline7.gif"/></alternatives></inline-formula>, to ensure that the sum of every row is equal to zero (Fig. S1 B, C) (<xref ref-type="bibr" rid="c1">Aldous and Fill, 2002</xref>, chapter 2).</p></sec>
<sec id="s2b"><title>Aggregation for Codon Models</title>
<p>An obvious question in performing aggregation is the definition of &#x201C;similar states&#x201D; to aggregate. We define all non observed states for a position of the alignment to be &#x201C;similar&#x201D; in the context of that position. The rationale is that the codons that are not observed at this site in any of the sequences at the tips of the tree have low probability to occur as ancestral states. The lack of some possible codons could be due to chance, but in many cases we expect a subset of codons to occur at a site because of natural selection or mutational bias. For example, a protein site which is constrained to be negatively charged will only use codons encoding such amino acids. It is thus justified to call all other codons &#x201C;similar&#x201D; relative to this site. We therefore aggregated all states unobserved at a position (i.e. triplet of columns of the DNA alignment) into a single state (<xref ref-type="fig" rid="fig1">Fig. 1</xref>). We performed here only aggregation on the probability matrix <italic>P</italic>. We discuss the advantages of aggregation on the <italic>P</italic> or <italic>Q</italic> matrices in the Discussion section.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure"><label>Figure 1:</label>
<caption><p>Example of state aggregation for one position (highlighted in purple) in a codon alignment.</p></caption>
<graphic xlink:href="035063_fig1.tif"/>
</fig>
<p>The intensity of state aggregation can be modified and we tested two different approaches by implementing them for the codon model M0 (<xref ref-type="bibr" rid="c8">Goldman and Yang, 1994</xref>). The first and least aggressive approach aggregates only the positions that were absolutely conserved in any sites of the alignment. The state-space for these sites is thus reduced to two states: the observed (conserved) codon, and the &#x201C;meta-state&#x201D; of the 60 other non stop codons. In the second approach, all positions were aggregated and the &#x201C;meta-state&#x201D; included all codons not present in the position subjected to aggregation. These two approaches represent extreme cases of the application of aggregation.</p>
<p>Given the small speedup of the first approach on M0 (see Results), only the second approach was employed for the more complex branch-site model.</p></sec></sec>
<sec id="s3"><title>R<sc>esults</sc></title>
<sec id="s3a"><title>M0 Model</title>
<p>For the simple M0 model, we compare the performance of likelihood maximization in three different modes: full likelihood (no aggregation), aggregation for conserved positions, and full aggregation.</p>
<p>The likelihood values obtained for all datasets using both aggregation modes are highly correlated with values estimated by the full likelihood (Fig. S2, S3, S4, S5, S6, S7). The error in estimation of the likelihood is small and is not dependent on the simulation parameters (<xref ref-type="fig" rid="fig2">Fig. 2</xref>, S8, S9), with the exception of tree length (<xref ref-type="fig" rid="fig3">Fig. 3</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure"><label>Figure 2:</label>
<caption><p>Estimated &#x03C9; (A) and &#x03BA; (B) values depending on the alignment length (<monospace>alen</monospace> dataset, M0 model). Lines correspond to the simulation parameter values.</p></caption>
<graphic xlink:href="035063_fig2.tif"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure"><label>Figure 3:</label>
<caption><p>Estimated &#x03C9; (A) and &#x03BA; (B) values depending on the tree length (<monospace>tlen</monospace> dataset, M0 model). Lines correspond to the simulation parameter values. Tree length limited to the range [0.01; 300], see text).</p></caption>
<graphic xlink:href="035063_fig3.tif"/>
</fig>
<p>The mean computational speedup is approximately 1.7 for aggregation on all positions (<xref ref-type="fig" rid="fig4">Fig. 4</xref>), but only 1.02 (Fig. S10) for aggregation limited to fixed positions. We thus only analyzed in details the behavior of the full aggregation mode.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure"><label>Figure 4:</label>
<caption><p>Speedup of aggregation on all alignment positions with M0 model. A) <monospace>wvar</monospace> dataset with variable &#x03C9; value, B) <monospace>kvar</monospace> dataset with variable &#x03BA;.</p></caption>
<graphic xlink:href="035063_fig4.tif"/>
</fig>
<p>First, we see a strong effect of the alignment length on the speedups obtained (<xref ref-type="fig" rid="fig5">Fig. 5</xref>). Matrix eigendecomposition is performed only once per likelihood evaluation and the decrease in the state-space between the full likelihood and the aggregation does not have any impact on the eigendecomposition performance. However, a longer alignment will increase the number of times the tree pruning step is performed (i.e. once per site), which becomes more important in the overall computational cost. For instance, the speedup obtained with an alignment of 500 codons is 1.8 with full aggregation. The maximum speedup of 6.8 fold was achieved on extremely long alignments (above 10,000 codons) and short trees (total length &#x003C; 0.05).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure"><label>Figure 5:</label>
<caption><p>Speedup depending on a number of the codons (<monospace>alen</monospace> dataset, M0 model).</p></caption>
<graphic xlink:href="035063_fig5.tif"/>
</fig>
<p>While there is a larger error on the estimation of model parameters (<italic>&#x03BA;</italic> and <italic>&#x03C9;</italic>) with shorter alignments, this effect is identical with or without aggregation (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). The heuristic that we propose does therefore not increase error on a simple model even with short alignments. Interplay between eigendecomposition and pruning times explains the direct effect of the relationship between the number of sequences and the speedup (<xref ref-type="fig" rid="fig6">Fig. 6</xref>). A large number of sequences decreases the proportion of time spent in the eigendecomposition phase and subsequently increases the speedup.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure"><label>Figure 6:</label>
<caption><p>Speedup versus number of sequences (<monospace>nseq</monospace> dataset, M0 model).</p></caption>
<graphic xlink:href="035063_fig6.tif"/>
</fig>
<p>Changes in the other parameters impact the speedup of the aggregation mode insofar as they change the number of codon states per alignment site. The latter has then a direct effect on the number of non aggregated states. Indeed, we aggregate into one state all codons which are not observed in a given position. Thus any processes that reduces the number of different codons per position also increases the efficiency of aggregation. Hence, the speedup is slightly higher for smaller <italic>&#x03C9;</italic> values because, as <italic>&#x03C9;</italic> approaches 0, more and more codons at a particular site are only part of a synonymous codon set. The number of possible codons is thus greatly reduced and there is a higher chance that the aggregation will lead to very few states. In contrast, increasing <italic>&#x03C9;</italic> values will lead to an increasing number of states observed. Similarly, extremely short branches limit state variety at each site, which in turn increase the level of aggregation possible and thus increase speedup (<xref ref-type="fig" rid="fig7">Fig. 7</xref>). Biased codon frequencies can also reduce diversity of states and thus increase aggregation speedup. In our simulations, codon frequencies were drawn from a Dirichlet distribution and we varied the concentration parameter <italic>&#x03B1;</italic> to estimate the effect of codon frequencies on codon aggregation. We see a better speedup associated with smaller values of the <italic>&#x03B1;</italic> parameter, which leads to a higher variance between codon frequencies (Fig. S11).</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure"><label>Figure 7:</label>
<caption><p>Speedup versus tree length (<monospace>tlen</monospace> dataset, M0 model).</p></caption>
<graphic xlink:href="035063_fig7.tif"/>
</fig>
<p>Total tree length is the only parameter in our simulations that also affects the accuracy of the estimation of model parameters (<xref ref-type="fig" rid="fig3">Fig. 3</xref>, S12). Longer trees tend to improve the accuracy of the estimation of the parameters <italic>&#x03C9;</italic> and <italic>&#x03BA;</italic>. However, extremely long trees lead to an increase in error both in aggregated and in full likelihood mode, probably because of saturation. It appears that under reasonable conditions of applicability of the M0 model (i.e. total tree length &#x003C; 20 substitutions per codon), aggregation does not lead to any detectable bias, while for extremely long trees aggregation can introduce a slight bias.</p>
<p>Thus, overall speedup on the simple M0 model can be explained by average observed codons count and by alignment length (<xref ref-type="fig" rid="fig8">Fig. 8</xref>). The relationship between speedup and <italic>&#x03C9;, &#x03BA;</italic>, tree length and codon frequencies is effectively explained by a reduced size of the state space of the continuous-time Markov chain. Aggregation is thus all the more effective when sequence data are biased or when analyses contain closely related species, which is probably the case for many real multiple sequence alignments.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure"><label>Figure 8:</label>
<caption><p>Speedup versus average codon count for M0 model. Each point represents one simulated alignment, dataset indicated by color. For the dataset with changing alignment length (<monospace>alen</monospace>), variation in speedup does not depend on the observed codon count (which does not vary significantly), but longer alignments lead to higher speedup, see <xref ref-type="fig" rid="fig5">Fig. 5</xref>.</p></caption>
<graphic xlink:href="035063_fig8.tif"/>
</fig></sec>
<sec id="s3b"><title>Branch-Site Model</title>
<p>Given the small speedup that we obtained for the aggregation on fixed positions, we implemented only the full aggregation mode for the branch-site model in FastCodeML. We then compared this new implementation with the standard FastCodeML. We see a slight increase in both false positives and true positives with aggregation (<xref ref-type="table" rid="tbl1">Tables 1</xref>, <xref ref-type="table" rid="tbl2">2</xref>). Overall, ROC curves show that the performance of FastCodeML in aggregation mode is similar to the full likelihood mode (<xref ref-type="fig" rid="fig9">Fig. 9</xref>). Thus any errors in estimation under aggregation seem to have very little impact on the Likelihood ratio test (LRT) used to test for the presence of positive selection with the branch-site model.</p>
<table-wrap id="tbl1" orientation="portrait" position="float"><label>Table 1:</label>
<caption><p>Statistical performance of FastCodeML in normal and aggregated modes on simulated data.</p></caption>
<graphic xlink:href="035063_tbl1.tif"/>
</table-wrap>
<table-wrap id="tbl2" orientation="portrait" position="float"><label>Table 2:</label>
<caption><p>Statistical performance of FastCodeML on the simulated dataset. A) Without positive selection; B) With positive selection.</p></caption>
<graphic xlink:href="035063_tbl2.tif"/>
</table-wrap>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure"><label>Figure 9:</label>
<caption><p>ROC curves for FastCodeML in full likelihood and aggregated likelihood modes.</p></caption>
<graphic xlink:href="035063_fig9.tif"/>
</fig>
<p>For <italic>&#x03C9;</italic><sub>0</sub>, <italic>&#x03BA;</italic>, and <italic>p</italic><sub>1</sub>, Pearson&#x2019;s correlation coefficients between aggregated and full likelihood estimates are 0.9986, 0.9969 and 0.9735, respectively (<xref ref-type="fig" rid="fig10">Fig. 10</xref>). A lower correlation is observed for <italic>p</italic><sub>0</sub> and <italic>&#x03C9;</italic><sub>2</sub> (0.9578 and 0.9109, respectively). Yet, these correlations are much higher than those obtained between the full likelihood estimate and simulated values: 0.35 for <italic>p</italic><sub>0</sub> and 0.20 for <italic>&#x03C9;</italic><sub>2</sub>.</p>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure"><label>Figure 10:</label>
<caption><p>Correlation between aggregated and non aggregated parameter estimates for the branch-site model.</p></caption>
<graphic xlink:href="035063_fig10.tif"/>
</fig>
<p>As with the M0 model, speedup is mostly affected by sequence length and tree length (<xref ref-type="fig" rid="fig11">Fig. 11</xref>) through their effects on observed codon counts (Fig. S13). We reached a maximum speedup of 4.4 fold per likelihood computation for the branch-site model.</p>
<fig id="fig11" position="float" orientation="portrait" fig-type="figure"><label>Figure 11:</label>
<caption><p>Effect of A) alignment length and B) tree length on the speedup, branch-site model.</p></caption>
<graphic xlink:href="035063_fig11.tif"/>
</fig>
<p>Finally, we used FastCodeML in normal and aggregated modes on a real dataset from Primates (<xref ref-type="table" rid="tbl3">Table 3</xref>). After correction for multiple testing, 20 branches were identified to be under positive selection using full likelihood computations and 18 using aggregation, with 13 branches in common. Aggregation gives a median speedup of 2.7 on this real dataset, confirming that real data can be sufficiently biased to make aggregation quite efficient.</p>
<table-wrap id="tbl3" orientation="portrait" position="float"><label>Table 3:</label>
<caption><p>Statistical performance of FastCodeML on the Primates dataset. A) Detected selection in normal and aggregated modes of FastCodeML; B) After correction for multiple hypothesis testing, FDR (false discovery rate) cutoff&#x003D;0.05; C) FDR cutoff&#x003D;0.4.</p></caption>
<graphic xlink:href="035063_tbl3.tif"/>
</table-wrap></sec></sec>
<sec id="s4"><title>D<sc>iscussion</sc></title>
<p>We propose state aggregation as a technique for speeding up the computation of likelihood in a phylogenetic context. By reducing the size of the state space of the Markov process, aggregation accelerates the phase of tree pruning during the likelihood computation and, in some cases, the eigendecomposition of the transition rate matrix. We show that aggregation can be applied to the likelihood calculation of two of the most commonly used codon models. It can also be used for other types of models (see below), in both maximum likelihood and Bayesian frameworks.</p>
<p>The speedup for codon models depends on the alignment length and the observed codon counts, the latter being mostly affected by the tree length (<xref ref-type="fig" rid="fig8">Fig. 8</xref>, S13).</p>
<p>These effects are especially strong with the M0 model, because the likelihood optimizer uses a fixed number of iterations. The total runtime is therefore proportional to the likelihood computation time. We see similar effects with the branch-site model, but less pronounced because the optimizer is using a variable number of iterations. We see more explicitly the dependency if we normalize for the number of likelihood function computations (Fig. S14).</p>
<p>The most time consuming stages of the likelihood computation are matrix exponentiation and tree pruning. FastCodeML uses highly optimized algorithms to do matrix exponentiation (<xref ref-type="bibr" rid="c27">Schabauer <italic>et al</italic>., 2012</xref>) and state aggregation improves the time to perform the tree pruning steps of the likelihood calculations (Fig. S1 A, B).</p>
<p>While the dependency of the speedup on the alignment length and the codon counts make intuitive sense, we can understand it in more details by considering the steps of the likelihood computation. Let us consider the computation time of the total likelihood (Fig. S1 A):</p>
<p>
<disp-formula><alternatives><graphic xlink:href="035063_ueqn2.gif"/></alternatives></disp-formula>
where <italic>t<sub>eigen</sub></italic> is the time to decompose the instantaneous rate matrix, <italic>t<sub>exp</sub></italic> is the time to exponentiate the rate matrix for each internal node, <italic>t<sub>prun</sub></italic> is the time to compute the partial likelihood vector per internal node per position, <italic>K</italic> is the number of internal nodes and <italic>N</italic> is the number of positions in the alignment. The number of states is 61 for Markov chains modeling codon sequences.</p>
<p>Similarly for the state aggregation (Fig. S1 B):</p>
<p>
<disp-formula><alternatives><graphic xlink:href="035063_ueqn3.gif"/></alternatives></disp-formula>
where <italic>t<sub>agg</sub></italic> is the matrix aggregation time per internal node per position, and 61 is replaced by M, the number of states after aggregation.</p>
<p>Aggregation speedup is thus:</p>
<disp-formula><alternatives><graphic xlink:href="035063_ueqn4.gif"/></alternatives></disp-formula>
<p>Generally performance is limited by eigen-decomposition and pruning, so we can approximate speedup as:</p>
<disp-formula><alternatives><graphic xlink:href="035063_ueqn5.gif"/></alternatives></disp-formula>
<p>This representation gives a clear explanation for the dependency of the speedup on the alignment length and the observed codon counts. Increasing the alignment length causes a weaker effect on the non-accelerated eigendecomposition phase, which results in a more efficient acceleration. In contrast, a higher codon diversity in each alignment position increases the number of states in the aggregated Markov process (<italic>M</italic>), thus reducing the advantage of the aggregated process relative to the full one.</p>
<p>Not only does aggregation provide diminishing speedup with longer trees (more observed states, larger <italic>M</italic>), it also introduces a bias in the parameter estimation for extremely long trees. Consequently, for trees longer than 100 expected substitutions per position it is not practical to use state aggregation: biased results would be obtained without any significant speedup. In practice, however, extremely long trees are rare, for example in the Selectome database 99&#x0025; of the trees has total length below 18 expected substitutions per position.</p>
<p>State aggregation can be applied either to the probability matrix <italic>P</italic> or to the instantaneous matrix <italic>Q</italic> (Fig. S1 B, C). In the case of the matrix <italic>P</italic> (Fig. S1 B), aggregation is applied after exponentiation and must be performed for every position independently. The performance improvement is therefore achieved during the tree pruning phase. In the case of the matrix <italic>Q</italic> (Fig. S1 C), aggregation is applied prior to the exponentiation. This leads to smaller dimensions of <italic>P</italic> matrices, but eigendecomposition and exponentiation have to be performed for every position independently, since those positions will differ in the states aggregated. Moreover, aggregation of the matrix <italic>Q</italic> is expected to introduce more bias that will accumulate along the branches. Aggregation performed on the <italic>Q</italic> matrix will discard differences in substitution trajectories passing through unobserved states. There will thus be an accumulation of the error during both exponentiation and pruning phases. Aggregation done after the exponentiation phase only introduces error during the tree pruning phase. Preliminary results do not show an advantage of aggregating the matrix <italic>Q</italic> for codon models (not shown). A solution might be to perform a &#x201C;softer&#x201D; aggregation on clusters of sites with similar patterns of codons. This would be done by first clustering alignment positions and then producing aggregated instantaneous rate matrices for each cluster. This should diminish the bias and allow to exponentiate a smaller number of <italic>Q</italic> matrices than for the aggregation per site, while still computing on smaller <italic>Q</italic> matrices than in non aggregated mode. It is also possible that aggregation of the <italic>Q</italic> matrix could be more useful for other types of models, especially those with large instantaneous rate matrices, such as coevolution models (<xref ref-type="bibr" rid="c4">Dib <italic>et al</italic>., 2014</xref>). Finally, a second round of aggregation might be performed after the exponentiation in order to speedup the tree pruning stage (Fig. S1 D). The computational and statistical performance of such approaches has yet to be investigated.</p>
<p>It is also possible to implement aggregation on a subset of the data only. In our case, we chose an extreme situation and aggregated only the most conserved positions. The result was a large loss in speedup relative to aggregation on all positions without any gain in accuracy. But there might be other cases where aggregation on a subset of data only makes most sense in terms of the cost (accuracy) &#x2014; benefit (speedup) trade-off. Moreover, there are multiple ways to perform the aggregation itself. Here, we collapsed all of the states (codons) which are not observed at the position of the alignment. It is also possible to use a less aggressive approach and only aggregate codons reachable by more than a single mutation (or a single non-synonymous mutation). For example, models of amino acid substitutions have been derived from codon-based Markov models by aggregating codons separated by only synonymous substitutions. These models were, however, not built nor evaluated for computational efficiency (<xref ref-type="bibr" rid="c24">Ren <italic>et al</italic>., 2005</xref>; <xref ref-type="bibr" rid="c14">Kosiol and Goldman, 2011</xref>). Less aggressive aggregation probably will increase accuracy at the price of reduced speedup, although, in our tests, accuracy was already good with the aggressive aggregation.</p>
<p>The combined use of both aggregated and non-aggregated modes in the same analysis could be efficient in several scenarios. First, aggregation could be used during likelihood maximization, but the final likelihood value computed without aggregation, providing a more accurate value. Second, aggregation could be used to obtain a starting point for non-aggregated likelihood maximization. Third, aggregation could be used in a preprocessing step to detect datasets of interest (e.g., gene families with a signal of positive selection). These datasets could then be analyze with full likelihood to get an accurate estimation of the parameters and model comparison. Finally, aggregation could be used during the burn-in period in a Bayesian approach (e.g. MCMC). There are probably other scenarios where aggregation can provide a faster estimation of likelihood within a more complex analysis.</p>
<p>For the specific case of the branch-site model, we have tested the second scenario of using aggregation as a starting point and we do not obtain a significant speedup (Fig. S15).</p>
<p>Obviously, state aggregation in phylogeny and evolution is not limited to the branch-site and M0 codon models. First, it is universally applicable to Markov process-based codon models, such as aBSREL (<xref ref-type="bibr" rid="c28">Smith <italic>et al</italic>., 2015</xref>), RELAX (<xref ref-type="bibr" rid="c36">Wertheim <italic>et al</italic>., 2014</xref>), or any other GY94 (<xref ref-type="bibr" rid="c8">Goldman and Yang, 1994</xref>) or MG94-based (<xref ref-type="bibr" rid="c20">Muse and Gaut, 1994</xref>) model. Second, it is not limited to codon models. Given a trade-off between per-position matrix aggregation slowdown and tree pruning speedup, aggregation is unlikely to give a significant performance improvement for models with a small number of states (e.g., nucleotide models). But even for amino acids models we can expect some degree of speedup. In contrast, we expect state aggregation to provide a significant performance improvement for the models with a large number of states, such as amino acid coevolution models that can include up to 400 states (<xref ref-type="bibr" rid="c4">Dib <italic>et al</italic>., 2014</xref>; <xref ref-type="bibr" rid="c37">Yeang and Haussler, 2007</xref>).</p>
<p>The aggregation of states in a Markov process is a powerful technique used in a variety of fields including computational biology, such as protein network interaction analysis (<xref ref-type="bibr" rid="c21">Petrov <italic>et al</italic>., 2012</xref>), single molecule photobleaching (<xref ref-type="bibr" rid="c17">Messina <italic>et al</italic>., 2006</xref>), or disease-progression models (<xref ref-type="bibr" rid="c23">Regnier and Shechter, 2013</xref>). Its application to phylogenetic models has not been systematically studied, although it has been implemented in some software (<xref ref-type="bibr" rid="c16">Lartillot and Philippe, 2004</xref>, e.g. PhyloBayes;). This is, to our knowledge, the first systematic study of state aggregation biases and computational efficiency for molecular evolution.</p>
<p>In conclusion, we demonstrate that state aggregation is a powerful method which improves computational performance of codon-based models, with little cost in accuracy. State aggregation is not limited to codon models, and we expect it to be useful for a large variety of phylogenetic models and methods.</p></sec>
<sec id="s5"><title>M<sc>aterials and</sc> M<sc>ethods</sc></title>
<sec id="s5a"><title>Software</title>
<p>State aggregation for the M0 model was implemented in the godon package (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/Davydov/godon">https://bitbucket.org/Davydov/godon</ext-link>). State aggregation for the branch-site model was implemented in a version of FastCodeML (<ext-link ext-link-type="uri" xlink:href="https://gitlab.isb-sib.ch/phylo/fastcodeml">https://gitlab.isb-sib.ch/phylo/fastcodeml</ext-link>), which is a software that has been optimized for computational efficiency of the calculation of the matrix exponentiation and the matrix-vector multiplication (<xref ref-type="bibr" rid="c34">Valle <italic>et al</italic>., 2014</xref>).</p></sec>
<sec id="s5b"><title>Dataset</title>
<p>Five datasets were simulated for the M0 model (see <xref ref-type="table" rid="tbl4">Table 4</xref>). We varied one parameter at a time, based on the following settings: 300 codons, 18 sequences, <italic>&#x03C9;<sub>0</sub></italic> &#x003D; 0.3, <italic>&#x03BA; &#x003D;</italic> 2, equal codon frequencies (<italic>&#x03C0;<sub>i</sub></italic> &#x003D; 1/61), default tree length (4). We used the the ENSGT00680000099620 gene tree from the En-sembl database (<xref ref-type="bibr" rid="c2">Cunningham <italic>et al</italic>., 2015</xref>) for topology and relative branch lengths.</p>
<table-wrap id="tbl4" orientation="portrait" position="float"><label>Table 4:</label>
<caption><p>List of simulated datasets for M0 model.</p></caption>
<graphic xlink:href="035063_tbl4.tif"/>
</table-wrap>
<p>For the branch-site model, 2,000 alignments were simulated with stochastic birth-death trees and <italic>&#x03BA;</italic>, <italic>&#x03C9;</italic><sub>0</sub>, <italic>&#x03C9;</italic><sub>2</sub>, <italic>p</italic><sub>0</sub>, <italic>p</italic><sub>1</sub>, alignment length and number of tips sequences chosen randomly (<xref ref-type="table" rid="tbl5">Table 5</xref>, Fig. S16). One thousand of the alignments were simulated under the branch-site model null hypothesis with &#x03C9;<sub>2</sub> &#x003D; 1, while the other 1000 alignments represented the alternative hypothesis with <italic>&#x03C9;</italic><sub>2</sub> &#x003E; 1. In these simulations every parameter was estimated at random to have a more biologically realistic dataset.</p>
<table-wrap id="tbl5" orientation="portrait" position="float"><label>Table 5:</label>
<caption><p>Model parameter distribution for the branch-site model simulated dataset.</p></caption>
<graphic xlink:href="035063_tbl5.tif"/>
</table-wrap>
<p>The likelihood ratio test (LRT) was used for model selection, with a significance level of <italic>&#x03B1; &#x003D;</italic> 0.05.</p>
<p>All sequence simulations were performed using the evolver program from the PAML package.</p>
<p>Finally, a Primates dataset from the Selectome database (<xref ref-type="bibr" rid="c22">Proux <italic>et al</italic>., 2009</xref>; <xref ref-type="bibr" rid="c18">Moretti <italic>et al</italic>., 2014</xref>) release 6 was used to study the behaviour of the method on a real dataset. The dataset consists of 15669 gene trees and alignments (<ext-link ext-link-type="uri" xlink:href="http://selectome.unil.ch/cgi-bin/download.cgi">http://selectome.unil.ch/cgi-bin/download.cgi</ext-link>).</p></sec></sec>
</body>
<back>
<sec id="s6"><title>S<sc>upplementary</sc> M<sc>aterial</sc></title>
<p>Supplementary figures S1&#x2013;S16 are available at Molecular Biology and Evolution online (<ext-link ext-link-type="uri" xlink:href="http://www.mbe.oxfordjournals.org/">http://www.mbe.oxfordjournals.org/</ext-link>).</p>
</sec>
<ack><title>A<sc>cknowledgments</sc></title>
<p>This work was supported by the Swiss National Science Foundation (grant number CR32I3_143768). The computations were performed at the Vital-IT (<ext-link ext-link-type="uri" xlink:href="http://www.vital-it.ch">http://www.vital-it.ch</ext-link>) centre for high-performance computing of the Swiss Institute of Bioinformatics.</p>
</ack>
<ref-list><title>R<sc>eferences</sc></title>
<ref id="c1"><mixed-citation publication-type="website"><string-name><surname>Aldous</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Fill</surname>, <given-names>J. A.</given-names></string-name> <year>2002</year>. <article-title>Reversible markov chains and random walks on graphs</article-title>. Unfinished monograph, recompiled 2014, available at <ext-link ext-link-type="uri" xlink:href="http://www.stat.berkeley.edu/&#x007E;aldous/RWG/book.html">http://www.stat.berkeley.edu/&#x007E;aldous/RWG/book.html</ext-link>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Cunningham</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Amode</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Barrell</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Beal</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Billis</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Brent</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Carvalho-Silva</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Clapham</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Coates</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Fitzgerald</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal> <year>2015</year>. <article-title>Ensembl 2015</article-title>. <source>Nucleic acids research</source>, <volume>43</volume>(<issue>D1</issue>): <fpage>D662</fpage>&#x2013;<lpage>D669</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>de Koning</surname>, <given-names>A. J.</given-names></string-name>, <string-name><surname>Gu</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Castoe</surname>, <given-names>T. A.</given-names></string-name>, and <string-name><surname>Pollock</surname>, <given-names>D. D.</given-names></string-name> <year>2012</year>. <article-title>Phylogenetics, likelihood, evolution and complexity</article-title>. <source>Bioinformatics</source>, <volume>28</volume>(<issue>22</issue>): <fpage>2989</fpage>&#x2013;<lpage>2990</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Dib</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Silvestro</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Salamin</surname>, <given-names>N.</given-names></string-name> <year>2014</year>. <article-title>Evolutionary footprint of coevolving positions in genes</article-title>. <source>Bioinformatics</source>, <volume>30</volume>(<issue>9</issue>): <fpage>1241</fpage>&#x2013;<lpage>1249</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="other"><string-name><surname>Felsenstein</surname>, <given-names>J.</given-names></string-name> <year>1973</year>. <article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>. <source>Systematic zoology</source>, pages <fpage>240</fpage>&#x2013;<lpage>249</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Felsenstein</surname>, <given-names>J.</given-names></string-name> <year>1981</year>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of molecular evolution</source>, <volume>17</volume>(<issue>6</issue>): <fpage>368</fpage>&#x2013;<lpage>376</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Gladstein</surname>, <given-names>D. S.</given-names></string-name> <year>1997</year>. <article-title>Efficient incremental character optimization</article-title>. <source>Cladistics</source>, <volume>13</volume>(<issue>1</issue>): <fpage>21</fpage>&#x2013;<lpage>26</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Goldman</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Yang</surname>, <given-names>Z.</given-names></string-name> <year>1994</year>. <article-title>A codon-based model of nucleotide substitution for protein-coding DNA sequences</article-title>. <source>Molecular biology and evolution</source>, <volume>11</volume>(<issue>5</issue>): <fpage>725</fpage>&#x2013;<lpage>736</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Goloboff</surname>, <given-names>P. A.</given-names></string-name> <year>1993</year>. <article-title>Character optimization and calculation of tree lengths</article-title>. <source>Cladistics</source>, <volume>9</volume>(<issue>4</issue>): <fpage>433</fpage>&#x2013;<lpage>436</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Guindon</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Gascuel</surname>, <given-names>O.</given-names></string-name> <year>2003</year>. <article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title>. <source>Systematic biology</source>, <volume>52</volume>(<issue>5</issue>): <fpage>696</fpage>&#x2013;<lpage>704</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Guindon</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Dufayard</surname>, <given-names>J.-F.</given-names></string-name>, <string-name><surname>Lefort</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Anisimova</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hordijk</surname>, <given-names>W.</given-names></string-name>, and <string-name><surname>Gascuel</surname>, <given-names>O.</given-names></string-name> <year>2010</year>. <article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title>. <source>Systematic biology</source>, <volume>59</volume>(<issue>3</issue>): <fpage>307</fpage>&#x2013;<lpage>321</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Hordijk</surname>, <given-names>W.</given-names></string-name> and <string-name><surname>Gascuel</surname>, <given-names>O.</given-names></string-name> <year>2005</year>. <article-title>Improving the efficiency of SPR moves in phylogenetic tree search methods based on maximum likelihood</article-title>. <source>Bioinformatics</source>, <volume>21</volume>(<issue>24</issue>): <fpage>4338</fpage>&#x2013;<lpage>4347</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Huelsenbeck</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Ronquist</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal> <year>2001</year>. <article-title>MR-BAYES: Bayesian inference of phylogenetic trees</article-title>. <source>Bioinformatics</source>, <volume>17</volume>(<issue>8</issue>): <fpage>754</fpage>&#x2013;<lpage>755</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Kosiol</surname>, <given-names>C.</given-names></string-name> and <string-name><surname>Goldman</surname>, <given-names>N.</given-names></string-name> <year>2011</year>. <article-title>Markovian and non-markovian protein sequence evolution: aggregated markov process models</article-title>. <source>Journal of molecular biology</source>, <volume>411</volume>(<issue>4</issue>): <fpage>910</fpage>&#x2013;<lpage>923</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Lartillot</surname>, <given-names>N.</given-names></string-name> <year>2006</year>. <article-title>Conjugate gibbs sampling for bayesian phylogenetic models</article-title>. <source>Journal of computational biology</source>, <volume>13</volume>(<issue>10</issue>): <fpage>1701</fpage>&#x2013;<lpage>1722</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Lartillot</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Philippe</surname>, <given-names>H.</given-names></string-name> <year>2004</year>. <article-title>A bayesian mixture model for across-site heterogeneities in the amino-acid replacement process</article-title>. <source>Molecular biology and evolution</source>, <volume>21</volume>(<issue>6</issue>): <fpage>1095</fpage>&#x2013;<lpage>1109</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Messina</surname>, <given-names>T. C.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Giurleo</surname>, <given-names>J. T.</given-names></string-name>, and <string-name><surname>Talaga</surname>, <given-names>D. S.</given-names></string-name> <year>2006</year>. <article-title>Hidden markov model analysis of multichromophore photobleaching</article-title>. <source>The Journal of Physical Chemistry B</source>, <volume>110</volume>(<issue>33</issue>): <fpage>16366</fpage>&#x2013;<lpage>16376</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Moretti</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Laurenczy</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Gharib</surname>, <given-names>W. H.</given-names></string-name>, <string-name><surname>Castella</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Kuzniar</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Schabauer</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Studer</surname>, <given-names>R. A.</given-names></string-name>, <string-name><surname>Valle</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Salamin</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Stockinger</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal> <year>2014</year>. <article-title>Selectome update: quality control and computational improvements to a database of positive selection</article-title>. <source>Nucleic acids research</source>, <volume>42</volume>(<issue>D1</issue>): <fpage>D917</fpage>&#x2013;<lpage>D921</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Murrell</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Wertheim</surname>, <given-names>J. O.</given-names></string-name>, <string-name><surname>Moola</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Weighill</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Scheffler</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Pond</surname>, <given-names>S. K.</given-names></string-name> <year>2012</year>. <article-title>Detecting individual sites subject to episodic diversifying selection</article-title>. <source>PLoS Genet</source>, <volume>8</volume>(<issue>7</issue>): <fpage>e1002764</fpage>&#x2013;<lpage>e1002764</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Muse</surname>, <given-names>S. V.</given-names></string-name> and <string-name><surname>Gaut</surname>, <given-names>B. S.</given-names></string-name> <year>1994</year>. <article-title>A likelihood approach for comparing synonymous and nonsynonymous nucleotide substitution rates, with application to the chloroplast genome</article-title>. <source>Molecular Biology and Evolution</source>, <volume>11</volume>(<issue>5</issue>): <fpage>715</fpage>&#x2013;<lpage>724</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Petrov</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Ganguly</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Koeppl</surname>, <given-names>H.</given-names></string-name> <year>2012</year>. <article-title>Model decomposition and stochastic fragments</article-title>. <source>Electronic Notes in Theoretical Computer Science</source>, <volume>284</volume>: <fpage>105</fpage>&#x2013;<lpage>124</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Proux</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Studer</surname>, <given-names>R. A.</given-names></string-name>, <string-name><surname>Moretti</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Robinson-Rechavi</surname>, <given-names>M.</given-names></string-name> <year>2009</year>. <article-title>Selectome: a database of positive selection</article-title>. <source>Nucleic acids research</source>, <volume>37</volume>(<issue>suppl 1</issue>): <fpage>D404</fpage>&#x2013;<lpage>D407</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Regnier</surname>, <given-names>E. D.</given-names></string-name> and <string-name><surname>Shechter</surname>, <given-names>S. M.</given-names></string-name> <year>2013</year>. <article-title>State-space size considerations for disease-progression models</article-title>. <source>Statistics in medicine</source>, <volume>32</volume>(<issue>22</issue>): <fpage>3862</fpage>&#x2013;<lpage>3880</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Ren</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Tanaka</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Yang</surname>, <given-names>Z.</given-names></string-name> <year>2005</year>. <article-title>An empirical examination of the utility of codon-substitution models in phylogeny reconstruction</article-title>. <source>Systematic Biology</source>, <volume>54</volume>(<issue>5</issue>): <fpage>808</fpage>&#x2013;<lpage>818</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Rodrigue</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Philippe</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Lartillot</surname>, <given-names>N.</given-names></string-name> <year>2008</year>. <article-title>Uniformization for sampling realizations of markov processes: applications to bayesian implementations of codon substitution models</article-title>. <source>Bioinformatics</source>, <volume>24</volume>(<issue>1</issue>): <fpage>56</fpage>&#x2013;<lpage>62</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Ronquist</surname>, <given-names>F.</given-names></string-name> <year>1998</year>. <article-title>Fast Fitch-parsimony algorithms for large data sets</article-title>. <source>Cladistics</source>, <volume>14</volume>(<issue>4</issue>): <fpage>387</fpage>&#x2013;<lpage>400</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="confproc"><string-name><surname>Schabauer</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Valle</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pacher</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Stockinger</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Stamatakis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>Z.</given-names></string-name>, and <string-name><surname>Salamin</surname>, <given-names>N.</given-names></string-name> <year>2012</year>. <article-title>SlimCodeML: an optimized version of CodeML for the branch-site model</article-title>. In <conf-name>2012 IEEE 26th International Parallel and Distributed Processing Symposium Workshops &#x0026; PhD Forum</conf-name>, pages <fpage>706</fpage>&#x2013;<lpage>714</lpage>. IEEE.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>Wertheim</surname>, <given-names>J. O.</given-names></string-name>, <string-name><surname>Weaver</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Murrell</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Scheffler</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Pond</surname>, <given-names>S. L. K.</given-names></string-name> <year>2015</year>. <article-title>Less is more: An adaptive branch-site random effects model for efficient detection of episodic diversifying selection</article-title>. <source>Molecular biology and evolution</source>, <volume>32</volume>(<issue>5</issue>): <fpage>1342</fpage>&#x2013;<lpage>1353</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Stamatakis</surname>, <given-names>A.</given-names></string-name> <year>2014</year>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>(<issue>9</issue>): <fpage>1312</fpage>&#x2013;<lpage>1313</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Stamatakis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ludwig</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Meier</surname>, <given-names>H.</given-names></string-name> <year>2005</year>. <article-title>RAxML-III: a fast program for maximum likelihood-based inference of large phylogenetic trees</article-title>. <source>Bioinformatics</source>, <volume>21</volume>(<issue>4</issue>): <fpage>456</fpage>&#x2013;<lpage>463</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="confproc"><string-name><surname>Stamatakis</surname>, <given-names>A. P.</given-names></string-name>, <string-name><surname>Meier</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Ludwig</surname>, <given-names>T.</given-names></string-name> <year>2004</year>. <article-title>New fast and accurate heuristics for inference of large phylogenetic trees</article-title>. In <conf-name>Parallel and Distributed Processing Symposium, 2004. Proceedings. 18th International</conf-name>, page <fpage>193</fpage>. IEEE.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="book"><string-name><surname>Swofford</surname>, <given-names>D. L.</given-names></string-name> and <string-name><surname>Olsen</surname>, <given-names>G. J.</given-names></string-name> <year>1990</year>. <chapter-title>Phylogeny reconstruction</chapter-title>. In <string-name><given-names>D.</given-names> <surname>Hillis</surname></string-name> and <string-name><given-names>C.</given-names> <surname>Moritz</surname></string-name>, editors, <source>Molecular Systematics</source>, pages <fpage>411</fpage>&#x2013;<lpage>501</lpage>. <publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderlands, Massachusetts</publisher-loc>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="other"><string-name><surname>Valle</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Schabauer</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Pacher</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Stockinger</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Stamatakis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Salamin</surname>, <given-names>N.</given-names></string-name> <year>2014</year>. <article-title>Optimization strategies for fast detection of positive selection on phylogenetic trees</article-title>. <source>Bioinformatics</source>, page <fpage>btt760</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Vilella</surname>, <given-names>A. J.</given-names></string-name>, <string-name><surname>Severin</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ureta-Vidal</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Heng</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Durbin</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Birney</surname>, <given-names>E.</given-names></string-name> <year>2009</year>. <article-title>EnsemblCompara GeneTrees: Complete, duplication-aware phylogenetic trees in vertebrates</article-title>. <source>Genome research</source>, <volume>19</volume>(<issue>2</issue>): <fpage>327</fpage>&#x2013;<lpage>335</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="other"><string-name><surname>Wertheim</surname>, <given-names>J. O.</given-names></string-name>, <string-name><surname>Murrell</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>Pond</surname>, <given-names>S. L. K.</given-names></string-name>, and <string-name><surname>Scheffler</surname>, <given-names>K.</given-names></string-name> <year>2014</year>. <article-title>Relax: detecting relaxed selection in a phylogenetic framework</article-title>. <source>Molecular biology and evolution</source>, page <fpage>msu400</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Yeang</surname>, <given-names>C.-H.</given-names></string-name> and <string-name><surname>Haussler</surname>, <given-names>D.</given-names></string-name> <year>2007</year>. <article-title>Detecting coevolution in and among protein domains</article-title>. <source>PLoS Comput Biol</source>, <volume>3</volume>(<issue>11</issue>): <fpage>e211</fpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Nielsen</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Yang</surname>, <given-names>Z.</given-names></string-name> <year>2005</year>. <article-title>Evaluation of an improved branch-site likelihood method for detecting positive selection at the molecular level</article-title>. <source>Molecular biology and evolution</source>, <volume>22</volume>(<issue>12</issue>): <fpage>2472</fpage>&#x2013;<lpage>2479</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>
