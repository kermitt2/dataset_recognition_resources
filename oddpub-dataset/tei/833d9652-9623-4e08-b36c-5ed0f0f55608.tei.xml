<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Spike sorting of synchronous spikes from local neuron ensembles</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">X</forename><surname>Felix Franke</surname></persName>
							<email>felix.franke@bsse.ethz.ch</email>
							<idno type="ORCID">0000-0001-5550-1222</idno>
							<affiliation key="aff0">
								<orgName type="department">School for Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Technische Universität Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">Bernstein Center for Computational Neuroscience</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Robert</forename><surname>Pröpper</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School for Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Technische Universität Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">Bernstein Center for Computational Neuroscience</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Henrik</forename><surname>Alle</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">Charité Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Philipp</forename><surname>Meier</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School for Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Technische Universität Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">Bernstein Center for Computational Neuroscience</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Jörg</forename><forename type="middle">R P</forename><surname>Geiger</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">Charité Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Klaus</forename><surname>Obermayer</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School for Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Technische Universität Berlin</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">Bernstein Center for Computational Neuroscience</orgName>
								<address>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Matthias</forename><forename type="middle">H J</forename><surname>Munk</surname></persName>
							<affiliation key="aff3">
								<orgName type="department">Fachbereich Biologie</orgName>
								<orgName type="institution">Technische Universität Darmstadt</orgName>
								<address>
									<settlement>Darmstadt</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Max Planck Institute for Biological Cybernetics</orgName>
								<address>
									<settlement>Tübingen</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><roleName>ETH</roleName><forename type="first">F</forename><surname>Franke</surname></persName>
						</author>
						<author>
							<affiliation key="aff5">
								<orgName type="department">Dept. of Biosystems Science and Engineering (BSSE)</orgName>
								<address>
									<addrLine>Mattenstrasse 26</addrLine>
									<postCode>4058</postCode>
									<settlement>Zürich, Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Spike sorting of synchronous spikes from local neuron ensembles</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">7199BEC49D1F5CD2638F64E1F9BA3BE4</idno>
					<idno type="DOI">10.1152/jn.00993.2014.25350022-3077/15</idno>
					<note type="submission">Submitted 10 December 2014; accepted in final form 14 August 2015</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2-SNAPSHOT" ident="GROBID" when="2022-05-18T11:34+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract/>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p><s>-Synchronous spike discharge of cortical neurons is thought to be a fingerprint of neuronal cooperativity.</s><s>Because neighboring neurons are more densely connected to one another than neurons that are located further apart, near-synchronous spike discharge can be expected to be prevalent and it might provide an important basis for cortical computations.</s><s>Using microelectrodes to record local groups of neurons does not allow for the reliable separation of synchronous spikes from different cells, because available spike sorting algorithms cannot correctly resolve the temporally overlapping waveforms.</s><s>We show that high spike sorting performance of in vivo recordings, including overlapping spikes, can be achieved with a recently developed filter-based template matching procedure.</s><s>Using tetrodes with a three-dimensional structure, we demonstrate with simulated data and ground truth in vitro data, obtained by dual intracellular recording of two neurons located next to a tetrode, that the spike sorting of synchronous spikes can be as successful as the spike sorting of nonoverlapping spikes and that the spatial information provided by multielectrodes greatly reduces the error rates.</s><s>We apply the method to tetrode recordings from the prefrontal cortex of behaving primates, and we show that overlapping spikes can be identified and assigned to individual neurons to study synchronous activity in local groups of neurons.</s><s>spike sorting; overlapping spikes; synchronous spikes; template matching; simultaneous intracellular and extracellular recordings THERE IS GROWING EVIDENCE for the relevance of spike timing in postsynaptic integration.</s><s>Spikes arriving near-synchronously at a postsynaptic neuron have been found to have a much stronger influence on firing activity than spikes with larger time delays <ref type="bibr">(Sjöström et al. 2008)</ref>.</s><s>Excitatory postsynaptic potentials (EP-SPs) that arrive at a dendritic branch with precisely timed short delays can be integrated supralinearly, further emphasizing the role played by near-synchronous input <ref type="bibr" target="#b2">(Branco et al. 2010)</ref>.</s><s>In particular, in local cortical networks <ref type="bibr" target="#b22">(Perin et al. 2011)</ref>, in which transmission delays for action potentials are very short and neurons are likely to receive highly correlated input (Tsodyks 1999), near-synchronous activity is expected to be both frequent and of high functional importance <ref type="bibr">(Sakurai et al. 2013)</ref>.</s></p><p><s>In behaving animals, extracellular electrodes are commonly used to record electrical activity from multiple nearby neurons simultaneously.</s><s>However, a fundamental problem of using this technique is that spikes from multiple neurons are recorded as a mixture and single neuron activity needs to be reconstructed from the recording, which involves a difficult and error-prone process called spike sorting <ref type="bibr" target="#b6">(Einevoll et al. 2012;</ref><ref type="bibr" target="#b17">Lewicki 1998)</ref>.</s></p><p><s>Most spike sorting algorithms are based on the assumption that all spikes from a given neuron will cause distinct voltage deflections (waveforms) in the recordings.</s><s>Therefore, the standard approach is to detect individual spikes, cut a short segment of data around each of them, and compare all the segments to identify groups of spikes that are similar to each other but different from the spikes in the other groups.</s><s>The grouping is usually achieved via clustering procedures after first reducing the number of dimensions of each segment with a set of features, e.g., principal components <ref type="bibr" target="#b17">(Lewicki 1998)</ref> or wavelet coefficients <ref type="bibr" target="#b15">(Letelier and Weber 2000;</ref><ref type="bibr">Quiroga et al. 2004</ref>).</s><s>To reflect the uncertainty of the assignment, the resulting groups are called units, instead of neurons.</s></p><p><s>Two factors make the clustering-based spike sorting approach particularly challenging.</s><s>First, the signal-to-noise ratio (SNR) depends on the neuron's distance from the electrode, and for most neurons this ratio is very low <ref type="bibr" target="#b3">(Buzsáki 2004;</ref><ref type="bibr" target="#b22">Pedreira et al. 2012)</ref>.</s><s>Second, spike waveforms of neurons that are active at the same time will overlap in the recordings and yield a joint waveform for the overlap (see pink points in Fig. <ref type="figure" target="#fig_2">1B</ref>), which can differ significantly from the individual spike waveforms.</s><s>This leads to misclassification (see Fig. <ref type="figure" target="#fig_2">1B</ref>), classification as noise, detection of only a subset of the overlapping spikes, or no detection at all.</s><s>Thus spike sorting error rates are significantly higher for overlapping spikes than they are for nonoverlapping spikes <ref type="bibr">(Quiroga et al. 2004</ref>).</s></p><p><s>The quality of the reconstruction, i.e., the spike sorting performance, can be increased by using electrodes with multiple contacts <ref type="bibr" target="#b12">(Gray et al. 1995</ref><ref type="bibr">), e.g., stereotrodes (Mc-Naughton et al. 1983</ref>) and tetrodes with four contacts <ref type="bibr">(Eckhorn and Thomas 1993;</ref><ref type="bibr" target="#b20">O'Keefe and Recce 1993)</ref>.</s><s>Electrodes with multiple contacts (referred to below as multielectrodes) record a compound signal from each electrically active cell in their vicinity.</s><s>In the remainder of this report we refer to the individual electrode contacts of a multielectrode simply as "electrodes."</s><s>Because of the different distances between each cell and the individual electrodes, each cell has a characteristic amplitude profile across the electrodes.</s><s>Therefore, the action potential of each cell is represented by a multielectrode spike waveform.</s><s>In contrast to spike waveforms, which are recorded from conventional single-ended microelectrodes, multielectrode waveforms from different neurons not only differ in their voltage time course but also provide spatial information for a more reliable assignment to individual units <ref type="bibr" target="#b12">(Gray et al. 1995)</ref>.</s></p><p><s>However, studies have not yet investigated the extent to which the additional information provided by recording the same spike on multiple electrodes can be used to separate overlapping spikes.</s><s>In principle, if the neurons that are simultaneously active are recorded by distinct sets of electrodes, the problem could be solved by spike sorting the electrode sets independently.</s><s>Unfortunately, this approach cannot be trivially exploited, because the set of electrodes on which a neuron is recorded is not known prior to spike sorting.</s><s>More importantly, many neurons will be recorded on the same electrodes, so that overlapping spikes cannot be trivially resolved by detecting each neuron on a distinct electrode.</s></p><p><s>Thus overlapping waveforms are a fundamental problem for any kind of spike sorting.</s><s>The failure of most spike sorting algorithms to reliably separate superimposed waveforms, i.e., synchronous or near-synchronous spikes, generates a bias in the resulting spike trains <ref type="bibr" target="#b1">(Bar-Gad et al. 2001;</ref><ref type="bibr" target="#b21">Pazienti and Grün 2006;</ref><ref type="bibr" target="#b22">Pillow et al. 2013)</ref>.</s><s>Therefore, the study of local cooperativity from extracellular recordings has been elusive.</s></p><p><s>The problem of temporally overlapping spikes was identified early on <ref type="bibr" target="#b17">(Lewicki 1998)</ref>, and considerable effort has been made to find solutions.</s><s>Most of the approaches rely on brute force template matching of all the combinations of participating neurons and temporal shifts <ref type="bibr" target="#b0">(Atiya 1992;</ref><ref type="bibr" target="#b16">Lewicki 1994;</ref><ref type="bibr">Prentice et al. 2011;</ref><ref type="bibr">Segev et al. 2004;</ref><ref type="bibr">Vargas-Irwin and Donoghue 2007;</ref><ref type="bibr">Zhang et al. 2004)</ref>, independent component analysis (ICA) to demix multielectrode recordings <ref type="bibr" target="#b14">(Jäckel et al. 2012;</ref><ref type="bibr">Takahashi et al. 2003)</ref>, filter-based methods <ref type="bibr" target="#b10">(Franke et al. 2010</ref><ref type="bibr" target="#b10">(Franke et al. , 2015;;</ref><ref type="bibr">Roberts and Hartline 1975;</ref><ref type="bibr">Stein et al. 1979;</ref><ref type="bibr">Vollgraf et al. 2005</ref>) that could resolve overlapping spikes by deconvolution, and methods based on probabilistic frameworks that integrate the possibility of spike overlap <ref type="bibr" target="#b7">(Ekanadham et al. 2014;</ref><ref type="bibr" target="#b10">Franke et al. 2015;</ref><ref type="bibr" target="#b22">Pillow et al. 2013)</ref>  proaches are successful in estimating spike synchrony in tetrode recordings, and their ability to solve the overlap problem could not be evaluated on experimental data because of the absence of reliable ground truth information in real recordings.</s></p><p><s>In this study, we analyzed the ability of clustering-based spike sorting <ref type="bibr" target="#b17">(Lewicki 1998</ref>) and a modified version of a previously developed filter-based template matching <ref type="bibr" target="#b10">(Franke et al. 2015)</ref> to resolve overlapping spikes.</s><s>Toward this end, we conducted dual patch-clamp recordings of two nearby neurons simultaneously with an extracellular tetrode in slices of rat cortex.</s><s>We induced overlapping spikes by evoking near-synchronous action potentials in the two neurons with different temporal delays by simultaneous intracellular current injection.</s><s>Using the intracellular recordings as ground truth, we were able to evaluate the spike sorting performance of the extracellular data.</s><s>We then used extensive surrogate data mimicking in vivo recordings in macaque prefrontal cortex to estimate the performance of our spike sorting approach in a realistic setting (see Table <ref type="table" target="#tab_1">1</ref> for an overview of the data sets used in this study).</s><s>The data were created by combining real noise recordings and extracellular spike waveforms to produce overlaps with a varying number of participating neurons.</s><s>Additionally, we investigated the degree to which the multielectrodes increased the spike sorting performance over single-electrode recordings, especially for the overlapping spikes.</s></p><p><s>Using the filter-based template matching procedure, we show that overlapping spikes can be reliably separated with a performance similar to nonoverlapping spikes if the templates are known.</s><s>This separation performance was greatly improved by the additional spatial information provided by multielectrode recordings, thereby confirming the results of previous studies <ref type="bibr" target="#b12">(Gray et al. 1995;</ref><ref type="bibr" target="#b13">Harris et al. 2000)</ref> for nonoverlapping spikes.</s><s>The finding that classical clustering-based methods perform poorly for overlapping spikes <ref type="bibr" target="#b17">(Lewicki 1998;</ref><ref type="bibr">Quiroga et al. 2004</ref>) is also confirmed.</s><s>Finally, we show that the method can be used to successfully analyze the synchronous and near-synchronous correlation of spike trains from neurons recorded with the same electrode in tetrode recordings from macaque prefrontal cortex.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>METHODS</head><p><s>All experiments were performed in accordance with German law for the protection of experimental animals, were approved by the local authorities, and are in full compliance with the guidelines of the European Community (EUVD 86/609/EEC) for the care and use of laboratory animals.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Simultaneous Intra-and Extracellular Recordings of Two Neurons</head><p><s>Slice preparation.</s><s>Three-to four-week-old Wistar rats were anesthetized with isoflurane and decapitated according to institutional guidelines.</s><s>Transverse 300-m-thick horizontal slices containing neocortex and hippocampus were cut with a custom-built vibratome.</s><s>For dissection and storage of slices, a solution containing (in mM) 80 NaCl, 25 NaHCO 3 , 1.25 NaH 2 PO 4 , 2.5 KCl, 25 glucose, 85 sucrose, 0.5 CaCl 2 , and 3 MgCl 2 , equilibrated with 95% O 2 -5% CO 2 , was used.</s><s>Slices were incubated at 34°C for ϳ30 min and subsequently stored at room temperature.</s></p><p><s>Recording solutions.</s><s>Slices were superfused with a physiological extracellular solution (ACSF) containing (in mM) 125 NaCl, 25 NaHCO 3 , 1.25 NaH 2 PO 4 , 2.5 KCl, 25 glucose, 2 CaCl 2 , and 1 MgCl 2 , equilibrated with 95% O 2 -5% CO 2 .</s><s>For somatic whole cell recordings, pipettes were filled with a solution containing (in mM) 130 KMSO 4 , 20 KCl, 2 MgCl 2 , 10 HEPES, 0.2 EGTA, 2 Na 2 -ATP, 5 Na 2 -phosphocreatine, and 0.5 Na 2 -GTP.</s><s>The pH of the intracellular solutions was set to 7.3.</s></p><p><s>Electrophysiology.</s><s>Extracellular recordings were performed with custom-made quartz fiber tetrodes (Thomas Recording, Giessen, Germany) and equipment (preamplifier, amplifier) kindly provided by Thomas Recording.</s><s>The tetrode shaft had a diameter of 96 m with a pointed, conelike, end.</s><s>Three of the four wires inside the shaft had a diameter of 14 m and were arranged in a triangular fashion.</s><s>The fourth, central, wire had a diameter of 26 m and was in the center of the electrode shaft.</s><s>Individual electrodes sat on the four corners of a tetrahedron one corner of which coincided with the very tip (the apex of the cone forming the electrode tip) of the electrode and was formed by the central wire.</s><s>The apex angle (the angle with which the cone widens while going along the electrode) was roughly 32°.</s><s>The distance between the three electrodes on the sides of the electrode and the central electrode was minimally 40 m.</s><s>Electrode impedance (measured at 1 kHz) was between 0.2 and 0.6 M⍀.</s><s>The patch pipettes for intracellular recordings were pulled from borosilicate glass tubing with an outer diameter of 2 mm and an inner diameter of 1 mm, resulting in open tip resistances of 3-5 M⍀.</s><s>Experiments were done at 33-34°C.</s><s>For whole cell current-clamp recordings, a Multiclamp 700A (Molecular Devices) was used; the internal filter was set to 16 kHz and the sampling frequency to 33.33 kHz; bridge-balance series resistance compensation was employed.</s><s>Data acquisition was performed with Clampex 8.2 (Molecular Devices).</s></p><p><s>Deep-layer pyramidal neurons in somatosensory cortex were identified according to their large somata, action potential pattern, and action potentials with half-durations of between 0.8 and 2.5 ms (usually ϳ1 ms; 11 recordings with 2 simultaneously patched neurons); granule cells of the hippocampus were identified according to their location within the hippocampal dentate gyrus, their small somata, and action potentials with half-durations of between 0.4 and 0.6 ms (2 recordings with 2 simultaneously patched neurons).</s><s>The two neurons to be patched within each session were chosen according to their close location to the respective metal electrode endings of the previously placed tetrode, either one at the tip electrode and the other at a lateral electrode or both at two different lateral electrodes.</s><s>Action potentials in the patch-clamped neurons were evoked from Ϫ70 to Ϫ80 mV membrane potential by current injections long enough to result in one or two action potentials.</s><s>The relative timing of the action potentials in the cells was set and varied manually at an external stimulator unit.</s><s>Overview of the 3 data sets used in this study.</s><s>Ground truth of the in vitro data set is described as "partial" since we observed in some data sets spontaneous activity of additional neurons that were not recorded from intracellularly.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Tetrode Recordings in Monkey Prefrontal Cortex</head><p><s>Tetrodes were placed in ventral prefrontal cortex for individual recording sessions, sampling recordings from the same region (smaller than 1 cm 2 ) across experiments.</s><s>Recordings were performed simultaneously from up to 16 adjacent sites with an array of individually movable fiber microtetrodes (Eckhorn and Thomas 1993).</s><s>Recording positions of individual tetrodes were manually chosen to maximize the recorded activity and the signal quality.</s><s>Data were sampled at 32 kHz and band-pass filtered between 0.5 and 10 kHz.</s></p><p><s>Neuronal activity was recorded while two macaque monkeys performed a visual short-term memory task.</s><s>The task required the monkeys to compare a test stimulus to one to four different sample stimuli presented after a 3-s-long delay and to decide by differential button press whether the test stimulus was among the sample stimuli.</s><s>Stimuli were randomly drawn from 20 different pictures of fruits and vegetables that were presented for 2 s (test stimulus) or for 0.9 s (total time for all sample stimuli).</s><s>Correct responses were rewarded with a drop of juice.</s><s>Match and nonmatch trials were randomly presented with equal probability.</s><s>A similar experimental setup was presented in <ref type="bibr">Wu et al. (2008)</ref>.</s><s>The monkeys performed ϳ2,000 trials per session, which is equivalent to almost 4 h of recording time.</s><s>The in vivo data were sorted and analyzed with Spyke Viewer software (Pröpper and Obermayer 2013).</s><s>A MATLAB implementation is available on request.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Clustering-Based Spike Sorting Procedure</head><p><s>We performed spike detection on the in vitro data, using a manually selected amplitude threshold on the intracellular recordings.</s><s>For the in vivo data we detected spikes in the continuous recordings, using the multiresolution Teager energy operator (MTEO) <ref type="bibr" target="#b4">(Choi et al. 2006</ref>) with a threshold calculated from the median energy, analogous to a method previously used for amplitude thresholding <ref type="bibr">(Quiroga et al. 2004)</ref>.</s><s>For both data sets, short segments of the extracellular recordings (referred to as waveforms) were cut around each detected spike and were aligned to their minimum amplitude.</s><s>Additionally, for the in vitro data a second data set was created by aligning the spikes using the available ground truth information from the intracellular recordings, thus avoiding alignment mistakes due to the altered waveform of overlapping spikes.</s></p><p><s>Waveforms of multiple electrodes were concatenated into a single vector s i per spike.</s><s>From periods of the data where no spikes were detected, the noise covariance matrix C was estimated <ref type="bibr">(Pouzat et al. 2002;</ref><ref type="bibr">Rutishauser et al. 2006)</ref>.</s><s>Spikes were prewhitened by multiplication with the inverse of the Cholesky factorization U of C: p i ϭ U Ϫ1 s i .</s><s>Then, with principal component analysis (PCA) the dimensionality of the spikes was reduced to 8. Finally, using projections onto the first 8 principal components, the spikes were clustered into groups, each group representing all spikes of a putative neuron.</s></p><p><s>For the in vitro data, the k-means algorithm was used with k set to 2, the true number of neurons.</s><s>This was done to observe the performance of an "informed" k-means without the need of model selection.</s><s>k-Means was applied once to the spikes that were correctly aligned using the peaks of the intracellular recordings ("k-means*" in Fig. <ref type="figure" target="#fig_3">2F</ref>) and once to the spikes that were aligned to the peak of the extracellular recordings ("k-means" in Fig. <ref type="figure" target="#fig_3">2F</ref>).</s><s>For the in vivo data, the expectation maximization (EM) algorithm was used to fit Gaussian mixture models of various orders, as the correct number of clusters is unknown.</s><s>The best model was selected with the Bayesian information criterion.</s><s>The mean waveform for each cluster was then used as the template.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Filter-Based Spike Sorting Procedure</head><p><s>Filter-based spike sorting <ref type="bibr" target="#b8">(Franke 2011;</ref><ref type="bibr" target="#b10">Franke et al. 2010;</ref><ref type="bibr" target="#b12">Gozani and Miller 1994;</ref><ref type="bibr">Roberts and Hartline 1975;</ref><ref type="bibr">Stein et al. 1979</ref>) relies on a set of linear filters.</s><s>The goals of the filters are to produce a peak in the filter output whenever a spike of a given neuron is present and to suppress noise.</s><s>In the optimal case, each filter responds only to the neuron for which it was designed and completely suppresses spikes from all other neurons.</s><s>The problem of spike sorting is then relegated to the filter-output space.</s><s>Filter-based spike sorting techniques differ in the exact choice of how the filters are designed, e.g., in the frequency domain <ref type="bibr">(Roberts and Hartline 1975)</ref> or in the time domain <ref type="bibr" target="#b11">(Friedman 1968;</ref><ref type="bibr">Vollgraf and Obermayer 2006)</ref>, and how the filter outputs are postprocessed, e.g., simple spike detection relying on the hope that each filter responds exclusively to one single neuron <ref type="bibr">(Roberts and Hartline 1975)</ref>, demixing the filter outputs <ref type="bibr" target="#b10">(Franke et al. 2010)</ref>, or clustering spikes in the filter output <ref type="bibr">(Vollgraf et al. 2005)</ref>.</s><s>This has in particular consequences with respect to how overlapping spikes are classified.</s><s>If it was indeed possible to construct a set of filters so that each filter responds exclusively to a single neuron, thresholding the filter outputs would completely solve the spike sorting problem, including overlapping spikes.</s><s>Unfortunately, this is impractical for realistic spike waveforms <ref type="bibr" target="#b8">(Franke 2011)</ref>.</s></p><p><s>A potential way out of this problem is by constructing filters also for overlapping spikes, i.e., one filter for each neuron and, additionally, to each possible superposition of multiple spikes.</s><s>Such a set of filters can be constructed in the following way.</s><s>Assume that the multielectrode template for neuron i is given by i .</s><s>Here, i is a vector in which the single-electrode templates are concatenated to form one long vector.</s><s>Then the filter output d i (t) for neuron i at time t is given by Bayes optimal template matching (BOTM) <ref type="bibr" target="#b10">(Franke et al. 2015)</ref>:</s></p><formula xml:id="formula_0">d i͑ t͒ ϭ X͑t͒ T C Ϫ1 i Ϫ 1 2 i T C Ϫ1 i ϩ ln͓p͑i͔͒ (1)</formula><p><s>where C is the multielectrode noise covariance matrix <ref type="bibr" target="#b8">(Franke 2011;</ref><ref type="bibr">Pouzat et al. 2002)</ref> and p(i) is the probability of observing a spike of neuron i in the short piece of vectorized multielectrode recording X(t) at time t.</s><s>Equation 1 can be split into the data-dependent part</s></p><formula xml:id="formula_1">y i͑ t͒ ϭ X͑t͒ T C Ϫ1 i ϭ X͑t͒ T f i (2)</formula><p><s>where f i is the filter for neuron i, and a data-independent constant</s></p><formula xml:id="formula_2">c i ϭ Ϫ 1 2 i T C Ϫ1 i ϩ ln͓p͑i͔͒<label>(3)</label></formula><p><s>In Fig. <ref type="figure" target="#fig_4">3A</ref> a short piece of simulated data is shown including a spike of the "blue" neuron (Fig. <ref type="figure" target="#fig_4">3</ref>, left) and an overlap between the "blue" and the "green" neurons (orange trace, Fig. <ref type="figure" target="#fig_4">3</ref>, center).</s><s>Figure <ref type="figure" target="#fig_4">3B</ref> shows the filter outputs of two single spike filters ("blue" and "green") plus a number of filter outputs constructed to detect overlapping spikes between the "blue" and the "green" neuron (gray lines in Fig. <ref type="figure" target="#fig_4">3B</ref>).</s><s>The number of filters that are needed for this approach is thus combinatorially growing with the number of neurons and the maximal considered temporal shift between the spikes within the overlap.</s><s>However, the filter outputs for overlapping spikes can be computed directly from the single spike filter outputs <ref type="bibr" target="#b10">(Franke et al. 2015)</ref>:</s></p><formula xml:id="formula_3">d iϩj,͑ t͒ ϭ d i͑ t͒ ϩ d j͑ t ϩ ͒ (4)</formula><p><s>where d iϩj, (t) is the filter output for an overlapping spike of neurons i and j with a temporal delay of between the spikes and d j (t ϩ ) is the temporally shifted filter output of neuron j.</s><s>This makes it unnecessary to actually compute a filter (and its convolution with the data) for each possible overlap.</s><s>While this approach is feasible for a small number of neurons, it quickly becomes too computationally demanding for a larger number of neurons <ref type="bibr" target="#b5">(Dragas et al. 2014)</ref>.</s><s>In <ref type="bibr" target="#b10">Franke et al. (2015)</ref> a greedy heuristic to solve the problem was proposed, which is based on exclusively computing single spike filter outputs, iteratively subtracting each detected spike from the other filter outputs, and repeating this process until no spikes can be detected anymore. Figure <ref type="figure" target="#fig_4">3</ref> ⌬ values in the data set across experiments.</s><s>A total of ϳ47,000 spikes were recorded, of which ϳ25,000 spikes had a ⌬ Յ 50 samples.</s><s>F: performance of filter-based template matching [Bayes optimal template matching (BOTM)] and k-means with k ϭ 2. For k-means*, spikes were aligned using the available ground truth.</s><s>For k-means, spikes were aligned on the maximum of the waveform.</s><s>For BOTM, an alignment step is not necessary.</s><s>The performance is averaged across all in vitro experiments.</s></p><p><s>illustrates this iterative process.</s><s>In Fig. <ref type="figure" target="#fig_4">3A</ref>, a short piece of simulated data including an overlap between the "blue" and the "green" neuron is shown.</s><s>Figure <ref type="figure" target="#fig_4">3C</ref> shows the data after the "blue" spike was detected and subtracted from the data.</s><s>However, because of its greedy nature, this approach is suboptimal (see Fig. <ref type="figure" target="#fig_7">5A</ref>, BOTM without hybrid).</s></p><p><s>Here we combine the optimal solution, to compute one filter output for each possible overlapping spike, and the greedy iterative subtraction scheme into a hybrid greedy variant.</s><s>We compute as many of the filter outputs needed to detect overlapping spikes as computationally feasible and then use the iterative scheme to resolve overlaps with a  Superimposed are the templates that are detected in the step of the method illustrated in B. B: for each template the method computes a corresponding template matching output.</s><s>Shown are the outputs for 2 single spike templates (blue and green) and the outputs to a number of templates constructed from superposition of the 2 templates (thin gray lines).</s><s>If any of the outputs surpasses a threshold (dotted line), a detection window is started (gray shaded area).</s><s>This window has a minimal length and stops only when all outputs are below the threshold again.</s><s>Within each window, the template with the maximal output is detected (thick vertical ticks).</s><s>For the waveform at center, a template representing an overlap between the 2 spikes had the maximal output (orange).</s><s>In the case on right only a single spike is detected, since the 2 spikes in the overlap are too far apart.</s><s>C: once a template is found, it is subtracted from the data.</s><s>Shown are the residuals after the first subtraction.</s><s>D: template matching outputs on the residual signals.</s><s>Only in the case on right does a threshold crossing occur.</s><s>E: templates used for this illustration.</s><s>F: residual after subtraction of the second detected spike of the case on right in D. G: template matching outputs for F. larger number of participating neurons.</s><s>In particular, we only compute the filter outputs for overlaps of maximally two single spikes and a maximal temporal shift between the spikes of 0.3 ms.</s></p><p><s>In brief, the hybrid greedy variant of the BOTM algorithm used in this study uses one optimally matched multielectrode filter f i ϭ C Ϫ1 i for each neuronal template.</s><s>The matched filters are convolved with the whole extracellular recording.</s><s>A template-dependent constant (c i in Eq. 3) is added to each filter output to compute the final template matching output d i (t).</s><s>Then, for all pairs of two spikes and all temporal shifts of Ϫ0.3 ms to 0.3 ms between the two spikes, all filter outputs for overlapping spikes are computed by Eq. 4 (Fig. <ref type="figure" target="#fig_4">3, B, D</ref>, and G, thin gray lines).</s><s>Spikes are detected at peaks in the template matching outputs (see Fig. <ref type="figure" target="#fig_4">3</ref> for an illustration).</s><s>Each filter output can also respond with peaks to spikes of other templates it was not designed for, if those are similar (e.g., in Fig. <ref type="figure" target="#fig_4">3B</ref> for each spike multiple template matching outputs cross the threshold).</s><s>Therefore, several filters can respond to the same spike.</s><s>If multiple spikes are detected at the same temporal location (shaded gray areas in Fig. <ref type="figure" target="#fig_4">3, B  and D</ref>) in different template matching outputs, only the spike detection for the filter with the largest output peak is kept.</s><s>At this step, overlapping spikes, apart from the pairwise overlaps for which filter outputs were computed according to Eq. 4, are thus ignored.</s></p><p><s>Once a spike (or a pairwise overlap) is found, the expected responses of all filters to this spike are subtracted from the respective template matching outputs (Fig. <ref type="figure" target="#fig_4">3D</ref>).</s><s>Thus spikes overlapping with the previously found spike (or pairwise overlap), and not detected thus far, can now be detected in the residual template matching outputs (this iterative process is illustrated in Fig. <ref type="figure" target="#fig_4">3</ref>, right).</s></p><p><s>Thus the resulting overlap templates are treated similarly to the original single spike templates: If the maximal template matching output corresponds to a template of an overlapping spike (Fig. <ref type="figure" target="#fig_4">3</ref>, center), multiple spikes are detected in a single step.</s><s>This procedure has the advantage of being noniterative and in principle more precise than the previously discussed iterative procedure but requires the construction of a large number of overlapping templates, i.e., for all combinations of single spike waveforms and their temporal shifts.</s><s>The iterative procedure was used for overlapping spikes with larger temporal delay (Fig. <ref type="figure" target="#fig_4">3</ref>, right) and a larger number of participating spikes.</s></p><p><s>A potential problem can arise for overlapping spikes that have a temporal delay just outside the maximal delay for which overlap filter outputs are computed.</s><s>In this case, the filter output representing the maximal temporal delay can be larger than the filter outputs for the individual spikes.</s><s>However, the temporal delay indicated by such a classification would be too small.</s><s>In principle, this would not be a big problem since the difference between detected delay and real delay will only be a couple of samples at most.</s><s>However, in the iterative subtraction process we subtract the resulting waveforms from the data to search for additional spikes at this location.</s><s>A small error in temporal position of the detected spikes can lead to a suboptimal subtraction of the waveform from the data, which can in itself look like a spike and introduce false positive detections or classification errors.</s><s>Therefore, if the maximal filter output is one of the border cases with maximal temporal delay (0.3 ms in our case), the resulting detection is ignored and the overlap is resolved with the iterative procedure only.</s></p><p><s>In our prefrontal cortex recordings we experienced electrode drift <ref type="bibr" target="#b10">(Franke et al. 2010</ref>) that caused the spike waveforms to change over time.</s><s>We therefore recomputed the templates and filter coefficients approximately every 7 s, using the last 300 spikes that were assigned to a unit.</s></p><p><s>An open-source Python implementation of the BOTM algorithm is publicly available (https://github.com/pmeier82/BOTMpy).</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Synthetic Data</head><p><s>To validate the method on overlapping spikes that resemble in vivo tetrode recordings in terms of template combination and noise, we simulated surrogate data.</s><s>Noise recordings and templates from spike sorting results of the in vivo data set were used to simulate overlapping spikes (see Fig. <ref type="figure">4</ref>).</s><s>For overlaps of two spikes, all possible shifts between the two templates in the range Ϫ48 to 48 samples (Ϫ1.5 to 1.5 ms) were simulated and a piece of the corresponding recording where no spikes were detected was added to the overlap as noise.</s><s>The simulation was repeated 1,000 times for a pair of templates and each shift.</s><s>For higher-order overlaps, the number of possible combinations becomes too large to cover exhaustively, so 100,000 combinations of templates and respective shifts were sampled for each recording and overlap order Ͼ 2. Additional subsample shifts were applied to each template by upsampling, shifting, and then downsampling the spike waveforms.</s><s>We sorted the created data with the same algorithm and parameters as the in vivo data.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Resolving the Overlap of Two Spikes: in Vitro Data</head><p><s>Two neurons in slices of rat neocortex or hippocampus were stimulated by current injection in simultaneous whole cell current-clamp recordings while the extracellular spikes of the two cells were recorded by a tetrode (see Fig. <ref type="figure" target="#fig_3">2A</ref>).</s><s>The stimulation strengths for the two neurons were manually set so that the time between the first spikes of both neurons, ⌬, was close to 0 ms (see Fig. <ref type="figure" target="#fig_3">2, B and E</ref>).</s><s>This way, we elicited 25,000 spikes in 13 pairs of neurons (3 animals) with a ⌬ of Ͻ1.5 ms (50 samples), which we refer to as overlapping spikes or simply overlaps (see Fig. <ref type="figure" target="#fig_1">1</ref>, top, and Fig. <ref type="figure" target="#fig_3">2</ref></s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>, B-D, for examples).</head><p><s>Can the individual neuronal contributions to the overlaps be correctly estimated from the extracellular recording alone, i.e., can we resolve the overlap with spike sorting?</s><s>To our knowledge, this is the first time that data from dual patch-clamp recordings together with a tetrode were used for the evaluation of spike sorting performance.</s><s>The intracellular recording provides the ground truth about the firing of the neurons (see Fig. <ref type="figure" target="#fig_3">2</ref>) and allowed for eliciting overlapping spikes, while the extracellular recording was used for spike sorting.</s></p><p><s>To understand whether a standard clustering-based spike sorting procedure is able to resolve overlapping spikes, we subjected the extracellular recordings to PCA and k-means clustering <ref type="bibr" target="#b17">(Lewicki 1998</ref>).</s><s>Since we did not want to introduce additional errors by spike detection and alignment, which are known to be especially error-prone for overlapping spikes <ref type="bibr" target="#b7">(Ekanadham et al. 2014;</ref><ref type="bibr">Quiroga et al. 2004</ref>), we used the available ground truth information to cut the correctly aligned spikes from the extracellular recordings.</s><s>In addition, we tried to find only two, i.e., the correct number of clusters.</s><s>PCA was used to reduce the dimensionality of the spikes to eight dimensions.</s><s>An example projection on the first two principal components of a random subset of spikes from one pair of neurons can be seen in Fig. <ref type="figure" target="#fig_2">1B</ref>, top.</s><s>The spikes from the two neurons form two clearly distinguishable clusters with overlapping spikes (magenta dots) scattered around the clusters.</s><s>We then clustered the spikes using k-means (see METHODS).</s><s>The results are shown in Fig. <ref type="figure" target="#fig_3">2F</ref>.</s><s>We ran the procedure once on the spikes that were aligned according to the peak of the respective intracellular recording (Fig. <ref type="figure" target="#fig_3">2F</ref>, k-means*) and once on spikes that were aligned on the maximum of the extracellular recording (Fig. <ref type="figure" target="#fig_3">2F</ref>, k-means).</s><s>As expected, the majority of nonoverlapping spikes and spikes that have large ⌬ are correctly assigned to their corresponding cluster (average performance 95% for the correctly aligned spikes), while the performance for overlapping spikes with ⌬ Ͻ 18 samples (0.5 ms) is at chance level (50%).</s><s>Thus, in addition to potential spike detection and alignment problems, overlapping spikes with small ⌬ cannot be assigned correctly with a principal component-based clustering procedure.</s></p><p><s>We then investigated whether the recently proposed BOTM <ref type="bibr" target="#b10">(Franke et al. 2015</ref>) (see METHODS) was able to resolve the overlapping spikes.</s><s>In brief, the method uses one optimal matched multielectrode filter for each neuronal template.</s><s>The matched filters are convolved with the whole extracellular recording, and spikes are detected at peaks in the filter outputs.</s><s>The filters are computed so that they respond optimally to spikes similar to the template from which they were estimated.</s><s>However, they can also respond with peaks to spikes of other templates if those are similar.</s><s>Therefore, several filters can respond to the same spike.</s><s>If multiple spikes are detected at the same temporal location in different filter outputs, only the spike whose filter output was maximal is kept.</s><s>Overlapping spikes are thus, in this step, ignored.</s><s>Once a spike is found, the expected response of all filters to this spike is subtracted from the respective filter responses.</s><s>Thus spikes overlapping with the previously found spike, and not detected thus far, can now be detected in the residual filter responses.</s><s>Fig. <ref type="figure" target="#fig_1">1</ref>, B and C, illustrate this process (for illustration purposes in a 2-dimensional PCA projection, but BOTM does not rely on PCA).</s><s>If one of the spikes participating in an overlap is subtracted from that overlap (pink circles with black arrows), the resulting residual spike (the 2 connected black crosses) will fall within one of the clusters.</s><s>If this procedure is applied to all overlapping spikes, well-separated clusters emerge (Fig. <ref type="figure" target="#fig_2">1C</ref>).</s></p><p><s>In contrast to k-means, which was run on precut and aligned spikes using the intracellular ground truth information, BOTM was evaluated on the extracellular recordings directly: spikes were not cut from the data, but BOTM had to detect the spikes in the filter responses.</s><s>The templates for the two neurons (from which the matched filters were computed) were estimated with the available ground truth information by averaging all extracellular spikes from each neuron.</s><s>The result is shown in Fig. <ref type="figure" target="#fig_3">2F</ref> (magenta line).</s><s>In contrast to the clustering case, the performance for BOTM does not depend on ⌬ and is uniformly close to 100%.</s><s>For comparison, we show the result also for the method presented in <ref type="bibr" target="#b10">Franke et al. (2010)</ref>, which is similar to the BOTM method in that it uses the known templates to construct matched filters.</s><s>It then tries to resolve the cross talk between the filter outputs in a second processing step that is conceptually close to ICA <ref type="bibr" target="#b14">(Jäckel et al. 2012;</ref><ref type="bibr">Takahashi et al. 2003)</ref>.</s><s>Its performance was slightly lower than the performance of the BOTM method but also independent of ⌬.</s><s>Thus, in in vitro recordings with two neurons, overlapping spikes can be sorted with the same accuracy as nonoverlapping spikes, if the correct templates are known.</s></p><p><s>Simultaneous intra-and extracellular recordings provide a powerful tool for evaluating spike sorting algorithms and their performance in resolving overlapping spikes.</s><s>However, signals from only two neurons constitute a very limited sample compared with the number of neurons that can be expected to occur in realistic in vivo recordings.</s><s>We therefore generated surrogate data mimicking in vivo recordings with more than two neurons.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Resolution of Overlapping Spikes in Simulated Data</head><p><s>Two aspects increase the difficulty in resolving overlapping spikes in in vivo recordings compared with our in vitro data: First, for each overlap of two spikes, there are more than two possible templates we can chose from in order to explain the overlap.</s><s>Second, more than two spikes could be present in the overlap (here referred to as higher-order overlap).</s><s>To assess the performance of overlap resolution under more challenging conditions, we simulated artificial data mimicking the characteristics of our in vivo recordings.</s><s>Figure <ref type="figure">4</ref> depicts the simulation process.</s><s>Spikes were detected in in vivo tetrode recordings from monkey prefrontal cortex with MTEO, an action potential detector <ref type="bibr" target="#b4">(Choi et al. 2006)</ref>, on each of the four electrodes individually.</s><s>Periods of signal in which no spike was detected on any electrode were marked as noise (white regions in Fig. <ref type="figure">4A</ref>).</s><s>To find the number of neurons and their spike templates, data were subjected to a spike sorting procedure (see METHODS) based on PCA and clustering (Fig. <ref type="figure">4B</ref>).</s></p><p><s>For each tetrode recording we created a data set of artificial spikes and overlaps.</s><s>The maximum number of spikes in an overlap was constrained by the available number of units found by spike sorting for that tetrode and an upper limit of five spikes per overlap.</s><s>To create a single artificial waveform, between one and five templates were chosen randomly.</s><s>The templates were superimposed (their waveforms on each electrode were added) with randomly chosen shifts, ⌬, between Ϫ1.5 ms and ϩ1.5 ms.</s><s>The resulting waveform of noise-free overlapping spikes was copied into a randomly chosen period of in vivo data where no spikes were detected.</s><s>The length of that period was chosen to fit the whole overlapping waveform and was between 1.7 and 4.7 ms long.</s><s>A new piece of noise was chosen at random for each simulated overlap.</s><s>This way, the original SNR of each template and the noise characteristics of the in vivo recordings remained unchanged (see examples in Fig. <ref type="figure">4C</ref>).</s><s>For each tetrode recording and number of templates in the overlap, this process was repeated between 100,000 and several million times (depending on the number of templates in the overlap).</s><s>We sorted the simulated periods of data by template matching using all available templates (4.92 Ϯ 2.58 templates per tetrode) of the respective tetrode.</s><s>Figure <ref type="figure" target="#fig_7">5A</ref> shows the error rate over all tetrodes and template combinations for overlaps of two spikes as a function of ⌬.</s><s>Since an overlap is counted as an error if at least one of the participating Fig. <ref type="figure">4</ref>. Simulation of overlapping spikes.</s><s>A: data were recorded with a tetrode in monkey prefrontal cortex and sorted with a standard spike sorting approach using the following steps: spike detection, spike alignment (not shown), prewhitening of spikes (not shown), PCA, expectation maximization clustering.</s><s>The cluster means are used as templates for the corresponding neuron.</s><s>B: simulation of overlaps consisted of 3 steps: 1) Cutting of a small piece of recorded data where no spikes were detected (ϭ noise).</s><s>2) Selection of 2 or more random templates from the sorting of corresponding data.</s><s>Random subsample shift for each template.</s></p><formula xml:id="formula_4">A B C Δ Δ Δ Δ Δ (1)<label>(2)</label></formula><p><s>(3) noise spikes extracted noise simulated overlaps</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>+</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Innovative Methodology</head><p><s>spikes is incorrectly sorted, the error rate for overlaps does not converge to the single spike error rate, even for large ⌬, but to the rate for correct classification of two single spikes.</s><s>The average error for the BOTM algorithm is below 2% and only slightly depends on ⌬.</s><s>The BOTM procedure has two mechanisms to resolve overlapping spikes (see METHODS): As outlined above, it can first detect a single spike, subtract its influence from the data, and detect another spike at the same location.</s><s>The alternative is to construct templates for overlapping spikes and search explicitly for the overlap waveform in the data, which has the potential to be more accurate than the subtractive procedure <ref type="bibr" target="#b10">(Franke et al. 2015)</ref>.</s><s>However, additional templates for each possible combination of neurons and temporal shifts have to be considered, which is computation- The error in % reflects the number of overlapping spikes in which at least 1 individual spike was sorted incorrectly.</s><s>The grey and black bars in B-D show the error rate defined as % of overlapping spikes where at least 1 individual spike was missed (false negative) or at least 1 additional spike, not present in the overlap, was found (false position).</s><s>A: average error rate on overlaps of 2 spikes depending on their temporal shift ⌬.</s><s>Note that the error decreases for small ⌬ values for the BOTM hybrid approach (see METHODS) but increases if the pure greedy heuristic is used (BOTM without hybrid).</s><s>The increased error rate around Ϫ0.1 ms and 0.1 ms results from 2 recordings in which the waveform of an overlap of 2 units with a certain shift is similar to the waveform of another template on the same tetrode.</s><s>Inset: error rate for k-means is dramatically increased for overlapping spikes.</s><s>The error rate goes to 100% for spikes with ⌬ ϭ 0 ms, since 1 of the participating spikes is always misclassified.</s><s>B: the error rate for overlaps of 2 spikes increases with the number of units in the recording.</s><s>C: error rate for overlaps with different numbers of participating spikes.</s><s>D: the error rate decreases if more recording electrodes are available.</s></p><p><s>For D and E, we removed recording electrodes from the data and kept templates only for units that remained detectable on the remaining electrodes.</s><s>E: with increasing number of electrodes fewer templates were removed from the simulation due to low detectability.</s><s>Thus, with increasing electrode number, more units had to be sorted.</s><s>Error bars indicate SD.</s></p><p><s>ally expensive.</s><s>Therefore, here we used a hybrid approach between the two alternatives: We constructed templates only for overlaps of maximally two spikes with small temporal shifts (Ϫ0.3 ms to ϩ0.3 ms) and, additionally, used the subtractive resolution procedure (see METHODS).</s><s>Figure <ref type="figure" target="#fig_7">5A</ref> shows that the hybrid outperforms the pure, subtractive procedure for small ⌬.</s><s>The performance of the pure subtractive procedure is close to the performance of the recently proposed binary pursuit method <ref type="bibr" target="#b22">(Pillow et al. 2013)</ref>.</s><s>We used the MATLAB implementation (https://github.com/</s><s>pillowlab/BinaryPursuitSpikeSorting) provided by the authors.</s><s>In brief, this method uses a probabilistic framework to explicitly model overlapping spike waveforms and then uses a greedy strategy to resolve overlapping spikes.</s><s>The method is conceptually close to the subtractive BOTM method; it also relies on an initial clustering-based spike sorting to estimate the templates, but it does not rely on linear filters.</s><s>Instead, spikes are detected by solving a greedy binary optimization problem for 1-s pieces of data.</s><s>In each step, the method computes where to insert a spike, or delete an already detected spike, so that the posterior probability of the estimated spike trains is maximized given the prewhitened recordings.</s><s>The method then proceeds to recompute the templates, the noise covariance matrix (which is needed to prewhiten the recordings; see METHODS), and other statistical quantities given the estimated spike trains.</s><s>The two steps are then iterated until convergence.</s></p><p><s>In contrast to the previously discussed methods, k-means performs very poorly for narrow overlaps (Fig. <ref type="figure" target="#fig_7">5A</ref>, inset), despite the fact that it was run on spikes that were detected and aligned with the available ground truth (see METHODS).</s></p><p><s>Next, we analyzed how the number of units found by the initial spike sorting influenced the performance of overlap resolution.</s><s>Potentially, the larger the number of available templates, the harder it is to correctly classify a waveform.</s><s>Figure <ref type="figure" target="#fig_7">5B</ref> shows this effect.</s><s>For tetrodes, in which only two or three units were found, the error for both single spikes and overlaps was similar and below 1%.</s><s>If more than three neurons were present in the recording, the usual case for our in vivo recordings, the error rates increased slightly.</s><s>In recordings with nine units, the error rates for single spikes and overlapping spikes increased to 1% and 2.5%, respectively.</s><s>Figure <ref type="figure" target="#fig_7">5C</ref> shows how the number of spikes within an overlap affects the error rate.</s><s>The sorting of a higher-order overlap was counted as an error as soon as a single of the contributing spikes was incorrectly classified or not detected at all or a spike was found that was not part of the overlap.</s><s>Thus an error rate of 10% for overlaps with five participating units implies that the five individual spikes comprising the overlap are, in 90% of the cases, all correctly detected and classified.</s></p><p><s>Since a tetrode has four independent electrical contacts with the tissue, we were interested in how far each additional electrode improved performance compared with a single electrode <ref type="bibr" target="#b12">(Gray et al. 1995)</ref>.</s><s>To assess the impact of additional electrodes, we removed electrodes from our simulations.</s><s>Since most templates have an unequal amplitude distribution across electrodes, some templates could become undetectable after electrodes are removed (see METHODS).</s><s>In that case, we deleted the template from the set of available templates for the template matching.</s><s>This should mimic the fact that in a real recording condition with a lower number of electrodes the corresponding template would not have been found by any initial spike sorting and the associated spikes either missed or falsely assigned to another template.</s><s>We found that each additional recording electrode strongly decreases the error rate (Fig. <ref type="figure" target="#fig_7">5D</ref>), despite the fact that with increasing electrode number the number of recorded neurons also increases (Fig. <ref type="figure" target="#fig_7">5E</ref>).</s><s>The more neurons that are present in a recording, the more complex the spike sorting problem becomes: For a fixed number of electrodes, increasing the number of neurons present in the simulation leads to an increase in error rate (Fig. <ref type="figure" target="#fig_7">5B</ref>).</s><s>Thus, even though the number of available templates increases with additional electrodes, the neurons' error rates decrease because of the better discriminability provided by the additional spatial information.</s><s>We observed the beneficial effect of a larger number of electrodes for both single and overlapping spikes (Fig. <ref type="figure" target="#fig_7">5D</ref>, blue and green bars).</s></p><p><s>Why are error rates for single electrodes significantly higher than those for multielectrodes despite the fact that fewer neurons have to be sorted and the problem should thus be less complex?</s><s>We found that the main reason for this observation is the relative similarity of templates from different neurons on the same electrode when they are normalized to the same amplitude.</s><s>In a single-electrode recording, several neurons will have approximately the same distance to the electrode.</s><s>The further away from the electrode, the more neurons that can be present <ref type="bibr" target="#b3">(Buzsáki 2004</ref>) and the lower their spike amplitudes will be.</s><s>Since the shape of the spike waveform does not seem to be sufficient to discriminate those neurons, error rates are high.</s><s>The additional information given by the spatial distribution of spike amplitudes among the electrodes is the main reason why error rates are lower for multielectrode recordings.</s><s>Spatial information is thus a more reliable feature than singleelectrode waveform differences.</s></p><p><s>Therefore, multielectrodes not only allow for recording from more neurons than single electrodes, by capturing additional spatial information on the position of the different neurons they also reduce spike sorting error rates for all neurons, including the error rate for overlapping spikes.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Prevalence and Resolution of Overlapping Spikes in in Vivo Data</head><p><s>So far, our results indicate that overlapping spikes can be resolved with high precision in tetrode recordings by a filterbased template procedure with an iterative scheme to subtract already detected and classified spikes (see METHODS).</s><s>We applied the method to in vivo recordings in prefrontal cortex of awake, behaving macaques.</s><s>As described in the previous section, templates were found by an initial clustering-based spike sorting procedure.</s><s>The noise covariance matrix was estimated on periods of the recording where the initial spike sorting did not find any spikes.</s><s>Then, BOTM was used to redetect and classify all spikes and resolve overlapping spikes.</s></p><p><s>Figure <ref type="figure">6A</ref> shows the prevalence of overlapping spikes in the in vivo recordings.</s><s>Each blue dot is a tetrode recording.</s><s>As expected, the percentage of overlapping spikes increases with the overall firing rate.</s><s>To assess how far the measured percentage of overlaps exceeds what would be expected from pure chance, we simulated spike trains with similar characteristics as the recordings (red and green dots in Fig. <ref type="figure">6A</ref>).</s><s>We found that the percentage of overlaps in vivo is much higher than what would be expected if the neurons' firing reflected independent Poisson processes with constant firing rates (green dots in Fig. <ref type="figure">6A</ref>).</s><s>However, a comodulation of the neurons' firing rate could lead to the observed prevalence of overlapping spikes: We simulated independent Poisson spike trains with mean firing rates taken from the in vivo recordings and varied the average firing rate over time for each neuron by the same gamma oscillation (40 Hz).</s><s>The amplitude of the oscillation ranged Fig. <ref type="figure">6</ref>.</s><s>Prevalence and decomposition of in vivo synchronous spikes.</s><s>A: in in vivo recordings, % of spikes participating in overlaps depends on the total firing rate of all units in a given recording (blue points; each point reflects 1 tetrode recording).</s><s>The % of overlaps in in vivo recordings is compared to simulations of independent Poisson spike trains with the same total firing rate (green points) and simulations of independent Poisson spike trains with comodulated firing rates (red points).</s><s>Squares refer to tetrode recordings that are depicted in more detail in B-G.</s><s>B and E: spike times are plotted as ticks for sorted units (different colors) in 5 trials for 2 recordings marked with boxes in A. Rectangles indicate periods that are depicted in more detail in C-G.</s><s>B: recording in which the 4 identified units fire in collective bursts and are silent most of the time, which leads to a high prevalence of overlapping spikes.</s><s>E: recording with 9 identified units and high cumulative firing rate.</s><s>C and F: short piece of extracellular recording for the time period marked in B and E. Superimposed are the templates of the identified units at their respective time of a spike.</s><s>Marked overlaps are depicted in more detail in D and G: resolution of overlapping spikes.</s><s>Left: overlap waveform recorded at the 4 electrodes of the tetrode (black) with the sum of all templates identified in this overlap (magenta).</s><s>Center: template of 1 unit (thick colored line) and residual signal after the templates of all other units have been subtracted (black line).</s><s>Right: residual of data after subtraction of all templates.</s></p><p><s>Innovative Methodology from 0.2 to 1.8 times the original firing rate of the respective neuron (red points in Fig. <ref type="figure">6A</ref>).</s><s>We find that such a modulation yields a similar percentage of overlapping spikes as observed in most of the recordings.</s><s>A possible explanation could be the fact that in our prefrontal recordings local field potentials (LFPs) expressed oscillations in the gamma frequency (30 -90 Hz) range <ref type="bibr">(Pipa et al. 2009)</ref>.</s><s>The observed number of overlaps varies greatly between recording sites (0% to Ͼ50% with a mean of 22 Ϯ 15%).</s><s>One obvious reason for varying percentages of overlapping spikes among the tetrodes is the varying number of neurons recorded at each site and their firing rates (see trend in Fig. <ref type="figure">6A</ref>), which is also reflected in the simulations.</s><s>Apart from the number of neurons and their firing rates, the degree of correlated firing between the neurons is an important factor for the prevalence of overlapping spikes.</s><s>An extreme example from our recordings with strongly correlated, burstlike firing behavior of several neurons is shown in Fig. <ref type="figure">6B</ref> (marked in Fig. <ref type="figure">6A</ref> by a black square).</s><s>In such bursts, many, potentially all, of the recorded neurons fire at the same time.</s><s>Such a higher-order overlap is depicted in Fig. <ref type="figure">6, C and D</ref>, where three of the four neurons fire near-synchronously.</s><s>Can the method resolve such higher-order overlaps reliably?</s><s>The resolution for the example in Fig. <ref type="figure">6C</ref> is shown in Fig. <ref type="figure">6D</ref>.</s><s>As can be seen, each individual spike template fits well to the residual recording after all other templates have been subtracted.</s><s>This is also reflected in the overall residual, which is close to the noise signature <ref type="bibr">(Pouzat et al. 2002)</ref>.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DISCUSSION</head><p><s>We analyzed the degree to which the clustering-based spike sorting procedures and the filter-based template matching procedure were able to successfully resolve overlapping spikes in multielectrode recordings.</s><s>To our knowledge, this is the first time that dual patch-clamp recordings, together with a tetrode, have been employed for this purpose.</s><s>In agreement with the results from previous studies <ref type="bibr" target="#b17">(Lewicki 1998;</ref><ref type="bibr">Quiroga et al. 2004)</ref>, we found that the classical spike sorting approach using spike detection, alignment, feature extraction, and clustering is not able to correctly classify overlapping spikes, even if the activity of only two neurons is being recorded.</s><s>Spike detection and alignment are potentially strongly affected by overlapping spikes.</s><s>From all the spikes participating in an overlap only a single spike might be detected and the altered waveform of the overlap might lead to strong alignment problems.</s><s>We found that ignoring possible errors from spike detection and alignment, by correctly preprocessing the spikes with the available ground truth information, only partially remedied the problem (Fig. <ref type="figure" target="#fig_3">2F</ref>).</s><s>In contrast, a filter-based template matching procedure (BOTM) <ref type="bibr" target="#b10">(Franke et al. 2015)</ref> was able to reliably resolve the overlapping spikes.</s><s>However, template matching relies on knowledge of the correct templates.</s><s>How the templates should be estimated in the first place was not addressed in this work.</s></p><p><s>Alternative approaches to the overlapping problem have been suggested, e.g., ICA.</s><s>In principle, it enables investigators to demix multielectrode recordings <ref type="bibr">(Takahashi et al. 2003</ref>).</s><s>However, a major disadvantage of this method is that the number of electrodes has to be at least as large as the number of signal sources (neurons).</s><s>Thus ICA is inapplicable to single-electrode recordings.</s><s>Another caveat of ICA is the assumption that the waveforms of different electrodes of the same spike have to be linearly dependent.</s><s>This is in general not the case <ref type="bibr" target="#b14">(Jäckel et al. 2012)</ref>.</s></p><p><s>Therefore, after the application of ICA to extracellular recordings a final clustering step needs to be performed, but it is prone to the same problems as outlined above (Fig. <ref type="figure" target="#fig_3">2B</ref>).</s><s>Promising approaches that can be used to solve this overlap problem include filter-based methods <ref type="bibr" target="#b10">(Franke et al. 2010</ref><ref type="bibr" target="#b10">(Franke et al. , 2015;;</ref><ref type="bibr">Roberts and Hartline 1975;</ref><ref type="bibr">Stein et al. 1979;</ref><ref type="bibr">Vollgraf et al. 2005)</ref>, which could resolve overlapping spikes by deconvolution, and methods based on probabilistic frameworks that integrate the possibility of spike overlap <ref type="bibr" target="#b7">(Ekanadham et al. 2014;</ref><ref type="bibr" target="#b10">Franke et al. 2015;</ref><ref type="bibr" target="#b22">Pillow et al. 2013)</ref>.</s><s>In particular, we compared the purely subtractive BOTM procedure to the method presented in <ref type="bibr" target="#b22">Pillow et al. (2013)</ref> and found that the methods produce similar errors and error rates, highlighting the similarity of the two approaches.</s><s>Additionally, the hybrid BOTM approach clearly outperformed both other methods for small ⌬, indicating that the greedy subtractive scheme has its limits for heavily distorted waveforms.</s><s>Here, the position or the identity of the first spike to be subtracted might be incorrectly estimated, which can induce additional errors in the successive iterations.</s></p><p><s>Since the in vitro recordings only captured the activity of two neurons, simulated surrogate data mimicking recordings from macaque prefrontal cortex were used.</s><s>The results confirmed the findings from the previous analysis and indicated that overlaps can also be resolved correctly in more complicated scenarios where more than two neurons are firing at the same time.</s><s>The error rates for overlapping spikes using a tetrode with a three-dimensional electrode geometry stay relatively low for up to five spikes in a single overlap.</s><s>We found that the additional information given by the multielectrode greatly reduces the error rates for both overlapping spikes and single spikes.</s><s>A single electrode does not carry enough information to reliably discriminate between some of the neurons, since the single-electrode waveforms of different neurons can be relatively similar.</s><s>However, a multielectrode adds a spatial component about the origin of the spikes to the information gathered by the extracellular recording.</s></p><p><s>We then analyzed the behavior of BOTM to resolve overlapping spikes in the in vivo recordings from macaque prefrontal cortex; however, because of the lack of ground truth information it was not possible to evaluate the performance in a straightforward manner.</s><s>To identify the number of neurons and their templates from the extracellular recordings, we used a standard PCA and clustering-based spike sorting procedure.</s><s>Although we do not claim that this is the best way to compute the templates, manual inspection of the results indicated that the automatically estimated templates were at least reasonable.</s></p><p><s>The results of this study suggest that treating the spike sorting problem requires two distinct steps.</s><s>First, the number of neurons and their respective templates have to be estimated.</s><s>Second, template matching can be used to reanalyze the complete extracellular recording, thereby redetecting and classifying the spikes in the same step.</s><s>In the first step, the sorting quality is not crucial; overlapping spikes can (or even should) be ignored as long as the correct templates for the individual units can be correctly estimated.</s><s>In principle, this step could be run only on part of the recording, e.g., if the number of spikes is too large to be clustered efficiently.</s><s>The second step can then be run on the complete data.</s></p><p><s>Our results suggest that overlapping spikes in extracellular recordings can be separated with very high reliability, in particular when using multielectrodes.</s><s>This opens up the pos-sibility of also using relatively simple recording devices to study neural cooperativity in local neural ensembles in the case in which synchronous activity with a small temporal delay results from the recordings.</s></p><p><s>Violations of the underlying assumptions of the template matching (stable and known templates, colored Gaussian noise) could be induced by strong non-Gaussian noise and bursting neurons.</s><s>During bursts, the extracellular spike waveforms of a single neuron can change, which would lead to a suboptimal fit between the template and the recorded waveforms.</s><s>The method used in this study does not currently account for this, and in our data sets we did not observe amplitude variability to be a problem.</s><s>In other data sets, however, where amplitude decrease is more pronounced, the greedy subtraction scheme used here might subtract an ill-fitting template, which could cause errors in the successive steps.</s><s>There are two potential ways out of this problem: First, one could allow for multiple templates per neuron, each template representing spikes of the same neuron but with different amplitudes, e.g., during a burst.</s><s>Second, the method could take the amplitude variability explicitly into account, e.g., in a similar way as proposed in <ref type="bibr" target="#b18">Marre et al. (2012)</ref>, which would, however, significantly increase computational complexity.</s><s>But further investigation and different data sets are needed to investigate the effect of amplitude variability on overlap resolution.</s></p><p><s>The method in <ref type="bibr" target="#b18">Marre et al. (2012)</ref> was developed for multielectrode arrays with a high electrode count and also uses a greedy subtraction scheme to resolve overlapping spikes.</s><s>We have shown that additional electrodes are beneficial for spike sorting performance, and it stands to reason that this also holds for multielectrode arrays.</s><s>So many neurons are being recorded in this case, however, that overlapping spikes are the norm, not the exception <ref type="bibr" target="#b18">(Marre et al. 2012)</ref>.</s><s>Studying filter-based spike sorting methods for use with multielectrode arrays <ref type="bibr" target="#b5">(Dragas et al. 2014;</ref><ref type="bibr" target="#b9">Franke et al. 2012</ref>) is a promising future direction.</s></p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>FrankeF</head><label></label><figDesc><div><p><s>, Pröpper R, Alle H, Meier P, Geiger JR, Obermayer K, Munk MH.</s><s>Spike sorting of synchronous spikes from local neuron ensembles.</s><s>J Neurophysiol 114: 2535-2549, 2015.</s><s>First published August 19, 2015; doi:10.1152/jn.00993.2014.</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 1 .</head><label>1</label><figDesc><div><p><s>Fig. 1.</s><s>Overlapping spike waveforms in 3 different types of signals.</s><s>Temporally superimposed ("overlapping") spike waveforms for in vitro, simulated (in virtu), and in vivo data.</s><s>A: examples of single spikes (left) and 3 examples for overlaps (right) for 3 different data sets on all 4 electrodes.</s><s>The in vitro example includes the intracellular voltage traces of both recorded neurons.</s><s>The in virtu and in vivo data sets shown here have 3 recorded neurons each.</s><s>Vertical dashed lines show the timing of the spikes in the in virtu data set.</s><s>B: results of a principal component analysis (PCA).</s><s>The first 2 principal components are shown for overlapping spikes (pink circles) and single spikes (filled, colored).</s><s>Spike sorting methods based on clustering operate on the points shown here without the knowledge represented by the color code.</s><s>Each pink circle corresponds to an overlap of 2 single spikes.</s><s>The black arrows and crosses indicate, for 1 overlap in each row, where the 2 single waveforms comprising the overlap would be located.</s><s>C: the clusters are clearly separable after all overlaps have been resolved into 2 single waveforms each (pink circles).</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 1 ,</head><label>1</label><figDesc><div><p><s>Fig. 1, Fig. 4, Fig. 5</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 2 .</head><label>2</label><figDesc><div><p><s>Fig. 2. Simultaneous intra-and extracellular in vitro recordings.</s><s>A: infrared-differential interference contrast video microscopy image of a slice in the recording setup.</s><s>Two neurons are recorded with 1 intracellular recording pipette (IC) each.</s><s>A tetrode tip (black triangle, slightly out of focus) is placed between 2 neurons.</s><s>B: simultaneous intracellular and extracellular recordings of the 2 neurons upon intracellular stimulation of both cells.</s><s>The stimulation triggered near-synchronous action potentials in both neurons that overlap in time.</s><s>The second cell (red trace) fires 2 action potentials.</s><s>Dotted lines indicate 0 V. C: spikes are detected in the intracellular recordings by simple amplitude threshold and are cut out around the detection.</s><s>All spikes of the 2 neurons of 1 experiment are superimposed and aligned on the peak of the intracellular recordings.</s><s>The corresponding average waveforms (templates) are shown on right.</s><s>D: 4 examples of overlapping spikes from that recording with varying time distance ⌬ (in number of samples, 33.3-kHz sampling rate) between the intracellular peaks.</s><s>E: histogram of all⌬ values in the data set across experiments.</s><s>A total of ϳ47,000 spikes were recorded, of which ϳ25,000 spikes had a ⌬ Յ 50 samples.</s><s>F: performance of filter-based template matching [Bayes optimal template matching (BOTM)] and k-means with k ϭ 2. For k-means*, spikes were aligned using the available ground truth.</s><s>For k-means, spikes were aligned on the maximum of the waveform.</s><s>For BOTM, an alignment step is not necessary.</s><s>The performance is averaged across all in vitro experiments.</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 3 .</head><label>3</label><figDesc><div><p><s>Fig. 3. Illustration of the resolution of overlapping spikes by template matching.</s><s>A: single-electrode recording (black lines) of 3 spike waveform examples.Superimposed are the templates that are detected in the step of the method illustrated in B. B: for each template the method computes a corresponding template matching output.</s><s>Shown are the outputs for 2 single spike templates (blue and green) and the outputs to a number of templates constructed from superposition of the 2 templates (thin gray lines).</s><s>If any of the outputs surpasses a threshold (dotted line), a detection window is started (gray shaded area).</s><s>This window has a minimal length and stops only when all outputs are below the threshold again.</s><s>Within each window, the template with the maximal output is detected (thick vertical ticks).</s><s>For the waveform at center, a template representing an overlap between the 2 spikes had the maximal output (orange).</s><s>In the case on right only a single spike is detected, since the 2 spikes in the overlap are too far apart.</s><s>C: once a template is found, it is subtracted from the data.</s><s>Shown are the residuals after the first subtraction.</s><s>D: template matching outputs on the residual signals.</s><s>Only in the case on right does a threshold crossing occur.</s><s>E: templates used for this illustration.</s><s>F: residual after subtraction of the second detected spike of the case on right in D. G: template matching outputs for F.</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><label></label><figDesc><div><p><s>Fig. 4. Simulation of overlapping spikes.</s><s>A: data were recorded with a tetrode in monkey prefrontal cortex and sorted with a standard spike sorting approach using the following steps: spike detection, spike alignment (not shown), prewhitening of spikes (not shown), PCA, expectation maximization clustering.</s><s>The cluster means are used as templates for the corresponding neuron.</s><s>B: simulation of overlaps consisted of 3 steps: 1) Cutting of a small piece of recorded data where no spikes were detected (ϭ noise).</s><s>2) Selection of 2 or more random templates from the sorting of corresponding data.</s><s>Random subsample shift for each template.</s><s>3) Linear superposition of noise and templates.</s><s>C: examples of overlaps at different shifts (⌬).</s><s>Four overlaps of 2 spikes and 1 overlap of 3 spikes are shown.</s><s>⌬ values are given in samples; sampling rate is 32,000 Hz.</s><s>The examples show integer values for ⌬, but subsample shifts were also produced by upsampling, shifting, and successive downsampling of the respective waveforms.</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 5 .</head><label>5</label><figDesc><div><p><s>Fig.5.</s><s>Spike sorting performance on synthetic data.</s><s>Results from simulations based on 40 recordings in 2 monkeys with a total of 187 units.</s><s>Error bars indicate SE (A-C) or SD (E).</s><s>The error in % reflects the number of overlapping spikes in which at least 1 individual spike was sorted incorrectly.</s><s>The grey and black bars in B-D show the error rate defined as % of overlapping spikes where at least 1 individual spike was missed (false negative) or at least 1 additional spike, not present in the overlap, was found (false position).</s><s>A: average error rate on overlaps of 2 spikes depending on their temporal shift ⌬.</s><s>Note that the error decreases for small ⌬ values for the BOTM hybrid approach (see METHODS) but increases if the pure greedy heuristic is used (BOTM without hybrid).</s><s>The increased error rate around Ϫ0.1 ms and 0.1 ms results from 2 recordings in which the waveform of an overlap of 2 units with a certain shift is similar to the waveform of another template on the same tetrode.</s><s>Inset: error rate for k-means is dramatically increased for overlapping spikes.</s><s>The error rate goes to 100% for spikes with ⌬ ϭ 0 ms, since 1 of the participating spikes is always misclassified.</s><s>B: the error rate for overlaps of 2 spikes increases with the number of units in the recording.</s><s>C: error rate for overlaps with different numbers of participating spikes.</s><s>D: the error rate decreases if more recording electrodes are available.</s><s>For D and E, we removed recording electrodes from the data and kept templates only for units that remained detectable on the remaining electrodes.</s><s>E: with increasing number of electrodes fewer templates were removed from the simulation due to low detectability.</s><s>Thus, with increasing electrode number, more units had to be sorted.</s><s>Error bars indicate SD.</s></p></div></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 .</head><label>1</label><figDesc><div><p><s>Data sets used in this study</s></p></div></figDesc><table><row><cell>Data Set</cell><cell>Ground Truth</cell><cell>Aspect Studied</cell><cell>Used in</cell></row><row><cell>In vitro</cell><cell>Partial: 2 neurons from patch-clamp recordings</cell><cell>Overlaps of 2 spikes</cell><cell>Fig. 1, Fig. 2</cell></row><row><cell>In virtu</cell><cell>Full: Յ9 simulated neurons using realistic</cell><cell>Higher-order overlaps, effect of number of</cell><cell></cell></row><row><cell></cell><cell>waveforms from in vivo recordings</cell><cell>electrodes, many neurons per recording</cell><cell></cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot">J Neurophysiol • doi:10.1152/jn.00993.2014 • www.jn.org Downloaded from journals.physiology.org/journal/jn (176.172.000.127) on May 17, 2022.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2543">SPIKE SORTING OF SYNCHRONOUS SPIKES J Neurophysiol • doi:10.1152/jn.00993.2014 • www.jn.org Downloaded from journals.physiology.org/journal/jn (176.172.000.127) on May 17, 2022.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot">J Neurophysiol • doi:10.1152/jn.00993.2014 • www.jn.org from journals.physiology.org/journal/jn (176.172.000.127) on May 17, 2022.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGMENTS</head><p><s>We thank Roland Diggelmann and Thomas Russel, ETH Zürich, for comments on a draft of this paper.</s><s>We gratefully acknowledge the helpful comments and suggestions from the anonymous reviewers.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>GRANTS</head><p><s>This work was supported by DFG GRK 1589/1 and the German Federal Ministry of Education and Research (BMBF) with the grants 01GQ0743 and 01GQ0410, by the European Community through the ERC Advanced Grant 267351, NeuroCMOS, and the SNSF Sinergia Project CRSII3_141801.</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DISCLOSURES</head><p><s>No conflicts of interest, financial or otherwise, are declared by the author(s).</s></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>AUTHOR CONTRIBUTIONS</head><p><s>Author contributions: F.F., R.P., H.A., K.O., and M.H.J.M. conception and design of research; F.F., R.P., and P.M. analyzed data; F.F., R.P., and M.H.J.M. interpreted results of experiments; F.F. and R.P. prepared figures; F.F., R.P., and M.H.J.M. drafted manuscript; F.F., R.P., H.A., P.M., and M.H.J.M. edited and revised manuscript; F.F., R.P., H.A., J.R.P.G., K.O., and M.H.J.M. approved final version of manuscript; H.A. and M.H.J.M. performed experiments.</s></p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0" />			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Recognition of multiunit neural signals</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Atiya</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans Biomed Eng</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="723" to="729" />
			<date type="published" when="1992">1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Failure in identification of overlapping spikes from multiple neuron activity causes artificial correlations</title>
		<author>
			<persName><forename type="first">I</forename><surname>Bar-Gad</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Ritov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Vaadia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Bergman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci Methods</title>
		<imprint>
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="page" from="1" to="13" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Dendritic discrimination of temporal input sequences in cortical neurons</title>
		<author>
			<persName><forename type="first">T</forename><surname>Branco</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">A</forename><surname>Clark</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Häusser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">329</biblScope>
			<biblScope unit="page" from="1671" to="1675" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Large-scale recording of neuronal ensembles</title>
		<author>
			<persName><forename type="first">G</forename><surname>Buzsáki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat Neurosci</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="446" to="451" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">A new action potential detector using the MTEO and its effects on spike sorting systems at low signal-to-noise ratios</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">K</forename><surname>Jung</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Kim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans Biomed Eng</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="738" to="746" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Eckhorn R, Thomas U. A new method for the insertion of multiple microprobes into neural and muscular tissue, including fiber electrodes, fine wires, needles and microsensors</title>
		<author>
			<persName><forename type="first">J</forename><surname>Dragas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Jackel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hierlemann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans Neural Syst Rehabil Eng</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="175" to="179" />
			<date type="published" when="1993">2014. 1993</date>
		</imprint>
	</monogr>
	<note>J Neurosci Methods</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Towards reliable spike-train recordings from thousands of neurons with multielectrodes</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">T</forename><surname>Einevoll</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Hagen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Pouzat</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">D</forename><surname>Harris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr Opin Neurobiol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="11" to="17" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">A unified framework and method for automatic neural spike identification</title>
		<author>
			<persName><forename type="first">C</forename><surname>Ekanadham</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Tranchina</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">P</forename><surname>Simoncelli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci Methods</title>
		<imprint>
			<biblScope unit="volume">222</biblScope>
			<biblScope unit="page" from="47" to="55" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Real-Time Analysis of Extracellular Multielectrode Recordings</title>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<ptr target="http://opus.kobv.de/tuber-lin/volltexte/2012/3387/" />
		<imprint>
			<date type="published" when="2011">2011</date>
			<pubPlace>Berlin</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Technische Universität Berlin</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">PhD thesis</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">High-density microelectrode array recordings and real-time spike sorting for closed-loop experiments: an emerging technology to study neural plasticity</title>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Jäckel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Dragas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Müller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Radivojevic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Bakkum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hierlemann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front Neural Circuits</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="1" to="7" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">An online spike detection and spike classification algorithm capable of instantaneous resolution of overlapping spikes</title>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Natora</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Boucsein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">H</forename><surname>Munk</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Obermayer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">Q</forename><surname>Quiroga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hierlemann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Obermayer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Comput Neurosci</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="439" to="459" />
			<date type="published" when="2010">2010. 2015</date>
		</imprint>
	</monogr>
	<note>J Comput Neurosci</note>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Detection of Signals by Template Matching</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">H</forename><surname>Friedman</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1968">1968</date>
			<publisher>Johns Hopkins Press</publisher>
			<pubPlace>Baltimore, MD</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Optimal discrimination and classification of neuronal action potential waveforms from multiunit, multichannel recordings using software-based linear filters</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">N</forename><surname>Gozani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jp ;</forename><surname>Miller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Gray</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Maldonado</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wilson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Mcnaughton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans Biomed Eng</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="43" to="54" />
			<date type="published" when="1994">1994. 1995</date>
		</imprint>
	</monogr>
	<note>J Neurosci Methods</note>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Accuracy of tetrode spike separation as determined by simultaneous intracellular and extracellular measurements</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">D</forename><surname>Harris</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Henze</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Csicsvari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Hirase</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Buzsáki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurophysiol</title>
		<imprint>
			<biblScope unit="volume">84</biblScope>
			<biblScope unit="page" from="401" to="414" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Applicability of independent component analysis on high-density microelectrode array recordings</title>
		<author>
			<persName><forename type="first">D</forename><surname>Jäckel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><surname>Frey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Fiscella</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Franke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hierlemann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurophysiol</title>
		<imprint>
			<biblScope unit="volume">108</biblScope>
			<biblScope unit="page" from="334" to="348" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Spike sorting based on discrete wavelet transform coefficients</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Letelier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">P</forename><surname>Weber</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci Methods</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="page" from="93" to="106" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Bayesian modeling and classification of neural signals</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Lewicki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural Comput</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="1005" to="1030" />
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">A review of methods for spike sorting: the detection and classification of neural action potentials</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Lewicki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Network</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="R53" to="R78" />
			<date type="published" when="1998">1998</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Mapping a complete neural population in the retina</title>
		<author>
			<persName><forename type="first">O</forename><surname>Marre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Amodei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Deshmukh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Sadeghi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Soo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">E</forename><surname>Holy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Berry</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="14859" to="14873" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">The stereotrode: a new technique for simultaneous isolation of several single units in the central nervous system from multiple unit records</title>
		<author>
			<persName><forename type="first">B</forename><surname>Mcnaughton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>O'keefe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Barnes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci Methods</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="391" to="397" />
			<date type="published" when="1983">1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Phase relationship between hippocampal place units and the EEG theta rhythm</title>
		<author>
			<persName><forename type="first">J</forename><surname>O'keefe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">L</forename><surname>Recce</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hippocampus</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="317" to="330" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Robustness of the significance of spike synchrony with respect to sorting errors</title>
		<author>
			<persName><forename type="first">A</forename><surname>Pazienti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Grün</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Comput Neurosci</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="329" to="342" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">A model-based spike sorting algorithm for removing correlation artifacts in multi-neuron recordings</title>
		<author>
			<persName><forename type="first">C</forename><surname>Pedreira</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Martinez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Ison</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">Q</forename><surname>Quiroga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Perin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">K</forename><surname>Berger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Markram</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">W</forename><surname>Pillow</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Shlens</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">J</forename><surname>Chichilnisky</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">P</forename><surname>Simoncelli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Neurosci Methods</title>
		<imprint>
			<biblScope unit="volume">211</biblScope>
			<biblScope unit="page">e62123</biblScope>
			<date type="published" when="2011">2012. 2011. 2013</date>
		</imprint>
	</monogr>
	<note>PLoS One</note>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Performance-and stimulus-dependent oscillations in</title>
		<author>
			<persName><forename type="first">G</forename><surname>Pipa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">S</forename><surname>Städtler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">F</forename><surname>Rodriguez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Waltz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">F</forename><surname>Muckli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Singer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Goebel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">H</forename><surname>Munk</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
